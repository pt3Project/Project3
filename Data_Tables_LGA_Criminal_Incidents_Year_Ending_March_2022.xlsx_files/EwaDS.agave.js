/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1017:function(y,C,b){function a(e,f,l){this.fQb=e;this.sjg=f;this.tjg=l}function c(){this.title=this.id=this.tabs=null}y=b(0);Object(y.a)(c,"AddInDataTransferObject",null,[]);b.d(C,"a",function(){return a});a.pub=function(e){return(e=e.pW)?Object.assign(new c,{tabs:e.Ps.toArray(),id:e.NAg,title:e.OAg}):null};Ck.Object.defineProperties(a.prototype,{Ps:{configurable:!0,enumerable:!0,get:function(){return this.fQb}},NAg:{configurable:!0,
enumerable:!0,get:function(){return this.sjg}},OAg:{configurable:!0,enumerable:!0,get:function(){return this.tjg}}});Object(y.a)(a,"OneLineRibbonExtensibility",null,[])},1057:function(y,C,b){function a(M,ba,V){V=void 0===V?null:V;this.wEc=new u.a;var aa=new h.a;ba&&aa.add(ba.dwi);V&&aa.addRange(V);this.En=M;this.ixg=aa}function c(M,ba,V,aa){this.vT=new h.a;this.tG=new h.a;this.zpa=null;this.Skb=new h.a;this.n$d=Promise.resolve(null);this.oge=!1;this.FVb=ba;this.fmg=M;this.Rge=V;this.xjg=aa}function e(){var M=
f.call(this)||this;M.errorCode=0;return M}function f(){this.LQb=new h.a;this.U9=this.T9=!1;this.uoa=this.authChallenge=null;this.startTime=this.retryCount=0;this.Vne=null}function l(){this.token=null;this.expiresOn=0;this.iha=this.authChallenge=null}function n(){this.accessToken=null}function m(){this.startTime=0;this.callback=null}b.r(C);y=b(0);var h=b(202),x=b(15),u=b(99);Object(y.a)(m,"SSOCallbackInfo",null,[]);Object(y.a)(n,"AccessTokenInformation",null,[109]);var w=b(1167);Object(y.a)(l,"CachedTokenInfo",
null,[]);Ck.Object.defineProperties(f.prototype,{callbacks:{configurable:!0,enumerable:!0,get:function(){return this.LQb}}});Object(y.a)(f,"SSORequestInfo",null,[]);Wl(e,f);Object(y.a)(e,"SSOFailedRequestInfo",f,[]);var v=b(4);c.prototype.Mvj=function(M){if(this.zpa&&this.zpa.authChallenge===M.authChallenge){if(Date.now()/1E3+c.Bxi>this.zpa.expiresOn)return this.zpa=null,!1;M=new w.a;M.token=this.zpa.token;M.expiresOn=this.zpa.expiresOn;M.iha=this.zpa.iha;M.WSa=!0;M.ewb=0;this.vwb(M);return!0}return!1};
c.prototype.ruj=function(M){for(var ba=0;ba<this.tG.count;ba++)if(this.tG.oa(ba).authChallenge===M.authChallenge&&this.tG.oa(ba).uoa===M.uoa){var V=void 0;(V=this.tG.oa(ba)).retryCount=V.retryCount+1;M.retryCount=this.tG.oa(ba).retryCount;if(this.tG.oa(ba).retryCount<c.$xi||!this.tG.oa(ba).T9&&M.T9||!this.tG.oa(ba).U9&&M.U9){if(!this.tG.oa(ba).T9&&M.T9||!this.tG.oa(ba).U9&&M.U9)M.retryCount=0;this.tG.removeAt(ba);break}M=new w.a;M.errorCode=this.tG.oa(ba).errorCode;this.vwb(M);return!0}return!1};
c.prototype.DCg=function(M,ba){for(var V=0;V<this.tG.count;V++)if(this.tG.oa(V).uoa===M.uoa&&this.tG.oa(V).authChallenge===M.authChallenge)return;this.tG.add(Object.assign(new e,{T9:M.T9,U9:M.U9,authChallenge:M.authChallenge,uoa:M.uoa,errorCode:ba,retryCount:M.retryCount}))};c.prototype.acd=function(M,ba,V,aa,E,G){var I=this,R=b(1057).AppsForOfficeSingleSignOnManager;""===V&&(V=null);if(this.oge)R.P5(G,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{for(var Y=null,U=Gl(this.vT),
ha=U.next();!ha.done;ha=U.next())if(ha=ha.value,ha.T9===M&&ha.U9===ba&&ha.authChallenge===V&&ha.uoa===E){Y=ha;break}Y||(Y=Object.assign(new f,{T9:M,U9:ba,authChallenge:V,Vne:aa,uoa:E,retryCount:0,startTime:R.xw()}),this.vT.add(Y));Y.retryCount=0;Y.callbacks.add(G);this.n$d=this.n$d.then(function(){var ta=b(1057).AppsForOfficeSingleSignOnManager;if(0<I.vT.count){var xa=I.vT.oa(0);if(I.Mvj(xa)||I.ruj(xa))return null;for(var oa=0;oa<I.Skb.count;)I.Skb.oa(oa)+c.$Gj<ta.xw()?I.Skb.removeAt(oa):oa++;if(I.Skb.count>=
c.Vxi||I.vT.count>=c.yxi)return xa=new w.a,xa.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,I.vwb(xa),null;var qa=null;v.AFrameworkApplication.sa&&(ta=v.AFrameworkApplication.sa.yD)&&(qa=ta.Gc("ComponentAttach",I.fmg+c.fwg));return xa.uoa.Iyg(I.resource,xa.T9,xa.U9,xa.authChallenge,I.xjg,xa.Vne).then(function(Ea){qa&&qa.stop();I.vwb(Ea)},function(){qa&&qa.stop();var Ea=new w.a;Ea.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;I.vwb(Ea)})}return null})}};c.prototype.vwb=
function(M){var ba=b(1057).AppsForOfficeSingleSignOnManager;try{if(this.vT.count){var V=this.vT.oa(0);this.vT.removeAt(0);var aa=null;M.errorCode||(aa=new n,aa.accessToken=M.token);M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&M.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.DCg(V,M.errorCode);var E={};null!=
M.ewb&&(E.getTokenSilentTime=M.ewb.toString());null!=M.Bgd&&(E.getTokenPopupTime=M.Bgd.toString());null!=M.led&&(E.getIDTokenTime=M.led.toString());null!=M.WSa&&(E.tokenCached=M.WSa.toString());M.DUd&&(E.detailedError=M.DUd);M.iha&&(E.authLibrary=M.iha);V.retryCount&&(E.retryCount=V.retryCount);for(var G=Gl(V.callbacks),I=G.next();!I.done;I=G.next())ba.P5(I.value,M.errorCode,aa,E);null!=M.WSa&&M.WSa||this.Skb.add(V.startTime);if(!M.errorCode)for(null!=M.expiresOn&&(this.zpa=Object.assign(new l,{token:M.token,
expiresOn:M.expiresOn,authChallenge:V.authChallenge,iha:M.iha})),this.tG.clear(),G=0;G<this.vT.count;)if(this.vT.oa(G).authChallenge===V.authChallenge){var R=Gl(this.vT.oa(G).callbacks);for(I=R.next();!I.done;I=R.next())ba.P5(I.value,M.errorCode,aa,E);this.vT.removeAt(G)}else G++}}catch(Y){x.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",Y.message)}};c.prototype.shutdown=function(){this.oge=!0;this.vT.clear()};Ck.Object.defineProperties(c.prototype,{resource:{configurable:!0,
enumerable:!0,get:function(){return this.FVb}}});c.$Gj=6E4;c.Vxi=6;c.yxi=6;c.$xi=3;c.Bxi=300;c.fwg="GetAccessToken";Object(y.a)(c,"SSOCallbackManager",null,[]);var t=b(933),z=b(940),D=b(124),A=b(80),B=b(24),N=b(29),P=b(153),Q=b(355);b.d(C,"AppsForOfficeSingleSignOnManager",function(){return a});a.prototype.bcd=function(M,ba,V,aa,E,G,I,R,Y,U){U=Object.assign(new m,{startTime:a.xw(),callback:U});try{var ha=!!V&&""!==V,ta=U.startTime,xa=this.getOsfControl(M),oa=xa.getStoreType()||"",qa=xa.getOwnerAddinStoreType()||
"",Ea=xa.getSolutionId()||"",ka=xa.getVersion()||"";oa=oa.toLowerCase();qa=qa.toLowerCase();Ea=Ea.toLowerCase();var za=A.a.ked(ba)||"",La=A.a.ked(xa.getIframeUrl())||"",Ia=za.toLowerCase()===La.toLowerCase();za=oa;"inmemory"===oa&&(za=qa);var Ya=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ea,za,xa.getAssetId(),null,null,xa.getStoreId());xa={};var tb=(xa.callInstanceId=ta.toString(),xa.controlAssetId=Ya,xa.controlVersion=ka,xa.storeType=oa,xa.ownerStoreType=qa,xa.allowConsentPrompt=aa.toString(),
xa.forMSGraphAccess=E.toString(),xa.allowSignInPrompt=G.toString(),xa.hasAddinAuthChallenge=ha.toString(),xa.securityOriginEqualsSourceLocation=Ia.toString(),xa.singleSignOnEnabled=I.toString(),xa.accountTypeFilter=R||"",xa);x.ULS.sendTraceTag(51401115,344,50,"{0}",tb);P.a.sendTelemetryEvent(Object.assign(new Q.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:D.a.sl(tb)}));ta=!0;var Tb=v.AFrameworkApplication.fa.Va("HostAuthType");switch(R){case "aad":ta="aad"===Tb;break;
case "msa":ta="msa"===Tb;break;default:ta=!R||"noFilter"===R}if(ta){R=null;if(I)for(var va=Gl(this.ixg),la=va.next();!la.done;la=va.next()){var $a=la.value;if($a.Tfi(Ea)){R=$a;break}}R?this.isSSOAddin(M)?(I=!0,"omex"===za&&(I=!1),"spapp"===za||"spcatalog"===za?(x.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),a.P5(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):E&&!I?(x.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),
a.P5(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(E&&"exchange"===za&&(aa=!1),this.acd(M,ba,V,za,aa,G,Y,R,U))):(x.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),a.P5(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):a.P5(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else a.P5(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(Ra){this.Sjc(),x.ULS.sendTraceTag(22402397,
344,10,"GetAccessToken: action failed. Exception message: {0}",Ra.message),a.P5(U,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}};a.prototype.getAccessToken=function(M,ba,V,aa){this.bcd(M,V[t.a.zVc]||null,V[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,V[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,V[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,V[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||
!1,ba,V[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,V[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,aa)};a.prototype.acd=function(M,ba,V,aa,E,G,I,R,Y){this.wEc.yb(M)?aa=this.wEc.oa(M):(aa=new c(M,this.getWebApplicationResource(M).split(",")[0],aa,this.getDefaultDisplayName(M)),this.wEc.add(M,aa));var U=aa.resource;M=a.QUh(U,this.getWebApplicationId(M));var ha=OfficeExt.WACUtils.getHostSecure(ba);M&&ha?M.toLowerCase()===ha.toLowerCase()?aa.acd(E,
G,V,I,R,Y):(a.GNa('SSO Resource "'+U+'" cannot be used from "'+ba+'" origin due to domain mismatch.'),x.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),a.P5(Y,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(M||x.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),ha||x.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),a.P5(Y,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,
null,null))};a.prototype.Sjc=function(){var M={};x.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",(M.UserAgent=window.navigator.userAgent,M))};a.prototype.getOsfControl=function(M){return this.En.getOsfControl(M)};a.prototype.isSSOAddin=function(M){return this.getOsfControl(M).getManifest().isSSOAddin()};a.prototype.getWebApplicationId=function(M){return this.getOsfControl(M).getManifest().getWebApplicationId()};a.prototype.getWebApplicationResource=function(M){return this.getOsfControl(M).getManifest().getWebApplicationResource()};
a.prototype.getDefaultDisplayName=function(M){return this.getOsfControl(M).getManifest().getDefaultDisplayName()};a.zWh=function(){try{var M={};B.a.dxa&&z.a.lxb&&(M.UiHostSupportsAuthTokenAddinList=a.bTe);M.UiHostSupportsAuthToken=z.a.lxb;return M}catch(ba){x.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",ba.message)}return null};a.getInstance=function(M,ba,V){a.Ma||(a.Ma=new a(M,void 0===V?null:V));return a.Ma};a.GNa=function(M){window.console.warn&&window.console.warn(M)};
a.QUh=function(M,ba){if(!M)return"";ba||(ba="");var V=M.toLowerCase(),aa=ba.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(aa)||(a.GNa('SSO App Id "'+ba+'" is not a valid format. It will be rejected from store submission.'),x.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));V.endsWith(aa)||(a.GNa('SSO Resource "'+M+'" does not end with App Id "'+ba+'". It will be rejected from store submission.'),x.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));
if(!V.startsWith("https://")&&!V.startsWith("api://"))return a.GNa('SSO Resource "'+M+'" must be https:// or api:// protocol.'),x.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(ba=0;ba<M.length;ba++){aa=M.charAt(ba);var E=N.a.charCodeAt(M,ba);if(33>E||126<E||"&"===aa||"?"===aa||"#"===aa||"%"===aa||"\\"===aa)return a.GNa('SSO Resource "'+M+'" contains an invalid character "'+aa+'".'),x.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+aa+"' in resource URI."),
""}if(0<=M.indexOf("::"))return a.GNa('SSO Resource "'+M+'" contains an invalid string "::".'),x.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<M.length)return a.GNa('SSO Resource "'+M+'" is '+M.length+" characters and exceeds the max length of 120 characters."),x.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+M.length+"."),"";V.startsWith("api://")&&(V="https://"+V.substring(6,V.length));return 8===V.length?"":OfficeExt.WACUtils.getHostSecure(V)||""};a.P5=function(M,
ba,V,aa){var E=M.startTime,G=0;0<E&&(G=a.xw()-E);var I={};E=(I.callInstanceId=E.toString(),I.callDuration=G.toString(),I.errorCode=ba.toString(),I);if(aa)for(var R in aa)E[R]=aa[R];x.ULS.sendTraceTag(51401116,344,50,"{0}",E);P.a.sendTelemetryEvent(Object.assign(new Q.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:D.a.sl(E)}));M.callback(ba,V)};a.xw=function(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(M){}return Date.now()};a.bTe=
"wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");a.Ma=null;Object(y.a)(a,"AppsForOfficeSingleSignOnManager",null,[82])},1071:function(y,C,b){function a(){var e={};this.tQe=(e.tabhome="Ribbon.Home",e.tabinsert="Ribbon.Insert",e.tabdata="Ribbon.Data",e.tabreview="Ribbon.Review",e.tabview="Ribbon.View",e);e={};this.sQe=(e.tabpagelayoutexcel=["Ribbon.PageLayoutExcel",c.a.instance.ga(1610),c.a.instance.ga(1614)],
e.tabformulas=["Ribbon.Formulas",c.a.instance.ga(1611),c.a.instance.ga(1615)],e.tabdeveloper=["Ribbon.Developer",c.a.instance.ga(1612),c.a.instance.ga(1616)],e.tabaddins=["Ribbon.AddIns",c.a.instance.ga(1613),c.a.instance.ga(1617)],e);this.I8b=null}b.d(C,"a",function(){return a});y=b(0);var c=b(14);a.prototype.NQh=function(){if(!this.I8b){this.I8b={};for(var e=Gl(Object.keys(this.tQe)),f=e.next();!f.done;f=e.next())f=f.value,this.I8b[f]=this.tQe[f];e=Gl(Object.keys(this.sQe));for(f=e.next();!f.done;f=
e.next())f=f.value,this.I8b[f]=this.sQe[f][0]}};Ck.Object.defineProperties(a.prototype,{Zha:{configurable:!0,enumerable:!0,get:function(){return"SourceControlId"}},QM:{configurable:!0,enumerable:!0,get:function(){return"Workbook"}},formFactor:{configurable:!0,enumerable:!0,get:function(){return"DesktopFormFactor"}}});Object(y.a)(a,"AddinCommandsStringProvider",null,[528])},1073:function(y,C,b){function a(){this.tLa=0;this.yha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=
0;this.Jdc=!1;this.y8e=this.nia=null}b.d(C,"a",function(){return a});y=b(0);Object(y.a)(a,"AddInCommandsNotificationParameters",null,[])},1140:function(y,C,b){function a(){}function c(){}function e(E,G,I,R,Y,U){E=f.call(this,E,G,I,R,Y,void 0===U?null:U)||this;E.uUb=null;return E}function f(E,G,I,R,Y,U){E=l.call(this,E,I,Y.vX,void 0===U?null:U)||this;E.Nae=0;E.m1=E.SQh(R);E.HXa=G;E.ff=Y;E.aIj=7;E.ol=E.HXa.ownerDocument.createElement("div");E.ol.className="ModalCalloutControlOverlay";E.ol.tabIndex=
0;E.HXa.insertBefore(E.ol,E.HXa.firstChild);return E}function l(E,G,I,R){var Y=w.call(this,document.createElement("div"))||this;Y.Tqa=null;Y.upa=null;Y.vG=null;Y.qG=null;Y.jx=null;Y.bT=null;Y.cT=null;Y.iqa=!1;Y.Dib=!1;Y.Qp=null;Y.content=null;Y.m1=0;Y.Hse=null;Y.jU=0;Y.$Bf=null;Y.mhe=E;Y.Fce=G;Y.rP=I;Y.Vsa=R;Y.Cg=G.ownerDocument;Y.Wib=!1;Y.fv=!1;Y.Qid=!1;return Y}y=b(0);var n=b(15),m=b(82),h=b(157),x=b(13),u=b(90),w=Sys.UI.Control;Wl(l,w);l.prototype.show=function(){this.Wib||(this.s5g(),this.mo(),
this.Fce.appendChild(this.rW),this.rW.style.display="Block",this.mrj(),this.Wib=!0,this.$Bf&&this.$Bf())};l.prototype.dismiss=function(){this.Wib&&(this.d1a(),this.Fce.removeChild(this.rW),this.Wib=!1,this.Vsa&&this.Vsa())};l.prototype.dispose=function(){this.dismiss();this.bT=this.jx=this.qG=this.upa=this.vG=this.Tqa=null;Sys.Component.prototype.dispose.call(this)};l.prototype.oi=function(E){return this.get_element().id+E};l.prototype.s5g=function(){this.vG=this.Cg.createElement("div");this.vG.id=
this.oi("WACCalloutHeader");this.vG.className="WACCalloutHeader";this.fv&&this.zke();this.Qid&&this.Ple();this.qG=this.Cg.createElement("div");this.qG.id=this.oi("WACCalloutContent");this.qG.className="WACCalloutContent";this.qG.style.width=190<this.m1?this.m1-26+"px":"164px";this.qG.appendChild(this.content);this.rW.appendChild(this.t0b);this.rW.appendChild(this.vG);this.rW.appendChild(this.qG)};l.prototype.zke=function(){this.jx=this.Cg.createElement("a");this.jx.className="WACCalloutCloseAnchor";
this.jx.id=this.oi("WACCalloutCloseAnchor");this.jx.href="#";this.vG.appendChild(this.jx);var E=h.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.jx.appendChild(E)};l.prototype.Ple=function(){this.bT=this.Cg.createElement("div");this.bT.className="WACCalloutTitle UIFontBold";this.bT.style.width=190<this.m1?this.m1-30+"px":"160px";this.bT.id=this.oi("WACCalloutTitle");this.bT.innerText=this.title;this.vG.contains(this.jx)?this.vG.insertBefore(this.bT,
this.jx):this.vG.appendChild(this.bT)};l.prototype.mrj=function(){var E=this.mhe;if(1===this.jU){var G=this.Hse.y+16;var I=-16}else 2===this.jU||3===this.jU||0===this.jU?(G=E.y+E.height+15,I=-15):(G=E.y-this.rW.clientHeight-15-2,I=this.rW.clientHeight-1);this.rW.style.top=G+"px";this.t0b.style.top=I+"px";1===this.jU?(E=this.Hse.x-16,this.rW.style.left="50%",this.rW.style.marginLeft=-this.m1/2+"px",G=Sys.UI.DomElement.getBounds(this.rW),this.t0b.style.left=E-G.x+"px"):(G=E.x+this.mhe.width/2,2===this.jU||
5===this.jU?(E=20,G-=36):0===this.jU||4===this.jU?(E=this.m1/2-16,G-=this.m1/2):(E=this.m1-20-32,G=G-this.m1+36),this.rW.style.left=G+"px",this.t0b.style.left=E+"px")};l.prototype.mo=function(){this.fv&&!this.cT&&(this.cT=Object(m.a)(this,this.z$,"closeHandler"),this.rP.pa(x.a.click,this.jx,this.cT,null))};l.prototype.d1a=function(){this.fv&&this.cT&&(this.rP.Aa(x.a.click,this.jx,this.cT),this.cT=null)};l.prototype.z$=function(){this.dismiss();return!0};Ck.Object.defineProperties(l.prototype,{rW:{configurable:!0,
enumerable:!0,get:function(){this.Tqa||(this.Tqa=this.Cg.createElement("div"),this.Tqa.id=this.oi("WACCalloutOuter"),this.Tqa.className="WACCalloutOuter",this.Tqa.setAttribute(u.a.Wd,u.a.eZa),this.Tqa.style.width=this.m1+"px");return this.Tqa}},t0b:{configurable:!0,enumerable:!0,get:function(){if(!this.upa){this.upa=this.Cg.createElement("div");this.upa.id=this.oi("WACCalloutBeakContainer");this.upa.className="WACCalloutBeakContainer";var E="CalloutBeakTopFilled_32x16x32";if(5===this.jU||6===this.jU||
4===this.jU)E="CalloutBeakBottomFilled_32x16x32";E=h.createClusteredImage(32,16,E,"WACCalloutBeak",!0,"");this.upa.appendChild(E)}return this.upa},set:function(E){this.upa=E}},XLa:{configurable:!0,enumerable:!0,get:function(){return this.Wib}},title:{configurable:!0,enumerable:!0,get:function(){return this.Qp},set:function(E){this.Qp!==E&&(this.Qp=E,this.bT&&(this.bT.innerText=this.Qp))}},fv:{configurable:!0,enumerable:!0,get:function(){return this.iqa},set:function(E){this.iqa!==E&&(this.iqa=E,this.vG&&
(this.vG.contains(this.jx)&&!this.iqa?this.vG.removeChild(this.jx):!this.vG.contains(this.jx)&&this.iqa&&this.zke()))}},Qid:{configurable:!0,enumerable:!0,get:function(){return this.Dib},set:function(E){this.Dib!==E&&(this.Dib=E,this.vG&&(this.vG.contains(this.bT)&&!this.Dib?this.vG.removeChild(this.bT):!this.vG.contains(this.bT)&&this.Dib&&this.Ple()))}}});Object(y.a)(l,"Callout",Sys.UI.Control,[122]);Wl(f,l);f.prototype.show=function(){this.XLa||(this.ff.hqc(),this.ff.LP(!1),this.ol.style.zIndex=
String(this.ff.r2),l.prototype.show.call(this),this.Ej(),this.Nae=window.setTimeout(Object(m.a)(this,this.dismiss,"dismiss"),1E3*this.aIj))};f.prototype.dismiss=function(){this.XLa&&(this.ff.uM(!1),this.al(),this.HXa&&this.HXa.contains(this.ol)&&this.HXa.removeChild(this.ol),l.prototype.dismiss.call(this),window.clearTimeout(this.Nae))};f.prototype.Ej=function(){this.ff.Xra(Object(m.a)(this,this.dismiss,"dismiss"));this.ff.Hy.pa(x.a.click,this.ol,Object(m.a)(this,this.xd,"onClick"))};f.prototype.al=
function(){this.ff.dbb(Object(m.a)(this,this.dismiss,"dismiss"));this.ff.Hy.Aa(x.a.click,this.ol,Object(m.a)(this,this.xd,"onClick"))};f.prototype.xd=function(){this.dismiss();return!0};f.prototype.SQh=function(E){var G=0;switch(E){case 0:G=190;break;case 1:G=250;break;case 2:G=300;break;case 3:G=360}return G};Object(y.a)(f,"ModalCallout",l,[]);var v=b(626),t=b(204);Wl(e,f);e.prototype.show=function(){var E=this;if(!this.XLa){var G=Object.assign(new v.a,{onShow:function(){f.prototype.show.call(E)}});
t.UISurfaces.QQ().then(function(I){var R=I.externalNotification();E.uUb=I.addNotification(R,G);return null},function(I){n.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",I);return null})}};e.prototype.dismiss=function(){var E=this;this.XLa&&this.uUb&&(t.UISurfaces.QQ().then(function(G){G.removeNotification(E.uUb);return E.uUb=null},function(G){n.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",G);return null}),f.prototype.dismiss.call(this))};
Object(y.a)(e,"ReactManagedModalCallout",f,[]);var z=b(4);c.b7g=function(E,G,I){var R=void 0===R?null:R;return z.AFrameworkApplication.sa.Qa.lR?new e(E,G,I,3,z.AFrameworkApplication.sa,R):new f(E,G,I,3,z.AFrameworkApplication.sa,R)};Object(y.a)(c,"ModalCalloutControlFactory",null,[]);var D=b(52),A=b(1069),B=b(640),N=b(1070),P=b(135),Q=b(56),M=b(39),ba=b(84),V=b(1017),aa=b(904);b.d(C,"a",function(){return a});a.mCe=function(E,G,I,R){a.cJ&&a.cJ.XLa&&a.cJ.dismiss();a.cJ=c.b7g(G,E,E);a.cJ.content=I;aa.b(R)||
(a.cJ.title=R,a.cJ.Qid=!0);E=new Sys.UI.Bounds(0,0,Q.a.hcc(),Q.a.gcc());a.cJ.jU=a.RIh(E,G,a.cJ.m1);a.cJ.show();a.P_b&&a.P_b.sendNotification(I.innerText,!0)};a.L2c=function(E,G,I,R){R=void 0===R?null:R;t.UISurfaces.QQ().then(function(Y){var U=null;a.Pkb&&(Y.removeNotification(a.Pkb),a.Pkb=null);var ha=Y.callout(Object.assign(new A.a,{target:E,title:G,content:I,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new N.a,{onDismiss:function(){Y.removeNotification(U)},
directionalHint:null!=R?R:null})})),ta=Object.assign(new v.a,{expirationOptions:Object.assign(new B.a,{displayTimeoutSeconds:7,onExpire:function(){Y.removeNotification(a.Pkb)}})});U=a.Pkb=Y.addNotification(ha,ta);return null},function(Y){n.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",Y);return null})};a.TQd=function(E,G){G=void 0===G?null:G;a.cJ&&a.cJ.XLa&&a.cJ.dismiss();var I=new P.StandardDialog;I.YRa=!1;I.ic=0;I.Wz(D.a.lpi,CommonUIStrings.l_DialogError,aa.b(E)?a.PXe():
E,G)};a.VQd=function(E){a.cJ&&a.cJ.XLa&&a.cJ.dismiss();n.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",E.errorCode));var G=aa.b(E.description)?a.PXe():E.description,I=new P.StandardDialog,R=null;E.yha?(I.ic=1,I.Ac(1,E.buttonText),I.s7(1)):I.ic=0;R=function(Y){1===Y?E.yha():E.nia&&E.nia()};I.YRa=!1;0===E.tLa?I.Wz(E.errorCode,E.title?E.title:CommonUIStrings.l_DialogError,G,R):1===E.tLa?I.pX(E.title?E.title:CommonUIStrings.l_DialogWarning,G,R):I.EAa(E.title?
E.title:CommonUIStrings.l_DialogInfo,G,R)};a.RIh=function(E,G,I){var R=4,Y=E.x+E.width-G.x-G.width;G.x-E.x+G.width/2<=I/2?R=5:Y+G.width/2<=I/2&&(R=6);return R};a.oxj=function(E,G,I,R){R=void 0===R?!1:R;(G=V.a.pub(G))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(G,function(Y){Y&&(R||a.L2c(Y,I,E,5))})};a.pxj=function(E,G,I){I=void 0===I?!1:I;a.oxj(G.startedNode?G.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,
E),G,G.startedNode?G.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,E),I)};a.nxj=function(E,G,I,R){if(a.ydg)E=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,I,R,CommonUIStrings.l_InsertionDialogRefresh)),a.L2c(G,E,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{G=M.a.fp(G);var Y=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),U=document.createElement("span");U.innerText=
Y[0];var ha=document.createElement("span");ha.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,I,R,CommonUIStrings.l_InsertionDialogRefresh);ha.className="UIFontBold";I=document.createElement("span");I.innerText=Y[1];R=document.createElement("div");Sys.UI.DomElement.addCssClass(R,"ModalCalloutControl");R.appendChild(U);R.appendChild(ha);R.appendChild(I);a.mCe(E,G,R,CommonUIStrings.l_ErrorLoadingAddInsTitle)}};a.Fyj=function(E,G){var I=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,
R=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;a.ydg?a.L2c(G,I,R):(G=M.a.fp(G),a.mCe(E,G,a.nRg(R),I))};a.nRg=function(E){var G=document.createElement("div");Sys.UI.DomElement.addCssClass(G,"ModalCalloutControl");G.innerText=E;return G};a.PXe=function(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive};Ck.Object.defineProperties(a,{P_b:{configurable:!0,enumerable:!0,get:function(){return a.Yea||(a.Yea=ba.a.instance.Lh("Common.Utils.IAriaNotifier"))}},
ydg:{configurable:!0,enumerable:!0,get:function(){return z.AFrameworkApplication.sa.Qa.Mi&&z.AFrameworkApplication.sa.Qa.lR}}});a.cJ=null;a.Pkb=null;a.Yea=null;Object(y.a)(a,"AddInCommandsNotificationFactory",null,[])},1150:function(y,C,b){function a(t,z,D,A,B){this.Ks=t;this.SI=D;this.D1=A;this.ae=B;this.ihb=this.SI.Ei;this.Oy=this.ihb.getOsfControl(z);this.Krg=this.Oy.getManifest()}function c(t,z,D,A){this._id=t;this.Ks=z;this.D1=D;this.ae=A}function e(t,z,D,A){this.lA=!1;this._id=t;this.Ks=z;this.D1=
D;this.ae=A}b.r(C);y=b(0);var f=b(15),l=b(1479),n=b(153),m=b(124),h=b(933),x=b(942),u=b(355);e.prototype.setEnabled=function(){};e.prototype._OnAccess=function(){};e.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonButton"};e.prototype.invokePropertyGet=function(t){switch(t){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};e.prototype.invokePropertyGetAsync=function(t){t=this.invokePropertyGet(t);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};e.prototype.invokePropertySet=function(t,z){switch(t){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};e.prototype.invokePropertySetAsync=function(t,z){this.invokePropertySet(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};e.prototype.invokeMethod=function(t,z){switch(t){case 5:return this.boj(z);
case 1:return this.jCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};e.prototype.invokeMethodAsync=function(t,z){t=this.invokeMethod(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};e.prototype.boj=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");this.setEnabled(t);return null};e.prototype.jCa=function(){this._OnAccess();return null};Ck.Object.defineProperties(e.prototype,{enabled:{configurable:!0,enumerable:!0,
get:function(){return this.lA},set:function(t){var z=b(1150).DynamicRibbon,D=this.ae.OwnerAddinStoreType,A=this.ae.PrimaryMarketplace.MarketplaceRef,B={};B=(B.addinAssetId=Telemetry.PrivacyRules.GetAssetId(D,A,this.Ks),B.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(D,A,this.ae.OwnerAddinAssetId),B.ownerAddinStoreType=D,B.ribbonControlType="Button",B.toggle=t,B);n.a.sendTelemetryEvent(Object.assign(new u.a,{name:z.Bzc+"ControlUpdate",dataFields:m.a.sl(B)}));this.lA=t;t={};D=(t.DynamicAddinCommandsMethodDispatchId=
1,t.SolutionId=this.Ks,t.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(D,A,this.Ks),t.SourceControlId=this.id,t.MethodData=this.lA,t);this.D1.ZJ(-1014260128,D)}},id:{configurable:!0,enumerable:!0,get:function(){return this._id}},label:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(y.a)(e,"RibbonButton",null,[]);c.prototype.setVisibility=function(t){var z=b(1150).DynamicRibbon,D=this.ae.OwnerAddinStoreType,A=this.ae.PrimaryMarketplace.MarketplaceRef,B={};B=(B.addinAssetId=
Telemetry.PrivacyRules.GetAssetId(D,A,this.Ks),B.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(D,A,this.ae.OwnerAddinAssetId),B.ownerAddinStoreType=D,B.ribbonControlType="Tab",B.toggle=t,B);n.a.sendTelemetryEvent(Object.assign(new u.a,{name:z.Bzc+"ControlUpdate",dataFields:m.a.sl(B)}));z={};t=(z.DynamicAddinCommandsMethodDispatchId=2,z.SolutionId=this.Ks,z.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(D,A,this.Ks),z.StoreType=D,z.SourceControlId=this.id,z.MethodData=t,z);this.D1.ZJ(-1014260128,
t)};c.prototype._OnAccess=function(){};c.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonTab"};c.prototype.invokePropertyGet=function(t){switch(t){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};c.prototype.invokePropertyGetAsync=function(t){t=this.invokePropertyGet(t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};c.prototype.invokePropertySet=function(t){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);
};c.prototype.invokePropertySetAsync=function(t,z){this.invokePropertySet(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};c.prototype.invokeMethod=function(t,z){switch(t){case 3:return this.Rrj(z);case 1:return this.jCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};c.prototype.invokeMethodAsync=function(t,z){t=this.invokeMethod(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};c.prototype.Rrj=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"boolean");this.setVisibility(t);return null};c.prototype.jCa=function(){this._OnAccess();return null};Ck.Object.defineProperties(c.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(y.a)(c,"RibbonTab",null,[]);var w=b(1168),v=b(179);b.d(C,"DynamicRibbon",function(){return a});a.prototype.executeRequestCreate=function(t){try{var z={},D=(z.addinAssetId=Telemetry.PrivacyRules.GetAssetId(this.ae.OwnerAddinStoreType,this.ae.PrimaryMarketplace.MarketplaceRef,this.Ks),
z.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(this.ae.OwnerAddinStoreType,this.ae.PrimaryMarketplace.MarketplaceRef,this.ae.OwnerAddinAssetId),z.ownerAddinStoreType=this.ae.OwnerAddinStoreType,z.ribbonControlType="Ribbon",z);n.a.sendTelemetryEvent(Object.assign(new u.a,{name:a.Bzc+"ExecuteRequestCreate",dataFields:m.a.sl(D)}));var A=v.a.ni(t);t={};z={};z[h.a.wIa]=this.Oy;z[h.a.xIa]=A;z[h.a.U6c]=this.ae;t[h.a.Asb]=3;t[h.a.Y3]=this.Ks;t[h.a.n7b]=Telemetry.PrivacyRules.GetAssetId(this.ae.OwnerAddinStoreType,
this.ae.PrimaryMarketplace.MarketplaceRef,this.Ks);t[h.a.X3]=z;this.D1.ZJ(-1014260128,t);var B=a.H$b("ExecuteRequestCreate",!0,"");f.ULS.sendTraceTag(538572826,0,50,B)}catch(N){A=a.H$b("ExecuteRequestCreate",!1,N.toString()),f.ULS.sendTraceTag(538572825,0,50,A)}return null};a.prototype.executeRequestUpdate=function(t){try{var z=null,D=null;z=this.ae.OwnerAddinStoreType;D=this.ae.PrimaryMarketplace.MarketplaceRef;var A={},B=(A.addinAssetId=Telemetry.PrivacyRules.GetAssetId(z,D,this.Ks),A.ownerAddinAssetId=
Telemetry.PrivacyRules.GetAssetId(z,D,this.ae.OwnerAddinAssetId),A.ownerAddinStoreType=this.ae.OwnerAddinStoreType,A.ribbonControlType="Ribbon",A);n.a.sendTelemetryEvent(Object.assign(new u.a,{name:a.Bzc+"ExecuteRequestUpdate",dataFields:m.a.sl(B)}));var N=v.a.ni(t);t={};A={};A[h.a.wIa]=this.Oy;A[h.a.xIa]=N;A[h.a.U6c]=this.ae;t[h.a.Asb]=3;t[h.a.Y3]=this.Ks;t[h.a.n7b]=Telemetry.PrivacyRules.GetAssetId(z,D,this.Ks);t[h.a.X3]=A;this.D1.ZJ(-1014260128,t);var P=a.H$b("ExecuteRequestUpdate",!0,"");f.ULS.sendTraceTag(538572824,
0,50,P)}catch(Q){z=a.H$b("ExecuteRequestUpdate",!1,Q.toString()),f.ULS.sendTraceTag(538572823,0,50,z)}return null};a.prototype.getButton=function(t){var z=null;if(!this.Tbf())return this.oCe();if(t&&0<t.length){if(!this.uxe(t))return this.HCe(t);z=new e(t,this.Ks,this.D1,this.ae)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(z)};a.prototype.getTab=function(t){var z=null;if(!this.Tbf())return this.oCe();if(this.Oy.getOwnerAddinControlRecreated())return this.q6g();if(t&&0<t.length){if(!this.uxe(t))return this.HCe(t);
z=new c(t,this.Ks,this.D1,this.ae)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(z)};a.prototype._OnAccess=function(){};a.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.DynamicRibbon"};a.prototype.invokePropertyGet=function(t){switch(t){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};a.prototype.invokePropertyGetAsync=function(t){t=this.invokePropertyGet(t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};
a.prototype.invokePropertySet=function(t){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};a.prototype.invokePropertySetAsync=function(t,z){this.invokePropertySet(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};a.prototype.invokeMethod=function(t){switch(t){case 1:return this.jCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};a.prototype.invokeMethodAsync=function(t,z){switch(t){case 7:return this.swh(z);case 6:return this.twh(z);
case 3:return this.wIh(z);case 5:return this.uXh(z)}t=this.invokeMethod(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};a.prototype.swh=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.executeRequestCreate(t)};a.prototype.twh=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.executeRequestUpdate(t)};a.prototype.wIh=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,
0,"string");return this.getButton(t)};a.prototype.uXh=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.getTab(t)};a.prototype.jCa=function(){this._OnAccess();return null};a.prototype.HCe=function(t){return w.a(x.a.X1g,v.a.ga(1743)+t)};a.prototype.oCe=function(){return w.a(x.a.egj,v.a.ga(1739))};a.prototype.q6g=function(){return w.a(x.a.hostRestartNeeded,v.a.ga(1744))};a.prototype.Tbf=function(){var t=this.Oy.getSharedRuntimeId();t=!!t&&0<t.length;f.ULS.sendTraceTag(538572822,
0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",t));return t};a.prototype.uxe=function(t){var z=this.Krg.getRibbonExtensionControlMap();return t in z||this.eWg(t)};a.prototype.eWg=function(t){var z=this.bAh();if(z){z=Gl(z.pJe.tabs);for(var D=z.next();!D.done;D=z.next()){D=D.value;if(D.id===t)return!0;D=Gl(D.groups);for(var A=D.next();!A.done;A=D.next()){A=Gl(A.value.controls);for(var B=A.next();!B.done;B=A.next()){B=B.value;if(B.id===t)return!0;if("Menu"===B.type){B=
Gl(B.items);for(var N=B.next();!N.done;N=B.next())if(N.value.id===t)return!0}}}}}return!1};a.prototype.bAh=function(){return l.a.getInstance().Ria(this.ae.PrimaryMarketplace.MarketplaceType,this.ae.PrimaryMarketplace.SolutionId,1)};a.H$b=function(t,z,D){var A={};A.methodName="DynamicRibbon."+t;A.result=z?"Succeeded":"Failed";A.message=D;return v.a.Jc(A)};Ck.Object.defineProperties(a.prototype,{buttons:{configurable:!0,enumerable:!0,get:function(){return null}}});a.Bzc="Office.Online.Extensibility.Ribbon.";
Object(y.a)(a,"DynamicRibbon",null,[])},1164:function(y,C,b){function a(){}b.d(C,"a",function(){return a});y=b(0);a.T8b="extId";a.qAe="ComponentType";a.gHa="ComponentId";a.Ojd="HostProps";a.Jya="OptionalProps";Object(y.a)(a,"ActionPropertyNames",null,[])},1166:function(y,C,b){function a(c,e){var f=!1;c&&(c=e.osfControl,(e=c.getManifest())&&e.getSharedRuntimeForCustomFunctions("Workbook")&&!c.getIsUpgrading()&&(f=!0));return f}b.d(C,"a",function(){return a})},1167:function(y,C,b){function a(){this.token=
null;this.errorCode=0;this.expiresOn=this.iha=this.WSa=this.led=this.Bgd=this.ewb=this.DUd=null}b.d(C,"a",function(){return a});y=b(0);Object(y.a)(a,"AppsForOfficeOauthResult",null,[])},1168:function(y,C,b){function a(c,e){return OfficeExtension.WacRuntime.Utility.createPromise(function(f,l){l(OfficeExtension.WacRuntime.Utility.createRichApiException(c,e))})}b.d(C,"a",function(){return a})},1302:function(y,C,b){function a(la,$a,Ra){this.Iwa=!1;this.eF={};this.$=la;this.wj=$a;this.Gld().lna();this.indexedDB=
Ra;this.indexedDB.Sf()&&(this.Iwa=!0,this.indexedDB.initialize(a.Mkd,a.Nkd))}function c(la,$a){this.EQc=la;this._message=$a}function e(){}function f(){}function l(la){switch(la){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function n(la,$a){v(b(1302).CustomFunctionsInstaller.RZe("CustomFunctionsRuntimeLogging"),function(Ra){if(Ra.result&&window.console)switch(Ra=l(la.severity)+" "+la.message+$a,la.severity){case 2:window.console.log&&window.console.log(Ra);
break;case 0:window.console.info&&window.console.info(Ra);break;case 1:window.console.error&&window.console.error(Ra)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")}function m(la,$a,Ra,eb,mb){Ra=la.CWCT(function(){$a(la)},Ra,3,eb);Ra.continueWith(function(){Q.ULS.sendTraceTag(537163459,0,10,mb)},4);return Ra}function h(la,$a,Ra){return m(la,$a,xa.a.none,oa.a.current,Ra)}function x(la,$a,Ra,eb,mb){Ra=la.CWRCT(function(){return $a(la)},Ra,
3,eb);Ra.continueWith(function(){Q.ULS.sendTraceTag(537163460,0,10,mb)},4);return Y.TaskExtensions.bBc(Ra)}function u(la,$a,Ra){return x(la,$a,xa.a.none,oa.a.current,Ra)}function w(la,$a,Ra,eb,mb){Ra=la.CWRCT(function(){return $a(la)},Ra,3,eb);Ra.continueWith(function(){Q.ULS.sendTraceTag(537163461,0,10,mb)},4);return Ra}function v(la,$a,Ra){return w(la,$a,xa.a.none,oa.a.current,Ra)}function t(la,$a,Ra,eb,mb){Ra=la.CWRCT(function(){return $a(la)},Ra,3,eb);Ra.continueWith(function(){Q.ULS.sendTraceTag(537163462,
0,10,mb)},4);return Y.TaskExtensions.bBc(Ra)}function z(la,$a,Ra){return t(la,$a,xa.a.none,oa.a.current,Ra)}function D(la,$a,Ra,eb,mb){Ra=la.CWCT(function(){$a(la)},Ra,3,eb);Ra.continueWith(function(){Q.ULS.sendTraceTag(537163463,0,10,mb)},4);return Ra}function A(la,$a,Ra){return D(la,$a,xa.a.none,oa.a.current,Ra)}function B(){}function N(la){la=la.split("|");this.Ks=la[1];this.gRc=la[2];this.xTd=la[3]}b.r(C);y=b(0);var P=b(7),Q=b(15),M=b(4),ba=b(162),V=b(202),aa=b(85),E=b(560),G=b(175),I=b(83),R=
b(51),Y=b(37),U=b(221),ha=b(121),ta=b(590);Ck.Object.defineProperties(N.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Ks}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.gRc}},needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.xTd===OSF.StoreTypeEnum.Registry.toString()}}});Object(y.a)(N,"AddinStoreInfo",null,[]);Object(y.a)(B,"CustomFunctionRegistrationInfos",null,[]);var xa=b(212),oa=b(62),qa=b(1166);Object(y.a)(f,
"InstallationInfo",null,[]);Object(y.a)(e,"UninstallationInfo",null,[]);var Ea=b(28),ka=b(95),za=b(35),La=b(30),Ia=b(1),Ya=b(21),tb=b(292),Tb=b(993),va=b(58);Ck.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.EQc}},message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});Object(y.a)(c,"CustomFunctionLog",null,[]);b.d(C,"CustomFunctionsInstaller",function(){return a});a.prototype.t$e=function(la,$a,Ra,eb){var mb=this;if(eb.invariantNamespace)for(var Pa=
0;Pa<eb.invariantNamespace.length;++Pa){var Da=eb.invariantNamespace.charAt(Pa);if("."!==Da&&"_"!==Da&&"a">Da&&"z"<Da&&"A">Da&&"Z"<Da&&"0">Da&&"9"<Da)throw Q.ULS.sendTraceTag(537163552,0,10,"CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",Da,Pa),Error.create("InvariantNamespace validation failed");}return z(this.vSg(Ra,eb.manifest),function(){return z(mb.kGd(la),function(Ta){var Sa=Ta.result;return(null===Sa||void 0===Sa?0:Sa.isDynamicMetadata)?
mb.kHd(la,$a,Sa,!1,!1,!1):z(mb.gWj(la,$a,eb),function(Cb){var cc;Sa=(cc=new f,cc.addinId=Ra,cc.locale=eb.locale,cc.addinInvariantNamespace=eb.invariantNamespace,cc.addinNamespace=eb.namespace,cc.addinTitle=eb.title,cc.isXllCompatible=eb.isXllCompatible,cc.metadataContent=JSON.stringify(JSON.parse(Cb.result)),cc);return mb.kHd(la,$a,Sa,!1,a.vxh(eb.osfControl.getStoreType()),qa.a(mb.$,eb))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed")},
"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")};a.prototype.v$e=function(la,$a,Ra,eb){var mb=this;if(!a.Pqd(Ra))throw Q.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return z(this.kGd(la),function(Pa){Pa=Pa.result;if(!Pa&&(Pa=za.a.Nc(mb.JV,la),!Pa))throw Q.ULS.sendTraceTag(537163550,0,10,String.format("CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId {0} hasn't been installed yet.",
Telemetry.PrivacyRules.GetPrivacyCompliantId(la,$a,null))),Error.create("Customfunctions dynamic registration failed");Pa.metadataContent=JSON.stringify(JSON.parse(Ra));Pa.isDynamicMetadata=!0;return mb.kHd(la,$a,Pa,!0,!0,eb)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")};a.prototype.iag=function(la,$a){var Ra=this;this.wj.zia();var eb=Object(P.a)(new e,{solutionId:la}),mb=String.format("CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",
Telemetry.PrivacyRules.GetPrivacyCompliantId(la,$a,null));return z(this.THd(la),function(){return z(Ra.$Hd(la),function(){return Ra.gXd(Ra.wj,la,$a,eb)},"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed")},mb)};a.prototype.gWj=function(la,$a,Ra){var eb=new ba.a;OSF.OUtil.xhrGet(Ra.metadataUrl,function(mb){mb?eb.setResult(mb):eb.setException(Error.create("Invalid manifest"))},function(mb){Q.ULS.sendTraceTag(537163548,0,10,"CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",
Telemetry.PrivacyRules.GetPrivacyCompliantId(la,$a,null),mb);eb.setException(Error.create("Failed to download manifest"))});return eb.task};a.prototype.Gld=function(){var la=this;return z(this.jrc(),function($a){var Ra=$a.result;if(!Ra.length)return va.Task.Sa(!0);Q.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");$a=new V.a;for(var eb=[],mb={},Pa=0;Pa<Ra.length;mb={KPb:mb.KPb},Pa++)mb.KPb=Object(aa.a)(String,Ra[Pa]),
$a.add(v(la.kGd(mb.KPb),function(Da){return function(Ta){if(Ta=Ta.result){var Sa=za.a.Nc(la.eF,Ta.addinId);Sa&&Sa===Ta.metadataContent||(la.eF[Ta.addinId]=Ta.metadataContent,la.JV[Da.KPb]=Ta,eb.push(Ta))}return!0}}(mb),"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"));return u(va.Task.WAE($a),function(){if(eb.length){var Da,Ta=(Da=new B,Da.registrationInfos=eb,Da);return la.s0b(la.wj,Ra,Ta)}Q.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");
return va.Task.Sa(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")};a.prototype.w$e=function(){var la=this,$a=new ba.a;new V.a;var Ra=[],eb=[];Object.keys(this.JV).forEach(function(mb){mb=Object(aa.a)(String,mb);var Pa=za.a.Nc(la.JV,mb);Ra.push(Pa);eb.push(mb)});if(!eb.length)return $a.setResult(!0),$a.task;$a=Object(P.a)(new B,{registrationInfos:Ra});return this.s0b(this.wj,eb,$a)};a.prototype.jrc=
function(){return v(this.Fed(ta.a.IYa),function(la){la=la.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(la||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(la||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")};a.prototype.Tfg=function(la){return this.pOd(ta.a.IYa,Sys.Serialization.JavaScriptSerializer.serialize(la))};a.prototype.kGd=function(la){return z(this.Fed(ta.a.L3a(la)),function($a){$a=
$a.result||"";return 0<$a.length?va.Task.Sa(Sys.Serialization.JavaScriptSerializer.deserialize($a,!0)):va.Task.Sa(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")};a.prototype.$Vj=function(la,$a){var Ra=this;return z(this.WKe(la),function(){return z(Ra.pOd(ta.a.L3a(la),Sys.Serialization.JavaScriptSerializer.serialize($a)),function(){return a.qOd(ta.a.yid,"true")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed")},
"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.THd=function(la){var $a=this;return z(this.PNf(la),function(){return z($a.gOf(ta.a.L3a(la)),function(){return z($a.jrc(),function(Ra){return Ra.result.length?va.Task.Sa(!0):a.qOd(ta.a.yid,"false")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed")},
"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.fLf=function(la){return this.Fed(ta.a.K3a(la))};a.prototype.Qfg=function(la,$a){var Ra=this;return z(this.WKe(la),function(){return Ra.pOd(ta.a.K3a(la),$a)},"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.$Hd=function(la){var $a=this;return z(this.PNf(la),function(){return $a.gOf(ta.a.K3a(la))},"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};
a.prototype.WKe=function(la){var $a=this;return z(this.jrc(),function(Ra){Ra=Ra.result;var eb=la.toLowerCase();if(Array.contains(Ra,eb))return va.Task.Sa(!0);Ra.push(eb);return $a.Tfg(Ra)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.PNf=function(la){var $a=this;return z(this.jrc(),function(Ra){Ra=Ra.result;var eb=la.toLowerCase();return Array.contains(Ra,eb)?(Ra.splice(Array.indexOf(Ra,eb),1),$a.Tfg(Ra)):va.Task.Sa(!0)},
"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.vSg=function(la,$a){if(Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return la=new OSF.AddinIdInfo(la),la.needToRestoreManifest()?this.Qfg(la.getSolutionId(),$a):va.Task.Sa(!0);la=new N(la);return la.needToRestoreManifest?this.Qfg(la.solutionId,$a):va.Task.Sa(!0)};a.prototype.Hfj=function(la){var $a=this;if(Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){var Ra=
new OSF.AddinIdInfo(la);return Ra.needToRestoreManifest()?v(this.fLf(Ra.getSolutionId()),function(mb){(mb=mb.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Ra.getSolutionId(),Ra.getSolutionVersion(),mb,$a.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):va.Task.Sa(!0)}var eb=new N(la);return eb.needToRestoreManifest?v(this.fLf(eb.solutionId),function(mb){(mb=mb.result)&&OSF.OsfManifestManager.cacheManifestFromXml(eb.solutionId,
eb.solutionVersion,mb,$a.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):va.Task.Sa(!0)};a.prototype.gOf=function(la){return this.Iwa?this.indexedDB.F5c(la):a.Y8i(la)};a.prototype.pOd=function(la,$a){return this.Iwa?this.indexedDB.Tbb(new Tb.a(la,$a)):a.qOd(la,$a)};a.prototype.Fed=function(la){return this.Iwa?this.indexedDB.E3a(la):a.RZe(la)};a.prototype.kHd=function(la,$a,Ra,eb,mb,Pa){var Da=this,Ta=String.format("CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: {0}.",
Telemetry.PrivacyRules.GetPrivacyCompliantId(la,$a,null));return Y.TaskExtensions.bBc(v(this.lHd(this.wj,la,$a,Ra,!1,eb,Pa),function(){return mb?Da.$Vj(la,Ra):va.Task.Sa(!0)},Ta))};a.prototype.lHd=function(la,$a,Ra,eb,mb,Pa,Da){var Ta=this;if(!Pa&&(Pa=za.a.Nc(this.eF,eb.addinId))&&Pa===eb.metadataContent)return va.Task.Sa(!0);this.eF[eb.addinId]=eb.metadataContent;this.JV[$a]=eb;Da||la.yHb($a);la.zia();return z(this.B6i($a,Ra,eb),function(){return Ta.YEd(eb.addinId,mb)},"Failed to register functions for customfunction addin")};
a.prototype.B6i=function(la,$a,Ra){var eb=this,mb=new ba.a,Pa=this.Zob(Ra);return this.Jia(function(Da){Ia.EwaSettings.ma(257)&&n(a.Hrb,la);(Da=Da.Result)&&204===Da.ResponseStatusCode?mb.setResult(!0):(delete eb.eF[Ra.addinId],delete eb.JV[la],A(eb.THd(la),function(){A(eb.$Hd(la),function(){eb.l2f()},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",la,Da?Da.ResponseStatusCode.toString():
"Unknown")),mb.setResult(!1))},function(Da){Da=ha.a.ig(Da.data);Q.ULS.sendTraceTag(537163544,0,10,"CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(la,$a,null),La.a.Tc(Da));Ia.EwaSettings.ma(257)&&n(a.Grb,la);delete eb.eF[Ra.addinId];delete eb.JV[la];mb.setResult(!1)},Pa,mb,!0)};a.prototype.s0b=function(la,$a,Ra){var eb=this,mb=new ba.a,Pa=Ea.a.Ua.oe.m;$a.forEach(function(Ta){Ta=
Object(aa.a)(String,Ta);la.bxe(Ta)});la.zia();var Da=this.xYc(Ra);return this.Jia(function(Ta){Ia.EwaSettings.ma(257)&&n(a.Hrb,Sys.Serialization.JavaScriptSerializer.serialize($a));Ta=Ta.Result;var Sa=!0,Cb=Sys.Serialization.JavaScriptSerializer.deserialize(Ta.ResponseBody.toString());Cb=Array.isArray(Cb.value)?Cb.value:null;for(var cc=new V.a,nc={Qea:0};nc.Qea<Cb.length;nc={Qea:nc.Qea},nc.Qea++)if(!Cb[nc.Qea]){Sa=!1;var Nb=String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code {0}.",
Ta.ResponseStatusCode);cc.add(z(eb.THd($a[nc.Qea]),function(nb){return function(){delete eb.eF[Ra.registrationInfos[nb.Qea].addinId];delete eb.JV[$a[nb.Qea]];return eb.$Hd($a[nb.Qea])}}(nc),Nb))}h(va.Task.WAE(cc),function(){A(eb.YEd("",!1),function(){Q.ULS.sendTraceTag(537163542,0,50,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes {0} Millisecond.",Ea.a.Ua.oe.m-Pa);Sa?mb.setResult(Sa):h(eb.l2f(),function(){mb.setResult(Sa)},"Failed to show customfunctions installation error info")},
String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"))},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},function(Ta){Ta=ha.a.ig(Ta.data);Q.ULS.sendTraceTag(537163541,0,10,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: {0}.",La.a.Tc(Ta));Ia.EwaSettings.ma(257)&&n(a.Grb,Sys.Serialization.JavaScriptSerializer.serialize($a));
for(Ta=0;Ta<Ra.registrationInfos.length;Ta++)delete eb.eF[Ra.registrationInfos[Ta].addinId],delete eb.JV[$a[Ta]];mb.setResult(!1)},Da,mb,!0)};a.prototype.gXd=function(la,$a,Ra,eb){var mb=this;return z(this.oNj(la,$a,Ra,eb),function(){return mb.YEd(eb.solutionId,!1)},"Failed to unregister functions for customfunction addin")};a.prototype.oNj=function(la,$a,Ra,eb){var mb=new ba.a;la.yHb($a);(la=za.a.Nc(this.JV,$a))&&delete this.eF[la.addinId];delete this.JV[$a];eb=this.JYc(eb);return this.Jia(function(){Ia.EwaSettings.ma(257)&&
n(a.D4c,$a);mb.setResult(!0)},function(Pa){Pa=ha.a.ig(Pa.data);Q.ULS.sendTraceTag(537163539,0,10,"CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId($a,Ra,null),La.a.Tc(Pa));Ia.EwaSettings.ma(257)&&n(a.C4c,$a);mb.setResult(!1)},eb,mb,!1)};a.prototype.Jia=function(la,$a,Ra,eb,mb){function Pa(){function nc(db,Bb,zc){Ia.EwaSettings.ma(257)&&n(mb?a.B4c:a.E4c,Nb.RequestBody);return I.i(Ta.va,
"ExecuteRichApiRequest",Ra,tb.b(db,la),tb.a(Bb,$a),zc,null,0)}if(Da.mHa()||0<Ta.va.h4||0<Ta.Mk.h4)return!1;Sa&&Da.Ul(Sa);Cb&&Ta.Ar(Cb);cc&&Ta.Qz(cc);var Nb=Ra.request,nb=0;Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Nb.RequestFlags&1&&256!==(Nb.RequestFlags&256)||(nb=16):nb=Nb.RequestFlags&1?0:16;Ia.EwaSettings.qc()?Da.Zt(new G.a(507,0,nc,nb|64)):Da.Zt(new E.a(507,0,nc,nb));return!0}var Da=this.$.userOperationManager,Ta=this.$.na,Sa=null,Cb=null,cc=null;
Pa()||(Sa=function(){Pa()},Cb=function(){Pa()},cc=function(){Pa()},Da.xq(Sa),Ta.zq(Cb),Ta.Uy(cc));return eb.task};a.prototype.Zob=function(la){var $a={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};$a.RequestBody=JSON.stringify(la);$a.RequestFlags=1;Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&($a.RequestFlags|=256);la=this.$.na.va.Na(1);la.request=$a;return la};a.prototype.xYc=function(la){var $a={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",
RequestHeaders:null};$a.RequestBody=JSON.stringify(la);$a.RequestFlags=1;Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&($a.RequestFlags|=256);la=this.$.na.va.Na(1);la.request=$a;return la};a.prototype.JYc=function(la){var $a={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};$a.RequestBody=JSON.stringify(la);$a.RequestFlags=1;Ia.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&($a.RequestFlags|=
256);la=this.$.na.va.Na(1);la.request=$a;return la};a.prototype.YEd=function(la,$a){var Ra=this,eb=R.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);return t(eb,function(){eb.result.hKd();return la&&$a?Ra.Hfj(la):va.Task.Sa(!0)},this.$.la,U.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")};a.prototype.l2f=function(){var la=new ka.a(1949669462,0,this.$.Xc,0,null);return this.$.Ka.Wb(la)};a.RZe=function(la){try{return va.Task.Sa(localStorage.getItem(la))}catch($a){return Q.ULS.sendTraceTag(537163537,
0,50,"CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: {0}",$a.message||"Unknown"),va.Task.Sa(null)}};a.qOd=function(la,$a){try{return localStorage.setItem(la,$a),va.Task.Sa(!0)}catch(Ra){return Q.ULS.sendTraceTag(537163536,0,50,"CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: {0}",Ra.message||"Unknown"),va.Task.Sa(!1)}};a.Y8i=function(la){try{return localStorage.removeItem(la),va.Task.Sa(!0)}catch($a){return Q.ULS.sendTraceTag(537163535,
0,50,"CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: {0}",$a.message||"Unknown"),va.Task.Sa(!1)}};a.vxh=function(la){return Ya.a.equals(la,"registry",!0)||Ya.a.equals(la,"uploadfiledevcatalog",!0)||M.AFrameworkApplication.userNameUnknown||M.AFrameworkApplication.limitedEdit};a.Pqd=function(la){if(!la)return!1;try{JSON.parse(la)}catch($a){return!1}return!0};Ck.Object.defineProperties(a.prototype,{JV:{configurable:!0,enumerable:!0,get:function(){return this.wj.JV}}});
a.Mkd="CustomFunctionCache";a.Nkd="CustomFunction";a.B4c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Hrb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.Grb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.E4c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.D4c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.C4c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(y.a)(a,
"CustomFunctionsInstaller",null,[505])},1304:function(y,C,b){function a(U){this.eF={};this.$=U;this.Gld().lna()}function c(U,ha){this.EQc=U;this._message=ha}function e(){}function f(){}function l(U){switch(U){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function n(U,ha){if(b(1304).CustomFunctionsLegacyInstaller.uvb("CustomFunctionsRuntimeLogging")&&window.console)switch(ha=l(U.severity)+" "+U.message+ha,U.severity){case 2:window.console.log&&window.console.log(ha);
break;case 0:window.console.info&&window.console.info(ha);break;case 1:window.console.error&&window.console.error(ha)}}function m(){}function h(U){U=U.split("|");this.Ks=U[1];this.gRc=U[2];this.xTd=U[3]}b.r(C);y=b(0);var x=b(7),u=b(15),w=b(1140),v=b(162),t=b(85),z=b(560),D=b(175),A=b(83),B=b(51),N=b(37),P=b(121),Q=b(590),M=b(1166);Ck.Object.defineProperties(h.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Ks}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.gRc}},
needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.xTd===OSF.StoreTypeEnum.Registry.toString()}}});Object(y.a)(h,"AddinStoreInfo",null,[]);Object(y.a)(m,"CustomFunctionRegistrationInfos",null,[]);Object(y.a)(f,"InstallationInfo",null,[]);Object(y.a)(e,"UninstallationInfo",null,[]);var ba=b(158),V=b(35),aa=b(30),E=b(1),G=b(14),I=b(292),R=b(1073),Y=b(58);Ck.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.EQc}},message:{configurable:!0,
enumerable:!0,get:function(){return this._message}}});Object(y.a)(c,"CustomFunctionLog",null,[]);b.d(C,"CustomFunctionsLegacyInstaller",function(){return a});a.prototype.t$e=function(U,ha,ta,xa){var oa=this,qa=new v.a;if(xa.invariantNamespace)for(ha=0;ha<xa.invariantNamespace.length;++ha){var Ea=xa.invariantNamespace.charAt(ha);if("."!==Ea&&"_"!==Ea&&"a">Ea&&"z"<Ea&&"A">Ea&&"Z"<Ea&&"0">Ea&&"9"<Ea)return u.ULS.sendTraceTag(537163530,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",
Ea,ha),qa.setResult(!1),qa.task}a.cacheManifest(ta,xa.manifest);var ka=a.lGd(U);(null===ka||void 0===ka?0:ka.isDynamicMetadata)?this.jHd(U,ka,qa,!1,!1):OSF.OUtil.xhrGet(xa.metadataUrl,function(za){ka=Object(x.a)(new f,{addinId:ta,locale:xa.locale,addinInvariantNamespace:xa.invariantNamespace,addinNamespace:xa.namespace,addinTitle:xa.title,isXllCompatible:xa.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(za))});oa.jHd(U,ka,qa,!1,M.a(oa.$,xa))},function(za){u.ULS.sendTraceTag(537163528,0,
10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",U,za);qa.setResult(!1)});return qa.task};a.prototype.v$e=function(U,ha,ta,xa){ha=new v.a;if(!a.Pqd(ta))return u.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),ha.setResult(!1),ha.task;var oa=a.lGd(U);if(!oa)return u.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),
ha.setResult(!1),ha.task;oa.metadataContent=JSON.stringify(JSON.parse(ta));oa.isDynamicMetadata=!0;this.jHd(U,oa,ha,!0,xa);return ha.task};a.prototype.iag=function(U){var ha=this,ta=new v.a,xa=B.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);N.TaskExtensions.Ba(xa,function(){var oa=xa.result;oa.zia();var qa=Object(x.a)(new e,{solutionId:U});a.UHd(U);a.aId(U);N.TaskExtensions.Ba(ha.gXd(oa,U,qa),function(Ea){ba.b(Ea)?ta.setResult(Ea.result):(Ea.kg?u.ULS.sendTraceTag(537163524,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",
U):Ea.Ph&&u.ULS.sendTraceTag(537163523,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: {0}.",U),ta.setResult(!1))},ha.$.la,0)},this.$.la,3);return ta.task};a.prototype.Gld=function(){var U=this,ha=new v.a,ta=a.pGd();0<ta.length&&u.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");var xa=[];ta.forEach(function(qa){qa=Object(t.a)(String,qa);if(qa=a.lGd(qa)){var Ea=
V.a.Nc(U.eF,qa.addinId);Ea&&Ea===qa.metadataContent||(U.eF[qa.addinId]=qa.metadataContent,xa.push(qa))}});if(!xa.length)return ha.setResult(!0),u.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),ha.task;var oa=B.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);N.TaskExtensions.Ba(oa,function(){var qa=oa.result,Ea=Object(x.a)(new m,{registrationInfos:xa});N.TaskExtensions.Ba(U.s0b(qa,ta,Ea),function(ka){ba.b(ka)?
ha.setResult(ka.result):(ka.kg?u.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):ka.Ph&&u.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),ha.setResult(!1))},U.$.la,0)},this.$.la,3);return ha.task};a.prototype.Gfj=function(U){U=new h(U);if(U.needToRestoreManifest){var ha=a.c4i(U.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(U.solutionId,
U.solutionVersion,ha,this.$.ya.UICultureTag)}};a.prototype.jHd=function(U,ha,ta,xa,oa){var qa=this,Ea=B.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);N.TaskExtensions.Ba(Ea,function(){N.TaskExtensions.Ba(qa.lHd(Ea.result,U,ha,!1,xa,oa),function(ka){ba.b(ka)?((ka=ka.result)&&a.aWj(U,ha),ta.setResult(ka)):(ka.kg?u.ULS.sendTraceTag(537163488,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: {0}.",U):ka.Ph&&u.ULS.sendTraceTag(537163487,0,10,
"CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: {0}.",U),ta.setResult(!1))},qa.$.la,0)},this.$.la,3)};a.prototype.lHd=function(U,ha,ta,xa,oa,qa){var Ea=this;if(!oa&&(oa=V.a.Nc(this.eF,ta.addinId))&&oa===ta.metadataContent)return Y.Task.Sa(!0);this.eF[ta.addinId]=ta.metadataContent;var ka=new v.a;qa||U.yHb(ha);U.zia();U=this.Zob(ta);return this.Jia(function(za){E.EwaSettings.ma(257)&&n(a.Hrb,ha);var La=za.Result;204===La.ResponseStatusCode?N.TaskExtensions.Ba(Ea.XEd(ka,
ta.addinId,xa),function(Ia){Ia.kg?ha?u.ULS.sendTraceTag(537163485,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}.",ha):u.ULS.sendTraceTag(537163484,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId {0}.",ta.addinId):Ia.Ph&&(ha?u.ULS.sendTraceTag(537163483,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution {0}.",
ha):u.ULS.sendTraceTag(537163482,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId {0}.",ta.addinId));ka.setResult(!1)},Ea.$.la,4):(za=function(){delete Ea.eF[ta.addinId];a.UHd(ha);a.aId(ha);u.ULS.sendTraceTag(537163481,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",ha,La.ResponseStatusCode);ka.setResult(!1)},za=Object(x.a)(new R.a,{tLa:OSF.InfoType.Error,
title:ta.addinTitle,description:String.format(G.a.instance.Bb(153),G.a.instance.ga(1862)),buttonText:G.a.instance.ga(4),yha:za,Jdc:!1,nia:za,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),w.a.VQd(za))},function(za){za=P.a.ig(za.data);u.ULS.sendTraceTag(537163480,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",ha,aa.a.Tc(za));E.EwaSettings.ma(257)&&n(a.Grb,ha);delete Ea.eF[ta.addinId];ka.setResult(!1)},
U,ka,!0)};a.prototype.s0b=function(U,ha,ta){var xa=this,oa=new v.a;ha.forEach(function(Ea){Ea=Object(t.a)(String,Ea);U.bxe(Ea)});U.zia();var qa=this.xYc(ta);return this.Jia(function(Ea){E.EwaSettings.ma(257)&&n(a.Hrb,Sys.Serialization.JavaScriptSerializer.serialize(ha));Ea=Ea.Result;var ka=!0,za=Sys.Serialization.JavaScriptSerializer.deserialize(Ea.ResponseBody.toString());za=Array.isArray(za.value)?za.value:null;for(var La=0;La<za.length;La++)za[La]||(ka=!1,delete xa.eF[ta.registrationInfos[La].addinId],
a.UHd(ha[La]),a.aId(ha[La]),u.ULS.sendTraceTag(537163478,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: {0}. Received status code {1}.",ha[La],Ea.ResponseStatusCode));N.TaskExtensions.Ba(xa.XEd(oa,"",!1),function(Ia){Ia.kg?u.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):Ia.Ph&&u.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");
oa.setResult(!1)},xa.$.la,4);oa.setResult(ka)},function(Ea){Ea=P.a.ig(Ea.data);u.ULS.sendTraceTag(537163475,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds {0}. Errors: {1}.",Sys.Serialization.JavaScriptSerializer.serialize(ha),aa.a.Tc(Ea));E.EwaSettings.ma(257)&&n(a.Grb,Sys.Serialization.JavaScriptSerializer.serialize(ha));Ea=Gl(ta.registrationInfos);for(var ka=Ea.next();!ka.done;ka=Ea.next())delete xa.eF[ka.value.addinId];
oa.setResult(!1)},qa,oa,!0)};a.prototype.gXd=function(U,ha,ta){var xa=this,oa=new v.a;U.yHb(ha);U=this.JYc(ta);return this.Jia(function(){E.EwaSettings.ma(257)&&n(a.D4c,ha);N.TaskExtensions.Ba(xa.XEd(oa,ta.solutionId,!1),function(qa){qa.kg?ha&&u.ULS.sendTraceTag(537163473,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}.",ha):qa.Ph&&ha&&u.ULS.sendTraceTag(537163472,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution {0}.",
ha);oa.setResult(!1)},xa.$.la,4)},function(qa){qa=P.a.ig(qa.data);u.ULS.sendTraceTag(537163471,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",ha,aa.a.Tc(qa));E.EwaSettings.ma(257)&&n(a.C4c,ha);oa.setResult(!1)},U,oa,!1)};a.prototype.Jia=function(U,ha,ta,xa,oa){function qa(){function Ya(va,la,$a){E.EwaSettings.ma(257)&&n(oa?a.B4c:a.E4c,tb.RequestBody);return A.i(ka.va,"ExecuteRichApiRequest",ta,I.b(va,U),
I.a(la,ha),$a,null,0)}if(Ea.mHa()||0<ka.va.h4||0<ka.Mk.h4)return!1;za&&Ea.Ul(za);La&&ka.Ar(La);Ia&&ka.Qz(Ia);var tb=ta.request,Tb=tb.RequestFlags&1?0:16;E.EwaSettings.qc()?Ea.Zt(new D.a(507,0,Ya,Tb|64)):Ea.Zt(new z.a(507,0,Ya,Tb));return!0}var Ea=this.$.userOperationManager,ka=this.$.na,za=null,La=null,Ia=null;qa()||(za=function(){qa()},La=function(){qa()},Ia=function(){qa()},Ea.xq(za),ka.zq(La),ka.Uy(Ia));return xa.task};a.prototype.Zob=function(U){var ha={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",
RequestHeaders:null};ha.RequestBody=JSON.stringify(U);ha.RequestFlags=1;U=this.$.na.va.Na(1);U.request=ha;return U};a.prototype.xYc=function(U){var ha={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};ha.RequestBody=JSON.stringify(U);ha.RequestFlags=1;U=this.$.na.va.Na(1);U.request=ha;return U};a.prototype.JYc=function(U){var ha={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};ha.RequestBody=JSON.stringify(U);ha.RequestFlags=1;U=this.$.na.va.Na(1);
U.request=ha;return U};a.prototype.XEd=function(U,ha,ta){var xa=this,oa=B.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);N.TaskExtensions.Ba(oa,function(){oa.result.hKd();ha&&ta&&xa.Gfj(ha);U.setResult(!0)},this.$.la,3);return oa};a.prototype.w$e=function(){return Y.Task.Sa(!0)};a.pGd=function(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(a.uvb(Q.a.IYa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(a.uvb(Q.a.IYa)||"[]"):null)||[]};a.Ufg=function(U){a.rOd(Q.a.IYa,
Sys.Serialization.JavaScriptSerializer.serialize(U))};a.lGd=function(U){U=a.uvb(Q.a.L3a(U))||"";return 0<U.length?Sys.Serialization.JavaScriptSerializer.deserialize(U,!0):null};a.aWj=function(U,ha){a.VKe(U);a.rOd(Q.a.L3a(U),Sys.Serialization.JavaScriptSerializer.serialize(ha))};a.UHd=function(U){a.ONf(U);a.hOf(Q.a.L3a(U))};a.c4i=function(U){return a.uvb(Q.a.K3a(U))};a.bWj=function(U,ha){a.VKe(U);a.rOd(Q.a.K3a(U),ha)};a.aId=function(U){a.ONf(U);a.hOf(Q.a.K3a(U))};a.VKe=function(U){var ha=a.pGd();U=
U.toLowerCase();Array.contains(ha,U)||(ha.push(U),a.Ufg(ha))};a.ONf=function(U){var ha=a.pGd();U=U.toLowerCase();Array.contains(ha,U)&&(ha.splice(Array.indexOf(ha,U),1),a.Ufg(ha))};a.cacheManifest=function(U,ha){U=new h(U);U.needToRestoreManifest&&a.bWj(U.solutionId,ha)};a.uvb=function(U){try{return localStorage.getItem(U)}catch(ha){return u.ULS.sendTraceTag(537163469,0,50,"CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: {0}",ha.message||"Unknown"),
null}};a.rOd=function(U,ha){try{localStorage.setItem(U,ha)}catch(ta){u.ULS.sendTraceTag(537163468,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",ta.message||"Unknown")}};a.hOf=function(U){try{localStorage.removeItem(U)}catch(ha){u.ULS.sendTraceTag(537163467,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",ha.message||"Unknown")}};a.Pqd=function(U){if(!U)return!1;
try{JSON.parse(U)}catch(ha){return!1}return!0};a.B4c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Hrb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.Grb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.E4c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.D4c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.C4c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(y.a)(a,
"CustomFunctionsLegacyInstaller",null,[505])},1314:function(y,C,b){function a(M,ba,V,aa,E){this.$=M;this.Je=ba;this.ownerAddinInfo=V;this.Sd=void 0===E?null:E;this.xQa=(void 0===aa?null:aa)||P.Task.Sa(!0);return this}function c(M){var ba=N.call(this)||this;ba.SCa="AddInCommandsDialog";ba.Ne=ba.SCa;ba.ic=5;ba.dialogWidth=695;ba.dialogHeight=438;ba.j1g="100%";ba.g1g="408px";ba.h1g="15px";ba.i1g="0";ba.ysg=M;return ba}function e(M,ba,V,aa,E,G){var I=M.Na(9);I.sharedInfo=ba;return u.i(M,"InsertAgaveTaskpane",
I,V,aa,E,G,0)}function f(){}y=b(0);var l=b(212),n=b(15);Object(y.a)(f,"AddinCommandsHost",null,[]);var m=b(1364),h=b(1430),x=b(1071),u=b(83),w=b(560),v=b(386),t=b(175),z=b(37),D=b(1),A=b(292),B=b(150),N=B.a;Wl(c,N);c.prototype.jD=function(){N.prototype.jD.call(this);this.Lp.style.width=this.j1g;this.Lp.style.height=this.g1g;this.Lp.style.marginTop=this.h1g;this.Lp.style.padding=this.i1g};c.prototype.wO=function(){N.prototype.wO.call(this);this.Ob.style.width=String.format("{0}px",this.dialogWidth);
this.Ob.style.height=String.format("{0}px",this.dialogHeight)};c.prototype.dispose=function(){N.prototype.dispose.call(this);this.ysg()};Ck.Object.defineProperties(c.prototype,{containerDiv:{configurable:!0,enumerable:!0,get:function(){return this.Lp}}});Object(y.a)(c,"AddInCommandsDialog",B.a,[]);var P=b(58),Q=b(62);B=b(99);b.d(C,"a",function(){return a});Wl(a,f);a.prototype.b1g=function(){var M=this.xQa;this.xQa=P.Task.Sa(!0);return M};a.prototype.disposeHost=function(M){this.Je.aQa(M)};a.prototype.setOwnerAddinEToken=
function(M){this.ownerAddinInfo.eToken=M};a.prototype.showTaskpane=function(M,ba,V){var aa=this;n.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");var E=null,G=!1,I=(new m.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new x.a,!0)).hFe(M.solutionId.substr(this.ownerAddinInfo.solutionId.length));E=ba.getSharedRuntimeForTaskpane("Workbook",I);G=!!E&&1===E.LifeTime;this.Je.exe(G?this.ownerAddinInfo.solutionId:M.solutionId,G?E:null,null)||(this.Qlf(G,!0),this.xQa=this.Eld(M,
E,function(R,Y){R?(G&&(R.PrimaryMarketplace.SolutionId=aa.ownerAddinInfo.solutionId,R.SharedRuntime=E),R.WebExtensionOsfControlType=3,aa.Je.w0a(R),V(R.InstanceId,Y),aa.Qlf(G,!1),D.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&n.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(n.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),V(null,Y))}))};a.prototype.getSettings=function(M,ba){var V=this.Je.waa(M.solutionId);
V?ba(this.Je.tZ(V).OsfPropertyBag):this.xQa=this.Eld(M,null,function(aa){aa?ba(aa.OsfPropertyBag):n.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})};a.prototype.showDialog=function(M,ba,V){function aa(Y,U,ha){return e(I,R,A.b(Y,E),U,ha,null)}function E(Y){var U=Y.Result,ha=U?U.AgaveData:null;ha?(G.Je.bEe(ha,function(){var ta=new c(function(){G.disposeHost(ha.InstanceId)});ta.initializeAndShow("",null,null);return ta.containerDiv}),V(ha.InstanceId,0)):(n.ULS.sendTraceTag(537170638,
220,10,"ShowDialog: instance id is null."),V(null,Y.Errors?Y.Errors[0].ErrorCause:5001))}var G=this;n.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");var I=this.$.na.va,R=a.orb(M,this.ownerAddinInfo);D.EwaSettings.qc()?this.xQa=v.a(this.$.userOperationManager,aa,function(Y){return new t.a(500,0,Y,64)},this.Sd):this.xQa=v.a(this.$.userOperationManager,aa,function(Y){return new w.a(500,0,Y)},this.Sd)};a.prototype.createUILessSandbox=function(M,ba,V){var aa=this;n.ULS.sendTraceTag(537170637,
220,50,"UILess action called.");var E=ba.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),G=!!E&&1===E.LifeTime;(ba=this.Je.fAh(G?this.ownerAddinInfo.solutionId:M.solutionId,G?E:null))?V(ba,0):this.xQa=this.Eld(M,E,function(I,R){I?(G?(I.PrimaryMarketplace.SolutionId=aa.ownerAddinInfo.solutionId,I.SharedRuntime=E,I.TaskpaneVisible=!1,I.WebExtensionOsfControlType=3,aa.Je.w0a(I)):(I.WebExtensionOsfControlType=4,aa.Je.bEe(I,function(){a.Beb.ia(I.InstanceId,new h.a);return a.Beb.oa(I.InstanceId).g1a})),
V(I.InstanceId,R)):(n.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),V(null,R))})};a.prototype.Eld=function(M,ba,V){function aa(xa,oa,qa){return e(R,Y,A.b(xa,E),oa,qa,null)}function E(xa){var oa=xa.Result;(I=oa?oa.AgaveData:null)||V(null,xa.Errors?xa.Errors[0].ErrorCause:5001)}var G=this,I=null,R=this.$.na.va,Y=a.orb(M,this.ownerAddinInfo);ba&&(n.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),Y.SharedRuntimeId=ba.Resid);var U=500,ha=0;void 0===Y.IsToBePersisted||
null===Y.IsToBePersisted||Y.IsToBePersisted||(U=538,aa=function(xa,oa,qa){n.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(G.ownerAddinInfo.solutionId,G.ownerAddinInfo.storeType,G.ownerAddinInfo.assetId,null,null,G.ownerAddinInfo.storeId));xa=A.b(xa,E);var Ea=R.Na(9,null);Ea.sharedInfo=Y;return u.i(R,"ShowAgaveTaskpane",Ea,xa,oa,qa,null,0)},ha=16);if(D.EwaSettings.qc()){ha|=64;var ta=
v.a(this.$.userOperationManager,aa,function(xa){return new t.a(U,0,xa,ha)},this.Sd)}else ta=v.a(this.$.userOperationManager,aa,function(xa){return new w.a(U,0,xa,ha)},this.Sd);return z.TaskExtensions.ts(ta,function(){return I?G.Zsd(R,I.InstanceId,function(xa,oa){if(xa){ba||(I.PrimaryMarketplace.MarketplaceType=M.storeType);I.OwnerAddinSolutionId=G.ownerAddinInfo.solutionId;I.OwnerAddinStoreType=G.ownerAddinInfo.storeType;I.OsfPropertyBag=[];for(oa=0;oa<xa.Settings.length;oa++){var qa=[];qa[0]=xa.Settings[oa].Name;
qa[1]=xa.Settings[oa].Value;I.OsfPropertyBag[oa]=qa}V(I,0)}else V(null,oa.Errors?oa.Errors[0].ErrorCause:5001)}):P.Task.Sa(!1)},l.a.none,3,Q.a.current)};a.prototype.Zsd=function(M,ba,V){function aa(G,I,R){G=A.b(G,E);var Y=M.Na(1);Y.controlId=ba;return u.i(M,"DdaLoadSettings",Y,G,I,R,null,0)}function E(G){V(G.Result,G)}return D.EwaSettings.qc()?v.a(this.$.userOperationManager,aa,function(G){return new t.a(501,0,G,80)},this.Sd):v.a(this.$.userOperationManager,aa,function(G){return new w.a(501,0,G,16)},
this.Sd)};a.prototype.Qlf=function(M,ba){var V;M&&(null===(V=window.performance)||void 0===V?0:V.memory)&&n.ULS.sendTraceTag(537170630,220,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",ba,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)};a.showUILessDialog=function(M){a.Beb.yb(M)&&a.Beb.oa(M).initializeAndShowWithTitle()};a.hideUILessDialog=function(M){a.Beb.yb(M)&&
a.Beb.oa(M).hide()};a.orb=function(M,ba){var V={};V.SolutionId=M.solutionId;V.Version=M.version;V.StoreType=ba.storeType;V.StoreId=M.storeId;V.AssetId=M.solutionId;V.AssetStoreId="omex";V.TargetType=1;V.Width=350;V.OwnerAddinSolutionId=ba.solutionId;V.OwnerAddinStoreType=ba.storeType;V.SharedRuntimeId=null;V.Preload=!1;return V};a.Beb=new B.a;Object(y.a)(a,"WACExcelAddinCommandsHost",f,[])},1350:function(y,C,b){function a(c,e,f,l){this._id=c;this.gwg=e;this.Rge=f;this.EUa=l}b.d(C,"a",function(){return a});
y=b(0);a.prototype.getId=function(){return this._id};a.prototype.getStoreId=function(){return this.gwg};a.prototype.getStoreType=function(){return this.Rge};Object(y.a)(a,"ExtensionIdentity",null,[297])},1351:function(y,C,b){function a(c,e,f){this.Q$d=f}b.d(C,"a",function(){return a});y=b(0);Object(y.a)(a,"HostProperties",null,[])},1352:function(y,C,b){function a(){this.optionalProperties={};this.Dq={}}b.d(C,"a",function(){return a});y=b(0);Object(y.a)(a,"ExtensionLaunchProperties",null,[])},1353:function(y,
C,b){function a(){this.La=m.AFrameworkApplication.Ib}b.d(C,"a",function(){return a});y=b(0);var c=b(1350),e=b(1352),f=b(1164),l=b(1355),n=b(1351),m=b(4),h=b(633),x=b(27);a.prototype.kNa=function(u,w,v,t,z){this.Cpi(u,w,v,t,z)};a.prototype.Cpi=function(u,w,v,t,z){var D=b(1354).ExtensionComponentInstance,A={};A[f.a.T8b]=u;A[f.a.qAe]=w;A[f.a.gHa]=v;A[f.a.Ojd]=t;A[f.a.Jya]=z;t=8;if(m.AFrameworkApplication.Tki(u.getId()))switch(w){case l.a.action:t=this.La.se(x.a.yQe,2,A);break;case l.a.taskpane:t=this.La.se(x.a.t2f,
2,A);break;case l.a.njj:t=this.La.se(x.a.Wpi,2,A);break;default:t=16}32===t?(t=h.a.create().toString(),z.optionalProperties.InstanceToken&&(t=z.optionalProperties.InstanceToken),u=new D(u,w,v,t),a.Uv[t]=u):u=new D(u,w,v,null);u.Cmj(A)};a.prototype.Bpi=function(u){var w=u.ExtId,v=u.ComponentType,t=u.ComponentId,z=u.HostProps;u=u.OptionalProps;w=new c.a(w.Id,w.StoreId,w.StoreType,w.AppVersion);z=new n.a(z.HostType,z.FormFactor,z.Locale);var D=new e.a;D.optionalProperties=u.OptionalProperties;D.Dq=u.DevProperties;
a.instance.kNa(w,v,t,z,D)};a.prototype.getInstance=function(u){return a.Uv[u]};a.prototype.U8i=function(u){delete a.Uv[u]};Ck.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.aIc||(a.aIc=new a);return a.aIc}}});a.aIc=null;a.Uv={};Object(y.a)(a,"ExtensionLifeCycleManager",null,[298])},1354:function(y,C,b){function a(l,n,m,h){this.EUa=this.mG=null;this._id=l;this.Plg=m;this.Npg=h;this.La=e.AFrameworkApplication.Ib?e.AFrameworkApplication.Ib:null}b.r(C);b.d(C,"ExtensionComponentInstance",
function(){return a});y=b(0);var c=b(1353),e=b(4),f=b(27);a.prototype.Tcd=function(){return this.Plg};a.prototype.Cmj=function(l){this.mG=l};a.prototype.stop=function(){var l=this.La.se(f.a.JYg,2,this.mG);c.a.instance.U8i(this.Npg);return 32===l};a.prototype.Jtc=function(){this.La.se(f.a.ESf,2,this.mG)};Ck.Object.defineProperties(a.prototype,{appVersion:{configurable:!0,enumerable:!0,get:function(){return this.EUa}}});Object(y.a)(a,"ExtensionComponentInstance",null,[319])},1355:function(y,C,b){function a(){}
b.d(C,"a",function(){return a});y=b(0);a.taskpane="Taskpane";a.action="Action";a.njj="SDXDialog";Object(y.a)(a,"ComponentTypeNames",null,[])},1356:function(y,C,b){(function(a){function c(Q,M,ba){var V=P.call(this)||this;V.I8e=m.a.getTypeName();V.Sd=null;V.vU=null;V.xxb=null;V.imageWidth=0;V.imageHeight=0;V.tableData=null;V.errorMessage=null;V.qLa=null;V.Vjd=0;V.fTc=!1;V.qFe=function(aa){if(aa){var E={};if(function(){var ha=B.d(V.vbh(aa.data));E=ha.Wt;return ha}().returnValue){var G=Object(n.a)(Object,
E);if("."===G.DataFromPictureWildcard)if(G.SessionId!==V.qLa)f.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(f.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),G.CmdType){case "ACK":V.fTc=!0;V.x7f.stop();f.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");
V.hlj();0<V.errorMessage.length?V.wWf():0<V.tableData.length&&V.NWf();break;case "insert_html":var I=V.$.na.va,R={},Y=A.g(V.$).ha.ta.qd.clone();R.PasteId=l.a.create().toString();R.DestinationRanges=u.s(u.v(Y,V.$));Y=G.Parameters.split("|",3);f.ULS.sendTraceTag(523805136,0,50,"DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:{0}|{1}|{2}.",Y[0],Y[1],Y[2]);Y=G.Parameters.indexOf("|");Y=G.Parameters.indexOf("|",Y+1);Y=G.Parameters.indexOf("|",Y+1);R.SourceHtml=G.Parameters.substring(Y+
1);R.CopyOperationId=null;var U=I.Na(1,I.hc());U.pasteHtmlParameters=R;w.a(V.$.userOperationManager,function(ha,ta,xa){return t.i(I,"pasteHtmlContent",U,ha,ta,xa,null,64)},function(ha){return new v.a(204,0,ha,1)},null);V.Vjd++;f.ULS.sendTraceTag(523805135,0,50,"DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:{0}",V.Vjd.toString())}}}};V.X6h=function(aa,E){if(aa=E.IG)if(!E.parentPath||1>=E.parentPath.length||E.parentPath[1]!==V.qLa)f.ULS.sendTraceTag(523805124,
0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{f.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");E=aa.errorCode;switch(E){case null:case -1:V.errorMessage=D.a.instance.ga(2231);break;case 1:V.errorMessage=D.a.instance.ga(2232);break;case 2:V.errorMessage=D.a.instance.ga(2233)}0<V.errorMessage.length&&f.ULS.sendTraceTag(523805122,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:{0}.",
E?E.toString():"null");V.hpe.stop();V.tableData=aa.html;V.fTc&&(0<V.errorMessage.length?V.wWf():0<V.tableData.length&&V.NWf())}else f.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};V.$=Q;V.augmentationLoopManager=M;V.uploaderCreator=ba;V.initialize();return V}b.d(C,"a",function(){return c});var e=b(0),f=b(15),l=b(176),n=b(85),m=b(1361),h=b(38),x=b(245),u=b(45),w=b(386),v=b(175),t=b(83),z=b(95),D=b(14),A=b(22),B=b(41),N=b(1362),
P=h.a;Wl(c,P);c.prototype.dispose=function(){window.removeEventListener("message",this.qFe,!1);P.prototype.dispose.call(this)};c.prototype.$Qi=function(Q,M){var ba=this;f.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");var V=new Image;V.onload=function(){var aa=document.createElement("canvas");aa.width=V.width;aa.height=V.height;var E=aa.getContext("2d");try{E.drawImage(V,0,0,V.width,V.height)}catch(R){f.ULS.sendTraceTag(523805145,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: {0}",
R.message);return}try{var G=aa.toDataURL("image/jpeg")}catch(R){f.ULS.sendTraceTag(523805144,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: {0}",R.message);return}aa=G.split(",");if(2>aa.length)f.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{aa=aa[1];try{var I=window.self.atob(aa)}catch(R){f.ULS.sendTraceTag(523805142,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: {0}",
R.message);return}28E5<I.length?(f.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),M.Vxj()):(ba.qhj(ba.Sd,ba.vU,aa,V.width,V.height),URL.revokeObjectURL(V.src),V=null,f.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};V.src=Q};c.prototype.hZi=function(Q,M,ba,V){this.Sd=Q;this.vU=V;this.uploaderCreator.E9h(this.$,M,ba,V,this)};c.prototype.qhj=function(Q,M,ba,V,aa){this.qLa=l.a.create().toString();
this.Vjd=0;this.xxb=ba;this.imageWidth=V;this.imageHeight=aa;this.errorMessage=this.tableData="";this.fTc=!1;this.x7f=this.$.Pb.Zg("LoadResource","DataFromPictureTaskpaneLaunch");this.x7f.start();this.DTi(Q,M);this.hpe=this.$.Pb.Zg("LoadResource","DataFromPictureAnnotation");this.hpe.start();this.lSj()};c.prototype.lSj=function(){if(this.xxb.length){var Q=window.self.atob(this.xxb);for(var M=new Uint8Array(Q.length),ba=0;ba<Q.length;ba++)M[ba]=Q.charCodeAt(ba);this.augmentationLoopManager.kSj(M,this.qLa,
this.imageWidth,this.imageHeight)}else f.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")};c.prototype.DTi=function(Q,M){M.SessionID=this.qLa;M.DataFromPictureAssetId="FA000000050";M.LoadDataFromPictureTaskpane=!0;Q=new z.a(-859308420,Q.method,Q.mode,Q.Ze,Q.tabName);this.$.Ka.Wb(Q,M)};c.prototype.x7c=function(Q){try{var M=a.from(Q,"utf16le").toString("base64");return N.a.tHa(this.qLa,M)}catch(ba){return f.ULS.sendTraceTag(523805133,
0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message.",ba.message),""}};c.prototype.vbh=function(Q){try{var M=N.a.tHa(this.qLa,Q);return a.from(M,"base64").toString("utf16le")}catch(ba){return f.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message.",ba.message),""}};c.prototype.hlj=function(){if(this.xxb.length){var Q=x.a(this.$).waa("FA000000050"),M={};M=(M.DataFromPictureWildcard=".",M);M.imageData=this.x7c(this.xxb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Q,
"onCustomMessage",M,function(ba){ba&&f.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else f.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")};c.prototype.NWf=function(){if(this.tableData.length){var Q=x.a(this.$).waa("FA000000050"),M={};M=(M.DataFromPictureWildcard=".",M);M.tableHtml=this.x7c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Q,
"onCustomMessage",M,function(ba){ba&&f.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else f.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")};c.prototype.wWf=function(){if(this.errorMessage.length){var Q=x.a(this.$).waa("FA000000050"),M={};M=(M.DataFromPictureWildcard=".",M);M.errorMessage=this.x7c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Q,
"onCustomMessage",M,function(ba){ba&&f.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else f.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")};c.prototype.initialize=function(){window.addEventListener("message",this.qFe,!1);this.augmentationLoopManager.activateAnnotation(this.I8e);this.augmentationLoopManager.aE(this.I8e,
this.X6h)};Object(e.a)(c,"DataFromPictureManager",h.a,[527])}).call(this,b(1357).Jgg)},1357:function(y,C,b){(function(a){function c(){try{var aa=new Uint8Array(1);aa.__proto__={__proto__:Uint8Array.prototype,Tad:function(){return 42}};return 42===aa.Tad()&&"function"===typeof aa.subarray&&0===aa.subarray(1,1).byteLength}catch(E){return!1}}function e(aa,E){if((f.cP?2147483647:1073741823)<E)throw new RangeError("Invalid typed array length");f.cP?(aa=new Uint8Array(E),aa.__proto__=f.prototype):(null===
aa&&(aa=new f(E)),aa.length=E);return aa}function f(aa,E,G){if(!(f.cP||this instanceof f))return new f(aa,E,G);if("number"===typeof aa){if("string"===typeof E)throw Error("If encoding is specified then the first argument must be a string");return m(this,aa)}return l(this,aa,E,G)}function l(aa,E,G,I){if("number"===typeof E)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&E instanceof ArrayBuffer){E.byteLength;if(0>G||E.byteLength<G)throw new RangeError("'offset' is out of bounds");
if(E.byteLength<G+(I||0))throw new RangeError("'length' is out of bounds");E=void 0===G&&void 0===I?new Uint8Array(E):void 0===I?new Uint8Array(E,G):new Uint8Array(E,G,I);f.cP?(aa=E,aa.__proto__=f.prototype):aa=h(aa,E);E=aa}else if("string"===typeof E){I=aa;aa=G;if("string"!==typeof aa||""===aa)aa="utf8";if(!f.Ybf(aa))throw new TypeError('"encoding" must be a valid string encoding');G=w(E,aa)|0;I=e(I,G);E=I.write(E,aa);E!==G&&(I=I.slice(0,E));E=I}else E=x(aa,E);return E}function n(aa){if("number"!==
typeof aa)throw new TypeError('"size" argument must be a number');if(0>aa)throw new RangeError('"size" argument must not be negative');}function m(aa,E){n(E);aa=e(aa,0>E?0:u(E)|0);if(!f.cP)for(var G=0;G<E;++G)aa[G]=0;return aa}function h(aa,E){var G=0>E.length?0:u(E.length)|0;aa=e(aa,G);for(var I=0;I<G;I+=1)aa[I]=E[I]&255;return aa}function x(aa,E){if(f.isBuffer(E)){var G=u(E.length)|0;aa=e(aa,G);if(0===aa.length)return aa;E.copy(aa,0,0,G);return aa}if(E){if("undefined"!==typeof ArrayBuffer&&E.buffer instanceof
ArrayBuffer||"length"in E)return(G="number"!==typeof E.length)||(G=E.length,G=G!==G),G?e(aa,0):h(aa,E);if("Buffer"===E.type&&M(E.data))return h(aa,E.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function u(aa){if(aa>=(f.cP?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.cP?2147483647:1073741823).toString(16)+" bytes");return aa|0}function w(aa,E){if(f.isBuffer(aa))return aa.length;
if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(aa)||aa instanceof ArrayBuffer))return aa.byteLength;"string"!==typeof aa&&(aa=""+aa);var G=aa.length;if(0===G)return 0;for(var I=!1;;)switch(E){case "ascii":case "latin1":case "binary":return G;case "utf8":case "utf-8":case void 0:return A(aa).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*G;case "hex":return G>>>1;case "base64":return N(aa).length;default:if(I)return A(aa).length;
E=(""+E).toLowerCase();I=!0}}function v(aa,E,G){var I=!1;if(void 0===E||0>E)E=0;if(E>this.length)return"";if(void 0===G||G>this.length)G=this.length;if(0>=G)return"";G>>>=0;E>>>=0;if(G<=E)return"";for(aa||(aa="utf8");;)switch(aa){case "hex":aa=E;E=G;G=this.length;if(!aa||0>aa)aa=0;if(!E||0>E||E>G)E=G;I="";for(G=aa;G<E;++G)aa=I,I=this[G],I=16>I?"0"+I.toString(16):I.toString(16),I=aa+I;return I;case "utf8":case "utf-8":return D(this,E,G);case "ascii":aa="";for(G=Math.min(this.length,G);E<G;++E)aa+=
String.fromCharCode(this[E]&127);return aa;case "latin1":case "binary":aa="";for(G=Math.min(this.length,G);E<G;++E)aa+=String.fromCharCode(this[E]);return aa;case "base64":return 0===E&&G===this.length?Q.xUe(this):Q.xUe(this.slice(E,G));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":E=this.slice(E,G);G="";for(aa=0;aa<E.length;aa+=2)G+=String.fromCharCode(E[aa]+256*E[aa+1]);return G;default:if(I)throw new TypeError("Unknown encoding: "+aa);aa=(aa+"").toLowerCase();I=!0}}function t(aa,E,G,
I,R){if(0===aa.length)return-1;"string"===typeof G?(I=G,G=0):2147483647<G?G=2147483647:-2147483648>G&&(G=-2147483648);G=+G;isNaN(G)&&(G=R?0:aa.length-1);0>G&&(G=aa.length+G);if(G>=aa.length){if(R)return-1;G=aa.length-1}else if(0>G)if(R)G=0;else return-1;"string"===typeof E&&(E=f.from(E,I));if(f.isBuffer(E))return 0===E.length?-1:z(aa,E,G,I,R);if("number"===typeof E)return E&=255,f.cP&&"function"===typeof Uint8Array.prototype.indexOf?R?Uint8Array.prototype.indexOf.call(aa,E,G):Uint8Array.prototype.lastIndexOf.call(aa,
E,G):z(aa,[E],G,I,R);throw new TypeError("val must be string, number or Buffer");}function z(aa,E,G,I,R){function Y(xa,oa){return 1===U?xa[oa]:xa.p4i(oa*U)}var U=1,ha=aa.length,ta=E.length;if(void 0!==I&&(I=String(I).toLowerCase(),"ucs2"===I||"ucs-2"===I||"utf16le"===I||"utf-16le"===I)){if(2>aa.length||2>E.length)return-1;U=2;ha/=2;ta/=2;G/=2}if(R)for(I=-1;G<ha;G++)if(Y(aa,G)===Y(E,-1===I?0:G-I)){if(-1===I&&(I=G),G-I+1===ta)return I*U}else-1!==I&&(G-=G-I),I=-1;else for(G+ta>ha&&(G=ha-ta);0<=G;G--){ha=
!0;for(I=0;I<ta;I++)if(Y(aa,G+I)!==Y(E,I)){ha=!1;break}if(ha)return G}return-1}function D(aa,E,G){G=Math.min(aa.length,G);for(var I=[];E<G;){var R=aa[E],Y=null,U=239<R?4:223<R?3:191<R?2:1;if(E+U<=G)switch(U){case 1:128>R&&(Y=R);break;case 2:var ha=aa[E+1];128===(ha&192)&&(R=(R&31)<<6|ha&63,127<R&&(Y=R));break;case 3:ha=aa[E+1];var ta=aa[E+2];128===(ha&192)&&128===(ta&192)&&(R=(R&15)<<12|(ha&63)<<6|ta&63,2047<R&&(55296>R||57343<R)&&(Y=R));break;case 4:ha=aa[E+1];ta=aa[E+2];var xa=aa[E+3];128===(ha&
192)&&128===(ta&192)&&128===(xa&192)&&(R=(R&15)<<18|(ha&63)<<12|(ta&63)<<6|xa&63,65535<R&&1114112>R&&(Y=R))}null===Y?(Y=65533,U=1):65535<Y&&(Y-=65536,I.push(Y>>>10&1023|55296),Y=56320|Y&1023);I.push(Y);E+=U}aa=I.length;if(aa<=ba)I=String.fromCharCode.apply(String,I);else{G="";for(E=0;E<aa;)G+=String.fromCharCode.apply(String,I.slice(E,E+=ba));I=G}return I}function A(aa,E){E=E||Infinity;for(var G,I=aa.length,R=null,Y=[],U=0;U<I;++U){G=aa.charCodeAt(U);if(55295<G&&57344>G){if(!R){if(56319<G){-1<(E-=
3)&&Y.push(239,191,189);continue}else if(U+1===I){-1<(E-=3)&&Y.push(239,191,189);continue}R=G;continue}if(56320>G){-1<(E-=3)&&Y.push(239,191,189);R=G;continue}G=(R-55296<<10|G-56320)+65536}else R&&-1<(E-=3)&&Y.push(239,191,189);R=null;if(128>G){if(0>--E)break;Y.push(G)}else if(2048>G){if(0>(E-=2))break;Y.push(G>>6|192,G&63|128)}else if(65536>G){if(0>(E-=3))break;Y.push(G>>12|224,G>>6&63|128,G&63|128)}else if(1114112>G){if(0>(E-=4))break;Y.push(G>>18|240,G>>12&63|128,G>>6&63|128,G&63|128)}else throw Error("Invalid code point");
}return Y}function B(aa){for(var E=[],G=0;G<aa.length;++G)E.push(aa.charCodeAt(G)&255);return E}function N(aa){var E=Q,G=E.kIj;aa=(aa.trim?aa.trim():aa.replace(/^\s+|\s+$/g,"")).replace(V,"");if(2>aa.length)aa="";else for(;0!==aa.length%4;)aa+="=";return G.call(E,aa)}function P(aa,E,G,I){for(var R=0;R<I&&!(R+G>=E.length||R>=aa.length);++R)E[R+G]=aa[R];return R}var Q=b(1358);b(1359);var M=b(1360);C.Jgg=f;C.yXj=function(aa){+aa!=aa&&(aa=0);return f.Doe(+aa)};C.WWj=50;f.cP=void 0!==a.cP?a.cP:c();C.ZYj=
f.cP?2147483647:1073741823;f.from=function(aa,E,G){return l(null,aa,E,G)};f.cP&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));f.Doe=function(aa){n(aa);return e(null,aa)};f.nIg=function(aa){return m(null,aa)};f.isBuffer=function(aa){return!(null==aa||!aa.cqg)};f.compare=function(aa,E){if(!f.isBuffer(aa)||!f.isBuffer(E))throw new TypeError("Arguments must be Buffers");
if(aa===E)return 0;for(var G=aa.length,I=E.length,R=0,Y=Math.min(G,I);R<Y;++R)if(aa[R]!==E[R]){G=aa[R];I=E[R];break}return G<I?-1:I<G?1:0};f.Ybf=function(aa){switch(String(aa).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};f.concat=function(aa,E){if(!M(aa))throw new TypeError('"list" argument must be an Array of Buffers');if(0===aa.length)return f.Doe(0);var G;
if(void 0===E)for(G=E=0;G<aa.length;++G)E+=aa[G].length;E=f.nIg(E);var I=0;for(G=0;G<aa.length;++G){var R=aa[G];if(!f.isBuffer(R))throw new TypeError('"list" argument must be an Array of Buffers');R.copy(E,I);I+=R.length}return E};f.byteLength=w;f.prototype.cqg=!0;f.prototype.toString=function(){var aa=this.length|0;return 0===aa?"":0===arguments.length?D(this,0,aa):v.apply(this,arguments)};f.prototype.equals=function(aa){if(!f.isBuffer(aa))throw new TypeError("Argument must be a Buffer");return this===
aa?!0:0===f.compare(this,aa)};f.prototype.compare=function(aa,E,G,I,R){if(!f.isBuffer(aa))throw new TypeError("Argument must be a Buffer");void 0===E&&(E=0);void 0===G&&(G=aa?aa.length:0);void 0===I&&(I=0);void 0===R&&(R=this.length);if(0>E||G>aa.length||0>I||R>this.length)throw new RangeError("out of range index");if(I>=R&&E>=G)return 0;if(I>=R)return-1;if(E>=G)return 1;E>>>=0;G>>>=0;I>>>=0;R>>>=0;if(this===aa)return 0;var Y=R-I,U=G-E,ha=Math.min(Y,U);I=this.slice(I,R);aa=aa.slice(E,G);for(E=0;E<
ha;++E)if(I[E]!==aa[E]){Y=I[E];U=aa[E];break}return Y<U?-1:U<Y?1:0};f.prototype.includes=function(aa,E,G){return-1!==this.indexOf(aa,E,G)};f.prototype.indexOf=function(aa,E,G){return t(this,aa,E,G,!0)};f.prototype.lastIndexOf=function(aa,E,G){return t(this,aa,E,G,!1)};f.prototype.write=function(aa,E,G,I){if(void 0===E)I="utf8",G=this.length,E=0;else if(void 0===G&&"string"===typeof E)I=E,G=this.length,E=0;else if(isFinite(E))E|=0,isFinite(G)?(G|=0,void 0===I&&(I="utf8")):(I=G,G=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var R=this.length-E;if(void 0===G||G>R)G=R;if(0<aa.length&&(0>G||0>E)||E>this.length)throw new RangeError("Attempt to write outside buffer bounds");I||(I="utf8");for(R=!1;;)switch(I){case "hex":E=Number(E)||0;I=this.length-E;G?(G=Number(G),G>I&&(G=I)):G=I;I=aa.length;if(0!==I%2)throw new TypeError("Invalid hex string");G>I/2&&(G=I/2);for(I=0;I<G;++I){R=parseInt(aa.substr(2*I,2),16);if(isNaN(R))break;this[E+I]=R}return I;case "utf8":case "utf-8":return P(A(aa,this.length-E),this,E,G);case "ascii":return P(B(aa),
this,E,G);case "latin1":case "binary":return P(B(aa),this,E,G);case "base64":return P(N(aa),this,E,G);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":I=aa;R=this.length-E;for(var Y=[],U=0;U<I.length&&!(0>(R-=2));++U){var ha=I.charCodeAt(U);aa=ha>>8;ha%=256;Y.push(ha);Y.push(aa)}return P(Y,this,E,G);default:if(R)throw new TypeError("Unknown encoding: "+I);I=(""+I).toLowerCase();R=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.EXj||this,0)}};var ba=
4096;f.prototype.slice=function(aa,E){var G=this.length;aa=~~aa;E=void 0===E?G:~~E;0>aa?(aa+=G,0>aa&&(aa=0)):aa>G&&(aa=G);0>E?(E+=G,0>E&&(E=0)):E>G&&(E=G);E<aa&&(E=aa);if(f.cP)E=this.subarray(aa,E),E.__proto__=f.prototype;else{G=E-aa;E=new f(G,void 0);for(var I=0;I<G;++I)E[I]=this[I+aa]}return E};f.prototype.p4i=function(aa){if(0!==aa%1||0>aa)throw new RangeError("offset is not uint");if(aa+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[aa]<<8|this[aa+1]};
f.prototype.copy=function(aa,E,G,I){G||(G=0);I||0===I||(I=this.length);E>=aa.length&&(E=aa.length);E||(E=0);0<I&&I<G&&(I=G);if(I===G||0===aa.length||0===this.length)return 0;if(0>E)throw new RangeError("targetStart out of bounds");if(0>G||G>=this.length)throw new RangeError("sourceStart out of bounds");if(0>I)throw new RangeError("sourceEnd out of bounds");I>this.length&&(I=this.length);aa.length-E<I-G&&(I=aa.length-E+G);var R=I-G;if(this===aa&&G<E&&E<I)for(I=R-1;0<=I;--I)aa[I+E]=this[I+G];else if(1E3>
R||!f.cP)for(I=0;I<R;++I)aa[I+E]=this[I+G];else Uint8Array.prototype.set.call(aa,this.subarray(G,G+R),E);return R};f.prototype.fill=function(aa,E,G,I){if("string"===typeof aa){"string"===typeof E?(I=E,E=0,G=this.length):"string"===typeof G&&(I=G,G=this.length);if(1===aa.length){var R=aa.charCodeAt(0);256>R&&(aa=R)}if(void 0!==I&&"string"!==typeof I)throw new TypeError("encoding must be a string");if("string"===typeof I&&!f.Ybf(I))throw new TypeError("Unknown encoding: "+I);}else"number"===typeof aa&&
(aa&=255);if(0>E||this.length<E||this.length<G)throw new RangeError("Out of range index");if(G<=E)return this;E>>>=0;G=void 0===G?this.length:G>>>0;aa||(aa=0);if("number"===typeof aa)for(I=E;I<G;++I)this[I]=aa;else for(aa=f.isBuffer(aa)?aa:A((new f(aa,I)).toString()),R=aa.length,I=0;I<G-E;++I)this[I+E]=aa[I%R];return this};var V=/[^+\/0-9A-Za-z-_]/g}).call(this,b(741))},1358:function(y,C){function b(f){var l=f.length;if(0<l%4)throw Error("Invalid string. Length must be a multiple of 4");f=f.indexOf("=");
-1===f&&(f=l);return[f,f===l?0:4-f%4]}C.byteLength=function(f){f=b(f);var l=f[1];return 3*(f[0]+l)/4-l};C.kIj=function(f){var l=b(f);var n=l[0];l=l[1];var m=new e(3*(n+l)/4-l),h=0,x=0<l?n-4:n,u;for(u=0;u<x;u+=4)n=c[f.charCodeAt(u)]<<18|c[f.charCodeAt(u+1)]<<12|c[f.charCodeAt(u+2)]<<6|c[f.charCodeAt(u+3)],m[h++]=n>>16&255,m[h++]=n>>8&255,m[h++]=n&255;2===l&&(n=c[f.charCodeAt(u)]<<2|c[f.charCodeAt(u+1)]>>4,m[h++]=n&255);1===l&&(n=c[f.charCodeAt(u)]<<10|c[f.charCodeAt(u+1)]<<4|c[f.charCodeAt(u+2)]>>
2,m[h++]=n>>8&255,m[h++]=n&255);return m};C.xUe=function(f){for(var l=f.length,n=l%3,m=[],h=0,x=l-n;h<x;h+=16383){for(var u=m,w=u.push,v,t=f,z=h+16383>x?x:h+16383,D=[],A=h;A<z;A+=3)v=(t[A]<<16&16711680)+(t[A+1]<<8&65280)+(t[A+2]&255),D.push(a[v>>18&63]+a[v>>12&63]+a[v>>6&63]+a[v&63]);v=D.join("");w.call(u,v)}1===n?(f=f[l-1],m.push(a[f>>2]+a[f<<4&63]+"==")):2===n&&(f=(f[l-2]<<8)+f[l-1],m.push(a[f>>10]+a[f>>4&63]+a[f<<2&63]+"="));return m.join("")};var a=[],c=[],e="undefined"!==typeof Uint8Array?Uint8Array:
Array;for(y=0;64>y;++y)a[y]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[y],c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(y)]=y;c[45]=62;c[95]=63},1359:function(y,C){C.read=function(b,a,c,e,f){var l=8*f-e-1;var n=(1<<l)-1,m=n>>1,h=-7;f=c?f-1:0;var x=c?-1:1,u=b[a+f];f+=x;c=u&(1<<-h)-1;u>>=-h;for(h+=l;0<h;c=256*c+b[a+f],f+=x,h-=8);l=c&(1<<-h)-1;c>>=-h;for(h+=e;0<h;l=256*l+b[a+f],f+=x,h-=8);if(0===c)c=1-m;else{if(c===n)return l?NaN:Infinity*(u?
-1:1);l+=Math.pow(2,e);c-=m}return(u?-1:1)*l*Math.pow(2,c-e)};C.write=function(b,a,c,e,f,l){var n,m=8*l-f-1,h=(1<<m)-1,x=h>>1,u=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;l=e?0:l-1;var w=e?1:-1,v=0>a||0===a&&0>1/a?1:0;a=Math.abs(a);isNaN(a)||Infinity===a?(a=isNaN(a)?1:0,e=h):(e=Math.floor(Math.log(a)/Math.LN2),1>a*(n=Math.pow(2,-e))&&(e--,n*=2),a=1<=e+x?a+u/n:a+u*Math.pow(2,1-x),2<=a*n&&(e++,n/=2),e+x>=h?(a=0,e=h):1<=e+x?(a=(a*n-1)*Math.pow(2,f),e+=x):(a=a*Math.pow(2,x-1)*Math.pow(2,f),e=0));for(;8<=
f;b[c+l]=a&255,l+=w,a/=256,f-=8);e=e<<f|a;for(m+=f;0<m;b[c+l]=e&255,l+=w,e/=256,m-=8);b[c+l-w]|=128*v}},1360:function(y){var C={}.toString;y.exports=Array.isArray||function(b){return"[object Array]"==C.call(b)}},1361:function(y,C,b){function a(){var f=e.call(this)||this;f.errorCode=null;f.errorDescription=null;f.html=null;f.H_=Object.assign(new c.a,{T_:a.getTypeName(),B_:a.he()});return f}b.d(C,"a",function(){return a});y=b(0);C=b(930);var c=b(907),e=C.a;Wl(a,e);a.getTypeName=function(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"};
a.he=function(){return["AugLoop_Core_Annotation"]};Object(y.a)(a,"DetectedHtmlTableAnnotation",C.a,[])},1362:function(y,C,b){function a(){}b.d(C,"a",function(){return a});y=b(0);a.tHa=function(c,e){if(!(c&&e&&c.length&&e.length)||256<c.length)return"";var f=Array(256),l=Array(256),n,m=0,h=0,x="";for(n=0;256>n;n++)f[n]=n;for(n=0;256>n;n++){var u=c.charCodeAt(n%c.length);if(256<=u)return"";m=(m+f[n]+u)%256;u=f[n];f[n]=f[m];f[m]=u}for(n=0;256>n;n++)l[n]=f[256-n-1];for(c=m=n=0;c<e.length;c++){n=(n+1)%
256;m=(m+f[n])%256;u=f[n];f[n]=f[m];f[m]=u;u=e.charCodeAt(c);if(256<=u)return"";var w=u^f[(f[n]+f[m])%256];h=(h+l[n])%256;u=l[n];l[n]=l[h];l[h]=u;x+=String.fromCharCode(w^f[(l[n]+l[h])%256])}return x};Object(y.a)(a,"RC4A",null,[])},1364:function(y,C,b){function a(e,f,l,n){this.$jb=e;c.AFrameworkApplication.fa.ra("AddInCommandsMissingTabIsEnabled")&&l.NQh();this.ikg=this.Ks=f;this.nvg=n}b.d(C,"a",function(){return a});y=b(0);b(15);var c=b(4);a.prototype.PJa=function(e){e=this.YCb+this.solutionId+e;
return this.sQd?(e in a.NZb||(a.NZb[e]="AddinControl"+a.$Gg++),a.NZb[e]):e};a.prototype.hFe=function(e){if(this.sQd){var f=a.NZb,l;for(l in f){var n=l;if(e===f[l])return n.substr(this.YCb.length+this.solutionId.length)}}return e};a.prototype.j2e=function(e){e=this.YCb+this.solutionId+e;return this.sQd?(e in a.BVc||(a.BVc[e]="AddinTab"+a.jHg++),a.BVc[e]):e};Ck.Object.defineProperties(a.prototype,{YCb:{configurable:!0,enumerable:!0,get:function(){return this.$jb}},solutionId:{configurable:!0,enumerable:!0,
get:function(){return this.Ks}},assetId:{configurable:!0,enumerable:!0,get:function(){return this.ikg}},sQd:{configurable:!0,enumerable:!0,get:function(){return this.nvg}}});a.NZb={};a.BVc={};a.jHg=0;a.$Gg=0;Object(y.a)(a,"DefaultRibbonNamingProvider",null,[242])},1407:function(y,C,b){function a(v){var t=this;this.aB=null;this.j9f={};this.l9f={};this.had={};this.Cxd={};this.Zhd=function(z,D){z=t.$.Pb.Gc("Task","DdaEventDispatch.HandleServerEvent");D=D.TWf;for(var A=0;A<D.length;A++)switch(D[A].EventType){case 2:var B=
D[A],N={};N.Name=B.Name;N.BindingType=B.BindingType;N.ColCount=B.ColCount;N.RowCount=B.RowCount;t.Lva(B.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,N,null);break;case 4:t.Lva(D[A].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(B=D[A],B.InstanceId){N=Array(B.Entries.length);for(var P=0;P<B.Entries.length;P++)N[P]=a.Kbc(B.Entries[P],B.IsRemoteOverride);0<B.Entries.length&&1===B.Entries[0].Category?t.C_i(B.InstanceId,N):B.InstanceId&&t.Lva(B.InstanceId,
OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,N)}else{t.had={};t.Cxd={};for(N=0;N<B.Entries.length;N++)t.SHe(B.Entries[N],B.IsRemoteOverride);c.ULS.sendTraceTag(537170593,0,50,"Number of Fired event: {0}, Number of Not Fired event: {1}, Total Number of Fired event: {2}, Total Number of Not Fired event: {3}",t.had,t.Cxd,t.j9f,t.l9f)}}z.stop()};this.GJb=function(z,D){t.Lva(z,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,D)};this.$=v;this.qvc=this.Zhd}b.r(C);y=b(0);var c=b(15),e=b(85),f;(function(v){v[v.none=
0]="none";v[v.testEvent=1]="testEvent";v[v.test1Event=2]="test1Event";v[v.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";v[v.worksheetActivatedEvent=11]="worksheetActivatedEvent";v[v.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";v[v.worksheetAddedEvent=13]="worksheetAddedEvent";v[v.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";v[v.worksheetDeletedEvent=15]="worksheetDeletedEvent";v[v.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";v[v.worksheetFilteredEvent=
17]="worksheetFilteredEvent";v[v.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";v[v.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";v[v.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";v[v.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";v[v.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";v[v.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";v[v.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";v[v.worksheetNameChangedEvent=
25]="worksheetNameChangedEvent";v[v.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";v[v.worksheetMovedEvent=27]="worksheetMovedEvent";v[v.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";v[v.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";v[v.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";v[v.chartAddedEvent=50]="chartAddedEvent";v[v.chartActivatedEvent=51]="chartActivatedEvent";v[v.chartDeactivatedEvent=
52]="chartDeactivatedEvent";v[v.chartDeletedEvent=53]="chartDeletedEvent";v[v.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";v[v.tableDataChangedEvent=101]="tableDataChangedEvent";v[v.tableAddedEvent=102]="tableAddedEvent";v[v.tableDeletedEvent=103]="tableDeletedEvent";v[v.tableFilteredEvent=104]="tableFilteredEvent";v[v.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";v[v.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";v[v.customFunctionExecutionEndEvent=
201]="customFunctionExecutionEndEvent";v[v.commentAddedEvent=250]="commentAddedEvent";v[v.commentDeletedEvent=251]="commentDeletedEvent";v[v.commentChangedEvent=252]="commentChangedEvent";v[v.invocationMessage=1E3]="invocationMessage";v[v.cancellationMessage=1001]="cancellationMessage";v[v.metadataMessage=1002]="metadataMessage";v[v.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";v[v.visualChangeEvent=2001]="visualChangeEvent";v[v.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";
v[v.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";v[v.shapeActivatedEvent=2101]="shapeActivatedEvent";v[v.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";v[v.shapeAddedEvent=2103]="shapeAddedEvent";v[v.shapeDeletedEvent=2104]="shapeDeletedEvent";v[v.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";v[v.wacOperationEvent=2201]="wacOperationEvent";v[v.recordingStateChangedEvent=2202]="recordingStateChangedEvent";v[v.workbookActivatedEvent=2203]="workbookActivatedEvent";
v[v.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";v[v.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";v[v.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";v[v.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";v[v.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";v[v.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";
v[v.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";v[v.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";v[v.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";v[v.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";v[v.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";v[v.pivotTableAddedEvent=2900]="pivotTableAddedEvent";v[v.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";
v[v.namedItemAddedEvent=3E3]="namedItemAddedEvent";v[v.namedItemDeletedEvent=3001]="namedItemDeletedEvent";v[v.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";v[v.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";v[v.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(f||(f={}));Object(y.b)("MessageType",f);var l=b(973),n=b(245),m=b(944),h=b(55),x=b(37),u=b(158),w=b(1);b.d(C,"DdaEventDispatch",function(){return a});
a.prototype.mZb=function(v){v&&(this.zia(),this.aB.push(v))};a.prototype.Hsc=function(v){this.aB&&(Array.remove(this.aB,v),this.aB.length||(this.$.wantServerEvents=!1,this.$.kbj(this.qvc),this.aB=null))};a.prototype.C_i=function(v,t){var z=this,D=Object(e.a)(m.DdaFacade,n.a(this.$));x.TaskExtensions.Ba(D.iSh(v),function(A){if(u.b(A)){var B=A.result;A=D.kn(B);if(B)if(A.Yod)z.Lva(B,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t);else if(A.A4c)for(B=0;B<t.length;B++)A.A4c.push(t[B]);else A.A4c=
t}else A.kg?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):A.Ph&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.la,0)};a.prototype.Y_i=function(v,t){var z=Object(e.a)(m.DdaFacade,n.a(this.$)),D=z.BGh(v);D?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(D,t,this.GJb):z.u3g(v,t)};a.prototype.SHe=function(v,t){var z=
!1,D=parseInt(v.Type,10),A=v.Target,B=Object(e.a)(m.DdaFacade,n.a(this.$));if((A=B.hj.oSh(D,A))&&0<Object.keys(A).length){z=!0;for(var N in A)if(A=N,B.hj.G_b(A)){var P=Array(1);P[0]=a.Kbc(v,t);if(w.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var Q=P[0][3];if(void 0!==Q&&null!==Q&&(Q=Object(e.a)(Object,h.a.ni(Q)))&&void 0!==Q.triggerControlId&&null!==Q.triggerControlId&&void 0!==Q.triggerSource&&null!==Q.triggerSource){var M=!1;t?(Q.triggerSource="Unknown",M=!0):
B.dgh(Q.triggerControlId,A)&&(Q.triggerSource="ThisLocalAddin",M=!0);M&&(P[0][3]=h.a.Jc(Q))}}this.Lva(A,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,P)}}z?(this.pec(f[D],this.had),this.pec(f[D],this.j9f)):(this.pec(f[D],this.Cxd),this.pec(f[D],this.l9f))};a.prototype.zia=function(){this.aB||(this.aB=[],this.$.Ane(this.qvc),this.$.wantServerEvents=!0)};a.prototype.pec=function(v,t){v in t||(t[v]=0);t[v]+=1};a.prototype.xM=function(v,t,z){var D={};D.Target=t;D.Category=65536;D.Type=v;D.Message=
z;D.Id=-1;this.SHe(D,!1)};a.prototype.uAh=function(v,t){var z={Target:"",Category:2,Type:1E3};z.Message=t;z.Id=0;t=Array(1);t[0]=a.Kbc(z,!1);this.Y_i(v,t)};a.prototype.K9b=function(v,t,z,D){var A={};A.Target=z;A.Category=65536;A.Type=t;A.Message=D;A.Id=-1;t=Array(1);t[0]=a.Kbc(A,!1);this.Lva(v,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t)};a.prototype.tAh=function(v,t){this.Lva(v,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t)};a.prototype.Lva=function(v,t,z,D){if(this.aB){var A=Object(e.a)(m.DdaFacade,
n.a(this.$));if(!A||t!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&t!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||A.hj.G_b(v))for(v=new l.a(t,v,z,D),t=0,z=this.aB.length;t<z;t++)(D=this.aB[t])&&D(v)}};a.Kbc=function(v,t){var z=Array(6);z[0]=v.Category;z[1]=v.Type;z[2]=v.Target;z[3]=v.Message;z[4]=v.Id;z[5]=t;return z};Object(y.a)(a,"DdaEventDispatch",null,[])},1430:function(y,C,b){function a(){var f=e.call(this,void 0,void 0,void 0,!0)||this;f.SCa="AddinCommandsUILessDialog";f.eSc="WACDialogTitleText";
f.ZUa="0";f.VCa=380;f.Ihb=190;f.Ne=f.SCa;f.ic=5;f.Wlg=String.format("{0}px",f.VCa);f.YUa=String.format("{0}px",f.Ihb);f.fv=!1;f.M5e=!1;f.jD();return f}b.d(C,"a",function(){return a});y=b(0);C=b(150);var c=b(90),e=C.a;Wl(a,e);a.prototype.jD=function(){e.prototype.jD.call(this);this.Lp.style.width=this.Wlg;this.Lp.style.height=this.YUa;this.Lp.style.padding=this.ZUa};a.prototype.zv=function(f){this.wO();document.getElementById(this.oi(this.eSc)).innerText=f};a.prototype.wO=function(){e.prototype.wO.call(this);
this.Ob.style.width=String.format("{0}px",this.VCa);this.Ob.style.height=String.format("{0}px",this.Ihb);this.Ob.removeAttribute(c.a.Wd);this.Ob.removeAttribute(c.a.iE)};a.prototype.hide=function(){this.hxb()};a.prototype.initializeAndShowWithTitle=function(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)};Ck.Object.defineProperties(a.prototype,{g1a:{configurable:!0,enumerable:!0,get:function(){return this.Lp}}});Object(y.a)(a,"AddinCommandsUILessDialog",C.a,[251])},1436:function(y,
C,b){function a(H){return uk.call(this,H)||this}function c(H,ia,ib){this.rangePicker=null;this.$=H;this.Je=ia;this.Ee=new I(H.ea);this.cA=new Q(H,this.Ee);this.Nqf=ib;this.b9b=new Map}function e(H,ia,ib,Lb,Nc){this.ISc=null;this.tQb=H;this.rA=ia;this.SI=ib;this.xb=Lb;this.$xg=Nc}function f(){}function l(){this.ura=null}function n(H){if(!H)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.Yud=H}function m(H,ia,ib){return function(Lb){return function(Nc,
Vc){Nh.TaskExtensions.Ba(hj.GetServiceTaskFactory.create(ia.da,279,ia.la,1),function(Hd){Hd=Hd.result;var Ld=!1,Be=ib.Ei.getOsfControl(H),df=null;Be&&(df=Be.getStoreType(),(Be=Be.getManifest())&&Be.getSharedRuntimeForCustomFunctions("Workbook")&&(Ld=!0));Nh.TaskExtensions.Ba(Hd.v$e(H,df,Lb,Ld),function(uf){Pb.b(uf)?uf.result?Nc(null):Vc(OfficeExtension.WacRuntime.Utility.createRichApiException(ai.a.invalidArgument,K.a.instance.ga(1741))):Vc(OfficeExtension.WacRuntime.Utility.createRichApiException(ai.a.generalException,
K.a.instance.ga(1737)))},ia.la,3)},ia.la,3)}}}function h(H,ia){this.eP=Yd.a.instance.kc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.rA=H;this.SI=ia;this.Ksg=this.SI.Ei.getOsfControl(this.rA)}function x(H,ia,ib,Lb){this.l2d="";this.lSb=0;this.eP=H;this._id=ia;this.rA=ib;this.SI=Lb}function u(H,ia,ib){this.Rpg=H;this.Spg=ia;this.Vtg=ib}function w(){this.Sge=this.fbe=this.lA=!1}function v(H,ia,ib,Lb){this.Ks=H;this.D1=ib;this.Oy=Lb.Ei.getOsfControl(ia)}function t(H,ia){this.SI=
ia;this.rA=H}function z(H){this.rA=H}function D(H){this.rIa={};this.Kxi=H}function A(H,ia){var ib=this;ib.hgf=function(Lb,Nc){Lb=A.k2g(Lb,Nc);if(!J.a(ib.$,Lb))return!0;Lb=ib.$.shortcutKeyManager.M1e(Lb);return!!Lb&&0<Lb.length};ib.addinId=H;ib.$=ia;return ib}function B(){}function N(){}function P(H,ia,ib,Lb){this.oyh=H;this.fileSize=ia;this.BAj=Lb}function Q(H,ia){var ib=this;this.eI=function(Lb,Nc){ib.wQ.BJa(mh.a.internalError,Nc)};this.$=H;this.wQ=ia}function M(H,ia,ib,Lb){ib=Zk.call(this,576,0,
ib,Lb)||this;ib.mLd=new V("576",H,ia);return ib}function ba(H,ia,ib,Lb,Nc,Vc,Hd,Ld){ia=Bk.call(this,10,0,ia,Ld)||this;ia.Llb=ib;ia.cib=Lb;ia.I3=Nc;ia.$Ea=Vc;ia.request=Hd;ia.mLd=new V("10",H,Hd);return ia}function V(H,ia,ib){this.parentName=H;this.$=ia;this.request=ib}function aa(H,ia){this.source=H;this.eventId=ia}function E(H,ia,ib,Lb,Nc,Vc){var Hd=H.Na(1);Hd.request=ia;return Zc.i(H,"ExecuteRichApiRequest",Hd,ib,Lb,Nc,Vc,0)}function G(H,ia,ib){this.$=H;this.wQ=ia;this.cA=ib}function I(H){this.ea=
H}function R(H,ia,ib,Lb){H=Gj.call(this,H,"Select Data")||this;H.Gob=null;H.AFe=ia;H.d5c=ib;H.callback=Lb;return H}function Y(H){this.xb=H}function U(H){H.add("InternalTest","PreviewExecutionMethod",ha)}function ha(H,ia){console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof H+", objectId="+H+", value="+ia);return null}function ta(H,ia){this.Lrg=H;this.hsg=ia}function xa(H){var ia=H.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}",
"{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var ib=ia.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);ib.addParameter("shortcuts","String[]",1,null,0);ia.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);ib=ia.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);ib.addParameter("shortcuts","Object",1,null,0);ia=H.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);ib=ia.addMethod("GetSharedFilePickerResponse",
1,"Object",1,1,"SharedFilePickerResponse",0);ib.addParameter("pickerCustomizationJsonString","String",1,null,0);ia=H.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);ib=ia.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);ib.addParameter("base64File","String",1,null,0);ia=H.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);ia.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",
1,1,"AppRuntimeState",0);ib=ia.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);ib.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ia=H.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);ia.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);ib=ia.addMethod("Register",1,"Void",0,0,"Register",0);ib.addParameter("metadata",
"String",1,null,0);ib.addParameter("javascript","String",1,null,0);ia=H.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);ia.addProperty("Enabled",1,"Boolean",1,!1,null,0);ia.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);ia.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);ia=H.addEnumType("Microsoft.Authentication.IdentityType");ia.addEnumField("OrganizationAccount",0);ia.addEnumField("MicrosoftAccount",1);ia=H.addEnumType("Microsoft.Authentication.AuthorityType");
ia.addEnumField("External",0);ia.addEnumField("Msa",1);ia.addEnumField("Aad",2);ia=H.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);ia.addProperty("DisplayName",4,"String",1,!1,null,0);ia.addProperty("Email",3,"String",1,!1,null,0);ia.addProperty("FederationProvider",2,"String",1,!1,null,0);ia.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);ia=H.addType("Microsoft.Authentication.AuthContext",
"{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);ia.addProperty("AppId",4,"String",1,!1,null,0);ia.addProperty("Authority",2,"String",1,!1,null,0);ia.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);ia.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);ia.addProperty("TenantId",6,"String",1,!1,null,0);ia.addProperty("Upn",1,"String",1,!1,null,0);ia=H.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}",
"{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);ia.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);ib=ia.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);ib.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);ia.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);ia.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",
2,1,"PrimaryIdentityInfo",4);ia=H.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);ia.addProperty("AuthChallenge",3,"String",1,!1,null,0);ia.addProperty("CorrelationId",7,"String",1,!1,null,0);ia.addProperty("Policy",4,"String",1,!1,null,0);ia.addProperty("Resource",2,"String",1,!1,null,0);ia.addProperty("Scope",5,"String",1,!1,null,0);ia.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);ia=H.addType("Microsoft.Authentication.SingleSignOnToken",
"{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);ia.addProperty("AccessToken",2,"String",1,!1,null,0);ia.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);ia=H.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);ia.addProperty("Id",1,"String",1,!0,null,0);ia.addProperty("Value",2,"Object",1,!1,null,0);ia=H.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}",
"",3,0);ib=ia.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);ib.addParameter("id","String",1,null,0);ib=ia.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);ib.addParameter("id","String",1,null,0);ia=H.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);ia.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",
0);ib=ia.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);ib.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ia=H.addEnumType("Microsoft.AppRuntime.AppRuntimeState");ia.addEnumField("Inactive",0);ia.addEnumField("Background",1);ia.addEnumField("Visible",2);ia=H.addEnumType("Microsoft.AppRuntime.Visibility");ia.addEnumField("Hidden",1);ia.addEnumField("Visible",2);ia=H.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}",
"{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);ia.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);ib=ia.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);ib.addParameter("jsonCreate","String",1,null,0);ib=ia.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);ib.addParameter("jsonUpdate","String",1,null,0);ib=ia.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);ib.addParameter("id","String",
1,null,0);ib=ia.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);ib.addParameter("id","String",1,null,0);ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ia=H.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);ia.addProperty("Id",2,"String",1,!0,null,0);ib=ia.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);ib.addParameter("visibility","Boolean",1,null,0);ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ia=H.addType("Microsoft.DynamicRibbon.RibbonButton",
"{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);ia.addProperty("Enabled",3,"Boolean",1,!1,null,0);ia.addProperty("Id",2,"String",1,!0,null,0);ia.addProperty("Label",4,"String",1,!0,null,0);ib=ia.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);ib.addParameter("enabled","Boolean",1,null,0);ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ia=H.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);ia.addMethod("GetCount",3,"Int32",1,1,"Count",
0);ib=ia.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);ib.addParameter("key","String",1,null,0);ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ia.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);ia=H.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");ia.addEnumField("Unknown",0);ia.addEnumField("Basic",1);ia.addEnumField("Premium",2);ia=H.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",
3,0);ib=ia.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);ib.addParameter("feature","String",1,null,0);ib.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);ib=ia.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);ib.addParameter("feature","String",1,null,0);ib=ia.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);ib.addParameter("feature","String",
1,null,0);ib.addParameter("fallbackValue","Boolean",1,null,0);ia.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);ib=ia.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);ib.addParameter("experienceId","String",1,null,0);ib=ia.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);ib.addParameter("feature","String",1,null,0);ia=H.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}",
"",3,0);ia.addProperty("Id",5,"String",1,!0,null,0);ia.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);ia.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);ia=H.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);ia.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);ia=H.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification",
"{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);ia.addMethod("Disable",3,"Void",0,1,"Disable",0);ia.addMethod("Enable",2,"Void",0,1,"Enable",0);ia.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)}function oa(H,ia,ib,Lb){this.menuItemId=H;this.YF=ia;this.aEj=ib;this.zyh=Lb}function qa(H){this.dwi=H}function Ea(H){this.Hxa=H;this.cng=ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}function ka(){}function za(){}
function La(){}function Ia(H,ia){this.ihb=ia;this.rA=H}function Ya(){this.y1d=null;this.hfe=this.FVb=this.JD="";this.sge=!0;this.options=null}function tb(H,ia){this.XPb=H;this.Mib=ia}function Tb(){}function va(){this.K5d=this.d5d=this.ifa=null;this.Mib=0}function la(H){var ia=bj.call(this)||this;ia.$=H;ia.Tb();return ia}function $a(){this.initialized=!1;this.agaveCommandManager=this.Je=this.V_a=null;this.yU={}}function Ra(H){var ia=mi.call(this)||this;ia.$=H;ia.Tb();return ia}function eb(){}function mb(){}
function Pa(H,ia,ib,Lb,Nc){var Vc=Ah.call(this)||this;Vc.zRa={};Vc.nad={};Vc.iwa=null;Vc.Zya=null;Vc.Q2h=function(Hd,Ld,Be,df,uf){if(2!==Be)return 32;Hd=uf[Zi.a.T8b];Be=uf[Zi.a.gHa];uf=uf[Zi.a.Jya];Ld=new Fj.a;Ld.Yai=uf.optionalProperties.InstanceToken;Ld.Yk=uf.optionalProperties[Zd.Yk];Ld.yS=uf.optionalProperties[Zd.yS];Zd.taskPaneWidth in uf.optionalProperties&&(Ld.taskPaneWidth=uf.optionalProperties[Zd.taskPaneWidth]);Ld.sourceLocationOverrideResourceId=uf.optionalProperties[Zd.sourceLocationOverrideResourceId];
Ld.$H=uf.Dq;Ld.onTaskPaneClose=uf.optionalProperties[Zd.onTaskPaneClose];Ld.gHa=Be;Be=new Lk.a(-859308420,0,2,0,"");df=Hd.getStoreType()===OSF.StoreType.Sdx;var og=new kf;og.cba=uf.optionalProperties.HeaderCssClass||Si.a.f2a;og.dNb=uf.optionalProperties.TitleCssClass;Vc.D7(Be,Hd.getId(),Ld,df,og);return 32};Vc.B2h=function(Hd,Ld,Be,df,uf){if(2!==Be)return 32;Hd=uf[Zi.a.T8b].getId();uf=uf[Zi.a.Jya].optionalProperties[Zd.sourceLocationOverrideResourceId];return Hd?(Vc.Je.Ei.refreshOsfControl(Hd,uf),
32):8};Vc.oYi=function(Hd){Hd=Hd.Result;if(Hd=null===Hd?null:Hd.SolutionId)Vc.Je.Fke(Hd),ok.a(Vc.$).rna(3,Hd)};Vc.CGf=function(Hd,Ld){var Be,df=(Hd=Hd.Result)?Hd.AgaveData:null;if(df){af.ULS.shipAssertTag(537170434,0,df.TaskpaneWidth===Pa.$bh,"Taskpane width is {0}, assetId is {1}.",df.TaskpaneWidth,Telemetry.PrivacyRules.GetPrivacyCompliantId(df.PrimaryMarketplace.SolutionId,df.PrimaryMarketplace.MarketplaceType,null===(Be=null===df||void 0===df?void 0:df.AssetMarketplace)||void 0===Be?void 0:Be.SolutionId,
null,null,df.PrimaryMarketplace.MarketplaceRef));if(Be=Vc.nad[df.PrimaryMarketplace.SolutionId])Be.zzc&&(df.TaskpaneTitle=Be.zzc),Be.xzc&&(df.TaskpaneIconId=Be.xzc),Be.zUd&&(df.TaskpaneButtonTooltip=Be.zUd),0<Be.xu&&(df.TaskpaneWidth=Be.xu);Ld&&(df.FocusOnIframeWhenLoaded=Ld.focusOnIframeWhenLoaded,Ld.width&&(df.TaskpaneWidth=Ld.width),df.TaskpaneIconCssClass=Ld.Rk,df.TaskpaneHeaderCssClass=Ld.cba,df.TaskpaneTitleCssClass=Ld.dNb,df.IsFirstPartyOptOutAppContextOptmization=Ld.isFirstPartyOptOutAppContextOptmization);
Vc.zRa[df.PrimaryMarketplace.SolutionId]&&(df.OsfPropertyBag=Vc.Mvd(df.OsfPropertyBag,df.PrimaryMarketplace.SolutionId));Ji.a(df)||(df.WebExtensionOsfControlType=1);df&&(Vc.Je.Fke(Hd.SolutionId),Vc.Je.w0a(df))}else af.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};Vc.Jxh=function(Hd){Hd&&(Vc.v$c.Thf(Hd),Vc.lwe())};Vc.GGf=function(Hd){Hd=Hd.toDataURL("image/jpeg");var Ld=Vc.Je.waa(Pa.U6e+"."+Pa.E3e);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Ld,
"onScreenshot",{screenshot:Hd},function(){})};Vc.b1h=function(Hd,Ld,Be,df,uf){if(2!==Be)return 32;if(qe.a.Fh(uf)||uf[Zi.a.qAe]!==Dk.a.action)return 8;Ld=uf[Zi.a.Jya];return Ld?(Hd=(Hd=Vc.nSh(uf))?Vc.Je.waa(Hd):null)?(uf=Vc.Je.r3g(uf[Zi.a.gHa],Ld.optionalProperties[Zd.gTc]),Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(Be=Vc.Je.tZ(Hd),Be.TaskpaneTitle!==Ld.optionalProperties[Zd.Yk]&&(Be.TaskpaneTitle=Ld.optionalProperties[Zd.Yk],Be.TaskpaneIconCssClass=Ld.optionalProperties.IconCssClass,
Be.TaskpaneIconUrl=Ld.optionalProperties.TaskPaneIconUrl,Be.TaskpaneIconId=Ld.optionalProperties.TaskPaneIconId,Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(Ld=Vc.Je.Ei,Ld.changeIframeTitle(Hd,Be.TaskpaneTitle),Be=Ld.getOsfControl(Hd),Ld.raiseOsfControlStatusChange(Be)):(Ld=Vc.Je.Ei.getOsfControl(Hd),Vc.Je.Ei.raiseOsfControlStatusChange(Ld)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Hd,uf,Vc.GJb),32):8:8};Vc.GJb=function(Hd,Ld){Vc.Je.pAh(Hd,
Ld)};Vc.$=H;Vc.viewBlockContainerHelpers=ib;Vc.Je=ia;Vc.v$c=Lb;Vc.Ci=Nc;Vc.Ci.fc(kj.a.t2f,Ed.a.frame,Vc.Q2h);Vc.Ci.fc(kj.a.ESf,Ed.a.frame,Vc.B2h);Vc.Ci.fc(kj.a.yQe,Ed.a.frame,Vc.b1h);return Vc}function Da(){var H=Ej.call(this)||this;H.YUa="calc(100% - 46px)";H.hRb="15px";H.ZUa="0";H.Qmg="WACDialogPanel";H.VCa=695;H.Rmg=462;H.Ihb="80%";H.Ekg=350;H.P1d="100%";H.ic=5;H.Ne="AppsForOfficeInsertionDialog";H.OHc=!!ag.AFrameworkApplication.fa&&ag.AFrameworkApplication.fa.ra("OfficeAddinEnableInsertDialogAccessibilityFix");
return H}function Ta(){var H=Sa.call(this)||this;H.isTable=!1;H.isPivotTable=!1;H.hasTableHeaders=!1;H.tableName=null;H.userSelectedPivotTable=!1;return H}function Sa(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}function Cb(){this.zUd=this.zzc=null;this.xu=0;this.xzc=null}function cc(){var H=this;this.Je=null;this.eab=function(ia,ib,Lb,Nc,Vc){if(2===Lb){ia=Vc?Vc:{};
ib=ia.callback;if(!ib)return 16;H.Je.Uca(ib,ia.refresh?ia.refresh:!1)}return 32};this.e7i=function(ia,ib,Lb,Nc,Vc){2===Lb&&(ia=Vc?Vc.callback:null)&&H.Je.PDg(ia);return 32}}function nc(){}function Nb(H){return Ic.call(this,H)||this}function nb(H){var ia=Oc.call(this)||this;ia.$=H;ia.isFirstLaunch=!1;return ia}function db(H){af.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.snf=ag.AFrameworkApplication.fa.ra("IsTellMeUpSellEnterpriseEnabled");this.wvi=ag.AFrameworkApplication.fa.Va("SmartLookupApprovedOriginPattern");
this.i8a=ag.AFrameworkApplication.fa.Va("SmartLookupShredderServiceEndpoint");this.bwi=hl.a.DM(ag.AFrameworkApplication.fa.Va("AppCatalogUrl")||"");this.h8a=new Eb;this.h8a.EnableAllTabV2=!0;this.h8a.EnableIntentService=!0;this.h8a.EnableInDocumentSearch=ag.AFrameworkApplication.fa.ra("SmartLookupEnableInDocumentSearch");this.h8a.EnableLocalSearch=ag.AFrameworkApplication.fa.ra("SmartLookupEnableLocalSearch");this.h8a.IntentServiceEndpoint=Bb.SVh();this.Wvi=new zc(H,this.i8a)}function Bb(){}function zc(H,
ia,ib){this.LIj=9E5;this.OIj=3E5;this.Cud=null;this.Mmf="";this.zud=0;this.xFe=Date.now;this.Hxa=H;this.i8a=ia;(void 0===ib||ib)&&this.ocd()}function Eb(){}function Ja(){}function Rb(){}function yc(){}function qd(){}function bc(H,ia,ib,Lb,Nc,Vc){this.$=H;this.agaveCommandManager=Vc}function Vb(H){var ia=gd.call(this)||this;ia.ddaFacade=null;ia.ALf=null;ia.$=H;H.da.Ga(106,ia);ia.Tb();return ia}function mc(){}function sb(){}function Yb(H){this.fFa=H}function Hb(H,ia,ib){this.iframe=H;this.onSuccess=
ia;this.onError=ib;$addHandler(window,"message",Object(zh.a)(this,this.k5e,"handleResponse"))}function sc(H,ia){return ek.a.Ysd(43,function(){return window.OfficeExtension&&window.OfficeExtension.WacRuntime},ag.AFrameworkApplication.fa.Dd("MaxRetriesForLoadingScript",0),H,ia)}function zb(H){var ia=W.call(this)||this;ia.$=H;ia.Tb();return ia}function vc(H,ia){var ib=this;this.HPa=this.IPa=null;this.K9f=function(Lb,Nc){var Vc=null,Hd=null,Ld=null;Nc?(Object(xj.a)(475,Nc)?(Vc=Nc.UFa,Ld=Nc.instanceId):
Object(xj.a)(406,Nc)&&(Vc=Nc.get_element(),Ld=Nc.instanceId),Vc)?(Hd=Object(lj.a)(503,Lb),Hd)?ib.BLf(Ld,Vc,Hd)||Ld in ib.HPa||(ib.IPa[Ld]=0,ib.HPa[Ld]=rl.a.instance.tC(function(){10<=ib.IPa[Ld]||ib.BLf(Ld,Vc,Hd)?(delete ib.IPa[Ld],ib.HPa[Ld].dispose(),delete ib.HPa[Ld]):ib.IPa[Ld]+=1},500,ml.a.SHg,!0,!1)):af.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):af.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):
af.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=H;this.$=ia;this.hXc=!1;this.$.da.Ga(224,this)}function ad(H){var ia=Ij.call(this)||this;ia.$=H;ia.Tb();return ia}function ub(H){var ia=el.call(this,H)||this;ia.handler=null;ia.Wyg=function(){af.ULS.sendTraceTag(38410434,0,50,"AddinUICommandHandlerFactory.ActivateFeature, isEditMode [{0}] ShowCommandUI [{1}]",ia.$.isEditMode,!!(ia.$.Qd&16384));var ib=new yk.a;ia.$.da.$a(53,function(uf){af.ULS.sendTraceTag(38410435,
0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");ib.setResult(uf)});var Lb=ib.task,Nc=new ne,Vc=pl.a.getInstance(),Hd=new Fe(ia.$,Vc),Ld=hj.GetServiceTaskFactory.create(ia.$.da,203,ia.la,ia.vb),Be=ia.f6i(Nc),df=hj.GetServiceTaskFactory.Xa(ia.$.da,349,350,ia.vb);return Nh.TaskExtensions.Ba(Nh.TaskExtensions.te([Lb,Ld,Be,df],ia.la),function(){af.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");
Nh.TaskExtensions.Ba(hj.GetServiceTaskFactory.create(ia.$.da,106,ia.la,ia.vb),function(uf){ia.handler=new Za(ia.$,uf.result,Nc,new he,Vc,Hd,Yd.a.instance.Lh("Common.IExternalUICommandDefinitionMapping"));af.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");ia.Cd([ia.handler]);ia.$.da.Ga(198,ia.handler)},ia.la,3)},ia.la,3)};ia.jbh=function(){void 0!==ia.handler&&null!==ia.handler?(ia.$.Ka.Qab(ia.handler),ia.$.da.QU(198),ia.handler=null):af.ULS.sendTraceTag(42341715,
0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");ia.$.da.QU(204);ll.a(Tk.a,21,ia.$.da,198)};return ia}function Za(H,ia,ib,Lb,Nc,Vc,Hd){var Ld=this;Hd=void 0===Hd?null:Hd;this.disposed=!1;this.WEi=function(Be,df){if(df)if(df)if(Be=df.Mm){df=df.Ho;var uf=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(Be.solutionId in uf)df=uf[Be.solutionId];else if(df=Ld.uKh(df),void 0===df||null===df){af.ULS.sendTraceTag(528098434,
220,15,"addinCommandControlId is NullOrUndefined");return}uf=new Lk.a(kj.a.A2,0,0,2,null);var og={};Ld.executeCommand(0,uf,(og.SourceControlId=df,og),null);Be.isAutoLaunched=!0}else af.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else af.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else af.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.oMi=function(Be,df){Be=null;df&&(Be=df);(null===Be||void 0===Be?0:Be.Ho)&&Ld.zqj(Be.Ho);Ld.$.Bf();Fg.EwaSettings.ma(88)&&
Be&&Be.Mm&&Ld.xMg(Be.Mm)};this.$=H;af.ULS.shipAssertTag(537170659,0,!(void 0===ia||null===ia),"AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: {0}",jk.a.v3());this.Je=ia;this.bBe=ib;this.JZb=Lb;this.Wga=Nc;this.unb=Vc;this.Po=new Sk.a;this.Uga=new Cf;this.h$c=Hd;Wk.a.kxb=Wk.a.uQe;this.n5c=new Kg.a;this.l1a=new Kg.a}function wa(H){var ia=this;this.JFa=this.NFa=this.Mm=this.Ho=null;this.ZNf=0;this.nMi=function(){if(ia.Mm&&ia.JFa){var ib=new Lk.a(kj.a.A2,0,0,2,null),
Lb={};ia.addinUICommandHandler.executeCommand(0,ib,(Lb.SourceControlId=ia.JFa,Lb),null);af.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.qxj=function(ib,Lb){ib=null;if(Lb)if(ib=Lb,ia.Mm=ib.Mm,ia.Ho=ib.Ho,ia.Ho&&ia.Ho.pW&&ia.Ho.pW.Ps&&(ia.NFa=ia.Ho.pW.Ps.oa(0)),ia.NFa&&ia.NFa.id)if(ia.NFa.isOfficeTab)if(Lb=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),ib=wa.UDc?ia.Mm.solutionId:ia.Mm.assetId,ib in Lb?ia.JFa=Lb[ib]:(af.ULS.sendTraceTag(537170695,
220,15,"Failed to get button id from controlIdMap for add-in: {0}",wa.GetPrivacyCompliantId(ia.Mm)),ia.JFa=ia.LGh(ia.Ho)),ia.JFa)if(Kj.a.contains(ia.NFa.id,gh.a.JW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Ek.a.pub(ia.Ho),function(){ia.t3f(ia.yfd(ia.JFa))});else{if(Lb=ia.$.Ka)Lb.Jne(ia.xCf),af.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else af.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),Lb={},Lb=(Lb.AppTeachingUICalloutAction=
"NoEnabledButtonFound",Lb["SDX.Id"]=wa.GetPrivacyCompliantId(ia.Mm),Lb.AppTeachingUICalloutGoal="NewAdminDeployment",Lb["SDX.AppInstallOrigin"]="Organization",Lb),Db.a.sendTelemetryEvent(Object(Kf.a)(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(Lb)})),ia.U5();else ia.v3f(ia.yfd(ia.NFa.id),0);else af.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),Lb={},Lb=(Lb.AppTeachingUICalloutAction="NoTabFound",Lb["SDX.Id"]=
wa.GetPrivacyCompliantId(ia.Mm),Lb.AppTeachingUICalloutGoal="NewAdminDeployment",Lb["SDX.AppInstallOrigin"]="Organization",Lb),Db.a.sendTelemetryEvent(Object(Kf.a)(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(Lb)})),ia.U5();else ia.U5()};this.xCf=function(){if(Kj.a.contains(ia.NFa.id,appChrome.selectors.getSelectedTabId(),!0)){var ib=ia.$.Ka;ib&&ib.VPf(ia.xCf);ia.t3f(ia.yfd(ia.JFa))}};this.$=H.$;this.addinUICommandHandler=H;this.appName=ag.AFrameworkApplication.fa.Va("WebAppShortName")||
"Excel";this.dHg=ag.AFrameworkApplication.fa.Dd("AddinMaxDOMElementDetectionTimesForTeachingUI",10)}function ja(H,ia){this.$jb=H;this.sUa=new cb;this.UUa=new Qa(ia)}function Ua(H,ia,ib,Lb,Nc,Vc){this.fQb=new Kg.a;this.qhb=this.cfa=this.hVa=null;this.DNc=H;this.sUa=ia;this.UUa=ib;this.Ks=Lb;this.iQb=Nc;this.y5d=Vc}function bb(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}function Xa(){this.iconLocation=
this.title=this.id=null;this.enabled=!1;this.attributes=null}function yb(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}function Ib(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}function Qa(H){this.GCa=H}function cb(){}function lb(H){this.$jb=H}function Ha(H,ia,ib){this.RI=this.gVa=null;this.DNc=H;this.UUa=ia;this.sUa=ib;this.Rrg=new Kg.a}function $b(H){this.Gpa=null;if(Dj.c(H))throw af.ULS.sendTraceTag(9175314,
220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=H}function Jb(H){this.wae=null;if(Dj.c(H))throw af.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=H;this.ula[uc.id]=this._id}function kc(H,ia){this.YDa=this.y3d=null;if(Dj.c(H)||Dj.c(ia))throw af.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),
Error.create("ControlDefinition id or type should not be null or undefined");this.gmg=ia;this._id=H;this.AU[uc.id]=this._id}function uc(){}function hd(H,ia,ib,Lb,Nc,Vc,Hd,Ld){Ld=void 0===Ld?null:Ld;this.Za=new Qk.a;this.yEc=H;this.amg=ia;this.En=ib;this.Rhe=Lb;this.aXa=Nc;this.ujg=Vc;this.iQb=Hd;this.usg=Ld;this.dTb=ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinTelemetryEnabled",!1);this.iqg=ag.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")}
function ma(H,ia,ib,Lb,Nc,Vc,Hd){this.xSa=new Ok.a;this.pt=H;this.Ei=ia;this.Po=ib;this.ribbonManager=Lb;this.contextMenuManager=Nc;this.QF=Vc;this.Uga=Hd;this.AO=ag.AFrameworkApplication.sa.yD}function jb(H,ia,ib){this.W0d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=H;this.eventBuilder=ia;this.contextMenuBuilder=ib}function Zb(H){this.hng=H.entitlement}function Ub(H,ia,ib){ia=void 0===ia?null:ia;ib=void 0===ib?0:ib;if(Dj.c(H))throw af.ULS.sendTraceTag(9041814,
220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.Csg=H;this.Zvg=ia;this.jog=ib}function Qc(H){this.Obe=null;if(Dj.c(H))throw af.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.Gjg=H}function kd(){}function xb(H){this.R9d=null;this.L7d=H}function bd(H,ia,ib){this.Ytc=!1;this.opa=null;this.Za=
H;this.Sib=ia;this.kgb=ib}function Qd(H,ia,ib,Lb,Nc,Vc){this.pt=H;this.Mm=ia;this.f7=ib;this.displayName=Nc;this.pif=Vc}function zd(){var H=Kk.call(this)||this;H.Mm=null;H.Ho=null;return H}function Jd(){new gc(Fk.a.instance)}function gc(H){this.RDa=H}function Hc(){this.Ver=1}function Tc(){}function Md(H){this.Jsg=H}function Xc(H,ia,ib){this.Pa=new Qk.a;this.context=new qf;this.Kyc=this.SWc=this.ySd=this.KFa=this.Rza=this.opa=null;this.contextActivationMgr=H;this.aHg=ia;this.KZb=ib;this.appName=ag.AFrameworkApplication.fa.Va("WebAppShortName")}
function Cd(H){var ia=oj.call(this)||this;ia.solutionId=H.solutionId;ia.assetId=H.assetId;ia.storeType=H.storeType;ia.storeId=H.storeId;ia.assetStoreId=H.assetStoreId;ia.targetType=H.targetType;ia.width=H.width;ia.height=H.height;ia.displayName=H.displayName;ia.version=H.version;return ia}function Sb(){this.addinId=null;this.targetType=0;this.storeId=this.assetId=this.solutionId=null}function Mc(H,ia,ib,Lb){this.OIb=ag.AFrameworkApplication.fa.Va("RoamingServiceHandlerWebServiceBase");this.appName=
H;this.zib=ia;this.vib=ib;this.Fkb=void 0===Lb?null:Lb}function md(H){var ia=jl.call(this)||this;ia.properties=H;return ia}function wc(){this.wA=this.oq=null;this._count=0}function ed(H,ia,ib){this.next=ib;this.previous=ia;this.data=H}function Nd(H){this.Kr=null;this.oA=H}function pe(H){var ia=-1;switch(H.toLowerCase()){case "omex":ia=0;break;case "spcatalog":ia=1;break;case "spapp":ia=2;break;case "filesystem":ia=3;break;case "exchange":ia=4;break;case "registry":ia=6;break;case "inmemory":ia=7;
break;case "uploadfiledevcatalog":ia=8;break;case "hardcodedpreinstall":ia=9;break;case "excatalog":ia=10;break;case "wopicatalog":ia=16}return ia}function Ec(H){var ia=null;switch(H){case 0:ia="omex";break;case 1:ia="spcatalog";break;case 2:ia="spapp";break;case 3:ia="filesystem";break;case 4:ia="exchange";break;case 6:ia="registry";break;case 7:ia="inmemory";break;case 8:ia="uploadfiledevcatalog";break;case 9:ia="hardcodedpreinstall";break;case 10:ia="excatalog";break;case 16:ia="wopicatalog"}return ia}
function rd(H){var ia={};ia.solutionId=H.solutionId;ia.version=H.version;ia.storeType=H.storeType;ia.storeId=H.storeId;ia.assetId=H.assetId;ia.assetStoreId=H.assetStoreId;ia.targetType=H.targetType;ia.requireConsent=H.requireConsent||!1;ia.isAddinCommands=!0;ia.addinCommandsActionType=0;return ia}function Dd(){return hl.a.w4(window.location.href.toLowerCase(),"wdtpl")}function wb(){var H=hl.a.w4(window.location.href.toLowerCase(),"wdomexsrctype");return!!H&&"4"===H}function lf(){}function qf(){this.pt=
this.c0=0;this.xVc=null;this.Eqc=this.kAc=0;this.C3b=this.eja=this.O9=null}function Cf(){this.GYa=null}function Fe(H,ia){var ib=cl.call(this)||this;ib.statusBarManager=null;ib.agaveCommandManager=null;ib.dye=function(){ib.QF&&ib.QF.Kxe()};ib.f4e=function(){ib.raiseEvent("LAC")};ib.od=function(Lb,Nc){!Lb.rc&&Pk.b(Nc)&&ib.statusBarManager&&(ib.statusBarManager.HF(ib),ib.statusBarManager=null)};ib.QF=ia;ib.$=H;ib.xDj=H.Mb+"OfficeAddinLabel-Medium14";ib.$.da.$a(29,function(Lb){ib.statusBarManager=Lb;
Lb.nJ(ib)});ib.$.ea.hk(ib.od);ib.QF.dDg(ib.f4e);ib.$.da.$a(206,function(Lb){ib.agaveCommandManager=Lb;Lb.GEg(ib.dye)});return ib}function Ke(){}function $d(){this.Ai=null;this.visible=!1}function Id(H,ia){this.Ta=H;this.z1g=ia}function he(){this.B1d=this.gEc=null}function Af(){}function ne(){this.$kg=new Kg.a}function Te(H){return bl.call(this,H)||this}function Ac(H,ia,ib){this.Krb=null;this.$=H;ia?(af.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),
this.Krb=new mj.a(H,ia,ib)):af.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}function Kd(H){var ia=pk.call(this)||this;ia.$=H;ia.Tb();return ia}function ce(H,ia){var ib=sd.call(this)||this;ib.$=H;ib.t1a=new DOMParser;ib.cache=new qj.a;ib.indexedDB=ia;ia.Sf()&&ib.indexedDB.initialize("Scripts","OfficeScriptingCache");ib.Jwb=!1;ib.jq=new lc([],function(Lb){sd.BBj(Lb)});ib.Tj=new lc([],function(Lb){sd.ASd(Lb)});ib.CB=new lc([],
function(Lb){sd.ASd(Lb)});ib.ut=new lc([],function(){});return ib}function sd(){this.ut=null;this.Jwb=this.YGb=this.LW=this.uab=this.oGd=this.hLf=this.mGd=this.vab=this.jdc=!1;this.CB=this.Tj=this.jq=null}function Ge(H,ia,ib,Lb){var Nc=this;this.O6a=!1;this.c9a=function(){Nc.l1f()?(Nc.MGf(),vj.g(Nc.$).Ea.pId(Nc.c9a)):Nc.O6a&&vj.g(Nc.$).Ea.pId(Nc.c9a)};this.VGi=function(Vc,Hd){Object.getType(Hd)===String&&Hd.toString().endsWith(sf.a.Nvb(Nc.$))&&(Nc.O6a=!1)};this.$=H;this.kha=ia;this.Ou=ib;this.businessBarManager=
Lb;this.Psj()}function kf(){this.focusOnIframeWhenLoaded=!1;this.width=0;this.dNb=this.cba=this.Rk=null;this.isFirstPartyOptOutAppContextOptmization=!1}function Ze(H,ia,ib,Lb,Nc,Vc,Hd,Ld,Be){var df=this;this.HA=null;this.cache=new qj.a;this.Iwa=!1;this.TFa={};this.$=H;this.LPc=ib;this.indexedDB=Lb;this.vob=Nc;this.Ou=Vc;this.kha=Hd;this.qf=Ld;this.fC=Be;this.BMg=new Kc(this,H);this.Fpg=zi.a.Ua.Vb;this.J5f="";Lb.Sf()&&(this.Iwa=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));H=!0;if(hb.a.Kte){this.cache.Sf()&&
!sf.a.Jta&&(ia=this.qf.KIh(sf.a.Y$b(this.$)),ia.isSuccess&&(H=Di.getElapsedSeconds(ia.timeStamp,zi.a.Ua.Vb),this.Ou.ly=new Wf(!0,!0),this.HA=new Wf(ia.value,!0),H=this.HA.value?604800<H:86400<H,this.Lwb=this.QRa(!0)));this.QGh();if("undefined"!==typeof makerstorage&&this.jhf)if(this.J5f=dc(this.$),Wb(this.$))Xd(this.$,"localstorageToken"),this.Ou.ly=new Wf(!0,!0),this.HA=new Wf(!0,!0),this.Lwb=this.QRa(!0);else if((ia=sf.a.ZZe())&&makerstorage.setStorageEnvironmentOverride(ia),H||sf.a.Jta)try{this.$.zcb("automateTab",
!0),this.Lwb=sf.a.Jta?this.Ou.M_c().then(function(){return df.kha.vvb()}).then(function(){return df.QRa(!1)}).catch(function(){return df.QRa(!1)}):this.Ou.M_c().then(function(){return df.kha.vvb()}).then(function(uf){return df.q3h(uf)}).then(function(){return df.QRa(!1)}).catch(function(){return df.QRa(!1)})}catch(uf){af.ULS.sendTraceTag(537170314,0,15,"AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: {0}",uf.message),this.Lwb=Promise.resolve(!1),this.$.zcb("automateTab",
!1)}Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:5925531_useHasShownAutomateTabPromise")&&this.Lwb?this.Lwb.then(function(uf){return df.BJd(uf)}):this.BJd(!1)}else af.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.BJd(!1)}function je(H,ia,ib,Lb,Nc,Vc){this.actionName=H;this.shapeId=ia;this.scriptLink=ib;this.clickId=Lb;this.Gba=Nc;this.buttonText=Vc}function dg(H,ia,ib,Lb){this.Ojd=H;this.Pwh=ia;
this.Jya=ib;this.gHa=Lb}function Zd(){}function of(){this.ly=null;return this}function Wf(H,ia,ib,Lb,Nc){this.value=H;this.isSuccess=ia;this.timeStamp=void 0===ib?null:ib;this.errorCode=void 0===Lb?"":Lb;this.errorMessage=void 0===Nc?"":Nc}function $f(){this.ly=null}function mg(H,ia){this.DW=null;this.$=H;this.qf=ia;return this}function Qf(H){this.K$=$c.b(H)||{};this.shareId=this.shareId||null}function lc(H,ia){this.scripts=H;this.r4f=ia}function Kc(H,ia){this.automateCommandManager=H;this.$=ia}function Fd(H){return Ee.a.Ld(H)?
Si.a.qNe:Si.a.pNe}function re(H){return Ee.a.Ld(H)?H.isChromeRtl?Si.a.$ph:Si.a.Zph:Si.a.f2a}function ke(H){H=H.na.va.Na(1);H.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return H}function nd(H,ia,ib,Lb,Nc){function Vc(){function og(dh,th,Ki){return Zc.i(Ld.va,"ExecuteRichApiRequest",Lb,Ue.b(dh,ia),Ue.a(th,ib),Ki,null,0)}if(Hd.mHa()||
0<Ld.va.h4||0<Ld.Mk.h4)return!1;Be&&Hd.Ul(Be);df&&Ld.Ar(df);uf&&Ld.Qz(uf);Fg.EwaSettings.qc()?Hd.Zt(new tc.a(507,0,og,80)):Hd.Zt(new Mb.a(507,0,og,16));return!0}var Hd=H.userOperationManager,Ld=H.na,Be=null,df=null,uf=null;Vc()||(Be=function(){Vc()},df=function(){Vc()},uf=function(){Vc()},Hd.xq(Be),Ld.zq(df),Ld.Uy(uf));return Nc.task}function dc(H){if(Wb(H))return Fg.EwaSettings.getBooleanFeatureGate(sf.a.oCb,!1)?"makerservicelocal":"localstorage";H=sf.a.ZZe();return sf.a.UWh(H)}function Xd(H,ia){Wb(H)&&
(Fg.EwaSettings.getBooleanFeatureGate(sf.a.oCb,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(H.ya.UserSessionId);makerstorage.setUserAccessInfo(new hc(ia,null));makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,"1")}function sa(){return Fg.EwaSettings.getBooleanFeatureGate(sf.a.wtj,!1)}function ob(H,ia){ia.WacTaskPaneInfra=Ee.a.Ld(H);ia.TaskpanelessRFB=Fg.EwaSettings.getBooleanFeatureGate(sf.a.z7f,!1);ia.OfficeScriptsAutomateTask=
sf.a.tsf;ia.DeferAdminCheck=sf.a.Jta;ia.SharedScriptsButton=sa()}function Wb(H){return"TestHost"===H.ya.DocumentHostInfo.HostTier}function hc(H,ia){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=H;this.currentUserMlapiToken=ia}function pc(){this.DW=null}function xd(H,ia,ib){var Lb,Nc;this.$=H;this.oAuthManager=ia;this.Ou=ib;this.pob=new Gd;this.hse=null!==(Nc=null===(Lb=this.oAuthManager)||void 0===Lb?void 0:Lb.C5a())&&void 0!==Nc?Nc:!1}function Gd(){this.token=null;this.timeStamp=
0}function te(H){return Aj.call(this,H)||this}function Sd(H,ia){this.automateCommandManager=H;this.$=ia}function If(H){var ia=dk.call(this)||this;ia.$=H;ia.Tb();return ia}function pf(H){this.Jb=null;this.$=H}function Ef(){return L.call(this)||this}function pg(){return L.call(this)||this}function Ag(){return L.call(this)||this}function Nf(){return L.call(this)||this}function Lg(){return L.call(this)||this}function Mg(){return L.call(this)||this}function Hg(){return L.call(this)||this}function nh(){return L.call(this)||
this}function Ae(){return L.call(this)||this}function Dg(){return L.call(this)||this}function Jf(){return L.call(this)||this}function fg(){return L.call(this)||this}function Jg(){return L.call(this)||this}function Og(){return L.call(this)||this}function ef(){return L.call(this)||this}function ng(){return L.call(this)||this}function Xb(){return L.call(this)||this}function da(){return L.call(this)||this}function Aa(){return L.call(this)||this}function qb(){return L.call(this)||this}function jc(){return L.call(this)||
this}function id(){return L.call(this)||this}function Gc(){return L.call(this)||this}function Rd(){return L.call(this)||this}function Ce(){return L.call(this)||this}function Re(){return L.call(this)||this}function Pf(){return L.call(this)||this}function Le(){return L.call(this)||this}function kg(){return L.call(this)||this}function vg(){return L.call(this)||this}function gg(){return L.call(this)||this}function Bc(){return L.call(this)||this}function od(){return L.call(this)||this}function td(){return L.call(this)||
this}function le(){return L.call(this)||this}function Ve(){return L.call(this)||this}function Pe(){return L.call(this)||this}function yf(){return L.call(this)||this}function Cg(){return L.call(this)||this}function hg(){return L.call(this)||this}function Lf(){return L.call(this)||this}function $e(){return L.call(this)||this}function lg(){return L.call(this)||this}function ae(){return L.call(this)||this}function se(){return L.call(this)||this}function Wh(){return L.call(this)||this}function zf(){return L.call(this)||
this}function fh(){return L.call(this)||this}function ya(){return L.call(this)||this}function Ob(){return L.call(this)||this}function Lc(){return L.call(this)||this}function Ad(){return L.call(this)||this}function Pd(){return L.call(this)||this}function He(){return L.call(this)||this}function Me(){return L.call(this)||this}function Se(){return L.call(this)||this}function Ff(){return L.call(this)||this}function Oe(){return Ie.call(this,195,16)||this}function Na(){return Ie.call(this,194,8)||this}function kb(){return L.call(this)||
this}function ic(){return Ie.call(this,198,2)||this}function Rc(){return Ie.call(this,197,1)||this}function dd(){return Ie.call(this,196,32)||this}function Od(){return L.call(this)||this}function me(){return Ie.call(this,193,4)||this}function Ie(H,ia){var ib=L.call(this)||this;ib.pfa=H;ib.VYd=ia;return ib}function Xe(){return L.call(this)||this}function wf(){return L.call(this)||this}function De(){return L.call(this)||this}function oc(){return L.call(this)||this}function Yc(){return L.call(this)||
this}function hf(){return L.call(this)||this}function ie(){return Ig.call(this,11,16)||this}function bf(){return Ig.call(this,10,128)||this}function Wd(){return L.call(this)||this}function ee(){return L.call(this)||this}function Yg(){return L.call(this)||this}function Sf(){return L.call(this)||this}function vd(){return L.call(this)||this}function vf(){return L.call(this)||this}function rh(){return L.call(this)||this}function cg(){return L.call(this)||this}function eh(){return L.call(this)||this}function Ud(){return Ig.call(this,
9,2)||this}function lh(){return Ig.call(this,8,1)||this}function Eg(){return Ig.call(this,7,8)||this}function Vf(){return Ig.call(this,6,32)||this}function ve(){return L.call(this)||this}function Rg(){return L.call(this)||this}function hh(){return L.call(this)||this}function ff(){return L.call(this)||this}function Ih(){return L.call(this)||this}function Eh(){return L.call(this)||this}function Xf(){return L.call(this)||this}function jj(){return L.call(this)||this}function Yh(){return L.call(this)||
this}function sh(){return L.call(this)||this}function ii(){return L.call(this)||this}function Bg(){return L.call(this)||this}function Ga(){return L.call(this)||this}function Kb(){return L.call(this)||this}function qc(){return Ig.call(this,4,64)||this}function Wc(){return L.call(this)||this}function Dc(){return L.call(this)||this}function de(){return L.call(this)||this}function ye(){return L.call(this)||this}function Gf(){return L.call(this)||this}function jf(){return L.call(this)||this}function Hf(){return L.call(this)||
this}function Df(){}function Rf(){return L.call(this)||this}function Of(){return Ig.call(this,3,4)||this}function Ig(H,ia){var ib=L.call(this)||this;ib.pfa=H;ib.VYd=ia;return ib}function Sh(){return L.call(this)||this}function Fh(){return L.call(this)||this}function zg(){return L.call(this)||this}function ki(){return L.call(this)||this}function Hi(){return rf.call(this,185,18)||this}function ug(){return L.call(this)||this}function wi(){return rf.call(this,181,14)||this}function Fa(){return rf.call(this,
169,2)||this}function na(){return rf.call(this,168,1)||this}function Gb(){return L.call(this)||this}function Vd(){return rf.call(this,182,15)||this}function ge(){return L.call(this)||this}function We(){return L.call(this)||this}function Vg(){return rf.call(this,180,13)||this}function Qg(){return rf.call(this,186,19)||this}function jg(){return rf.call(this,175,8)||this}function sg(){return rf.call(this,176,9)||this}function Th(){return rf.call(this,187,20)||this}function Bi(){return rf.call(this,174,
7)||this}function ri(){return rf.call(this,179,12)||this}function pi(){return rf.call(this,178,11)||this}function vi(){return rf.call(this,177,10)||this}function jh(){return L.call(this)||this}function Ng(){return rf.call(this,170,3)||this}function ji(){return rf.call(this,172,5)||this}function we(){return rf.call(this,173,6)||this}function vh(){return rf.call(this,183,16)||this}function Ph(){return rf.call(this,184,17)||this}function Mf(){return rf.call(this,171,4)||this}function rf(H,ia){var ib=
L.call(this)||this;ib.pfa=H;ib.opType=ia;return ib}function oi(){return L.call(this)||this}function bh(){return L.call(this)||this}function ah(){return L.call(this)||this}function wh(){return L.call(this)||this}function xi(){return L.call(this)||this}function O(){return L.call(this)||this}function fa(){return L.call(this)||this}function Va(){return L.call(this)||this}function d(){return L.call(this)||this}function r(){return L.call(this)||this}function S(){return L.call(this)||this}function ca(){return L.call(this)||
this}function Ka(){return L.call(this)||this}function fc(){return L.call(this)||this}function pb(){return L.call(this)||this}function Z(){return L.call(this)||this}function Ba(){return L.call(this)||this}function Fb(){return L.call(this)||this}function xc(){return L.call(this)||this}function Pc(){return L.call(this)||this}function Sc(){return L.call(this)||this}function oe(){return fi.call(this)||this}function gf(){return L.call(this)||this}function xf(){return L.call(this)||this}function Uf(){return L.call(this)||
this}function Zf(){return L.call(this)||this}function Ne(){return L.call(this)||this}function ch(){return L.call(this)||this}function yh(){return L.call(this)||this}function nf(){return L.call(this)||this}function Ci(){return L.call(this)||this}function kh(){return Uh.call(this,78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])||this}function Xi(){return Uh.call(this,79,[0,1,2,-102])||
this}function hi(){return Uh.call(this,75,[-101])||this}function Mi(){return Uh.call(this,81,[100,101,102,103,104,105,106])||this}function uj(){return L.call(this)||this}function uh(){return Uh.call(this,85,[328,329,330,331,332,333,334,335])||this}function Ui(){return fi.call(this)||this}function Zh(H,ia,ib){this.response=this.request=this.eventId=this.source=null;H&&(this.source=H.source,this.eventId=H.eventId,this.request=ia,this.response=ib)}function fi(){return L.call(this)||this}function wg(){return Uh.call(this,
83,[500,501,502])||this}function gj(){return Uh.call(this,76,[-100])||this}function Ei(){return Uh.call(this,82,[200,201,202,203,204,205,206,207,208,209,210])||this}function Fi(){return Uh.call(this,80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])||this}function ck(){return Uh.call(this,84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])||this}function Uh(H,ia){var ib=L.call(this)||this;ib.pfa=H;ib.kTj=ia;return ib}function Xg(){return L.call(this)||this}function Oi(){return L.call(this)||
this}function Wj(){return L.call(this)||this}function Pj(){return L.call(this)||this}function L(){this.hIc=this.iIc=this.dOc=this.BSc=null}function Ma(H,ia,ib){var Lb=this;this.I9b=null;this.hwi=function(Nc,Vc){Lb.m1f()&&Lb.ead(Vc)};this.Wnf=ia;this.Vnf=ib;this.$=H;this.$.Eba&&this.$.wFg(this.hwi);H.da.Ga(297,this)}function rb(){}function ec(){}function fd(){this.vgb=null}function yd(){this.tb=null}function be(H){this._initialized=!1;this.f$a={};this.Iyc={};this.AO=ag.AFrameworkApplication.sa.yD;
this.Njd=H}function xe(H,ia,ib){this.expiration=this.authority=this.accessToken=null;this.accessToken=H;this.authority=ia;this.expiration=ib}function cf(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}function ze(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=
!1}function Yf(){}function Sg(H,ia){this.requestCallback=this.requestParameters=null;this.requestParameters=H;this.requestCallback=ia}function eg(){}b.r(C);var Pg=b(555),Vh=b(1160),fe=b(0),af=b(15),zh=b(82),yi;(function(H){H[H.generalException=0]="generalException";H[H.invalidArgument=1]="invalidArgument";H[H.notAllowed=2]="notAllowed";H[H.apiNotAvailable=3]="apiNotAvailable";H[H.unresolvedPendingRequest=4]="unresolvedPendingRequest";H[H.timeout=5]="timeout";H[H.adalTimeout=6]="adalTimeout";H[H.userNotSignedIn=
7]="userNotSignedIn";H[H.userAborted=8]="userAborted";H[H.silentSignInFailed=9]="silentSignInFailed";H[H.invalidResourceUrl=10]="invalidResourceUrl";H[H.invalidGrant=11]="invalidGrant";H[H.connectionLost=12]="connectionLost";H[H.clientError=13]="clientError";H[H.serverError=14]="serverError"})(yi||(yi={}));Object(fe.b)("ErrorCodes",yi);eg.GDf="OneDriveWOPI";Object(fe.a)(eg,"HostApplicationType",null,[]);Object(fe.a)(Sg,"OutstandingRequest",null,[]);Yf.WBi="AADSTS50058";Yf.invalidResourceUrl="AADSTS50001";
Yf.RBi="AADSTS65001";Yf.gCi="AADSTS70011";Yf.userAborted="13002";Yf.cYi="Popup Window is null";Yf.bYi="Popup Window closed";Yf.adalTimeout="Token renewal operation failed due to timeout";Yf.PIj="tokenRevoked";Object(fe.a)(Yf,"WopiHostErrorType",null,[]);var ag=b(4),Zj=b(940),T=b(633),pa=b(41);ze.CHh=function(H){switch(H){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}};Object(fe.a)(ze,"WopiAuthContext",null,[193]);Object(fe.a)(cf,"WopiIdentityInfo",null,[349]);
Object(fe.a)(xe,"WopiIdentityToken",null,[348]);var hb=b(24),Db=b(153),rc=b(389),vb=b(169),Uc=b(78),Td=b(355);be.prototype.R1a=function(H){this._initialized||(H.jo(vb.a.yGf),H.Tl(vb.a.yGf,Object(zh.a)(this,this.KOi,"onReceivedAccessToken")),this._initialized=!0)};be.prototype.getAccessToken=function(H,ia,ib){var Lb=this;ib=void 0===ib?null:ib;this.FNa(H,ia);return new Promise(function(Nc,Vc){if(Lb.jmd(ia))if(ia in Lb.f$a)Vc("unresolvedPendingRequest");else{var Hd=window.setTimeout(function(){var Be=
{};af.ULS.sendTraceTag(37856032,344,10,pa.c((Be.error="Request timeout.",Be.callerId=ia,Be)));Vc("timeout")},12E4);Lb.bcd(H,ia,ib,function(Be,df){window.clearTimeout(Hd);Be?Nc(Be):(Be={},af.ULS.sendTraceTag(37856033,369,15,pa.c((Be.error=yi[df],Be))),Vc(df))})}else{var Ld={};af.ULS.sendTraceTag(37856034,344,10,pa.c((Ld.error="Caller is not allowed.",Ld)));Vc("notAllowed")}})};be.prototype.getPrimaryIdentityInfo=function(H){var ia=this;return new Promise(function(ib,Lb){if(ia.jmd(H))ia.qTh(function(Vc,
Hd){Vc?ib(Vc):(Vc={},af.ULS.sendTraceTag(37856064,369,10,pa.c((Vc.error=Hd.toString(),Vc))),Lb(Hd))});else{var Nc={};af.ULS.sendTraceTag(37856065,344,10,pa.c((Nc.error="Caller is not allowed.",Nc)));Lb("notAllowed")}})};be.prototype.getAuthContext=function(H){var ia=this;return new Promise(function(ib,Lb){var Nc=ia.getAuthContextSync(H);Nc?ib(Nc):Lb("notAllowed")})};be.prototype.getAuthContextSync=function(H){if(this.jmd(H)){var ia=new ze;ia.upn=ag.AFrameworkApplication.fa.Va("UserPrincipalName");
ia.userId=ag.AFrameworkApplication.fa.Va("LoggableUserId");ia.authority=ag.AFrameworkApplication.fa.Va("HostAuthAuthority");ia.tenantId=ag.AFrameworkApplication.fa.Va("TenantId");ia.isAnonymous=ag.AFrameworkApplication.fa.ra("IsAnonymousUser");ia.supportsAuthToken=this.U5h(H);H=ag.AFrameworkApplication.fa.Va("HostAuthType");ia.authorityType="aad"===H.toLowerCase()?2:"msa"===H.toLowerCase()?1:0;return ia}ia={};af.ULS.sendTraceTag(40751647,344,10,pa.c((ia.error="Caller is not allowed.",ia)));return null};
be.prototype.U5h=function(H){var ia=Zj.a.lxb;return hb.a.dxa?ia&&Zj.a.E7f?Array.contains(Zj.a.E7f,H.toLowerCase()):!1:ia};be.prototype.bcd=function(H,ia,ib,Lb){var Nc=this,Vc=[];Array.add(Vc,Object.assign(new Uc.a,{name:"CallerId",string:ia}));Array.add(Vc,Object.assign(new Uc.a,{name:rc.a.KSd,string:H.correlationId}));Db.a.sendTelemetryEvent(Object.assign(new Td.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Vc}));Vc=T.a.create().toString();var Hd="getAccessToken_"+
Vc,Ld=this.AO.Gc("ComponentAttach",Hd);this.Iyc[Hd]=Ld;var Be={};Be[rc.a.LSd]=Vc;Be[rc.a.iCj]=H.resource;Be[rc.a.jCj]=H.scope;Be[rc.a.I4f]=ag.AFrameworkApplication.fa.Va("HostAuthType");Be[rc.a.mCj]=ag.AFrameworkApplication.fa.Va("UserPrincipalName");Be[rc.a.kCj]=H.silentLogin;Be[rc.a.fCj]=H.options;Be[rc.a.KSd]=H.correlationId;Be[rc.a.gCj]=ia;ib&&(Be[rc.a.addinName]=ib.AddinName,Be[rc.a.eCj]=ib.AddinTrustId);this.Njd.execute(function(df){Nc.R1a(df);df.Gj(vb.a.getAuthToken,Be)});this.f$a[Vc]=new Sg(H,
Lb)};be.prototype.qTh=function(H){var ia=ag.AFrameworkApplication.fa.Va("UserName"),ib=ag.AFrameworkApplication.fa.Va("UserPrincipalName"),Lb=ag.AFrameworkApplication.fa.Va("LoggableUserIdSpace"),Nc=new cf;Nc.email=ib;Nc.displayName=ia;switch(Lb){case "OrgIdPuid":Nc.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Nc.authority="MicrosoftAccount";break;default:Nc.authority=Lb}H(Nc,null)};be.prototype.KOi=function(H){var ia=null;try{var ib=H.Values[rc.a.LSd],Lb=H.Values[rc.a.dCj],
Nc=H.Values[rc.a.I4f],Vc=H.Values[rc.a.lCj],Hd=null,Ld=null,Be=this.f$a[ib];if("undefined"!==typeof Be&&Be){var df=[];Array.add(df,Object.assign(new Uc.a,{name:rc.a.KSd,string:Be.requestParameters.correlationId}));Db.a.sendTelemetryEvent(Object.assign(new Td.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:df}));ia=Be.requestCallback;delete this.f$a[ib];"undefined"!==typeof Lb&&Lb&&Lb.length?Ld=new xe(Lb,Nc,Vc):Hd=yi[this.Ywi(H)];ib="getAccessToken_"+ib;ib in this.Iyc&&
(this.Iyc[ib].stop(),delete this.Iyc[ib]);ia(Ld,Hd)}else Hd={},af.ULS.sendTraceTag(37856066,344,10,pa.c((Hd.error="No matching outstanding request for request ID.",Hd.requestId=ib,Hd)))}catch(uf){H=H.Values[rc.a.LSd],H in this.f$a&&delete this.f$a[H],this.Sjc(),H={},af.ULS.sendTraceTag(37856067,344,10,pa.c((H.error=uf.message,H.stack=uf.stack,H))),ia&&ia(null,"generalException")}};be.prototype.jmd=function(H){var ia=ag.AFrameworkApplication.l_h();H=H.toLowerCase();ia=Gl(ia);for(var ib=ia.next();!ib.done;ib=
ia.next())if(H===ib.value.toLowerCase())return!0;ia=Zj.a.fWc;for(var Lb in ia)if(H===ia[Lb].toLowerCase())return!0;return!1};be.prototype.Ywi=function(H){H=H.Values[rc.a.hCj];this.Sjc();var ia={};af.ULS.sendTraceTag(39068821,344,15,pa.c((ia.error=H,ia)));return H?-1<H.indexOf(Yf.WBi)?9:-1<H.indexOf(Yf.cYi)||-1<H.indexOf(Yf.bYi)?12:-1<H.indexOf(Yf.invalidResourceUrl)?10:-1<H.indexOf(Yf.userAborted)?8:-1<H.indexOf(Yf.gCi)||-1<H.indexOf(Yf.RBi)||H===Yf.PIj?11:-1<H.indexOf(Yf.adalTimeout)?6:0:13};be.prototype.FNa=
function(H,ia){H=this.u5i(H.resource);var ib={};af.ULS.sendTraceTag(39921882,344,50,pa.c((ib.callerId=ia,ib.resource=H,ib)))};be.prototype.Sjc=function(){var H={};af.ULS.sendTraceTag(39068822,344,50,pa.c((H.userAgent=window.navigator.userAgent,H)))};be.prototype.u5i=function(H){return(H?H:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Object(fe.a)(be,"WopiIdentityManager",null,[333]);var mf=b(257);yd.prototype.fi=function(H){this.tb=H;H.register(be,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").Hc().Oc(function(){return new be(H.kc("Postmessage.IHostPostmessenger"))})};
yd.prototype.init=function(){ag.AFrameworkApplication.fa&&ag.AFrameworkApplication.fa.hv(Object(zh.a)(this,this.vB,"onFullAppSettingsReady"))};yd.prototype.vB=function(){try{this.tb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(H){af.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+H)}};yd.prototype.dispose=function(){};yd.main=function(){mf.a.instance.gj(new yd)};Ck.Object.defineProperties(yd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WopiIdentity"}}});
Object(fe.a)(yd,"WopiIdentityPackage",null,[4,5]);var bg=b(11),qg=b(229),Kg=b(202),di=b(646);fd.prototype.Bdi=function(H){return this.aNg.contains(H.operation)};fd.prototype.BMj=function(H){for(var ia=[],ib=Gl(H.payload.batchedOperations),Lb=ib.next();!Lb.done;Lb=ib.next())ia.push(new di.a(H.operation,Lb.value));return ia};Ck.Object.defineProperties(fd.prototype,{aNg:{configurable:!0,enumerable:!0,get:function(){this.vgb||(this.vgb=new Kg.a,this.vgb.add(12),this.vgb.add(11));return this.vgb}}});Object(fe.a)(fd,
"MacroRecorderBatchedEventList",null,[]);var Bh=b(55),ak=b(127),Kh=b(735);ec.prototype.equals=function(H,ia){return H===ia};ec.prototype.getHashCode=function(H){return H};ec.prototype.rja=function(H){return H};Object(fe.a)(ec,"UserOperationNameComparer",null,[31,32]);rb.j_h=function(){rb.Uc||(rb.Uc=new Kh.a(new ec),rb.Uc.add(507),rb.Uc.add(10),rb.Uc.add(576),rb.Uc.add(563),rb.Uc.add(564),rb.Uc.add(565),rb.Uc.add(566),rb.Uc.add(567),rb.Uc.add(568),rb.Uc.add(569),rb.Uc.add(570),rb.Uc.add(571),rb.Uc.add(572),
rb.Uc.add(573),rb.Uc.add(574),rb.Uc.add(575),rb.Uc.add(501),rb.Uc.add(520),rb.Uc.add(1),rb.Uc.add(1002),rb.Uc.add(129),rb.Uc.add(198),rb.Uc.add(500),rb.Uc.add(519),rb.Uc.add(538),rb.Uc.add(1E3),rb.Uc.add(1003),rb.Uc.add(144),rb.Uc.add(502),rb.Uc.add(505),rb.Uc.add(179),rb.Uc.add(205),rb.Uc.add(134),rb.Uc.add(230),rb.Uc.add(103),rb.Uc.add(110),rb.Uc.add(112),rb.Uc.add(113),rb.Uc.add(124),rb.Uc.add(133),rb.Uc.add(154),rb.Uc.add(162),rb.Uc.add(168),rb.Uc.add(172),rb.Uc.add(201),rb.Uc.add(222),rb.Uc.add(227),
rb.Uc.add(513),rb.Uc.add(534),rb.Uc.add(539),rb.Uc.add(545),rb.Uc.add(600),rb.Uc.add(547),rb.Uc.add(555),rb.Uc.add(558),rb.Uc.add(562),rb.Uc.add(585),rb.Uc.add(1001),rb.Uc.add(1005),rb.Uc.add(1008),rb.Uc.add(1010),rb.Uc.add(1011),rb.Uc.add(1012),rb.Uc.add(1018),rb.Uc.add(252),rb.Uc.add(253),rb.Uc.add(258),rb.Uc.add(101),rb.Uc.add(102),rb.Uc.add(108),rb.Uc.add(257),rb.Uc.add(119),rb.Uc.add(120),rb.Uc.add(123),rb.Uc.add(126),rb.Uc.add(127),rb.Uc.add(130),rb.Uc.add(140),rb.Uc.add(159),rb.Uc.add(160),
rb.Uc.add(165),rb.Uc.add(166),rb.Uc.add(167),rb.Uc.add(169),rb.Uc.add(189),rb.Uc.add(223),rb.Uc.add(214),rb.Uc.add(228),rb.Uc.add(233),rb.Uc.add(247),rb.Uc.add(504),rb.Uc.add(511),rb.Uc.add(512),rb.Uc.add(525),rb.Uc.add(533),rb.Uc.add(537),rb.Uc.add(542),rb.Uc.add(544),rb.Uc.add(548),rb.Uc.add(550),rb.Uc.add(551),rb.Uc.add(552),rb.Uc.add(554),rb.Uc.add(577),rb.Uc.add(584),rb.Uc.add(586),rb.Uc.add(587),rb.Uc.add(588),rb.Uc.add(592),rb.Uc.add(1009),rb.Uc.add(1016),rb.Uc.add(1017));return rb.Uc};rb.Uc=
null;Object(fe.a)(rb,"MacroRecorderUnrecognizedEventList",null,[]);Ma.prototype.init=function(H){this.$.Eba&&(H?this.I9b=H:af.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))};Ma.prototype.ead=function(H){if(this.m1f())try{if(this.Vnf.Bdi(H))for(var ia=this.Vnf.BMj(H),ib=Gl(ia),Lb=ib.next();!Lb.done;Lb=ib.next())this.VSe(Lb.value);else this.VSe(H)}catch(Nc){H=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Error: {0}, Exception: {1}",
ak.a(H.operation),Nc.stack),af.ULS.sendTraceTag(537155423,0,10,H)}};Ma.prototype.VSe=function(H){var ia=this.Wnf.XZe(H,!0);ia?(this.I9b(ia.eventId,Bh.a.Jc(H.payload)),H=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}",ia.eventId),af.ULS.sendTraceTag(537155422,0,50,H)):(ia=this.Wnf.XZe(H,!1))?(H=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}, but failed to match filters",ia.eventId),af.ULS.sendTraceTag(537155421,0,50,H)):rb.j_h().contains(H.operation)||
(this.I9b(0,Bh.a.Jc(H.operation)),H=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: {0}",ak.a(H.operation)),af.ULS.sendTraceTag(537155420,0,50,H))};Ma.prototype.m1f=function(){return this.$.Eka&&this.I9b&&this.$.Aba?!0:!1};Object(fe.a)(Ma,"MacroRecorderEventHandler",null,[512]);var Fg=b(1);L.prototype.wg=function(){};L.prototype.gwa=function(){};L.prototype.Bd=function(H){this.xCc.add(H)};L.prototype.Yb=function(H){this.operations.contains(H)||this.operations.add(H)};
L.prototype.Rmb=function(){this.featureGates.add(675)};L.prototype.Pke=function(H){this.xRe.add(H)};Ck.Object.defineProperties(L.prototype,{operations:{configurable:!0,enumerable:!0,get:function(){this.dOc||(this.dOc=new Kg.a,this.mc());return this.dOc}},xCc:{configurable:!0,enumerable:!0,get:function(){this.BSc||(this.BSc=new Kg.a,this.wg());return this.BSc}},xRe:{configurable:!0,enumerable:!0,get:function(){this.hIc||(this.hIc=new Kg.a);return this.hIc}},featureGates:{configurable:!0,enumerable:!0,
get:function(){this.iIc||(this.iIc=new Kg.a,this.gwa());return this.iIc}}});Object(fe.a)(L,"MacroRecorderEventBase",null,[]);Wl(Pj,L);Pj.prototype.mc=function(){this.Yb(100)};Ck.Object.defineProperties(Pj.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 130}}});Object(fe.a)(Pj,"AccessibilityCheckRunEvent",L,[]);Wl(Wj,L);Wj.prototype.mc=function(){this.Yb(241)};Wj.prototype.wg=function(){this.Bd(function(H){return H.addToPrintArea})};Ck.Object.defineProperties(Wj.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 160}}});Object(fe.a)(Wj,"AddedToPrintAreaEvent",L,[]);Wl(Oi,L);Oi.prototype.mc=function(){this.Yb(516)};Ck.Object.defineProperties(Oi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 65}}});Object(fe.a)(Oi,"AutoFilterToggledEvent",L,[]);Wl(Xg,L);Xg.prototype.mc=function(){this.Yb(502)};Xg.prototype.wg=function(){this.Bd(function(H){return!(H.b4a().FirstColumn===H.b4a().LastColumn&&H.b4a().FirstRow===H.b4a().LastRow)})};Ck.Object.defineProperties(Xg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 118}}});Object(fe.a)(Xg,"AutoSumEvent",L,[]);Wl(Uh,L);Uh.prototype.mc=function(){this.Yb(529);this.Yb(594)};Uh.prototype.wg=function(){var H=this;this.Bd(function(ia){return Array.contains(H.kTj,ia.cfd())})};Ck.Object.defineProperties(Uh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.pfa}}});Object(fe.a)(Uh,"ChartPropertyAppliedEventBase",L,[]);Wl(ck,Uh);Object(fe.a)(ck,"ChartAxisChangedEvent",Uh,[]);Wl(Fi,
Uh);Object(fe.a)(Fi,"ChartAxisTitleChangedEvent",Uh,[]);Wl(Ei,Uh);Object(fe.a)(Ei,"ChartDataLabelsChangedEvent",Uh,[]);Wl(gj,Uh);Object(fe.a)(gj,"ChartDataSelectedEvent",Uh,[]);Wl(wg,Uh);Object(fe.a)(wg,"ChartDataTableChangedEvent",Uh,[]);var si=b(613),xj=b(437),lj=b(85);Wl(fi,L);Object(fe.a)(fi,"RichApiRequestExecutedEventBase",L,[]);Ck.Object.defineProperties(Zh.prototype,{isValid:{configurable:!0,enumerable:!0,get:function(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||
null===this.eventId)&&!0}}});Object(fe.a)(Zh,"MacroRecorderRichApiRequestExecutedPayload",null,[450]);Wl(Ui,fi);Ui.prototype.iF=function(H){Ui.Z6||(Ui.Z6=new Kh.a(si.a.Qk()),Ui.Z6.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Ui.Z6.add("fa000000014"));return!!H&&Ui.Z6.contains(H.toLowerCase())};Ui.prototype.mc=function(){this.Yb(507);this.Yb(10);this.Yb(576)};Ui.prototype.wg=function(){var H=this;this.Bd(function(ia){return Object(xj.a)(Zh,ia)&&(ia=Object(lj.a)(Zh,ia),ia.isValid&&H.iF(ia.source))?(af.ULS.sendTraceTag(537155427,
0,50,"[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: {0}",ia.eventId),!0):!1})};Ck.Object.defineProperties(Ui.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 117}}});Ui.Z6=null;Object(fe.a)(Ui,"ChartFormatRichApiRequestExecutedEvent",fi,[]);Wl(uh,Uh);Object(fe.a)(uh,"ChartGridlinesChangedEvent",Uh,[]);Wl(uj,L);uj.prototype.mc=function(){this.Yb(528)};Ck.Object.defineProperties(uj.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 66}}});
Object(fe.a)(uj,"ChartInsertedEvent",L,[]);Wl(Mi,Uh);Object(fe.a)(Mi,"ChartLegendChangedEvent",Uh,[]);Wl(hi,Uh);Object(fe.a)(hi,"ChartRowColumnSwitchedEvent",Uh,[]);Wl(Xi,Uh);Object(fe.a)(Xi,"ChartTitleChangedEvent",Uh,[]);Wl(kh,Uh);Object(fe.a)(kh,"ChartTypeChangedEvent",Uh,[]);Wl(Ci,L);Ci.prototype.mc=function(){this.Yb(521)};Ck.Object.defineProperties(Ci.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 131}}});Object(fe.a)(Ci,"ConnectorFloatingObjectResizedEvent",L,[]);Wl(nf,
L);nf.prototype.mc=function(){this.Yb(109)};Ck.Object.defineProperties(nf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 129}}});Object(fe.a)(nf,"EntitySelectedEvent",L,[]);Wl(yh,L);yh.prototype.mc=function(){this.Yb(149);this.Yb(147)};Ck.Object.defineProperties(yh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 49}}});Object(fe.a)(yh,"FindCellEvent",L,[]);Wl(ch,L);ch.prototype.mc=function(){this.Yb(122)};Ck.Object.defineProperties(ch.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 96}}});Object(fe.a)(ch,"FloatingObjectAltTextAppliedEvent",L,[]);Wl(Ne,L);Ne.prototype.mc=function(){this.Yb(522)};Ck.Object.defineProperties(Ne.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 93}}});Object(fe.a)(Ne,"FloatingObjectDeletedEvent",L,[]);Wl(Zf,L);Zf.prototype.mc=function(){this.Yb(524)};Ck.Object.defineProperties(Zf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 94}}});Object(fe.a)(Zf,"FloatingObjectMovedAndResizedEvent",
L,[]);Wl(Uf,L);Uf.prototype.mc=function(){this.Yb(523)};Ck.Object.defineProperties(Uf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 95}}});Object(fe.a)(Uf,"FloatingObjectRotatedEvent",L,[]);Wl(xf,L);xf.prototype.mc=function(){this.Yb(543)};Ck.Object.defineProperties(xf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 100}}});Object(fe.a)(xf,"GroupDetailsShownOrHiddenEvent",L,[]);Wl(gf,L);gf.prototype.mc=function(){this.Yb(125)};Ck.Object.defineProperties(gf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 154}}});Object(fe.a)(gf,"HyperlinksRemovedFromRangeEvent",L,[]);Wl(oe,fi);oe.prototype.iF=function(H){oe.Z6||(oe.Z6=new Kh.a(si.a.Qk()),oe.Z6.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),oe.Z6.add("fa000000005"));return!!H&&oe.Z6.contains(H.toLowerCase())};oe.prototype.mc=function(){this.Yb(507);this.Yb(10);this.Yb(576)};oe.prototype.wg=function(){var H=this;this.Bd(function(ia){return Object(xj.a)(Zh,ia)?(ia=Object(lj.a)(Zh,ia),ia.isValid&&
H.iF(ia.source)):!1})};Ck.Object.defineProperties(oe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 125}}});oe.Z6=null;Object(fe.a)(oe,"IdeasRichApiRequestExecutedEvent",fi,[]);Wl(Sc,L);Sc.prototype.mc=function(){this.Yb(115)};Ck.Object.defineProperties(Sc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 136}}});Object(fe.a)(Sc,"LinkedEntityConvertedEvent",L,[]);Wl(Pc,L);Pc.prototype.mc=function(){this.Yb(114)};Ck.Object.defineProperties(Pc.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 148}}});Object(fe.a)(Pc,"LinkedEntityDisambiguationPaneToggledEvent",L,[]);Wl(xc,L);xc.prototype.mc=function(){this.Yb(119)};Ck.Object.defineProperties(xc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 127}}});Object(fe.a)(xc,"MovedToEdgeEvent",L,[]);Wl(Fb,L);Fb.prototype.mc=function(){this.Yb(191)};Fb.prototype.gwa=function(){this.Rmb()};Ck.Object.defineProperties(Fb.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 135}}});Object(fe.a)(Fb,"NamedSheetViewCreatedEvent",L,[]);Wl(Ba,L);Ba.prototype.mc=function(){this.Yb(200)};Ba.prototype.gwa=function(){this.Rmb()};Ck.Object.defineProperties(Ba.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 166}}});Object(fe.a)(Ba,"NamedSheetViewDeletedEvent",L,[]);Wl(Z,L);Z.prototype.mc=function(){this.Yb(192)};Z.prototype.gwa=function(){this.Rmb()};Ck.Object.defineProperties(Z.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 133}}});
Object(fe.a)(Z,"NamedSheetViewExitedEvent",L,[]);Wl(pb,L);pb.prototype.mc=function(){this.Yb(199)};pb.prototype.gwa=function(){this.Rmb()};Ck.Object.defineProperties(pb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 162}}});Object(fe.a)(pb,"NamedSheetViewRenamedEvent",L,[]);Wl(fc,L);fc.prototype.mc=function(){this.Yb(195)};fc.prototype.gwa=function(){this.Rmb()};Ck.Object.defineProperties(fc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 167}}});Object(fe.a)(fc,
"NamedSheetViewSwitchedEvent",L,[]);Wl(Ka,L);Ka.prototype.mc=function(){this.Yb(174)};Ck.Object.defineProperties(Ka.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 99}}});Object(fe.a)(Ka,"OutlineLevelSetEvent",L,[]);Wl(ca,L);ca.prototype.mc=function(){this.Yb(244)};Ck.Object.defineProperties(ca.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 156}}});Object(fe.a)(ca,"PageBreakInsertedEvent",L,[]);Wl(S,L);S.prototype.mc=function(){this.Yb(245)};Ck.Object.defineProperties(S.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 157}}});Object(fe.a)(S,"PageBreakRemovedEvent",L,[]);Wl(r,L);r.prototype.mc=function(){this.Yb(246)};Ck.Object.defineProperties(r.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 158}}});Object(fe.a)(r,"PageBreaksAllResetEvent",L,[]);Wl(d,L);d.prototype.mc=function(){this.Yb(503)};d.prototype.wg=function(){this.Bd(function(H){return!!H.pasteParameters.ClientEstimationFloatingObjectId&&2===H.pasteParameters.CopyPasteTargetType&&
!H.isFromCurrentSession})};Ck.Object.defineProperties(d.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 112}}});Object(fe.a)(d,"PasteArtOtherWorkbookEvent",L,[]);Wl(Va,L);Va.prototype.mc=function(){this.Yb(503)};Va.prototype.wg=function(){this.Bd(function(H){return!!H.pasteParameters.ClientEstimationFloatingObjectId&&2===H.pasteParameters.CopyPasteTargetType&&H.isFromCurrentSession})};Ck.Object.defineProperties(Va.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 52}}});
Object(fe.a)(Va,"PasteArtSameWorkbookEvent",L,[]);Wl(fa,L);fa.prototype.mc=function(){this.Yb(204)};Ck.Object.defineProperties(fa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 110}}});Object(fe.a)(fa,"PasteHtmlEvent",L,[]);Wl(O,L);O.prototype.mc=function(){this.Yb(506)};Ck.Object.defineProperties(O.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 35}}});Object(fe.a)(O,"PasteRangeEvent",L,[]);Wl(xi,L);xi.prototype.mc=function(){this.Yb(503)};xi.prototype.wg=
function(){this.Bd(function(H){return 1===H.pasteParameters.CopyPasteTargetType})};Ck.Object.defineProperties(xi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 111}}});Object(fe.a)(xi,"PasteShadowWorkbookRangeEvent",L,[]);Wl(wh,L);wh.prototype.mc=function(){this.Yb(180)};Ck.Object.defineProperties(wh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 42}}});Object(fe.a)(wh,"PasteStringEvent",L,[]);Wl(ah,L);ah.prototype.mc=function(){this.Yb(220)};Ck.Object.defineProperties(ah.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 134}}});Object(fe.a)(ah,"PendingMergeEvent",L,[]);Wl(bh,L);bh.prototype.mc=function(){this.Yb(510)};Ck.Object.defineProperties(bh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 122}}});Object(fe.a)(bh,"PictureInsertedEvent",L,[]);Wl(oi,L);oi.prototype.mc=function(){this.Yb(161)};Ck.Object.defineProperties(oi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 153}}});Object(fe.a)(oi,"PivotDrillToggledEvent",
L,[]);Wl(rf,L);rf.prototype.mc=function(){this.Yb(225)};rf.prototype.wg=function(){var H=this;this.Bd(function(ia){return ia.opType===H.opType})};Ck.Object.defineProperties(rf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.pfa}}});Object(fe.a)(rf,"PivotTableSettingsChangedEventBase",L,[]);Wl(Mf,rf);Object(fe.a)(Mf,"PivotTableAllItemLabelsRepeatedEvent",rf,[]);Wl(Ph,rf);Object(fe.a)(Ph,"PivotTableAltTextDescriptionChangedEvent",rf,[]);Wl(vh,rf);Object(fe.a)(vh,"PivotTableAltTextTitleChangedEvent",
rf,[]);Wl(we,rf);Object(fe.a)(we,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",rf,[]);Wl(ji,rf);Object(fe.a)(ji,"PivotTableBlankLineAfterEachItemToggledEvent",rf,[]);Wl(Ng,rf);Object(fe.a)(Ng,"PivotTableColumnGrandTotalShownEvent",rf,[]);Wl(jh,L);jh.prototype.mc=function(){this.Yb(132)};Ck.Object.defineProperties(jh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 98}}});Object(fe.a)(jh,"PivotTableCreatedEvent",L,[]);Wl(vi,rf);Object(fe.a)(vi,"PivotTableDisplayErrorStringToggledEvent",
rf,[]);Wl(pi,rf);Object(fe.a)(pi,"PivotTableDisplayNullStringToggledEvent",rf,[]);Wl(ri,rf);Object(fe.a)(ri,"PivotTableErrorStringChangedEvent",rf,[]);Wl(Bi,rf);Object(fe.a)(Bi,"PivotTableExpandCollapseButtonsShownEvent",rf,[]);Wl(Th,rf);Object(fe.a)(Th,"PivotTableIndentChangedEvent",rf,[]);Wl(sg,rf);Object(fe.a)(sg,"PivotTableItemsWithNoDataOnColumnsShownEvent",rf,[]);Wl(jg,rf);Object(fe.a)(jg,"PivotTableItemsWithNoDataOnRowsShownEvent",rf,[]);Wl(Qg,rf);Object(fe.a)(Qg,"PivotTableLayoutTypeSetEvent",
rf,[]);Wl(Vg,rf);Object(fe.a)(Vg,"PivotTableNullStringChangedEvent",rf,[]);Wl(We,L);We.prototype.mc=function(){this.Yb(219)};Ck.Object.defineProperties(We.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 149}}});Object(fe.a)(We,"PivotTablePivotLocationChangedEvent",L,[]);Wl(ge,L);ge.prototype.mc=function(){this.Yb(145)};Ck.Object.defineProperties(ge.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 102}}});Object(fe.a)(ge,"PivotTablePivotedEvent",L,[]);
Wl(Vd,rf);Object(fe.a)(Vd,"PivotTableRefreshDataOnLoadToggledEvent",rf,[]);Wl(Gb,L);Gb.prototype.mc=function(){this.Yb(50)};Gb.prototype.wg=function(){this.Bd(function(H){return!!H.pivotTableId&&!!H.pivotTableName})};Ck.Object.defineProperties(Gb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 104}}});Object(fe.a)(Gb,"PivotTableRefreshedEvent",L,[]);Wl(na,rf);Object(fe.a)(na,"PivotTableRenamedEvent",rf,[]);Wl(Fa,rf);Object(fe.a)(Fa,"PivotTableRowGrandTotalShownEvent",rf,[]);
Wl(wi,rf);Object(fe.a)(wi,"PivotTableSaveSourceDataWithFileToggledEvent",rf,[]);var gk=b(701);Wl(ug,L);ug.prototype.mc=function(){this.Yb(131)};ug.prototype.wg=function(){this.Bd(function(H){H=Object(lj.a)(gk.a,H);return!!H&&!!H.UJa()&&!!H.hierarchyName})};Ck.Object.defineProperties(ug.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 155}}});Object(fe.a)(ug,"PivotTableSortedEvent",L,[]);Wl(Hi,rf);Object(fe.a)(Hi,"PivotTableSubTotalsVisibilitySettingSetEvent",rf,[]);Wl(ki,L);
ki.prototype.mc=function(){this.Yb(560)};Ck.Object.defineProperties(ki.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 206}}});Object(fe.a)(ki,"PivotValueFieldSettingAppliedEvent",L,[]);Wl(zg,L);zg.prototype.mc=function(){this.Yb(243)};Ck.Object.defineProperties(zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 161}}});Object(fe.a)(zg,"PrintAreaClearedEvent",L,[]);Wl(Fh,L);Fh.prototype.mc=function(){this.Yb(241)};Fh.prototype.wg=function(){this.Bd(function(H){return!H.addToPrintArea})};
Ck.Object.defineProperties(Fh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 159}}});Object(fe.a)(Fh,"PrintAreaSetEvent",L,[]);Wl(Sh,L);Sh.prototype.mc=function(){this.Yb(517)};Ck.Object.defineProperties(Sh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 57}}});Object(fe.a)(Sh,"RangeAutoFilterClearedEvent",L,[]);Wl(Ig,L);Ig.prototype.mc=function(){this.Yb(11)};Ig.prototype.wg=function(){var H=this;this.Bd(function(ia){return 16===ia.zZ().ValidMembers});
this.Bd(function(ia){return ia.zZ().Font.ValidMembers===H.VYd})};Ck.Object.defineProperties(Ig.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.pfa}}});Object(fe.a)(Ig,"RangeFontFormattedEventBase",L,[]);Wl(Of,Ig);Object(fe.a)(Of,"RangeBoldedEvent",Ig,[]);Wl(Rf,L);Rf.prototype.mc=function(){this.Yb(11)};Rf.prototype.wg=function(){this.Bd(function(H){return 128===H.zZ().ValidMembers})};Ck.Object.defineProperties(Rf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 2}}});
Object(fe.a)(Rf,"RangeBorderedEvent",L,[]);Df.a$a="Table";Df.Roc="Sheet";Object(fe.a)(Df,"MacroRecorderEventConstants",null,[]);Wl(Hf,L);Hf.prototype.mc=function(){this.Yb(208)};Hf.prototype.wg=function(){this.Bd(function(H){return H.getParameters().FilterType===Df.Roc})};Ck.Object.defineProperties(Hf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 113}}});Object(fe.a)(Hf,"RangeCheckedItemsFilteredEvent",L,[]);Wl(jf,L);jf.prototype.mc=function(){this.Yb(106);this.Yb(105)};
Ck.Object.defineProperties(jf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 109}}});Object(fe.a)(jf,"RangeConditionalFormattingChangedEvent",L,[]);Wl(Gf,L);Gf.prototype.mc=function(){this.Yb(221)};Ck.Object.defineProperties(Gf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 124}}});Object(fe.a)(Gf,"RangeConditionalFormattingRuleDeletedEvent",L,[]);Wl(ye,L);ye.prototype.mc=function(){this.Yb(508)};ye.prototype.wg=function(){this.Bd(function(H){return 3===
H.au()||1===H.au()||4===H.au()})};Ck.Object.defineProperties(ye.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 29}}});Object(fe.a)(ye,"RangeContentClearedEvent",L,[]);Wl(de,L);de.prototype.mc=function(){this.Yb(104)};Ck.Object.defineProperties(de.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 40}}});Object(fe.a)(de,"RangeCopiedCutCellsInsertedEvent",L,[]);Wl(Dc,L);Dc.prototype.mc=function(){this.Yb(209)};Dc.prototype.wg=function(){this.Bd(function(H){return H.getParameters().FilterType===
Df.Roc})};Ck.Object.defineProperties(Dc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 114}}});Object(fe.a)(Dc,"RangeCustomFilteredEvent",L,[]);Wl(Wc,L);Wc.prototype.mc=function(){this.Yb(121)};Ck.Object.defineProperties(Wc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 106}}});Object(fe.a)(Wc,"RangeDataValidationChangedEvent",L,[]);Wl(qc,Ig);Object(fe.a)(qc,"RangeDoubleUnderlinedEvent",Ig,[]);Wl(Kb,L);Kb.prototype.mc=function(){this.Yb(190)};Ck.Object.defineProperties(Kb.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 69}}});Object(fe.a)(Kb,"RangeDuplicatesRemovedEvent",L,[]);Wl(Ga,L);Ga.prototype.mc=function(){this.Yb(527);this.Yb(12)};Ck.Object.defineProperties(Ga.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(fe.a)(Ga,"RangeEditedEvent",L,[]);Wl(Bg,L);Bg.prototype.mc=function(){this.Yb(255)};Bg.prototype.wg=function(){this.Bd(function(H){return 4===H.actionType})};Ck.Object.defineProperties(Bg.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 164}}});Object(fe.a)(Bg,"RangeExternalLinksBrokeAllLinksEvent",L,[]);Wl(ii,L);ii.prototype.mc=function(){this.Yb(255)};ii.prototype.wg=function(){this.Bd(function(H){return 3===H.actionType})};Ck.Object.defineProperties(ii.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 119}}});Object(fe.a)(ii,"RangeExternalLinksBrokeLinkEvent",L,[]);Wl(sh,L);sh.prototype.mc=function(){this.Yb(256)};sh.prototype.gwa=function(){this.Pke("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")};
Ck.Object.defineProperties(sh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 205}}});Object(fe.a)(sh,"RangeExternalLinksChangeSourceEvent",L,[]);Wl(Yh,L);Yh.prototype.mc=function(){this.Yb(553)};Yh.prototype.wg=function(){this.Bd(function(H){return 1===H.actionType})};Ck.Object.defineProperties(Yh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 163}}});Object(fe.a)(Yh,"RangeExternalLinksRefreshedAllEvent",L,[]);Wl(jj,L);jj.prototype.mc=function(){this.Yb(553)};
jj.prototype.wg=function(){this.Bd(function(H){return 0===H.actionType})};Ck.Object.defineProperties(jj.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 77}}});Object(fe.a)(jj,"RangeExternalLinksRefreshedEvent",L,[]);Wl(Xf,L);Xf.prototype.mc=function(){this.Yb(224)};Ck.Object.defineProperties(Xf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 165}}});Object(fe.a)(Xf,"RangeExternalLinksSetAutoRefreshEvent",L,[]);Wl(Eh,L);Eh.prototype.mc=function(){this.Yb(11)};
Eh.prototype.wg=function(){this.Bd(function(H){return 64===H.zZ().ValidMembers})};Ck.Object.defineProperties(Eh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 5}}});Object(fe.a)(Eh,"RangeFillColoredEvent",L,[]);Wl(Ih,L);Ih.prototype.mc=function(){this.Yb(155)};Ck.Object.defineProperties(Ih.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 59}}});Object(fe.a)(Ih,"RangeFilledEvent",L,[]);Wl(ff,L);ff.prototype.mc=function(){this.Yb(176)};ff.prototype.wg=
function(){this.Bd(function(H){return H.oV().AutoFilterType===Df.Roc&&!!H.oV().CriteriaType})};Ck.Object.defineProperties(ff.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 115}}});Object(fe.a)(ff,"RangeFilterAppliedEvent",L,[]);Wl(hh,L);hh.prototype.mc=function(){this.Yb(176)};hh.prototype.wg=function(){this.Bd(function(H){return H.oV().AutoFilterType===Df.Roc&&!H.oV().CriteriaType})};Ck.Object.defineProperties(hh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 58}}});
Object(fe.a)(hh,"RangeFilterClearedEvent",L,[]);Wl(Rg,L);Rg.prototype.mc=function(){this.Yb(518)};Ck.Object.defineProperties(Rg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 41}}});Object(fe.a)(Rg,"RangeFilterReappliedEvent",L,[]);Wl(ve,L);ve.prototype.mc=function(){this.Yb(150)};Ck.Object.defineProperties(ve.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 86}}});Object(fe.a)(ve,"RangeFlashFilledEvent",L,[]);Wl(Vf,Ig);Object(fe.a)(Vf,"RangeFontColoredEvent",
Ig,[]);Wl(Eg,Ig);Object(fe.a)(Eg,"RangeFontItalicizedEvent",Ig,[]);Wl(lh,Ig);Object(fe.a)(lh,"RangeFontNamedEvent",Ig,[]);Wl(Ud,Ig);Object(fe.a)(Ud,"RangeFontSizedEvent",Ig,[]);Wl(eh,L);eh.prototype.mc=function(){this.Yb(215)};Ck.Object.defineProperties(eh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 74}}});Object(fe.a)(eh,"RangeFormattedAsTableEvent",L,[]);Wl(cg,L);cg.prototype.mc=function(){this.Yb(188)};Ck.Object.defineProperties(cg.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 97}}});Object(fe.a)(cg,"RangeGroupedOrUngroupedEvent",L,[]);Wl(rh,L);rh.prototype.mc=function(){this.Yb(11)};rh.prototype.wg=function(){this.Bd(function(H){return 2===H.zZ().ValidMembers})};Ck.Object.defineProperties(rh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 60}}});Object(fe.a)(rh,"RangeHorizontallyAlignedEvent",L,[]);Wl(vf,L);vf.prototype.mc=function(){this.Yb(526)};Ck.Object.defineProperties(vf.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 43}}});Object(fe.a)(vf,"RangeHyperlinkAppliedEvent",L,[]);Wl(vd,L);vd.prototype.mc=function(){this.Yb(11)};vd.prototype.wg=function(){this.Bd(function(H){return 256===H.zZ().ValidMembers})};Ck.Object.defineProperties(vd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 63}}});Object(fe.a)(vd,"RangeIndentChangedEvent",L,[]);Wl(Sf,L);Sf.prototype.mc=function(){this.Yb(156)};Sf.prototype.wg=function(){this.Bd(function(H){return 2===H.au()||5===
H.au()||6===H.au()||7===H.au()})};Ck.Object.defineProperties(Sf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 53}}});Object(fe.a)(Sf,"RangeMergedEvent",L,[]);Wl(Yg,L);Yg.prototype.mc=function(){this.Yb(216)};Ck.Object.defineProperties(Yg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 107}}});Object(fe.a)(Yg,"RangeNamedCellStyleAppliedEvent",L,[]);Wl(ee,L);ee.prototype.mc=function(){this.Yb(11)};ee.prototype.wg=function(){this.Bd(function(H){return 32===
H.zZ().ValidMembers})};Ck.Object.defineProperties(ee.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 12}}});Object(fe.a)(ee,"RangeNumberFormattedEvent",L,[]);var zj=b(1161);Wl(Wd,L);Wd.prototype.mc=function(){this.Yb(141)};Wd.prototype.wg=function(){this.Bd(function(H){return Object(xj.a)(zj.a,H)})};Ck.Object.defineProperties(Wd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 108}}});Object(fe.a)(Wd,"RangeSortedEvent",L,[]);Wl(bf,Ig);Object(fe.a)(bf,
"RangeStrikedThroughEvent",Ig,[]);Wl(ie,Ig);Object(fe.a)(ie,"RangeUnderlinedEvent",Ig,[]);Wl(hf,L);hf.prototype.mc=function(){this.Yb(11)};hf.prototype.wg=function(){this.Bd(function(H){return 1===H.zZ().ValidMembers})};Ck.Object.defineProperties(hf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 61}}});Object(fe.a)(hf,"RangeVerticallyAlignedEvent",L,[]);Wl(Yc,L);Yc.prototype.mc=function(){this.Yb(11)};Yc.prototype.wg=function(){this.Bd(function(H){return 8===H.zZ().ValidMembers})};
Ck.Object.defineProperties(Yc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 62}}});Object(fe.a)(Yc,"RangeWrapTextToggledEvent",L,[]);Wl(oc,L);oc.prototype.mc=function(){this.Yb(51)};Ck.Object.defineProperties(oc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 103}}});Object(fe.a)(oc,"RefreshedAllEvent",L,[]);Wl(De,L);De.prototype.mc=function(){this.Yb(148)};Ck.Object.defineProperties(De.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 47}}});
Object(fe.a)(De,"ReplaceAllEvent",L,[]);Wl(wf,L);wf.prototype.mc=function(){this.Yb(532)};wf.prototype.wg=function(){this.Bd(function(H){return 95!==H.getShapeType()&&96!==H.getShapeType()&&97!==H.getShapeType()&&98!==H.getShapeType()&&100!==H.getShapeType()&&102!==H.getShapeType()&&103!==H.getShapeType()})};Ck.Object.defineProperties(wf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 91}}});Object(fe.a)(wf,"ShapeInsertedEvent",L,[]);Wl(Xe,L);Xe.prototype.mc=function(){this.Yb(531)};
Ck.Object.defineProperties(Xe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 92}}});Object(fe.a)(Xe,"ShapeStyleSetEvent",L,[]);var Qj=b(1020);Wl(Ie,L);Ie.prototype.mc=function(){this.Yb(581)};Ie.prototype.wg=function(){var H=this;this.Bd(function(ia){return Object(xj.a)(Qj.a,ia)&&4===ia.getShapeTextFormat().ValidMembers});this.Bd(function(ia){return Object(xj.a)(Qj.a,ia)&&ia.getShapeTextFormat().Font.ValidMembers===H.VYd})};Ck.Object.defineProperties(Ie.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return this.pfa}}});Object(fe.a)(Ie,"ShapeTextFontFormattedEventBase",L,[]);Wl(me,Ie);Object(fe.a)(me,"ShapeTextBoldedEvent",Ie,[]);var Gg=b(1163);Wl(Od,L);Od.prototype.mc=function(){this.Yb(581)};Od.prototype.wg=function(){this.Bd(function(H){return Object(xj.a)(Gg.a,H)})};Ck.Object.defineProperties(Od.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 191}}});Object(fe.a)(Od,"ShapeTextChangedEvent",L,[]);Wl(dd,Ie);Object(fe.a)(dd,"ShapeTextFontColorChangedEvent",
Ie,[]);Wl(Rc,Ie);Object(fe.a)(Rc,"ShapeTextFontNameChangedEvent",Ie,[]);Wl(ic,Ie);Object(fe.a)(ic,"ShapeTextFontSizeChangedEvent",Ie,[]);Wl(kb,L);kb.prototype.mc=function(){this.Yb(581)};kb.prototype.wg=function(){this.Bd(function(H){return Object(xj.a)(Qj.a,H)&&2===H.getShapeTextFormat().ValidMembers})};Ck.Object.defineProperties(kb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 199}}});Object(fe.a)(kb,"ShapeTextHorizontallyAlignedEvent",L,[]);Wl(Na,Ie);Object(fe.a)(Na,"ShapeTextItalicizedEvent",
Ie,[]);Wl(Oe,Ie);Object(fe.a)(Oe,"ShapeTextUnderlinedEvent",Ie,[]);Wl(Ff,L);Ff.prototype.mc=function(){this.Yb(581)};Ff.prototype.wg=function(){this.Bd(function(H){return Object(xj.a)(Qj.a,H)&&1===H.getShapeTextFormat().ValidMembers})};Ck.Object.defineProperties(Ff.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 200}}});Object(fe.a)(Ff,"ShapeTextVerticallyAlignedEvent",L,[]);Wl(Se,L);Se.prototype.mc=function(){this.Yb(138)};Ck.Object.defineProperties(Se.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 13}}});Object(fe.a)(Se,"SheetAddedEvent",L,[]);var Xh=b(9);Wl(Me,L);Me.prototype.mc=function(){this.Yb(237)};Me.prototype.wg=function(){this.Bd(function(H){return!!H.insertDeleteMultiRangeParameters});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(H){H=H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>H.DeltaColumn&&!H.DeltaRow&&(!!H.InsertDeleteRange.FirstRow||H.InsertDeleteRange.LastRow!==Xh.a.ny)||
!H.DeltaColumn&&0>H.DeltaRow&&(!!H.InsertDeleteRange.FirstColumn||H.InsertDeleteRange.LastColumn!==Xh.a.mv)})};Ck.Object.defineProperties(Me.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 142}}});Object(fe.a)(Me,"SheetCellsDeletedEvent",L,[]);Wl(He,L);He.prototype.mc=function(){this.Yb(237)};He.prototype.wg=function(){this.Bd(function(H){return!!H.insertDeleteMultiRangeParameters});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(H){H=
H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<H.DeltaColumn&&!H.DeltaRow&&(!!H.InsertDeleteRange.FirstRow||H.InsertDeleteRange.LastRow!==Xh.a.ny)||!H.DeltaColumn&&0<H.DeltaRow&&(!!H.InsertDeleteRange.FirstColumn||H.InsertDeleteRange.LastColumn!==Xh.a.mv)})};Ck.Object.defineProperties(He.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 143}}});Object(fe.a)(He,"SheetCellsInsertedEvent",L,[]);Wl(Pd,L);Pd.prototype.mc=function(){this.Yb(237)};Pd.prototype.wg=
function(){this.Bd(function(H){return!!H.insertDeleteMultiRangeParameters});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(H){return 0>H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.Bd(function(H){return H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
Xh.a.ny})};Ck.Object.defineProperties(Pd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 139}}});Object(fe.a)(Pd,"SheetColumnDeletedEvent",L,[]);Wl(Ad,L);Ad.prototype.mc=function(){this.Yb(237)};Ad.prototype.wg=function(){this.Bd(function(H){return!!H.insertDeleteMultiRangeParameters});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(H){return 0<H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});
this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.Bd(function(H){return H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===Xh.a.ny})};Ck.Object.defineProperties(Ad.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 138}}});Object(fe.a)(Ad,"SheetColumnInsertedEvent",L,[]);Wl(Lc,L);Lc.prototype.mc=function(){this.Yb(137)};Ck.Object.defineProperties(Lc.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 14}}});Object(fe.a)(Lc,"SheetDeletedEvent",L,[]);Wl(Ob,L);Ob.prototype.mc=function(){this.Yb(185)};Ck.Object.defineProperties(Ob.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 137}}});Object(fe.a)(Ob,"SheetDirectionChangedEvent",L,[]);Wl(ya,L);ya.prototype.mc=function(){this.Yb(139)};Ck.Object.defineProperties(ya.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 54}}});Object(fe.a)(ya,"SheetDuplicatedEvent",L,[]);Wl(fh,
L);fh.prototype.mc=function(){this.Yb(207)};Ck.Object.defineProperties(fh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 15}}});Object(fe.a)(fh,"SheetNameEditedEvent",L,[]);Wl(zf,L);zf.prototype.mc=function(){this.Yb(151)};Ck.Object.defineProperties(zf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 90}}});Object(fe.a)(zf,"SheetPaneFrozenEvent",L,[]);Wl(Wh,L);Wh.prototype.mc=function(){this.Yb(226)};Ck.Object.defineProperties(Wh.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 120}}});Object(fe.a)(Wh,"SheetPrintSettingsSavedEvent",L,[]);var rj=b(1066);Wl(se,L);se.prototype.mc=function(){this.Yb(507)};se.prototype.gwa=function(){this.Pke("Microsoft.Office.Excel.SheetProtectionMacroRecording")};se.prototype.wg=function(){this.Bd(function(H){return Object.getType(H)===rj.a})};Ck.Object.defineProperties(se.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(fe.a)(se,"SheetProtectionPausedResumedEvent",L,
[]);Wl(ae,L);ae.prototype.mc=function(){this.Yb(557)};Ck.Object.defineProperties(ae.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 64}}});Object(fe.a)(ae,"SheetReorderedEvent",L,[]);Wl(lg,L);lg.prototype.mc=function(){this.Yb(237)};lg.prototype.wg=function(){this.Bd(function(H){return!!H.insertDeleteMultiRangeParameters});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.Bd(function(H){return 0>H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});this.Bd(function(H){return H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Xh.a.mv})};Ck.Object.defineProperties(lg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 141}}});Object(fe.a)(lg,"SheetRowDeletedEvent",L,
[]);Wl($e,L);$e.prototype.mc=function(){this.Yb(237)};$e.prototype.wg=function(){this.Bd(function(H){return!!H.insertDeleteMultiRangeParameters});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(H){return 0<H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});
this.Bd(function(H){return H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Xh.a.mv})};Ck.Object.defineProperties($e.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 140}}});Object(fe.a)($e,"SheetRowInsertedEvent",L,[]);Wl(Lf,L);Lf.prototype.mc=function(){this.Yb(135)};Ck.Object.defineProperties(Lf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 39}}});Object(fe.a)(Lf,"SheetRowsColumnsAutoFitEvent",L,[]);Wl(hg,
L);hg.prototype.mc=function(){this.Yb(136)};Ck.Object.defineProperties(hg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 36}}});Object(fe.a)(hg,"SheetRowsColumnsResizedEvent",L,[]);Wl(Cg,L);Cg.prototype.mc=function(){this.Yb(183)};Ck.Object.defineProperties(Cg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 68}}});Object(fe.a)(Cg,"SheetShowGridlinesToggledEvent",L,[]);Wl(yf,L);yf.prototype.mc=function(){this.Yb(184)};Ck.Object.defineProperties(yf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 67}}});Object(fe.a)(yf,"SheetShowHeadingsToggledEvent",L,[]);Wl(Pe,L);Pe.prototype.mc=function(){this.Yb(213)};Ck.Object.defineProperties(Pe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 89}}});Object(fe.a)(Pe,"SheetSpellCheckedEvent",L,[]);Wl(Ve,L);Ve.prototype.mc=function(){this.Yb(515)};Ck.Object.defineProperties(Ve.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 70}}});Object(fe.a)(Ve,
"SheetTabColoredEvent",L,[]);Wl(le,L);le.prototype.mc=function(){this.Yb(157)};Ck.Object.defineProperties(le.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 71}}});Object(fe.a)(le,"SheetVisibilityChangedEvent",L,[]);Wl(td,L);td.prototype.mc=function(){this.Yb(239)};Ck.Object.defineProperties(td.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 126}}});Object(fe.a)(td,"SheetsVisibilityChangedEvent",L,[]);Wl(od,L);od.prototype.mc=function(){this.Yb(203)};
Ck.Object.defineProperties(od.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 188}}});Object(fe.a)(od,"SlicerInsertedEvent",L,[]);Wl(Bc,L);Bc.prototype.mc=function(){this.Yb(173)};Bc.prototype.wg=function(){this.Bd(function(H){return!H.clearFilter})};Ck.Object.defineProperties(Bc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 189}}});Object(fe.a)(Bc,"SlicerSelectionAppliedEvent",L,[]);Wl(gg,L);gg.prototype.mc=function(){this.Yb(173)};gg.prototype.wg=
function(){this.Bd(function(H){return H.clearFilter})};Ck.Object.defineProperties(gg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 190}}});Object(fe.a)(gg,"SlicerSelectionClearedEvent",L,[]);Wl(vg,L);vg.prototype.mc=function(){this.Yb(208)};vg.prototype.wg=function(){this.Bd(function(H){return H.getParameters().FilterType===Df.a$a})};Ck.Object.defineProperties(vg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 27}}});Object(fe.a)(vg,"TableCheckedItemsFilteredEvent",
L,[]);Wl(kg,L);kg.prototype.mc=function(){this.Yb(237)};kg.prototype.wg=function(){this.Bd(function(H){return!!H.insertDeleteMultiRangeParameters});this.Bd(function(H){return H.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(H){return 0>H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Ck.Object.defineProperties(kg.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 144}}});Object(fe.a)(kg,"TableColumnDeletedEvent",L,[]);Wl(Le,L);Le.prototype.mc=function(){this.Yb(237)};Le.prototype.wg=function(){this.Bd(function(H){return!!H.insertDeleteMultiRangeParameters});this.Bd(function(H){return H.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(H){return 0<H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Ck.Object.defineProperties(Le.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 145}}});Object(fe.a)(Le,"TableColumnInsertedEvent",L,[]);var mk=b(1162);Wl(Pf,L);Pf.prototype.mc=function(){this.Yb(141)};Pf.prototype.wg=function(){this.Bd(function(H){return Object(xj.a)(mk.a,H)})};Ck.Object.defineProperties(Pf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 121}}});Object(fe.a)(Pf,"TableColumnSortedEvent",L,[]);Wl(Re,L);Re.prototype.mc=function(){this.Yb(193)};
Ck.Object.defineProperties(Re.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 105}}});Object(fe.a)(Re,"TableConvertedToRangeEvent",L,[]);Wl(Ce,L);Ce.prototype.mc=function(){this.Yb(206)};Ck.Object.defineProperties(Ce.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 16}}});Object(fe.a)(Ce,"TableCreatedEvent",L,[]);Wl(Rd,L);Rd.prototype.mc=function(){this.Yb(209)};Rd.prototype.wg=function(){this.Bd(function(H){return H.getParameters().FilterType===Df.a$a})};
Ck.Object.defineProperties(Rd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 30}}});Object(fe.a)(Rd,"TableCustomFilteredEvent",L,[]);Wl(Gc,L);Gc.prototype.mc=function(){this.Yb(187)};Gc.prototype.wg=function(){this.Bd(function(H){return 1===H.options.OperationType})};Ck.Object.defineProperties(Gc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 25}}});Object(fe.a)(Gc,"TableCustomSortedEvent",L,[]);Wl(id,L);id.prototype.mc=function(){this.Yb(176)};id.prototype.wg=
function(){this.Bd(function(H){return H.oV().AutoFilterType===Df.a$a});this.Bd(function(H){return 0===H.oV().CriteriaType})};Ck.Object.defineProperties(id.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 28}}});Object(fe.a)(id,"TableFilterClearedEvent",L,[]);Wl(jc,L);jc.prototype.mc=function(){this.Yb(176)};jc.prototype.wg=function(){this.Bd(function(H){return H.oV().AutoFilterType===Df.a$a});this.Bd(function(H){var ia=new Kg.a;ia.add(1);ia.add(2);ia.add(8);ia.add(9);ia.add(10);
ia.add(11);ia.add(12);ia.add(13);ia.add(14);ia.add(15);ia.add(16);ia.add(17);ia.add(18);ia.add(19);ia.add(20);ia.add(21);ia.add(22);ia.add(23);ia.add(24);ia.add(25);ia.add(26);ia.add(27);ia.add(28);ia.add(29);ia.add(30);ia.add(31);ia.add(32);ia.add(33);ia.add(34);ia.add(35);ia.add(36);ia.add(37);ia.add(38);ia.add(39);return ia.contains(H.oV().CriteriaType)})};Ck.Object.defineProperties(jc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 32}}});Object(fe.a)(jc,"TableItemFilteredEvent",
L,[]);Wl(qb,L);qb.prototype.mc=function(){this.Yb(217)};Ck.Object.defineProperties(qb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 101}}});Object(fe.a)(qb,"TableRenamedEvent",L,[]);Wl(Aa,L);Aa.prototype.mc=function(){this.Yb(211)};Ck.Object.defineProperties(Aa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 73}}});Object(fe.a)(Aa,"TableResizedEvent",L,[]);Wl(da,L);da.prototype.mc=function(){this.Yb(514)};Ck.Object.defineProperties(da.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 44}}});Object(fe.a)(da,"TableRowColumnRearrangedEvent",L,[]);Wl(Xb,L);Xb.prototype.mc=function(){this.Yb(237)};Xb.prototype.wg=function(){this.Bd(function(H){return!!H.insertDeleteMultiRangeParameters});this.Bd(function(H){return H.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(H){return 0>H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Ck.Object.defineProperties(Xb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 146}}});Object(fe.a)(Xb,"TableRowDeletedEvent",L,[]);Wl(ng,L);ng.prototype.mc=function(){this.Yb(237)};ng.prototype.wg=function(){this.Bd(function(H){return!!H.insertDeleteMultiRangeParameters});this.Bd(function(H){return H.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(H){return!H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(H){return 0<
H.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Ck.Object.defineProperties(ng.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 147}}});Object(fe.a)(ng,"TableRowInsertedEvent",L,[]);Wl(ef,L);ef.prototype.mc=function(){this.Yb(177)};ef.prototype.wg=function(){this.Bd(function(H){return H.oV().AutoFilterType===Df.a$a})};Ck.Object.defineProperties(ef.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 26}}});Object(fe.a)(ef,"TableSortedEvent",
L,[]);Wl(Og,L);Og.prototype.mc=function(){this.Yb(212)};Ck.Object.defineProperties(Og.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 87}}});Object(fe.a)(Og,"TableStyleAppliedEvent",L,[]);Wl(Jg,L);Jg.prototype.mc=function(){this.Yb(196)};Ck.Object.defineProperties(Jg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 88}}});Object(fe.a)(Jg,"TableStyleOptionToggledEvent",L,[]);Wl(fg,L);fg.prototype.mc=function(){this.Yb(210)};fg.prototype.wg=function(){this.Bd(function(H){return H.getParameters().FilterType===
Df.a$a})};Ck.Object.defineProperties(fg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 31}}});Object(fe.a)(fg,"TableTop10FilteredEvent",L,[]);Wl(Jf,L);Jf.prototype.mc=function(){this.Yb(238)};Ck.Object.defineProperties(Jf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 207}}});Object(fe.a)(Jf,"TextToColumnsEvent",L,[]);Wl(Dg,L);Dg.prototype.mc=function(){this.Yb(559)};Ck.Object.defineProperties(Dg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 128}}});
Object(fe.a)(Dg,"ValuesSortedEvent",L,[]);Wl(Ae,L);Ae.prototype.mc=function(){this.Yb(197)};Ck.Object.defineProperties(Ae.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 55}}});Object(fe.a)(Ae,"WorkbookCalculationModeSetEvent",L,[]);Wl(nh,L);nh.prototype.mc=function(){this.Yb(181)};nh.prototype.wg=function(){this.Bd(function(H){return!!H.parentCommentId})};Ck.Object.defineProperties(nh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 34}}});Object(fe.a)(nh,
"WorkbookCommentRepliedEvent",L,[]);Wl(Hg,L);Hg.prototype.mc=function(){this.Yb(181)};Hg.prototype.wg=function(){this.Bd(function(H){return!H.parentCommentId})};Ck.Object.defineProperties(Hg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 33}}});Object(fe.a)(Hg,"WorkbookCommentedEvent",L,[]);Wl(Mg,L);Mg.prototype.mc=function(){this.Yb(128)};Ck.Object.defineProperties(Mg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 56}}});Object(fe.a)(Mg,"WorkbookRecalculatedEvent",
L,[]);Wl(Lg,L);Lg.prototype.mc=function(){this.Yb(171)};Ck.Object.defineProperties(Lg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 46}}});Object(fe.a)(Lg,"WorkbookRedoEvent",L,[]);Wl(Nf,L);Nf.prototype.mc=function(){this.Yb(170)};Ck.Object.defineProperties(Nf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 45}}});Object(fe.a)(Nf,"WorkbookUndoEvent",L,[]);Wl(Ag,L);Ag.prototype.mc=function(){this.Yb(507);this.Yb(576);this.Yb(10)};Ag.prototype.wg=function(){this.Bd(function(H){if(Object(xj.a)(Zh,
H)&&(H=Object(lj.a)(Zh,H),void 0!==H.source&&null!==H.source&&void 0!==H.eventId&&null!==H.eventId))return af.ULS.sendTraceTag(537155426,0,50,"[RichApiRecorder]: received a valid but unhandled event: source: {0}; eventId: {1}.",H.source,H.eventId),!0;af.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})};Ck.Object.defineProperties(Ag.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 116}}});Object(fe.a)(Ag,"DefaultRichApiRequestExecutedEvent",
L,[]);Wl(pg,L);pg.prototype.mc=function(){this.Yb(1022)};Ck.Object.defineProperties(pg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 216}}});Object(fe.a)(pg,"TablelAltTextEditedEvent",L,[]);Wl(Ef,L);Ef.prototype.mc=function(){this.Yb(263)};Ck.Object.defineProperties(Ef.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 217}}});Object(fe.a)(Ef,"FloatingObjectZOrderChangedEvent",L,[]);pf.prototype.XZe=function(H,ia){var ib=this.YZe(H,this.macroRecorderEvents,
ia);ib||(ib=this.YZe(H,pf.d_h(),ia),!ib&&this.Odf(H,pf.dGe,ia)&&(ib=pf.dGe));return ib};pf.prototype.YZe=function(H,ia,ib){var Lb=new Kg.a;ia=Gl(ia);for(var Nc=ia.next();!Nc.done;Nc=ia.next())Nc=Nc.value,this.Odf(H,Nc,ib)&&Lb.add(Nc);return 1===Lb.count?Lb.oa(0):1<Lb.count?pf.RHh(Lb):null};pf.prototype.Odf=function(H,ia,ib){var Lb=pf.JTi(H,ia);return ib?Lb&&pf.NTj(H,ia):Lb};pf.prototype.B8i=function(){for(var H=new Kg.a,ia=Gl(this.Jb),ib=ia.next();!ib.done;ib=ia.next()){ib=ib.value;for(var Lb=!1,
Nc=Gl(ib.featureGates),Vc=Nc.next();!Vc.done;Vc=Nc.next())if(!Fg.EwaSettings.ma(Vc.value)){H.add(ib);Lb=!0;break}if(!Lb)for(Lb=Gl(ib.xRe),Nc=Lb.next();!Nc.done;Nc=Lb.next())if(!Fg.EwaSettings.getBooleanFeatureGate(Nc.value,!1)){H.add(ib);break}}H=Gl(H);for(ia=H.next();!ia.done;ia=H.next())this.Jb.remove(ia.value)};pf.d_h=function(){pf.mCb||(pf.mCb=new Kg.a,pf.mCb.add(new Ui),pf.mCb.add(new oe));return pf.mCb};pf.JTi=function(H,ia){return ia.operations.contains(H.operation)};pf.NTj=function(H,ia){var ib=
ia.xCc;if(!ib.count)return!0;ia=!0;ib=Gl(ib);for(var Lb=ib.next();!Lb.done;Lb=ib.next())if(Lb=Lb.value,!Lb(H.payload)){ia=!1;break}return ia};pf.RHh=function(H){var ia=H.oa(0);H=Gl(H);for(var ib=H.next();!ib.done;ib=H.next())ib=ib.value,ib.xCc.count>ia.xCc.count&&(ia=ib);return ia};Ck.Object.defineProperties(pf.prototype,{macroRecorderEvents:{configurable:!0,enumerable:!0,get:function(){this.Jb||(this.Jb=new Kg.a,this.Jb.add(new Ga),this.Jb.add(new Rf),this.Jb.add(new Of),this.Jb.add(new qc),this.Jb.add(new Eh),
this.Jb.add(new Vf),this.Jb.add(new Eg),this.Jb.add(new lh),this.Jb.add(new Ud),this.Jb.add(new bf),this.Jb.add(new ie),this.Jb.add(new ee),this.Jb.add(new Se),this.Jb.add(new Lc),this.Jb.add(new fh),this.Jb.add(new Ce),this.Jb.add(new kg),this.Jb.add(new Le),this.Jb.add(new Xb),this.Jb.add(new ng),this.Jb.add(new Ad),this.Jb.add(new Pd),this.Jb.add(new $e),this.Jb.add(new lg),this.Jb.add(new Gc),this.Jb.add(new ef),this.Jb.add(new vg),this.Jb.add(new id),this.Jb.add(new ye),this.Jb.add(new Rd),this.Jb.add(new fg),
this.Jb.add(new jc),this.Jb.add(new Hg),this.Jb.add(new nh),this.Jb.add(new O),this.Jb.add(new hg),this.Jb.add(new Me),this.Jb.add(new He),this.Jb.add(new Lf),this.Jb.add(new de),this.Jb.add(new Rg),this.Jb.add(new vf),this.Jb.add(new wh),this.Jb.add(new da),this.Jb.add(new Lg),this.Jb.add(new Nf),this.Jb.add(new De),this.Jb.add(new yh),this.Jb.add(new Va),this.Jb.add(new Sf),this.Jb.add(new ya),this.Jb.add(new Ae),this.Jb.add(new Mg),this.Jb.add(new Sh),this.Jb.add(new hh),this.Jb.add(new Ih),this.Jb.add(new rh),
this.Jb.add(new hf),this.Jb.add(new Yc),this.Jb.add(new vd),this.Jb.add(new ae),this.Jb.add(new Oi),this.Jb.add(new uj),this.Jb.add(new yf),this.Jb.add(new Cg),this.Jb.add(new Kb),this.Jb.add(new le),this.Jb.add(new Ve),this.Jb.add(new Aa),this.Jb.add(new eh),this.Jb.add(new hi),this.Jb.add(new gj),this.Jb.add(new jj),this.Jb.add(new kh),this.Jb.add(new Xi),this.Jb.add(new Fi),this.Jb.add(new Mi),this.Jb.add(new Ei),this.Jb.add(new wg),this.Jb.add(new ck),this.Jb.add(new uh),this.Jb.add(new ve),this.Jb.add(new Og),
this.Jb.add(new Jg),this.Jb.add(new Pe),this.Jb.add(new zf),this.Jb.add(new wf),this.Jb.add(new Xe),this.Jb.add(new Ne),this.Jb.add(new Zf),this.Jb.add(new Uf),this.Jb.add(new ch),this.Jb.add(new cg),this.Jb.add(new jh),this.Jb.add(new Ka),this.Jb.add(new xf),this.Jb.add(new qb),this.Jb.add(new ge),this.Jb.add(new oc),this.Jb.add(new Gb),this.Jb.add(new Re),this.Jb.add(new Wc),this.Jb.add(new Yg),this.Jb.add(new Wd),this.Jb.add(new jf),this.Jb.add(new fa),this.Jb.add(new xi),this.Jb.add(new d),this.Jb.add(new Hf),
this.Jb.add(new Dc),this.Jb.add(new ff),this.Jb.add(new Xg),this.Jb.add(new bh),this.Jb.add(new ii),this.Jb.add(new Wh),this.Jb.add(new Pf),this.Jb.add(new Gf),this.Jb.add(new td),this.Jb.add(new xc),this.Jb.add(new Dg),this.Jb.add(new nf),this.Jb.add(new Pj),this.Jb.add(new Ci),this.Jb.add(new Z),this.Jb.add(new ah),this.Jb.add(new Fb),this.Jb.add(new Sc),this.Jb.add(new Ob),this.Jb.add(new Pc),this.Jb.add(new We),this.Jb.add(new oi),this.Jb.add(new gf),this.Jb.add(new ug),this.Jb.add(new ca),this.Jb.add(new S),
this.Jb.add(new r),this.Jb.add(new Fh),this.Jb.add(new Wj),this.Jb.add(new zg),this.Jb.add(new pb),this.Jb.add(new Yh),this.Jb.add(new Bg),this.Jb.add(new Xf),this.Jb.add(new Ba),this.Jb.add(new fc),this.Jb.add(new na),this.Jb.add(new Fa),this.Jb.add(new Ng),this.Jb.add(new Mf),this.Jb.add(new ji),this.Jb.add(new we),this.Jb.add(new Bi),this.Jb.add(new jg),this.Jb.add(new sg),this.Jb.add(new vi),this.Jb.add(new pi),this.Jb.add(new ri),this.Jb.add(new Vg),this.Jb.add(new wi),this.Jb.add(new Vd),this.Jb.add(new vh),
this.Jb.add(new Ph),this.Jb.add(new Hi),this.Jb.add(new Qg),this.Jb.add(new Th),this.Jb.add(new od),this.Jb.add(new Bc),this.Jb.add(new gg),this.Jb.add(new Od),this.Jb.add(new me),this.Jb.add(new Na),this.Jb.add(new Oe),this.Jb.add(new dd),this.Jb.add(new Rc),this.Jb.add(new ic),this.Jb.add(new kb),this.Jb.add(new Ff),this.Jb.add(new sh),this.Jb.add(new ki),this.Jb.add(new Jf),this.Jb.add(new se),this.Jb.add(new pg),this.Jb.add(new Ef),Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&
this.B8i());return this.Jb}}});pf.mCb=null;pf.dGe=new Ag;Object(fe.a)(pf,"MacroRecorderEventList",null,[]);var dk=qg.a;Wl(If,dk);If.prototype.create=function(){this.Eb(this.$.da.za(297)||new Ma(this.$,new pf(this.$),new fd))};If.ka=function(H){H.da.Ga(298,new If(H))};Object(fe.a)(If,"MacroRecorderEventHandlerFactory",qg.a,[]);var yj=b(903),Gi=b(79),Nh=b(37);Sd.prototype.$c=function(){return!1};Sd.prototype.executeCommand=function(H,ia,ib){H=Nh.TaskExtensions.sk();ia=ia.command;switch(ia){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 1043696663:case 971811139:this.$.Ud(2045014907,
-1,0,null),this.automateCommandManager.Vpi(ia,1904816141===ia?ib[Gi.a.kd].toString():null)}return H};Sd.prototype.Mc=function(H,ia){H=!1;switch(ia.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case 1904816141:case 1043696663:case 1606046412:H=this.$.Eba}return H};Sd.prototype.jd=function(H,ia,ib){return"PopulateAutomateGalleryMenu"===ia&&this.$.Eba?(this.automateCommandManager.jd(ia,ib),!0):!1};Object(fe.a)(Sd,"AutomateCommandHandler",null,[428]);var Hh=b(489),Aj=yj.a;Wl(te,
Aj);te.prototype.Od=function(){var H=this;Hh.a(this.$,374,375,this.vb,function(){var ia=H.$.da.za(352);ia?H.Cd([new Sd(ia,H.$)]):af.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})};te.ka=function(H){H.da.Ga(308,new te(H))};Object(fe.a)(te,"AutomateCommandHandlerFactory",yj.a,[]);var Kf=b(7);Object(fe.a)(Gd,"AuthContext",null,[]);var sf=b(929),$h=b(133),Di=b(111),zi=b(28),xk=b(1021),Pi=b(187);xd.prototype.getAuthContext=function(){return this.pob};
xd.prototype.vvb=function(){function H(Vc,Hd){return(new Promise(function(Ld){window.setTimeout(function(){Ld(Vc)},Hd)})).then(function(Ld){Lb.push(Object(Kf.a)(new Uc.a,{name:"Error"+Nc,string:Ld.ErrorMessage}));Lb.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode"+Nc,string:Ld.ErrorCode}));Nc++;return ia.j$f()})}var ia=this,ib=zi.a.Ua.Vb,Lb=[];if(this.oAuthManager)Lb.push(Object(Kf.a)(new Uc.a,{name:"IsAuthSupported",bool:this.hse}));else return this.a9b(Lb,ib,"need_OAuthManager","No OAuthManager");if(!this.Ou.ly||
!this.Ou.ly.value)return this.a9b(Lb,ib,"need_license","No License");if(ag.AFrameworkApplication.fa.ra("IsAnonymousUser"))return this.a9b(Lb,ib,"need_user","Anonymous User");if(33E5>Date.now()-this.pob.timeStamp)return Lb.push(Object(Kf.a)(new Uc.a,{name:"UsedCachedToken",bool:!0})),Pi.a($h.a.pyd,!0,0,Lb),Promise.resolve(Object(Kf.a)(new xk.a,{IsSuccess:!0,Token:this.pob.token}));Lb.push(Object(Kf.a)(new Uc.a,{name:"UsedCachedToken",bool:!1}));var Nc=1;return this.j$f().catch(function(Vc){return H(Vc,
200)}).catch(function(Vc){return H(Vc,400)}).then(function(Vc){Vc.IsSuccess?(ia.pob.token=Vc.Token,ia.pob.timeStamp=Date.now()):(Lb.push(Object(Kf.a)(new Uc.a,{name:"Error"+Nc,string:Vc.ErrorMessage})),Lb.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode"+Nc,string:Vc.ErrorCode})));Lb.push(Object(Kf.a)(new Uc.a,{name:"Attempts",int64:Nc}));Lb.push(Object(Kf.a)(new Uc.a,{name:"Error",string:Vc.ErrorMessage}));Lb.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode",string:Vc.ErrorCode}));Pi.a($h.a.pyd,Vc.IsSuccess,
Di.getElapsedMilliseconds(ib,zi.a.Ua.Vb),Lb);return Promise.resolve(Vc)}).catch(function(Vc){Lb.push(Object(Kf.a)(new Uc.a,{name:"Error"+Nc,string:Vc.ErrorMessage}));Lb.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode"+Nc,string:Vc.ErrorCode}));Lb.push(Object(Kf.a)(new Uc.a,{name:"Attempts",int64:Nc}));return ia.a9b(Lb,ib,Vc.ErrorCode,Vc.ErrorMessage)})};xd.prototype.a9b=function(H,ia,ib,Lb){H.push(Object(Kf.a)(new Uc.a,{name:"Error",string:Lb}));H.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode",string:ib}));
Pi.a($h.a.pyd,!1,Di.getElapsedMilliseconds(ia,zi.a.Ua.Vb),H);return Promise.resolve(Object(Kf.a)(new xk.a,{IsSuccess:!1,ErrorMessage:Lb,ErrorCode:ib}))};xd.prototype.j$f=function(){var H=this,ia=sf.a.dYh(),ib=0;ia=this.oAuthManager.FS("Maker",ia).then(function(Lb){if(Lb)return!Lb.IsSuccess&&H.Kvj(Lb)?Promise.reject(Lb):Promise.resolve(Lb);Lb=Object(Kf.a)(new xk.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(Lb)}).catch(function(Lb){var Nc=new xk.a;
Object.getType(Lb)===Object.getType(Nc)?Nc=Lb:(Nc.ErrorMessage=Lb.toString(),Nc.ErrorCode="exception");return Promise.reject(Nc)});return Promise.race([ia,new Promise(function(Lb,Nc){ib=window.setTimeout(function(){Nc(Object(Kf.a)(new xk.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(function(Lb){window.clearTimeout(ib);return Lb})};xd.prototype.Kvj=function(H){return"interaction_required"===H.ErrorCode||"InitFailed"===H.ErrorCode||"invalid_resource"===
H.ErrorCode||"login_required"===H.ErrorCode&&H.ErrorMessage.startsWith("AADSTS500341")?!1:!0};Object(fe.a)(xd,"AutomateCommandAuth",null,[546]);var nk=b(1022);Object(fe.a)(pc,"AutomateCommandGalleryBase",null,[]);var Rj=b(391),Bj=b(29),Nk=b(620),Ik=b(1429),Si=b(19),ek=b(54),K=b(14);b(321);var Ca=b(651);Object(fe.a)(hc,"UserInfo",null,[]);var Mb=b(560),tc=b(175),Zc=b(83),Ee=b(36),Ue=b(292);Kc.prototype.BFh=function(H){var ia=this.automateCommandManager.Ta.Cq().jE();if(!sa()){var ib=Kc.CU(H,K.a.instance.ga(2104));
this.zUc(ib,sf.a.xRi,this.automateCommandManager.Tj,sf.a.fDi,K.a.instance.ga(2100),this.automateCommandManager.Ta);ia.MenuSectionList.push(ib)}ib=Kc.CU(H,K.a.instance.ga(2105));this.zUc(ib,sf.a.tAi,sf.a.Z5?this.automateCommandManager.ut.MSe(this.automateCommandManager.Tj):this.automateCommandManager.jq.MSe(this.automateCommandManager.Tj),sf.a.Prf,K.a.instance.ga(2101),this.automateCommandManager.Ta);ia.MenuSectionList.push(ib);ib=Kc.CU(H,K.a.instance.ga(2106));this.zUc(ib,sf.a.Jhj,this.automateCommandManager.CB,
sf.a.Prf,"",this.automateCommandManager.Ta);ia.MenuSectionList.push(ib);ib=Object(Kf.a)(new Rj.a,{Id:sf.a.zoe,ExternalId:sf.a.zoe,Command:"1606046412",LabelText:K.a.instance.ga(2097),Alt:K.a.instance.ga(2098),Image16by16:ek.a.gf(16),Image16by16Class:Si.a.ONe,Visible:!0});H=Kc.CU(H,null);H.ControlsId="myScriptsSection.Controls";if(sa()){var Lb=Object(Kf.a)(new Rj.a,{Id:sf.a.d0f,ExternalId:sf.a.d0f,Command:"1043696663",LabelText:K.a.instance.ga(2107),Alt:K.a.instance.ga(2107),ExternalImageId:"PeopleSharedIcon_16",
Visible:!0});H.ControlList.push(Lb)}H.ControlList.push(ib);ia.MenuSectionList.push(H);return ia};Kc.prototype.zUc=function(H,ia,ib,Lb,Nc,Vc){if(ib&&0<ib.length){ia=Vc.uC(ia,1,"Size150by20").P0b();Nc={};Vc={};Vc.root=Kc.x0a(320,30);Vc.flexContainer={display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"left",alignItems:"left",lineHeight:"normal"};Vc.label={margin:"0px 3px"};Nc.galleryButtonInExpanded=Vc;ia.GalleryStyle=Nc;for(Nc=0;Nc<ib.length&&Nc<Lb;Nc++)Vc=ib.z4(Nc),ia.GalleryItems.push(Kc.g3c(Vc.id,
Vc));H.ControlList.push(ia)}else ib=Object(Kf.a)(new Ca.a,{Id:ia,ExternalId:ia,LabelText:Nc}),H.ControlsId=ib.Id+".Controls",H.ControlList.push(ib)};Kc.BEh=function(H){if(H){var ia=String.format(sf.a.sai,H.isShared?sf.a.oKj:sf.a.$ij,ek.a.gf(16));H=String.format(sf.a.tai,Bj.a.vg(H.name));return String.format(sf.a.rai,ia,H)}return""};Kc.CU=function(H,ia){return Object(Kf.a)(new Nk.a,{Id:H,Title:ia,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})};
Kc.g3c=function(H,ia){var ib=sf.a.mKj,Lb=sf.a.Yij,Nc=sf.a.nKj,Vc=sf.a.Zij;return ia?Kc.fDe(ia.shareId||ia.id,ia.name,ia.isShared&&!sa()?ib:Lb,H,H,ia.isShared&&!sa()?Nc:Vc):Kc.fDe("","","",H,H)};Kc.fDe=function(H,ia,ib,Lb,Nc,Vc){Lb=void 0===Lb?null:Lb;Nc=void 0===Nc?null:Nc;Vc=void 0===Vc?null:Vc;var Hd=void 0===Hd?null:Hd;var Ld={},Be={};Ld.root=Kc.x0a(20,20);Be.root=Kc.x0a(20,20);return Object(Kf.a)(new Ik.a,{Id:H,ExternalId:Lb||H,MenuItemId:Nc||H,Command:"1904816141",Icon:ib,Image:ek.a.gf(16),ImageClass:Vc,
LabelText:ia,FullIconStyle:Ld,PreviewIconStyle:Be,Alt:Hd||ia})};Kc.x0a=function(H,ia){var ib={};ib.width=H;ib["min-width"]=H;ib.height=ia;return ib};Object(fe.a)(Kc,"AutomateCommandRenderer",null,[]);lc.prototype.pKa=function(H){for(var ia=0;ia<this.scripts.length;ia++)if(this.scripts[ia].id===H||this.scripts[ia].shareId===H)return ia;return-1};lc.prototype.sort=function(){this.r4f(this.scripts)};lc.prototype.Mu=function(H){return-1===this.pKa(H.id)?(this.scripts.push(H),!0):!1};lc.prototype.yUc=
function(H){return-1===this.pKa(H.id)?(this.scripts=[H].concat(this.scripts),!0):!1};lc.prototype.Zzi=function(H){H=this.pKa(H.id);if(-1!==H){for(var ia=this.scripts[H].J_a();0<H;)this.scripts[H]=this.scripts[H-1],H--;this.scripts[0]=ia}};lc.prototype.Xeb=function(H){var ia=this.pKa(H.id);if(-1!==ia){var ib=this.scripts[ia].shareId;this.scripts[ia]=H;this.scripts[ia].shareId=ib}};lc.prototype.fef=function(H){var ia=this.pKa(H.id);return-1!==ia?H.name===this.scripts[ia].name:!1};lc.prototype.$0a=function(H){H=
this.pKa(H);return-1!==H?(this.scripts.splice(H,1),!0):!1};lc.prototype.clear=function(){this.scripts=[]};lc.prototype.getScripts=function(){return this.scripts};lc.prototype.HM=function(H){H=this.pKa(H);return-1!==H?this.scripts[H]:null};lc.prototype.z4=function(H){return 0<=H&&this.length>H?this.scripts[H]:null};lc.prototype.MSe=function(H){for(var ia=new lc([],this.r4f),ib=0;ib<this.scripts.length;ib++){var Lb=this.scripts[ib];H.HM(Lb.id)||ia.Mu(Lb)}return ia};lc.prototype.beb=function(){for(var H=
[],ia=Gl(this.scripts),ib=ia.next();!ib.done;ib=ia.next())H.push(ib.value.lVd());return H};Ck.Object.defineProperties(lc.prototype,{length:{configurable:!0,enumerable:!0,get:function(){return this.scripts.length}}});Object(fe.a)(lc,"ScriptCollection",null,[]);var $c=b(198);Qf.prototype.J_a=function(){return new Qf(this.K$)};Qf.prototype.lVd=function(){return this.K$};Ck.Object.defineProperties(Qf.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.K$.id}},shareId:{configurable:!0,
enumerable:!0,get:function(){return this.K$.shareId},set:function(H){this.K$.shareId=H||null}},name:{configurable:!0,enumerable:!0,get:function(){return this.K$.name}},wFe:{configurable:!0,enumerable:!0,get:function(){return this.K$.dateLastPublished}},body:{configurable:!0,enumerable:!0,get:function(){return this.K$.body}},description:{configurable:!0,enumerable:!0,get:function(){return this.K$.description}},ubf:{configurable:!0,enumerable:!0,get:function(){return this.K$.isCreator}},isShared:{configurable:!0,
enumerable:!0,get:function(){return!!this.shareId&&0<this.shareId.length}}});Object(fe.a)(Qf,"ScriptCore",null,[]);Wl(mg,pc);mg.prototype.Qfd=function(H){switch(H){case "1":case "2":case "3":case "4":case "5":case "6":return this.DW.z4(parseInt(H,10)-1);default:return this.qf.ut.HM(H)||this.qf.jq.HM(H)||this.qf.Tj.HM(H)||this.qf.CB.HM(H)}};mg.prototype.aed=function(H,ia){var ib=null;if(this.qf.K4a)switch(H){case "1":case "2":case "3":case "4":case "5":case "6":ib=this.DW.z4(parseInt(H,10)-1);break;
default:ib=this.DW.HM(H)}Ee.a.isReactRibbonEnabled()?ia[nk.a.GalleryButtonProps]=Kc.g3c(H,ib):ia[nk.a.InnerHTML]=Kc.BEh(ib);ia[nk.a.Alt]=ib?ib.name:""};mg.prototype.YN=function(H){this.DW=this.yGd();this.$.Bf();var ia=[];ia.push(Object(Kf.a)(new Uc.a,{name:"Operation",string:H}));ia.push(Object(Kf.a)(new Uc.a,{name:"HasReadRecentCachedScripts",bool:this.qf.jdc}));ia.push(Object(Kf.a)(new Uc.a,{name:"ReadScriptsDone",bool:this.qf.Mid}));ia.push(Object(Kf.a)(new Uc.a,{name:"ReadSamplesScriptsDone",
bool:this.qf.YGb}));ia.push(Object(Kf.a)(new Uc.a,{name:"SamplesScriptCount",int64:this.qf.CB.length}));ia.push(Object(Kf.a)(new Uc.a,{name:"ReadRecentScriptsDone",bool:this.qf.vab}));ia.push(Object(Kf.a)(new Uc.a,{name:"RecentScriptCount",int64:this.qf.ut.length}));ia.push(Object(Kf.a)(new Uc.a,{name:"ReadWorkbookScriptsDone",bool:this.qf.LW}));ia.push(Object(Kf.a)(new Uc.a,{name:"WorkbookScriptCount",int64:this.qf.Tj.length}));Pi.a($h.a.ssf,!0,0,ia)};mg.prototype.Yhd=function(H){var ia=!1,ib="",
Lb=new Qf(H.scriptMetadata),Nc={Operation:"HandleRefreshRibbonGallery"};Nc.RefreshOperation=H.operationName;switch(H.operationName){case sf.a.IMf:H=this.Xhd(Lb);ib=H.message;ia=H.returnValue;break;case sf.a.GMf:H=this.Vhd(Lb);ib=H.message;ia=H.returnValue;break;case sf.a.FMf:H=this.Uhd(Lb);ib=H.message;ia=H.returnValue;break;case sf.a.HMf:H=this.Whd(Lb);ib=H.message;ia=H.returnValue;break;case sf.a.L5i:H=this.t2h(Lb),ib=H.message,ia=H.returnValue}(Nc.GalleryUpdated=ia)?(af.ULS.sendTraceTag(537170322,
0,50,"AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: {0}",ib),this.YN("RefreshGallery")):af.ULS.sendTraceTag(537170321,0,15,"AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",ib);Nc.Message=ib;af.ULS.sendTraceTag(537170320,0,50,pa.c(Nc))};mg.prototype.yGd=function(){for(var H=new lc([],function(){}),ia=this.qf.Tj?this.qf.Tj.length:0,ib=this.qf.ut?this.qf.ut.length:0,Lb=this.qf.CB?this.qf.CB.length:0,Nc=0,Vc=sf.a.AHf,Hd=0;Hd<Vc;Hd++)if(Hd<
ia)H.Mu(this.qf.Tj.z4(Hd));else if(Hd-ia+Nc<ib){var Ld=this.qf.ut.z4(Hd-ia+Nc);this.qf.Tj.HM(Ld.id)?(Nc++,Hd--):H.Mu(Ld)}else Hd-ia-ib+Nc<Lb&&H.Mu(this.qf.CB.z4(Hd-ia+Nc-ib));return H};mg.prototype.Xhd=function(H){if(this.qf.ut.yUc(H))var ia="";else{ia="";var ib=H.J_a();this.qf.Tj.Xeb(ib);this.qf.Tj.sort();this.qf.ut.Xeb(H)}return{returnValue:!0,message:ia}};mg.prototype.Vhd=function(H){this.qf.Tj.$0a(H.id);return this.qf.ut.$0a(H.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};
mg.prototype.Uhd=function(H){var ia=H.J_a();ia.shareId=null;this.qf.ut.yUc(ia);return this.qf.Tj.Mu(H)?(this.qf.Tj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};mg.prototype.Whd=function(H){return this.qf.Tj.$0a(H.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};mg.prototype.t2h=function(H){var ia=H.J_a(),ib=!1;this.qf.Tj.fef(ia)&&(this.qf.Tj.Xeb(ia),
this.qf.Tj.sort(),ib=!0);this.qf.ut.yUc(H)?ib=!0:this.qf.ut.fef(H)&&(this.qf.ut.Xeb(H),this.qf.ut.Zzi(H),ib=!0);return{returnValue:ib,message:""}};Object(fe.a)(mg,"AutomateCommandGallery",pc,[]);var Yd=b(84);Object(fe.a)($f,"AutomateCommandLicensingBase",null,[]);Object(fe.a)(Wf,"BoolResultWrapper",null,[]);Wl(of,$f);of.prototype.M_c=function(){var H=this,ia=zi.a.Ua.Vb,ib=[];return new Promise(function(Lb){Yd.a.instance.kc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Nc){Nc.isFeatureEnabled("ExcelOfficeScripting",
!1).then(function(Vc){ib.push(Object(Kf.a)(new Uc.a,{name:"IsLicensed",bool:Vc}));Pi.a($h.a.osf,!0,Di.getElapsedMilliseconds(ia,zi.a.Ua.Vb),ib);H.ly=new Wf(Vc,!0);Lb(Vc)}).catch(function(Vc){ib.push(Object(Kf.a)(new Uc.a,{name:"IsLicensed",bool:!1}));ib.push(Object(Kf.a)(new Uc.a,{name:"Error",string:Vc.toString()}));ib.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode",string:"exception"}));Pi.a($h.a.osf,!1,Di.getElapsedMilliseconds(ia,zi.a.Ua.Vb),ib);H.ly=new Wf(!1,!1,void 0,"exception",Vc.toString());
Lb(!1)})})})};Object(fe.a)(of,"AutomateCommandLicensing",$f,[]);var rg=b(1353),xg=b(1351),Zg=b(1350),ih=b(1352);Zd.taskPaneWidth="TaskPaneWidth";Zd.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";Zd.Yk="TaskPaneTitle";Zd.Rk="IconCssClass";Zd.vUd="TaskPaneIconUrl";Zd.yS="TaskPaneIconId";Zd.$H="NonPersistedSettings";Zd.onTaskPaneClose="OnTaskPaneClose";Zd.gTc="ActionArgs";Object(fe.a)(Zd,"PropertyNames",null,[]);var qi=b(176),qj=b(322),gh=b(5);Object(fe.a)(dg,"LaunchSDXParams",null,
[]);Object(fe.a)(je,"RunfromButtonParameters",null,[]);var Vi=b(167),Vj=b(993),Ch=b(50),sj=b(46),Cj=b(166);Ze.prototype.QRa=function(H){var ia=ag.AFrameworkApplication.fa.ra("IsO365CommercialHost"),ib="",Lb="",Nc=!1;var Vc=this.Ou.ly&&this.Ou.ly.isSuccess&&this.Ou.ly.value;Vc=sf.a.Jta?Vc:!(Vc&&(!this.HA||!this.HA.isSuccess));this.Ou.ly&&!this.Ou.ly.isSuccess?(Lb=this.Ou.ly.errorCode,ib=this.Ou.ly.errorMessage):this.HA&&!this.HA.isSuccess&&(Lb=this.HA.errorCode,ib=this.HA.errorMessage);var Hd=[];Hd.push(Object(Kf.a)(new Uc.a,
{name:"IsScriptingEnabled",bool:this.Gba}));Hd.push(Object(Kf.a)(new Uc.a,{name:"IsValidHost",bool:ia}));Hd.push(Object(Kf.a)(new Uc.a,{name:"IsUserLicensed",bool:this.Ou.ly?this.Ou.ly.value:!1}));sf.a.Jta||Hd.push(Object(Kf.a)(new Uc.a,{name:"IsAdminSwitchOn",bool:this.HA?this.HA.value:!1}));Hd.push(Object(Kf.a)(new Uc.a,{name:"ShowTab",bool:this.Gba}));sf.a.Jta||Hd.push(Object(Kf.a)(new Uc.a,{name:"ServiceChecked",bool:!H}));this.Gba?Ee.a.Wwa(this.$)&&(H=Vi.a(this.$),(null===H||void 0===H?0:H.Wl)?
(Hd.push(Object(Kf.a)(new Uc.a,{name:"RibbonType",string:"React"})),H.Wl.uzj(gh.a.UGb),H.Wl.EOd(["AutomateAutomateTask"],!sf.a.tsf),Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(Nc=!0)):(Lb="ribbon_manager_error",ib="The RibbonManager or RibbonUser is null")):this.f5h();Hd.push(Object(Kf.a)(new Uc.a,{name:"Error",string:ib}));Hd.push(Object(Kf.a)(new Uc.a,
{name:"ErrorCode",string:Lb}));Pi.a($h.a.UDi,Vc,Di.getElapsedMilliseconds(this.initTime,zi.a.Ua.Vb),Hd);this.$.zcb("automateTab",!1);return Promise.resolve(Nc)};Ze.prototype.jd=function(H,ia){if(!ia)return!1;ia.MenuItems=this.BMg.BFh(ia.MenuId);return!0};Ze.prototype.oXi=function(){var H=this;this.Iwa&&(sf.a.Z5?this.qf.iLf(this.fC).continueWith(function(ia){ia.result&&H.fC.YN(sf.a.MPa)}):this.qf.l4i(this.fC));Wb(this.$)?this.i1e(Object(Kf.a)(new xk.a,{IsSuccess:!0,Token:"FakeToken"})):this.kha.vvb().then(function(ia){H.i1e(ia)})};
Ze.prototype.aed=function(H,ia,ib){if(sf.a.Z5)this.fC.aed(H,ia,ib);else{ib=null;if(this.qf.K4a)switch(H){case "1":case "2":case "3":case "4":case "5":case "6":ib=this.fC.DW.z4(parseInt(H,10)-1);break;default:ib=this.fC.DW.HM(H)}ia[nk.a.GalleryButtonProps]=Kc.g3c(H,ib);ia[nk.a.Alt]=ib?ib.name:""}};Ze.prototype.Yhd=function(H){if(sf.a.Z5)this.fC.Yhd(H);else{var ia=!1,ib="",Lb=new Qf(H.scriptMetadata),Nc={Operation:"HandleRefreshRibbonGallery"};Nc.RefreshOperation=H.operationName;switch(H.operationName){case sf.a.IMf:H=
this.Xhd(Lb);ib=H.message;ia=H.returnValue;break;case sf.a.GMf:H=this.Vhd(Lb);ib=H.message;ia=H.returnValue;break;case sf.a.FMf:H=this.Uhd(Lb);ib=H.message;ia=H.returnValue;break;case sf.a.HMf:H=this.Whd(Lb),ib=H.message,ia=H.returnValue}(Nc.GalleryUpdated=ia)?(af.ULS.sendTraceTag(537170313,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",ib),this.YN("RefreshGallery")):af.ULS.sendTraceTag(537170312,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",
ib);Nc.Message=ib;af.ULS.sendTraceTag(537170311,0,50,pa.c(Nc))}};Ze.prototype.N2h=function(H,ia,ib,Lb){if(Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:6254340_ExitCellEditModeOnRFBClick")||this.$.Aq(null,!1,1023))H=new je(sf.a.WTf,H,ia,ib,this.Gba,Lb),this.vob.uwb(H)};Ze.prototype.q5e=function(H,ia,ib){H=new je(sf.a.qUj,H,ia,ib,this.Gba);this.vob.uwb(H)};Ze.prototype.x0h=function(H){this.vob.uhd(sf.a.Izj,H)};Ze.prototype.w0h=function(H){this.vob.uhd(sf.a.c1g,H)};Ze.prototype.y0h=function(H){this.vob.uhd(sf.a.LDj,
H)};Ze.prototype.Vpi=function(H,ia){var ib=Ch.b().ri(H),Lb=[];Lb.push(Object(Kf.a)(new Uc.a,{name:"SessionId",string:this.$.ya.UserSessionId}));Lb.push(Object(Kf.a)(new Uc.a,{name:"MenuItemId",string:ia}));Lb.push(Object(Kf.a)(new Uc.a,{name:"WorkbookScriptCount",int64:this.Tj.length}));Lb.push(Object(Kf.a)(new Uc.a,{name:"PublishedScriptCount",int64:this.jq.length}));Lb.push(Object(Kf.a)(new Uc.a,{name:"RecentScriptCount",int64:this.ut.length}));Lb.push(Object(Kf.a)(new Uc.a,{name:"Command",string:ib}));
ia=ia?this.Qfd(ia):null;if(ib=this.ZPh(H,ib,ia))Lb.push(Object(Kf.a)(new Uc.a,{name:sf.a.x$,string:ib.Jya.Dq[sf.a.x$]})),rg.a.instance.kNa(ib.Pwh,"Taskpane",ib.gHa,ib.Ojd,ib.Jya),1904816141===H&&(Lb.push(Object(Kf.a)(new Uc.a,{name:"ScriptId",string:ia.id})),Lb.push(Object(Kf.a)(new Uc.a,{name:"ShareId",string:ia.shareId})),Lb.push(Object(Kf.a)(new Uc.a,{name:"IsPreviewGallery",bool:!!this.fC.DW.HM(ia.id)})),Lb.push(Object(Kf.a)(new Uc.a,{name:"IsOwner",bool:ia.ubf||!!this.jq.HM(ia.id)})),this.$.Bf());
Pi.a($h.a.RDi,void 0,void 0,Lb)};Ze.prototype.ZPh=function(H,ia,ib){var Lb=null,Nc=sf.a.xu,Vc=new xg.a(sf.a.M7e,sf.a.aUe,sf.a.locale),Hd=new Zg.a(sf.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,sf.a.nMd),Ld=new ih.a;Ld.Dq.AdminPolicyForFeedback=pa.c(this.TFa);Ld.Dq.DocumentHostInfo=Bh.a.Jc(this.$.ya.DocumentHostInfo);Ld.Dq.CodeEditorUrl=sf.a.w3a(this.$);Ld.Dq.MakerTestService=Fg.EwaSettings.getBooleanFeatureGate(sf.a.oCb,!1);Ld.Dq[sf.a.mTf]=sf.a.f3a(this.$);Ld.Dq.StorageModePreference=this.J5f||
"";Ld.Dq.Source="Ribbon";Ld.Dq[sf.a.y7f]=Bh.a.Jc(Nc);Ld.Dq[sf.a.ate]=this.$.nsf?"true":"false";Ld.Dq[sf.a.x$]=qi.a.create().toString();var Be=re(this.$),df=Fd(this.$);Ld.optionalProperties.HeaderCssClass=Be;Ld.optionalProperties.TitleCssClass=df;Ld.Dq[sf.a.I6e]=Be;Ld.Dq[sf.a.E8f]=df;Be={};Be.ribbonCommand=ia;Be[sf.a.H5f]=this.kha.getAuthContext();Be[sf.a.cab]=this.qf.hLf?this.jq.beb():null;Be[sf.a.cPb]=this.qf.oGd?this.Tj.beb():null;sf.a.Z5&&(Be[sf.a.MPa]=this.qf.mGd?this.ut.beb():null);Ld.Dq[sf.a.T$e]=
Bh.a.Jc(Be);ia={};ob(this.$,ia);Ld.Dq[sf.a.pTe]=Bh.a.Jc(ia);switch(H){case -45542983:Ld.Dq.Script="";Ld.Dq.Destination="Editor";Ld.Dq.IsOwner=!0;Ld.optionalProperties[Zd.Yk]=K.a.instance.ga(2093);Ld.optionalProperties[Zd.taskPaneWidth]=Nc;Ld.optionalProperties[Zd.sourceLocationOverrideResourceId]=sf.a.w3a(this.$);Lb=sf.a.K2b;break;case -1342227603:Ld.optionalProperties[Zd.Yk]=K.a.instance.ga(2095);Ld.optionalProperties[Zd.taskPaneWidth]=Nc;Ld.optionalProperties[Zd.sourceLocationOverrideResourceId]=
sf.a.u0e(this.$);break;case 971811139:case 1606046412:Ld.Dq.Script="";Ld.Dq.Destination="BackStage";Ld.Dq.IsOwner=!0;Ld.optionalProperties[Zd.Yk]=K.a.instance.ga(2093);Ld.optionalProperties[Zd.taskPaneWidth]=Nc;Ld.optionalProperties[Zd.sourceLocationOverrideResourceId]=sf.a.w3a(this.$);Lb=sf.a.K2b;break;case 1043696663:Ld.Dq.Script="";Ld.Dq.Destination="BackStage_Workbook";Ld.optionalProperties[Zd.Yk]=K.a.instance.ga(2093);Ld.optionalProperties[Zd.taskPaneWidth]=Nc;Ld.optionalProperties[Zd.sourceLocationOverrideResourceId]=
sf.a.w3a(this.$);Lb=sf.a.K2b;break;case 1845457202:Ld.optionalProperties[Zd.Yk]=K.a.instance.ga(2094);Ld.optionalProperties[Zd.taskPaneWidth]=Nc;Ld.optionalProperties[Zd.sourceLocationOverrideResourceId]=sf.a.L0e(this.$);Lb=sf.a.djj;break;case 1904816141:if(ib)Ld.Dq.Script=Bh.a.Jc(ib.lVd()),Ld.Dq.Destination="Details",Ld.Dq.IsOwner=ib.ubf||!!this.jq.HM(ib.id),Ld.optionalProperties[Zd.Yk]=K.a.instance.ga(2093),Ld.optionalProperties[Zd.taskPaneWidth]=Nc,Ld.optionalProperties[Zd.sourceLocationOverrideResourceId]=
sf.a.w3a(this.$),Lb=sf.a.K2b;else return null;break;default:return null}return new dg(Vc,Hd,Ld,Lb)};Ze.prototype.QGh=function(){var H=this;Yd.a.instance.kc("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(function(ia){H.TFa.FeedbackEnabled=!0;H.TFa.ScreenshotEnabled=!0;H.TFa.EmailEnabled=!0;ia.RJ("Enabled").then(function(ib){H.TFa.FeedbackEnabled=ib},function(){});ia.RJ("IncludeScreenshot").then(function(ib){H.TFa.ScreenshotEnabled=ib},function(){});ia.RJ("IncludeEmail").then(function(ib){H.TFa.EmailEnabled=
ib},function(){})})};Ze.prototype.q3h=function(H){var ia=this,ib=zi.a.Ua.Vb,Lb=[];if(!H||!H.IsSuccess){var Nc=H?H.ErrorCode:"need_token";H=H?H.ErrorMessage:"No Access Token";Lb.push(Object(Kf.a)(new Uc.a,{name:"ServiceChecked",bool:!1}));Lb.push(Object(Kf.a)(new Uc.a,{name:"Error",string:H}));Lb.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode",string:Nc}));Pi.a($h.a.nyd,!1,Di.getElapsedMilliseconds(ib,zi.a.Ua.Vb),Lb);this.HA=new Wf(!1,!1,void 0,Nc,H);return Promise.resolve(!1)}Lb.push(Object(Kf.a)(new Uc.a,
{name:"ServiceChecked",bool:!0}));Xd(this.$,H.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(function(Vc){ia.HA=new Wf(Vc.OfficeScriptingEnabled,!0);ia.qf.rSg(sf.a.Y$b(ia.$),Vc.OfficeScriptingEnabled);Lb.push(Object(Kf.a)(new Uc.a,{name:"IsEnabled",bool:ia.HA.value}));Pi.a($h.a.nyd,!0,Di.getElapsedMilliseconds(ib,zi.a.Ua.Vb),Lb);return Promise.resolve(ia.HA.value)}).catch(function(Vc){Object.getType(Vc)===makerstorage.StorageServiceError?(Lb.push(Object(Kf.a)(new Uc.a,
{name:"Error",string:Vc.message})),Lb.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Vc.errorCode.toString(),Vc.status.toString())}))):(Lb.push(Object(Kf.a)(new Uc.a,{name:"Error",string:Vc.toString()})),Lb.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode",string:"exception"})));Pi.a($h.a.nyd,!1,Di.getElapsedMilliseconds(ib,zi.a.Ua.Vb),Lb);ia.HA=new Wf(!1,!1,void 0,"exception",Vc.toString());return Promise.resolve(!1)})};Ze.prototype.i1e=function(H){var ia=this;
this.qf.rVh(this.fC);sf.a.Z5?this.qf.kUh(H,this.fC,this.cache):this.JTh(H);sa()||this.qf.k4i(function(ib){ia.qf.eWh(ib,H,ia.fC)},this.fC)};Ze.prototype.JTh=function(H){var ia=this,ib=zi.a.Ua.Vb,Lb=[];if(H&&H.IsSuccess){Xd(this.$,H.Token);var Nc=T.a.create().toString();Lb.push(Object(Kf.a)(new Uc.a,{name:"CorrelationId",string:Nc}));makerstorage.getScripts(Nc).then(function(Vc){Lb.push(Object(Kf.a)(new Uc.a,{name:"HasReadCachedScripts",bool:ia.qf.Jwb}));ia.jq.clear();Vc=Gl(Vc);for(var Hd=Vc.next();!Hd.done;Hd=
Vc.next())ia.jq.Mu(new Qf(Hd.value));ia.jq.sort();ia.qf.hLf=!0;ia.qf.uab=!0;ia.Iwa&&(Vc=Bh.a.Jc(ia.jq.beb()),ia.indexedDB.Tbb(new Vj.a(sf.a.cab,Vc)));Lb.push(Object(Kf.a)(new Uc.a,{name:"ScriptCount",int64:ia.jq.length}));Pi.a($h.a.DDb,!0,Di.getElapsedMilliseconds(ib,zi.a.Ua.Vb),Lb);ia.YN(sf.a.cab)}).catch(function(Vc){Object.getType(Vc)===makerstorage.StorageServiceError?(Lb.push(Object(Kf.a)(new Uc.a,{name:"Error",string:Vc.message})),Lb.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",
Vc.errorCode.toString(),Vc.status.toString())})),17===Vc.errorCode&&ia.cache.VHd(sf.a.Y$b(ia.$))):(Lb.push(Object(Kf.a)(new Uc.a,{name:"Error",string:Vc.toString()})),Lb.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode",string:"exception"})));Pi.a($h.a.DDb,!1,Di.getElapsedMilliseconds(ib,zi.a.Ua.Vb),Lb);ia.qf.uab=!0;ia.YN(sf.a.cab)})}else Nc=H?H.ErrorCode:"need_token",H=H?H.ErrorMessage:"No Access Token",Lb.push(Object(Kf.a)(new Uc.a,{name:"ServiceChecked",bool:!1})),Lb.push(Object(Kf.a)(new Uc.a,{name:"Error",
string:H})),Lb.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode",string:Nc})),Pi.a($h.a.DDb,!1,Di.getElapsedMilliseconds(ib,zi.a.Ua.Vb),Lb),this.qf.uab=!0,this.YN(sf.a.cab)};Ze.prototype.Qfd=function(H){if(sf.a.Z5)return this.fC.Qfd(H);switch(H){case "1":case "2":case "3":case "4":case "5":case "6":return this.fC.DW.z4(parseInt(H,10)-1);default:return this.jq.HM(H)||this.Tj.HM(H)||this.CB.HM(H)}};Ze.prototype.Xhd=function(H){if(this.jq.Mu(H)){this.jq.sort();var ia=""}else{ia="";var ib=H.J_a();this.Tj.Xeb(ib);
this.Tj.sort();this.jq.Xeb(H);this.jq.sort()}return{returnValue:!0,message:ia}};Ze.prototype.Vhd=function(H){this.Tj.$0a(H.id);return this.jq.$0a(H.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}};Ze.prototype.Uhd=function(H){var ia=H.J_a();ia.shareId=null;this.jq.Mu(ia)&&this.jq.sort();return this.Tj.Mu(H)?(this.Tj.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};
Ze.prototype.Whd=function(H){return this.Tj.$0a(H.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};Ze.prototype.YN=function(H){if(sf.a.Z5)this.fC.YN(H);else{this.yGd();this.$.Bf();var ia=[];ia.push(Object(Kf.a)(new Uc.a,{name:"Operation",string:H}));ia.push(Object(Kf.a)(new Uc.a,{name:"HasReadCachedScripts",bool:this.qf.Jwb}));ia.push(Object(Kf.a)(new Uc.a,{name:"ReadScriptsDone",bool:this.qf.Mid}));ia.push(Object(Kf.a)(new Uc.a,
{name:"ReadSamplesScriptsDone",bool:this.qf.YGb}));ia.push(Object(Kf.a)(new Uc.a,{name:"SamplesScriptCount",int64:this.CB.length}));ia.push(Object(Kf.a)(new Uc.a,{name:"ReadPublishedScriptsDone",bool:this.qf.uab}));ia.push(Object(Kf.a)(new Uc.a,{name:"PublishedScriptCount",int64:this.jq.length}));ia.push(Object(Kf.a)(new Uc.a,{name:"ReadWorkbookScriptsDone",bool:this.qf.LW}));ia.push(Object(Kf.a)(new Uc.a,{name:"WorkbookScriptCount",int64:this.Tj.length}));Pi.a($h.a.ssf,!0,0,ia)}};Ze.prototype.yGd=
function(){this.fC.DW=new lc([],function(){});for(var H=this.Tj?this.Tj.length:0,ia=this.jq?this.jq.length:0,ib=this.CB?this.CB.length:0,Lb=0,Nc=sf.a.AHf,Vc=0;Vc<Nc;Vc++)if(Vc<H)this.fC.DW.Mu(this.Tj.z4(Vc));else if(Vc-H+Lb<ia){var Hd=this.jq.z4(Vc-H+Lb);this.Tj.HM(Hd.id)?(Lb++,Vc--):this.fC.DW.Mu(Hd)}else Vc-H-ia+Lb<ib&&this.fC.DW.Mu(this.CB.z4(Vc-H+Lb-ia))};Ze.prototype.BJd=function(H){Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",
!1)&&(H?(sj.PageLoadTrackingInfo.instance.d7(gh.a.fO,["automateTab"]),sj.PageLoadTrackingInfo.instance.WW(gh.a.fO,["automateTab"]),sj.PageLoadTrackingInfo.instance.bS(gh.a.fO,["automateTab"])):sj.PageLoadTrackingInfo.instance.rda(gh.a.fO,["automateTab"]))};Ze.prototype.f5h=function(){Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&Cj.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(gh.a.UGb))};Ck.Object.defineProperties(Ze.prototype,{jq:{configurable:!0,
enumerable:!0,get:function(){return this.qf.jq}},Tj:{configurable:!0,enumerable:!0,get:function(){return sa()?new lc([],function(){}):this.qf.Tj}},CB:{configurable:!0,enumerable:!0,get:function(){return this.qf.CB}},ut:{configurable:!0,enumerable:!0,get:function(){return this.qf.ut}},Ta:{configurable:!0,enumerable:!0,get:function(){return this.LPc}},K4a:{configurable:!0,enumerable:!0,get:function(){return this.qf.K4a}},initTime:{configurable:!0,enumerable:!0,get:function(){return this.Fpg}},Gba:{configurable:!0,
enumerable:!0,get:function(){var H=!!this.Ou.ly&&this.Ou.ly.isSuccess&&this.Ou.ly.value,ia=!!this.HA&&!this.HA.isSuccess,ib=!!this.HA&&this.Ou.ly.isSuccess&&this.HA.value;ia=sf.a.Jta||ib||ia&&!hb.a.Mka(11);return this.jhf&&H&&ia}},jhf:{configurable:!0,enumerable:!0,get:function(){var H="TestHost"===this.$.ya.DocumentHostInfo.HostTier,ia=ag.AFrameworkApplication.fa.Va("UserPrincipalName");ia=!ag.AFrameworkApplication.fa.ra("IsAnonymousUser")&&!!ia&&!ia.includes("ext#")&&!ia.includes("guest#");return!hb.a.Cka&&
(H||this.kha.hse&&ia)}}});Object(fe.a)(Ze,"AutomateCommandManager",null,[521]);var Fj=b(1404),Dk=b(1355),li=b(245);kf.key="InsertAgaveClientSideParametersKey";Object(fe.a)(kf,"InsertAgaveClientSideParameters",null,[]);var hj=b(51),ok=b(104),vj=b(22),hk=b(1165);Ge.prototype.uwb=function(H){if(H.Gba){var ia=[];ia.push(Object(Kf.a)(new Uc.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.O6a}));ia.push(Object(Kf.a)(new Uc.a,{name:"actionName",string:H.actionName}));ia.push(Object(Kf.a)(new Uc.a,
{name:sf.a.x$,string:H.clickId.toString()}));this.O6a?this.rWf(H):this.h1h(H);Pi.a($h.a.SDi,void 0,void 0,ia)}};Ge.prototype.uhd=function(H,ia){var ib={};ib[sf.a.x$]=ia;this.YMd(H,ib)};Ge.prototype.Psj=function(){this.l1f()?this.MGf():vj.g(this.$).Ea.fme(this.c9a)};Ge.prototype.l1f=function(){if(this.O6a||Wb(this.$))return!1;var H=ok.a(this.$);return vj.g(this.$).Ea.c_b&&H.rdi()};Ge.prototype.MGf=function(){var H=this;this.Ou.ly?this.Ou.ly.value&&this.kha.vvb():this.Ou.M_c().then(function(ia){ia&&
H.kha.vvb()});Pi.a($h.a.NDi)};Ge.prototype.jlj=function(){var H=qi.a.create().toString(),ia={};ob(this.$,ia);var ib={};ib[sf.a.H5f]=this.kha.getAuthContext();var Lb={};Lb[sf.a.pTe]=Bh.a.Jc(ia);Lb[sf.a.T$e]=Bh.a.Jc(ib);Lb[sf.a.zgh]=Bh.a.Jc(this.$.ya.DocumentHostInfo);Lb[sf.a.RDj]=dc(this.$);Lb[sf.a.y7f]=Bh.a.Jc(sf.a.xu);Lb[sf.a.ate]=this.$.nsf?"true":"false";Lb[sf.a.mTf]=sf.a.f3a(this.$);Lb[sf.a.I6e]=re(this.$);Lb[sf.a.E8f]=Fd(this.$);Lb[sf.a.x$]=H;ia=[];ia.push(Object(Kf.a)(new Uc.a,{name:sf.a.x$,
string:H}));Pi.a($h.a.QDi,void 0,void 0,ia);this.YMd(sf.a.Z8h,Lb)};Ge.prototype.h1h=function(H){var ia=this;this.kxj(H);Wb(this.$)&&Xd(this.$,"localstorage");Nh.TaskExtensions.Ba(hj.GetServiceTaskFactory.Xa(this.$.da,374,375,1),function(ib){ia.Bri(ib.result).continueWith(function(){ia.ilj(H)});ia.O6a=!0},this.$.la,3)};Ge.prototype.Bri=function(H){var ia={};ia.SolutionId=sf.a.solutionId;ia.Version=sf.a.nMd;ia.StoreType=OSF.StoreType.Sdx;ia.StoreId=OSF.StoreType.Sdx;ia.AssetId=sf.a.solutionId;ia.AssetStoreId=
OSF.StoreType.Sdx;ia.TargetType=1;ia.SharedRuntimeId=sf.a.Nvb(this.$);ia.SourceLocationOverrideResourceId=sf.a.Nvb(this.$);ia.IsToBePersisted=!1;var ib=new Fj.a;ib.Yk=K.a.instance.ga(2115);ib.taskPaneWidth=sf.a.xu;var Lb=new kf;Lb.dNb=Fd(this.$);Lb.cba=re(this.$);return H.XLd(ia,ib,void 0,void 0,Lb)};Ge.prototype.ilj=function(H){this.jlj();li.a(this.$)&&li.a(this.$).tme(this.VGi);this.rWf(H)};Ge.prototype.rWf=function(H){var ia={};ia[sf.a.uhj]=H.shapeId;ia[sf.a.thj]=H.scriptLink;ia[sf.a.x$]=H.clickId.toString();
ia[sf.a.shj]=H.buttonText;this.YMd(H.actionName,ia)};Ge.prototype.YMd=function(H,ia){var ib=new Zg.a(sf.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,sf.a.nMd),Lb=new xg.a(sf.a.M7e,sf.a.aUe,this.$.ya.UICultureTag),Nc=new ih.a;Nc.optionalProperties[Zd.Yk]=K.a.instance.ga(2115);Nc.optionalProperties[Zd.sourceLocationOverrideResourceId]=sf.a.Nvb(this.$);Nc.optionalProperties[Zd.gTc]=ia;Nc.optionalProperties[Zd.taskPaneWidth]=sf.a.xu;rg.a.instance.kNa(ib,Dk.a.action,H,Lb,Nc)};Ge.prototype.kxj=function(H){Fg.EwaSettings.getBooleanFeatureGate(sf.a.z7f,
!1)&&H.actionName===sf.a.WTf&&(H=new hk.a(H.scriptLink,"initializing",H.clickId.toString(),H.buttonText),this.businessBarManager.lle(63,H))};Object(fe.a)(Ge,"AutomateCommandRunFromButton",null,[520]);var yk=b(162),Kj=b(21);sd.BBj=function(H){H.sort(function(ia,ib){return ib.wFe-ia.wFe})};sd.ASd=function(H){H.sort(function(ia,ib){return Kj.a.compare(ia.name,ib.name,!0)})};sd.TWh=function(H){var ia;var ib=ia=null;if(H){var Lb=H.indexOf(":");if(-1!==Lb)return ia=H.substr(0,Lb),ib=H.substr(Lb+1),{returnValue:!0,
I5f:ia,shareId:ib}}return{returnValue:!1,I5f:ia,shareId:ib}};sd.QVh=function(H,ia){var ib={};ib[sf.a.Mfg]=encodeURIComponent(H.workbookContext.WorkbookFileName);ib[sf.a.xVf]=ia.beb();return pa.c(ib)};sd.lLf=function(H,ia){return Nh.TaskExtensions.Yha(ia.E3a(sf.a.cPb),function(ib){ib=ib.result;if(""!==ib){ib=pa.b(ib);var Lb=ib[sf.a.xVf];if(ib[sf.a.Mfg]===encodeURIComponent(H.workbookContext.WorkbookFileName)){ib=new lc([],function(Vc){sd.ASd(Vc)});Lb=Gl(Lb);for(var Nc=Lb.next();!Nc.done;Nc=Lb.next())ib.Mu(new Qf(Nc.value));
ib.sort();return ib}}},H.la,3)};Ck.Object.defineProperties(sd.prototype,{K4a:{configurable:!0,enumerable:!0,get:function(){var H=sf.a.Z5?this.jdc:this.Jwb;return this.YGb||H||this.Mid}},Mid:{configurable:!0,enumerable:!0,get:function(){return(sf.a.Z5?this.vab:this.uab)&&this.LW&&this.YGb}}});Object(fe.a)(sd,"AutomateCommandStorageBase",null,[]);var Gh=b(121),Ok=b(99);Wl(ce,sd);ce.prototype.rSg=function(H,ia){if(this.cache.Sf()){var ib={};ib.TimeStamp=zi.a.Ua.Vb;ib.IsEnabled=ia;this.cache.kOd(H,Bh.a.Jc(ib))}};
ce.prototype.KIh=function(H){var ia=!1,ib=!1,Lb=null;this.cache.Sf()&&(H=pa.b(this.cache.qvb(H)))&&(ib=H.IsEnabled,Lb=new Date(H.TimeStamp),ia=!0);return new Wf(ib,ia,Lb)};ce.prototype.iLf=function(H){var ia=this,ib=zi.a.Ua.Vb,Lb=[];return Nh.TaskExtensions.Yha(this.indexedDB.E3a(sf.a.MPa),function(Nc){var Vc=!ia.vab||!ia.ut.length;Nc=Nc.result;Lb.push(Object(Kf.a)(new Uc.a,{name:"ExistingScriptCount",int64:ia.ut.length}));if(""!==Nc&&(Nc=pa.b(Nc),Lb.push(Object(Kf.a)(new Uc.a,{name:"CachedScriptCount",
int64:Nc.length})),Vc)){for(var Hd=Gl(Nc),Ld=Hd.next();!Ld.done;Ld=Hd.next())ia.ut.Mu(new Qf(Ld.value));ia.jdc=!0;ia.mGd=0<Nc.length;Pi.a($h.a.qsf,Vc,Di.getElapsedMilliseconds(ib,zi.a.Ua.Vb),Lb);ia.WGd(H);return!0}Pi.a($h.a.qsf,Vc,Di.getElapsedMilliseconds(ib,zi.a.Ua.Vb),Lb);return!1},this.$.la,3)};ce.prototype.l4i=function(H){Fg.EwaSettings.getBooleanFeatureGate(sf.a.vXc,!1)&&!sa()&&this.r4i(H);sf.a.Z5?this.iLf(H):this.j4i(H)};ce.prototype.kUh=function(H,ia,ib){var Lb=this,Nc=zi.a.Ua.Vb,Vc=[];if(H&&
H.IsSuccess){Xd(this.$,H.Token);var Hd=T.a.create().toString();Vc.push(Object(Kf.a)(new Uc.a,{name:"CorrelationId",string:Hd}));makerstorage.getRecentScripts(Hd).then(function(Ld){Vc.push(Object(Kf.a)(new Uc.a,{name:"HasReadCachedScripts",bool:Lb.jdc}));Lb.ut.clear();Ld=Gl(Ld);for(var Be=Ld.next();!Be.done;Be=Ld.next())Lb.ut.Mu(new Qf(Be.value));Lb.mGd=!0;Lb.vab=!0;Lb.indexedDB.Sf()&&(Ld=Bh.a.Jc(Lb.ut.beb()),Lb.indexedDB.Tbb(new Vj.a(sf.a.MPa,Ld)));Vc.push(Object(Kf.a)(new Uc.a,{name:"ScriptCount",
int64:Lb.ut.length}));Pi.a($h.a.DDb,!0,Di.getElapsedMilliseconds(Nc,zi.a.Ua.Vb),Vc);ia.YN(sf.a.MPa)}).catch(function(Ld){Object.getType(Ld)===makerstorage.StorageServiceError?(Vc.push(Object(Kf.a)(new Uc.a,{name:"Error",string:Ld.message})),Vc.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Ld.errorCode.toString(),Ld.status.toString())})),17===Ld.errorCode&&ib.VHd(sf.a.Y$b(Lb.$))):(Vc.push(Object(Kf.a)(new Uc.a,{name:"Error",string:Ld.toString()})),Vc.push(Object(Kf.a)(new Uc.a,
{name:"ErrorCode",string:"exception"})));Pi.a($h.a.ODi,!1,Di.getElapsedMilliseconds(Nc,zi.a.Ua.Vb),Vc);Lb.vab=!0;ia.YN(sf.a.MPa)})}else Hd=H?H.ErrorCode:"need_token",H=H?H.ErrorMessage:"No Access Token",Vc.push(Object(Kf.a)(new Uc.a,{name:"ServiceChecked",bool:!1})),Vc.push(Object(Kf.a)(new Uc.a,{name:"Error",string:H})),Vc.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode",string:Hd})),Pi.a($h.a.DDb,!1,Di.getElapsedMilliseconds(Nc,zi.a.Ua.Vb),Vc),this.vab=!0,ia.YN(sf.a.MPa)};ce.prototype.k4i=function(H,
ia){var ib=this,Lb=new yk.a,Nc=ke(this.$);nd(this.$,function(Vc){if((Vc=Vc.Result)&&200===Vc.ResponseStatusCode)Vc=Vc.ResponseBody.join(""),Vc=JSON.parse(Vc),H(ib.sVi(Vc.value)),Lb.setResult(!0);else{Vc=Vc?"RichApi_"+Vc.ResponseStatusCode:"RichApiError";var Hd=[];Hd.push(Object(Kf.a)(new Uc.a,{name:"Error",string:"Failed to read shared script ids from document"}));Hd.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode",string:Vc}));ib.LW=!0;ib.y_a(ia,zi.a.Ua.Vb,0,Hd);Lb.setResult(!1)}},function(Vc){Vc=Gh.a.ig(Vc.data);
af.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");var Hd=[];Hd.push(Object(Kf.a)(new Uc.a,{name:"Error",string:"Failure using rich api: "+Vc}));Hd.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode",string:"RichApiFailure"}));ib.LW=!0;ib.y_a(ia,zi.a.Ua.Vb,0,Hd);Lb.setResult(!1)},Nc,Lb)};ce.prototype.eWh=function(H,ia,ib){var Lb=this,Nc=zi.a.Ua.Vb,Vc=0,Hd=0;this.LW=Vc===H.count;var Ld=[];Ld.push(Object(Kf.a)(new Uc.a,{name:"ScriptIds",int64:H.count}));
if(H.count)if(ia&&ia.IsSuccess){Xd(this.$,ia.Token);var Be={};ia=Gl(H);for(var df=ia.next();!df.done;Be={Ifb:Be.Ifb},df=ia.next())df=df.value,Be.Ifb=T.a.create().toString(),makerstorage.getSharedScript(df.value,Be.Ifb).then(function(uf){return function(og){var dh=[];dh.push(Object(Kf.a)(new Uc.a,{name:"BodySize",int64:og.body.length}));dh.push(Object(Kf.a)(new Uc.a,{name:"CorrelationId",string:uf.Ifb}));Pi.a($h.a.rsf,!0,Di.getElapsedMilliseconds(Nc,zi.a.Ua.Vb),dh);Vc++;og=new Qf(og);og.shareId=H.oa(og.id);
Lb.Tj.Mu(og);Lb.LW=Vc===H.count;Lb.oGd=!0;Lb.y_a(ib,Nc,Hd,Ld)}}(Be)).catch(function(uf){return function(og){var dh=[];Object.getType(og)===makerstorage.StorageServiceError?(Ld.push(Object(Kf.a)(new Uc.a,{name:"Error",string:og.message})),Ld.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",og.errorCode.toString(),og.status.toString())}))):(dh.push(Object(Kf.a)(new Uc.a,{name:"Error",string:og.toString()})),dh.push(Object(Kf.a)(new Uc.a,{name:"ErrorCode",string:"exception"})));
dh.push(Object(Kf.a)(new Uc.a,{name:"CorrelationId",string:uf.Ifb}));Pi.a($h.a.rsf,!1,Di.getElapsedMilliseconds(Nc,zi.a.Ua.Vb),dh);Vc++;Hd++;Lb.LW=Vc===H.count;Lb.y_a(ib,Nc,Hd,Ld)}}(Be)).finally(function(){if(Fg.EwaSettings.getBooleanFeatureGate(sf.a.vXc,!1)&&Lb.indexedDB.Sf()&&Lb.LW){var uf=sd.QVh(Lb.$,Lb.Tj);Lb.indexedDB.Tbb(new Vj.a(sf.a.cPb,uf))}})}else Be=ia?ia.ErrorCode:"need_token",ia=ia?ia.ErrorMessage:"No Access Token",Ld.push(Object(Kf.a)(new Uc.a,{name:"Error",string:ia})),Ld.push(Object(Kf.a)(new Uc.a,
{name:"ErrorCode",string:Be})),this.LW=!0,this.y_a(ib,Nc,Hd,Ld);else this.LW=this.oGd=!0,this.y_a(ib,Nc,Hd,Ld),Fg.EwaSettings.getBooleanFeatureGate(sf.a.vXc,!1)&&Nh.TaskExtensions.Yha(sd.lLf(this.$,this.indexedDB),function(uf){uf.result&&(Lb.indexedDB.F5c(sf.a.cPb),Lb.Tj.clear(),ib.YN("CachedScripts"))},this.$.la,3)};ce.prototype.rVh=function(H){var ia={id:"samples-6"};ia.name=K.a.instance.ga(2111);this.CB.Mu(new Qf(ia));ia.id="samples-8";ia.name=K.a.instance.ga(2112);this.CB.Mu(new Qf(ia));ia.id=
"samples-2";ia.name=K.a.instance.ga(2108);this.CB.Mu(new Qf(ia));ia.id="samples-4";ia.name=K.a.instance.ga(2109);this.CB.Mu(new Qf(ia));ia.id="samples-5";ia.name=K.a.instance.ga(2110);this.CB.Mu(new Qf(ia));ia.id="samples-9";ia.name=K.a.instance.ga(2113);this.CB.Mu(new Qf(ia));this.YGb=!0;H.YN("SampleScripts")};ce.prototype.sVi=function(H){var ia=new Ok.a;if(H=this.t1a.parseFromString(H,"text/xml").querySelector('[id="script-ids-node-id"]')){H=H.getElementsByTagName("scriptId");for(var ib={},Lb=0;Lb<
H.length;ib={PPb:ib.PPb,MPb:ib.MPb,HPb:ib.HPb},Lb++)ib.PPb=H[Lb].getAttribute("id"),ib.PPb&&(ib.MPb=void 0,ib.HPb=void 0,function(Nc){return function(){var Vc=sd.TWh(Nc.PPb);Nc.MPb=Vc.I5f;Nc.HPb=Vc.shareId;return Vc}}(ib)().returnValue&&ia.ia(ib.MPb,ib.HPb))}return ia};ce.prototype.r4i=function(H){var ia=this,ib=zi.a.Ua.Vb,Lb=[];Nh.TaskExtensions.Yha(sd.lLf(this.$,this.indexedDB),function(Nc){var Vc=Nc.result;Lb.push(Object(Kf.a)(new Uc.a,{name:"ExistingScriptCount",int64:ia.Tj.length}));if(Vc){Lb.push(Object(Kf.a)(new Uc.a,
{name:"CachedScriptCount",int64:Vc.length}));if(Nc=!ia.LW||0===ia.Tj.length){Vc=Gl(Vc.getScripts());for(var Hd=Vc.next();!Hd.done;Hd=Vc.next())ia.Tj.Mu(Hd.value);ia.Tj.sort();Pi.a($h.a.oyd,Nc,Di.getElapsedMilliseconds(ib,zi.a.Ua.Vb),Lb);ia.WGd(H);return!0}Pi.a($h.a.oyd,Nc,Di.getElapsedMilliseconds(ib,zi.a.Ua.Vb),Lb)}else Pi.a($h.a.oyd,!1,Di.getElapsedMilliseconds(ib,zi.a.Ua.Vb),Lb);return!1},this.$.la,3)};ce.prototype.j4i=function(H){var ia=this,ib=zi.a.Ua.Vb,Lb=[];Nh.TaskExtensions.Yha(this.indexedDB.E3a(sf.a.cab),
function(Nc){var Vc=!ia.uab||!ia.jq.length;Nc=Nc.result;Lb.push(Object(Kf.a)(new Uc.a,{name:"ExistingScriptCount",int64:ia.jq.length}));if(""!==Nc&&(Nc=pa.b(Nc),Lb.push(Object(Kf.a)(new Uc.a,{name:"CachedScriptCount",int64:Nc.length})),Vc)){Nc=Gl(Nc);for(var Hd=Nc.next();!Hd.done;Hd=Nc.next())ia.jq.Mu(new Qf(Hd.value));ia.jq.sort();Pi.a($h.a.psf,Vc,Di.getElapsedMilliseconds(ib,zi.a.Ua.Vb),Lb);ia.WGd(H);return!0}Pi.a($h.a.psf,Vc,Di.getElapsedMilliseconds(ib,zi.a.Ua.Vb),Lb);return!1},this.$.la,3)};
ce.prototype.y_a=function(H,ia,ib,Lb){this.LW&&(Lb.push(Object(Kf.a)(new Uc.a,{name:"ScriptCount",int64:this.Tj.length})),Lb.push(Object(Kf.a)(new Uc.a,{name:"ScriptErrorCount",int64:ib})),Pi.a($h.a.PDi,!ib,Di.getElapsedMilliseconds(ia,zi.a.Ua.Vb),Lb),this.Tj.sort(),H.YN(sf.a.cPb))};ce.prototype.WGd=function(H){this.Jwb=!0;H.YN("CachedScripts")};Object(fe.a)(ce,"AutomateCommandStorage",sd,[]);var pk=qg.a;Wl(Kd,pk);Kd.prototype.create=function(){var H=this,ia=hj.GetServiceTaskFactory.Xa(this.$.da,
349,350,this.vb),ib=ek.a.loadScript(110,4,this.vb,void 0,void 0,351),Lb=hj.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.vb),Nc=hj.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.vb),Vc=hj.GetServiceTaskFactory.Xa(this.$.da,5,4,this.vb);Nh.TaskExtensions.Ba(Nh.TaskExtensions.te([ia,ib,Lb,Nc,Vc],this.la,3),function(){var Hd=ia.result,Ld=Nc.result,Be=Vc.result,df=new of,uf=new xd(H.$,Hd,df),og=new ce(H.$,Ld),dh=new mg(H.$,og);Be=new Ge(H.$,uf,df,Be);H.Eb(H.$.da.za(352)||new Ze(H.$,
Hd,Lb.result,Ld,Be,df,uf,og,dh))},this.la,3)};Kd.ka=function(H){H&&H.da.Ga(351,new Kd(H))};Object(fe.a)(Kd,"AutomateCommandManagerFactory",qg.a,[]);var Nj=b(103),mj=b(1356),fk=b(186),Lj=b(58);Ac.prototype.$c=function(){return!1};Ac.prototype.executeCommand=function(H,ia,ib){H=!1;switch(ia.command){case 73979048:this.Krb&&this.Krb.hZi(ia,Nj.a.instance,ag.AFrameworkApplication.fa,ib),H=!0}return H?Lj.Task.Sa(!0):fk.a(ia.command)};Ac.prototype.Mc=function(H,ia){return 73979048===ia.command&&Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)};Ac.prototype.jd=function(){return!1};Ac.prototype.dispose=function(){this.Krb&&this.Krb.dispose()};Object(fe.a)(Ac,"DataFromPictureCommandHandler",null,[428,3]);var bl=yj.a;Wl(Te,bl);Te.prototype.Od=function(){var H=this,ia=hj.GetServiceTaskFactory.Xa(this.$.da,328,327,1),ib=hj.GetServiceTaskFactory.Xa(this.$.da,484,485,1);Nh.TaskExtensions.Ba(Nh.TaskExtensions.te([ia,ib],this.$.la),function(){H.Cd([new Ac(H.$,ia.result,ib.result)])},this.$.la,3)};Te.ka=function(H){yj.a.ee(452,new Te(H))};Object(fe.a)(Te,
"DataFromPictureCommandHandlerFactory",yj.a,[]);ne.prototype.ZRh=function(H){af.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",H);for(var ia=new Kg.a,ib=Gl(this.f1b),Lb=ib.next();!Lb.done;Lb=ib.next()){Lb=Gl(Lb.value.ADb);for(var Nc=Lb.next();!Nc.done;Nc=Lb.next())Nc=Nc.value,Nc.id===H&&ia.add(Nc)}return ia};ne.prototype.Cke=function(H){this.f1b.add(H)};ne.prototype.x8i=function(H){for(var ia=Gl(this.f1b),ib=ia.next();!ib.done;ib=ia.next())if(ib=ib.value,ib.voe===H.voe){this.f1b.remove(ib);
break}};ne.Geh=function(H,ia,ib){ib=void 0===ib?null:ib;H=ne.qKh(H);0<H.length&&(ne.Svc(H,!1),ib&&ib(ia,H))};ne.qKh=function(H){var ia=[];if(H&&H.ADb&&0<H.ADb.count){H=Gl(H.ADb);for(var ib=H.next();!ib.done;ib=H.next())if(ib=ib.value,ib.controls&&0<ib.controls.count){ib=Gl(ib.controls);for(var Lb=ib.next();!Lb.done;Lb=ib.next())if(Lb=Lb.value,Lb.menuItems&&0<Lb.menuItems.count){Lb=Gl(Lb.menuItems);for(var Nc=Lb.next();!Nc.done;Nc=Lb.next())Array.add(ia,Nc.value.id)}}}return ia};ne.Svc=function(H,
ia){if(H.length){var ib=[];H=Gl(H);for(var Lb=H.next();!Lb.done;Lb=H.next())ib.push(appChrome.actions.updateControlEnabledDisabledState(Lb.value,ia));appChrome.api.dispatch(ib)}};Ck.Object.defineProperties(ne.prototype,{f1b:{configurable:!0,enumerable:!0,get:function(){return this.$kg}}});Object(fe.a)(ne,"ContextMenuExtensibilityCache",null,[246,247]);var pl=b(1479),Xj=b(1073),Ek=b(1017);Af.prototype.nYa=function(H,ia){ia=void 0===ia?null:ia;if(H=Ek.a.pub(H)){appChrome.addInApi.dispatchActionsToInstallAddIn(H,
ia);ia=Gl(H.tabs);for(var ib=ia.next();!ib.done;ib=ia.next())if(ib.value.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(H,function(){});break}}};Af.prototype.jId=function(H){(H=Ek.a.pub(H))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(H)};Af.Oeh=function(H,ia,ib){ib=void 0===ib?null:ib;H=Af.WUh(H);0<H.length&&(Af.Svc(H,!1),ib&&ib(ia,H))};Af.WUh=function(H){var ia=[];if(H&&(H=H.pW,H.Ps&&0<H.Ps.count)){H=Gl(H.Ps);for(var ib=H.next();!ib.done;ib=H.next())if(ib=ib.value,ib.groups&&
0<ib.groups.length){ib=Gl(ib.groups);for(var Lb=ib.next();!Lb.done;Lb=ib.next())if(Lb=Lb.value,Lb.controls&&0<Lb.controls.length){Lb=Gl(Lb.controls);for(var Nc=Lb.next();!Nc.done;Nc=Lb.next())Array.add(ia,Nc.value.id)}}}return ia};Af.Svc=function(H){if(H.length){var ia=[];H=Gl(H);for(var ib=H.next();!ib.done;ib=H.next())ia.push(appChrome.actions.updateControlEnabledDisabledState(ib.value,!0));appChrome.api.dispatch(ia)}};Object(fe.a)(Af,"OneLineRibbonExtensibilityManager",null,[276]);var qk=b(1140);
he.prototype.getTaskPaneControlIdFromAssetIdRuntimeId=function(H,ia){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(H,ia)};he.prototype.shd=function(H,ia,ib,Lb,Nc,Vc,Hd){Vc=void 0===Vc?null:Vc;Hd=void 0===Hd?null:Hd;af.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",H);if((H=ia.Ria(Nc.ownerAddinInfo.storeType,Nc.ownerAddinInfo.solutionId))&&H.xB&&!H.xB.getIsUpgrading())if(ia=null,0<H.xB.getNotificationParams().length&&(ia=this.Xte(H.xB.getNotificationParams()[0]))&&
2147758681===ia.errorCode&&(H.isUpgraded=!0),2!==H.xB.getStatus()&&(1!==H.xB.getStatus()||ia&&2147758681===ia.errorCode))ia&&this.V1f(H,ia,Hd);else try{ib.setOwnerAddinEToken(H.xB.getEToken()),Nc.action(ib,Lb.rma),Vc&&Vc()}catch(Ld){af.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",ag.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?Ld.stack:Ld.message)),qk.a.TQd(CommonUIStrings.l_InternalError+" "+
CommonUIStrings.l_InternalError_Directive)}};he.prototype.V1f=function(H,ia,ib){var Lb=this;ib=void 0===ib?null:ib;var Nc=H.xB;if(1===Nc.getNotificationParams().length||ia.Jdc){var Vc=ia.yha,Hd=ia.nia;ia.yha=function(){Nc.removeFirstNotification();if(0<Nc.getNotificationParams().length){var Ld=Lb.Xte(Nc.getNotificationParams()[0]);Lb.V1f(H,Ld)}2147758681===ia.errorCode&&(Af.Oeh(H.Ho,Nc,Object(zh.a)(Lb,Lb.y9e,"initUpgradeStateDetectTask")),ne.Geh(H.Hqb,Nc,Object(zh.a)(Lb,Lb.y9e,"initUpgradeStateDetectTask")));
Vc&&Vc()};ia.nia=function(){Hd&&Hd();ib&&ib()};qk.a.VQd(ia)}};he.prototype.y9e=function(H,ia){var ib=null;ib=function(){H.getIsUpgrading()?window.setTimeout(ib,1E3):H.getUpgradingFailed()?Af.Svc(ia,!0):ag.AFrameworkApplication.sa.updateCommandUI()};window.setTimeout(ib,1E3)};he.prototype.Xte=function(H){var ia=new Xj.a;ia.tLa=H.infoType;ia.id=H.id;ia.title=H.title;ia.description=H.description;ia.buttonText=H.buttonTxt;ia.yha=H.buttonCallback;ia.Jdc=H.highPriority;ia.nia=H.dismissCallback;ia.errorCode=
H.errorCode;ia.y8e=H.iframeNotificationUrl;return ia};Ck.Object.defineProperties(he.prototype,{pje:{configurable:!0,enumerable:!0,get:function(){return this.gEc||(this.gEc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},set:function(H){this.gEc=H}},yMg:{configurable:!0,enumerable:!0,get:function(){return this.B1d||(this.B1d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}}});Object(fe.a)(he,"AddinCommandsActionHandler",null,[252]);var rk=b(945),Dj=b(904);
Id.prototype.aFh=function(H){if(void 0!==H&&null!==H&&H===gh.a.cBe)H="ContextMenuCell";else return null;var ia=this.Ta.Pc();this.uEh(ia,H);return ia};Id.prototype.uEh=function(H,ia){ia=this.z1g.ZRh(ia);ia=Gl(ia);for(var ib=ia.next();!ib.done;ib=ia.next()){ib=Gl(ib.value.controls);for(var Lb=ib.next();!Lb.done;Lb=ib.next())this.hEh(H,Lb.value)}};Id.prototype.hEh=function(H,ia){var ib=ia.AU[rk.a.id],Lb=ia.AU[rk.a.mUa],Nc=ia.AU[rk.a.pUa],Vc="Image16by16",Hd=ia.AU[rk.a.nUa];Dj.c(Nc)&&(Vc="None");0<ia.menuItems.count?
(ib=this.Ta.lw(ib,ib,Lb,798637440),ib.iKb(Vc,Nc,null),this.ZEh(ib.menu,ia),H.buttons.push(ib)):H.buttons.push(this.Ta.wHa(ib,Lb,Hd,Nc,Vc,null,!1))};Id.prototype.ZEh=function(H,ia){var ib,Lb=this.Ta.Pc();ia=Gl(ia.menuItems);for(ib=ia.next();!ib.done;ib=ia.next()){var Nc=ib.value;ib=Nc.ula[rk.a.id];var Vc=Nc.ula[rk.a.mUa],Hd=Nc.ula[rk.a.pUa],Ld="Image16by16";Nc=Nc.ula[rk.a.nUa];Dj.c(Hd)&&(Ld="None");ib=this.Ta.wHa(ib,Vc,Nc,Hd,Ld,null,!1);Lb.buttons.push(ib)}H.Ec.push(Lb)};Object(fe.a)(Id,"AddInCommandsContextMenuExtensibilityHandler",
null,[552]);var Jk=b(1068);Object(fe.a)($d,"AddinStatusCommandValues",null,[]);Ke.S0i=function(H){var ia=new $d;ia.Ai=H.HYa;ia.visible=ia.Ai?!0:!1;return ia};Ke.Exc=function(H,ia,ib,Lb,Nc){var Vc=document.getElementById(ib);Vc?Ke.Ayj(H,ia,Vc,Lb,Nc):af.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",ib))};Ke.Ayj=function(H,ia,ib,Lb,Nc){ib?H.HYa===CommonUIStrings.l_ErrorLoadingAddInsTitle?qk.a.nxj(ia,ib,Lb,Nc):H.HYa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&
qk.a.Fyj(ia,ib):af.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))};Object(fe.a)(Ke,"AddinCommandsStatusHandler",null,[]);var zk=b(38),Pk=b(232),cl=zk.a;Wl(Fe,cl);Fe.prototype.yq=function(H){this.addHandler("LAC",H)};Fe.prototype.Wq=function(H){this.removeHandler("LAC",H)};Fe.prototype.Xr=function(H,ia){var ib=this;if("QueryAddinLabel"!==H)return!1;ia[Jk.a.LabelText]!==this.QF.HYa&&(H=Ke.S0i(this.QF),ia[Jk.a.LabelText]=H.Ai,ia[Jk.a.Visible]=H.visible,
window.setTimeout(function(){ib.Exc()},0));return!0};Fe.prototype.sn=function(){return!0};Fe.prototype.Exc=function(){this.$&&Ke.Exc(this.QF,this.$.domElement,this.xDj,K.a.instance.ga(337),K.a.instance.ga(338))};Fe.prototype.dispose=function(){this.$.ea.Dk(this.od);this.QF.D9i(this.f4e);this.agaveCommandManager&&(this.agaveCommandManager.R$i(this.dye),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.HF(this),this.statusBarManager=null);this.QF=this.$=null;cl.prototype.dispose.call(this)};
Object(fe.a)(Fe,"AddinCommandsStatusBarManager",zk.a,[457,177]);var Wk=b(1363),Ug=b(933),nj=b(124),tl=b(142);Cf.prototype.setErrorMessageForAddin=function(H,ia){this.GYa||(this.GYa={});this.GYa[H]=ia};Cf.prototype.JMh=function(H){return this.GYa&&H in this.GYa?this.GYa[H]:null};Object(fe.a)(Cf,"AddinCommandsErrorManager",null,[]);var Ti=b(345),Qk=b(97);Object(fe.a)(qf,"AddinCommandsListLoaderContext",null,[]);var ik=b(1023);Object(fe.a)(lf,"AppsForOfficeEntitlementQueryInfo",null,[]);var hl=b(80),
il=b(891);Nd.prototype.get_current=function(){if(!this.Kr)throw Error.argumentOutOfRange();return this.Kr.data};Nd.prototype.moveNext=function(){if(!this.Kr)return this.Kr=this.oA,!!this.oA;if(!this.Kr.next)return!1;this.Kr=this.Kr.next;return!0};Nd.prototype.plc=function(){if(!this.Kr)return this.Kr=this.oA,!!this.oA;if(!this.Kr.previous)return!1;this.Kr=this.Kr.previous;return!0};Nd.prototype.reset=function(){this.Kr=this.oA};Object(fe.a)(Nd,"ListEnumerator",null,[0]);Object(fe.a)(ed,"ListNode",
null,[]);wc.prototype.add=function(H){this.oq?this.wA=this.wA.next=new ed(H,this.wA,null):this.oq=this.wA=new ed(H,null,null);this._count=this.count+1};wc.prototype.insert=function(H,ia){if(H>this.count||0>H)throw Error.argumentOutOfRange("pos");if(H===this.count)this.add(ia);else{for(var ib=this.oq;0!==H--;)ib=ib.next;H=new ed(ia,ib.previous,ib);H.previous?H.previous.next=H:this.oq=H;H.next?H.next.previous=H:this.wA=H;this._count=this.count+1}};wc.prototype.remove=function(H){for(var ia=this.oq;ia&&
ia.data!==H;)ia=ia.next;if(!ia)return!1;ia.previous?ia.previous.next=ia.next:this.oq=ia.next;ia.next?ia.next.previous=ia.previous:this.wA=ia.previous;this._count=this.count-1;return!0};wc.prototype.clear=function(){var H=this.oq;for(this.wA=this.oq=null;H;){var ia=H.next;H.previous=null;H.next=null;H=ia}this._count=0};wc.prototype.indexOf=function(H){for(var ia=this.oq,ib=0;ia&&ia.data!==H;)ia=ia.next,ib++;return ia?ib:-1};wc.prototype.oa=function(H){return this.at(H).data};wc.prototype.getEnumerator=
function(){return new Nd(this.oq)};wc.prototype[Symbol.iterator]=function(){return Object(il.a)(this.getEnumerator())};wc.prototype.Mac=function(H){H=this.at(H);return new Nd(H)};wc.prototype.toArray=function(){for(var H=Array(this.count),ia=0,ib=Gl(this),Lb=ib.next();!Lb.done;Lb=ib.next())H[ia]=Lb.value,ia++;return H};wc.prototype.at=function(H){for(var ia=this.oq,ib=0;ib!==H;){if(!ia)throw Error.argumentOutOfRange("pos");ia=ia.next;ib++}return ia};Ck.Object.defineProperties(wc.prototype,{count:{configurable:!0,
enumerable:!0,get:function(){return this._count}}});Object(fe.a)(wc,"List",null,[1]);var jl=Sys.EventArgs;Wl(md,jl);Object(fe.a)(md,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);Mc.prototype.M9c=function(H){var ia=new Sys.StringBuilder(this.OIb);ia.append("RoamingServiceHandler.ashx?action=");ia.append("getAddinTeachingCalloutSettings");ia.append("&");ia.append(this.xfd(H));ia.append("&");ia.append(ag.AFrameworkApplication.nj);ag.AFrameworkApplication.Jd.gm(ia.toString(),1,null,
null,!0,2,Object(zh.a)(this,this.nKa,"getRequestSuccessCallback"),Object(zh.a)(this,this.Cja,"getRequestFailureCallback"),null)};Mc.prototype.qtb=function(H){var ia=new Sys.StringBuilder(this.OIb);ia.append("RoamingServiceHandler.ashx?action=");ia.append("saveAddinTeachingCalloutSettings");ia.append("&");ia.append(ag.AFrameworkApplication.nj);ia=ia.toString();H=pa.c(H);ag.AFrameworkApplication.Jd.gm(ia,2,H,null,!0,4,null,Object(zh.a)(this,this.K6,"postRequestFailureCallback"),null)};Mc.prototype.nKa=
function(H){var ia=!1,ib=null;try{if(0<H.data.ke.length){var Lb=Object(lj.a)(Object,pa.a(H.data.ke)),Nc=Lb?Lb[this.appName]:null;Nc&&(ib=Object(lj.a)(Object,pa.a(Nc.toString())))}ia=!0}catch(Vc){this.Cja(null)}ia&&this.zib&&this.zib(ib)};Mc.prototype.Cja=function(H){this.vib&&this.vib(H?H.data:null)};Mc.prototype.K6=function(H){this.Fkb&&this.Fkb(H?H.data:null)};Mc.prototype.xfd=function(H){for(var ia=new Sys.StringBuilder("requestedsettings="),ib=0;ib<H.count;ib++)ia.append(H.oa(ib)),ib<H.count-
1&&ia.append(";");return ia.toString()};Object(fe.a)(Mc,"AddinTeachingUIRoamingRequestHandler",null,[]);Object(fe.a)(Sb,"MiniAddinInfo",null,[]);var oj=Sys.EventArgs;Wl(Cd,oj);Object(fe.a)(Cd,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);Xc.prototype.bDg=function(H){this.Pa.addHandler(Ug.a.LZb,H)};Xc.prototype.xGg=function(H){this.Pa.addHandler(Ug.a.ZQd,H)};Xc.prototype.XLj=function(H){var ia=this;null!==H&&(this.context.c0=H[Ug.a.Vga],this.context.pt=H[Ug.a.ZT],this.context.kAc=
this.context.Eqc=0,H=Ug.a.LFa in H?H[Ug.a.LFa]:0,-1!==this.context.c0&&0!==this.context.pt&&(this.context.O9=new wc,this.context.eja=new wc,this.context.C3b=new wc,this.context.xVc=this.aHg.createAddinDataProvider(Ec(this.context.c0),this.contextActivationMgr),this.context.xVc?this.context.xVc.getEntitlementsAsync(this.contextActivationMgr.rma,!0,H,function(ib){ia.AMi(ib)}):af.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.c0)))};Xc.prototype.AMi=function(H){var ia=
this;if(H&&0<H.length){this.context.kAc=H.length;for(var ib=0;ib<H.length;ib++){var Lb=H[ib];if(!Lb||1!==Lb.targetType&&-1!==Lb.targetType)this.Byd();else{var Nc={};Nc.marketplaceId=Lb.solutionId;Nc.marketplaceVersion=Lb.version;Nc.storeType=Lb.storeType;Nc.storeId=Lb.storeId;Nc.targetData=Lb;this.contextActivationMgr.isAddinCommandsAsync(Nc,function(Vc,Hd,Ld){Vc?(Hd&&ia.context.O9.add(Ld.targetData),10===ia.context.c0&&(Vc=Ld.targetData,Hd=Vc.targetType,ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PropertiesForTeachingUIOfPrivateCatelogEnabled",
!1)&&!Dj.c(Ld.targetTypeForExp)&&(Hd=Ld.targetTypeForExp,Vc.targetType=Hd),ia.context.eja.add(Vc),0===Hd&&ia.context.C3b.add(Vc))):(Ld=Ld.targetData,af.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ld.solutionId,Ld.storeType,Ld.assetId,null,null,Ld.storeId),Ld.storeType));ia.Byd()})}}}else this.Byd()};Xc.prototype.Byd=function(){var H;(H=this.context).Eqc=H.Eqc+1;this.context.Eqc>=this.context.kAc&&(this.KZb.gXf(this.context.c0,
!1),0<this.context.kAc&&10===this.context.c0&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(H=!1,ag.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&wb()&&(H=this.Usi()),this.hsi(),ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!H?this.MGh(this.context.O9):this.HYb(this.context.O9)):this.HYb(this.context.O9))};Xc.prototype.HYb=function(H){var ia=
new Kg.a;if(H){H=Gl(this.context.O9);for(var ib=H.next();!ib.done;ib=H.next())ia.add(rd(ib.value))}this.context.O9&&1>this.context.O9.count&&ik.a.ANb(Ug.a.MZb,"false",this.context.c0);H={};ia=(H.ack2=ia,H);ia[Ug.a.Vga]=this.context.c0;ia[Ug.a.ZT]=this.context.pt;this.Pa.raiseEvent(Ug.a.LZb,new md(ia),this)};Xc.prototype.JQa=function(H){if(this.appName){var ia={},ib={};ib.LastTeachingUIShowTime=(new Date).toUTCString();ib.AddinHasShown=H;ia[this.appName]=pa.c(ib);this.opa&&(this.opa.qtb(ia),af.ULS.sendTraceTag(539530527,
306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else af.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")};Xc.prototype.MGh=function(H){if(this.KFa=H)H=new Kg.a,H.add(this.appName),this.opa=new Mc(this.appName,Object(zh.a)(this,this.nKa,"getRequestSuccessCallback"),Object(zh.a)(this,this.Cja,"getRequestFailureCallback"),Object(zh.a)(this,this.K6,"postRequestFailureCallback")),this.opa.M9c(H);else{H=
new Kg.a;var ia={};H=(ia.ack2=H,ia);H[Ug.a.Vga]=this.context.c0;H[Ug.a.ZT]=this.context.pt;this.Pa.raiseEvent(Ug.a.LZb,new md(H),this)}};Xc.prototype.nKa=function(H){H?this.lwj(H)?(af.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.Rza="AddinHasShown"in H&&H.AddinHasShown?H.AddinHasShown.toString():null,this.rAe()):(af.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.HYb(this.KFa)):(af.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.Rza=null,
this.rAe())};Xc.prototype.Cja=function(H){af.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",H?H.httpStatus:-1);this.HYb(this.KFa)};Xc.prototype.K6=function(H){af.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",H?H.httpStatus:-1)};Xc.prototype.rAe=function(){var H=this.Bdh();if(0===H.targetType){Xc.jSa?H.solutionId?(this.ySd=H.solutionId,this.Kyc=H.storeId,this.ZIf()):this.ktd("NoSolutionId"):
H.assetId?(this.SWc=H.assetId,this.Kyc=H.storeId,this.ZIf()):this.ktd("NoAssetId");if(H.addinId){var ia=this.Rza?this.Rza+","+H.addinId:H.addinId;ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=ia:this.JQa(ia)}this.$ke(null)}else this.$ke(H.addinId);af.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",H.addinId)};Xc.prototype.ZIf=function(){var H=this,ia=new lf;ia.callbackFunc=function(ib){if(ib.errorCode)H.ktd("FailToGetAppDetails"),
ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&(ib=window.g_roamingAddinList)&&H.JQa(ib);else if(ib.value){var Lb=Gl(ib.value);for(ib=Lb.next();!ib.done;ib=Lb.next())if(ib=ib.value,Xc.jSa){var Nc=ib[1];if(Nc===H.ySd){Lb={solutionId:Nc};Lb.assetId=ib[5];Lb.storeType=ib[6];ag.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?Lb.storeId=H.Kyc:Lb.storeId=ib[11];Lb.assetStoreId=ib[6];Lb.targetType=ib[3];Lb.width=ib[7];Lb.height=
ib[8];Lb.displayName=ib[0];Lb.version=ib[4];ib=new Cd(Lb);H.Pa.raiseEvent(Ug.a.ZQd,ib);break}}else if(Nc=ib[1],Nc===H.SWc){Lb={solutionId:Nc,assetId:Nc};Lb.storeType=ib[6];ag.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?Lb.storeId=H.Kyc:Lb.storeId=ib[11];Lb.assetStoreId=ib[6];Lb.targetType=ib[3];Lb.width=ib[7];Lb.height=ib[8];Lb.displayName=ib[0];Lb.version=ib[4];ib=new Cd(Lb);H.Pa.raiseEvent(Ug.a.ZQd,ib);break}}};ia.storeType=OSF.StoreTypeEnum.PrivateCatalog;ia.fromInsertDialog=
!1;ia.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(ia)};Xc.prototype.lwj=function(H){if("LastTeachingUIShowTime"in H){if(H=+new Date-+new Date(H.LastTeachingUIShowTime.toString()),H<ag.AFrameworkApplication.fa.vV("AddinShowTeachingUIIntervalInMS",864E5))return af.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",H),!1}else af.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0};Xc.prototype.Bdh=function(){var H=
new Ti.a(new Sb,0),ia=new Ti.a(new Sb,0),ib=0,Lb=0,Nc=0,Vc=new wc;if(0<this.context.O9.count)for(var Hd=Gl(this.context.O9),Ld=Hd.next();!Ld.done;Ld=Hd.next())Vc.add(Ld.value);if(0<this.context.C3b.count)for(Hd=Gl(this.context.C3b),Ld=Hd.next();!Ld.done;Ld=Hd.next())Vc.add(Ld.value);Vc=Gl(Vc);for(Ld=Vc.next();!Ld.done;Ld=Vc.next())if(Ld=Ld.value,!("excatalog"!==Ld.storeType||Dj.c(Ld.installTimeInMS)||!Ld.installTimeInMS||Ld.installTimeInMS<=ag.AFrameworkApplication.fa.vV("DateTimeInMSForNewAddin",
16409664E5))){Hd=Xc.JVe(Ld);if(this.Rza){var Be=this.Rza.split(",");if(0<Be.length&&Array.contains(Be,Hd)){Nc++;af.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}}Hd.startsWith("private_")?(H.value<Ld.installTimeInMS&&(H=Xc.jSa?new Ti.a(Object.assign(new Sb,{addinId:Hd,targetType:Ld.targetType,storeId:Ld.storeId,solutionId:Ld.solutionId}),Ld.installTimeInMS):new Ti.a(Object.assign(new Sb,{addinId:Hd,targetType:Ld.targetType,storeId:Ld.storeId,assetId:Ld.assetId}),
Ld.installTimeInMS)),Lb++):(ia.value<Ld.installTimeInMS&&(ia=Xc.jSa?new Ti.a(Object.assign(new Sb,{addinId:Hd,targetType:Ld.targetType,storeId:Ld.storeId,solutionId:Ld.solutionId}),Ld.installTimeInMS):new Ti.a(Object.assign(new Sb,{addinId:Hd,targetType:Ld.targetType,storeId:Ld.storeId,assetId:Ld.assetId}),Ld.installTimeInMS)),ib++)}af.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",Lb,ib,Nc);return 0<ia.value?ia.key:
0<H.value?H.key:Object.assign(new Sb,{addinId:null,targetType:-1,solutionId:null,storeId:null,assetId:null})};Xc.prototype.$ke=function(H){for(var ia=new Kg.a,ib=Gl(this.KFa),Lb=ib.next();!Lb.done;Lb=ib.next()){var Nc=Lb.value;Lb=rd(Nc);H&&(Nc=Xc.JVe(Nc),H===Nc&&(Lb.showCallout=!0,Nc=this.Rza?this.Rza+","+H:H,ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=Nc:this.JQa(Nc)));ia.add(Lb)}this.KFa&&1>this.KFa.count&&
ik.a.ANb(Ug.a.MZb,"false",this.context.c0);H={};ia=(H.ack2=ia,H);ia[Ug.a.Vga]=this.context.c0;ia[Ug.a.ZT]=this.context.pt;this.Pa.raiseEvent(Ug.a.LZb,new md(ia),this)};Xc.prototype.Usi=function(){var H=!1;if(this.context.eja&&1>this.context.eja.count)return H;var ia=Dd();if(!ia)return H;for(var ib=Gl(this.context.eja),Lb=ib.next();!Lb.done;Lb=ib.next())if(Lb=Lb.value,Lb.storeId&&Lb.storeId.toLowerCase()===ia.toLowerCase()||Lb.assetId&&Lb.assetId.toLowerCase()===ia.toLowerCase()){H=Xc.iKa(Lb);var Nc=
{};Lb=(Nc.SDX_Id=H,Nc.SDX_TargetType=Dj.c(Lb.targetType)?"":Lb.targetType.toString(),Nc);Db.a.sendTelemetryEvent(Object.assign(new Td.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:nj.a.sl(Lb)}));H=!0}return H};Xc.prototype.hsi=function(){if(!(this.context.eja&&1>this.context.eja.count))if(this.KZb.dii()){var H=this.KZb.nTh();H?(H=this.xXe(this.context.eja,H),af.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(H=this.xXe(this.context.eja,null),af.ULS.sendTraceTag(527523847,
306,50,"no data from cache"));this.KZb.kqj(H)}else af.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")};Xc.prototype.xXe=function(H,ia){var ib={},Lb=!1;H=Gl(H);for(var Nc=H.next();!Nc.done;Nc=H.next()){Nc=Nc.value;var Vc=Xc.iKa(Nc);Vc&&(!ia||Vc in ia||(this.Bxa(Nc,Vc),af.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===Vc.toLowerCase()?Lb||(Lb=!0,ib[Vc]=null):ib[Vc]=null)}return ib};Xc.prototype.Bxa=function(H,ia){var ib=H.installTimeInMS?(new Date(H.installTimeInMS)).toISOString():
"",Lb={};ib=(Lb["SDX.Id"]=ia,Lb["SDX.AppInstallOrigin"]="Organization",Lb["SDX.TargetType"]=Dj.c(H.targetType)?"":H.targetType.toString(),Lb["SDX.AdminDeploymentTime"]=ib,Lb);Db.a.sendTelemetryEvent(Object.assign(new Td.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:nj.a.sl(ib)}));1===H.targetType&&(H={},ia=(H["SDX.Id"]=ia,H["SDX.AppInstallOrigin"]="Organization",H["SDX.CommandPlacement"]="Ribbon",H),Db.a.sendTelemetryEvent(Object.assign(new Td.a,{name:"Office.Extensibility.Host.AppPinning",
dataFields:nj.a.sl(ia)})))};Xc.prototype.ktd=function(H){var ia={};H=(ia.AppTeachingUICalloutAction=H,ia["SDX.Id"]=Xc.jSa?this.ySd:this.SWc,ia.AppTeachingUICalloutGoal="NewAdminDeployment",ia["SDX.AppInstallOrigin"]="Organization",ia);Db.a.sendTelemetryEvent(Object.assign(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(H)}))};Xc.iKa=function(H){return Xc.jSa?Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.storeType,H.assetId,null,null,H.storeId):Telemetry.PrivacyRules.GetAssetId(H.storeType,
H.storeId,H.assetId)};Xc.JVe=function(H){if(Xc.jSa){var ia=H.solutionId;var ib=Telemetry.PrivacyRules.IsPrivateAddin(H.storeType,H.assetId,null,null,H.storeId)}else ia=H.assetId,ib=Telemetry.PrivacyRules.IsPrivateAddin(H.storeType,H.storeId,H.assetId);return ib?"private_"+H.installTimeInMS:ia};Ck.Object.defineProperties(Xc,{jSa:{configurable:!0,enumerable:!0,get:function(){return ag.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6189484_TeachingCalloutSolutionIdRefactorEnabled")}}});Object(fe.a)(Xc,
"AddInCommandsListLoader",null,[]);Md.prototype.insertOsfControl=function(H){return this.rma.insertOsfControl(H)};Md.prototype.getManifestInvaildErrorString=function(){return this.rma.getManifestInvaildErrorString()};Md.prototype.isAddinCommandsAsync=function(H,ia){this.rma.isAddinCommandsAsync(H,ia)};Md.prototype.ownerAddinControlRecreated=function(H,ia){this.rma.ownerAddinControlRecreated(H,ia)};Md.prototype.queryEntitlementDetails=function(H){this.rma.queryEntitlementDetails(H)};Ck.Object.defineProperties(Md.prototype,
{rma:{configurable:!0,enumerable:!0,get:function(){return this.Jsg}}});Object(fe.a)(Md,"ContextActivationMgrWrapper",null,[243]);Tc.prototype.createAddinDataProvider=function(H,ia){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(H,ia.rma)};Ck.Object.defineProperties(Tc,{instance:{configurable:!0,enumerable:!0,get:function(){Tc.Ma||(Tc.Ma=new Tc);return Tc.Ma}}});Tc.Ma=null;Object(fe.a)(Tc,"OSFAddinDataProviderFactory",null,[245]);Object(fe.a)(Hc,"CacheItem",null,[]);gc.prototype.ul=
function(H){var ia=this.RDa.getItem(H);if(ia){var ib=new Hc;try{ib=Sys.Serialization.JavaScriptSerializer.deserialize(ia,!0)}catch(Lb){return this.RDa.removeItem(H),null}return ib.Data?ib.Data:ib.data}return null};gc.prototype.ZPa=function(H){this.RDa.removeItem(H)};Object(fe.a)(gc,"AppsDataCacheManager",null,[277]);var Fk=b(1024);Jd.prototype.gXf=function(H,ia){H=Ug.a.AYe()+H;Fk.a.instance.setItem(H,ia.toString())};Jd.prototype.nTh=function(){var H=Ug.a.y0e();af.ULS.sendTraceTag(527523850,306,50,
"set cache key:{0}",H);H=Fk.a.instance.getItem(H);return pa.a(H)};Jd.prototype.kqj=function(H){var ia=Ug.a.y0e();af.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",ia);Fk.a.instance.setItem(ia,pa.c(H))};Jd.prototype.dii=function(){return!!Fk.a.instance.localStorage};Ck.Object.defineProperties(Jd,{instance:{configurable:!0,enumerable:!0,get:function(){Jd.Ma||(Jd.Ma=new Jd);return Jd.Ma}}});Jd.Ma=null;Object(fe.a)(Jd,"AddInCommandsCacheManager",null,[240]);var Kk=Sys.EventArgs;Wl(zd,Kk);Object(fe.a)(zd,
"InsertionParamEventArgs",Sys.EventArgs,[]);Object(fe.a)(Qd,"PostLaunchAddinCommandsParameters",null,[]);bd.prototype.sAg=function(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(zh.a)(this,this.pMi,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(zh.a)(this,this.EHi,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(zh.a)(this,this.iGi,"onCloseButtonClickedEventHandler"),!0),ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&window.addEventListener("FGWebSurfaceEvent",Object(zh.a)(this,this.Ltf,"onCampaignLaunchedHandler"),!0)):af.ULS.sendTraceTag(525112601,306,15,"AddEventListenerForTeachingCallout failed to get Window")};bd.prototype.pMi=function(){var H=this,ia={};ia=(ia.AppTeachingUICalloutAction="ClickOnLaunch",ia["SDX.Id"]=bd.iKa(this.Sib),ia.AppTeachingUICalloutGoal="NewAdminDeployment",ia["SDX.AppInstallOrigin"]="Organization",ia);this.kgb&&this.kgb.tabs&&!this.kgb.tabs[0].isOfficeTab&&(ia["SDX.FeatureFlags"]=
"NonOfficeTab");Db.a.sendTelemetryEvent(Object.assign(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(ia)}));ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Gkc();this.kgb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.kgb,function(){var ib=new zd;ib.Mm=H.Sib;H.Za.raiseEvent(Ug.a.ijf,ib)}):af.ULS.sendTraceTag(525112602,306,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};
bd.prototype.iGi=function(){var H={};H=(H.AppTeachingUICalloutAction="ClickOnClose",H["SDX.Id"]=bd.iKa(this.Sib),H.AppTeachingUICalloutGoal="NewAdminDeployment",H["SDX.AppInstallOrigin"]="Organization",H);Db.a.sendTelemetryEvent(Object.assign(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(H)}));ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Gkc()};bd.prototype.EHi=function(){var H={};H=(H.AppTeachingUICalloutAction=
"ClickOnDismiss",H["SDX.Id"]=bd.iKa(this.Sib),H.AppTeachingUICalloutGoal="NewAdminDeployment",H["SDX.AppInstallOrigin"]="Organization",H);Db.a.sendTelemetryEvent(Object.assign(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(H)}));ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.Gkc()};bd.prototype.Ltf=function(H){if(H&&(H=H.detail)&&H.id&&this.Udi(H.id)){var ia=(H.action||"").toLowerCase();if(H.success&&
"opened"===ia){var ib={};ib=(ib.AppTeachingUICalloutAction="CampaignLaunched",ib["SDX.Id"]=bd.iKa(this.Sib),ib.AppTeachingUICalloutGoal="NewAdminDeployment",ib["SDX.AppInstallOrigin"]="Organization",ib);Db.a.sendTelemetryEvent(Object.assign(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(ib)}));af.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.Gkc();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(zh.a)(this,this.Ltf,"onCampaignLaunchedHandler"),!0)}else try{ib=JSON.stringify(H),af.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+ib)}catch(Lb){ib="id : "+H.id+" telemetryEventName: "+H.telemetryEventName,af.ULS.sendTraceTag(523321996,306,50,"Error serializing campaign event. "+ib+" Error: "+(Lb?Lb.toString():""))}}};bd.prototype.Udi=function(H){H=Bj.a.Al(H);return-1!==H.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==H.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||
-1!==H.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==H.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==H.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==H.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")};bd.prototype.JQa=function(H){var ia=ag.AFrameworkApplication.fa.Va("WebAppShortName");if(ia){var ib={},Lb={};Lb.LastTeachingUIShowTime=(new Date).toUTCString();Lb.AddinHasShown=H;ib[ia]=pa.c(Lb);this.opa=new Mc(ia,null,null,Object(zh.a)(this,this.K6,"postRequestFailureCallback")),
this.opa.qtb(ib),af.ULS.sendTraceTag(523535564,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else af.ULS.sendTraceTag(523535565,306,10,"Fail to save roaming service since AppName is null")};bd.prototype.Gkc=function(){if(!this.Ytc){var H=window.g_roamingAddinList;H&&(this.JQa(H),this.Ytc=!0)}};bd.prototype.K6=function(H){af.ULS.sendTraceTag(523535566,306,10,"failed to POST data to Roaming Settings Service with status: {0}",H?H.httpStatus:
-1)};bd.iKa=function(H){return ag.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6189484_TeachingCalloutSolutionIdRefactorEnabled")?Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.storeType,H.assetId,null,null,H.storeId):Telemetry.PrivacyRules.GetAssetId(H.storeType,H.storeId,H.assetId)};Object(fe.a)(bd,"PrivateCatalogTeachingCalloutHandler",null,[]);xb.prototype.nYa=function(H,ia){this.L7d.nYa(H,void 0===ia?null:ia);this.R9d=H};xb.prototype.jId=function(H){this.L7d.jId(H)};Ck.Object.defineProperties(xb.prototype,
{VMa:{configurable:!0,enumerable:!0,get:function(){return this.R9d}}});Object(fe.a)(xb,"RibbonExtensibilityManagerWithChangeDetection",null,[276]);var Rk=b(1072);kd.jZe=function(H){var ia=new Kg.a;if(kd.fAe)for(var ib=Gl(kd.fAe),Lb=ib.next();!Lb.done;Lb=ib.next())ia.add(Lb.value);Lb=null;switch(H){case "Workbook":Lb=kd.MVj;break;case "Document":Lb=kd.ygh;break;case "Presentation":Lb=kd.EZi}if(Lb)for(H=Gl(Lb),Lb=H.next();!Lb.done;Lb=H.next())ia.add(Lb.value);return ia};kd.fAe=["PrimaryCommandSurface",
"ContextMenu"];kd.MVj=null;kd.ygh=null;kd.EZi=null;Object(fe.a)(kd,"ExtensionPointType",null,[]);Ck.Object.defineProperties(Qc.prototype,{ADb:{configurable:!0,enumerable:!0,get:function(){return this.Obe||(this.Obe=new Kg.a)}},voe:{configurable:!0,enumerable:!0,get:function(){return this.Gjg}}});Object(fe.a)(Qc,"ContextMenuExtensibility",null,[248]);Ck.Object.defineProperties(Ub.prototype,{pW:{configurable:!0,enumerable:!0,get:function(){return this.Csg}},startedNode:{configurable:!0,enumerable:!0,
get:function(){return this.Zvg}},XFh:{configurable:!0,enumerable:!0,get:function(){return this.jog}}});Object(fe.a)(Ub,"RibbonExtensibility",null,[323]);Zb.prototype.createActionContext=function(H,ia){H={};H.ownerAddinInfo=this.entitlement;H.action=ia;return H};Ck.Object.defineProperties(Zb.prototype,{entitlement:{configurable:!0,enumerable:!0,get:function(){return this.hng}}});Object(fe.a)(Zb,"AddInCommandsContextProvider",null,[]);jb.prototype.R4g=function(H){return new Zb(H)};jb.prototype.createActionBuilder=
function(H,ia){return OfficeExt.DefaultControlActionBinder.createActionBuilder(H,ia.entitlement,ia.manifest)};jb.prototype.startApplyAddin=function(H){this.W0d=H;var ia=this.R4g(H);this.actionBuilder=this.createActionBuilder(ia,H)};jb.prototype.endApplyAddin=function(){};jb.prototype.Xbd=function(H,ia,ib){ib=void 0===ib?0:ib;return this.ribbonBuilder.Ps&&0<this.ribbonBuilder.Ps.count?new Ub(this.lFh(H,ia),this.Sne.startedNode,ib):null};jb.prototype.YUe=function(){var H=void 0===H?null:H;if(this.contextMenuBuilder.Xkc&&
0<this.contextMenuBuilder.Xkc.count){H||(H=this.Sne.entitlement.solutionId);H=new Qc(H);for(var ia=Gl(this.contextMenuBuilder.Xkc),ib=ia.next();!ib.done;ib=ia.next())H.ADb.add(ib.value);return H}return null};jb.prototype.lFh=function(H,ia){return this.ribbonBuilder.Ps&&0<this.ribbonBuilder.Ps.count?new Ek.a(this.ribbonBuilder.Ps,H,ia):null};Ck.Object.defineProperties(jb.prototype,{Sne:{configurable:!0,enumerable:!0,get:function(){return this.W0d}}});Object(fe.a)(jb,"AddinCommandsBuilder",null,[]);
ma.prototype.oBb=function(H,ia,ib,Lb,Nc,Vc,Hd){function Ld(dh,th,Ki,xh){Nc(dh,th,Ki,xh);dh=Rk.a[Be.pt]+th.assetId;Ki=Be.xSa.Nc(dh);th=Ki.value;Ki.returnValue&&(th.stop(),Be.xSa.remove(dh))}var Be=this;if(0!==this.pt&&H)for(af.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",H.count),4===this.pt&&(af.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",Lb)),this.fXg(H,Lb),Vc()),H=Gl(H),Lb=H.next();!Lb.done;Lb=H.next())if(Lb=Lb.value,af.ULS.sendTraceTag(17638144,
220,50,String.format("{0}: Install addin {1}",this.Po.QM,Telemetry.PrivacyRules.GetPrivacyCompliantId(Lb.solutionId,Lb.ownerAddinStoreType||Lb.storeType,Lb.assetId,null,null,Lb.storeId))),this.seg(Lb))if(Hd&&Lb.requireConsent)Hd(Lb,function(dh){try{if(Be.AO){var th=Rk.a[Be.pt]+dh.solutionId,Ki=Be.AO.Gc("ComponentAttach",th);Be.xSa.ia(th,Ki)}var xh=Be.QF.Ria(dh.storeType,dh.solutionId);6!==Be.pt&&(xh&&(Be.k2b(xh),xh.xB.purge(!1)),Be.Ei.insertOsfControl(Be.iGb(dh,ia,ib,Ld)),xh&&Be.Ei.ownerAddinControlRecreated(dh.solutionId,
dh.storeType))}catch(ui){af.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",Be.Po.QM,Telemetry.PrivacyRules.GetPrivacyCompliantId(dh.solutionId,dh.ownerAddinStoreType||dh.storeType,dh.assetId,null,null,dh.storeId),dh.version,dh.storeType,dh.storeId,ui.message)),Ld(!1,dh,null,null)}});else try{if(this.AO){var df=Rk.a[this.pt]+Lb.solutionId,uf=this.AO.Gc("ComponentAttach",df);this.xSa.ia(df,
uf)}var og=this.QF.Ria(Lb.storeType,Lb.solutionId);6!==this.pt&&(og&&(this.k2b(og),og.xB.purge(!1)),this.Ei.insertOsfControl(this.iGb(Lb,ia,ib,Ld)),og&&this.Ei.ownerAddinControlRecreated(Lb.solutionId,Lb.storeType))}catch(dh){af.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Po.QM,Telemetry.PrivacyRules.GetPrivacyCompliantId(Lb.solutionId,Lb.ownerAddinStoreType||Lb.storeType,Lb.assetId,
null,null,Lb.storeId),Lb.version,Lb.storeType,Lb.storeId,dh.message)),Ld(!1,Lb,null,null)}else Ld(!1,Lb,null,null)};ma.prototype.ypi=function(H,ia,ib,Lb,Nc,Vc){function Hd(og,dh,th,Ki){Vc(og,dh,th,Ki);og=Rk.a[Ld.pt]+dh.solutionId;th=Ld.xSa.Nc(og);dh=th.value;th.returnValue&&(dh.stop(),Ld.xSa.remove(og))}var Ld=this;if(6===this.pt&&H)if(af.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.Po.QM,Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.ownerAddinStoreType||
H.storeType,H.assetId,null,null,H.storeId))),this.seg(H))try{if(this.AO){var Be=Rk.a[this.pt]+H.solutionId,df=this.AO.Gc("ComponentAttach",Be);this.xSa.ia(Be,df)}var uf=this.QF.Ria(H.storeType,H.solutionId);uf||Hd(!1,H,null,null);ag.AFrameworkApplication.sa&&ag.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?this.vVe(H,ia,Lb,Nc,ib,function(og){Hd(og,H,ib,uf.displayName)}):(this.vVe(H,ia,Lb,Nc,ib),Hd(!0,H,ib,uf.displayName))}catch(og){af.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.Po.QM,Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.ownerAddinStoreType||H.storeType,H.assetId,null,null,H.storeId),H.version,H.storeType,H.storeId,og.message)),Hd(!1,H,null,null)}else Hd(!1,H,null,null)};ma.prototype.rEi=function(H,ia,ib,Lb,Nc,Vc){if(Vc)if(Vc._isAddinCommandsManifest(this.Po.QM))try{ag.AFrameworkApplication.sa&&ag.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?this.uVe(H,ia,ib,Nc,Vc,function(Hd){Lb(Hd,H,Vc,Vc.getDefaultDisplayName())}):(this.uVe(H,ia,ib,
Nc,Vc),Lb(!0,H,Vc,Vc.getDefaultDisplayName()))}catch(Hd){af.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.Po.QM,Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.ownerAddinStoreType||H.storeType,H.assetId,null,null,H.storeId),H.version,H.storeType,H.storeId,Hd.message)),Lb(!1,H,Vc,Vc.getDefaultDisplayName())}else af.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.Po.QM,Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.ownerAddinStoreType||H.storeType,H.assetId,null,null,H.storeId),H.version,H.storeType,H.storeId)),Lb(!1,H,null,null);else af.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Po.QM,Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.ownerAddinStoreType||H.storeType,H.assetId,null,null,H.storeId),H.version,H.storeType,H.storeId)),
Lb(!1,H,null,null)};ma.prototype.iGb=function(H,ia,ib,Lb){var Nc=this,Vc={},Hd=document.createElement("div");Hd.setAttribute("visible","false");Vc.div=Hd;Vc.id=H.solutionId;Vc.solutionId=H.solutionId;Vc.version=H.version;Vc.storeType=H.storeType;Vc.storeId=H.storeId;Vc.assetId=H.assetId;Vc.assetStoreId=H.assetStoreId;Vc.isvirtualOsfControl=!0;Vc.virtualOsfControlActivationCallback=function(Ld,Be){var df=Nc.QF.Ria(H.storeType,H.solutionId);df&&(df.isUpgraded&&(H.isUpgraded=!0),Nc.k2b(df));Nc.rEi(H,
ia,ib,Lb,Ld,Be)};Vc.reason=3===this.pt?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Vc};ma.prototype.uVe=function(H,ia,ib,Lb,Nc,Vc){Vc=void 0===Vc?null:Vc;var Hd={};Hd.solutionId=Lb.getSolutionId();Hd.version=Lb.getVersion();Hd.storeType=Lb.getStoreType();Hd.storeId=Lb.getStoreId();Hd.assetId=Lb.getSolutionId();Hd.assetStoreId=Lb.getAssetStoreId();Hd.targetType=Lb.getOsfControlType();var Ld=null,Be=null;if(ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))Ld=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Po.QM,this.Po.formFactor)).parseExtensions(Hd,Nc,this.Uga),Be=kd.jZe(this.Po.QM);else try{Ld=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Po.QM,this.Po.formFactor)).parseExtensions(Hd,Nc,this.Uga),Be=kd.jZe(this.Po.QM)}catch(pj){throw af.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+pj.message),pj;}if(Be&&0<Be.count){if(ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var df=ia(H);var uf=ib(H);ib=!!ag.AFrameworkApplication.fa&&ag.AFrameworkApplication.fa.ra("AddinCommandsMultipleCustomTabsEnabled");df=new jb(df,null,uf);Be=Gl(Be);for(uf=Be.next();!uf.done;uf=Be.next())df.commandSurface=uf.value,Ld.apply(df,this.Uga,ib)}else try{var og=ia(H),dh=ib(H),th=!!ag.AFrameworkApplication.fa&&ag.AFrameworkApplication.fa.ra("AddinCommandsMultipleCustomTabsEnabled");df=new jb(og,null,dh);var Ki=Gl(Be);for(uf=Ki.next();!uf.done;uf=Ki.next())df.commandSurface=uf.value,
Ld.apply(df,this.Uga,th)}catch(pj){throw af.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+pj.message),pj;}if(OSF.OUtil.checkFlight(14))try{var xh=df.Xbd(H.solutionId,Nc.getDefaultDisplayName()),ui=df.YUe();xh&&this.ribbonManager.nYa(xh,Vc);ui&&this.contextMenuManager.Cke(ui);this.QF.fle(Lb,xh,ui,Nc.getDefaultDisplayName());af.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Nc.getDefaultDisplayName())}catch(pj){throw OfficeExt.DevConsole.log(pj),af.ULS.sendTraceTag(539870850,
220,10,"Error generating ribbon extensibility. Exception: "+pj.message),pj;}else try{var Ai=df.Xbd(H.solutionId,Nc.getDefaultDisplayName()),Oj=df.YUe();Ai&&this.ribbonManager.nYa(Ai);Oj&&this.contextMenuManager.Cke(Oj);this.QF.fle(Lb,Ai,Oj,Nc.getDefaultDisplayName());af.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Nc.getDefaultDisplayName())}catch(pj){throw af.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+pj.message),pj;}}};ma.prototype.vVe=function(H,
ia,ib,Lb,Nc,Vc){Vc=void 0===Vc?null:Vc;var Hd={};Hd.solutionId=H.solutionId;Hd.version=H.version;Hd.storeType=H.storeType;Hd.storeId=H.assetStoreId;Hd.assetId=H.assetId;Hd.assetStoreId=H.assetStoreId;Hd.targetType=H.targetType;var Ld=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Po.QM,this.Po.formFactor);try{var Be=ia.getManifest(),df=Ld.parse(Hd,Be,Nc,this.Uga,ia.getSharedRuntimeId()),uf=ib(H),og=Lb(H),dh=new jb(uf,null,og);dh.commandSurface="PrimaryCommandSurface";df.apply(dh,this.Uga,!0);
if(dh.ribbonBuilder.Ps&&0<dh.ribbonBuilder.Ps.count){var th=dh.Xbd(H.solutionId,ia.getManifest().getDefaultDisplayName(),1);ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.ribbonManager.nYa(th,Vc):th&&this.ribbonManager.nYa(th,Vc);this.QF.jBg(ia,th,Nc,ia.getManifest().getDefaultDisplayName());af.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",ia.getManifest().getDefaultDisplayName())}}catch(Ki){af.ULS.sendTraceTag(592290768,
220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",ia.getManifest().getDefaultDisplayName(),Ki.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Ki)}};ma.prototype.k2b=function(H){H.Ho&&this.ribbonManager.jId(H.Ho);H.Hqb&&this.contextMenuManager.x8i(H.Hqb);this.QF.e8i(H.xB.getStoreType(),H.xB.getSolutionId())};ma.prototype.fXg=function(H,ia){ia=Ec(ia);for(var ib=Gl(this.QF.s5a),Lb=ib.next();!Lb.done;Lb=ib.next())if(Lb=Lb.value,Lb.xB.getStoreType()===ia){for(var Nc=
!0,Vc=Gl(H),Hd=Vc.next();!Hd.done;Hd=Vc.next())if((Hd=Hd.value)&&Lb.Gff(Hd.storeType,Hd.solutionId)){Nc=!1;break}Nc&&(this.k2b(Lb),Lb.xB.purge(!1))}};ma.prototype.seg=function(H){return!!H&&!!H.solutionId&&!!H.version&&!!H.storeType&&!!H.storeId};Object(fe.a)(ma,"AddInCommandsIntegration",null,[]);hd.prototype.cDg=function(H){this.Za.addHandler(Ug.a.Rne,H)};hd.prototype.VEg=function(H){this.Za.addHandler(Ug.a.ijf,H)};hd.prototype.wGg=function(H){this.Za.addHandler(Ug.a.b2f,H)};hd.prototype.kDg=function(H){this.Za.addHandler(Ug.a.sXc,
H)};hd.prototype.Rpi=function(H,ia,ib){var Lb=this,Nc=ib[Ug.a.tnb],Vc=void 0===ib[Ug.a.ZT]?0:ib[Ug.a.ZT];if(Nc&&0!==Vc)if(0>=Nc.count&&4!==Vc)this.EGf(new Qd(Vc,null,null,ia,null,!0));else{var Hd=Nc.count,Ld=new xb(new Af),Be=void 0===ib[Ug.a.Vga]?-1:ib[Ug.a.Vga],df=new ma(Vc,this.En,this.yEc,Ld,this.amg,this.aXa,this.iQb),uf=function(xh){return Lb.Rhe.tQg(xh.solutionId,Lb.iQb,Lb.yEc,H)},og=function(xh){return Lb.Rhe.EPg(xh.solutionId)},dh=function(xh,ui,Ai){Hd--;Ai=new Qd(Vc,ui,Ld,ia,Ai,0>=Hd);xh&&
ui?Lb.EGf(Ai):(Lb.dTb&&(3===Vc||ui&&ui.isUpgraded)&&(xh="",ui&&(xh=Telemetry.PrivacyRules.GetPrivacyCompliantId(ui.solutionId,ui.ownerAddinStoreType||ui.storeType,ui.assetId,null,null,ui.storeId)),ui={},ui=(ui.SDX_AppInstallOrigin="User",ui.SDX_AppInstallErrorCode="onAddinCompletedBase.fail",ui.SDX_Id=xh,ui),Db.a.sendTelemetryEvent(Object.assign(new Td.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:nj.a.sl(ui)}))),Lb.DGf(Ai));Hd||ag.AFrameworkApplication.sa.updateCommandUI()},th=function(xh,
ui,Ai,Oj){dh(xh,ui,Oj)},Ki=function(){Lb.Pxd();0>=Nc.count&&4===Vc&&Lb.aXa.RNd()};6===Vc?(Be=ib[Ug.a.wIa],ib=ib[Ug.a.xIa],df.ypi(Nc.oa(0),Be,ib,uf,og,function(xh,ui,Ai,Oj){dh(xh,ui,Oj)})):df.oBb(Nc,uf,og,Be,th,Ki,this.usg)}else this.dTb&&(df={},df=(df.SDX_AppInstallOrigin="User",df.SDX_AppInstallErrorCode="LaunchOneLineRibbonAddinCommands.fail",df.SDX_Id="",df),Db.a.sendTelemetryEvent(Object.assign(new Td.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:nj.a.sl(df)}))),af.ULS.sendTraceTag(24786637,
220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.yEc.QM)),this.DGf(new Qd(Vc,null,null,ia,null,!0))};hd.prototype.DGf=function(H){this.Pxd(H);this.T2f(!1,H)};hd.prototype.EGf=function(H){var ia=H.Mm,ib=null;null!==ia&&(ib=ia.storeType,ib=ib.toLowerCase());if(this.dTb&&H&&"omex"===ib&&(3===H.pt||ia.isUpgraded)){var Lb={};Lb=(Lb.SDX_AppInstallOrigin="User",Lb.SDX_AppInstallErrorCode="0",Lb.SDX_Id=Telemetry.PrivacyRules.GetPrivacyCompliantId(ia.solutionId,ia.ownerAddinStoreType||
ia.storeType,ia.assetId,null,null,ia.storeId),Lb);Db.a.sendTelemetryEvent(Object.assign(new Td.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:nj.a.sl(Lb)}))}this.Pxd(H);"omex"===ib&&H.f7&&(3===H.pt||ia.isUpgraded)&&(Lb=new zd,Lb.Mm=ia,Lb.Ho=H.f7.VMa,this.Za.raiseEvent(Ug.a.sXc,Lb));if(this.iqg){Lb=wb();var Nc=Dd();Lb&&ia&&"excatalog"===ia.storeType&&H.f7&&5===H.pt&&Nc&&(ia.storeId&&ia.storeId.toLowerCase()===Nc.toLowerCase()||ia.assetId&&ia.assetId.toLowerCase()===Nc.toLowerCase())&&(Lb=
new zd,Lb.Mm=ia,Lb.Ho=H.f7.VMa,this.Za.raiseEvent(Ug.a.sXc,Lb),af.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."))}ia&&(Jd.instance.gXf(pe(ib),!0),"uploadfiledevcatalog"===ib&&(Lb=this.ujg.createAddinDataProvider(ib,this.En))&&Lb.localCacheAddinCommands(this.En.rma,ia.solutionId,ia.version,ia.storeId),ik.a.ANb(Ug.a.MZb,"true",pe(ib)));this.T2f(!0,H)};hd.prototype.T2f=function(H,ia){H?ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&ia.f7&&5===ia.pt&&ia.f7.VMa&&void 0!==ia.Mm.showCallout&&null!==ia.Mm.showCallout&&ia.Mm.showCallout?((new bd(this.Za,ia.Mm,Ek.a.pub(ia.f7.VMa))).sAg(),H=new zd,H.Ho=ia.f7.VMa,H.Mm=ia.Mm,this.Za.raiseEvent(Ug.a.b2f,H)):3!==ia.pt?ia.pif&&this.aXa.RNd():ia.f7&&ia.f7.VMa&&"hardcodedpreinstall"!==ia.Mm.storeType&&qk.a.pxj(ia.displayName,ia.f7.VMa,ia.Mm.isAutoLaunched):3===ia.pt?ia.Mm&&"uploadfiledevcatalog"===ia.Mm.storeType.toLowerCase()?(ia=this.iQb.JMh(ia.Mm.solutionId),qk.a.TQd(ia?ia:CommonUIStrings.l_InternalError+
" "+CommonUIStrings.l_InternalError_Directive)):this.aXa.lYf():ia.pif&&this.aXa.RNd()};hd.prototype.Pxd=function(H){var ia=(H=void 0===H?null:H)?H.Mm:null,ib=new zd;if(ib.Mm=ia){var Lb=this.aXa.Ria(ia.storeType,ia.solutionId,6===H.pt?1:0);Lb&&Lb.Ho&&(ib.Ho=Lb.Ho,this.dTb&&3===H.pt&&"hardcodedpreinstall"!==ia.storeType)&&(H="",Lb.Ho.pW&&Lb.Ho.pW.Ps&&(Lb=Lb.Ho.pW.Ps.oa(0))&&(H=Lb.id),Lb={},ia=(Lb.SDX_CommandPlacement=H,Lb.SDX_PinningAction="Pinning",Lb.SDX_PinningActionErrorCode="0",Lb.SDX_Id=Telemetry.PrivacyRules.GetPrivacyCompliantId(ia.solutionId,
ia.ownerAddinStoreType||ia.storeType,ia.assetId,null,null,ia.storeId),Lb),Db.a.sendTelemetryEvent(Object.assign(new Td.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:nj.a.sl(ia)})))}this.Za.raiseEvent(Ug.a.Rne,ib)};Object(fe.a)(hd,"LaunchAddinCommandsHandler",null,[253]);uc.mUa="Alt";uc.nUa="Command";uc.id="Id";uc.pUa="Image16by16";uc.TPb="LabelText";uc.qUa="Title";uc.GROUP="Group";uc.d0d="Groups";uc.agb="Controls";uc.button="Button";uc.Caa="FlyoutAnchor";uc.LARGE="Large";uc.SMALL="Small";
Object(fe.a)(uc,"AddinDataNodeConstants",null,[]);b(629);b(622);Ck.Object.defineProperties(kc.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}},AU:{configurable:!0,enumerable:!0,get:function(){return this.y3d||(this.y3d={})}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.gmg||""}},menuItems:{configurable:!0,enumerable:!0,get:function(){return this.YDa||(this.YDa=new Kg.a)}}});Object(fe.a)(kc,"ControlDefinition",null,[249]);Ck.Object.defineProperties(Jb.prototype,
{ula:{configurable:!0,enumerable:!0,get:function(){return this.wae||(this.wae={})}},id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}}});Object(fe.a)(Jb,"MenuItemDefinition",null,[296]);Ck.Object.defineProperties($b.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},controls:{configurable:!0,enumerable:!0,get:function(){return this.Gpa||(this.Gpa=new Kg.a)}}});Object(fe.a)($b,"OfficeMenuDefinition",null,[250]);var kj=b(27);Ha.prototype.addButton=function(H){af.ULS.sendTraceTag(17085952,
220,50,"ContextMenu button actiontype: {0}.",H.actionType);this.RI=new kc(this.Asa(H.id),uc.button);this.RI.AU[uc.TPb]=H.label;this.RI.AU[uc.mUa]=H.label;this.RI.AU[uc.pUa]=H.icon["16"];this.Fob(this.RI.AU[uc.id],H.action);this.uFa(this.RI.AU);this.gVa.controls.add(this.RI);this.RI=null};Ha.prototype.startBuildMenu=function(H){if(Dj.c(this.gVa))this.gVa=new $b(H.id);else{var ia=this.Asa(H.id);this.RI=new kc(ia,uc.Caa);this.OZa(this.RI.AU,H);this.RI.AU[uc.pUa]=H.icon["16"];this.RI.AU[uc.nUa]=kj.a.alwaysEnabled}};
Ha.prototype.addMenuItem=function(H){af.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",H.actionType);var ia=new Jb(this.Asa(H.id));this.OZa(ia.ula,H);H.icon&&(ia.ula[uc.pUa]=H.icon["16"]);this.Fob(ia.ula[uc.id],H.action);this.uFa(ia.ula);this.RI.menuItems.add(ia)};Ha.prototype.endBuildMenu=function(){Dj.c(this.RI)?(this.Xkc.add(this.gVa),this.gVa=null):(this.gVa.controls.add(this.RI),this.RI=null)};Ha.prototype.Fob=function(H,ia){this.hTc.bindAction(H,ia)};Ha.prototype.uFa=
function(H){this.jqb.uFa(H)};Ha.prototype.Asa=function(H){return this.Dlc.PJa(H)};Ha.prototype.OZa=function(H,ia){H[uc.TPb]=ia.label;H[uc.mUa]=ia.label};Ck.Object.defineProperties(Ha.prototype,{Dlc:{configurable:!0,enumerable:!0,get:function(){return this.DNc}},jqb:{configurable:!0,enumerable:!0,get:function(){return this.UUa}},hTc:{configurable:!0,enumerable:!0,get:function(){return this.sUa}},Xkc:{configurable:!0,enumerable:!0,get:function(){return this.Rrg}}});Object(fe.a)(Ha,"ContextMenuExtensibilityCreator",
null,[272,270]);lb.prototype.PJa=function(H){return this.YCb+H};Ck.Object.defineProperties(lb.prototype,{YCb:{configurable:!0,enumerable:!0,get:function(){return this.$jb}}});Object(fe.a)(lb,"DefaultContextMenuNamingProvider",null,[274]);var sk=b(1364);cb.prototype.bindAction=function(H,ia){OfficeExt.DefaultControlActionBinder.bindAction(H,ia)};Object(fe.a)(cb,"DefaultUIControlActionBinder",null,[273]);Qa.prototype.uFa=function(H){H[uc.nUa]=this.command};Ck.Object.defineProperties(Qa.prototype,{command:{configurable:!0,
enumerable:!0,get:function(){return this.GCa}}});Object(fe.a)(Qa,"DefaultUIControlCommandBinder",null,[271]);var tk=b(32);Object(fe.a)(Ib,"AddInControl",null,[]);Object(fe.a)(yb,"AddInGroup",null,[]);Object(fe.a)(Xa,"AddInMenuItem",null,[]);Object(fe.a)(bb,"AddInTab",null,[]);Ua.prototype.startBuildTab=function(H){var ia=H.isOfficeTab?H.id:this.Dlc.j2e(H.id),ib=H.isOfficeTab?null:H.label;this.hVa=Object.assign(new bb,{id:ia,title:ib,isOfficeTab:H.isOfficeTab,visible:H.visible,groups:[],tabType:H.tabType,
insertBefore:H.insertBefore,insertAfter:H.insertAfter,autoFocus:H.autoFocus})};Ua.prototype.startBuildGroup=function(H){var ia=this.Asa(H.id);this.cfa=Object.assign(new yb,{id:ia,mlrId:H.mlrId,title:H.label,controls:[],groupType:0})};Ua.prototype.addNativeGroup=function(H){this.cfa=Object.assign(new yb,{id:H.id,mlrId:H.mlrId,title:H.label,controls:[],groupType:1});this.hVa.groups.push(this.cfa)};Ua.prototype.addButton=function(H){var ia=this.Asa(H.id);ia&&(this.Fob(ia,H.action),af.ULS.sendTraceTag(24786640,
220,50,"AddInDataTransferObject button actiontype: {0}.",H.actionType),H=Object.assign(new Ib,{id:ia,title:H.label,iconLocation:this.med(H),enabled:H.enabled,controlType:0,attributes:this.OZa()}),this.y5d.rke(new tk.a(ia,this.jqb.command.toString())),this.cfa.controls.push(H))};Ua.prototype.addNativeControl=function(H){H.id&&(af.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",H.actionType),H=Object.assign(new Ib,{id:H.id,title:"",iconLocation:"",enabled:H.enabled,
controlType:2,attributes:this.OZa()}),this.cfa.controls.push(H))};Ua.prototype.startBuildMenu=function(H){var ia=this.Asa(H.id);ia&&(this.qhb=Object.assign(new Ib,{id:ia,title:H.label,iconLocation:this.med(H),controlType:1,attributes:{},menuItems:[]}))};Ua.prototype.addMenuItem=function(H){var ia=this.Asa(H.id);ia&&(this.Fob(ia,H.action),af.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",H.actionType),H=Object.assign(new Xa,{id:ia,title:H.label,iconLocation:this.med(H),
enabled:H.enabled,attributes:this.OZa()}),this.y5d.rke(new tk.a(ia,this.jqb.command.toString())),this.qhb.menuItems.push(H))};Ua.prototype.endBuildMenu=function(){Dj.c(this.qhb.id)||this.cfa.controls.push(this.qhb);this.qhb=null};Ua.prototype.endBuildGroup=function(){Dj.c(this.cfa.id)||this.hVa.groups.push(this.cfa);this.cfa=null};Ua.prototype.endBuildTab=function(){Dj.c(this.hVa.id)||this.fQb.add(this.hVa);this.hVa=null};Ua.prototype.OZa=function(){var H={};this.uFa(H);return H};Ua.prototype.med=
function(H){return H.icon["80"]?H.icon["80"]:H.icon["32"]};Ua.prototype.uFa=function(H){this.jqb.uFa(H)};Ua.prototype.Asa=function(H){return this.Dlc.PJa(H)};Ua.prototype.Fob=function(H,ia){this.hTc.bindAction(H,ia)};Ck.Object.defineProperties(Ua.prototype,{Dlc:{configurable:!0,enumerable:!0,get:function(){return this.DNc}},Ps:{configurable:!0,enumerable:!0,get:function(){return this.fQb}},hTc:{configurable:!0,enumerable:!0,get:function(){return this.sUa}},jqb:{configurable:!0,enumerable:!0,get:function(){return this.UUa}}});
Object(fe.a)(Ua,"OneLineRibbonExtensibilityCreator",null,[269,270]);ja.prototype.EPg=function(H){H=new lb(H);return new Ha(H,this.UUa,this.sUa)};ja.prototype.tQg=function(H,ia,ib,Lb){ib=new sk.a(this.$jb,H,ib,!0);return new Ua(ib,this.sUa,this.UUa,H,ia,Lb)};Object(fe.a)(ja,"UIExtensibilityFactory",null,[244]);var Lk=b(95),Sk=b(1071);wa.GetPrivacyCompliantId=function(H){return wa.UDc?Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.storeType,H.assetId,null,null,H.storeId):Telemetry.PrivacyRules.GetAssetId(H.storeType,
H.storeId,H.assetId)};wa.oUa=function(H){return wa.UDc?Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,H.storeType,H.assetId,null,null,H.storeId):Telemetry.PrivacyRules.GetAssetId(H.storeType,H.storeId,H.assetId)};wa.prototype.A7i=function(H){this.pC=H;window.addEventListener&&(window.addEventListener("LaunchContentAddin",Object(zh.a)(this,this.qMi,"onLaunchButtonClicked_ContentAddin"),!0),window.addEventListener("DismissCallout",Object(zh.a)(this,this.FHi,"onDismissButtonClicked_ContentAddin"),
!0),window.addEventListener("CloseCallout",Object(zh.a)(this,this.jGi,"onCloseButtonClicked_ContentAddin"),!0))};wa.prototype.yfd=function(H){return"[id="+H+"]"};wa.prototype.v3f=function(H,ia){var ib=this;ia>this.dHg?(window.clearTimeout(this.ZNf),this.u3f("[data-unique-id='pivotOverflowButton']"),af.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+H)?this.u3f(H):this.ZNf=window.setTimeout(function(){ib.v3f(H,ia+
1)},1E3)};wa.prototype.t3f=function(H){var ia=document.querySelector("button[data-unique-id='RightPaddle']");if(ia)H={},H=(H.AppTeachingUICalloutAction="RightPaddlePresent",H["SDX.Id"]=wa.GetPrivacyCompliantId(this.Mm),H.AppTeachingUICalloutGoal="NewAdminDeployment",H["SDX.AppInstallOrigin"]="Organization",H),Db.a.sendTelemetryEvent(Object(Kf.a)(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(H)}));else if(ia=document.querySelector("button"+H),!ia||"none"===window.getComputedStyle(ia).display)if(ia=
document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!ia){ia={};ia=(ia.AppTeachingUICalloutAction="NoAnchor",ia["SDX.Id"]=wa.GetPrivacyCompliantId(this.Mm),ia.AppTeachingUICalloutGoal="NewAdminDeployment",ia["SDX.AppInstallOrigin"]="Organization",ia);Db.a.sendTelemetryEvent(Object(Kf.a)(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(ia)}));af.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.U5();return}this.H9f(ia,
"ShowTeachingUIForAddinButton")};wa.prototype.u3f=function(H){H=document.querySelector("button"+H);if(!H&&(H=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!H)){H={};H=(H.AppTeachingUICalloutAction="NoAnchor",H["SDX.Id"]=wa.GetPrivacyCompliantId(this.Mm),H.AppTeachingUICalloutGoal="NewAdminDeployment",H["SDX.AppInstallOrigin"]="Organization",H);Db.a.sendTelemetryEvent(Object(Kf.a)(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(H)}));af.ULS.sendTraceTag(537170690,
220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.U5();return}this.H9f(H,"ShowTeachingUIForAddinTab")};wa.prototype.H9f=function(H,ia){H.setAttribute("lpp-id","latestAddin");var ib=Yd.a.instance.kc("Common.ISystemInitiatedFeedback");ib&&H?(ib.execute(function(Lb){Lb.logActivity(ia,null)}),H={},H=(H.AppTeachingUICalloutAction="Show",H["SDX.Id"]=wa.GetPrivacyCompliantId(this.Mm),H.AppTeachingUICalloutGoal="NewAdminDeployment",H["SDX.AppInstallOrigin"]="Organization",H),Db.a.sendTelemetryEvent(Object(Kf.a)(new Td.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(H)})),af.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(af.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),H={},H=(H.AppTeachingUICalloutAction="NoSifFutureObject",H["SDX.Id"]=wa.GetPrivacyCompliantId(this.Mm),H.AppTeachingUICalloutGoal="NewAdminDeployment",H["SDX.AppInstallOrigin"]="Organization",H),Db.a.sendTelemetryEvent(Object(Kf.a)(new Td.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(H)})),this.U5())};wa.prototype.LGh=function(H){if(!H)return null;H=H.pW;if((null===H||void 0===H?0:H.Ps)&&0<H.Ps.count){H=Gl(H.Ps);for(var ia=H.next();!ia.done;ia=H.next())if(ia=ia.value,ia.groups&&0<ia.groups.length){ia=Gl(ia.groups);for(var ib=ia.next();!ib.done;ib=ia.next())if(ib=ib.value,ib.controls&&0<ib.controls.length){ib=Gl(ib.controls);for(var Lb=ib.next();!Lb.done;Lb=ib.next()){Lb=Lb.value;if(Lb.attributes&&0===Lb.controlType&&
Lb.enabled)return Lb.id;if(Lb.menuItems)for(var Nc=Gl(Lb.menuItems),Vc=Nc.next();!Vc.done;Vc=Nc.next())if(Vc=Vc.value,Vc.attributes&&Vc.enabled)return Lb.id}}}}return null};wa.prototype.Kzj=function(){var H=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(H&&"none"!==window.getComputedStyle(H).display)af.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{H=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");
if(null==H){H={};H=(H.AppTeachingUICalloutAction="NoAnchor",H["SDX.Id"]=wa.oUa(this.pC),H.AppTeachingUICalloutGoal="NewAdminDeployment",H["SDX.AppInstallOrigin"]="Organization",H);Db.a.sendTelemetryEvent(Object(Kf.a)(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(H)}));af.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.U5();return}af.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}var ia=
Yd.a.instance.kc("Common.ISystemInitiatedFeedback");null==ia||null==H?(H={},H=(H.AppTeachingUICalloutAction="NoSifFutureObject",H["SDX.Id"]=wa.oUa(this.pC),H.AppTeachingUICalloutGoal="NewAdminDeployment",H["SDX.AppInstallOrigin"]="Organization",H),Db.a.sendTelemetryEvent(Object(Kf.a)(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(H)})),af.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.U5()):(ia.execute(function(ib){ib.logActivity("ShowTeachingUIForContentAddin",
null)}),H={},H=(H.AppTeachingUICalloutAction="Show",H["SDX.Id"]=wa.oUa(this.pC),H.AppTeachingUICalloutGoal="NewAdminDeployment",H["SDX.AppInstallOrigin"]="Organization",H),Db.a.sendTelemetryEvent(Object(Kf.a)(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(H)})),af.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))};wa.prototype.qMi=function(){var H={};H=(H.AppTeachingUICalloutAction="ClickOnLaunch",H["SDX.Id"]=wa.oUa(this.pC),
H.AppTeachingUICalloutGoal="NewAdminDeployment",H["SDX.AppInstallOrigin"]="Organization",H);Db.a.sendTelemetryEvent(Object(Kf.a)(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(H)}));this.U5();var ia={};ia[Gi.a.pg]=this.pC;H={};H.solutionId=this.pC.solutionId;H.assetId=this.pC.assetId;H.assetStoreId=this.pC.assetStoreId;H.height=0!=this.pC.height?this.pC.height:600;H.storeId=this.pC.storeId;H.storeType=this.pC.storeType;H.targetType=this.pC.targetType;H.width=0!=
this.pC.width?this.pC.width:600;H.displayName=this.pC.displayName;H.version=this.pC.version;H.isAddinCommands=!1;ia[Ug.a.Yra]=H;var ib=new Lk.a(-741808261,0,0,2,null);Nh.TaskExtensions.Ba(hj.GetServiceTaskFactory.Xa(this.$.da,374,375,1),function(Lb){Lb=Lb.result;null!=Lb&&Lb.insertAgave(ia,ib)},this.$.la,3)};wa.prototype.jGi=function(){var H={};H=(H.AppTeachingUICalloutAction="ClickOnClose",H["SDX.Id"]=wa.oUa(this.pC),H.AppTeachingUICalloutGoal="NewAdminDeployment",H["SDX.AppInstallOrigin"]="Organization",
H);Db.a.sendTelemetryEvent(Object(Kf.a)(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(H)}));this.U5()};wa.prototype.FHi=function(){var H={};H=(H.AppTeachingUICalloutAction="ClickOnDismiss",H["SDX.Id"]=wa.oUa(this.pC),H.AppTeachingUICalloutGoal="NewAdminDeployment",H["SDX.AppInstallOrigin"]="Organization",H);Db.a.sendTelemetryEvent(Object(Kf.a)(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(H)}));this.U5()};wa.prototype.JQa=function(H){var ia=
{},ib={};ib.LastTeachingUIShowTime=(new Date).toUTCString();ib.AddinHasShown=H;ia[this.appName]=pa.c(ib);this.Une=new Mc(this.appName,null,null,Object(zh.a)(this,this.K6,"postRequestFailureCallback")),this.Une.qtb(ia),af.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")};wa.prototype.U5=function(){if(ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&!this.Ytc){var H=
window.g_roamingAddinList;H&&(this.JQa(H),this.Ytc=!0)}};wa.prototype.K6=function(H){af.ULS.sendTraceTag(522981591,306,10,"failed to POST data to Roaming Settings Service with status: {0}",H?H.httpStatus:-1)};Ck.Object.defineProperties(wa,{UDc:{configurable:!0,enumerable:!0,get:function(){return ag.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6189484_TeachingCalloutSolutionIdRefactorEnabled")}}});Object(fe.a)(wa,"AddinTeachingCalloutHandler",null,[]);var Xk=b(1314),kl=b(392),Gk=b(10),jk=
b(40);Za.prototype.dispose=function(){void 0!==this.unb&&null!==this.unb&&(this.unb.dispose(),this.unb=null);this.Je=this.$=null;this.disposed=!0};Za.prototype.Juj=function(H,ia){switch(H){case kj.a.A2:H=this.vuj(ia);break;default:H=!1}return H};Za.prototype.$c=function(){return!1};Za.prototype.executeCommand=function(H,ia,ib){var Lb=this;H=Nh.TaskExtensions.sk();ia=ia.command;switch(ia){case 843847158:break;case -2025863019:qk.a.TQd(ib[Ug.a.yVc].toString(),function(){vj.g(Lb.$).focus()});break;case -1777565636:Xk.a.showUILessDialog(ib[Ug.a.vnb].toString());
this.Je.Exj(ib[Ug.a.vnb].toString());break;case 1592314317:Xk.a.hideUILessDialog(ib[Ug.a.vnb].toString());this.Je.S4h(ib[Ug.a.vnb].toString());break;case kj.a.A2:H=this.shd(ib);break;case kj.a.nBb:this.oBb(ib);break;case kj.a.hna:this.hna(ib);break;case kj.a.UQd:this.unb.Exc();break;case kj.a.refreshAddinCommands:this.w5i();break;case 1949669462:this.Wga.lYf(!0);break;case -1014260128:H=this.executeDynamicAddInCommandsAPI(ib);break;default:H=fk.a(ia)}return H};Za.prototype.Mc=function(H,ia){H=!1;
switch(ia.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case kj.a.hna:case kj.a.UQd:case kj.a.refreshAddinCommands:case 1949669462:case kj.a.nBb:case -1014260128:H=!0;break;case kj.a.A2:H=!ag.AFrameworkApplication.protectedFile}return H};Za.prototype.jd=function(){return!1};Za.prototype.uKh=function(H){if(!H)return af.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((H=H.pW)&&H.Ps&&0<H.Ps.count){H=Gl(H.Ps);for(var ia=H.next();!ia.done;ia=H.next()){ia=
ia.value;if(ia.groups&&1===ia.groups.length){var ib=ia.groups[0];if(ib.controls&&1===ib.controls.length){var Lb=ib.controls[0];if(Lb.attributes&&!Lb.controlType&&Lb.enabled)return Lb.id}ib.controls&&af.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}ia.groups&&af.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}}return null};Za.prototype.w5i=function(){if(this.Wga.btd()){this.Wga.Kxe();var H=this.scd();if(H&&0<H.count){H=Gl(H);for(var ia=H.next();!ia.done;ia=H.next()){var ib=
{};ia=(ib[Ug.a.Vga]=ia.value,ib[Ug.a.ZT]=4,ib[Ug.a.LFa]=(new Date).getTime(),ib);this.hna(ia)}}}};Za.prototype.hna=function(H){var ia=this;af.ULS.sendTraceTag(537170657,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",H[Ug.a.ZT],H[Ug.a.Vga]);this.Wga.Wmj();window.setTimeout(function(){if(void 0===ia.Je||null===ia.Je)af.ULS.sendTraceTag(537170656,220,10,String.format("AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: {0}",
jk.a.v3()));else{var ib=new Xc(new Md(ia.Je.Ei),Tc.instance,Jd.instance);ib.bDg(function(Lb,Nc){ia.oBb(Nc.properties)});ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&ag.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&ib.xGg(function(Lb,Nc){null==Nc?(Lb={},Lb=(Lb.AppTeachingUICalloutAction="InvalidEventArgs",Lb.AppTeachingUICalloutGoal="NewAdminDeployment",
Lb["SDX.AppInstallOrigin"]="Organization",Lb),Db.a.sendTelemetryEvent(Object(Kf.a)(new Td.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:nj.a.sl(Lb)}))):(ia.A7f=new wa(ia),ia.A7f.A7i(Nc),Lb=ia.$.Ka,null!=Lb&&(Lb.Jne(Object(zh.a)(ia,ia.o$e,"onTabSwitched")),af.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});ib.XLj(H)}},0)};Za.prototype.o$e=function(H,ia){"Insert"==ia.tabName&&(H=this.$.Ka,null!=H&&(H.VPf(Object(zh.a)(this,this.o$e,"onTabSwitched")),af.ULS.sendTraceTag(527286662,
220,50,"Remove insertTabSwitched handler")),this.A7f.Kzj())};Za.prototype.oBb=function(H){var ia=this;if(!this.disposed){af.ULS.sendTraceTag(537170655,220,50,"LaunchOperationType {0}.",H[Ug.a.ZT]);try{if(Fg.EwaSettings.ma(187)){var ib=H[Ug.a.tnb];if(ib&&0<ib.count){for(var Lb=ib.count,Nc=Lb-1;0<=Nc;Nc--){var Vc=ib.oa(Nc);OSF.OsfControl.isFirstPartyStoreString(Vc.storeType)||ib.remove(ib.oa(Nc))}if(ib.count<Lb){var Hd=hj.GetServiceTaskFactory.Xa(this.$.da,5,4,0);Nh.TaskExtensions.Ba(Hd,function(){Hd.result.fg(35,
null)},this.$.la,3)}if(!ib.count)return}}if(void 0===this.Je||null===this.Je)af.ULS.sendTraceTag(537170654,220,10,String.format("LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: {0}",jk.a.v3()));else{var Ld=null;Ld=ag.AFrameworkApplication.fa.ra("HostInstallAddInsIsEnabled")?new hd(this.Po,this.bBe,new Md(this.Je.Ei),new ja(this.$.Mb,kj.a.A2),this.Wga,Tc.instance,this.Uga,function(df,uf){var og={};og.InstanceId=T.a.create().toString();og.PrimaryMarketplace={};og.PrimaryMarketplace.SolutionId=
df.solutionId;og.PrimaryMarketplace.SolutionVersion=df.version;og.PrimaryMarketplace.MarketplaceType=df.storeType;og.PrimaryMarketplace.MarketplaceRef=df.storeId;og.WebExtensionType=1;ia.Je.Qzj(og,function(){uf(df)})}):new hd(this.Po,this.bBe,new Md(this.Je.Ei),new ja(this.$.Mb,kj.a.A2),this.Wga,Tc.instance,this.Uga);Ld.kDg(this.WEi);Ld.cDg(this.oMi);if(ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)){var Be=new wa(this);Ld.VEg(Be.nMi);
Ld.wGg(Be.qxj)}this.$.da.za(53).Wl&&tl.a.get_instance().Nk(5,null).continueWith(function(){ia.disposed||Ld.Rpi(ia.h$c,ia.$.domElement,H)})}}catch(df){af.ULS.sendTraceTag(537170653,220,10,String.format("LaunchAddinCommands error message : {0}.",df.message))}}};Za.prototype.shd=function(H){var ia=Nh.TaskExtensions.sk();H=H[this.Po.Zha];var ib=this.JZb.pje(H),Lb=new Xk.a(this.$,this.Je,ib.ownerAddinInfo,ia);return this.e4e(ia,H,ib,Lb)};Za.prototype.e4e=function(H,ia,ib,Lb){var Nc=this;this.JZb.shd(ia,
this.Wga,Lb,new Md(this.Je.Ei),ib,function(){H=Lb.b1g()},function(){vj.g(Nc.$).focus()});return H};Za.prototype.xMg=function(H){var ia=this,ib=Nh.TaskExtensions.sk(),Lb=this.Je.waa(H.solutionId);if(Lb){var Nc=this.Je.tZ(Lb);if(Gk.HelperMethods.Bw(Nc)&&0!==Nc.SharedRuntime.State)return}Nc=this.JZb.yMg;var Vc=H.solutionId in Nc?Nc[H.solutionId]:null;if(Vc){var Hd=this.JZb.pje(Vc),Ld=new Xk.a(this.$,this.Je,Hd.ownerAddinInfo,ib);Nc=function(df){if(df){var uf={};df=Gl(df);for(var og=df.next();!og.done;og=
df.next())og=og.value,uf[og[0]]=og[1];(uf=Ug.a.Qne in uf?uf[Ug.a.Qne]:null)&&"true"===uf.toLowerCase()&&(af.ULS.sendTraceTag(537170652,220,50,"Auto-Show AddinCommands TaskPane, StoreType {0}, StoreId {1}, SolutionId {2}.",H.storeType,H.storeId,Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,null!==Hd.ownerAddinInfo?Hd.ownerAddinInfo.storeType:H.storeType,H.assetId,null,null,H.storeId)),ia.e4e(ib,Vc,Hd,Ld))}};af.ULS.sendTraceTag(537170651,220,50,"Check Auto-Show AddinCommands TaskPane, StoreType {0}, StoreId {1}, SolutionId {2}.",
H.storeType,H.storeId,Telemetry.PrivacyRules.GetPrivacyCompliantId(H.solutionId,null!==Hd.ownerAddinInfo?Hd.ownerAddinInfo.storeType:H.storeType,H.assetId,null,null,H.storeId));if(Lb)Nc(this.Je.tZ(Lb).OsfPropertyBag);else if(Lb=this.$.ea.workbookContext.WebExtensions){Lb=Gl(Lb);for(var Be=Lb.next();!Be.done;Be=Lb.next())if(Be=Be.value,(1===Be.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===H.targetType&&Be.PrimaryMarketplace.MarketplaceType.toLowerCase()===H.storeType.toLowerCase()&&
Be.PrimaryMarketplace.MarketplaceRef.toLowerCase()===H.storeId.toLowerCase()&&Be.PrimaryMarketplace.SolutionId.toLowerCase()===H.solutionId.toLowerCase()){Nc(Be.OsfPropertyBag);break}}}};Za.prototype.kUd=function(H,ia,ib){H&&(void 0===ib||!ib||ia||this.n5c.contains(H)||this.n5c.add(H),(ib=this.l1a.contains(H))&&ia&&this.l1a.remove(H),ib||ia||this.l1a.add(H))};Za.prototype.zqj=function(H){if((H=H.pW)&&H.Ps){H=Gl(H.Ps);for(var ia=H.next();!ia.done;ia=H.next())if(ia=ia.value,ia.groups){ia=Gl(ia.groups);
for(var ib=ia.next();!ib.done;ib=ia.next())if(ib=ib.value,ib.controls){ib=Gl(ib.controls);for(var Lb=ib.next();!Lb.done;Lb=ib.next())if(Lb=Lb.value,this.kUd(Lb.id,Lb.enabled,!0),1===Lb.controlType&&Lb.menuItems){Lb=Gl(Lb.menuItems);for(var Nc=Lb.next();!Nc.done;Nc=Lb.next())Nc=Nc.value,this.kUd(Nc.id,Nc.enabled,!0)}}}}};Za.prototype.scd=function(){var H=new Kg.a;Fg.EwaSettings.ma(54)&&(this.$.ea.Yg.get(27)&&(H.add(0),H.add(16)),this.$.ea.Yg.get(33)&&H.add(1),H.add(8));return H};Za.prototype.executeDynamicAddInCommandsAPI=
function(H){var ia=!0;if(void 0===H||null===H||void 0===H[Ug.a.Asb]||null===H[Ug.a.Asb])return Lj.Task.Sa(!1);switch(H[Ug.a.Asb]){case 1:ia=this.$Oj(H);break;case 2:ia=this.Dqj(H);break;case 4:this.l1a.clear();this.l1a.addRange(this.n5c);break;case 3:ia=this.installContextualTab(H);break;default:ia=!1}return Lj.Task.Sa(ia)};Za.prototype.vuj=function(H){return H&&this.Po.Zha in H?(H=H[this.Po.Zha])?this.l1a.contains(H):!1:!1};Za.prototype.$Oj=function(H){var ia=null,ib=null,Lb=null,Nc=!0;void 0!==
H[Ug.a.Y3]&&null!==H[Ug.a.Y3]&&void 0!==H[this.Po.Zha]&&null!==H[this.Po.Zha]&&void 0!==H[Ug.a.X3]&&null!==H[Ug.a.X3]&&(ia=H[Ug.a.Y3],ib=H[Ug.a.n7b],Lb=H[this.Po.Zha],Nc=H[Ug.a.X3]);if(!ia||!Lb)return af.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;H=(new sk.a(this.$.Mb,ia,this.Po,!0)).PJa(Lb);ia={DynamicAddinCommandsApiName:"UpdateControlEnableState"};ia.AssetId=ib;ia.MaskedTabId=H;ia.IsToEnable=Nc;af.ULS.sendTraceTag(537170648,220,50,Bh.a.Jc(ia));
this.kUd(H,Nc);kl.a.Sy.updateCommandUI();return!0};Za.prototype.Dqj=function(H){var ia,ib,Lb=null,Nc=null,Vc=null,Hd=null,Ld=!0;void 0!==H[Ug.a.T6c]&&null!==H[Ug.a.T6c]&&void 0!==H[Ug.a.Y3]&&null!==H[Ug.a.Y3]&&void 0!==H[this.Po.Zha]&&null!==H[this.Po.Zha]&&void 0!==H[Ug.a.X3]&&null!==H[Ug.a.X3]&&(Lb=H[Ug.a.T6c],Nc=H[Ug.a.Y3],Vc=H[Ug.a.n7b],Hd=H[this.Po.Zha],Ld=H[Ug.a.X3]);if(!Lb||!Nc||!Hd)return af.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),
!1;H=(new sk.a(this.$.Mb,Nc,this.Po,!0)).j2e(Hd);Hd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};Hd.StoreType=Lb;Hd.AssetId=Vc;Hd.MaskedTabId=H;Hd.IsToShow=Ld;af.ULS.sendTraceTag(537170646,220,15,Bh.a.Jc(Hd));Nc=this.Wga.Ria(Lb,Nc,1);Lb=!1;if(null===(ib=null===(ia=null===Nc||void 0===Nc?void 0:Nc.Ho)||void 0===ia?void 0:ia.pW)||void 0===ib?0:ib.Ps)for(ia=Gl(Nc.Ho.pW.Ps),ib=ia.next();!ib.done;ib=ia.next())if(ib.value.id===H){Lb=!0;break}if(!Lb)return af.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),
!1;ia=[];Ld?appChrome.selectors.getSelectedTabId()!==H&&ia.push(appChrome.actions.activateRibbonTab(H)):(appChrome.selectors.getSelectedTabId()===H&&ia.push(appChrome.actions.setCurrentTab(gh.a.JW)),ia.push(appChrome.actions.deactivateRibbonTab(H)));appChrome.api.dispatch(ia);return!0};Za.prototype.installContextualTab=function(H){var ia=null,ib=null,Lb=null,Nc=null;if(void 0!==H[Ug.a.Y3]&&null!==H[Ug.a.Y3]&&void 0!==H[Ug.a.X3]&&null!==H[Ug.a.X3]){var Vc=H[Ug.a.X3];ia=H[Ug.a.Y3];void 0!==Vc[Ug.a.wIa]&&
null!==Vc[Ug.a.wIa]&&void 0!==Vc[Ug.a.xIa]&&null!==Vc[Ug.a.xIa]&&(ib=Vc[Ug.a.wIa],Lb=Vc[Ug.a.xIa],Nc=Vc[Ug.a.U6c])}if(!(ia&&Lb&&ib&&Nc))return af.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;H=this.Wga.Ria(Nc.PrimaryMarketplace.MarketplaceType,Nc.PrimaryMarketplace.SolutionId,1);if(null===H||void 0===H?0:H.Ho)return af.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;H={};H.solutionId=Nc.PrimaryMarketplace.SolutionId;
H.version=Nc.PrimaryMarketplace.SolutionVersion;H.storeType=Nc.PrimaryMarketplace.MarketplaceType;H.storeId=Nc.PrimaryMarketplace.MarketplaceRef;H.assetId=Nc.PrimaryMarketplace.SolutionId;H.assetStoreId=Nc.PrimaryMarketplace.MarketplaceRef;H.targetType=Nc.WebExtensionOsfControlType;H.width=Nc.TaskpaneWidth;H.height=0;H.isAddinCommands=!0;Nc=new Kg.a;Nc.add(H);H={};H[Ug.a.tnb]=Nc;H[Ug.a.ZT]=6;H[Ug.a.wIa]=ib;H[Ug.a.xIa]=Lb;this.oBb(H);return!0};Object(fe.a)(Za,"AddinUICommandHandler",null,[509,428,
3]);var Yk=b(70),dl=b(694),Tk=b(20),ll=b(17),el=yj.a;Wl(ub,el);ub.prototype.Od=function(){var H=this;af.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");Yk.a(this.$).add(Object(Kf.a)(new dl.a,{Jwc:function(){var ia=H.$.ea.kF&&H.$.ea.rc&&!!(H.$.Qd&16384)&&H.$.isEditMode;H.$.ea.rc&&af.ULS.sendTraceTag(38410433,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [{0}] IsSessionFullyLoaded [{1}] IsSessionActive [{2}] ShowCommandUI [{3}] IsEditMode [{4}]",
ia,H.$.ea.kF,H.$.ea.rc,!!(H.$.Qd&16384),H.$.isEditMode);return ia},WXb:this.Wyg,H5b:this.jbh,wtb:2}))};ub.prototype.f6i=function(H){var ia=this,ib=hj.GetServiceTaskFactory.create(this.$.da,102,this.la,this.vb);return Nh.TaskExtensions.Ba(ib,function(){af.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");ia.$.da.Ga(204,new Id(ib.result,H))},this.la,3)};ub.ka=function(H){yj.a.ee(199,new ub(H))};Object(fe.a)(ub,"AddinUICommandHandlerFactory",
yj.a,[]);var ql=b(1302),Hk=b(1304),Ij=qg.a;Wl(ad,Ij);ad.prototype.create=function(){var H=this,ia;if(Fg.EwaSettings.ma(403)){var ib=hj.GetServiceTaskFactory.create(this.$.da,106,this.$.la,this.vb),Lb=hj.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.vb);Nh.TaskExtensions.Ba(Lj.Task.WAA(ib,Lb),function(){H.Eb(H.$.da.za(278)||new ql.CustomFunctionsInstaller(H.$,ib.result,Lb.result))},this.$.la,3)}else(ia=this.$.da.za(278))||(ia=this.$.da.Ga(278,new Hk.CustomFunctionsLegacyInstaller(this.$))),
this.Eb(ia)};ad.ka=function(H){H.da.Ga(279,new ad(H))};Object(fe.a)(ad,"CustomFunctionsInstallerFactory",qg.a,[]);var Uk=b(91),rl=b(47),ml=b(43);vc.prototype.ka=function(H){this.hXc?af.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.hXc=!0,this.HPa={},this.IPa={},H?H.QDg(this.K9f):af.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))};vc.prototype.detach=function(H){if(H){H.i$i(this.K9f);
H=this.HPa;for(var ia in H)Uk.a.Ha(H[ia]);this.IPa=this.HPa=null;this.hXc=!1}else af.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")};vc.prototype.BLf=function(H,ia,ib){if(this.gdi(ib,H))return!1;H=ia.querySelector("iframe");if(!H)return af.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;H=H.title;if(!H||!H.length)return af.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),
!0;this.ariaLiveNotifier.readText(H);return!0};vc.prototype.gdi=function(H,ia){return(H=H.Ei.getOsfControl(ia))?H.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0};Object(fe.a)(vc,"AgaveOnSelectedReadoutHandler",null,[504]);var W=qg.a;Wl(zb,W);zb.prototype.create=function(){var H=this,ia=this.$.da;Nh.TaskExtensions.Ba(hj.GetServiceTaskFactory.Xa(ia,211,212,this.vb),function(ib){ib=ia.za(224)||new vc(ib.result,H.$);H.Eb(ib)},this.la,3)};zb.ka=function(H){H.da.Ga(225,new zb(H))};Object(fe.a)(zb,
"AgaveOnSelectedReadoutHandlerFactory",qg.a,[]);var ua=b(944),gb=b(246);Hb.prototype.k5e=function(H){try{if(H&&H.rawEvent&&H.rawEvent.origin&&this.iframe&&this.iframe.id){var ia=this.VEf(H.rawEvent.origin),ib=this.VEf(document.domain);if(si.a.Qk().equals(ib,ia))if(H.rawEvent.source&&H.rawEvent.source.frameElement&&H.rawEvent.source.frameElement.id&&si.a.Qk().equals(H.rawEvent.source.frameElement.id,this.iframe.id)){ia=null;try{ia=JSON.parse(H.rawEvent.data)}catch(Lb){af.ULS.sendTraceTag(39112971,
344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",Lb.message)}ia?(ia.statusCode!==gb.a.bP||void 0!==ia.error&&ia.error?(af.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",ia.statusCode,ia.error),this.onError()):(af.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(ia.authorizationCode?ia.authorizationCode:
ia.signInUrl)),$removeHandler(window,"message",Object(zh.a)(this,this.k5e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):af.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):af.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):af.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else af.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");
else af.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else af.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Lb){af.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Lb.message)}};Hb.prototype.VEf=function(H){var ia="";try{H&&(ia=-1<H.indexOf("//")?H.split("/")[2]:H.split("/")[0])&&(ia=ia.split(":")[0],ia=ia.split("?")[0])}catch(ib){af.ULS.sendTraceTag(51451615,
344,10,"Failed to parse host name from url: {0}",ib.message)}return ia};Hb.ka=function(H,ia,ib){new Hb(H,ia,ib)};Object(fe.a)(Hb,"ResponseHandler",null,[]);var ac=b(261);Yb.prototype.tryAuthenticate=function(H,ia){this.y$a(Yb.spg,function(){H()},ia)};Yb.prototype.tryAuthorize=function(H,ia){this.y$a(Yb.pkg,H,ia)};Yb.prototype.getSignInUrl=function(H,ia){this.y$a(Yb.qge,H,ia)};Yb.prototype.signOut=function(H,ia){this.y$a(Yb.Kvg,H,ia)};Yb.prototype.y$a=function(H,ia,ib){var Lb=new ac.QueryStringBuilder("AuthenticationProxyHandler.aspx");
Lb.Wi("responseType",H);ag.AFrameworkApplication.iYa(Lb);Lb=String.format("{0}{1}&{2}",this.fFa,Lb.toString(),ag.AFrameworkApplication.nj);var Nc=document.createElement("iframe");Nc.setAttribute("id","privateCatalogIframe");Nc.setAttribute("name","privateCatalogIframe");Nc.setAttribute("style","display: none");si.a.Qk().equals(H,Yb.qge)||Nc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Hb.ka(Nc,ia,ib);Nc.setAttribute("src",Lb);document.body.appendChild(Nc)};
Yb.pkg="authcode";Yb.spg="identitytoken";Yb.qge="signinurl";Yb.Kvg="signout";Object(fe.a)(Yb,"AuthenticationProxy",null,[]);sb.getUserId="getUserId";sb.getLastStoreUpdate="laststoreupdate";sb.getEntitlement="getEntitlements";sb.getEToken="getEToken";sb.getManifest="getManifest";sb.getAppState="getAppState";sb.getKilledApps="getRemovedAddins";sb.getAppDetails="getAppDetails";sb.removeApps="removeAddin";sb.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";sb.getPrivateCatalogAddIns="getAddIns";
sb.getPrivateCatalogManifests="getAppManifests";sb.isStoreDisabled="isStoreDisabled";Object(fe.a)(sb,"S2SWebRequestActions",null,[]);var Jc=b(637);mc.prototype.getUserId=function(H,ia){var ib=new Kg.a;ib.add(new Ti.a("corr",H));this.iX(sb.getUserId,ib,1,ia)};mc.prototype.getLastStoreUpdate=function(H,ia,ib){var Lb=new Kg.a;Lb.add(new Ti.a("lc",H));Lb.add(new Ti.a("corr",ia));this.iX(sb.getLastStoreUpdate,Lb,1,ib)};mc.prototype.getEntitlement=function(H,ia,ib,Lb){H=new Kg.a;H.add(new Ti.a("av",ia));
H.add(new Ti.a("corr",ib));this.iX(sb.getEntitlement,H,1,Lb)};mc.prototype.getEToken=function(H,ia,ib,Lb,Nc,Vc){var Hd=new Kg.a;Hd.add(new Ti.a("cmu",H));Hd.add(new Ti.a("cmf",ia));Hd.add(new Ti.a("assetid",ib));Hd.add(new Ti.a("expver",Lb));Hd.add(new Ti.a("corr",Nc));this.iX(sb.getEToken,Hd,1,Vc)};mc.prototype.getManifest=function(H,ia,ib,Lb){var Nc=new Kg.a;Nc.add(new Ti.a("cmu",H));Nc.add(new Ti.a("assetid",ia));Nc.add(new Ti.a("corr",ib));this.iX(sb.getManifest,Nc,1,Lb)};mc.prototype.getAppState=
function(H,ia,ib){var Lb=new Kg.a;Lb.add(new Ti.a("ma",H));Lb.add(new Ti.a("corr",ia));this.iX(sb.getAppState,Lb,1,ib)};mc.prototype.getKilledApps=function(H,ia){var ib=new Kg.a;ib.add(new Ti.a("corr",H));this.iX(sb.getKilledApps,ib,1,ia)};mc.prototype.getAppDetails=function(H,ia,ib,Lb){var Nc=new Kg.a;Nc.add(new Ti.a("cmo",H));Nc.add(new Ti.a("corr",ib));this.sendWithBody(sb.getAppDetails,Nc,ia,2,Lb,!1)};mc.prototype.removeApps=function(H,ia,ib){var Lb=new Kg.a;Lb.add(new Ti.a("corr",ia));this.sendWithBody(sb.removeApps,
Lb,H,2,ib,!1)};mc.prototype.getLastPrivateCatalogUpdate=function(H,ia,ib,Lb,Nc,Vc){var Hd=new Kg.a;Hd.add(new Ti.a("catalog","privatecatalog"));Hd.add(new Ti.a("clientCode",H));Hd.add(new Ti.a("clientVersion",ia));Hd.add(new Ti.a("corr",Nc));H=String.format("authorizationCode={0}&refreshToken={1}",ib?Bj.a.nf(ib):"",Lb?Bj.a.nf(Lb):"");this.sendWithBody(sb.getLastPrivateCatalogUpdate,Hd,H,2,Vc,!0)};mc.prototype.getPrivateCatalogAddIns=function(H,ia,ib,Lb,Nc,Vc){var Hd=new Kg.a;Hd.add(new Ti.a("catalog",
"privatecatalog"));Hd.add(new Ti.a("clientCode",H));Hd.add(new Ti.a("clientVersion",ia));Hd.add(new Ti.a("corr",Nc));H=String.format("authorizationCode={0}&refreshToken={1}",ib?Bj.a.nf(ib):"",Lb?Bj.a.nf(Lb):"");this.sendWithBody(sb.getPrivateCatalogAddIns,Hd,H,2,Vc,!0)};mc.prototype.getPrivateCatalogManifests=function(H,ia,ib,Lb,Nc){var Vc=new Kg.a;Vc.add(new Ti.a("catalog","privatecatalog"));Vc.add(new Ti.a("corr",Lb));H=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Bj.a.nf(H),
ia?Bj.a.nf(ia):"",ib?Bj.a.nf(ib):"");this.sendWithBody(sb.getPrivateCatalogManifests,Vc,H,2,Nc,!0)};mc.prototype.isStoreDisabled=function(H,ia){var ib=new Kg.a;ib.add(new Ti.a("corr",H));this.iX(sb.isStoreDisabled,ib,2,ia)};mc.prototype.iX=function(H,ia,ib,Lb){this.sendWithBody(H,ia,null,ib,Lb,!1)};mc.prototype.sendWithBody=function(H,ia,ib,Lb,Nc,Vc){var Hd=new ac.QueryStringBuilder("AddinServiceHandler.ashx");Hd.Wi("action",H);Hd.Wi("app",Jc.a[ag.AFrameworkApplication.sa.Qa.Sj]);ia=Gl(ia);for(var Ld=
ia.next();!Ld.done;Ld=ia.next())Ld=Ld.value,Hd.Wi(Ld.key,Ld.value);Hd=String.format("{0}{1}&{2}",ag.AFrameworkApplication.sa.Qa.jW,Hd.toString(),ag.AFrameworkApplication.nj);ag.AFrameworkApplication.Jd.gm(Hd,Lb,ib,null,!1,2,function(Be){var df=null,uf=null;Be&&Be.data&&(Be.data.responseHeaders["X-BlockedForMinor"]&&"1"===Be.data.responseHeaders["X-BlockedForMinor"].toString()&&(Be.data.httpStatus=451),df=Be.data.ke,uf=Be.data.responseHeaders);Nc(Be.data.httpStatus,df,uf)},function(Be){var df=null,
uf=null;Vc&&Be&&Be.data&&Be.data.ke&&(df=Be.data.ke,uf=Be.data.responseHeaders);Nc(Be.data.httpStatus,df,uf);if(ag.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){df={message:"AddinServiceHandler request failed"};df.code=Be.data.httpStatus;df.action=H;if(Be.data.request||Be.data.request.get_headers())df["X-UserSessionId"]=Be.data.request.get_headers()["X-UserSessionId"];408===Be.data.httpStatus||503===Be.data.httpStatus?af.ULS.sendTraceTag(538784582,
220,10,JSON.stringify(df)):af.ULS.sendTraceTag(18392345,220,50,JSON.stringify(df))}else af.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Be.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+H,void 0,void 0,void 0,void 0,["X-UserKey"])};Object(fe.a)(mc,"S2SWebRequestManager",null,[]);var gd=qg.a;Wl(Vb,gd);Vb.prototype.create=function(){var H=this;af.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");ag.AFrameworkApplication.disableWholeAppsForOfficeFeature?
af.ULS.sendTraceTag(537170506,0,50,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [{0}]",ag.AFrameworkApplication.disableWholeAppsForOfficeFeature):Fg.EwaSettings.ma(407)?Yd.a.instance.kc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(ia){ia.isFeatureEnabled("mso_officeStore",!0).then(function(ib){ua.DdaFacade.f2c=ib;H.lDe();return null})}):this.lDe()};Vb.prototype.lDe=function(){var H=this,ia=hj.GetServiceTaskFactory.Xa(this.$.da,
224,225,this.vb),ib=ek.a.Ysd(42,function(){return!(void 0===window.OSF||null===window.OSF)},this.$.ya.MaxRetriesForLoadingScript,this.$.la,this.vb,106),Lb=sc(this.la,this.vb);Nh.TaskExtensions.Ba(Nh.TaskExtensions.te([ia,ib,Lb],this.$.la),function(){"undefined"===typeof OfficeExt||"undefined"===typeof OSF?af.ULS.sendTraceTag(537170505,0,15,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: {0}",jk.a.v3()):H.y8h();af.ULS.sendTraceTag(537170504,
0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");H.ALf=ia.result;H.Eb(H.Je);af.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.la,3)};Vb.prototype.y8h=function(){Fg.EwaSettings.ma(65)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new mc);this.$.Yf.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new mc,new Yb(ag.AFrameworkApplication.fa.appSettings.WebServiceBase),Fg.EwaSettings.ma(72),Fg.EwaSettings.ma(434))};Vb.prototype.dispose=
function(){Uk.a.Ha(this.ddaFacade);this.$=this.ddaFacade=null;gd.prototype.dispose.call(this)};Vb.ka=function(H){new Vb(H)};Ck.Object.defineProperties(Vb.prototype,{Je:{configurable:!0,enumerable:!0,get:function(){return this.ddaFacade||(this.ddaFacade=new ua.DdaFacade(this.$,this.ALf))}}});Object(fe.a)(Vb,"DdaFacadeServiceFactory",qg.a,[]);bc.prototype.jd=function(){return!1};bc.prototype.$c=function(){return!1};bc.prototype.Mc=function(H,ia,ib,Lb){var Nc=!1;switch(ia.command){case -684355545:Nc=
!0;break;case -741808261:Nc=!!ib;break;case -859308420:Nc=!!Lb&&1===Lb.Ex;break;case 418618014:Nc=1===H&&!!Lb&&1===Lb.Ex;break;case -515602470:ia=Fg.EwaSettings.ma(235)&&2===H;Nc=(1===H||ia)&&!!Lb&&1===Lb.Ex;break;case 2086613372:Nc=Fg.EwaSettings.ma(235)&&2===H&&!!Lb&&1===Lb.Ex;break;case -1336341324:Nc=Fg.EwaSettings.ma(482)&&1===H&&!!Lb&&1===Lb.Ex;break;case 451940422:Nc=Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",!1)&&1===H&&!!Lb&&1===Lb.Ex;break;case -1444574190:case -336193495:Nc=
1===H&&!!Lb&&1===Lb.Ex;break;case 1296389134:Nc=1===H&&!!Lb&&1===Lb.Ex;break;case -1473679467:Nc=Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===H&&!!Lb&&1===Lb.Ex;break;case 1221897806:Nc=Fg.EwaSettings.ma(167)&&2===H;break;case 1172793074:case 1930653487:Nc=Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===H;break;case -1753056834:Nc=Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",
!1);break;case 932597253:Nc=!0;break;case 301511274:Nc=Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Nc=Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:Nc=this.$.isEditMode&&this.$.ea.OKb}return Nc};bc.prototype.executeCommand=function(H,ia,ib){var Lb=Nh.TaskExtensions.sk(),Nc=ia.command;switch(ia.command){case -1473679467:Hh.a(this.$,488,489,1,function(Vc){Lb=
Vc.zai(ib.SourceControlId,ia)});break;case 1296389134:this.agaveCommandManager.LCj(ib.SourceControlId,ib.LabelText);break;case -684355545:this.agaveCommandManager.CZc();break;case -741808261:Lb=this.agaveCommandManager.insertAgave(ib,ia);Hh.a(this.$,488,489,1,function(Vc){Vc.wzg(ib)});break;case -1336341324:Fg.EwaSettings.ma(482)&&(Lb=this.agaveCommandManager.Ghd(ib,H,ia));break;case 1172793074:Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&(Lb=this.agaveCommandManager.Ghd(ib,
H,ia));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:Lb=this.agaveCommandManager.Ghd(ib,H,ia);break;default:Lb=fk.a(Nc)}return Lb};Object(fe.a)(bc,"AgaveCommandHandler",null,[428]);Object(fe.a)(qd,"Selection",null,[]);Object(fe.a)(yc,"SmartLookupApplicationInterface",null,[]);Object(fe.a)(Rb,"ApplicationProperties",null,
[]);Object(fe.a)(Ja,"EnterpriseUserInfo",null,[]);Object(fe.a)(Eb,"FeatureGates",null,[]);zc.prototype.uWh=function(){var H=void 0===H?!0:H;var ia=this.xFe();if(ia<this.zud+this.LIj)return ia>this.zud+this.OIj&&this.ocd(),this.Mmf;H&&this.ocd();return""};zc.prototype.ocd=function(){var H=this;this.Cud=this.Cud||new Promise(function(ia){H.vWh().then(function(ib){H.Mmf=ib;H.zud=H.xFe();H.Cud=null;ia(ib)})})};zc.prototype.vWh=function(){var H=this;return this.i8a&&this.i8a.length?new Promise(function(ia){H.Hxa.FS("SmartLookup",
H.i8a).then(function(ib){ib.IsSuccess?ib.Token||(ia(""),af.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(af.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+ib.ErrorCode+": "+ib.ErrorMessage),ia(""));ia(ib.Token)}).catch(function(ib){ib=pa.c(ib);af.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+ib);ia("")})}):(af.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),
Promise.resolve(""))};Object(fe.a)(zc,"SmartLookupAuthenticationManager",null,[356]);Bb.DMh=function(){switch(Object(lj.a)(String,ag.AFrameworkApplication.dc.AudienceGroup)||""){case "Dogfood":if(ag.AFrameworkApplication.fa){var H=ag.AFrameworkApplication.fa.Va("UserPrincipalName");H=Bj.a.Al(H);var ia=ag.AFrameworkApplication.fa.ro("SmartLookupINTEnabledForSKITeam")?ag.AFrameworkApplication.fa.zw("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(ia,H)?"INT":"EDOG"}return"EDOG";default:return"PROD"}};
Bb.SVh=function(){switch(ag.AFrameworkApplication.fa.ra("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":ag.AFrameworkApplication.fa.ra("IntentSvcEnableProdSourceLocationOverride")?"PROD":ag.AFrameworkApplication.fa.ra("IntentSvcEnableIntSourceLocationOverride")?"INT":Bb.DMh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}};
Object(fe.a)(Bb,"Utils",null,[]);var cd=b(617);db.prototype.nHh=function(){return Promise.resolve(this.oHh())};db.prototype.oHh=function(){var H=new Rb;H.anid="";H.applicationVersion=ag.AFrameworkApplication.buildVersion;H.appCorrelationId=qi.a.create().toString();H.themePlatform=db.OUj;H.lcid=ag.AFrameworkApplication.lcid;H.launchUtcTime=(new Date).toUTCString();H.featureGates=this.h8a;var ia=cd.a.kH(ag.AFrameworkApplication.lcid);ia=ia?ia.name:null;H.market=this.zac(ia);H.uiLanguage=ia;H.sessionId=
ag.AFrameworkApplication.userSessionId;H.themeId=0;H.parentalControl=db.WUi;var ib=new Ja;ib.CountryCode=this.zac(ia);ib.ServiceEndpoint=this.i8a;ib.IsGoLocal=!1;ib.IsEnabled=this.snf;ib.IsEnterpriseEnabled=this.snf;ib.TenantRoot=this.bwi;H.enterpriseUserInfo=ib;H.accessToken=this.Wvi.uWh();return H};db.prototype.zac=function(H){H=H.split("-");return H[H.length-1]};Ck.Object.defineProperties(db.prototype,{approvedOriginPattern:{configurable:!0,enumerable:!0,get:function(){return this.wvi}}});db.OUj=
"web";db.WUi="yes";Object(fe.a)(db,"SmartLookupManager",null,[317]);var Oc=zk.a;Wl(nb,Oc);nb.prototype.jd=function(){return!1};nb.prototype.$c=function(){return!1};nb.prototype.Mc=function(H,ia){H=Fg.EwaSettings.ma(135);return-983891024===ia.command&&H};nb.prototype.executeCommand=function(H,ia){H=Nh.TaskExtensions.sk();-983891024===ia.command&&this.zpi();return H};nb.prototype.zpi=function(){var H=this,ia=new db(null),ib={},Lb=vj.g(this.$).lc(null).originalText;Lb=Object(Kf.a)(new qd,{neighborhood:Lb,
mentionStart:0,mentionLength:Lb?Lb.length:0});var Nc=Object(Kf.a)(new yc,{selection:Lb,entryPoint:0});ia.nHh().then(function(Hd){Hd.applicationName=nb.appName;Hd.isFirstLaunch=H.isFirstLaunch;Hd.themeId=5;ib[nb.smartLookupApplicationInterface]=JSON.stringify(Nc);ib[nb.gJg]=JSON.stringify(Hd);H.isFirstLaunch=!1});ia=new xg.a("ExcelOnline","Web","en-Us");Lb=new Zg.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");var Vc=new ih.a;Vc.optionalProperties[Zd.Yk]=K.a.instance.ga(1782);
Vc.optionalProperties[Zd.taskPaneWidth]=350;Vc.optionalProperties[Zd.sourceLocationOverrideResourceId]="WAC.PROD.URL";Vc.Dq=ib;rg.a.instance.kNa(Lb,"Taskpane","SmartLookupSDXTaskpane",ia,Vc)};nb.gJg="AppProperties";nb.appName="Excel";nb.smartLookupApplicationInterface="SmartLookupApplicationInterface";Object(fe.a)(nb,"SmartLookupCommandHandler",zk.a,[428]);var Ic=yj.a;Wl(Nb,Ic);Nb.prototype.Od=function(){var H=this;Hh.a(this.$,374,375,this.vb,function(ia){H.Cd([new bc(H.$,null,null,null,null,ia),
new nb(H.$)])})};Nb.ka=function(H){yj.a.ee(76,new Nb(H))};Object(fe.a)(Nb,"AgaveCommandHandlerFactory",yj.a,[]);Object(fe.a)(nc,"AppsDataManager",null,[228]);var Bd=b(1365),Ed=b(107);cc.prototype.initialize=function(H){cc.initialized||(this.Je=H,this.Og(),cc.initialized=!0)};cc.prototype.Og=function(){ag.AFrameworkApplication.Ib.Ve(kj.a.eab,Ed.a.frame,this.eab,96);ag.AFrameworkApplication.Ib.fc(kj.a.W5i,Ed.a.frame,this.e7i)};Ck.Object.defineProperties(cc,{instance:{configurable:!0,enumerable:!0,get:function(){cc.Ma||
(cc.Ma=new cc);return cc.Ma}}});cc.Ma=null;cc.initialized=!1;Object(fe.a)(cc,"AgaveCommandActor",null,[]);var qe=b(113),Qe=b(368),tf=b(365),ig=b(1317),yg=b(357);Object(fe.a)(Cb,"FirstPartyAddinTaskpaneOverrides",null,[]);Object(fe.a)(Sa,"IdeasSelectionContext",null,[]);Wl(Ta,Sa);Object(fe.a)(Ta,"IdeasTableSelectionContext",Sa,[]);var Dh=b(63),Jh=b(45),Lh=b(386),Yi=b(168),Ji=b(627),ej=b(134),Wi=b(150),Ni=b(182),Ej=Wi.a;Wl(Da,Ej);Da.prototype.jD=function(){Ej.prototype.jD.call(this);this.Lp.style.width=
this.P1d;this.Lp.style.height=this.YUa;this.Lp.style.marginTop=this.hRb;this.Lp.style.padding=this.ZUa};Da.prototype.DPa=function(){this.Lp.style.width=this.P1d;this.Lp.style.height=this.YUa;this.Lp.style.marginTop=this.hRb;this.Lp.style.padding=this.ZUa;this.VCa>Ni.a.k$a?(this.Ob.style.width=String.format("{0}px",Ni.a.k$a),this.Ob.style.overflowX="scroll",ag.AFrameworkApplication.isRtl?this.Ob.style.right="0":this.Ob.style.left="0"):(this.Ob.style.width=String.format("{0}px",this.VCa),this.Ob.style.overflowX=
"hidden");this.Ob.offsetHeight>Ni.a.j$a||this.Rmg+50>Ni.a.j$a?(this.Ob.style.height=String.format("{0}px",Ni.a.j$a),this.Ob.style.overflowY="scroll",this.Ob.style.top="0",ag.AFrameworkApplication.isRtl?this.Ob.style.right="0":this.Ob.style.left="0",this.OHc||(this.Ob.style.marginTop="-48px"),this.Lp.style.minHeight=String.format("{0}px",this.Ekg)):(this.Ob.style.overflowY="hidden",this.Ob.style.top="10%",this.Ob.style.height=this.Ihb);this.t_a()};Da.prototype.t_a=function(){if(this.Ob){var H=this.Ob.style.zIndex;
this.Ob.style.zIndex="-9999";if(this.VCa>Ni.a.k$a)ag.AFrameworkApplication.isRtl?this.Ob.style.marginRight="0":this.Ob.style.marginLeft="0";else{var ia=String.format("{0}px",Math.floor(-this.Ob.offsetWidth/2));ag.AFrameworkApplication.isRtl?this.Ob.style.marginRight=ia:this.Ob.style.marginLeft=ia;ag.AFrameworkApplication.isRtl?this.Ob.style.right="50%":this.Ob.style.left="50%"}this.Ob.style.zIndex=String(H)}else af.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")};Da.prototype.wO=
function(){Ej.prototype.wO.call(this);var H=document.getElementById(this.oi(this.Qmg));H.style.width=String.format("{0}px",this.VCa);H.style.height=this.Ihb};Ck.Object.defineProperties(Da.prototype,{g1a:{configurable:!0,enumerable:!0,get:function(){return this.Lp}}});Object(fe.a)(Da,"AppsForOfficeInsertionDialog",Wi.a,[341]);var Zi=b(1164),Ah=zk.a;Wl(Pa,Ah);Pa.prototype.GEg=function(H){this.addHandler(Pa.JBd,H)};Pa.prototype.R$i=function(H){this.removeHandler(Pa.JBd,H)};Pa.prototype.dispose=function(){Uk.a.Ha(this.iwa);
this.iwa=null;Ah.prototype.dispose.call(this)};Pa.prototype.CZc=function(){this.iwa.hide()};Pa.prototype.LCj=function(H,ia){if(H){this.raiseEvent(Pa.JBd);var ib=H.split("|");this.Fti(H,ia,ib);this.iwa=new Da;this.iwa.initializeAndShow("",null,null);this.Je.Tpi(this.iwa.g1a,ib)}};Pa.prototype.Ghd=function(H,ia,ib){var Lb=Nh.TaskExtensions.sk();if(-515602470===ib.command||-336193495===ib.command||2086613372===ib.command||-1444574190===ib.command||-1336341324===ib.command||451940422===ib.command)Lb=
this.w1h(H,ia,ib);418618014===ib.command&&(ia=new Fj.a,ia.Yk=K.a.instance.ga(1793),Lb=this.D7(ib,Pa.D4h,ia,!0));if((ib.tabName===this.$.Mb+gh.a.cTf||ib.tabName===gh.a.IW)&&2===ib.Ze||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),H[Gi.a.kd])||H[Gi.a.kd]===gh.a.XQ)return this.Q4e(H,ib);if(7===ib.Ze&&H.SourceControlId===this.$.Mb+gh.a.ucc)return H.MenuItemId=gh.a.rGd,this.Q4e(H,ib);1221897806===ib.command&&(Lb=this.e2f(ib,"Format"));if(1930653487===ib.command||1172793074===
ib.command)Lb=this.e2f(ib,"Data");-1753056834===ib.command&&(Lb=this.yyj(ib));932597253===ib.command&&(af.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),Pi.c(932597253,!0),ia=new Fj.a,ia.Yk=K.a.instance.ga(2126),ia.sourceLocationOverrideResourceId=Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?Pa.xYi:Pa.zYi,ia.focusOnIframeWhenLoaded=!0,ia.taskPaneWidth=Pa.u8e,Lb={},Lb.LaunchSource=Object(lj.a)(String,H.SourceControlId),Lb.LaunchMode=
"Default",ia.$H=Lb,Lb=this.D7(ib,Pa.yYi,ia,!0));301511274===ib.command&&(Lb=this.Iyj(ib));515196233===ib.command&&((ia=this.$.da.za(465))&&ia.$6e(),ia=new Fj.a,ia.Yk=K.a.instance.ga(2196),Lb={},Lb.SourceUILocation=Qe.a[ib.Ze],ia.$H=Lb,Lb=new kf,Lb.cba=Si.a.f2a,Lb=this.D7(ib,Pa.KTi,ia,!0,Lb,void 0,ia.Yk));1723441034===ib.command&&(ia=new Fj.a,ia.Yk=K.a.instance.ga(2208),ia.focusOnIframeWhenLoaded=!0,ia.taskPaneWidth=Pa.v0i,Lb=new kf,Lb.cba=Si.a.moh,Lb=this.D7(ib,Pa.u0i,ia,!0,Lb));Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)&&H.LoadDataFromPictureTaskpane&&(ia={},Lb=new Fj.a,Lb.Yk=K.a.instance.ga(2234),ia.SessionID=H.SessionID,Lb.$H=ia,Lb.focusOnIframeWhenLoaded=!0,Lb=this.D7(ib,H.DataFromPictureAssetId,Lb,!0));return Lb};Pa.prototype.insertAgave=function(H,ia){var ib=this,Lb=Nh.TaskExtensions.sk(),Nc=this.$,Vc=H[Ug.a.Yra];if("SourceControlId"in H){var Hd={};af.ULS.sendTraceTag(523819228,220,15,"insertAgave with SourceControlId called.");var Ld=H.SourceControlId.split("|");if(8!==Ld.length||!(Ld[0]&&Ld[1]&&Ld[2]&&
!isNaN(parseInt(Ld[2],10))&&Ld[3]&&!isNaN(parseInt(Ld[3],10))&&Ld[4]&&Ld[5]&&!isNaN(parseInt(Ld[5],10))&&Ld[6]&&Ld[7]))return Nh.TaskExtensions.G4();Vc={};Vc.version=Hd.Version=Ld[0];Vc.assetId=Hd.AssetId=Ld[1];Vc.solutionId=Hd.SolutionId=Ld[1];Vc.height=Hd.Height=parseInt(Ld[2],10);Vc.width=Hd.Width=parseInt(Ld[3],10);Vc.storeId=Hd.StoreId=Ld[4];Vc.targetType=Hd.TargetType=parseInt(Ld[5],10);Vc.assetStoreId=Hd.AssetStoreId=Ld[6];Vc.storeType=Hd.StoreType=Ld[7]}else Hd=H[Gi.a.pg];Ld=null;kf.key in
H&&(Ld=H[kf.key]);this.iwa&&this.iwa.hide();if(!Hd||!Vc)return af.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),Lb;this.$.t5&&gh.a.fea in H&&(Hd.EnabledInViewMode=H[gh.a.fea]);H=this.SJh(ia.command);if(!Hd.EnabledInViewMode&&!Nc.Aq(null,!1,H))return Lb;var Be=void 0===Hd.IsToBePersisted||null===Hd.IsToBePersisted||Hd.IsToBePersisted?0:16;if(1===Hd.TargetType)Lb=this.Uai(Hd,Vc,ia,Ld,Be);else{Vc=vj.g(Nc);Lb=this.viewBlockContainerHelpers.pfb(Vc);var df=Nc.ea.isNamedObjectViewMode?
Nc.qa.sheetName:Nc.qa.name;if(Lb){Vc=Lb.sf;var uf=Vc.uf.top;var og=Vc.uf.left;var dh=Lb.JI.x;var th=Lb.JI.y}else uf=og=1,Lb=this.viewBlockContainerHelpers.yKa(Vc),dh=Lb.x,th=Lb.y;var Ki=this.$.na.va.hc();Lb=function(xh,ui,Ai){var Oj=Nc.na.va,pj=Hd,tj=uf,Yj=og,lk=dh,vk=th;xh=Ue.b(xh,ib.oYi);var Hj=Oj.Na(9,Ki);Hj.sharedInfo=pj;Hj.sheetName=df;Hj.positionRow=tj;Hj.positionCol=Yj;Hj.positionOffsetX=lk;Hj.positionOffsetY=vk;return Zc.i(Oj,"InsertWebExtension",Hj,xh,ui,Ai,null,0)};Fg.EwaSettings.qc()?(Be|=
64,Lb=Lh.a(this.$.userOperationManager,Lb,function(xh){return new tc.a(534,0,xh,Be)},ia)):Lb=Lh.a(this.$.userOperationManager,Lb,function(xh){return new Mb.a(534,0,xh,Be)},ia)}return Lb};Pa.prototype.V0g=function(){var H=Yd.a.instance.kc("Common.App.ICustomerFeedbackUiWrapper"),ia=Yd.a.instance.kc("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.v$c?this.v$c.kjb?this.lwe():ia.instance.C6c(this.Jxh):af.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined");
ia={};ag.AFrameworkApplication.fa.Yke(ia);H=H.instance.getContext(ia);ia={};"telemetryGroup"in H&&(ia=H.telemetryGroup);ia.processSessionId=H.sessionId;ia.officeBuild=H.build;H.telemetryGroup=ia;H.feedbackType=-1;H.userVoiceEnabled=!1;"disableIncludeScreenshot"in H||(H.disableIncludeScreenshot=!1);"screenshot"in H||(H.screenshot=!1);H.disableScreenshotPreview=!1;H.includeScreenshotSelectedDefault=!0;return H};Pa.prototype.MYi=function(H){if(!this.Zya&&Fg.EwaSettings.getBooleanFeatureGate(Pa.z6h,!1)){var ia=
Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";ia=this.Rte(ia);var ib=new kf;ib.Rk=Si.a.z8b;this.Zya=this.XLd(ia,null,!1,null,ib);ia={};ej.b(this.$).Rd($h.a.NYi,(ia.Location=Qe.a[H.Ze],ia.InputMethod=tf.a[H.method],ia),void 0,!0)}};Pa.prototype.mYf=function(H){var ia=this.$.ea.Yg.get(17);Yd.a.instance.kc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(ib){ib.isFeatureEnabled("mso_sendASmile",
ia).then(function(Lb){H.FeedbackEnabled=ia&&Lb;return null})})};Pa.prototype.e2f=function(H,ia){var ib=vj.g(this.$),Lb=new Fj.a,Nc={};Nc.ActiveTab=ia;Nc.DatapaneFlighting=Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);Nc.RangePickerFlighting=Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneDataRangePicker",!1);Nc.AceFlighting=!0;Nc.ChartNewSDXRecording=Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",
!1);Nc.ThemeColorsFlighting=Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");Nc.UOMirror=Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);Nc.FormatTaskPaneAceButtonDark=Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",!1);Nc.FormatTaskPaneBetterFeedbackButton=Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",
!1);Nc.FormatTaskPaneBetterScrollbar=Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);this.mYf(Nc);Nc.startTimeMs=Date.now();Nc.UserSessionId=this.$.ya.UserSessionId;(ia=ib.ha.Oa.Ko)&&(Nc.SubSelection=ia);af.ULS.sendTraceTag(592524688,0,50,"Chart task pane launched. UserSessionId: {0}, UILocation: {1}, SubSelection: {2}",Nc.UserSessionId,void 0===H.Ze||null===H.Ze?"Null":Qe.a[H.Ze],ia||"ChartRoot");Lb.$H=Nc;Lb.Yk=K.a.instance.ga(975);Nc=new kf;Nc.cba=
Si.a.f2a;return this.D7(H,Pa.LVg,Lb,!0,Nc)};Pa.prototype.yyj=function(H){var ia=new Fj.a;ia.$H={};ia.Yk=K.a.instance.ga(1781);ia.yS=Pa.Rjf;var ib=new kf;ib.cba=Si.a.f2a;return this.D7(H,Pa.Rjf,ia,!0,ib,void 0,ia.Yk)};Pa.prototype.Iyj=function(H){var ia=new Fj.a;ia.$H={};ia.Yk=K.a.instance.ga(2150);var ib=new kf;ib.cba=Si.a.aqh;ib.dNb=Si.a.rNe;return this.D7(H,Pa.eBi,ia,!0,ib)};Pa.prototype.Q4e=function(H,ia){var ib=Pa.U6e,Lb=H[Gi.a.kd].toString(),Nc={},Vc=new Fj.a;Vc.Yk=K.a.instance.ga(9);switch(Lb){case "A0":Nc.query=
(H[Gi.a.pg]||"").split("|").slice(2,yg.a.WS).join("|");break;case "A1":Nc.query=H.CommandValueId;break;case "Help":Nc.gwdropdownflightinfo=Fg.EwaSettings.ma(240);Nc.query="";break;case gh.a.rGd:Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(Vc.Yk=K.a.instance.ga(1747),Vc.sourceLocationOverrideResourceId=Pa.E3e,Nc.feedback=this.V0g()):Nc.query=Lb;break;case "HelpArticle":Nc.query=H[Gi.a.pg];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":Nc.query=
Lb;break;default:return Lj.Task.Sa(!0)}Vc.$H=Nc;Lb=new kf;Lb.cba=Si.a.f2a;return this.D7(ia,ib,Vc,!1,Lb,H[gh.a.fea]||!1)};Pa.prototype.Rte=function(H){var ia={Version:"0.0.0.0"};ia.AssetId=Pa.mLa;ia.SolutionId=Pa.mLa;ia.AssetStoreId="";ia.StoreType=OSF.StoreType.Sdx;ia.Height=0;ia.Width=0;ia.StoreId=OSF.StoreType.Sdx;ia.TargetType=OSF.OsfControlTarget.TaskPane;ia.IsToBePersisted=!1;ia.SourceLocationOverrideResourceId=H;ia.SharedRuntimeId=H;return ia};Pa.prototype.w1h=function(H,ia,ib){function Lb(){Ld.LaunchMode=
"Default";Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Vc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Vc.sourceLocationOverrideResourceId="Insights.Https.Bundle";Vc.Yk=K.a.instance.ga(1792);Vc.yS=Pa.$Vc;Vc.Rk=Si.a.z8b;Hd.Rk=Si.a.z8b}var Nc=this,Vc=new Fj.a,Hd=new kf,Ld={};this.Zya&&this.mYf(Ld);Ld.LaunchSource="";Ld.StartTimeMs=Date.now();Ld.CorrelationId=qi.a.create().toString();Vc.$H=Ld;Vc.focusOnIframeWhenLoaded=!0;Vc.taskPaneWidth=Pa.u8e;Hd.cba=
Si.a.Yph;Hd.dNb=Si.a.oNe;switch(ib.command){case -1444574190:var Be,df;Ld.LaunchMode="RecommendedPivotTables";Ld.SelectionContext="";Ld.LaunchSource="PivotTableHandRaise"===Object(lj.a)(String,H.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&H.SourceSelection){var uf=H.SourceSelection.split(",")[0];ia=Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(function(){var th=
Jh.Z(uf,Nc.$.xa);Be=th.sheetName;df=th.OGb;og=th.range;return th}().returnValue&&!vj.g(this.$).Nb.Ika(og))H=this.$.xa.getItemByName(Be),Ld.SelectionContext=JSON.stringify(Object(Kf.a)(new Sa,{address:df,addressWithSheet:Be+"!"+og.hB(!1),sheetId:Dh.d(H),sheetName:Be,isSheetEmpty:!1,columnCount:og.width,rowCount:og.height,columnIndex:og.left+ia,rowIndex:og.top+ia,selectionType:"Continuous"}));else if((H=this.$.Hb.getItemByName(Object(lj.a)(String,H.SourceSelection)))&&Dh.n(H)){var og=Yi.a(H,!0);var dh=
this.$.xa.getItemByName(H.sheetName);Ld.SelectionContext=JSON.stringify(Object(Kf.a)(new Ta,{tableName:H.name,hasTableHeaders:Yi.d(H),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:og.hB(!1),addressWithSheet:dh.name+"!"+og.hB(!1),sheetId:Dh.d(dh),sheetName:dh.name,isSheetEmpty:!1,columnCount:og.width,rowCount:og.height,columnIndex:og.left+ia,rowIndex:og.top+ia,selectionType:"Continuous"}))}}Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Vc.sourceLocationOverrideResourceId=
"RecommendPivotTables.PPE.Bundle":Vc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";Vc.Yk=K.a.instance.ga(1791);Vc.yS=Pa.NWi;Vc.Rk=Si.a.GPe;Hd.Rk=Si.a.GPe;break;case -336193495:Ld.LaunchMode="RecommendedCharts";Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Vc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":Vc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";Vc.Yk=K.a.instance.ga(1790);Vc.yS=Pa.J4i;Vc.Rk=Si.a.HPe;Hd.Rk=Si.a.HPe;
break;case -1336341324:if(!Fg.EwaSettings.ma(482))return Lj.Task.Sa(!1);Ld.LaunchMode="NL";Vc.yS=Pa.$Vc;Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Vc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":Vc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(Fg.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Vc.Yk=K.a.instance.ga(1795);Ld.NLLaunchModeBrandingCandidatesIndex=1;break;
case 2:Vc.Yk=K.a.instance.ga(1796);Ld.NLLaunchModeBrandingCandidatesIndex=2;break;default:Vc.Yk=K.a.instance.ga(1794),Ld.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!Fg.EwaSettings.ma(235))return Lj.Task.Sa(!1);Ld.LaunchMode="ChartDesigner";Ld.LaunchSelectionMode=ia.toString();Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Vc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Vc.sourceLocationOverrideResourceId="Insights.Https.Bundle";
Vc.Yk=K.a.instance.ga(1797);Vc.yS=Pa.$Vc;break;case 451940422:Ld.LaunchSource="AutoFilter";ia=JSON.parse(H.CommandValueId);Ld.AutoFilterSource=JSON.stringify({autoFilterRange:{sheetName:ia.AutoFilterRange.SheetName,firstColumn:ia.AutoFilterRange.FirstColumn,lastColumn:ia.AutoFilterRange.LastColumn,firstRow:ia.AutoFilterRange.FirstRow,lastRow:ia.AutoFilterRange.LastRow},sob:ia.AutoFilterType,XYj:ia.ItemIndex,id:ia.Id});Lb();break;default:Fg.EwaSettings.ma(235)&&(Ld.LaunchSelectionMode=ia.toString()),
Lb()}Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Vc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Vc.sourceLocationOverrideResourceId="Insights.Https.Bundle";return this.Zya?this.Zya.CWR(function(){return Nc.qWf(Ld,Vc)}):this.$9h(ib,Vc,Hd,Ld)};Pa.prototype.$9h=function(H,ia,ib,Lb){var Nc=this;this.Zya=this.XLd(this.Rte(ia.sourceLocationOverrideResourceId),ia,!1,H,ib,!1);return Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?
(Lb.NoActionMsgOnFirstInstance=!0,this.zRa[Pa.mLa]=Lb,this.Zya):this.Zya.CWR(function(){return Nc.qWf(Lb,ia)})};Pa.prototype.qWf=function(H,ia){var ib=this.Je.waa(this.Je.$2a(Pa.mLa,ia.sourceLocationOverrideResourceId));if(ib){this.zRa[Pa.mLa]=H;var Lb=this.Mvd(this.Je.tZ(ib).OsfPropertyBag,Pa.mLa);this.Je.tZ(ib).OsfPropertyBag=Lb}this.kNa(Pa.mLa,"LaunchIdeasAction",H,ia);return Lj.Task.Sa(!0)};Pa.prototype.D7=function(H,ia,ib,Lb,Nc,Vc,Hd){ib=void 0===ib?null:ib;Lb=void 0===Lb?!1:Lb;Nc=void 0===Nc?
null:Nc;Vc=void 0===Vc?!1:Vc;Hd=void 0===Hd?null:Hd;Nh.TaskExtensions.sk();ib||(ib=new Fj.a);var Ld={Version:"0.0.0.0"};Ld.AssetId=ia;Ld.SolutionId=ia;Ld.AssetStoreId="";Ld.StoreType=Lb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Ld.Height=0;Ld.Width=0;Ld.StoreId=Lb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Ld.TargetType=OSF.OsfControlTarget.TaskPane;Ld.IsToBePersisted=!1;Ld.SourceLocationOverrideResourceId=ib.sourceLocationOverrideResourceId;if(ib.Yk||Hd)this.nad[ia]=Object(Kf.a)(new Cb,{zzc:ib.Yk,
zUd:Hd,xzc:ib.yS});Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(ib.$H||(ib.$H={}),ib.$H.ShowFeedback=this.$.isFeedbackEnabled,this.zRa[ia]=ib.$H):ib.$H&&(this.zRa[ia]=ib.$H);ia={};ia[Gi.a.pg]=Ld;Hd={};Hd.solutionId=Ld.SolutionId;Hd.version=Ld.Version;Hd.storeType=Ld.StoreType;Hd.storeId=Ld.StoreId;Hd.assetId=Ld.AssetId;Hd.assetStoreId=Ld.AssetStoreId;Hd.height=Ld.Height;Hd.targetType=Ld.TargetType;Hd.width=Ld.Width;Hd.isAddinCommands=
!Lb;ia[Ug.a.Yra]=Hd;Nc||(Nc=new kf);Nc.focusOnIframeWhenLoaded=ib.focusOnIframeWhenLoaded;Nc.width=ib.taskPaneWidth;ia[kf.key]=Nc;ia[gh.a.fea]=Vc;return this.insertAgave(ia,H)};Pa.prototype.Uai=function(H,ia,ib,Lb,Nc){function Vc(uf){af.ULS.sendTraceTag(537170440,220,50,"Insert addincommands for {0} from {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(uf.solutionId,uf.storeType,uf.assetId,null,null,uf.storeId),uf.storeType);var og={},dh=new Kg.a;dh.add(uf);og[Ug.a.tnb]=dh;og[Ug.a.ZT]=3;uf=new Lk.a(kj.a.nBb,
0,Ld.$.Xc,0,null);return Ld.$.Ka.Wb(uf,og)}function Hd(uf,og){var dh=uf.SolutionId;var th=OSF.OsfControl.isFirstPartyStoreString(uf.StoreType);th&&uf.SourceLocationOverrideResourceId&&(dh=Ld.Je.$2a(dh,uf.SourceLocationOverrideResourceId));var Ki=Ld.Je.exe(dh,null,uf.SharedRuntimeId);th&&(Fg.EwaSettings.ma(296)&&Ki&&(th=Ld.Je.waa(dh))&&(dh=null,dh=Ld.Mvd(Ld.Je.tZ(th).OsfPropertyBag,uf.SolutionId),(th=Ld.Je.Ei.getOsfControl(th))&&th.setSettings(dh)),uf.SharedRuntimeId&&Ki||Ld.Je.Ei.refreshOsfControl(uf.SolutionId,
uf.SourceLocationOverrideResourceId));if(!Ki){var xh=Ld.$.na.va.hc(),ui=519;Ki=function(Ai,Oj,pj){var tj=Ld.$.na.va;Ai=Ue.b(Ai,Ld.CGf);var Yj=tj.Na(9,xh);Yj.sharedInfo=uf;return Zc.i(tj,"InsertAgaveTaskpane",Yj,Ai,Oj,pj,Lb,0)};void 0===uf.IsToBePersisted||null===uf.IsToBePersisted||uf.IsToBePersisted||(ui=538,Ki=function(Ai,Oj,pj){af.ULS.sendTraceTag(537170442,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",uf.StoreType,uf.StoreId,Telemetry.PrivacyRules.GetPrivacyCompliantId(uf.SolutionId,
uf.StoreType,uf.AssetId,null,null,uf.StoreId));var tj=Ld.$.na.va;Ai=Ue.b(Ai,Ld.CGf);var Yj=tj.Na(9,void 0===xh?null:xh);Yj.sharedInfo=uf;return Zc.i(tj,"ShowAgaveTaskpane",Yj,Ai,Oj,pj,Lb,0)});return Fg.EwaSettings.qc()?(Nc|=64,Lh.a(Ld.$.userOperationManager,Ki,function(Ai){return new tc.a(ui,0,Ai,Nc)},og)):Lh.a(Ld.$.userOperationManager,Ki,function(Ai){return new Mb.a(ui,0,Ai,Nc)},og)}return Nh.TaskExtensions.G4()}var Ld=this;if(!Fg.EwaSettings.ma(54)||H.StoreId===OSF.StoreType.FirstParty)return Hd(H,
ib,Lb);if(ia.isAddinCommands)return Vc(ia);var Be=new yk.a,df={};df.marketplaceId=H.SolutionId;df.marketplaceVersion=H.Version;df.storeType=H.StoreType;df.storeId=H.StoreId;df.targetData=H;Fg.EwaSettings.ma(94)&&(df.clearCache=!0);this.Je.Ei.isAddinCommandsAsync(df,function(uf,og,dh){Be.setResult(og);uf||(uf=dh.targetData,af.ULS.sendTraceTag(537170438,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",Telemetry.PrivacyRules.GetPrivacyCompliantId(uf.SolutionId,uf.StoreType,
uf.AssetId,null,null,uf.StoreId),uf.StoreType))});return Nh.TaskExtensions.ts(Be.task,function(uf){return uf.result?Vc(ia):Hd(H,ib,Lb)},this.$.la)};Pa.prototype.Mvd=function(H,ia){if(!this.zRa[ia])return H;var ib={};if(H){H=Gl(H);for(var Lb=H.next();!Lb.done;Lb=H.next())Lb=Lb.value,ib[Lb[0]]=Lb[1]}H=this.zRa[ia];Lb=Gl(Object.keys(H));for(ia=Lb.next();!ia.done;ia=Lb.next())ia=ia.value,ia===Pa.Lxh&&Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?ib[ia]=
Sys.Serialization.JavaScriptSerializer.serialize(H[ia]):ib[ia]=Sys.Serialization.JavaScriptSerializer.serialize(H[ia].toString());ia=Object.keys(ib).length;H=Array(ia);Lb=0;var Nc=Gl(Object.keys(ib));for(ia=Nc.next();!ia.done;ia=Nc.next())ia=ia.value,H[Lb]=[ia,ib[ia].toString()],Lb++;return H};Pa.prototype.Fti=function(H,ia,ib){var Lb=this.$.ya.UserSessionId,Nc=this.$.ya.UICultureTag,Vc=this.$.ya.UICultureTagLcid,Hd=this.$.ya.WacHostId,Ld="",Be="";5<=ib.length&&(Ld=ib[3],Be=ib[4]);this.Gti(Ld,Be,
H,ia,Nc,Vc,Lb,Hd)};Pa.prototype.Gti=function(H,ia,ib,Lb,Nc,Vc,Hd,Ld){var Be={};Be.a=Hd;Be.b=ib;Be.c=Lb;Be.d=H;Be.e=ia;Be.f=Nc;Be.g=Vc;Be.h=Ld;Ch.b().Pe(36,Be)};Pa.prototype.lwe=function(){if(ig.a.fsf())af.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.GGf);return}catch(H){af.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(H?H.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,
null)().then(this.GGf)}catch(H){af.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(H?H.toString():null))}}};Pa.prototype.XLd=function(H,ia,ib,Lb,Nc,Vc){ia=void 0===ia?null:ia;ib=void 0===ib?!1:ib;Lb=void 0===Lb?null:Lb;Nc=void 0===Nc?null:Nc;Vc=void 0===Vc?!0:Vc;var Hd=H.SolutionId,Ld=Lj.Task.Sa(!1);H&&Hd&&H.SharedRuntimeId&&(Lb=Lb||new Lk.a(-859308420,0,2,0,""),Hd={},Hd.solutionId=H.SolutionId,Hd.version=H.Version,Hd.storeType=H.StoreType,Hd.storeId=H.StoreId,Hd.assetId=H.AssetId,
Hd.assetStoreId=H.AssetStoreId,Hd.height=H.Height,Hd.targetType=H.TargetType,Hd.width=0,Hd.isAddinCommands=!1,Hd.sharedRuntimeId=H.SharedRuntimeId,H.Preload=Vc,Nc=Nc?Nc:new kf,Nc.width=0,ia&&(Nc.focusOnIframeWhenLoaded=ia.focusOnIframeWhenLoaded,Vc=new Cb,ia.Yk&&(Vc.zzc=ia.Yk),0<ia.taskPaneWidth&&(Vc.xu=ia.taskPaneWidth),ia.yS&&(Vc.xzc=ia.yS),this.nad[H.SolutionId]=Vc),ia={},ia[Gi.a.pg]=H,ia[Ug.a.Yra]=Hd,ia[kf.key]=Nc,ia[gh.a.fea]=ib,Ld=this.insertAgave(ia,Lb));return Ld};Pa.prototype.kNa=function(H,
ia,ib,Lb){Lb=void 0===Lb?null:Lb;if(H&&ia){H=new Zg.a(H,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");var Nc=new xg.a("ExcelOnline","Web",this.$.ya.UICultureTag),Vc=new ih.a;Vc.optionalProperties[Zd.gTc]=ib;Lb&&(ib=Lb,ib.sourceLocationOverrideResourceId&&(Vc.optionalProperties[Zd.sourceLocationOverrideResourceId]=ib.sourceLocationOverrideResourceId),ib.Yk&&(Vc.optionalProperties[Zd.Yk]=ib.Yk),ib.Rk&&(Vc.optionalProperties.IconCssClass=ib.Rk),ib.vUd&&(Vc.optionalProperties.TaskPaneIconUrl=ib.vUd),
ib.yS&&(Vc.optionalProperties.TaskPaneIconId=ib.yS));rg.a.instance.kNa(H,Dk.a.action,ia,Nc,Vc)}};Pa.prototype.nSh=function(H){if(!qe.a.Fh(H)){var ia=H[Zi.a.T8b];if(ia&&(ia=ia.getId(),H=H[Zi.a.Jya],ia&&H))return this.$2a(ia,H.optionalProperties[Zd.sourceLocationOverrideResourceId])}return null};Pa.prototype.$2a=function(H,ia){ia=void 0===ia?null:ia;return H&&ia?String.format("{0}.{1}",H,ia):H};Pa.prototype.SJh=function(H){switch(H){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return Fg.EwaSettings.ma(235)?
1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}};Pa.z6h="Microsoft.Office.Excel.IdeasXLOPreload";Pa.JBd="IDS";Pa.U6e="FA000000012";Pa.mLa="FA000000005";Pa.D4h="HelloWorld";Pa.LVg="FA000000014";Pa.E3e="Help.GiveFeedback.Url";Pa.Lxh="feedback";Pa.Rjf="FA000000066";Pa.zYi="PowerBi.Url";Pa.xYi="PowerBi.DevUrl";Pa.yYi="FA000000054";Pa.eBi="FA000000064";Pa.KTi="FA000000075";Pa.u0i="FA000000080";Pa.$Vc="AnalyzeDataTaskPane";Pa.J4i="RecommendedChartsTaskPane";
Pa.NWi="PivotTableTaskPane";Pa.$bh=350;Pa.u8e=320;Pa.v0i=320;Object(fe.a)(Pa,"AgaveCommandManager",zk.a,[501,502]);Ck.Object.defineProperties(mb,{instance:{configurable:!0,enumerable:!0,get:function(){return mb.Ma}}});mb.Ma=new mb;Object(fe.a)(mb,"AppsDataManagerFactory",null,[]);Object(fe.a)(eb,"AppsDataProvider",null,[344]);var mi=qg.a;Wl(Ra,mi);Ra.prototype.create=function(){var H=this,ia=this.$.da,ib=hj.GetServiceTaskFactory.create(ia,106,this.la,this.vb),Lb=hj.GetServiceTaskFactory.create(ia,
104,this.la,this.vb),Nc=ek.a.loadScript(36,0,this.vb,void 0,void 0,375);Nh.TaskExtensions.Ba(Nh.TaskExtensions.te([Lb,ib,Nc],this.la),function(){var Vc=new gc(Fk.a.instance),Hd=new eb(ag.AFrameworkApplication.fa,ag.AFrameworkApplication.Jd,"WAC_Excel");new nc(Vc,Hd,"PreinstalledAppsData_Excel");Vc=null;Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(Vc=Yd.a.instance.kc("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);cc.instance.initialize(ib.result);
Vc=new Pa(H.$,ib.result,Lb.result,Vc,ag.AFrameworkApplication.Ib);ia.Ga(206,Vc);H.Eb(ia.za(374)||ia.Ga(374,Vc))},this.la,3);Yd.a.instance.register(Bd.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").Hc().Oc(function(){return new Bd.a(H.$.jw)})};Ra.ka=function(H){H.da.Ga(375,new Ra(H))};Object(fe.a)(Ra,"AgaveCommandManagerFactory",qg.a,[]);var $i=b(623);$a.prototype.initialize=function(H){Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",
!1)&&!this.initialized&&this.vhj(H)};$a.prototype.zai=function(H,ia){var ib=Nh.TaskExtensions.sk();if(this.initialized&&H&&0<H.length){var Lb=this.SGh(H);H in this.yU&&(ib=this.agaveCommandManager.insertAgave(Lb,ia))}return ib};$a.prototype.wzg=function(H){var ia=this;this.initialized&&(H=H[Gi.a.pg]||{},!H.SolutionId||H.SolutionId in this.yU||this.Je.Uca(function(ib){ia.Uca(ib)},!0))};$a.prototype.w2h=function(H){var ia=this;this.initialized&&(H=H||"")&&0<H.length&&H in this.yU&&(delete this.yU[H],
this.Je.Uca(function(ib){ia.Uca(ib)},!0))};$a.prototype.SGh=function(H){return H in this.yU?this.yU[H]:{}};$a.prototype.Uca=function(H){var ia=!1;if(H&&!H.errorCode){if(H.value){H=Gl(H.value);for(var ib=H.next();!ib.done;ib=H.next()){ib=ib.value;var Lb=ib[1];ib[3]==OSF.OsfControlTarget.InContent&&Lb&&0<Lb.length&&!(Lb in this.yU)&&(ia={NoReporting:!1,IsSystemInitiated:!1},ia.description=ib[2],ia.iconUrl=ib[9],ia[Ug.a.Yra]={solutionId:ib[1],version:ib[4],storeType:ib[12],storeId:ib[11],assetId:ib[5],
assetStoreId:ib[6],targetType:ib[3],width:ib[7],height:ib[8],displayName:ib[0],id:ib[1]},ia[Gi.a.pg]={SolutionId:ib[1],Version:ib[4],StoreType:ib[12],StoreId:ib[11],AssetId:ib[5],AssetStoreId:ib[6],TargetType:ib[3],Width:ib[7],Height:ib[8],Id:ib[1]},this.yU[Lb]=ia,ia=!0)}}ia&&this.L4g()}};$a.prototype.L4g=function(){var H=[],ia;for(ia in this.yU)H.push({id:ia,controlType:0,title:this.yU[ia][Ug.a.Yra].displayName});if(0<H.length){for(var ib in this.yU)appChrome.addInApi.registerAddinIcon("AddinIcon_"+
ib,this.yU[ib].iconUrl);this.XWg();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:$a.msf,isOfficeTab:!0,groups:[{id:$a.x$e,title:$a.y$e,controls:H}]}]});for(var Lb in this.yU)this.V_a.addCommandToMaps(Object(Kf.a)(new tk.a(Lb,"-1473679467"),{legacyControlId:Lb}))}};$a.prototype.XWg=function(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:$a.msf,isOfficeTab:!0,groups:[{id:$a.x$e,title:$a.y$e,controls:[]}]}]})};$a.prototype.vhj=function(H){var ia=this,ib=hj.GetServiceTaskFactory.Xa(H.da,
374,375,1),Lb=hj.GetServiceTaskFactory.create(H.da,106,H.la,1);Nh.TaskExtensions.Ba(Nh.TaskExtensions.te([ib,Lb],H.la),function(){ia.agaveCommandManager=ib.result;ia.V_a=Yd.a.instance.Lh("Common.IExternalUICommandDefinitionMapping")||new $i.a(H.Mb,H);ag.AFrameworkApplication.Ib.fc(kj.a.KNf,Ed.a.frame,function(Nc,Vc,Hd,Ld,Be){ia.w2h(Be)});ia.Je=Lb.result;ia.Je.Uca(function(Nc){ia.Uca(Nc)},!0);ia.initialized=!0},H.la,3)};$a.msf="tabinsert";$a.x$e="installedContentAddins";$a.y$e=K.a.instance.ga(2242);
Object(fe.a)($a,"AgaveCommandRibbon",null,[500]);var bj=qg.a;Wl(la,bj);la.prototype.create=function(){if(Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)){var H=this.$.da,ia=new $a;ia.initialize(this.$);this.Eb(H.za(488)||H.Ga(488,ia))}};la.ka=function(H){H.da.Ga(489,new la(H))};Object(fe.a)(la,"AgaveCommandRibbonFactory",qg.a,[]);var ai=b(942);va.prototype.getTypeName=function(){return"Microsoft.Authentication.OfficeIdentityInfo"};va.prototype.invokePropertyGet=
function(H){switch(H){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};va.prototype.invokePropertyGetAsync=function(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};va.prototype.invokePropertySet=function(H,ia){switch(H){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,
0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};va.prototype.invokePropertySetAsync=function(H,ia){this.invokePropertySet(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
va.prototype.invokeMethod=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};va.prototype.invokeMethodAsync=function(H,ia){H=this.invokeMethod(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};va.X5g=function(H){var ia=new va;ia.displayName=H.displayName;ia.email=H.email;switch(H.authority){case eg.GDf:ia.identityType=1;break;default:ia.identityType=0}ia.federationProvider="";return ia};Ck.Object.defineProperties(va.prototype,{displayName:{configurable:!0,
enumerable:!0,get:function(){return this.ifa},set:function(H){this.ifa=H}},email:{configurable:!0,enumerable:!0,get:function(){return this.d5d},set:function(H){this.d5d=H}},federationProvider:{configurable:!0,enumerable:!0,get:function(){return this.K5d},set:function(H){this.K5d=H}},identityType:{configurable:!0,enumerable:!0,get:function(){return this.Mib},set:function(H){this.Mib=H}}});Object(fe.a)(va,"OfficeIdentityInfo",null,[]);Tb.Nac=function(H){return H in Tb.BLe?Tb.BLe[H].toString():H};Ck.Object.defineProperties(Tb,
{BLe:{configurable:!0,enumerable:!0,get:function(){return Tb.lng}}});Tb.map=null;var Ii={};Tb.lng=(Ii.GeneralException=ai.a.generalException,Ii.AccessDenied=ai.a.cTc,Ii.ApiNotAvailable=ai.a.apiNotAvailable,Ii.UserNotSignedIn=ai.a.userNotSignedIn,Ii.UserAborted=ai.a.userAborted,Ii.UnsupportedUserIdentity=ai.a.bOj,Ii.InvalidResourceUrl=ai.a.invalidResourceUrl,Ii.InvalidGrant=ai.a.invalidGrant,Ii.AddinIsAlreadyRequestingToken=ai.a.cHg,Ii.ResourceNotAllowed=ai.a.qfj,Ii.ClientError=ai.a.clientError,Ii.ServerError=
ai.a.serverError,Ii);Object(fe.a)(Tb,"SingleSignOnErrorCodeMap",null,[]);tb.prototype.getTypeName=function(){return"Microsoft.Authentication.SingleSignOnToken"};tb.prototype.invokePropertyGet=function(H){switch(H){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};tb.prototype.invokePropertyGetAsync=function(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};tb.prototype.invokePropertySet=
function(H,ia){switch(H){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};tb.prototype.invokePropertySetAsync=function(H,ia){this.invokePropertySet(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};tb.prototype.invokeMethod=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
};tb.prototype.invokeMethodAsync=function(H,ia){H=this.invokeMethod(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};Ck.Object.defineProperties(tb.prototype,{accessToken:{configurable:!0,enumerable:!0,get:function(){return this.XPb},set:function(H){this.XPb=H}},tokenIdenityType:{configurable:!0,enumerable:!0,get:function(){return this.Mib},set:function(H){this.Mib=H}}});Object(fe.a)(tb,"SingleSignOnToken",null,[]);Ya.prototype.getTypeName=function(){return"Microsoft.Authentication.TokenParameters"};
Ya.prototype.invokePropertyGet=function(H){switch(H){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};Ya.prototype.invokePropertyGetAsync=function(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};Ya.prototype.invokePropertySet=function(H,ia){switch(H){case 3:this.authChallenge=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"string");return;case 6:this.silentLogin=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};Ya.prototype.invokePropertySetAsync=function(H,ia){this.invokePropertySet(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};Ya.prototype.invokeMethod=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};Ya.prototype.invokeMethodAsync=function(H,ia){H=this.invokeMethod(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};
Ck.Object.defineProperties(Ya.prototype,{authChallenge:{configurable:!0,enumerable:!0,get:function(){return this.y1d},set:function(H){this.y1d=H}},correlationId:{configurable:!0,enumerable:!0,get:function(){return this.JD},set:function(H){this.JD=H}},policy:{configurable:!0,enumerable:!0,get:function(){return null},set:function(){}},resource:{configurable:!0,enumerable:!0,get:function(){return this.FVb},set:function(H){this.FVb=H}},scope:{configurable:!0,enumerable:!0,get:function(){return this.hfe},
set:function(H){this.hfe=H}},silentLogin:{configurable:!0,enumerable:!0,get:function(){return this.sge},set:function(H){this.sge=H}}});Object(fe.a)(Ya,"TokenParameters",null,[576]);Ia.prototype.getAccessToken=function(H){var ia=this,ib=this.ihb.getOsfControl(this.rA),Lb=ib.getManifest(),Nc=Lb.getMarketplaceID();this.FNa(H,Nc);return OfficeExtension.WacRuntime.Utility.createPromise(function(Vc,Hd){ib.isFirstParty()&&ia.ihb._enableFirstPartySSO?ia.wdi(Lb,H)?Yd.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(H,
Nc).then(function(Ld){Vc(Ld)},function(Ld){Hd(Ld)}):Hd(ai.a.cTc):Hd(ai.a.apiNotAvailable)}).then(function(Vc){switch(Vc.authority){case eg.GDf:var Hd=1;break;default:Hd=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new tb(Vc.accessToken,Hd))},function(Vc){ia.logErrorResponse(H,Nc,Vc);return Vc?OfficeExtension.WacRuntime.Utility.createPromise(function(Hd,Ld){Ld(OfficeExtension.WacRuntime.Utility.createRichApiException(Vc,Tb.Nac(Vc)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(Hd,
Ld){Ld(OfficeExtension.WacRuntime.Utility.createRichApiException(ai.a.generalException,Tb.Nac(ai.a.generalException)))})})};Ia.prototype.getAuthContext=function(){return null};Ia.prototype.getPrimaryIdentityInfo=function(){var H=this.ihb.getOsfControl(this.rA);H.getManifest();var ia=H.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise(function(ib,Lb){Yd.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(ia).then(function(Nc){ib(Nc)},
function(Nc){Lb(Nc.toString())})}).then(function(ib){ib=va.X5g(ib);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ib)},function(ib){return ib?OfficeExtension.WacRuntime.Utility.createPromise(function(Lb,Nc){Nc(OfficeExtension.WacRuntime.Utility.createRichApiException(ib,Tb.Nac(ib)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(Lb,Nc){Nc(OfficeExtension.WacRuntime.Utility.createRichApiException(ai.a.generalException,Tb.Nac(ai.a.generalException)))})})};Ia.prototype.getTypeName=
function(){return"Microsoft.Authentication.AuthenticationService"};Ia.prototype.invokePropertyGet=function(H){switch(H){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};Ia.prototype.invokePropertyGetAsync=function(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};Ia.prototype.invokePropertySet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};Ia.prototype.invokePropertySetAsync=
function(H,ia){this.invokePropertySet(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};Ia.prototype.invokeMethod=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};Ia.prototype.invokeMethodAsync=function(H,ia){switch(H){case 1:return this.iGh(ia);case 3:return this.AHh();case 2:return this.pTh()}H=this.invokeMethod(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};Ia.prototype.iGh=function(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,
0,Ya);return this.getAccessToken(H)};Ia.prototype.AHh=function(){return this.getAuthContext()};Ia.prototype.pTh=function(){return this.getPrimaryIdentityInfo()};Ia.prototype.wdi=function(H,ia){var ib=!1,Lb=H.getWebApplicationAuthorizations();H=null;Lb=Gl(Lb);for(var Nc=Lb.next();!Nc.done;Nc=Lb.next())if(Nc=Nc.value,Nc.getResource().toLowerCase()===ia.resource.toLowerCase()){H=Nc;ib=!0;break}if(!ib)return!1;ia=ia.scope.split(" ,+");ia=Gl(ia);for(ib=ia.next();!ib.done;ib=ia.next())if((ib=ib.value)&&
ib.length){Lb=!1;Nc=Gl(H.getScopes());for(var Vc=Nc.next();!Vc.done;Vc=Nc.next())ib.toLowerCase()===Vc.value.toLowerCase()&&(Lb=!0);if(!Lb)return!1}return!0};Ia.prototype.FNa=function(H,ia){H=this.Yrf(H.resource);var ib={};af.ULS.sendTraceTag(538572831,369,50,"{0}",(ib.manifestId=ia,ib.resource=H,ib))};Ia.prototype.logErrorResponse=function(H,ia,ib){H=this.Yrf(H.resource);var Lb={};af.ULS.sendTraceTag(538572830,369,10,"{0}",(Lb.manifestId=ia,Lb.resource=H,Lb.error=ib,Lb))};Ia.prototype.Yrf=function(H){return H.replace("://",
"__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Ck.Object.defineProperties(Ia.prototype,{roamingSettings:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(fe.a)(Ia,"AuthenticationService",null,[]);La.prototype.create=function(H,ia){return new Ia(H,ia)};Object(fe.a)(La,"AuthenticationServiceFactory",null,[]);var cj=b(1057),gi=b(1167),Oh=b(1151);za.generalException="generalException";za.invalidArgument="invalidArgument";za.notAllowed="notAllowed";za.apiNotAvailable="apiNotAvailable";
za.unresolvedPendingRequest="unresolvedPendingRequest";za.timeout="timeout";za.adalTimeout="adalTimeout";za.userNotSignedIn="userNotSignedIn";za.userAborted="userAborted";za.silentSignInFailed="silentSignInFailed";za.invalidResourceUrl="invalidResourceUrl";za.invalidGrant="invalidGrant";za.connectionLost="connectionLost";za.clientError="clientError";za.serverError="serverError";Object(fe.a)(za,"WopiHostErrorCodes",null,[]);Object(fe.a)(ka,"OAuthCallerMetadata",null,[]);Ea.prototype.Iyg=function(H,
ia,ib,Lb,Nc,Vc){var Hd=this;if(!this.Hxa)return Lb=new gi.a,Lb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(Lb);var Ld=new ka;Ld.AddinName=Nc;Ld.AddinTrustId=Vc;var Be=-1;Vc=null;if(Lb&&this.odf())Vc=this.Hxa.o$f(Ug.a.Nzc,H,Lb,Ea.A0e(Nc),Ld);else{var df=Date.now();Vc=this.Hxa.FS(Ug.a.Nzc,H,Ld).then(function(uf){Be=Date.now()-df;var og=(ia||ib)&&"login_required"===uf.ErrorCode;return(ia&&("interaction_required"===uf.ErrorCode||"consent_required"===uf.ErrorCode||"invalid_grant"===
uf.ErrorCode)||og)&&Hd.odf()?Hd.Hxa.o$f(Ug.a.Nzc,H,null,Ea.A0e(Nc),Ld):Promise.resolve(uf)})}return Vc.then(function(uf){var og=new gi.a;uf.IsSuccess?(og.token=uf.Token,uf.Telemetry&&(og.WSa=uf.Telemetry.fromCache,og.expiresOn=uf.Telemetry.expiresOn)):(og.errorCode=Hd.Xwi(uf),og.DUd=Hd.YUi(uf));return og}).catch(function(){var uf=new gi.a;uf.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(uf)}).then(function(uf){uf.iha="OauthManager";0<=Be&&(uf.ewb=Be);return uf})};
Ea.prototype.Tfi=function(H){var ia=(ag.AFrameworkApplication.fa.Va(ag.AFrameworkApplication.rea)||"").toLowerCase();return(hb.a.dxa||"teams"===ia&&Zj.a.lxb)&&!Ea.wfi(H)||!this.Hxa||!this.Hxa.C5a()?!1:!0};Ea.prototype.odf=function(){return this.cng||1!==Oh.a.T$b()};Ea.prototype.Xwi=function(H){switch(H.ErrorCode){case "UserCancelled":case "interaction_required":H=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":H=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;
break;case "login_required":H=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":H=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":H=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":H=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:H=H.ErrorCode===za.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:H.ErrorCode===
za.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:H.ErrorCode===za.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:H.ErrorCode===za.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:H.ErrorCode===za.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return H};Ea.prototype.YUi=function(H){var ia="";(H=RegExp("AADSTS(\\d+)").exec(H.ErrorMessage))&&
1<H.length&&(ia=H[1]);return ia};Ea.A0e=function(H){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,H)};Ea.wfi=function(H){if(!H)return!1;H=H.toLowerCase();for(var ia=Gl(cj.AppsForOfficeSingleSignOnManager.bTe),ib=ia.next();!ib.done;ib=ia.next())if(ib.value===H)return!0;return!1};Object(fe.a)(Ea,"AppsforOfficeTokenFromOauthManager",null,[60]);qa.Boa=function(){if(ag.AFrameworkApplication.fa.ra("AppForOfficeSSOV2IsEnabled")){var H=null;try{H=Yd.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(ia){af.ULS.sendTraceTag(592061330,
1300,10,"Unable to resolve IOAuthManager: "+ia)}H=new Ea(H);qa.Ma=new qa(H)}};qa.getInstance=function(){qa.D7d||(qa.Boa(),qa.D7d=!0);return qa.Ma};qa.Ma=null;qa.D7d=!1;Object(fe.a)(qa,"AppsForOfficeOauthManagerFactory",null,[42]);var bi=b(135);Object(fe.a)(oa,"NewDocumentParameters",null,[]);var ti=b(179);ta.prototype.createAndOpenWorkbook=function(H){var ia=this;if(H&&H.length>this.Lrg)throw af.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",H.length),OfficeExtension.WacRuntime.Utility.createRichApiException(ai.a.invalidArgument,
ti.a.ga(1741));var ib=new oa("blank","agave",H?"streamBase64":"streamEmpty",H),Lb=null;return OfficeExtension.WacRuntime.Utility.createPromise(function(Nc,Vc){var Hd=new bi.StandardDialog;Hd.ic=4;Hd.Ak(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(Ld){2===Ld||0===Ld?Vc("Cancelled"):(Lb=window.open(""),ia.hsg.create(Nc,Vc,ib).v0a())})}).then(function(Nc){if(!Nc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(ai.a.generalException,
ti.a.ga(1737));try{Lb.top.location.href=Nc}catch(Vc){af.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",hb.a.lp,Vc),af.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),Lb.location.replace(Nc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},function(Nc){if("Cancelled"===Nc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(ai.a.NBd,
ti.a.ga(1740));Lb.close();ia.hHj();return null})};ta.prototype.getTypeName=function(){return"Microsoft.ExcelServices.WacWorkbook"};ta.prototype.invokePropertyGet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};ta.prototype.invokePropertyGetAsync=function(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};ta.prototype.invokePropertySet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
};ta.prototype.invokePropertySetAsync=function(H,ia){this.invokePropertySet(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ta.prototype.invokeMethod=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};ta.prototype.invokeMethodAsync=function(H,ia){switch(H){case 1:return this.K3g(ia)}H=this.invokeMethod(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};ta.prototype.K3g=function(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,
0,"string");return this.createAndOpenWorkbook(H)};ta.prototype.hHj=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(ai.a.generalException,ti.a.ga(1737));};Object(fe.a)(ta,"WacWorkbook",null,[]);var mh=b(941),bk=b(947);Ck.Object.defineProperties(Y.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.xb}}});Object(fe.a)(Y,"RichApiPreviewExecutionContext",null,[]);var Mh=b(25),kk=b(1075),Sj=b(213),fl=b(215),gl=b(118),fj=b(12),Gj=fl.a;Wl(R,Gj);R.prototype.start=
function(H,ia){var ib="<div class='"+gl.a.Rmh+" "+Si.a.Zo+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+gl.a.GC+"' /></div>";ib=String.format(ib,Bj.a.vg(this.d5c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Qb.innerHTML=ib;this.Gob=fj.DOMElementExtensions.getElementById(this.Qb,"bindingText");H=ia?H.w2a(ia,this.d5c.DdaBindingsMethod.BindingId):null;(null===H||void 0===H?0:H.IsValidRef)?(ia=new Mh.Range(H.Reference.FirstRow+1,
H.Reference.FirstColumn+1,H.Reference.LastRow+1,H.Reference.LastColumn+1,!1,!1),this.Gob.value=H.Reference.SheetName+"!"+ia):(H=vj.g(this.$).ha,this.Gob.value=Dh.f(this.$.qa)||!H.ta.Hg?"":H.jia);this.initialize();this.Af()};R.prototype.Bn=function(){this.W_c();this.addButton(0);this.addButton(1);Gj.prototype.Bn.call(this)};R.prototype.setFocus=function(){fj.DOMElementExtensions.setFocus(this.Gob)};R.prototype.validate=function(){return!0};R.prototype.commit=function(){var H=this.Gob.value.trim(),
ia=H.indexOf("!");-1!==ia&&(H=this.mWh(H.substring(0,ia))+H.substr(ia));this.AFe.addBinding(this.d5c,H,0,this.callback);return!0};R.prototype.Hsa=function(){this.AFe.wQ.wf(mh.a.internalError,this.callback);Gj.prototype.Hsa.call(this)};R.prototype.mWh=function(H){H=Kj.a.trimStart(H.trim(),"=");return H.length?H.startsWith("'")&&H.endsWith("'")?H:Gk.HelperMethods.Z7b(H):""};Ck.Object.defineProperties(R.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"DdaBindingPrompt"}}});Object(fe.a)(R,
"DdaBindingPrompt",fl.a,[]);I.prototype.wf=function(H,ia){if(ia){var ib={};ib.Error=H;ib.Version=this.ea.Te;ia(ib)}};I.prototype.BJa=function(H,ia){this.wf(H,ia)};I.prototype.iH=function(H,ia){this.wf(mh.a.yUe(H.Errors[0].MessageId),ia)};I.prototype.Zu=function(H){H&&H(this.dQ())};I.prototype.dQ=function(){var H={Error:0};H.Version=this.ea.Te;return H};Object(fe.a)(I,"DdaErrorGenerator",null,[]);var dj=b(293),Qi=b(105);G.prototype.Iwd=function(H,ia){function ib(Ld){var Be=Lb.$.xa.getItemByName(Ld.SheetName);
(null===Be||void 0===Be?0:Be.visible)?(vj.g(Lb.$).Gg(Ld,null,null,null,3,Qi.a.fbh,void 0,void 0,void 0,void 0,!0),Lb.wQ.Zu(ia)):Lb.wQ.wf(mh.a.pUg,ia)}var Lb=this,Nc=H.DdaGoToByIdMethod.GoToType,Vc=H.DdaGoToByIdMethod.SelectionMode,Hd=H.DdaGoToByIdMethod.Id.toString().trim();0===Nc?this.VAi(Hd,Vc,H.DdaMethod.ControlId,ib,ia):1===Nc?this.ZAi(Hd,Vc,ib,ia):this.wQ.wf(mh.a.ZNj,ia)};G.prototype.VAi=function(H,ia,ib,Lb,Nc){var Vc=this;this.cA.ddaGetBinding(ib,H,function(Hd){if(!dj.a(Hd)&&Hd.Result&&Hd.Result.Reference){Hd=
Hd.Result;var Ld={};Ld.SheetName=Hd.Reference.SheetName;Ld.FirstRow=Hd.Reference.FirstRow;Ld.FirstColumn=Hd.Reference.FirstColumn;Ld.LastRow=Hd.Reference.LastRow;Ld.LastColumn=Hd.Reference.LastColumn;G.MVc(Ld,ia);1!==Hd.BindingType?Lb(Ld):Vc.cA.ddaGetBindingData(ib,H,1,0,2,0,0,-1,-1,function(Be){dj.a(Be)||!Be.Result?Vc.wQ.iH(Be,Nc):(Be=Be.Result,2!==ia&&(Ld.FirstRow-=Be.Headers.length,0>Ld.FirstRow&&(Ld.FirstRow=0)),Lb(Ld))},Nc)}else Vc.wQ.BJa(mh.a.y4f,Nc)},Nc)};G.prototype.ZAi=function(H,ia,ib,Lb){var Nc=
this,Vc=Jh.z(H);Vc?(Vc=Jh.v(Vc,this.$),G.MVc(Vc,ia),ib(Vc)):this.$.ea.isNamedObjectViewMode&&this.$.Hb.Yj(H)?this.$.Hb.qa=this.$.Hb.getItemByName(H):(Vc=function(Hd){dj.a(Hd)||!Hd.Result?Nc.$.xa.contains(H)?(Hd={},Hd.SheetName=H,Hd.FirstRow=0,Hd.FirstColumn=0,Hd.LastRow=0,Hd.LastColumn=0,ib(Hd)):Nc.wQ.BJa(mh.a.y4f,Lb):(Hd=Hd.Result,G.MVc(Hd,ia),ib(Hd))},this.$.xa.qa?this.cA.parseRangeForGoto(H,this.$.xa.qa.name,Vc,Lb):this.cA.parseRange(H,Vc,Lb))};G.MVc=function(H,ia){H.LastRow=2===ia?H.FirstRow:
H.LastRow;H.LastColumn=2===ia?H.FirstColumn:H.LastColumn};Object(fe.a)(G,"DdaNavigator",null,[]);var wj=b(307),Tj;(function(H){H[H.unsupported=0]="unsupported";H[H.surface=1]="surface";H[H.combo=2]="combo";H[H.column=3]="column";H[H.column3D=4]="column3D";H[H.bar=5]="bar";H[H.bar3D=6]="bar3D";H[H.line=7]="line";H[H.line3D=8]="line3D";H[H.pie=9]="pie";H[H.pie3D=10]="pie3D";H[H.scatter=11]="scatter";H[H.bubble=12]="bubble";H[H.area=13]="area";H[H.area3D=14]="area3D";H[H.doughnut=15]="doughnut";H[H.radar=
16]="radar";H[H.stock=17]="stock";H[H.waterfall=18]="waterfall";H[H.funnel=19]="funnel";H[H.treemap=20]="treemap";H[H.sunburst=21]="sunburst";H[H.boxWhisker=22]="boxWhisker";H[H.histogram=23]="histogram";H[H.pareto=24]="pareto";H[H.regionMap=25]="regionMap";H[H.noVisibleSeries=26]="noVisibleSeries";H[H.complexDataSource=27]="complexDataSource";H[H.pivotChart=28]="pivotChart"})(Tj||(Tj={}));Object(fe.b)("ChartCategory",Tj);Object(fe.a)(aa,"MacroRecorderEventData",null,[]);V.prototype.FUh=function(H){var ia;
if(void 0===H||null===H||void 0===H.RequestBody||null===H.RequestBody)return null;var ib=JSON.parse(H.RequestBody);if(void 0!==H.ActiveChartId&&null!==H.ActiveChartId){ib.ActiveChartId=H.ActiveChartId;var Lb=vj.g(this.$).ha.Oa.nc;if(null===(ia=null===Lb||void 0===Lb?void 0:Lb.floatingObject)||void 0===ia?0:ia.dd)ib.ActiveChartType=Tj[Lb.floatingObject.dd.ChartCategory]}void 0!==H.SheetMultiRange&&null!==H.SheetMultiRange&&(ib.SheetName=H.SheetMultiRange.SheetName);return ib};V.prototype.SUh=function(H){if(void 0===
H||null===H||void 0===H.Result||null===H.Result)return null;H=H.Result;return void 0===H.ResponseBody||null===H.ResponseBody||H.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(H.ResponseBody.join(""))};V.prototype.$ji=function(H){return!!H&&!(void 0===H.eventId||null===H.eventId)&&0<H.eventId.length};V.prototype.oj=function(H){var ia=this;return function(){if(ia.$.Aba){var ib=ia.CQg(ia.request);if(ia.$ji(ib)){var Lb=ia.FUh(ia.request),Nc=ia.SUh(H);if(Lb&&!qe.a.isEmpty(Lb)&&Nc&&!qe.a.isEmpty(Nc))return af.ULS.sendTraceTag(537163164,
0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new Zh(ib,Lb,Nc);ib=String.format("requestInfo: {0}; responseInfo: {1}",Lb?"(not null)":"(null)",Nc?"(not null)":"(null)");af.ULS.sendTraceTag(537163163,0,50,"[RichApiRecorder]: Failed due to bad data: {0}",ib)}}return new Zh(null,null,null)}};V.prototype.CQg=function(H){var ia=this.aki(H.SolutionId),ib=V.mUh(H);if(ib&&ia)return ia={},af.ULS.sendTraceTag(537163162,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,
(ia.recorderEventId=ib,ia["request.SolutionId"]=H.SolutionId,ia)),new aa(H.SolutionId,ib);var Lb={};af.ULS.sendTraceTag(537163161,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(Lb.recorderEventId=ib,Lb.isRecorderAwareAddin=ia,Lb["request.SolutionId"]=H.SolutionId,Lb));return null};V.prototype.aki=function(H){if(!H)return!1;H=H.toLowerCase();return V.g_h().contains(H)};V.g_h=function(){V.tza||(V.tza=new Kh.a(si.a.Qk()),V.tza.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),V.tza.add("fa000000005"),
V.tza.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),V.tza.add("fa000000014"),V.tza.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return V.tza};V.mUh=function(H){var ia=null,ib=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(ib.test(H.RequestBody))ia=ib.exec(H.RequestBody)[1];else{H=H.RequestHeaders;if(!H)return ia;ib=Xh.a.KDi.toLowerCase();for(var Lb=0;Lb<H.length;Lb++)if(H[Lb].Name.toLowerCase()===ib){ia=H[Lb].Value;break}}return ia};V.tza=null;Object(fe.a)(V,"DdaRichApiRequestRecorder",
null,[]);var Ak=b(67),Bk=wj.a;Wl(ba,Bk);ba.prototype.W2=function(H){return Bk.prototype.W2.call(this,H)||this.lTg(H)};ba.prototype.oj=function(){return this.mLd.oj(this.rd)};ba.prototype.ceb=function(){var H={OperationType:3};H.RichApiRequest=this.request;return H};ba.prototype.lTg=function(H){var ia=this;return function(ib,Lb,Nc){return E(H,ia.request,Ue.b(ib,ia.Llb),Ue.a(Lb,ia.cib),Nc,ia.I3)}};Ck.Object.defineProperties(ba.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return Fg.EwaSettings.qc()?
Object(Ak.a)(ba.prototype,this,"operationWorkingState"):2}},kCc:{configurable:!0,enumerable:!0,get:function(){return this.$Ea}},yt:{configurable:!0,enumerable:!0,get:function(){return this.Llb}},qaa:{configurable:!0,enumerable:!0,get:function(){return this.cib}}});Object(fe.a)(ba,"DdaRichApiRequestBatchOperation",wj.a,[]);var Zk=tc.a;Wl(M,Zk);M.prototype.oj=function(){return this.mLd.oj(this.rd)};Ck.Object.defineProperties(M.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return Fg.EwaSettings.qc()?
Object(Ak.a)(M.prototype,this,"operationWorkingState"):0}}});Object(fe.a)(M,"DdaRichApiRequestOperation",tc.a,[]);Q.prototype.ddaAddBinding=function(H,ia,ib,Lb,Nc,Vc,Hd){var Ld=this;this.LJ(function(Be,df,uf){var og=Ld.$.na.va,dh=Ld.oja();Be=Ue.b(Be,Vc);df=Ue.a(df,Ld.eI);var th=og.Na(9);th.controlId=H;th.bindingId=ia;th.bindingType=ib;th.currentSheetName=dh;th.formula=Lb;th.options=Nc;return Zc.i(og,"DdaAddBinding",th,Be,df,uf,Hd,0)},Hd,563)};Q.prototype.ddaReleaseBinding=function(H,ia,ib,Lb){var Nc=
this;this.LJ(function(Vc,Hd,Ld){var Be=Nc.$.na.va;Vc=Ue.b(Vc,ib);Hd=Ue.a(Hd,Nc.eI);var df=Be.Na(9);df.controlId=H;df.bindingId=ia;return Zc.i(Be,"DdaReleaseBinding",df,Vc,Hd,Ld,Lb,0)},Lb,564)};Q.prototype.ddaGetBinding=function(H,ia,ib,Lb){var Nc=this;this.LJ(function(Vc,Hd,Ld){var Be=Nc.$.na.va;Vc=Ue.b(Vc,ib);Hd=Ue.a(Hd,Nc.eI);var df=Be.Na(1);df.controlId=H;df.bindingId=ia;return Zc.i(Be,"DdaGetBinding",df,Vc,Hd,Ld,Lb,0)},Lb,565,16)};Q.prototype.ddaGetAllBindings=function(H,ia,ib){var Lb=this;this.LJ(function(Nc,
Vc,Hd){var Ld=Lb.$.na.va;Nc=Ue.b(Nc,ia);Vc=Ue.a(Vc,Lb.eI);var Be=Ld.Na(1);Be.controlId=H;return Zc.i(Ld,"DdaGetAllBindings",Be,Nc,Vc,Hd,ib,0)},ib,566,16)};Q.prototype.ddaGetBindingData=function(H,ia,ib,Lb,Nc,Vc,Hd,Ld,Be,df,uf){var og=this;this.LJ(function(dh,th,Ki){var xh=og.$.na.va,ui=og.oja();dh=Ue.b(dh,df);th=Ue.a(th,og.eI);var Ai=xh.Na(1);Ai.controlId=H;Ai.bindingId=ia;Ai.coerceType=ib;Ai.valueFormat=Lb;Ai.filterType=Nc;Ai.startRow=Vc;Ai.startCol=Hd;Ai.rowCount=Ld;Ai.colCount=Be;Ai.currentSheetName=
ui;return Zc.i(xh,"DdaGetBindingData",Ai,dh,th,Ki,uf,0)},uf,567,16)};Q.prototype.ddaSetBindingData=function(H,ia,ib,Lb,Nc,Vc,Hd){var Ld=this;this.LJ(function(Be,df,uf){var og=Ld.$.na.va,dh=Ld.oja();Be=Ue.b(Be,Vc);df=Ue.a(df,Ld.eI);var th=og.Na(9);th.controlId=H;th.bindingId=ia;th.startRow=ib;th.startCol=Lb;th.currentSheetName=dh;th.bindingData=Nc;return Zc.i(og,"DdaSetBindingData",th,Be,df,uf,Hd,0)},Hd,568)};Q.prototype.ddaGetSelectedData=function(H,ia,ib,Lb,Nc,Vc,Hd){var Ld=this;this.LJ(function(Be,
df,uf){var og=Ld.$.na.va,dh=Ld.oja();Be=Ue.b(Be,Vc);df=Ue.a(df,Ld.eI);var th=og.Na(1);th.controlId=H;th.coerceType=ia;th.valueFormat=ib;th.filterType=Lb;th.currentSheetName=dh;th.formula=Nc;return Zc.i(og,"DdaGetSelectedData",th,Be,df,uf,Hd,0)},Hd,569,16)};Q.prototype.ddaSetSelectedData=function(H,ia,ib,Lb,Nc){var Vc=this;this.LJ(function(Hd,Ld,Be){var df=Vc.$.na.va,uf=Vc.oja();Hd=Ue.b(Hd,Lb);Ld=Ue.a(Ld,Vc.eI);var og=df.Na(9);og.controlId=H;og.currentSheetName=uf;og.formula=ia;og.bindingData=ib;return Zc.i(df,
"DdaSetSelectedData",og,Hd,Ld,Be,Nc,0)},Nc,570)};Q.prototype.ddaLoadSettings=function(H,ia,ib){var Lb=this;this.LJ(function(Nc,Vc,Hd){var Ld=Lb.$.na.va;Nc=Ue.b(Nc,ia);Vc=Ue.a(Vc,Lb.eI);var Be=Ld.Na(1);Be.controlId=H;return Zc.i(Ld,"DdaLoadSettings",Be,Nc,Vc,Hd,ib,0)},ib,501,16)};Q.prototype.ddaSaveSettings=function(H,ia,ib,Lb,Nc){var Vc=this;this.LJ(function(Hd,Ld,Be){var df=Vc.$.na.va;Hd=Ue.b(Hd,Lb);Ld=Ue.a(Ld,Vc.eI);var uf=df.Na(9);uf.controlId=H;uf.settings=ia;uf.overwriteIfStale=ib;return Zc.i(df,
"DdaSaveSettings",uf,Hd,Ld,Be,Nc,0)},Nc,571)};Q.prototype.ddaAddRowsColumns=function(H,ia,ib,Lb,Nc,Vc){var Hd=this;this.LJ(function(Ld,Be,df){var uf=Hd.$.na.va,og=Hd.oja();Ld=Ue.b(Ld,Nc);Be=Ue.a(Be,Hd.eI);var dh=uf.Na(9);dh.controlId=H;dh.bindingId=ia;dh.isRow=ib;dh.currentSheetName=og;dh.bindingData=Lb;return Zc.i(uf,"DdaAddRowsColumns",dh,Ld,Be,df,Vc,0)},Vc,572)};Q.prototype.ddaDeleteAllDataValues=function(H,ia,ib,Lb){var Nc=this;this.LJ(function(Vc,Hd,Ld){var Be=Nc.$.na.va,df=Nc.oja();Vc=Ue.b(Vc,
ib);Hd=Ue.a(Hd,Nc.eI);var uf=Be.Na(9);uf.controlId=H;uf.bindingId=ia;uf.currentSheetName=df;return Zc.i(Be,"DdaDeleteAllDataValues",uf,Vc,Hd,Ld,Lb,0)},Lb,573)};Q.prototype.ddaClearBindingFormats=function(H,ia,ib,Lb){var Nc=this;this.LJ(function(Vc,Hd,Ld){var Be=Nc.$.na.va,df=Nc.oja();Vc=Ue.b(Vc,ib);Hd=Ue.a(Hd,Nc.eI);var uf=Be.Na(9);uf.controlId=H;uf.bindingId=ia;uf.currentSheetName=df;return Zc.i(Be,"DdaClearBindingFormats",uf,Vc,Hd,Ld,Lb,0)},Lb,574)};Q.prototype.ddaSetBindingFormats=function(H,ia,
ib,Lb,Nc,Vc){var Hd=this;this.LJ(function(Ld,Be,df){var uf=Hd.$.na.va,og=Hd.oja();Ld=Ue.b(Ld,Nc);Be=Ue.a(Be,Hd.eI);var dh=uf.Na(9);dh.controlId=H;dh.bindingId=ia;dh.currentSheetName=og;dh.bindingData=ib;dh.isSetFormats=Lb;return Zc.i(uf,"DdaSetBindingFormats",dh,Ld,Be,df,Vc,0)},Vc,575)};Q.prototype.parseRange=function(H,ia,ib){var Lb=this;this.LJ(function(Nc,Vc,Hd){var Ld=Lb.$.na.va.hc();return Zc.Q(Lb.$.na.va,H,-1,Ue.b(Nc,ia),Ue.a(Vc,Lb.eI),Hd,ib,Ld)},ib,162,16)};Q.prototype.parseRangeForGoto=function(H,
ia,ib,Lb){var Nc=this;this.LJ(function(Vc,Hd,Ld){var Be=Nc.$.na.va.hc();return Zc.R(Nc.$.na.va,H,ia,Ue.b(Vc,ib),Ue.a(Hd,Nc.eI),Ld,Lb,Be)},Lb,562,16)};Q.prototype.executeRichApiRequest=function(H,ia,ib){var Lb=this;Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(H.RequestFlags&=8191);if(Fg.EwaSettings.ma(259))this.ywh(this.$.na.va.hc(),ia,function(){Lb.wQ.BJa(mh.a.internalError,ib)},ib,H);else{var Nc=ua.DdaFacade.bfd(H);!Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.Ab.Cz||Nc&16?(Fg.EwaSettings.qc()&&(Nc|=64),this.$.userOperationManager.Zt(new M(this.$,H,function(Vc,Hd,Ld){return E(Lb.$.na.va,H,Ue.b(Vc,ia),Ue.a(Hd,Lb.eI),Ld,ib)},Nc))):(this.wQ.BJa(mh.a.hDc,ib),af.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}};Q.prototype.oja=function(){return this.$.ea.isNamedObjectViewMode?this.$.qa.sheetName:this.$.activeItemName};Q.prototype.LJ=function(H,ia,ib,Lb){Lb=void 0===Lb?0:Lb;!Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.Ab.Cz||Lb&16?Fg.EwaSettings.qc()?this.$.userOperationManager.Zt(new tc.a(ib,0,H,Lb|64)):this.$.userOperationManager.Zt(new Mb.a(ib,0,H,Lb)):(this.wQ.BJa(mh.a.hDc,ia),af.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))};Q.prototype.ywh=function(H,ia,ib,Lb,Nc){var Vc=ua.DdaFacade.bfd(Nc);if(!Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.Ab.Cz||Vc&16){var Hd=this.$.Pb.Gc("UserAction","Rich Api request");Fg.EwaSettings.qc()&&
(Vc|=64);this.$.userOperationManager.jc(new ba(this.$,H,ia,ib,Lb,Hd,Nc,Vc),null)}else this.wQ.BJa(mh.a.hDc,Lb),af.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")};Object(fe.a)(Q,"DdaWebServiceHelper",null,[]);Object(fe.a)(P,"DocumentFile",null,[]);N.generalException="GeneralException";N.XIg="ApiNotFound";N.NBd="OperationCancelled";N.invalidArgument="InvalidArgument";Object(fe.a)(N,"ErrorCodes",null,[]);B.prototype.replaceShortcuts=function(){return Promise.reject("ReplaceShortcuts method is not overridden")};
B.prototype.getShortcuts=function(){return Promise.reject("GetShortcuts method is not overridden")};B.prototype.checkShortcutsInUse=function(){return Promise.reject("CheckShortcutsInUse method is not overridden")};Object(fe.a)(B,"WacApiDelegates",null,[]);var J=b(710);Wl(A,B);A.prototype.replaceShortcuts=function(H){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,H,this.hgf)};A.prototype.getShortcuts=function(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)};
A.prototype.checkShortcutsInUse=function(H){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(H,this.hgf)};A.F6g=function(H,ia){var ib=document.createEvent("KeyboardEvent");if(hb.a.mF)ib.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(H&8),!!(H&32),!!(H&4),!!(H&256));else{var Lb=[];H&4&&Lb.push("Shift");H&8&&Lb.push("Control");H&32&&Lb.push("Alt");ib.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,Lb.join(" "),!1,"en-US")}H=new Sys.UI.DomEvent(ib);H.keyCode=ia;return H};A.k2g=
function(H,ia){if(hb.a.Nf)switch(ia){case 189:ia=173;break;case 187:ia=61;break;case 186:ia=59}return A.F6g(H,ia)};Object(fe.a)(A,"ExcelWacApiDelegates",B,[]);D.prototype.oAg=function(H,ia){this.fdc(H)||(this.rIa[H]={});if(this.vfi(H))return af.ULS.sendTraceTag(537163157,344,50,"App {0} has reach the limit of number of cached files.",H),mh.a.syi;this.rIa[H][ia.oyh.toString()]=ia;return mh.a.success};D.prototype.dMh=function(H,ia){var ib=null;this.fdc(H)&&(ib=this.rIa[H][ia.toString()]);ib||af.ULS.sendTraceTag(537163156,
344,15,"File cache for [agave:{0}, fileHandler:{1}] doesn't exist",H,ia);return ib};D.prototype.fdc=function(H){return H in this.rIa};D.prototype.X7i=function(H,ia){if(this.fdc(H)){var ib=this.rIa[H];delete ib[ia.toString()];1>Object.keys(ib).length&&delete this.rIa[H];return ia.toString()in ib?mh.a.internalError:mh.a.success}return mh.a.internalError};D.prototype.vfi=function(H){return this.fdc(H)?Object.keys(this.rIa[H]).length>=this.Kxi:!1};D.getInstance=function(H){return H.da.za(200)||H.da.Ga(200,
new D(D.Lxi))};D.IBi=function(){return++D.ASg};D.qxi=4194304;D.Lxi=1;D.ASg=0;Object(fe.a)(D,"GetFileApiHelper",null,[]);z.prototype.notifyActionHandlerReady=function(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.rA)};z.prototype.getTypeName=function(){return"Microsoft.InternalService.AddinInternalService"};z.prototype.invokePropertyGet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};z.prototype.invokePropertyGetAsync=function(H){H=this.invokePropertyGet(H);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};z.prototype.invokePropertySet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};z.prototype.invokePropertySetAsync=function(H,ia){this.invokePropertySet(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};z.prototype.invokeMethod=function(H){switch(H){case 1:return this.qCi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};z.prototype.invokeMethodAsync=
function(H,ia){H=this.invokeMethod(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};z.prototype.qCi=function(){this.notifyActionHandlerReady();return null};Object(fe.a)(z,"AddinInternalService",null,[]);t.prototype.getAppRuntimeState=function(){return this.SI.getAppRuntimeState(this.rA)?2:1};t.prototype.setAppRuntimeState=function(H){switch(H){case 2:H=!0;break;case 1:H=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(ai.a.invalidArgument,
ti.a.ga(1741));}this.SI.setAppRuntimeState(this.rA,H)};t.prototype.getTypeName=function(){return"Microsoft.AppRuntime.AppRuntimeService"};t.prototype.invokePropertyGet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};t.prototype.invokePropertyGetAsync=function(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};t.prototype.invokePropertySet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
};t.prototype.invokePropertySetAsync=function(H,ia){this.invokePropertySet(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};t.prototype.invokeMethod=function(H,ia){switch(H){case 2:return this.pHh();case 1:return this.Nmj(ia)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};t.prototype.invokeMethodAsync=function(H,ia){H=this.invokeMethod(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};t.prototype.pHh=function(){return this.getAppRuntimeState()};
t.prototype.Nmj=function(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"int");this.setAppRuntimeState(H);return null};Object(fe.a)(t,"AppRuntimeService",null,[]);var ea=b(1168);v.prototype.disable=function(){try{if(!ti.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.pCe();if(!this.Fff())return this.qCe();this.D1.fNj(this.Ks)}catch(H){return af.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",
H.message||"Unknown"),this.nCe()}return null};v.prototype.enable=function(){try{if(!ti.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.pCe();if(!this.Fff())return this.qCe();this.D1.a6i(this.Ks)}catch(H){return af.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",H.message||"Unknown"),this.nCe()}return null};v.prototype._OnAccess=function(){};v.prototype.getTypeName=function(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"};
v.prototype.invokePropertyGet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};v.prototype.invokePropertyGetAsync=function(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};v.prototype.invokePropertySet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};v.prototype.invokePropertySetAsync=function(H,ia){this.invokePropertySet(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
v.prototype.invokeMethod=function(H){switch(H){case 1:return this.jCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};v.prototype.invokeMethodAsync=function(H,ia){switch(H){case 3:return this.Keh();case 2:return this.zjh()}H=this.invokeMethod(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};v.prototype.Keh=function(){return this.disable()};v.prototype.zjh=function(){return this.enable()};v.prototype.jCa=function(){this._OnAccess();return null};
v.prototype.pCe=function(){return ea.a(ai.a.notImplemented,ti.a.ga(1742))};v.prototype.qCe=function(){return ea.a(ai.a.sharedRuntimeNotAvailable,ti.a.ga(1746))};v.prototype.nCe=function(){return ea.a(ai.a.generalException,ti.a.ga(1737))};v.prototype.Fff=function(){var H=this.Oy.getSharedRuntimeId();return!!H&&0<H.length};Object(fe.a)(v,"BeforeDocumentCloseNotification",null,[]);w.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"};w.prototype.invokePropertyGet=
function(H){switch(H){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};w.prototype.invokePropertyGetAsync=function(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};w.prototype.invokePropertySet=function(H,ia){switch(H){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"boolean");return;case 3:this.nativeRuntime=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ia,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};w.prototype.invokePropertySetAsync=function(H,ia){this.invokePropertySet(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype.invokeMethod=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
};w.prototype.invokeMethodAsync=function(H,ia){H=this.invokeMethod(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};Ck.Object.defineProperties(w.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.lA},set:function(H){this.lA=H}},nativeRuntime:{configurable:!0,enumerable:!0,get:function(){return this.fbe},set:function(H){this.fbe=H}},streamingEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Sge},set:function(H){this.Sge=H}}});Object(fe.a)(w,
"CustomFunctionEngineStatus",null,[]);u.prototype.register=function(H){return OfficeExtension.WacRuntime.Utility.createPromise(this.Vtg(H))};u.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionManager"};u.prototype.invokePropertyGet=function(H){switch(H){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};u.prototype.invokePropertyGetAsync=function(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};
u.prototype.invokePropertySet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};u.prototype.invokePropertySetAsync=function(H,ia){this.invokePropertySet(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};u.prototype.invokeMethod=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};u.prototype.invokeMethodAsync=function(H,ia){switch(H){case 1:return this.S6i(ia)}H=this.invokeMethod(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};
u.prototype.S6i=function(H){var ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,1,"string");return this.register(ia,H)};Ck.Object.defineProperties(u.prototype,{status:{configurable:!0,enumerable:!0,get:function(){var H=new w;H.enabled=this.Rpg;H.streamingEnabled=this.Spg;H.nativeRuntime=!1;return H}}});Object(fe.a)(u,"CustomFunctionManager",null,[]);var Wa=b(1150);x.prototype._RegisterStateChange=function(){var H=
this;this.lSb||this.eP.execute(function(ia){H.l2d=ia.Pma(H._id,function(ib){H.SI.sAh(H.rA,H._id,JSON.stringify(ib))})});this.lSb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};x.prototype._UnregisterStateChange=function(){var H=this;this.lSb--;this.lSb||this.eP.execute(function(ia){ia.PHd(H._id,H.l2d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};x.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.LicenseFeature"};x.prototype.invokePropertyGet=
function(H){switch(H){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};x.prototype.invokePropertyGetAsync=function(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};x.prototype.invokePropertySet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};x.prototype.invokePropertySetAsync=function(H,ia){this.invokePropertySet(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
x.prototype.invokeMethod=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};x.prototype.invokeMethodAsync=function(H,ia){switch(H){case 6:return this.ijg();case 7:return this.kjg()}H=this.invokeMethod(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};x.prototype.ijg=function(){return this._RegisterStateChange()};x.prototype.kjg=function(){return this._UnregisterStateChange()};Ck.Object.defineProperties(x.prototype,{id:{configurable:!0,enumerable:!0,
get:function(){return this._id}}});Object(fe.a)(x,"LicenseFeature",null,[]);h.prototype.getFeatureTier=function(H,ia){var ib=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Lb){var Nc=1===ia?1:2===ia?2:0;ib.eP.execute(function(Vc){Vc.getFeatureTier(H,Nc).then(function(Hd){Lb(ib.jQh(Hd))},function(){Lb(ia)})})})};h.prototype.getLicenseFeature=function(H){H=new x(this.eP,H,this.rA,this.SI);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};h.prototype.isFeatureEnabled=
function(H,ia){var ib=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Lb){ib.eP.execute(function(Nc){Nc.isFeatureEnabled(H,ia).then(function(Vc){Lb(Vc)},function(){Lb(ia)})})})};h.prototype.isFreemiumUpsellEnabled=function(){var H=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(ia){H.eP.execute(function(ib){ib=ib.isFreemiumUpsellEnabled();ia(ib)})})};h.prototype.launchUpsellExperience=function(H){var ia=this;if(this.Ksg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(function(){ia.eP.execute(function(ib){ib.launchUpsellExperience(H)})});
throw OfficeExtension.WacRuntime.Utility.createRichApiException(ai.a.cTc,"");};h.prototype._TestFireStateChangedEvent=function(){};h.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.License"};h.prototype.invokePropertyGet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};h.prototype.invokePropertyGetAsync=function(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};h.prototype.invokePropertySet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
};h.prototype.invokePropertySetAsync=function(H,ia){this.invokePropertySet(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};h.prototype.invokeMethod=function(H,ia){switch(H){case 6:return this.jjg(ia)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};h.prototype.invokeMethodAsync=function(H,ia){switch(H){case 2:return this.YMh(ia);case 5:return this.iQh(ia);case 1:return this.kgi(ia);case 3:return this.Qgi();case 4:return this.bqi(ia)}H=this.invokeMethod(H,
ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};h.prototype.YMh=function(H){var ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,1,"int");return this.getFeatureTier(ia,H)};h.prototype.iQh=function(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");return this.getLicenseFeature(H)};h.prototype.kgi=function(H){var ia=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,
0,"string");H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,1,"boolean");return this.isFeatureEnabled(ia,H)};h.prototype.Qgi=function(){return this.isFreemiumUpsellEnabled()};h.prototype.bqi=function(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");return this.launchUpsellExperience(H)};h.prototype.jjg=function(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");this._TestFireStateChangedEvent(H);return null};h.prototype.jQh=function(H){switch(H){case 1:return 1;
case 2:return 2;default:return 0}};Object(fe.a)(h,"License",null,[]);var Pb=b(158);n.prototype.areShortcutsInUse=function(H){var ia=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(ib,Lb){ia.Yud.checkShortcutsInUse(H).then(function(Nc){ib(Nc)}).catch(function(Nc){Lb(Nc)})})};n.prototype.getShortcuts=function(){var H=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(ia,ib){H.Yud.getShortcuts().then(function(Lb){ia(Lb)}).catch(function(Lb){ib(Lb)})})};n.prototype.replaceShortcuts=
function(H){var ia=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(ib,Lb){ia.Yud.replaceShortcuts(H).then(function(){ib(null)}).catch(function(Nc){Lb(Nc)})})};n.prototype.getTypeName=function(){return"Microsoft.Office.ActionService"};n.prototype.invokePropertyGet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};n.prototype.invokePropertyGetAsync=function(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};
n.prototype.invokePropertySet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};n.prototype.invokePropertySetAsync=function(H,ia){this.invokePropertySet(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};n.prototype.invokeMethod=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};n.prototype.invokeMethodAsync=function(H,ia){switch(H){case 3:return this.EKg(ia);case 1:return this.rWh();case 2:return this.vcj(ia)}H=
this.invokeMethod(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};n.prototype.EKg=function(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"Array<string>");return this.areShortcutsInUse(H)};n.prototype.rWh=function(){return this.getShortcuts()};n.prototype.vcj=function(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"any");return this.replaceShortcuts(H)};Object(fe.a)(n,"ActionService",null,[]);var Cc=b(563);l.prototype.dWh=function(){this.ura||
(this.ura=Cc.a.ar(Yd.a.instance.kc("Common.App.SharedFilePicker.ISharedFilePicker")));return this.ura};l.prototype.getSharedFilePickerResponse=function(H){var ia=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(ib,Lb){try{var Nc=ia.dWh();Lj.Task.WAA.call(null,Nc).continueWith(function(){var Vc=Nc.result;if(Vc){var Hd={};(function(){var Ld=pa.d(H);Hd=Ld.Wt;return Ld})().returnValue?Vc.Hdd(Hd).then(function(Ld){Ld&&0<Ld.length?ib(Ld):Lb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(function(Ld){Lb(Ld)}):Lb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Lb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(Vc){Lb(Vc)}})};l.prototype.getTypeName=function(){return"Microsoft.Office.SharedFilePicker"};l.prototype.invokePropertyGet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
};l.prototype.invokePropertyGetAsync=function(H){H=this.invokePropertyGet(H);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};l.prototype.invokePropertySet=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);};l.prototype.invokePropertySetAsync=function(H,ia){this.invokePropertySet(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};l.prototype.invokeMethod=function(H){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(H);
};l.prototype.invokeMethodAsync=function(H,ia){switch(H){case 1:return this.cWh(ia)}H=this.invokeMethod(H,ia);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(H)};l.prototype.cWh=function(H){H=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(H,0,"string");return this.getSharedFilePickerResponse(H)};Object(fe.a)(l,"SharedFilePicker",null,[]);f.prototype.createInstance=function(H,ia){switch(H){case "Microsoft.Office.ActionService":return new n(ia);case "Microsoft.Office.SharedFilePicker":return new l}return null};
Object(fe.a)(f,"WacApiHost",null,[]);e.prototype.hostName=function(){return"ExcelOnline"};e.prototype.appId=function(){return this.tQb};e.prototype.createInstance=function(H){switch(H){case "Microsoft.Authentication.AuthenticationService":return Yd.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.rA,this.SI.Ei);case "Microsoft.Authentication.TokenParameters":return new Ya;case "Microsoft.ExcelServices.CustomFunctionManager":H=this.xb.ma(122);
var ia=this.xb.ma(123);return new u(H,ia,m(this.tQb,this.xb,this.SI));case "Microsoft.AppRuntime.AppRuntimeService":return new t(this.rA,this.SI);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return H=li.a(this.xb),new v(this.tQb,this.rA,H,this.SI);case "Microsoft.DynamicRibbon.DynamicRibbon":return H=li.a(this.xb),new Wa.DynamicRibbon(this.tQb,this.rA,this.SI,H,H.kn(this.rA).ml);case "Microsoft.Office.Licensing.License":return new h(this.rA,this.SI);case "Microsoft.InternalService.AddinInternalService":return new z(this.rA);
default:if(this.ISc||(this.ISc=new f),ia=this.ISc.createInstance(H,this.$xg))return ia}af.ULS.sendTraceTag(537163155,0,10,"Typename: {0} is an invalid parameter for the RichApiHost.CreateInstance method.",H);throw OfficeExtension.WacRuntime.Utility.createRichApiException(ai.a.generalException,ai.a.generalException);};Object(fe.a)(e,"RichApiHost",null,[]);var pd=b(406),wd=b(119),ue=b(35),Je=b(100),tg=b(294),oh=b(44),Qh=b(259),ni=b(6),Jj=b(66),Mj=b(205);c.prototype.dispose=function(){this.$=this.b9b=
null};c.prototype.$c=function(){return!1};c.prototype.jd=function(){return!1};c.prototype.executeCommand=function(H,ia,ib){H=ia.command;switch(H){case 451041795:this.Ee.wf(ib[Gi.a.pg],ib[Gi.a.I3]);break;case 974713501:this.M1h(ib[Gi.a.pg],ib[Gi.a.I3]);break;case 1237877382:this.Ee.Zu(ib[Gi.a.I3]);break;default:return fk.a(H)}return Lj.Task.Sa(!0)};c.prototype.Mc=function(H,ia,ib){if(H=!!ib)switch(ia.command){case 974713501:case 1237877382:case 451041795:break;default:H=!1}return H};c.prototype.M1h=
function(H,ia){var ib,Lb=H.DdaMethod;if("undefined"===typeof Lb.DispatchId)this.Ee.wf(mh.a.internalError,ia);else if(c.ofi(H)||this.$.Qd&1){if(Lb.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new R(this.$,this,H,ia)).start(this.Je,H.DdaMethod.ControlId):Lb.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.DVh(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.brj(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(H,this.edd(H.DdaMethod.ControlId),0,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.THh(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.Xmj(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.SHh(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.W7i(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.VGh(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.Zsd(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(H.DdaAddRowsColumns.IsRow=!0,this.Ale(H,ia)):Lb.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(H.DdaAddRowsColumns.IsRow=!1,this.Ale(H,ia)):Lb.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.uch(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.kXg(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(H.DdaSetBindingFormats.IsSetFormats=!0,this.vXf(H,ia)):Lb.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(H.DdaSetBindingFormats.IsSetFormats=!1,this.vXf(H,ia)):Lb.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(H,H.DdaBindingsMethod.ItemName,H.DdaBindingsMethod.FailOnCollision?2:1,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.bNh(ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.Iwd(H,ia):Lb.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.aMh(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.bMh(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.Y7i(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(H.DdaMethod.ControlId,H),this.Ee.Zu(ia)):
Lb.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?Fg.EwaSettings.ma(24)?this.Ee.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ia):this.Oyi(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?Fg.EwaSettings.ma(24)?this.Ee.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ia):this.Kyi(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(H,ia):Lb.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(H,ia):this.Ee.wf(mh.a.QBd,ia),Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&Lb.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){H=this.Je.tZ(H.DdaMethod.ControlId);ia="";if(H){ia=ua.DdaFacade.getSolutionId(H,this.$);var Nc=H.PrimaryMarketplace.MarketplaceType;Nc===OSF.StoreType.InMemory?H.OwnerAddinSolutionId&&H.AssetMarketplace&&(Nc=H.AssetMarketplace.MarketplaceType):Nc===OSF.StoreType.WopiCatalog&&(Nc=OSF.StoreType.OMEX);
ia=Telemetry.PrivacyRules.GetPrivacyCompliantId(ia,Nc,null===(ib=H.AssetMarketplace)||void 0===ib?void 0:ib.SolutionId,null,null,H.PrimaryMarketplace.MarketplaceRef)}af.ULS.sendTraceTag(537163224,344,50,"DDA method Id: {0}, AppID: {1}",Lb.DispatchId,ia)}}else this.Ee.wf(mh.a.tIe,ia)};c.prototype.THh=function(H,ia){var ib=this;H.DdaGetBindingData.CoerceType=c.M2b(H.DdaGetBindingData.CoerceType);H.DdaGetBindingData.FilterType=c.gSe(H.DdaGetBindingData.FilterType);H.DdaGetBindingData.ValueFormat=c.leg(H.DdaGetBindingData.ValueFormat);
if(this.nic(H.DdaGetBindingData.CoerceType,ia)){if(H.DdaGetBindingData){var Lb=H.DdaGetBindingData;0===Lb.FilterType&&(Lb.FilterType=2);Lb.StartCol|=0;Lb.StartRow|=0;Lb.ColCount=void 0===Lb.ColCount?-1:Lb.ColCount;Lb.RowCount=void 0===Lb.RowCount?-1:Lb.RowCount}this.cA.ddaGetBindingData(H.DdaMethod.ControlId,H.DdaGetBindingData.BindingId,H.DdaGetBindingData.CoerceType,H.DdaGetBindingData.ValueFormat,H.DdaGetBindingData.FilterType,H.DdaGetBindingData.StartRow,H.DdaGetBindingData.StartCol,H.DdaGetBindingData.RowCount,
H.DdaGetBindingData.ColCount,function(Nc){if(dj.a(Nc)||!Nc.Result)ib.Ee.iH(Nc,ia);else{var Vc=ib.Ee.dQ();Vc.Data=c.Pte(Nc.Result);ia(Vc)}},ia)}};c.prototype.Xmj=function(H,ia){var ib=this;H.DdaSetBindingData.CoerceType=c.M2b(H.DdaSetBindingData.CoerceType);if(this.nic(H.DdaSetBindingData.CoerceType,ia)){var Lb=c.yYc(H.DdaSetBindingData.CoerceType,H.DdaSetBindingData.Data);c.lfc(Lb)?this.Ee.wf(mh.a.ZAc,ia):(1===Lb.CoerceType&&(Lb.CellFormat||(Lb.CellFormat=H.DdaSetBindingData.CellFormat),Lb.TableOptions||
(Lb.TableOptions=H.DdaSetBindingData.TableOptions)),H.DdaSetBindingData&&(H.DdaSetBindingData.StartCol|=0,H.DdaSetBindingData.StartRow|=0),this.cA.ddaSetBindingData(H.DdaMethod.ControlId,H.DdaSetBindingData.BindingId,H.DdaSetBindingData.StartRow,H.DdaSetBindingData.StartCol,Lb,function(Nc){dj.a(Nc)?ib.Ee.iH(Nc,ia):ib.Ee.Zu(ia)},ia))}};c.prototype.DVh=function(H,ia){var ib=this;H.DdaGetBindingData.CoerceType=c.M2b(H.DdaGetBindingData.CoerceType);H.DdaGetBindingData.ValueFormat=c.leg(H.DdaGetBindingData.ValueFormat);
H.DdaGetBindingData.FilterType=c.gSe(H.DdaGetBindingData.FilterType);if(this.nic(H.DdaGetBindingData.CoerceType,ia)){var Lb=this.edd(H.DdaMethod.ControlId);Lb?this.cA.ddaGetSelectedData(H.DdaMethod.ControlId,H.DdaGetBindingData.CoerceType,H.DdaGetBindingData.ValueFormat,H.DdaGetBindingData.FilterType,Lb,function(Nc){if(dj.a(Nc))ib.Ee.iH(Nc,ia);else{var Vc=ib.Ee.dQ();Vc.Data=c.Pte(Nc.Result);ia(Vc)}},ia):this.Ee.wf(mh.a.v1e,ia)}};c.prototype.aMh=function(H,ia){var ib=this;if(hb.a.tod)this.Ee.wf(mh.a.GOg,
ia);else{var Lb=H[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],Nc=H[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],Vc=H.DdaMethod.ControlId,Hd=D.getInstance(this.$);if(0>=Nc)af.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.Ee.wf(mh.a.Wbi,ia);else if(Nc>D.qxi)af.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.Ee.wf(mh.a.JXe,ia);else{var Ld=null;switch(Lb){case 1:Ld="Compressed";
break;case 0:Ld="Text";break;case 2:Ld="Pdf";break;default:af.ULS.sendTraceTag(537163219,344,15,"Requested file type {0} is not supported.",Lb);this.Ee.wf(mh.a.VRe,ia);return}if("Text"===Ld)af.ULS.sendTraceTag(537163218,344,15,"Requested file type {0} is not supported.",Ld),this.Ee.wf(mh.a.VRe,ia);else{Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(H=new Sys.StringBuilder,H.append(kk.a(this.$,Ld)),"Pdf"===Ld&&Sj.a.eh(H,Xh.a.vFd,"WholeWorkbook"),H=
H.toString()):H=kk.a(this.$,Ld);var Be=null,df=new XMLHttpRequest;df.onreadystatechange=function(){if(4===df.readyState)if(200===df.status){var uf=df.response;if(uf){Be=new Uint8Array(uf);uf=ib.Ee.dQ();for(var og=Be.length,dh=D.IBi(),th={},Ki=0,xh=0;xh<og;xh+=Nc){for(var ui=[],Ai=xh+Nc<og?xh+Nc:og,Oj=0,pj=xh;pj<Ai;Oj++,pj++)ui[Oj]=Be[pj];th[(Ki++).toString()]=ui}th=new P(dh,og,Nc,th);th=Hd.oAg(Vc,th);th!==mh.a.success?ib.Ee.wf(th,ia):(uf[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=
dh,uf[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=og,af.ULS.sendTraceTag(537163216,344,50,"GetFileAsync get file successfully for file type {0}, the file size is {1}",Ld,og),ia(uf))}else af.ULS.sendTraceTag(537163217,344,15,"Request is successful, but respone have no data for file type {0}.",Ld),ib.Ee.wf(mh.a.internalError,ia)}else 500===df.status?ib.Ee.wf(mh.a.yUe(parseInt(df.statusText,10)),ia):(af.ULS.sendTraceTag(537163215,344,15,"Request failed to obtain the file for type {0}.",
Ld),ib.Ee.wf(mh.a.oBi,ia))};df.open("GET",H,!0);df.responseType="arraybuffer";df.setRequestHeader("If-Modified-Since","0");df.send(null)}}}};c.prototype.bMh=function(H,ia){var ib=H[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],Lb=H[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];H=H.DdaMethod.ControlId;(ib=D.getInstance(this.$).dMh(H,ib))?(ib=ib.BAj,0>Lb||Lb>=Object.keys(ib).length?this.Ee.wf(mh.a.B7h,ia):(Lb=ib[Lb.toString()],ib=this.Ee.dQ(),ib[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=
Lb,ib[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=Lb.length,ia(ib))):this.Ee.wf(mh.a.internalError,ia)};c.prototype.Y7i=function(H,ia){var ib=H[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];H=H.DdaMethod.ControlId;ib=D.getInstance(this.$).X7i(H,ib);ib===mh.a.success?this.Ee.Zu(ia):this.Ee.wf(ib,ia)};c.prototype.brj=function(H,ia){var ib=this;H.DdaSetBindingData.CoerceType=c.M2b(H.DdaSetBindingData.CoerceType);if(this.nic(H.DdaSetBindingData.CoerceType,ia)){var Lb=
this.edd(H.DdaMethod.ControlId);if(Lb){var Nc=c.yYc(H.DdaSetBindingData.CoerceType,H.DdaSetBindingData.Data),Vc=vj.g(this.$).ha;1===Nc.CoerceType&&(!Nc.Data&&Vc.ta.k_&&(Nc.Headers||(Nc.Headers=[]),Nc.Headers.length||Nc.Headers.push([]),Nc.Headers[0].length||Array.add(Nc.Headers[0],"")),c.lfc(Nc)||(Nc.CellFormat||(Nc.CellFormat=H.DdaSetBindingData.CellFormat),Nc.TableOptions||(Nc.TableOptions=H.DdaSetBindingData.TableOptions)));if(c.lfc(Nc))this.Ee.wf(mh.a.ZAc,ia);else{var Hd=Vc.ta.qd.clone(),Ld=Vc.ta.activeCell.clone();
this.cA.ddaSetSelectedData(H.DdaMethod.ControlId,Lb,Nc,function(Be){var df;if(dj.a(Be))ib.Ee.iH(Be,ia);else{Be=Hd.clone();var uf=Nc.Headers?Nc.Headers[0].length:Nc.Data[0].length;1!==Nc.CoerceType||Nc.Data?1===Nc.CoerceType&&(null===(df=Nc.TableOptions)||void 0===df?0:df.length)&&0==Nc.TableOptions[0]?(Be.top+=1,Be.bottom=Be.top+Nc.Data.length-1):Be.bottom=Be.top+Nc.Data.length-(1===Nc.CoerceType?0:1):Be.bottom=Be.top+1;Be.right=Be.left+uf-1;df=Be.contains(Ld)?Ld:Be.topLeft;Vc.updateSelection(Be,
df,0);ib.Ee.Zu(ia)}},ia)}}else this.Ee.wf(mh.a.iwe,ia)}};c.prototype.addBinding=function(H,ia,ib,Lb){var Nc=this;ia?this.cA.ddaAddBinding(H.DdaMethod.ControlId,H.DdaBindingsMethod.BindingId,H.DdaBindingsMethod.BindingType,ia,ib,function(Vc){if(dj.a(Vc))Nc.Ee.iH(Vc,Lb);else{var Hd=Nc.Ee.dQ();Hd.Bindings=Array(1);Hd.Bindings[0]=Nc.Je.w0b(Vc.Result);Lb(Hd)}},Lb):this.Ee.wf(mh.a.okj,Lb)};c.prototype.SHh=function(H,ia){var ib=this;this.cA.ddaGetBinding(H.DdaMethod.ControlId,H.DdaBindingsMethod.BindingId,
function(Lb){if(dj.a(Lb)||!Lb.Result)ib.Ee.iH(Lb,ia);else{var Nc=ib.Ee.dQ();Nc.Bindings=Array(1);Nc.Bindings[0]=ib.Je.w0b(Lb.Result);ia(Nc)}},ia)};c.prototype.bNh=function(H){var ia=this.Ee.dQ(),ib={};ib[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;ia[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=ib;H(ia)};c.prototype.W7i=function(H,ia){var ib=this;this.cA.ddaReleaseBinding(H.DdaMethod.ControlId,H.DdaBindingsMethod.BindingId,function(Lb){dj.a(Lb)?
ib.Ee.iH(Lb,ia):ib.Ee.Zu(ia)},ia)};c.prototype.VGh=function(H,ia){var ib=this;this.cA.ddaGetAllBindings(H.DdaMethod.ControlId,function(Lb){if(dj.a(Lb))ib.Ee.iH(Lb,ia);else{var Nc=ib.Ee.dQ();if(Lb.Result){Lb=Lb.Result;Nc.Bindings=Array(Lb.length);for(var Vc=0;Vc<Lb.length;Vc++)Nc.Bindings[Vc]=ib.Je.w0b(Lb[Vc])}else Nc.Bindings=null;ia(Nc)}},ia)};c.prototype.Zsd=function(H,ia){var ib=this;this.cA.ddaLoadSettings(H.DdaMethod.ControlId,function(Lb){if(dj.a(Lb))ib.Ee.iH(Lb,ia);else{var Nc=ib.Ee.dQ();Nc.Properties=
Lb.Result;ia(Nc)}},ia)};c.prototype.saveSettings=function(H,ia){for(var ib=this,Lb={Settings:[]},Nc=0;Nc<H.DdaSettingsMethod.Properties.length;Nc++){var Vc={};Vc.Name=H.DdaSettingsMethod.Properties[Nc][0];Vc.Value=H.DdaSettingsMethod.Properties[Nc][1];Lb.Settings[Nc]=Vc}this.cA.ddaSaveSettings(H.DdaMethod.ControlId,Lb,H.DdaSettingsMethod.OverwriteIfStale,function(Hd){dj.a(Hd)?ib.Ee.iH(Hd,ia):ib.Ee.Zu(ia)},ia)};c.prototype.Ale=function(H,ia){var ib=this,Lb=c.yYc(1,H.DdaAddRowsColumns.Data);c.lfc(Lb)?
this.Ee.wf(mh.a.ZAc,ia):this.cA.ddaAddRowsColumns(H.DdaMethod.ControlId,H.DdaAddRowsColumns.BindingId,H.DdaAddRowsColumns.IsRow,Lb,function(Nc){dj.a(Nc)?ib.Ee.iH(Nc,ia):ib.Ee.Zu(ia)},ia)};c.prototype.uch=function(H,ia){var ib=this;this.cA.ddaDeleteAllDataValues(H.DdaMethod.ControlId,H.DdaBindingsMethod.BindingId,function(Lb){dj.a(Lb)?ib.Ee.iH(Lb,ia):ib.Ee.Zu(ia)},ia)};c.prototype.kXg=function(H,ia){var ib=this;this.cA.ddaClearBindingFormats(H.DdaMethod.ControlId,H.DdaClearBindingFormats.BindingId,
function(Lb){dj.a(Lb)?ib.Ee.iH(Lb,ia):ib.Ee.Zu(ia)},ia)};c.prototype.vXf=function(H,ia){var ib=this,Lb={},Nc=H.DdaSetBindingFormats.IsSetFormats;Nc?Lb.CellFormat=H.DdaSetBindingFormats.CellFormat:Lb.TableOptions=H.DdaSetBindingFormats.TableOptions;this.cA.ddaSetBindingFormats(H.DdaMethod.ControlId,H.DdaSetBindingFormats.BindingId,Lb,Nc,function(Vc){dj.a(Vc)?ib.Ee.iH(Vc,ia):ib.Ee.Zu(ia)},ia)};c.prototype.executeRichApiRequest=function(H,ia){var ib=this,Lb,Nc=H.ArrayData,Vc={},Hd=vj.g(this.$).ha;if(Nc){if("WacPartition"===
Nc[0]){this.dwh(H,ia);return}var Ld=Object(lj.a)(ua.DdaFacade,li.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===Nc[0]){var Be=Ld.kn(H.DdaMethod.ControlId);Be&&(Be.Yod=!0,Be.yIf())}Vc.HttpMethod=Nc[1];Vc.PathAndQuery=Nc[2];Vc.RequestHeaders=c.aZe(Nc[3]);Vc.RequestBody=Nc[4];Vc.AppPermission=Nc[5];Be=Nc[6];Vc.RequestFlags=Be;var df=0;if(Dh.i(this.$.qa))switch(Hd.We){case 1:df=2;break;case 2:df=3;break;case 128:df=4;break;default:df=1}var uf=null;Hd.Oa.wC&&(uf=Hd.Oa.wC.ij);Vc.SheetMultiRange=
Jh.r(Hd.ta.selectedRanges,this.$);Vc.ActiveCell=Jh.v(Hd.ta.activeCell,this.$);Vc.ActiveChartId=uf;Vc.SelectionState=df;df=this.Je.tZ(H.DdaMethod.ControlId);Vc.InstanceId=df?df.InstanceId:"";if(df&&df.PrimaryMarketplace){uf=ua.DdaFacade.getSolutionId(df,this.$);var og=df.PrimaryMarketplace.MarketplaceType;if(og===OSF.StoreType.InMemory){if(!df.OwnerAddinSolutionId){this.Ee.wf(mh.a.cyb,ia);return}if(df.AssetMarketplace)og=df.AssetMarketplace.MarketplaceType;else{this.Ee.wf(mh.a.cyb,ia);return}}else og===
OSF.StoreType.WopiCatalog&&(og=OSF.StoreType.OMEX);var dh=Telemetry.PrivacyRules.GetPrivacyCompliantId(uf,og,null===(Lb=df.AssetMarketplace)||void 0===Lb?void 0:Lb.SolutionId,null,null,df.PrimaryMarketplace.MarketplaceRef);Vc.CompliantSolutionId=dh;Vc.SolutionId=uf;Vc.MarketplaceType=og;Vc.SolutionVersion=df.PrimaryMarketplace.SolutionVersion;Vc.StoreLocation=df.PrimaryMarketplace.MarketplaceRef}else Vc.SolutionId=Vc.MarketplaceType="",Vc.CompliantSolutionId="";Vc.IsEventsEnabled=void 0===Ld||null===
Ld||Ld.hj.G_b(Vc.InstanceId);Vc.RequestGuid=qi.a.create().toString();Lb=Vc.RequestBody.length;if(Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&Lb>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.Ee.wf(mh.a.Qdj,ia);af.ULS.sendTraceTag(537163213,0,50,"Request payload size:{0} exceeded the limit",Lb);return}Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&Be&4096&&(Lb=new Y(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Lb,
U,Nc),Vc.RequestBody=Nc[4])}var th=c.a1e(Vc.RequestHeaders);c.KCd++;var Ki=zi.a.Ua.Vb;Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&Vc&&Vc.RequestBody&&af.ULS.sendTraceTag(537163212,0,50,String.format("Richapi json request body size is {0}",Vc.RequestBody.length));this.cA.executeRichApiRequest(Vc,function(xh){var ui;ib.HWf(Ki,!0,xh.ServerCorrelationId);var Ai=null,Oj=null,pj=xh.ServerCorrelationId;if(null===(ui=null===xh||void 0===xh?void 0:xh.Errors)||void 0===
ui?0:ui[0])Ai=xh.Errors[0].MessageIdName,Oj=xh.Errors[0].Description,Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&Jj.a(ib.$).ud.bE(xh.Errors[0].MessageId);if(dj.a(xh)||!xh.Result)ib.ENa(pj,th,"Server error",Ai,Oj),ib.Ee.iH(xh,ia);else{var tj=null;if(Fg.EwaSettings.ma(259))if((ui=xh.Result)&&ui.length){for(var Yj=0;Yj<ui.length;Yj++)if(ui[Yj].RequestGuid===Vc.RequestGuid){tj=ui[Yj];break}tj||ib.Ee.iH(xh,ia)}else tj=xh.Result;else tj=xh.Result;if(!Ai&&tj&&tj.ResponseBody&&
tj.ResponseBody[0])if(xh=tj.ResponseBody[0],xh.startsWith('{"Error":')){1<tj.ResponseBody.length&&(xh=xh.substring(0,xh.indexOf("}")+1),xh+="}");try{var lk=Bh.a.ni(xh);lk.Error&&ib.ENa(pj,th,"Pipeline error",lk.Error.Code,lk.Error.Message)}catch(sl){ib.ENa(pj,th,"Json deserialize error",null,"Error info cannot be deserialized.")}}else ib.ENa(pj,th);else ib.ENa(pj,th,"Server error",Ai,Oj);var vk=(lk=tj.SheetMultiRange)?lk.SheetName:null;xh=tj.ActiveChartId;var Hj=tj.SelectionState;Ai=5===Hj&&!!lk||
6===Hj||7===Hj||8===Hj;if(Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&ib.$.Ab.Cz&&Ai)ib.Ee.wf(mh.a.hDc,ia),af.ULS.sendTraceTag(537163211,0,50,String.format("{0} is not allowed",Hj.toString()));else if(5===Hj&&lk){if(ib.$.xa&&vk)if(ib.$.xa.Yj(vk))ib.BTc(vk);else{var ul=null;ul=function(){ib.$.xa.Yj(vk)&&(af.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),ib.BTc(vk),ib.$.xa.VHb(ul))};ib.$.xa.jnb(ul);if(Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){var $k=
null;$k=function(){ib.$.xa.Yj(vk)&&(ib.BTc(vk),ib.$.xa.Yma($k))};ib.$.xa.Qga($k)}}}else if(6===Hj||7===Hj||8===Hj||9===Hj){if(lk){var al=Jh.g(lk.Ranges);if(vk&&Jh.cb(al,!0))if(Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!ib.$.xa.Yj(vk)){var nl=null;nl=function(){ib.Jcg(Hd,al,vk,Hj);ib.$.xa.Yma(nl)};ib.$.xa.Qga(nl)}else ib.Jcg(Hd,al,vk,Hj)}7===Hj?(xh="38.{"+Mj.e(xh)+"}",ok.a(ib.$).rna(0,xh,!0)):8===Hj&&ok.a(ib.$).rna(2,xh,!0);9===Hj&&(ib.$.ya.ApiCallToSetPageLayout=
!0)}tj.PostProcessActions?ib.$.Yef?(pj=Bh.a.ni(tj.PostProcessActions),ib.tYi(pj).then(function(){ib.dcb(tj,ia);ib.fad(H.DdaMethod.ControlId,Vc);return Promise.resolve(null)},function(sl){ib.dcb(tj,ia,sl);return Promise.reject(sl)})):(ib.ENa(pj,th,"Promise not supported",null,"Promise is not supported on this browser."),ib.Ee.wf(mh.a.internalError,ia)):ib.dcb(tj,ia)}},function(xh){ib.HWf(Ki,!1,null);ib.ENa(null,th,"Web service error");ia(xh)})};c.prototype.fad=function(H,ia){var ib=Object(lj.a)(ua.DdaFacade,
li.a(this.$));(null===ib||void 0===ib?0:ib.lLd)&&ib.kn(H)&&c.Tuj(ia.RequestHeaders)&&(af.ULS.sendTraceTag(537163209,0,50,"ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: {0}; SolutionId: {1}.",H,ia.SolutionId),ib.lLd.Hkh(H))};c.prototype.dwh=function(H,ia){var ib=this,Lb=this.Je.tZ(H.DdaMethod.ControlId),Nc=ua.DdaFacade.getSolutionId(Lb,this.$),Vc=null;Vc=ua.DdaFacade.Wua(Lb,this.$);Vc=new A(Vc,this.$);Vc=new e(Nc,H.DdaMethod.ControlId,this.Je,this.$,Vc);var Hd=
{ResponseHeaders:[]};Hd.ResponseBody=Array(1);Lb=c.aZe(H.ArrayData[3]);var Ld=c.a1e(Lb);Lb=new ta(this.$.ya.CreateWorkbookMaxAllowedBase64Size,this.Nqf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Vc,xa,Lb,H.ArrayData).then(function(Be){if(!Be)return ib.Qtd(!1,"The rich api executor call failed",Ld),af.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),Hd.ResponseStatusCode=500,ib.dcb(Hd,ia),null;ib.Qtd(!0,"The rich api executor call succeeded",Ld);Hd.ResponseStatusCode=
Be[0];Hd.ResponseBody[0]=Be[2];ib.dcb(Hd,ia);return null},function(Be){Hd.ResponseStatusCode=400;Hd.ResponseBody[0]=Be.toString();ib.Qtd(!1,"The rich api executor call failed",Ld);af.ULS.sendTraceTag(537163207,0,10,"A Excel Rich API batch execution was failed, AppId:{0}",Nc);ib.dcb(Hd,ia);return null})};c.prototype.HWf=function(H,ia,ib){c.KCd--;H=wd.a(zi.a.Ua,H);af.ULS.sendTraceTag(36763356,0,50,"Rich Api perf log -- total milliseconds used:{0}, requests pending:{1}, request result:{2}, server correlationid: {3}.",
H,c.KCd,ia?"success":"false",ib)};c.prototype.dcb=function(H,ia,ib){ib=void 0===ib?null:ib;var Lb=Array(3);Lb[0]=H.ResponseStatusCode;Lb[1]=c.XWh(H.ResponseHeaders);var Nc=[],Vc=!1;if(ib&&H.ResponseBody){var Hd=Bh.a.ni(H.ResponseBody.join(""));Hd.Error||(Vc={},Vc.Error=ib,Vc.TraceIds=Hd.TraceIds,Vc.ProcessedResults={},Vc.ProcessedResults.Results=Hd.Results,Nc[0]=Bh.a.Jc(Vc),Vc=!0)}Lb[2]=Vc?Nc:H.ResponseBody;H=this.Ee.dQ();H.Data=Lb;ia(H)};c.prototype.Iwd=function(H,ia){(new G(this.$,this.Ee,this.cA)).Iwd(H,
ia)};c.prototype.Oyi=function(H,ia){af.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");var ib=H[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],Lb=H[Ug.a.zVc],Nc=H[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];H=this.$.da.za(232).h1a.Pyi(H.DdaMethod.ControlId,ib,Lb,Nc);H===mh.a.success?this.Ee.Zu(ia):(af.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.Ee.wf(H,ia))};c.prototype.Kyi=function(H,ia){af.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");
var ib=H[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],Lb=H[Ug.a.zVc],Nc=H[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.za(232).h1a.nlj(H.DdaMethod.ControlId,ib,Lb,Nc);this.Ee.Zu(ia)};c.prototype.getAccessToken=function(H,ia){function ib(Vc,Hd){var Ld;if(Vc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Vc=Lb.Ee.dQ(),Vc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=Hd.accessToken,ia(Vc);else{Hd=Lb.Je.tZ(H.DdaMethod.ControlId);var Be=null!==Hd.OwnerAddinSolutionId?
Hd.OwnerAddinSolutionId:Hd.PrimaryMarketplace.MarketplaceType,df={};af.ULS.sendTraceTag(537163202,0,10,"{0}.",(df.errorCode=Vc.toString(),df.appId=Telemetry.PrivacyRules.GetPrivacyCompliantId(ua.DdaFacade.getSolutionId(Hd,Lb.$),Be,null===(Ld=Hd.AssetMarketplace)||void 0===Ld?void 0:Ld.SolutionId,null,null,Hd.PrimaryMarketplace.MarketplaceRef),df.storeType=Be,df));Lb.Ee.wf(Vc,ia)}}var Lb=this;af.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");var Nc=!Fg.EwaSettings.ma(24);Nh.TaskExtensions.Ba(hj.GetServiceTaskFactory.create(this.$.da,
137,this.$.la,1),function(Vc){var Hd=Lb.Je.Ei,Ld=qa.getInstance();cj.AppsForOfficeSingleSignOnManager.getInstance(Hd,Vc.result,Ld).getAccessToken(H.DdaMethod.ControlId,Nc,H,ib)},this.$.la)};c.prototype.getAuthContext=function(H,ia){var ib=this;Nh.TaskExtensions.Ba(hj.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),function(){var Lb=ib.Je.Ei.getOsfControl(H.DdaMethod.ControlId);if(!Fg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!0)||Lb.isFirstParty()){Lb=
Lb.getManifest();var Nc=Lb.getMarketplaceID(),Vc=Lb.getWebApplicationId(),Hd=Lb.getWebApplicationMsaId();Yd.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(Nc).then(function(Ld){var Be=ib.Ee.dQ(),df={};df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Vc;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Hd||Vc;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Ld.upn;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=
Ld.userId;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Ld.authority;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=ze.CHh(Ld.authorityType);df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Ld.isAnonymous;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Ld.tenantId;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Ld.supportsAuthToken;Be[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=
df;ia(Be)},function(Ld){var Be=ib.Ee.dQ(),df={},uf=new ze;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Vc;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=Hd||Vc;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=uf.upn;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=uf.userId;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=uf.authority;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=uf.authorityType;
df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=uf.isAnonymous;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=uf.tenantId;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Ld;df[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=uf.supportsAuthToken;Be[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=df;Be.Error=1;ia(Be)})}},this.$.la)};c.prototype.cfi=function(H){var ia=vj.g(this.$).ha;return 16===ia.We&&!!ia.Oa.nc&&
!!ia.Oa.nc.floatingObject&&Kj.a.equals(ia.Oa.nc.floatingObject.id,H,!0)};c.prototype.edd=function(H){var ia=vj.g(this.$).ha;return ia.ta.Hg?1===ia.We||this.cfi(H)?ia.jia:null:null};c.prototype.nic=function(H,ia){return 1!==H&&2!==H&&3!==H?(this.Ee.wf(mh.a.pze,ia),!1):!0};c.prototype.Qtd=function(H,ia,ib){var Lb={};Lb.a=this.$.ya.UserSessionId;Lb.b=H;Lb.c=ia;Lb.d=null;Lb.e=ib;Ch.b().Pe(37,Lb)};c.prototype.ENa=function(H,ia,ib,Lb,Nc){ib=void 0===ib?null:ib;Lb=void 0===Lb?null:Lb;Nc=void 0===Nc?null:
Nc;var Vc={};H&&(Vc.ServerCorrelationId=H);void 0!==ia&&null!==ia&&(Vc.Source=ia);ib&&(Vc.ErrorType=ib);Lb&&(Vc.MessageId=Lb);Nc&&(Vc.StatusDescription=Nc);Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&Lb&&"ExternalDataRefreshFailed"===Lb&&(Vc.StatusDescription="");af.ULS.sendTraceTag(50688452,0,50,Bh.a.Jc(Vc))};c.prototype.tYi=function(H){for(var ia=new Promise(function(Lb){Lb(null)}),ib=0;ib<H.length;ib++)ia=this.sYi(ia,H[ib]);return ia};c.prototype.sYi=function(H,
ia){var ib=this;if(!ia)return af.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),H.then(function(){return Promise.reject(c.a3a(N.generalException,K.a.instance.ga(1737),null))});switch(ia.actionType){case 1:case 2:H=H.then(function(){var Lb=Object(lj.a)(ua.DdaFacade,li.a(ib.$));if(Lb.kn(ia.controlId))switch(Lb.hj.a1h(ia),ia.messageType){case 14:case 100:Lb.kLd.d0b(ia);break;case 11:case 12:Lb.Bgj.mob(ia);break;case 51:case 52:Lb.zgj.mob(ia);break;case 2101:case 2102:Lb.Agj.mob(ia);break;
case 2E3:Lb.Cgj.d0b(ia);break;case 2201:ib.$.Eka&&Lb.lLd.xLg(ia);break;case 2203:Lb.Dgj.yLg(ia);break;case 2700:Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&Lb.jLd.d0b(ia)}else af.ULS.sendTraceTag(537163171,0,10,"OsfControl with instanceId[{0}] doesn't exist.",ia.controlId);return Promise.resolve(null)});break;case 3:H=H.then(function(){ib.N0h(ia);return Promise.resolve(null)});break;case 15:Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(H=H.then(function(){ib.q2h(ia);
return Promise.resolve(null)}));break;case 4:H=H.then(function(){if(Fg.EwaSettings.ma(105)){var Lb=vj.g(ib.$).ha.ta.activeCell;Lb.top!==ia.row+1&&Lb.left!==ia.column+1&&(Lb=Jh.v(Mh.Range.hd(ia.row+1,ia.column+1),ib.$),vj.g(ib.$).Gg(Lb,null,null,null,3,Qi.a.dbh));Hh.a(ib.$,243,242,0,function(Nc){Nc.fdb(ia.row+1,ia.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:H=H.then(function(){Object(lj.a)(ua.DdaFacade,li.a(ib.$)).hj.uKe(ia.controlId,ia.isEnableEvents);return Promise.resolve(null)});
break;case 5:H=H.then(function(){return ib.A$g(ia)});break;case 6:H=H.then(function(){return ib.ETi(ia)});break;case 8:H=H.then(function(){Fg.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(lj.a)(ua.DdaFacade,li.a(ib.$)).jXg();var Lb=new Qh.a(ni.a.Jk,5,null);oh.a(ib.$).tt(Lb);return Promise.resolve(null)});break;case 9:H=H.then(function(){return ib.$mj(ia)});break;case 10:H=H.then(function(){return ib.TVj(ia)});break;case 11:H=H.then(function(){return ib.SVj()});
break;case 12:H=H.then(function(){return ib.PVj()});break;case 13:H=H.then(function(){return ib.QVj(ia)});break;case 14:H=H.then(function(){return ib.RVj(ia)});break;case 16:H=H.then(function(){return Promise.resolve(ia)});break;case 17:H=H.then(function(){return ib.ojj(ia,Object(lj.a)(ua.DdaFacade,li.a(ib.$)))});break;case 18:vj.g(this.$).focus();break;case 19:this.j4e(ia.entryType,!1,ia.options);break;case 20:this.j4e(ia.entryType,!0,ia.options);break;default:H=H.then(function(){return Promise.reject(c.a3a(N.XIg,
K.a.instance.ga(1738),null))})}return H};c.prototype.q2h=function(H){var ia=Object(lj.a)(ua.DdaFacade,li.a(this.$)).kn(H.controlId);if(ia&&!(0===H.operationType^!ia.zda)){vj.g(this.$).Dhc=!0;switch(H.operationType){case 0:var ib=new tg.a(document.createElement("input"));ib.text=H.range;ia.H$h(vj.g(this.$).ug.X8g(ib,new pd.a(this.$)));ia.zda.startEdit(!0);break;case 1:ia.xOf();this.rangePicker=null;break;case 2:ia.zda.Ycg(H.range);break;case 3:ia.zda.Ycg(H.startingRange);ia=H.expandSelection;ib=H.getNextDataRegionCell;
var Lb=0;switch(H.keyboardDirectionValue){case 2:Lb=38;H=ia&&ib?105288353:ia?-31900117:ib?542791952:137938150;break;case 3:Lb=40;H=ia&&ib?-1297307319:ia?-1603798598:ib?1713663844:-798660877;break;case 0:Lb=37;H=ia&&ib?-403586027:ia?2039316657:ib?-2012742350:-1470715894;break;case 1:Lb=39;H=ia&&ib?784916030:ia?589730764:ib?1324884057:-1231471547;break;default:H=1461300262}ia=this.x4b("keydown",Lb,ia,ib);vj.g(this.$).QIb(ia,new Lk.a(H,1,0,8,null))}vj.g(this.$).Dhc=!1}};c.prototype.x4b=function(H,ia,
ib,Lb){var Nc=document.createEvent("KeyboardEvent");if(hb.a.mF)Nc.initKeyboardEvent(H,!1,!1,window.self,"A",0,Lb,!1,ib,!1);else{var Vc="";ib&&(Vc+="Shift");Lb&&(Vc+=0<Vc.length?" Control":"Control");Nc.initKeyboardEvent(H,!1,!1,window.self,"A",0,Vc,!1,"en-US")}H=new Sys.UI.DomEvent(Nc);H.keyCode=ia;return H};c.prototype.N0h=function(H){switch(H.operationType){case 1:Nh.TaskExtensions.Ba(hj.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1),function(ia){ia.result.hKd()},this.$.la,3);break;case 2:if(H=
Object(lj.a)(ua.DdaFacade,li.a(this.$)).kn(H.controlId))H.Yod=!0,H.yIf()}};c.prototype.A$g=function(H){var ia=this,ib=H.fileBase64;return ib&&ib.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(c.a3a(N.invalidArgument,K.a.instance.ga(1741),"Application.CreateWorkbook")):(new Promise(function(Lb,Nc){var Vc=new bi.StandardDialog;Vc.ic=4;Vc.Ak(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(Hd){2!==Hd&&0!==Hd||Nc(c.a3a(N.NBd,K.a.instance.ga(1740),
"Application.CreateWorkbook"));Hd=new oa("blank","agave",ib?"streamBase64":"streamEmpty",ib);ia.Nqf.create(Lb,Nc,Hd).v0a()})})).then(function(Lb){ia.b9b.set(H.fakeFileId,Lb);return Promise.resolve(null)},function(Lb){return Lb?Promise.reject(Lb):Promise.reject(c.a3a(N.generalException,K.a.instance.ga(1737),"Application.CreateWorkbook"))})};c.prototype.ETi=function(H){var ia=this;return new Promise(function(ib,Lb){if(ia.b9b.has(H.fakeFileId)){var Nc=ia.b9b.get(H.fakeFileId);Lb=new bi.StandardDialog;
Lb.ic=4;Lb.Ak(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,function(Vc){1===Vc&&Gk.HelperMethods.mf(Nc,void 0,void 0,"DdaMethodHandler.fileUrl");ib(null)})}else Lb(c.a3a(N.generalException,K.a.instance.ga(1737),"Document.Open"))})};c.prototype.$mj=function(H){var ia=this;return new Promise(function(ib){Object(lj.a)(ua.DdaFacade,li.a(ia.$)).iTf=H.runtimeCalculationMode;var Lb=ia.$.da.za(268);Lb&&Lb.Jxd(3===H.runtimeCalculationMode);ib(null)})};c.prototype.TVj=
function(H){Ee.a.sAb(this.$)&&this.$.da.za(331).ecb(0,H.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.SVj=function(){Ee.a.sAb(this.$)&&this.$.da.za(331).ecb(1,null,!0,!0,null);return Promise.resolve(null)};c.prototype.PVj=function(){Ee.a.sAb(this.$)&&this.$.da.za(331).rKe();return Promise.resolve(null)};c.prototype.QVj=function(H){Ee.a.sAb(this.$)&&this.$.da.za(331).ecb(5,H.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.RVj=function(H){if(Ee.a.sAb(this.$)){var ia=this.$.da.za(331);
ia=Gl(ia.naa);for(var ib=ia.next();!ib.done;ib=ia.next())ib=ib.value,ib.IsActive&&ib.HostEditUrl&&ib.UrlStr===H.hostEditUrlStr&&Gk.HelperMethods.mf(ib.HostEditUrl,"_blank")}return Promise.resolve(null)};c.prototype.ojj=function(H,ia){var ib=bk.a.cX;H=Bh.a.ni(H.payload);var Lb={};"eventId"in H&&"payload"in H&&(Lb.eventId=H.eventId,Lb.payload=H.payload);ia.xM(2201,ib,Bh.a.Jc(Lb));return Promise.resolve(null)};c.prototype.j4e=function(H,ia,ib){var Lb=this.$.da.za(5);Lb&&(H=this.uIh(H))&&(ia?Lb.removeEntry(H):
Lb.lle(H,ib))};c.prototype.uIh=function(H){switch(H){case 0:return 63}};c.prototype.BTc=function(H){H=Object(lj.a)(Je.a,this.$.xa.getItemByName(H));(null===H||void 0===H?0:H.visible)&&H.activate(!0)};c.prototype.Jcg=function(H,ia,ib,Lb){var Nc=H.ta.nt,Vc=Nc<ia.length&&ia[Nc].contains(H.ta.activeCell);H=Vc?H.ta.activeCell:ia[0].topLeft;Nc=Vc?Nc:0;vj.g(this.$).xV(ia,Nc,ib,null,H,null,null,3,Qi.a.ebh,void 0,void 0,void 0,6===Lb)};c.aZe=function(H){if(!H||!H.length)return null;for(var ia=Array(H.length/
2),ib=0;ib<H.length/2;ib++)ia[ib]={},ia[ib].Name=H[2*ib],ia[ib].Value=H[2*ib+1];return ia};c.XWh=function(H){if(!H||!H.length)return null;for(var ia=Array(2*H.length),ib=0;ib<H.length;ib++)ia[2*ib]=H[ib].Name,ia[2*ib+1]=H[ib].Value;return ia};c.tad=function(H){if(!H||!H.length)return null;for(var ia=Array(H.length),ib=0,Lb=H.length;ib<Lb;ib++){var Nc=H[ib].length;if(Nc){ia[ib]=Array(Nc);for(var Vc=0;Vc<Nc;Vc++)ia[ib][Vc]=null==H[ib][Vc]?null:H[ib][Vc].toString()}else return null}return ia};c.M2b=
function(H){return"string"===typeof H?ue.a.mq(c.$ah,H,0):H};c.gSe=function(H){return"string"===typeof H?ue.a.mq(c.cbh,H,0):H};c.leg=function(H){return"string"===typeof H?ue.a.mq(c.gbh,H,0):H};c.ofi=function(H){switch(H.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};c.yYc=function(H,ia){var ib={};ib.CoerceType=H;1===ib.CoerceType?(ib.Data=c.tad(ia.Rows),ib.Headers=c.tad(ia.Headers)):ib.Data=c.tad(ia);return ib};c.Pte=function(H){if(1===H.CoerceType){var ia=
{};return ia.Headers=H.Headers,ia.Rows=H.Data,ia}return H.Data};c.lfc=function(H){return 1===H.CoerceType?!H.Data&&!H.Headers:!H.Data};c.a1e=function(H){var ia="Unknown";if(!H)return ia;for(var ib=0;ib<H.length;ib++)if(H[ib].Name.toLowerCase()===Xh.a.Egj){ia=H[ib].Value;break}return ia};c.Tuj=function(H){if(!H)return!1;for(var ia=Xh.a.LDi.toLowerCase(),ib=0;ib<H.length;ib++)if(H[ib].Name.toLowerCase()===ia)return!0;return!1};c.a3a=function(H,ia,ib){var Lb={};Lb.Code=H;Lb.Message=ia;Lb.Location=ib;
Lb.ActionIndex=0;return Lb};Ck.Object.defineProperties(c.prototype,{wQ:{configurable:!0,enumerable:!0,get:function(){return this.Ee}}});Ck.Object.defineProperties(c,{$ah:{configurable:!0,enumerable:!0,get:function(){c.Ppa||(c.Ppa={},c.Ppa[Microsoft.Office.WebExtension.CoercionType.Table]=1,c.Ppa[Microsoft.Office.WebExtension.CoercionType.Text]=2,c.Ppa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,c.Ppa[Microsoft.Office.WebExtension.CoercionType.Html]=4,c.Ppa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=
5);return c.Ppa}},cbh:{configurable:!0,enumerable:!0,get:function(){c.whb||(c.whb={},c.whb[Microsoft.Office.WebExtension.FilterType.All]=1,c.whb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return c.whb}},gbh:{configurable:!0,enumerable:!0,get:function(){c.xhb||(c.xhb={},c.xhb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,c.xhb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return c.xhb}}});c.Ppa=null;c.whb=null;c.xhb=null;c.KCd=0;Object(fe.a)(c,"DdaMethodHandler",
null,[428,3]);var uk=yj.a;Wl(a,uk);a.prototype.Od=function(){var H=this,ia=hj.GetServiceTaskFactory.create(this.$.da,106,this.la,this.vb),ib=hj.GetServiceTaskFactory.create(this.$.da,165,this.la,this.vb),Lb=sc(this.la,this.vb);Nh.TaskExtensions.Ba(Nh.TaskExtensions.te([ia,ib,Lb],this.la),function(){var Vc=ia.result,Hd=Yd.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");H.Cd([new c(H.$,Vc,Hd)])},this.la,3);var Nc=Yd.a.instance;Nh.TaskExtensions.Ba(hj.GetServiceTaskFactory.create(this.$.da,
137,this.$.la,this.vb),function(){Nc.register(La,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Hc().Oc(function(){return new La})},this.$.la)};a.ka=function(H){yj.a.ee(82,new a(H))};Object(fe.a)(a,"DdaCommandHandlerFactory",yj.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");
Type.registerNamespace("_Ewa");Pg.a.Ji("");Pg.a.Ji(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Vh.a;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.WopiIdentity");yd.main();(function(){bg.a.Fa(function(H){If.ka(H)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");
Type.registerNamespace("Common.App.AppsForOfficeCommon");(function(){bg.a.Fa(function(H){te.ka(H);Kd.ka(H)})})();(function(){bg.a.Fa(function(H){Te.ka(H)})})();Type.registerNamespace("CommandUI.AddInCommands");(function(){bg.a.Fa(function(H){Fg.EwaSettings.ma(54)&&ub.ka(H)})})();(function(){bg.a.Fa(function(H){Fg.EwaSettings.ma(122)&&ad.ka(H)})})();bg.a.Fa(zb.ka);bg.a.Fa(Vb.ka);Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");(function(){bg.a.Fa(function(H){Nb.ka(H);
Ra.ka(H);la.ka(H)})})();bg.a.Fa(a.ka)},1479:function(y,C,b){function a(){this.xEc=null;this.hJc=0;this.NKc=!1;this.Za=new f.a;this.Lpg=new e.a}function c(){this.pJe=this.displayName=this.Hqb=this.Ho=this.xB=null;this.isUpgraded=!1}y=b(0);var e=b(202),f=b(97);c.prototype.Gff=function(l,n){return this.xB.getStoreType().toLowerCase()===l.toLowerCase()&&this.xB.getSolutionId().toLowerCase()===n.toLowerCase()};Object(y.a)(c,"AddinCommandsResourceItem",null,[]);b.d(C,"a",function(){return a});a.prototype.dDg=
function(l){this.Za.addHandler("AddinCommandsLoadingMessageChanged",l)};a.prototype.D9i=function(l){this.Za.removeHandler("AddinCommandsLoadingMessageChanged",l)};a.prototype.Fcb=function(l){l!==this.xEc&&(this.xEc=l,this.Za.raiseEvent("AddinCommandsLoadingMessageChanged"))};a.prototype.Wmj=function(){this.hJc++;this.HYa||this.Fcb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.RNd=function(){this.hJc--;this.btd()&&(this.NKc?this.HYa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Fcb(CommonUIStrings.l_ErrorLoadingAddInsTitle):
this.Fcb(null))};a.prototype.lYf=function(l){this.NKc=!0;this.Fcb((void 0===l?0:l)?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)};a.prototype.Kxe=function(){this.NKc=!1;this.btd()?this.Fcb(null):this.Fcb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.btd=function(){return 0>=this.hJc};a.prototype.Ria=function(l,n,m){m=void 0===m?0:m;for(var h=Gl(this.s5a),x=h.next();!x.done;x=h.next())if(x=x.value,x.Gff(l,n)&&(!x.Ho||x.Ho.XFh===m))return x;
return null};a.prototype.fle=function(l,n,m,h){var x=new c;x.xB=l;x.Ho=n;x.Hqb=m;x.displayName=h;this.s5a.add(x)};a.prototype.jBg=function(l,n,m,h){var x=new c;x.xB=l;x.Ho=n;x.Hqb=null;x.pJe=m;x.displayName=h;this.s5a.add(x)};a.prototype.e8i=function(l,n){for(var m=0,h=Gl(this.s5a),x=h.next();!x.done;x=h.next())x=x.value,x.xB.getStoreType()===l&&x.xB.getSolutionId()===n?this.s5a.removeAt(m):m++};a.getInstance=function(){a.Ma||(a.Ma=new a);return a.Ma};Ck.Object.defineProperties(a.prototype,{HYa:{configurable:!0,
enumerable:!0,get:function(){return this.xEc}},s5a:{configurable:!0,enumerable:!0,get:function(){return this.Lpg}}});a.Ma=null;Object(y.a)(a,"AddinCommandsResourceManager",null,[])},941:function(y,C,b){function a(){}b.d(C,"a",function(){return a});y=b(0);var c=b(35);a.yUe=function(e){return c.a.mq(a.Myi,e.toString(),a.internalError)};Ck.Object.defineProperties(a,{Myi:{configurable:!0,enumerable:!0,get:function(){var e={};return a.Eae||(a.Eae=(e["-2002156328"]=a.pze,e["-1954750170"]=a.v1e,e["317650254"]=
a.dZg,e["-1005263101"]=a.Pbi,e["1353664579"]=a.Gkj,e["159671765"]=a.Qbi,e["1446690022"]=a.JXe,e["1150069548"]=a.ZAc,e["-1409306331"]=a.iwe,e["338507772"]=a.rFe,e["-457159301"]=a.wUi,e["-1037701970"]=a.Bah,e["-1893322318"]=a.Vbi,e["965579896"]=a.Dah,e["93287890"]=a.Cah,e["358088857"]=a.Inj,e["-1223650923"]=a.rFe,e["2007306190"]=a.UUg,e["1549955423"]=a.Xse,e["-1275974171"]=a.Ubi,e["382101082"]=a.HTi,e["-898776235"]=a.zAi,e["335464256"]=a.oAi,e["1677378049"]=a.Tbi,e["-261992848"]=a.YMj,e["-980820954"]=
a.Xse,e["-931375837"]=a.GTi,e["929186550"]=a.gih,e["-982144310"]=a.t0i,e["-785741187"]=a.Nbi,e["2125217573"]=a.Xbi,e["299124955"]=a.Obi,e["1669853884"]=a.Tgj,e["-1515932330"]=a.eZg,e["314621024"]=a.uCh,e["-300049690"]=a.YUg,e["14766835"]=a.Gsj,e["-1251992761"]=a.tIe,e["-2087635043"]=a.invalidOrTimedOutSession,e["2100961153"]=a.invalidOrTimedOutSession,e["-1218744139"]=a.invalidSheetName,e["-1468309555"]=5006,e["-315732528"]=a.invalidOrTimedOutSession,e["611268539"]=a.invalidOrTimedOutSession,e["1531005923"]=
5006,e["1593924569"]=5006,e["299476328"]=a.pFa,e["49173765"]=a.pFa,e["-907155566"]=a.pFa,e["-1201603824"]=a.pFa,e["1541165282"]=a.pFa,e["-1347753427"]=a.pFa,e["134912532"]=a.pFa,e["1780971550"]=a.responsePayloadSizeLimitExceeded,e))}}});a.success=0;a.pze=1E3;a.v1e=1001;a.dZg=1002;a.Pbi=1003;a.Gkj=1004;a.Qbi=1005;a.JXe=1008;a.VRe=1009;a.invalidSheetName=1014;a.ZAc=2E3;a.iwe=2001;a.rFe=2002;a.wUi=2003;a.Bah=2004;a.Vbi=2005;a.Dah=2007;a.Cah=2008;a.Inj=2009;a.UUg=2014;a.okj=3E3;a.Xse=3002;a.Ubi=3004;
a.HTi=3005;a.zAi=3006;a.oAi=3007;a.Tbi=3008;a.YMj=3009;a.GTi=3010;a.Gsj=4002;a.QBd=5E3;a.internalError=5001;a.tIe=5002;a.cyb=5004;a.ZNj=5007;a.B7h=5008;a.GOg=5009;a.invalidOrTimedOutSession=5012;a.hDc=5016;a.pFa=5102;a.Qdj=5103;a.responsePayloadSizeLimitExceeded=5104;a.pUg=7001;a.y4f=7002;a.gih=8E3;a.t0i=8001;a.Nbi=8010;a.Xbi=8011;a.Obi=8012;a.Tgj=8020;a.eZg=8021;a.uCh=8022;a.YUg=8023;a.syi=11E3;a.oBi=11001;a.Wbi=11002;a.Eae=null;Object(y.a)(a,"DdaErrorIds",null,[])},942:function(y,C,b){function a(){}
b.d(C,"a",function(){return a});y=b(0);a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.notImplemented="NotImplemented";a.cTc="AccessDenied";a.notSupported="NotSupported";a.apiNotAvailable="ApiNotAvailable";a.notAllowed="NotAllowed";a.NBd="OperationCancelled";a.userNotSignedIn="UserNotSignedIn";a.userAborted="UserAborted";a.bOj="UnsupportedUserIdentity";a.invalidResourceUrl="InvalidResourceUrl";a.invalidGrant="InvalidGrant";a.cHg="AddinIsAlreadyRequestingToken";a.qfj="ResourceNotAllowed";
a.clientError="ClientError";a.serverError="ServerError";a.X1g="ControlIdNotFound";a.egj="RibbonApiNotAvailable";a.hostRestartNeeded="HostRestartNeeded";a.invalidRibbonDefinition="InvalidRibbonDefinition";a.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(y.a)(a,"ErrorCodes",null,[])},944:function(y,C,b){function a(sa,ob){var Wb=Xd.call(this)||this;Wb.ea=null;Wb.En=null;Wb.hi=null;Wb.If=[];Wb.DIa=null;Wb.WEe=!1;Wb.bPb=!1;Wb.initialized=!1;Wb.disposed=!1;Wb.SBa=null;Wb.Uoc=[];Wb.REe=[];
Wb.bPa=[];Wb.U0a=null;Wb.WCd=new bc.a(Vb.a.Qk());Wb.IZb=new mc.a(Vb.a.Qk());Wb.KFb=[];Wb.DFf=[];Wb.R5b=350;Wb.Yea=null;Wb.lxa=null;Wb.NSc=!1;Wb.Eee=null;Wb.Bee=null;Wb.Fee=null;Wb.Dee=null;Wb.Hee=null;Wb.xug=null;Wb.Cee=null;Wb.Gee=null;Wb.Iee=null;Wb.Jee=null;Wb.Kee=null;Wb.Hf=function(){Wb.SBa=Wb.ea.Qm.WebExtensions;for(var hc=Wb.If.length-1;0<=hc;--hc){var pc=Wb.If[hc],xd;if(xd=!Wb.lAh(pc.controlId))xd=pc,xd=Ib.EwaSettings.ma(122)?!xd.VHa:!0;xd&&(pc.Pmc(),Array.removeAt(Wb.If,hc))}if(Wb.SBa)for(hc=
0,pc=Wb.SBa.length;hc<pc;hc++){xd=Wb.SBa[hc];var Gd=Wb.kn(xd.WebExtensionId);Gd&&Gd.oAd(xd)}};Wb.Onc=function(hc){Wb.raiseEvent("csc",hc.getID())};Wb.vzf=function(hc,pc,xd){if(Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&pc===OSF.AgaveHostAction.KeyboardShortcuts){var Gd=Object(sb.a)(Object,xd);pc={};pc.keyCode=Gd.keyCode;pc.type="keydown";pc.ctrlKey=Gd.ctrlKey;pc.shiftKey=Gd.shiftKey;pc.altKey=Gd.altKey;pc.metaKey=Gd.metaKey;hc=Wb.kn(hc);Gd=hc.fha;pc.srcElement=
Object(Yb.a)(475,Gd)?Gd.UFa:Qa.g(Wb.$).wc;pc=new Sys.UI.DomEvent(pc);hc={focusedAddinId:a.Wua(hc.ml,Wb.$)};Gd=new Qc.a(1461300262,1,Wb.$.Xc,6,null);Qa.g(Wb.$).QIb(pc,Gd,hc)}else if(pc===OSF.AgaveHostAction.Select)Wb.g4e(!0);else if(pc===OSF.AgaveHostAction.UnSelect)Wb.g4e(!1);else if(pc===OSF.AgaveHostAction.CancelDialog)Wb.ZJ(-684355545,null);else if(pc===OSF.AgaveHostAction.InsertAgave)hc={},xd&&(hc[zc.a.Yra]=xd,hc[ja.a.pg]=a.orb(xd),Wb.ZJ(-741808261,hc));else if(pc===OSF.AgaveHostAction.InsertDevManifest)hc=
{},xd&&(hc[zc.a.Yra]=xd,hc[ja.a.pg]=a.orb(xd),Wb.ZJ(-741808261,hc));else if(pc===OSF.AgaveHostAction.InsertDevManifestError)hc=Object(sb.a)(Object,xd),pc={},hc=(pc[zc.a.yVc]=Wb.En.getDevManifestInvalidUrlErrorString(hc.manifestUrl),pc),Wb.ZJ(-2025863019,hc);else if(pc===OSF.AgaveHostAction.NotifyHostError)hc={},hc=(hc[zc.a.yVc]=Wb.En.getManifestInvaildErrorString(),hc),Wb.ZJ(-2025863019,hc);else if(pc===OSF.AgaveHostAction.RefreshAddinCommands)Ib.EwaSettings.ma(54)&&Wb.ZJ(dc.a.refreshAddinCommands,
null);else if(pc===OSF.AgaveHostAction.CtrlF6Exit||pc===OSF.AgaveHostAction.CtrlF6ExitShift){if(Gd=Wb.$.da.za(15)){(hc=Wb.kn(hc).fha)&&hc.Dyc();mb.a.Nf&&document.activeElement.blur();var te={keyCode:117,type:"keydown",ctrlKey:!0};te.shiftKey=pc===OSF.AgaveHostAction.CtrlF6ExitShift;te.srcElement=Object(Yb.a)(475,hc)?hc.UFa:Qa.g(Wb.$).wc;hc=new Sys.UI.DomEvent(te);Gd.ema(hc)}}else if(pc===OSF.AgaveHostAction.PageIsReady){if((hc=Wb.kn(hc).fha)&&hc.PYa===OSF.OsfControlTarget.TaskPane&&(hc=Wb.$.da.za(183))&&
Wb.If)for(pc=hd.a.Ld(Wb.$),Gd=Gl(Wb.If),te=Gd.next();!te.done;te=Gd.next())a.QLa(te.value.BU)&&(pc?hc.eg(!0,!1):hc.setFocusOnToolbarFirstElement())}else if(pc===OSF.AgaveHostAction.TabExit){pc=Wb.kn(hc);var Sd=pc.fha;if(Sd)if(Sd.PYa===OSF.OsfControlTarget.InContent)Sd.dif();else{if(Sd.PYa===OSF.OsfControlTarget.TaskPane)if(hd.a.Ld(Wb.$))mb.a.Nf&&document.activeElement.blur(),Eb.UISurfaces.$j().then(function(Ef){var pg=Object(Yb.a)(475,Sd)?Sd:null;pg?pg.isResizable?Ef.focusResizeHandle():Ef.focusTabbedTaskPaneArea():
Ef.focusTabbedTaskPaneArea();return null});else if(hc=Wb.$.da.za(183))mb.a.Nf&&document.activeElement.blur(),(pc=document.getElementById(Wb.$.Mb+vc.a.Xlc))&&kd.DOMElementExtensions.isVisible(pc)?kd.DOMElementExtensions.setFocus(pc):hc.setFocusOnToolbarFirstElement()}else pc&&4===pc.osfControlType&&Wb.En.notifyAgave(hc,OSF.AgaveHostAction.TabIn)}else if(pc===OSF.AgaveHostAction.TabExitShift)(pc=Wb.kn(hc),Gd=pc.fha)?Gd.PYa===OSF.OsfControlTarget.InContent?Gd.eif():Gd.PYa===OSF.OsfControlTarget.TaskPane&&
(hc=Object(Yb.a)(475,Gd)?Gd:null)&&(mb.a.Nf&&document.activeElement.blur(),hc.uYf()):pc&&4===pc.osfControlType&&Wb.En.notifyAgave(hc,OSF.AgaveHostAction.TabIn);else if(pc===OSF.AgaveHostAction.EscExit||pc===OSF.AgaveHostAction.ExitNoFocusable||pc===OSF.AgaveHostAction.ExitNoFocusableShift)if(Gd=Wb.kn(hc).fha)Gd.Dyc();else{if(pc===OSF.AgaveHostAction.EscExit){pc=null;Gd=Gl(Y.QZh());for(te=Gd.next();!te.done;te=Gd.next())if(te=te.value,te.value.Ne===hc){te.value.dialog.hide();pc=te.key;break}pc&&(hc=
Wb.kn(pc))&&4!==hc.osfControlType&&Wb.Ei.notifyAgave(pc,OSF.AgaveHostAction.TabIn)}}else if(pc===OSF.AgaveHostAction.InstallCustomFunctions)if(Ib.EwaSettings.ma(122)){dg.a(Wb.$).WTe(function(){return!1});var If=Wb.$.da;ma.TaskExtensions.Ba(kc.GetServiceTaskFactory.Xa(If,278,279,1),function(Ef){Ef=Ef.result;If.za(278)||If.Ga(278,Ef);var pg=xd.osfControl.getStoreType();Ef.t$e(xd.osfControl.getSolutionId(),pg,a.dLh(xd.osfControl),xd).lna()},Wb.la,3)}else tb.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");
else if(pc===OSF.AgaveHostAction.UninstallCustomFunctions)if(Ib.EwaSettings.ma(122)){dg.a(Wb.$).WTe(function(){return!1});var pf=Wb.$.da;ma.TaskExtensions.Ba(kc.GetServiceTaskFactory.Xa(pf,278,279,1),function(Ef){Ef=Ef.result;pf.za(278)||pf.Ga(278,Ef);Ef.iag(xd.solutionId,xd.storeType).lna()},Wb.la,3)}else tb.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else pc===OSF.AgaveHostAction.SendTelemetryEvent?e(xd):pc===
OSF.AgaveHostAction.SendCustomerContent?c(xd):pc===OSF.AgaveHostAction.LaunchExtensionComponent?Tb.a.instance.Bpi(xd):pc===OSF.AgaveHostAction.RefreshRibbonGallery?(hc=Wb.$.da.za(352))&&hc.Yhd(xd):pc===OSF.AgaveHostAction.RemoveAppCommandsAddin?(Wb.f9i(xd.solutionId),hd.a.Ld(Wb.$)||(hc=Wb.$.da.za(183))&&hc.gx(),Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&Ra.AFrameworkApplication.Ib.se(dc.a.KNf,2,xd.solutionId)):pc===OSF.AgaveHostAction.GetOriginalControlId&&
(hc=new nb.a(Wb.$.Mb,xd.ownerAddinSolutionId,new ad.a,!0),xd.originalControlId=hc?hc.hFe(xd.controlId):xd.controlId)};Wb.zSi=function(){Wb.$.qa&&Ke.o(Wb.$.qa)&&Wb.$.da.za(34).ild()};Wb.vd=function(){Wb.dkf()};Wb.ER=function(hc,pc){var xd,Gd;1===pc.Dp&&(hc=pc.Pf)&&(pc=new l(je.toTimestamp(hc.enqueueUtcTime),je.toTimestamp(hc.processUtcTime),je.toTimestamp(hc.dequeueUtcTime),je.getElapsedMilliseconds(hc.enqueueUtcTime,hc.processUtcTime),je.getElapsedMilliseconds(hc.processUtcTime,hc.dequeueUtcTime),
hc.operationCount,(null===(Gd=null===(xd=hc.operation)||void 0===xd?void 0:xd.rd)||void 0===Gd?0:Gd.ServerCorrelationId)?hc.operation.rd.ServerCorrelationId:null,hc.operation?Enum.toString(Ac.a,hc.operation.operationName):null,lc.a.jB(je.getElapsedMilliseconds(hc.enqueueUtcTime,Zd.a.Ua.Vb))),xd=Sys.Serialization.JavaScriptSerializer.serialize(pc),tb.ULS.sendTraceTag(50872916,0,50,xd))};Wb.od=function(hc,pc){!Wb.ea.rc&&Af.a(pc)?(Array.forEach(Wb.If,Wb.gvf),Array.clear(Wb.If),Wb.bPb=!1):(pc.EH&&(tb.ULS.sendTraceTag(537170516,
0,50,"Silent Reload require reset osf controls."),Wb.hSf()),Wb.RK(),Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(Wb.bPb=!1))};Wb.Fo=function(){Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(tb.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),Wb.hSf());Wb.RK();Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(Wb.bPb=!1)};
Wb.gvf=function(hc){hc.Pmc();Wb.raiseEvent("cd",hc.controlId)};Wb.xb=sa;Wb.QVc=ob;Wb.initialize();aa.ka(Wb);Wb.iTf=0;(sa=(sa=!(mb.a.pp||mb.a.Cka))&&(!Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||!mb.a.Nf))&&OfficeExt.ShortcutKeyDispatchManager.init();Wb.Mpg={};return Wb}function c(sa){Fd.a.sendOtelCustomerContent(Object.assign(new re.a,{otelEvent:sa}))}function e(sa){Fd.a.sendOtelEvent(Object.assign(new re.a,{otelEvent:sa}))}function f(sa,ob,Wb){var hc=
he.call(this,Wb,sa)||this;hc.hashCode=null;hc.Eva=null;hc.E3b=!1;hc.Sm=function(pc,xd){xd.nd.hash===hc.hashCode&&hc.Eva&&Object(sb.a)(b(944).DdaFacade,hc.$.da.za(35)).jyj(hc.Eva.InstanceId)};hc.yf=function(pc,xd){switch(xd.nd.block.state){case 1:case 3:case 5:hc.Fna(xd)}};hc.Oi=function(){hc.JGb(!0)};hc.Do=function(pc,xd){hc.isVisible&&hc.rTa(xd.BF);hc.clearCache()};hc.Ge=function(pc,xd){hc.tSa(xd.qa,!!xd.BF)};hc.AN=function(){hc.$.ea.nma()};hc.XTa=ob;hc.domElement.classList.add(wb.a.A8b);hc.domElement.classList.add(lf.a.Zo);
Wb.tabIndex=0;hc.tSa(hc.$.qa,!1);hc.Kc.ka("mousedown",hc.AN);hc.Kc.ka("contextmenu",function(pc){Id.g(pc)});hc.$.xa.pJ(hc.Do);hc.$.Hb.pJ(hc.Do);hc.$.Hb.og(hc.Ge);hc.$.xa.og(hc.Ge);hc.Ea.Qs(hc.yf);hc.Ea.EG(hc.Sm);hc.Ea.yx(hc.Oi);Ib.EwaSettings.qc()&&hc.Mt(hc.iya);return hc}function l(sa,ob,Wb,hc,pc,xd,Gd,te,Sd){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;
this.IsDocumentHidden=!1;this.enqueueUtcTime=sa;this.processUtcTime=ob;this.dequeueUtcTime=Wb;this.inQueueDurationInMS=hc;this.executionDurationInMS=pc;this.operationCount=xd;this.ServerCorrelationId=Gd;this.UserOperationName=te;this.IsDocumentHidden=Sd}function n(sa,ob,Wb){this.$=sa;this.hj=ob;this.runtimeCalculationMode=Wb}function m(){}function h(sa,ob,Wb){var hc=this;this.kEf=null;this.ead=function(pc,xd){var Gd=Hc.a.cX,te={};te.eventId=pc;te.payload=xd;hc.hj.c_(2201,Gd)&&hc.hi.xM(2201,Gd,gc.a.Jc(te))};
this.$=sa;this.hj=ob;this.hi=Wb;this.j$h()}function x(sa,ob,Wb){var hc=this;this.qHb=0;this.Nfg=!0;this.b$b=0;this.Gpd=!0;this.nxe=function(){var pc=document.hasFocus();if(hc.Nfg!==pc){if(pc){var xd=gc.a.Jc({});hc.hi.xM(2203,Hc.a.cX,xd)}hc.Nfg=pc}};this.oxe=function(pc){(0<pc.timeRemaining()||pc.didTimeout)&&hc.nxe();window.requestIdleCallback(hc.oxe)};this.$=sa;this.hj=ob;this.hi=Wb;window.requestIdleCallback||(this.Gpd=!1)}function u(sa,ob,Wb){var hc=this;this.pHb=0;this.J$a=this.Q$a=null;this.qDf=
function(){var pc=Qa.g(hc.$).ha.Oa.wC;if(pc)if(hc.nhf(pc)){var xd=hc.pja();hc.gad(xd);hc.Q$a=pc.floatingObject.id;hc.J$a=xd}else hc.Q$a&&(hc.gad(hc.J$a),hc.Q$a=null,hc.J$a=null);else hc.Q$a&&(hc.gad(hc.J$a),hc.Q$a=null,hc.J$a=null)};this.$=sa;this.hj=ob;this.hi=Wb}function w(sa,ob,Wb){var hc=this;this.z2b=null;this.Hqd=!1;this.onPointerDown=function(pc){if(3===pc.zb){var xd=hc.gridView.cac(pc.clientPoint).G_a;hc.Hqd=!!xd&&hc.gridView.ha.ta.uIe(xd)}else hc.Hqd=!1;hc.z2b=pc.clientPoint;return!1};this.xd=
function(pc){if(hc.gridView.inRangePicker||hc.gridView.Li||hc.Hqd||pc.shiftKey||pc.ctrlKey||pc.Ca.button!==Sys.UI.MouseButton.leftButton||!hc.z2b||!pc.clientPoint||pc.clientPoint.x!==hc.z2b.x||pc.clientPoint.y!==hc.z2b.y)return!1;var xd=hc.gridView.cac(pc.clientPoint);pc=xd.G_a;xd=xd.returnValue;var Gd=Object(sb.a)(Xc.a,hc.$.xa.qa);if(xd&&Gd&&0===Gd.tI){if(!hc.gridView.ha.ta.r4.contains(pc))return!1;pc=new v(Gd,pc,xb.HelperMethods.eDd(xd.x),xb.HelperMethods.eDd(xd.y));hc.TSi(pc)}return!1};this.$=
sa;this.gridView=Qa.g(sa);this.hj=ob;this.hi=Wb;this.D7i()}function v(sa,ob,Wb,hc){var pc=pe.call(this)||this;pc.sheet=sa;pc.RUg=ob;pc.offsetX=Wb;pc.offsetY=hc;return pc}function t(sa,ob,Wb){var hc=this;this.uNf=this.tNf=this.vNf=this.sNf=0;this.PSi=function(pc,xd){pc=Object(sb.a)(Xc.a,xd.qa);hc.e7a(pc)&&(xd={},xd.worksheetId=pc.sheetId,xd=gc.a.Jc(xd),hc.Uia(11,pc.sheetId,xd))};this.SSi=function(pc,xd){pc=Object(sb.a)(Xc.a,xd.BF);hc.e7a(pc)&&(xd={},xd.worksheetId=pc.sheetId,xd=gc.a.Jc(xd),hc.Uia(12,
pc.sheetId,xd))};this.QSi=function(pc,xd){pc=Object(sb.a)(Xc.a,xd.qa);hc.e7a(pc)&&(xd={},xd.worksheetId=pc.sheetId,pc=gc.a.Jc(xd),hc.Uia(11,null,pc,!0))};this.RSi=function(pc,xd){pc=Object(sb.a)(Xc.a,xd.BF);hc.e7a(pc)&&(xd={},xd.worksheetId=pc.sheetId,pc=gc.a.Jc(xd),hc.Uia(12,null,pc,!0))};this.$=sa;this.hj=ob;this.hi=Wb}function z(sa,ob,Wb){var hc=this;this.VPa=this.UPa=0;this.CGa=this.Bha=null;this.pwf=function(){var pc=Qa.g(hc.$).ha.Oa.wC;if(0<hc.VPa&&hc.Bha&&hc.CGa){var xd={};xd.shapeId=hc.Bha;
xd.worksheetId=hc.CGa;xd=gc.a.Jc(xd);hc.fireEvent(2102,hc.Bha,xd)}hc.gli(pc)?(hc.Bha=hc.uLj(pc),hc.CGa=hc.pja(),hc.Bha&&hc.CGa)?0<hc.UPa&&(pc={},pc.shapeId=hc.Bha,pc.worksheetId=hc.CGa,pc=gc.a.Jc(pc),hc.fireEvent(2101,hc.Bha,pc)):tb.ULS.sendTraceTag(537170458,344,10,"Something goes wrong, we got invalid shape id: '{0}', or worksheet id: '{1}' from a Floating object or gridview.",hc.Bha,hc.CGa):(hc.Bha=null,hc.CGa=null)};this.$=sa;this.hj=ob;this.hi=Wb}function D(sa,ob,Wb){sa=A.call(this,sa,ob,Wb)||
this;sa.zif=null;sa.yif=null;return sa}function A(sa,ob,Wb){var hc=Mc.call(this)||this;hc.zza=0;hc.TU=0;hc.ld=function(pc,xd){if(hc.enabled&&!(hc.sdf()||null!==xd&&void 0!==xd&&xd.Mgf)&&(pc=Object(sb.a)(Xc.a,hc.$.xa.qa))&&0===pc.tI){var Gd=pc.sheetId,te=hc.BXe(),Sd=null,If=null;hc.hj.Bgf()&&(Sd=hc.grid.Nb.rj(hc.grid.ha.ta.activeCell),If=Gd in hc.Xic?hc.Xic[Gd]:null);hc.bre(Gd,te)&&ma.TaskExtensions.Ba(Sb.Task.Sa(!0),function(){hc.l3h(Gd,te);hc.Y2h(Gd,te,Sd,If)},hc.la);hc.oIe(Gd,te,Sd)}};hc.$=sa;hc.hj=
ob;hc.hi=Wb;hc.grid=Qa.g(sa);hc.bNa={};hc.Xic={};return hc}function B(sa,ob,Wb){var hc=this;this.qNf=this.pNf=0;this.NKb=this.T$a=null;this.HFi=function(){var pc=Qa.g(hc.$).ha.Oa.wC;if(hc.Mmd(pc)&&(pc=hc.fac(pc))){var xd={chartId:pc};xd.worksheetId=hc.pja();xd=gc.a.Jc(xd);hc.Uia(51,pc,xd);hc.Uia(51,hc.pja(),xd)}};this.IFi=function(){if(hc.T$a){var pc={};pc.chartId=hc.T$a;pc.worksheetId=hc.NKb;pc=gc.a.Jc(pc);hc.Uia(52,hc.T$a,pc);hc.Uia(52,hc.NKb,pc)}pc=Qa.g(hc.$).ha.Oa.wC;hc.Mmd(pc)?(hc.T$a=hc.fac(pc),
hc.NKb=hc.pja()):(hc.T$a=null,hc.NKb=null)};this.$=sa;this.hj=ob;this.hi=Wb}function N(){this.JYa={}}function P(sa,ob,Wb,hc){hc=void 0===hc?!1:hc;var pc=Jd.call(this)||this;pc.hcb=0;pc.CE=null;pc.$va=!1;pc.vqc=null;pc.TU=0;pc.x1d=null;pc.cHc=null;pc.jVa=null;pc.y5b=null;pc.b9d=!1;pc.LZd=null;pc.zda=null;pc.eOc=null;pc.ld=function(){pc.enabled&&(pc.xlj(),pc.vqc=Jb.d(Qa.g(pc.$).ha.ta.selectedRanges))};pc.r4e=function(xd){xd.controlId===pc.ae.InstanceId&&Array.forEach(pc.CE,function(Gd){Gd.nxi(xd)&&
Gd.p1b(xd)})};pc.Usf=function(xd){if((xd=Object(sb.a)(475,xd))&&!xd.gs())if(!pc.ae||OSF.OsfControl.isFirstPartyStoreString(pc.ae.PrimaryMarketplace.MarketplaceType)||pc.$.dha){xd.vf=pc.ae;xd.wj=pc.Rg;pc.LZd=xd;pc.fwc(xd.UFa);var Gd=Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&hd.a.Ld(pc.$)&&xb.HelperMethods.Bw(pc.ae)&&pc.ae.Preload&&!pc.ae.TaskpaneVisible;Gd?xd.bAd():Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?
(xd.bAd(),(pc.ae.SharedRuntime&&1===pc.ae.SharedRuntime.LifeTime||pc.ae.SharedRuntimeId)&&!pc.ae.TaskpaneVisible&&xd.lg(!1)):((pc.ae.SharedRuntime&&1===pc.ae.SharedRuntime.LifeTime||pc.ae.SharedRuntimeId)&&!pc.ae.TaskpaneVisible&&xd.lg(!1),xd.bAd());pc.B5a||(hd.a.Ld(pc.$)?Gd||xd.E6():uc.a(pc.$).result.SF(xd,!0));pc.$.da.za(77).OOf(pc.Usf);pc.fha=Object(sb.a)(539,xd)}else tb.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};pc.onFloatingObjectControlAdded=function(xd,Gd){3===
Gd.control.floatingObject.type&&Gd.control.floatingObject.ml.InstanceId===pc.l1.WebExtensionId&&(pc.fha=Object(sb.a)(539,Gd.control),pc.fwc(Gd.control.Td.firstChild),bd.a(pc.$).zsc(pc.onFloatingObjectControlAdded))};pc.xb=sa.$;pc.Rg=sa;pc.ae=Wb;pc.ae.InstanceId=Wb.SrcLocationOverrideResourceId?sa.$2a(Wb.InstanceId,Wb.SrcLocationOverrideResourceId):Wb.InstanceId;pc.hi=ob;pc.l1={};pc.l1.WebExtensionId=Wb.InstanceId;pc.jEf="osfControl_"+Wb.InstanceId;pc.a6c="disabled_"+Wb.InstanceId;pc.l1.BindingData=
Wb.BindingData;pc.B5a=pc.Rg.B5a(Wb.InstanceId);pc.efc=pc.Rg.efc(Wb.InstanceId);pc.sce=Wb.WebExtensionOsfControlType;pc.vHf=hc;return pc}function Q(){}function M(sa,ob,Wb,hc,pc,xd,Gd,te){sa=lb.call(this,sa,ob,Wb)||this;sa.startRow=0;sa.startColumn=0;sa.rowCount=0;sa.columnCount=0;sa.startColumn=xd-hc.Reference.FirstColumn;sa.columnCount=te;xd=Math.max(pc,hc.Reference.FirstRow);pc=Math.min(pc+Gd-1,hc.Reference.LastRow);xd>pc?sa.startRow=sa.rowCount=void 0:(sa.startRow=xd-hc.Reference.FirstRow,sa.rowCount=
pc-xd+1);return sa}function ba(sa){var ob=this;this.CE=null;this.$va=!1;this.ld=function(){ob.CE.forEach(function(Wb){Wb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Wb.p1b(new bb.a(Wb.eventId,"",null))})};this.Rg=sa}function V(sa,ob){this.aB=null;this.pfa=sa;this.Bwg=ob}function aa(sa){var ob=this;this.Ei=this.vWc=null;this.YMi=function(Wb,hc){ob.handlers.yb(hc.controlId)&&(Wb=new G(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,hc.controlId,null,hc.messageType,hc.messageContent,
hc.messageOrigin,hc.targetOrigin),ob.handlers.oa(hc.controlId)(Wb),hc.messageType===OSF.DialogMessageType.DialogClosed&&ob.handlers.remove(hc.controlId))};this.XMi=function(Wb,hc){ob.$kc.yb(hc.controlId)&&(Wb=new E(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,hc.controlId,null,hc.messageType,hc.messageContent,hc.messageOrigin,hc.targetOrigin),ob.$kc.oa(hc.controlId)(Wb))};this.handlers=new nc.a;this.$kc=new nc.a;this.Rg=sa;this.h1a.zFg(this.YMi);this.h1a.yFg(this.XMi)}function E(sa,
ob,Wb,hc,pc,xd,Gd){sa=yb.call(this,sa,ob,Wb)||this;sa.messageType=0;sa.messageContent=null;sa.messageOrigin=null;sa.targetOrigin=null;sa.messageType=hc;sa.messageContent=pc;sa.messageOrigin=xd;sa.targetOrigin=Gd;return sa}function G(sa,ob,Wb,hc,pc,xd,Gd){sa=Xa.call(this,sa,ob,Wb)||this;sa.messageType=0;sa.messageContent=null;sa.messageOrigin=null;sa.targetOrigin=null;sa.messageType=hc;sa.messageContent=pc;sa.messageOrigin=xd;sa.targetOrigin=Gd;return sa}function I(sa,ob){var Wb=Ua.call(this)||this;
Wb.requests=[];Wb.K1b=!1;Wb.disposed=!1;Wb.Tf=function(){if(!Wb.disposed){Wb.grid.pc.Um(Wb.Tf);Wb.K1b=!1;var hc=Wb.requests;Wb.requests=[];hc=Gl(hc);for(var pc=hc.next();!pc.done;pc=hc.next())pc=pc.value,Wb.ddaFacade.ZJ(pc.command,pc.properties)}};Wb.ddaFacade=sa;Wb.grid=ob;return Wb}function R(){this.command=0;this.properties=null}function Y(sa){this.Za=new la.a;this.En=sa}function U(sa,ob,Wb,hc,pc){Wb=void 0===Wb?null:Wb;hc=void 0===hc?"":hc;pc=void 0===pc?"":pc;var xd=Ta.call(this)||this;xd.controlId=
sa;xd.messageType=ob;xd.messageContent=Wb;xd.messageOrigin=hc;xd.targetOrigin=pc;return xd}function ha(sa,ob,Wb,hc,pc){Wb=void 0===Wb?null:Wb;hc=void 0===hc?"":hc;pc=void 0===pc?"":pc;var xd=Da.call(this)||this;xd.controlId=sa;xd.messageType=ob;xd.messageContent=Wb;xd.messageOrigin=hc;xd.targetOrigin=pc;return xd}function ta(){this.height=this.width=0;this.Ne=this.controlId=this.pageUrl=null;this.Idc=this.j6c=!1}function xa(){}function oa(){this.dialog=this.Ne=null}function qa(sa,ob,Wb){var hc=Pa.call(this)||
this;hc.w9=null;hc.eSc="WACDialogTitleText";hc.ZUa="0";hc.hRb="15px";hc.Vlg="0px";hc.YUa="calc(100% - 30px)";hc.Ulg="100%";hc.dee=0;hc.Za=new la.a;hc.yjg=new ka;hc.ic=5;hc.SCa=Wb;hc.Ne=Wb;hc.zHc=sa;hc.t4d=ob;hc.OHc=!!Ra.AFrameworkApplication.fa&&Ra.AFrameworkApplication.fa.ra("OfficeAddinEnableInsertDialogAccessibilityFix");return hc}function Ea(){}function ka(){}function za(sa,ob){sa=La.call(this,1,sa,ob)||this;sa.daf=OfficeExt.CommandInvokeMode.ExclusiveForNew;return sa}function La(sa,ob,Wb){this._id=
sa;this.wjg=ob;this.Glg=Wb;this.daf=OfficeExt.CommandInvokeMode.Default}b.r(C);var Ia=b(0),Ya=b(7),tb=b(15),Tb=b(1353),va=b(82),la=b(97);La.prototype.execute=function(sa,ob,Wb){var hc=this;Wb=Wb||{};Wb.commandMode=this.daf;ob.invokeAppCommand(this.bHg,this.HZg,Wb,function(){sa.iNi(hc.id)})};Ck.Object.defineProperties(La.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},bHg:{configurable:!0,enumerable:!0,get:function(){return this.wjg}},HZg:{configurable:!0,enumerable:!0,
get:function(){return this.Glg}}});Object(Ia.a)(La,"AddinNativeActionBase",null,[309]);Wl(za,La);Object(Ia.a)(za,"AddinTakeSnapshotAction",La,[]);ka.prototype.v3g=function(sa){return new La(3,sa,this.EGh().getNativeActionName(3))};ka.prototype.EGh=function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()};Object(Ia.a)(ka,"AddinNativeActionManager",null,[282]);var $a=b(150);Ea.prototype.invokeAppCommand=function(sa,ob,Wb,hc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(sa,
ob,Wb,hc)};Ea.getInstance=function(){Ea.Ma||(Ea.Ma=new Ea);return Ea.Ma};Ea.Ma=null;Object(Ia.a)(Ea,"OSFAddinCommandsRuntimeManager",null,[281]);var Ra=b(4),eb=b(182),mb=b(24),Pa=$a.a;Wl(qa,Pa);qa.prototype.rFg=function(sa){this.Za.addHandler("OnDialogClosedEventKey",sa)};qa.prototype.zpj=function(){this.$Da=null};qa.prototype.jD=function(){Pa.prototype.jD.call(this);this.Lp.style.width="100%";this.Lp.style.height=this.ldc?this.YUa:this.Ulg;this.Lp.style.marginTop=this.ldc?this.hRb:this.Vlg;this.Lp.style.padding=
this.ZUa};qa.prototype.wO=function(){Pa.prototype.wO.call(this);this.Ob.style.width=String.format("{0}px",this.zHc*window.innerWidth/100);this.Ob.style.height=String.format("{0}px",this.t4d*window.innerHeight/100);this.Ob.style.minWidth="0px";this.OHc&&Ra.AFrameworkApplication.isRtl&&100===this.zHc&&(this.Ob.style.right="0px",this.Ob.style.marginRight="0px");this.w9=document.getElementById(this.oi(this.eSc));this.w9.style.position="absolute";this.w9.style.whiteSpace="nowrap";this.w9.style.textOverflow=
"ellipsis";Ra.AFrameworkApplication.isRtl?(this.w9.style.right="14px",this.w9.style.left="44px"):(this.w9.style.right="44px",this.w9.style.left="14px")};qa.prototype.zv=function(sa){Pa.prototype.zv.call(this,sa);this.w9&&this.w9.setAttribute("title",sa)};qa.prototype.nKd=function(){this.Ob.style.width=String.format("{0}px",this.zHc*window.innerWidth/100);this.Ob.style.height=String.format("{0}px",this.t4d*window.innerHeight/100);this.Ob.style.overflowY="hidden";this.Ob.style.overflowX="hidden";this.Ob.style.marginTop=
"";this.Ob.style.top="";mb.a.jR&&Ra.AFrameworkApplication.isRtl?(this.Ob.style.right="",this.Ob.style.marginRight=""):(this.Ob.style.left="",this.Ob.style.marginLeft="")};qa.prototype.hide=function(){var sa=this;this.yjg.v3g(this.SCa).execute(this,Ea.getInstance(),{});this.dee=window.setTimeout(function(){sa.Za.raiseEvent("OnDialogClosedEventKey",sa.SCa);eb.a.prototype.hide.call(sa)},500)};qa.prototype.iNi=function(sa){3===sa&&(window.clearTimeout(this.dee),this.Za.raiseEvent("OnDialogClosedEventKey",
this.SCa),Pa.prototype.hide.call(this))};Ck.Object.defineProperties(qa.prototype,{g1a:{configurable:!0,enumerable:!0,get:function(){return this.Lp}}});Object(Ia.a)(qa,"AppsForOfficeDialog",$a.a,[256,257]);Object(Ia.a)(oa,"DialogInfo",null,[]);xa.url="url";xa.height="height";xa.width="width";xa.j6c="displayInIframe";xa.Idc="hideTitle";Object(Ia.a)(xa,"DialogSettings",null,[]);Object(Ia.a)(ta,"DisplayDialogParams",null,[]);var Da=Sys.EventArgs;Wl(ha,Da);Object(Ia.a)(ha,"OnMessageDialogEventArgs",Sys.EventArgs,
[]);var Ta=Sys.EventArgs;Wl(U,Ta);Object(Ia.a)(U,"OnMessageParentEventArgs",Sys.EventArgs,[]);var Sa=b(41),Cb=b(29),cc=b(176),nc=b(99);Y.prototype.zFg=function(sa){this.Za.addHandler("OnMessageParentEventKey",sa)};Y.prototype.yFg=function(sa){this.Za.addHandler("OnMessageDialogEventKey",sa)};Y.prototype.showDialog=function(sa,ob,Wb,hc){if(Y.q8.yb(ob))tb.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else try{var pc=Sa.b(sa),xd=pc[xa.url];if(this.En.getOsfControl(ob).checkAppDomains(xd)){var Gd=new ta;Gd.width=pc[xa.width];Gd.height=pc[xa.height];Gd.pageUrl=xd;Gd.j6c=pc[xa.j6c];Gd.Idc=pc[xa.Idc];Gd.controlId=ob;Gd.Ne=cc.a.create().toString();var te=new oa;te.Ne=Gd.Ne;var Sd=this.En.getOsfControl(Gd.controlId).getManifest().getDefaultDisplayName(),If=this.En.getOsfControl(Gd.controlId).getStoreType().toLowerCase();sa=null;var pf=Ra.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",
!1);sa=(4===Ra.AFrameworkApplication.sa.Qa.Sj&&"hardcodedpreinstall"===If||pf&&"sdxcatalog"===If)&&Gd.Idc?this.createAndShowAppsForOfficeDialog(Gd.width,Gd.height,Gd.Ne,!0,Sd):this.createAndShowAppsForOfficeDialog(Gd.width,Gd.height,Gd.Ne,!1,Sd);var Ef=this.En.getOsfControl(Gd.controlId),pg=Ef.getManifest();pf={};pf.id=Gd.Ne;pf.solutionId=Ef.getSolutionId();pf.version=Ef.getVersion();pf.storeType=If;pf.storeId=Ef.getStoreId();pf.assetId=Ef.getAssetId();pf.assetStoreId=Ef.getAssetStoreId();pf.ownerAddinSolutionId=
Ef.getOwnerAddinSolutionId();pf.ownerAddinStoreType=Ef.getOwnerAddinStoreType();pf.appDomains=pg.getAppDomains();pf.dialogUrl=xd;pf.osfControlType=1;pf.agaveName=Sd;pf.div=sa.g1a;tb.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(pf.solutionId,pf.ownerAddinStoreType||pf.storeType,pf.assetId,null,null,pf.storeId),Cb.a.ew(Gd.pageUrl));this.En.insertDialogControl(pf);sa.rFg(Object(va.a)(this,this.zHi,"onDialogClosed"));te.dialog=
sa;Y.q8.ia(Gd.controlId,te);hc&&hc(pf);Wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else tb.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Ag){tb.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",Ag.message),Wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};Y.prototype.Pyi=function(sa,ob,Wb,hc){Ra.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===hc&&(hc=Wb);try{var pc=this.PJa(sa);pc&&this.Za.raiseEvent("OnMessageParentEventKey",new U(pc,OSF.DialogMessageType.DialogMessageReceived,ob,Wb,hc))}catch(xd){return tb.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",xd.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess};Y.prototype.E0c=function(sa,ob){if(Y.q8.yb(sa))try{var Wb=Y.q8.oa(sa);Wb.dialog&&Wb.dialog.hide();this.En.purgeDialogControl(Wb.Ne);
Y.q8.remove(sa);ob(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(hc){tb.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",hc.message),ob(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else tb.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),ob(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)};Y.prototype.nlj=function(sa,ob,Wb,hc){Ra.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===hc&&(hc=Wb);if(Y.q8.yb(sa)&&(sa=Y.q8.oa(sa),sa.dialog))try{this.Za.raiseEvent("OnMessageDialogEventKey",new ha(sa.Ne,OSF.DialogMessageType.DialogParentMessageReceived,ob,Wb,hc))}catch(pc){tb.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",pc.message)}};Y.prototype.PJa=function(sa){for(var ob=null,Wb=Gl(Y.q8),hc=Wb.next();!hc.done;hc=Wb.next())if(hc=hc.value,hc.value.Ne===sa){ob=hc.key;break}return ob};Y.prototype.zHi=function(sa,ob){if(sa=this.PJa(ob))this.En.purgeDialogControl(ob),
Y.q8.remove(sa),this.Za.raiseEvent("OnMessageParentEventKey",new U(sa,OSF.DialogMessageType.DialogClosed,null,null,"*"))};Y.prototype.createAndShowAppsForOfficeDialog=function(sa,ob,Wb,hc,pc){sa=new qa(sa,ob,Wb);pc=hc?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,pc);hc&&(sa.ldc=!1,sa.fv=!1);sa.initializeAndShow(pc,null,null);sa.zpj();return sa};Y.QZh=function(){return Y.q8};Y.getInstance=function(sa){Y.Ma||(Y.Ma=new Y(sa));return Y.Ma};Y.Ma=null;Y.q8=new nc.a;Object(Ia.a)(Y,"AppsForOfficeDialogManager",
null,[226]);var Nb=b(1057),nb=b(1364),db=b(1430),Bb=b(1140),zc=b(933),Eb=b(204),Ja=b(1365),Rb=b(120),yc=b(84),qd=b(91),bc=b(735),Vb=b(613),mc=b(892),sb=b(85),Yb=b(437),Hb=b(162),sc=b(202),zb=b(38),vc=b(5),ad=b(1071),ub=b(1314),Za=b(77);Object(Ia.a)(R,"DdaRequestInfo",null,[]);var wa=b(941),ja=b(79),Ua=Za.a;Wl(I,Ua);I.prototype.kch=function(sa,ob){this.disposed||(this.K1b||(this.grid.pc.Kn(this.Tf),this.K1b=!0),this.requests.push(Object(Ya.a)(new R,{command:sa,properties:ob})))};I.prototype.dispose=
function(){if(!this.disposed){this.disposed=!0;this.K1b&&this.grid.pc.Um(this.Tf);var sa=this.requests;this.requests=null;sa=Gl(sa);for(var ob=sa.next();!ob.done;ob=sa.next())ob=ob.value,(ob=ob.properties?ob.properties[ja.a.I3]:null)&&this.ddaFacade.wf(wa.a.cyb,ob);this.ddaFacade=this.grid=null;Ua.prototype.dispose.call(this)}};I.KZg=function(sa,ob){var Wb=!1;974713501===sa&&(ob=(sa=ob?ob[ja.a.pg]:null)?sa.DdaMethod:null)&&ob.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(Wb=
sa.ArrayData,Wb=!!Wb&&64===(Wb[6]&64));return Wb};Object(Ia.a)(I,"DdaCellEditDelayRequestHandler",Za.a,[]);var bb=b(973),Xa=bb.a;Wl(G,Xa);Object(Ia.a)(G,"DialogMessageReceivedEventArgs",bb.a,[]);var yb=bb.a;Wl(E,yb);Object(Ia.a)(E,"DialogParentMessageReceivedEventArgs",bb.a,[]);var Ib=b(1),Qa=b(22);aa.prototype.addHandler=function(sa,ob,Wb,hc){var pc=this;if(Ib.EwaSettings.ma(24))this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Wb);else{tb.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");
var xd=function(Gd){Gd===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(pc.handlers.ia(sa,ob),pc.Rg.Zu(Wb)):(tb.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),pc.Rg.wf(Gd,Wb))};this.handlers.yb(sa)?xd(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(sa,hc,xd)}};aa.prototype.aBg=function(sa,ob,Wb){Ib.EwaSettings.ma(24)?this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Wb):(tb.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),
this.$kc.ia(sa,ob),this.Rg.Zu(Wb))};aa.prototype.removeHandler=function(sa,ob){var Wb=this;Ib.EwaSettings.ma(24)?this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ob):this.handlers.yb(sa)?(tb.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.h1a.E0c(sa,function(hc){Wb.handlers.remove(sa);hc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?Wb.Rg.Zu(ob):(tb.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),
Wb.Rg.wf(hc,ob))})):this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,ob)};aa.prototype.$8i=function(sa,ob){Ib.EwaSettings.ma(24)?this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ob):(tb.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.$kc.remove(sa),this.Rg.Zu(ob))};aa.prototype.showDialog=function(sa,ob,Wb){var hc=this;try{Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&Qa.g(this.Rg.$).isEditing&&
Qa.g(this.Rg.$).Gp(!0),this.h1a.showDialog(ob,sa,Wb,function(pc){hc.Rg.sBg(hc.vRg(pc))})}catch(pc){tb.ULS.sendTraceTag(537170496,0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: {0}",pc.message),Wb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};aa.prototype.vRg=function(sa){var ob={};ob.InstanceId=sa.id;ob.WebExtensionType=sa.osfControlType===OSF.OsfControlTarget.InContent?0:1;ob.PrimaryMarketplace={};ob.PrimaryMarketplace.SolutionId=sa.solutionId;ob.PrimaryMarketplace.SolutionVersion=
sa.version;ob.PrimaryMarketplace.MarketplaceRef=sa.storeId;ob.PrimaryMarketplace.MarketplaceType=sa.storeType;return ob};aa.ka=function(sa){if(!sa.$.da.za(232)){var ob=new aa(sa);sa.$.da.Ga(232,ob)}};Ck.Object.defineProperties(aa.prototype,{h1a:{configurable:!0,enumerable:!0,get:function(){this.vWc||(this.vWc=Y.getInstance(this.contextActivationMgr));return this.vWc}},contextActivationMgr:{configurable:!0,enumerable:!0,get:function(){!this.Ei&&this.Rg&&(this.Ei=this.Rg.Ei);return this.Ei}}});Object(Ia.a)(aa,
"DialogMessageReceivedEventManager",null,[541]);V.prototype.mZb=function(sa){sa&&(this.aB||(this.aB=[]),this.aB.push(sa))};V.prototype.Hsc=function(sa){this.aB&&Array.remove(this.aB,sa)};V.prototype.nxi=function(sa){return this.eventId!==sa.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===sa.ddaBinding.Name:!0};V.prototype.p1b=function(sa){this.aB&&Array.forEach(this.aB,function(ob){ob(sa)})};
V.prototype.Sma=function(){this.aB=[]};Ck.Object.defineProperties(V.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.pfa}},targetId:{configurable:!0,enumerable:!0,get:function(){return this.Bwg}},L3h:{configurable:!0,enumerable:!0,get:function(){return 0<this.aB.length}}});Object(Ia.a)(V,"DdaEventRegistration",null,[]);ba.prototype.invokeDdaMethod=function(sa,ob){var Wb={};Wb[ja.a.pg]=sa;Wb[ja.a.I3]=ob;this.Rg.ZJ(974713501,Wb)};ba.prototype.registerDdaEventAsync=function(sa,
ob,Wb,hc,pc){ba.Nyb(sa)?(ba.cnd(sa)&&this.Djd(),this.CE||(this.CE=[]),ob=this.Dtb(sa,Wb),ob||(ob=new V(sa,Wb),this.CE.push(ob)),ob.mZb(hc),this.Rg.Zu(pc)):this.Rg.wf(-1,pc)};ba.prototype.unregisterDdaEventAsync=function(sa,ob,Wb,hc,pc){ba.Nyb(sa)?((sa=this.Dtb(sa,Wb))&&sa.Hsc(hc),this.Rg.Zu(pc)):this.Rg.wf(-1,pc)};ba.prototype.Djd=function(){this.$va||(Qa.g(this.Rg.$).ha.fE(this.ld),this.$va=!0)};ba.prototype.Dtb=function(sa,ob){if(!this.CE)return null;for(var Wb=0;Wb<this.CE.length;Wb++){var hc=
this.CE[Wb];if(hc.eventId===sa&&hc.targetId===ob)return hc}return null};ba.Nyb=function(sa){return sa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};ba.cnd=function(sa){return sa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};Object(Ia.a)(ba,"EmbeddingPage",null,[508]);var cb=b(207),lb=bb.a;Wl(M,lb);M.prototype.getStartRow=function(){return this.startRow};M.prototype.getStartColumn=function(){return this.startColumn};M.prototype.getRowCount=function(){return this.rowCount};
M.prototype.getColumnCount=function(){return this.columnCount};Object(Ia.a)(M,"DdaBindingSelectionEventArgs",bb.a,[]);var Ha=b(191),$b=b(25),Jb=b(45),kc=b(51),uc=b(438),hd=b(36),ma=b(37),jb=b(627),Zb=b(110),Ub=b(54),Qc=b(95),kd=b(12),xb=b(10),bd=b(104);Q.Arh="ewa-wx-disabled-div";Q.zrh="ewa-wx-container-div";Q.nNe="ewa-ptp-nov2-flex";Object(Ia.a)(Q,"CssClassNames",null,[]);var Qd=Q.Arh,zd=Q.zrh,Jd=cb.a;Wl(P,Jd);P.prototype.H$h=function(sa){this.zda||(this.zda=sa)};P.prototype.xOf=function(){this.zda&&
(this.zda.dispose(),this.zda=null)};P.prototype.Wkd=function(){var sa=this;if(!OSF.OsfControl.isFirstPartyStoreString(this.ae.PrimaryMarketplace.MarketplaceType)&&Ib.EwaSettings.ma(187)){var ob=kc.GetServiceTaskFactory.Xa(this.$.da,5,4,0);ma.TaskExtensions.Ba(ob,function(){ob.result.fg(35,null)},this.la,3);return this}if(1===this.ae.WebExtensionType)ma.TaskExtensions.Ba(uc.a(this.$),function(pc){pc.result.$qb(sa.$.da,77,6,sa.Usf,1)},this.la,3);else{var Wb=this.pSe(),hc=bd.a(this.$);Wb||(Wb={Type:3},
Wb.Id=this.l1.WebExtensionId,Wb.WebExtensionData=this.ae,Wb.ContentHtml="<div/>",Wb.Version=0,Wb.AbsoluteLeft=0,Wb.AbsoluteTop=0,Wb.AbsoluteRight=0,Wb.AbsoluteBottom=0,Wb.Width=0,Wb.Height=0,Wb.ZOrder=0,Wb.OriginDeltaX=0,Wb.OriginDeltaY=0,Wb=new Ha.a(Wb),hc.g4b(Wb,null),Wb=hc.Hq(Wb.Tg()));Wb?(this.fwc(Wb.Td.firstChild),this.fha=Object(sb.a)(539,Wb)):hc.dZb(this.onFloatingObjectControlAdded)}return this};P.prototype.r9e=function(sa){this.fwc(sa);return this};P.prototype.Pmc=function(){this.vHf||this.Rg.Ei.purgeOsfControl(this.controlId,
!1);this.fag(!0);var sa=this.pSe();sa&&bd.a(this.$).deleteFloatingObject(sa);this.Rg.hj.J8i(this.controlId);this.Rg.hj.uKe(this.controlId,!0);this.eOc=null};P.prototype.oAd=function(sa){this.l1=sa};P.prototype.invokeDdaMethod=function(sa,ob){if(Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var Wb={};Wb[ja.a.pg]=sa;Wb[ja.a.I3]=ob;this.Rg.ZJ(974713501,Wb)}else this.Rg.wf(wa.a.cyb,ob)};P.prototype.h6i=function(sa,ob,Wb,hc){if(Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||
this.enabled)if(!P.Hgh(sa)||void 0!==ob&&null!==ob&&void 0!==this.w2a(ob)&&null!==this.w2a(ob))if(tb.ULS.sendTraceTag(36444195,0,50,"eventId: {0}, targetId: {1}",sa,ob),P.Ibf(sa)&&this.E5h(),P.cnd(sa)&&this.Djd(),P.Gbf(sa))Ib.EwaSettings.ma(24)?this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,hc):this.Rg.$.da.za(232).addHandler(this.controlId,Wb,hc,ob);else if(P.Hbf(sa))Ib.EwaSettings.ma(24)?this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,hc):this.Rg.$.da.za(232).aBg(this.controlId,
Wb,hc);else{P.Fbf(sa)&&this.t4e(-1777565636,hc);this.CE||(this.CE=[]);var pc=this.Dtb(sa,ob);pc||(pc=new V(sa,ob),this.CE.push(pc));pc.Sma();pc.mZb(Wb);this.Rg.Zu(hc);sa===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.jVa&&(this.y5b=Wb)}else this.Rg.wf(3002,hc);else this.Rg.wf(-1,hc)};P.prototype.jNj=function(sa,ob,Wb,hc){P.Gbf(sa)?Ib.EwaSettings.ma(24)?this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,hc):this.Rg.$.da.za(232).removeHandler(this.controlId,hc):P.Hbf(sa)?
Ib.EwaSettings.ma(24)?this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,hc):this.Rg.$.da.za(232).$8i(this.controlId,hc):(P.Fbf(sa)&&this.t4e(1592314317,hc),ob=this.Dtb(sa,ob),this.enabled?(ob&&(ob.Hsc(Wb),ob.L3h||Array.remove(this.CE,ob),this.CE.length?P.Ibf(sa)&&this.gag(!1):this.fag(!1)),this.Rg.Zu(hc)):this.Rg.wf(-1,hc))};P.prototype.ka=function(sa){kd.DOMElementExtensions.getElementById(sa,this.jEf)||sa.appendChild(kd.DOMElementExtensions.zf(this.vy))};P.prototype.showHide=
function(sa){kd.DOMElementExtensions.setVisible(this.vy,sa)};P.prototype.resize=function(sa,ob){kd.DOMElementExtensions.Hr(this.vy,sa);kd.DOMElementExtensions.EI(this.vy,ob)};P.prototype.qHe=function(sa){if(!this.TU&&!kd.DOMElementExtensions.getElementById(this.vy,this.a6c)&&this.vy){var ob=document.createElement("div");ob.id=this.a6c;ob.className=Qd;ob.style.backgroundImage="url("+Ub.a.current.hp(82)+")";ob.style.opacity=sa?"1":"0";ob.style.backgroundRepeat="no-repeat";ob.style.backgroundPosition=
"center";this.vy.insertBefore(ob,this.vy.firstChild)}this.TU++};P.prototype.wjh=function(){0<this.TU&&this.TU--;this.TU||(kd.DOMElementExtensions.zf(kd.DOMElementExtensions.getElementById(this.vy,this.a6c)),this.$va&&!Jb.Q(this.vqc,Qa.g(this.$).ha.ta.selectedRanges)&&this.ld(null,null))};P.prototype.w2a=function(sa){if(!this.l1||!this.l1.BindingData)return null;for(var ob=0;ob<this.l1.BindingData.length;ob++)if(this.l1.BindingData[ob].Name===sa)return this.l1.BindingData[ob];return null};P.prototype.getDefaultIconUrl=
function(){var sa=this.$_e();return sa?sa.getDefaultIconUrl():null};P.prototype.getDefaultDisplayName=function(){if(this.ae.TaskpaneTitle)return this.ae.TaskpaneTitle;var sa=this.$_e();return sa?sa.getDefaultDisplayName():null};P.prototype.yIf=function(){if(this.jVa&&this.y5b){var sa=new bb.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.jVa);this.y5b(sa);this.y5b=this.jVa=null}};P.prototype.lg=function(sa){this.LZd&&this.LZd.lg(sa)};P.prototype.vnj=function(){var sa=this;
this.$.ea.isNamedObjectViewMode&&this.Aji()&&(this.$.da.za(34).unj(this.vy),this.showHide(!1));if(this.Rg.cVj){if(!this.vHf){var ob={};ob.div=this.vy;ob.id=this.ae.InstanceId;ob.solutionId=this.ae.PrimaryMarketplace.SolutionId;ob.version=this.ae.PrimaryMarketplace.SolutionVersion;ob.storeId=this.ae.PrimaryMarketplace.MarketplaceRef;ob.storeType=this.ae.PrimaryMarketplace.MarketplaceType;ob.ownerAddinSolutionId=this.ae.OwnerAddinSolutionId;ob.ownerAddinStoreType=this.ae.OwnerAddinStoreType;this.ae.AssetMarketplace&&
(ob.assetId=this.ae.AssetMarketplace.SolutionId,ob.assetStoreId=this.ae.AssetMarketplace.MarketplaceRef);ob.settings=this.ae.OsfPropertyBag;Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?ob.reason=this.B5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.efc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:ob.reason=this.B5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:
Microsoft.Office.WebExtension.InitializationReason.Inserted;ob.osfControlType=0===this.ae.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;ob.isForUILessAction=4===this.ae.WebExtensionOsfControlType;ob.sourceLocationOverrideResourceId=this.ae.SrcLocationOverrideResourceId;ob.focusOnIframeWhenLoaded=this.ae.FocusOnIframeWhenLoaded;jb.a(this.ae)&&(ob.featureGates=Ra.AFrameworkApplication.fa.ANh(ob.solutionId));ob.hostInfoFlags=0;this.VHa&&(ob.hostInfoFlags|=2);xb.HelperMethods.Bw(this.ae)&&
(ob.hostInfoFlags|=1);this.$.dha||(tb.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),ob.hostInfoFlags|=4);Ib.EwaSettings.ma(637)&&(ob.hostInfoFlags|=8);Ib.EwaSettings.ma(54)&&Ib.EwaSettings.ma(94)&&!this.cHc&&(ob.virtualOsfControlActivationCallback=function(){sa.Rg.tBd(sa.ae)});ob.sharedRuntimeId=this.ae.SharedRuntime?this.ae.SharedRuntime.Resid:this.ae.SharedRuntimeId;!xb.HelperMethods.Bw(this.ae)||this.ae.Preload||jb.a(this.ae)||this.Rg.Ei.getOsfControl(b(944).DdaFacade.getSolutionId(this.ae,
this.$))||(Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Rg.tBd(this.ae):this.Rg.tBd(this.ae));ob.initialDisplayMode=this.ae.TaskpaneVisible?2:1;Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(ob.titleOverride=this.ml.TaskpaneTitle);this.Rg.Ei.insertOsfControl(ob)}this.TU=0}else this.qHe(!0)};P.prototype.fag=function(sa){this.gag(sa);this.RMj()};P.prototype.E5h=function(){this.hcb||this.hi.mZb(this.r4e);
this.hcb++};P.prototype.gag=function(sa){0<this.hcb&&(sa?this.hcb=0:this.hcb--,this.hcb||this.hi.Hsc(this.r4e))};P.prototype.Djd=function(){if(!this.$va){var sa=Qa.g(this.$).ha;this.vqc=Jb.d(Qa.g(this.$).ha.ta.selectedRanges);sa.fE(this.ld);this.$va=!0}};P.prototype.RMj=function(){this.$va&&(Qa.g(this.$).ha.hI(this.ld),this.$va=!1)};P.prototype.pkj=function(sa){var ob=new $b.Range(sa.Reference.FirstRow+1,sa.Reference.FirstColumn+1,sa.Reference.LastRow+1,sa.Reference.LastColumn+1,!1,!1);1===sa.BindingType&&
(sa.HasHeaders&&--ob.top,sa.HasTotals&&(ob.bottom+=1));var Wb=Qa.g(this.$).ha.ta.selectedRanges;sa=ob.byb(this.vqc);Wb=ob.byb(Wb);return(ob=ob.Se(Qa.g(this.$).ha.ta.activeRange))&&(Zb.e(sa)&&!Zb.e(Wb)||!Zb.e(sa)&&!Zb.e(Wb)&&!Jb.Q(sa,Wb))?ob:null};P.prototype.xlj=function(){var sa=this;Array.forEach(this.CE,function(ob){if(ob.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&ob.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||sa.Rg.hj.G_b(sa.controlId))if(ob.eventId===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)ob.p1b(new bb.a(ob.eventId,sa.controlId,null));else if(ob.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){var Wb=sa.w2a(ob.targetId);if((null===Wb||void 0===Wb?0:Wb.IsValidRef)&&(sa.$.ea.isNamedObjectViewMode?sa.$.Hb.qa.sheetName:sa.$.xa.qa.name)===Wb.Reference.SheetName){var hc=sa.pkj(Wb);hc&&ob.p1b(new M(ob.eventId,sa.controlId,sa.Rg.w0b(Wb),Wb,hc.top-1,hc.left-1,hc.height,hc.width))}}})};P.prototype.Dtb=function(sa,ob){if(!this.CE)return null;
for(var Wb=0;Wb<this.CE.length;Wb++){var hc=this.CE[Wb];if(hc.eventId===sa&&hc.targetId===ob)return hc}return null};P.prototype.pSe=function(){for(var sa=bd.a(this.$).hV,ob=sa.length-1;0<=ob;--ob){var Wb=sa[ob];if(3===Wb.floatingObject.type&&Wb.floatingObject.ml.InstanceId===this.l1.WebExtensionId)return Wb}return null};P.prototype.Aji=function(){for(var sa=0;sa<this.$.Hb.count;sa++)if(this.$.Hb.getItem(sa).oLa===this.l1.WebExtensionId)return!0;return!1};P.prototype.fwc=function(sa){this.eOc=sa;this.vy.id=
this.jEf;this.vy.className=zd;this.vy.dir=this.$.isChromeRtl?"rtl":"ltr";this.vnj()};P.prototype.$_e=function(){if(!this.enabled)return null;var sa=jb.a(this.ml)?"":this.ml.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.ml.PrimaryMarketplace.SolutionId,sa)};P.prototype.t4e=function(sa,ob){if(Ib.EwaSettings.ma(24))this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ob);else try{if(tb.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),
4!==this.sce)this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,ob);else{var Wb={};Wb[zc.a.vnb]=this.controlId;var hc=new Qc.a(sa,0,this.$.isEditMode?2:1,0,null);this.$.Ka.Wb(hc,Wb);this.Rg.Zu(ob)}}catch(pc){tb.ULS.sendTraceTag(537170461,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: {0}.",pc.message),this.Rg.wf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,ob)}};P.Hgh=function(sa){return sa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||sa===
OSF.DDA.EventDispId.dispidBindingDataChangedEvent};P.Ibf=function(sa){return sa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||sa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||sa===OSF.DDA.EventDispId.dispidRichApiMessageEvent};P.cnd=function(sa){return sa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||sa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};P.Gbf=function(sa){return sa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent};P.Hbf=function(sa){return sa===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};P.Fbf=function(sa){return sa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent};Ck.Object.defineProperties(P.prototype,{controlId:{configurable:!0,enumerable:!0,get:function(){return this.ae.InstanceId}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.ae.WebExtensionType}},ownerAddinSolutionId:{configurable:!0,enumerable:!0,get:function(){return this.ae.OwnerAddinSolutionId}},$:{configurable:!0,enumerable:!0,
get:function(){return this.xb}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.TU}},vy:{configurable:!0,enumerable:!0,get:function(){return this.eOc}},BU:{configurable:!0,enumerable:!0,get:function(){return this.ae.SrcLocationOverrideResourceId?this.Rg.$2a(this.ae.PrimaryMarketplace.SolutionId,this.ae.SrcLocationOverrideResourceId):this.ae.PrimaryMarketplace.SolutionId}},sourceLocationOverrideResourceId:{configurable:!0,enumerable:!0,get:function(){return this.ae.SrcLocationOverrideResourceId}},
ml:{configurable:!0,enumerable:!0,get:function(){return this.ae}},fha:{configurable:!0,enumerable:!0,get:function(){return this.x1d},set:function(sa){this.x1d=sa}},osfControlType:{configurable:!0,enumerable:!0,get:function(){return this.sce}},VHa:{configurable:!0,enumerable:!0,get:function(){return this.cHc},set:function(sa){this.cHc=sa}},A4c:{configurable:!0,enumerable:!0,get:function(){return this.jVa},set:function(sa){this.jVa=sa}},focusOnIframeWhenLoaded:{configurable:!0,enumerable:!0,get:function(){return this.ae.FocusOnIframeWhenLoaded}},
Yod:{configurable:!0,enumerable:!0,get:function(){return this.b9d},set:function(sa){this.b9d=sa}}});Object(Ia.a)(P,"OsfControl",cb.a,[540]);N.prototype.add=function(sa){this.JYa[sa]=!0};N.prototype.remove=function(sa){delete this.JYa[sa]};N.prototype.clear=function(){for(var sa=Gl(Object.keys(this.JYa)),ob=sa.next();!ob.done;ob=sa.next())delete this.JYa[ob.value]};N.prototype.H5e=function(){return 0<Object.keys(this.JYa).length};N.prototype.DGh=function(){return Object.keys(this.JYa)};Object(Ia.a)(N,
"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var gc=b(55);B.prototype.mob=function(sa){51===sa.messageType?this.pNf=this.iGa(sa.actionType,this.pNf,this.HFi):52===sa.messageType&&(this.qNf=this.iGa(sa.actionType,this.qNf,this.IFi))};B.prototype.iGa=function(sa,ob,Wb){if(1===sa)ob||Qa.g(this.$).ha.Oa.QUc(Wb),ob++,this.arj();else if(2===sa){if(1>ob)return ob;1===ob&&Qa.g(this.$).ha.Oa.zId(Wb);ob--}return ob};B.prototype.Uia=function(sa,ob,Wb){ob&&this.hj.c_(sa,ob)&&this.hi.xM(sa,
ob,Wb)};B.prototype.fac=function(sa){return sa&&sa.floatingObject?(sa=sa.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===sa.length?sa[0]:null:null};B.prototype.pja=function(){var sa=this.$.xa.qa;return sa&&0===sa.tI?sa.sheetId:null};B.prototype.arj=function(){var sa=Qa.g(this.$).ha.Oa.wC;this.Mmd(sa)&&(this.T$a=this.fac(sa),this.NKb=this.pja())};B.prototype.Mmd=function(sa){return!!sa&&!!sa.floatingObject&&0===sa.floatingObject.type};Object(Ia.a)(B,"RichApiEventChartActivatedDeactivatedHandler",
null,[]);var Hc=b(947),Tc=b(198),Md=b(706),Xc=b(100),Cd=b(358),Sb=b(58),Mc=Za.a;Wl(A,Mc);A.prototype.d0b=function(sa){Object(sb.a)(Cd.a,this.$.xa);1===sa.actionType?(this.zza||this.grid.ha.fE(this.ld),this.zza++):2!==sa.actionType||1>this.zza||(1===this.zza&&this.grid.ha.hI(this.ld),this.zza--)};A.prototype.Qvc=function(sa){sa?this.TU++:(0<this.TU&&this.TU--,this.TU||this.ld(null,new Md.a(!1)))};A.prototype.BXe=function(){return this.grid.ha.ta.selectedRanges};A.prototype.bre=function(sa,ob){return Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?
(!!sa&&Tc.e(this.bNa)||sa in this.bNa)&&!Jb.Q(this.bNa[sa],ob):sa in this.bNa&&!Jb.Q(this.bNa[sa],ob)};A.prototype.oIe=function(sa,ob,Wb){this.bNa[sa]=Jb.d(ob);this.Xic[sa]=Wb};A.prototype.sdf=function(){return this.grid.isEditing||this.grid.Li};A.prototype.RSe=function(sa,ob){this.hj.c_(14,sa)&&this.hi.xM(14,sa,ob);this.hj.c_(14,Hc.a.cX)&&this.hi.xM(14,Hc.a.cX,ob)};A.prototype.l3h=function(sa,ob){var Wb={};Wb.worksheetId=sa;Wb.address=this.Cfd(ob);ob=gc.a.Jc(Wb);this.RSe(sa,ob)};A.prototype.Y2h=
function(sa,ob,Wb,hc){if(this.hj.Bgf()){var pc="",xd="";hc&&(pc=hc.ij);Wb&&(xd=Wb.ij);hc?Wb?(ob=Wb.usedRange.byb(ob),pc!==xd&&this.L9b(pc,"",sa),this.L9b(xd,this.Cfd(ob),sa)):this.L9b(pc,"",sa):Wb&&(pc=Wb.usedRange.byb(ob),this.L9b(xd,this.Cfd(pc),sa))}};A.prototype.L9b=function(sa,ob,Wb){if(this.hj.c_(100,sa)){var hc={};hc.address=ob;hc.worksheetId=Wb;this.hi.xM(100,sa,gc.a.Jc(hc))}};A.prototype.Cfd=function(sa){return Jb.i(sa,",",this.$,!1)};A.prototype.dispose=function(){0<this.zza&&this.grid.ha.hI(this.ld);
this.Xic=this.bNa=null;this.zza=0;this.hi=this.hj=this.$=this.grid=null};Ck.Object.defineProperties(A.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return!this.TU&&0<this.zza}}});Object(Ia.a)(A,"RichApiEventSelectionChangedHandler",Za.a,[]);var md=b(354);Wl(D,A);D.prototype.BXe=function(){return md.a.jrb(this.grid.ha.rangePicker.DK)};D.prototype.bre=function(sa,ob){return this.zif!==sa||!Jb.Q(this.yif,ob)};D.prototype.oIe=function(sa,ob){this.zif=sa;this.yif=Jb.d(ob)};D.prototype.sdf=
function(){return!this.grid.isEditing&&!this.grid.Li};D.prototype.RSe=function(sa,ob){this.hj.c_(2700,Hc.a.cX)&&this.hi.xM(2700,Hc.a.cX,ob)};Object(Ia.a)(D,"RichApiEventPickedRangesChangedHandler",A,[]);z.prototype.mob=function(sa){var ob=Qa.g(this.$).ha;1===sa.actionType?(this.UPa||this.VPa||ob.Oa.QUc(this.pwf),2101===sa.messageType?this.UPa++:2102===sa.messageType&&this.VPa++):2===sa.actionType&&(2101===sa.messageType?this.UPa=0<this.UPa?this.UPa-1:0:2102===sa.messageType&&(this.VPa=0<this.VPa?
this.VPa-1:0),this.UPa||this.VPa||ob.Oa.zId(this.pwf))};z.prototype.gli=function(sa){return!!sa&&!!sa.floatingObject&&(0===sa.floatingObject.type||7===sa.floatingObject.type||1===sa.floatingObject.type||3===sa.floatingObject.type||5===sa.floatingObject.type)};z.prototype.uLj=function(sa){if(!sa||!sa.floatingObject)return null;sa=sa.floatingObject.id;var ob=sa.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));ob=ob&&1===ob.length?ob[0]:null;return ob?ob:(tb.ULS.sendTraceTag(537170457,344,
10,"Expect get the guid like shape id from the floating object id: '{0}', but we failed.",sa),null)};z.prototype.pja=function(){var sa=this.$.xa.qa;return sa&&0===sa.tI?sa.sheetId:null};z.prototype.fireEvent=function(sa,ob,Wb){ob&&this.hj.c_(sa,ob)&&this.hi.xM(sa,ob,Wb)};Object(Ia.a)(z,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);t.prototype.mob=function(sa){11===sa.messageType?sa.targetId===Hc.a.cX?this.ALg(sa.actionType):this.zLg(sa.actionType):12===sa.messageType&&(sa.targetId===Hc.a.cX?
this.BLg(sa.actionType):this.CLg(sa.actionType))};t.prototype.zLg=function(sa){this.sNf=this.iGa(sa,this.sNf,this.PSi)};t.prototype.CLg=function(sa){this.vNf=this.iGa(sa,this.vNf,this.SSi)};t.prototype.ALg=function(sa){this.tNf=this.iGa(sa,this.tNf,this.QSi)};t.prototype.BLg=function(sa){this.uNf=this.iGa(sa,this.uNf,this.RSi)};t.prototype.iGa=function(sa,ob,Wb){1===sa?ob=this.fXc(ob,Wb):2===sa&&(ob=this.N5c(ob,Wb));return ob};t.prototype.fXc=function(sa,ob){sa||this.$.xa.og(ob);sa++;return sa};t.prototype.N5c=
function(sa,ob){if(1>sa)return sa;1===sa&&this.$.xa.Wg(ob);sa--;return sa};t.prototype.e7a=function(sa){return!!sa&&0===sa.tI};t.prototype.Uia=function(sa,ob,Wb,hc){ob=(void 0===hc?0:hc)?Hc.a.cX:ob;this.hj.c_(sa,ob)&&this.hi.xM(sa,ob,Wb)};Object(Ia.a)(t,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var wc=b(244),ed=b(13),Nd=b(230),pe=Sys.EventArgs;Wl(v,pe);Object(Ia.a)(v,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);w.prototype.dispose=function(){this.ENj()};w.prototype.D7i=function(){for(var sa=
Gl(this.gridView.vn),ob=sa.next();!ob.done;ob=sa.next())ob=ob.value.domElement,wc.a.instance.pa(ed.a.pointerDown,ob,this.onPointerDown),Nd.a.instance.pa(ed.a.click,ob,this.xd)};w.prototype.ENj=function(){for(var sa=Gl(this.gridView.vn),ob=sa.next();!ob.done;ob=sa.next())ob=ob.value.domElement,wc.a.instance.Aa(ed.a.pointerDown,ob,this.onPointerDown),Nd.a.instance.Aa(ed.a.click,ob,this.xd)};w.prototype.TSi=function(sa){var ob=sa.sheet;if(this.e7a(ob)){var Wb={};Wb.worksheetId=ob.sheetId;Wb.address=
sa.RUg.toString();Wb.offsetX=sa.offsetX;Wb.offsetY=sa.offsetY;sa=ob.sheetId;this.hj.c_(21,sa)&&(ob=gc.a.Jc(Wb),this.hi.xM(21,sa,ob));sa=Hc.a.cX;this.hj.c_(21,sa)&&(Wb=gc.a.Jc(Wb),this.hi.xM(21,sa,Wb))}};w.prototype.e7a=function(sa){return!!sa&&0===sa.tI};Object(Ia.a)(w,"RichApiEventSingleClickedHandler",null,[]);u.prototype.d0b=function(sa){2E3===sa.messageType&&(1===sa.actionType?(this.pHb||Qa.g(this.$).ha.Oa.QUc(this.qDf),this.pHb++,this.Cnj()):2===sa.actionType&&this.pHb&&(1===this.pHb&&Qa.g(this.$).ha.Oa.zId(this.qDf),
this.pHb--))};u.prototype.gad=function(sa){var ob,Wb={};Wb.worksheetId=sa;Wb.revisionLoad=!1;if(Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(Ib.EwaSettings.ma(717)||Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){var hc=Qa.g(this.$).ha.Oa.wC;(null===(ob=null===hc||void 0===hc?void 0:hc.floatingObject)||void 0===ob?0:ob.dd)?Wb.selectedVisualId=hc.floatingObject.dd.VisualID:Wb.selectedVisualId=
null}ob=gc.a.Jc(Wb);sa&&this.hj.c_(2E3,sa)&&this.hi.xM(2E3,sa,ob)};u.prototype.pja=function(){var sa=this.$.xa.qa;return sa&&0===sa.tI?sa.sheetId:null};u.prototype.Cnj=function(){var sa=Qa.g(this.$).ha.Oa.wC;this.nhf(sa)&&(this.Q$a=sa.floatingObject.id,this.J$a=this.pja())};u.prototype.nhf=function(sa){return!!sa&&sa.Zqd()};Object(Ia.a)(u,"RichApiEventVisualSelectionChangedHandler",null,[]);x.prototype.yLg=function(sa){1===sa.actionType?(this.qHb||this.SLg(),this.qHb++):2!==sa.actionType||1>this.qHb||
(1===this.qHb&&this.tdh(),this.qHb--)};x.prototype.SLg=function(){if(this.hj.c_(2203,Hc.a.cX))if(this.Gpd){var sa={};sa.timeout=this.$.ya.CheckFocusTimeout;this.b$b=window.requestIdleCallback(this.oxe,sa)}else this.b$b=window.setInterval(this.nxe,this.$.ya.CheckFocusTimeInterval)};x.prototype.tdh=function(){this.Gpd?window.cancelIdleCallback(this.b$b):window.clearInterval(this.b$b)};Object(Ia.a)(x,"RichApiEventWorkbookActivatedHandler",null,[]);var Ec;(function(sa){sa[sa.none=0]="none";sa[sa.registerEvent=
1]="registerEvent";sa[sa.unregisterEvent=2]="unregisterEvent";sa[sa.customFunction=3]="customFunction";sa[sa.showCard=4]="showCard";sa[sa.createWorkbook=5]="createWorkbook";sa[sa.openWorkbook=6]="openWorkbook";sa[sa.enableEvents=7]="enableEvents";sa[sa.closeWorkbook=8]="closeWorkbook";sa[sa.setCalculationMode=9]="setCalculationMode";sa[sa.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";sa[sa.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";sa[sa.workbookLinksEnableContent=
12]="workbookLinksEnableContent";sa[sa.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";sa[sa.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";sa[sa.rangePicker=15]="rangePicker";sa[sa.enableRichApiRecording=16]="enableRichApiRecording";sa[sa.recordAction=17]="recordAction";sa[sa.focus=18]="focus";sa[sa.businessBarShow=19]="businessBarShow";sa[sa.businessBarHide=20]="businessBarHide"})(Ec||(Ec={}));Object(Ia.b)("PostProcessActionType",Ec);var rd=b(245);h.prototype.xLg=function(sa){1===
sa.actionType?(this.$.Aba=!0,Object(sb.a)(b(944).DdaFacade,rd.a(this.$)).fad(!0)):2===sa.actionType&&(this.$.Aba=!1);this.kEf=sa.controlId;tb.ULS.sendTraceTag(537170456,0,50,"AttachOrDetachMacroRecorderEventHandler: actionType: {0}; controlId: {1}; this.ewaControl.IsMacroRecorderListening: {2}.",Ec[sa.actionType],this.kEf,this.$.Aba)};h.prototype.Hkh=function(sa){Object(sb.a)(b(944).DdaFacade,rd.a(this.$)).USe(sa,this.$.Aba)};h.prototype.j$h=function(){var sa=this;this.$.Eba&&ma.TaskExtensions.Ba(kc.GetServiceTaskFactory.Xa(this.$.da,
297,298,1),function(ob){(ob=ob.result)&&ob.init(sa.ead)},this.$.la,3)};Object(Ia.a)(h,"RichApiMacroRecorderEventHandler",null,[]);Object(Ia.a)(m,"SessionRecreationInfo",null,[]);n.prototype.hBi=function(){return Ib.EwaSettings.ma(260)?this.hj.V3h()||0!==this.runtimeCalculationMode:!1};n.prototype.HQg=function(){var sa={};sa.eventRegistrationInfos=this.hj.OMh();sa.runtimeCalculationMode=this.runtimeCalculationMode;sa=Object(Ya.a)(new m,{runtimeState:sa});var ob={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",
RequestHeaders:null};ob.RequestBody=JSON.stringify(sa);ob.RequestFlags=1;return ob};Object(Ia.a)(n,"RichApiRuntimeStateHandler",null,[]);Object(Ia.a)(l,"UserOperationQueueItemsStatisticsData",null,[]);var Dd=b(341),wb=b(31),lf=b(19),qf=b(306),Cf=b(48),Fe=b(655),Ke=b(63),$d=b(59),Id=b(72),he=Dd.a;Wl(f,he);f.prototype.dispose=function(){this.$&&(this.$.xa.JK(this.Do),this.$.Hb.JK(this.Do),this.$.Hb.Wg(this.Ge),this.$.xa.Wg(this.Ge));this.XTa&&(this.XTa.Vq(this.yf),this.XTa.gI(this.Sm),this.XTa.tv(this.Oi));
Ib.EwaSettings.qc()&&this.Ww(this.iya);this.clearCache();qd.a.Ha(this.XTa);this.XTa=null;kd.DOMElementExtensions.zf(this.domElement);he.prototype.dispose.call(this)};f.prototype.unj=function(sa){kd.DOMElementExtensions.zf(kd.DOMElementExtensions.getElementById(this.domElement,sa.id));this.domElement.appendChild(sa)};f.prototype.ild=function(){if(this.Eva&&!this.E3b){var sa=Object(sb.a)(b(944).DdaFacade,rd.a(this.$)).kn(this.Eva.InstanceId);sa&&(sa.resize(this.Eva.Width,this.Eva.Height),sa.ka(this.domElement),
sa.showHide(!0),this.E3b=!0)}};f.prototype.g7a=function(){return!0};f.prototype.Fna=function(sa){this.Eva=sa.nd.block.Be;this.E3b=!1;this.ild()};f.prototype.rTa=function(sa){this.$.ea.b_&&sa&&(sa.Cu||(sa.Cu=new qf.a),sa.Cu.ti=new Cf.a(this.domElement.scrollLeft,this.domElement.scrollTop),sa.Cu.cGb=20)};f.prototype.clearCache=function(){this.Ea.ZPa(this.hashCode);this.Eva=this.hashCode=null;this.E3b=!1};f.prototype.tSa=function(sa,ob){if(this.isVisible=!!sa&&Ke.o(sa))this.hashCode=this.Ea.Rra(sa,$d.a.L5b,
this.hashCode),this.uwc(ob)};f.jGa=function(sa){if(!sa.da.za(34)){var ob=sa.Lf;sa.da.Ga(34,new f(sa,new Fe.a(sa,sa.ea,sa.na.Mk,3,0),ob.appendChild(ob.ownerDocument.createElement("div"))))}};Ck.Object.defineProperties(f.prototype,{Ea:{configurable:!0,enumerable:!0,get:function(){return this.XTa}}});Object(Ia.a)(f,"WebExtensionView",Dd.a,[538,414,3]);var Af=b(232),ne=b(560),Te=b(386),Ac=b(466),Kd=b(175),ce=b(83),sd=b(121),Ge=b(47),kf=b(43),Ze=b(158),je=b(111),dg=b(70),Zd=b(28),of=b(30),Wf=b(293),$f=
b(21),mg=b(14),Qf=b(292),lc=b(946),Kc=b(50),Fd=b(153),re=b(1074),ke=b(205),nd=b(1073),dc=b(27);b.d(C,"DdaFacade",function(){return a});var Xd=zb.a;Wl(a,Xd);a.prototype.tme=function(sa){this.addHandler("cd",sa)};a.prototype.h$i=function(sa){this.removeHandler("cd",sa)};a.prototype.RDg=function(sa){this.addHandler("csc",sa)};a.prototype.j$i=function(sa){this.removeHandler("csc",sa)};a.prototype.ODg=function(sa){this.addHandler("ca",sa)};a.prototype.g$i=function(sa){this.removeHandler("ca",sa)};a.prototype.PDg=
function(sa){this.addHandler("ci",sa)};a.prototype.QDg=function(sa){this.addHandler("ekros",sa)};a.prototype.i$i=function(sa){this.removeHandler("ekros",sa)};a.prototype.zCd=function(sa,ob){try{return JSON.parse(sa)[ob].toLowerCase()}catch(Wb){return""}};a.prototype.Vtj=function(sa){var ob=this.zCd(sa,"AudienceGroup"),Wb=this.zCd(sa,"SessionOrigin");try{var hc=parseInt(this.zCd(sa,"Ring"),10);if("automation"!==ob&&"bluechicken"!==Wb&&-2<=hc)return!0}catch(pc){if("automation"!==ob&&"bluechicken"!==
Wb)return!0}return!1};a.prototype.w0b=function(sa){var ob={};ob.Name=sa.Name;ob.BindingType=sa.BindingType;ob.HasHeaders=sa.HasHeaders;sa.IsValidRef&&(ob.ColCount=sa.Reference.LastColumn-sa.Reference.FirstColumn+1,ob.RowCount=sa.Reference.LastRow-sa.Reference.FirstRow+1);return ob};a.prototype.Tpi=function(sa,ob){this.En.launchInsertDialog(sa,null,this.LPg(ob))};a.prototype.Uca=function(sa,ob){var Wb={};Wb.callbackFunc=sa;Wb.storeType=OSF.StoreTypeEnum.MarketPlace;Wb.fromInsertDialog=!1;Wb.refresh=
ob;this.En.queryEntitlementDetails(Wb)};a.prototype.invokeDdaMethod=function(sa,ob){var Wb=this.kn(sa.DdaMethod.ControlId);Wb?Wb.invokeDdaMethod(sa,ob):this.wf(wa.a.internalError,ob)};a.prototype.registerDdaEventAsync=function(sa,ob,Wb,hc,pc){(ob=this.kn(ob))?a.Nyb(sa)?ob.h6i(sa,Wb,hc,pc):this.wf(wa.a.QBd,pc):this.wf(wa.a.internalError,pc)};a.prototype.unregisterDdaEventAsync=function(sa,ob,Wb,hc,pc){(ob=this.kn(ob))?a.Nyb(sa)?ob.jNj(sa,Wb,hc,pc):this.wf(wa.a.QBd,pc):this.wf(wa.a.internalError,pc)};
a.prototype.dispose=function(){this.disposed||(this.$.yl(this.vd),this.ea.Dk(this.od),this.ea.$R(this.Fo),this.ea.uv(this.Hf),this.QVc.detach(this),this.$.userOperationManager.Ul(this.ER),this.Uoc=this.If=this.hi=this.QVc=this.xb=null,this.DIa&&(this.DIa.dispose(),this.DIa=null),qd.a.Ha(this.kLd),qd.a.Ha(this.jLd),this.U0a&&(this.U0a.dispose(),this.U0a=null),Xd.prototype.dispose.call(this),this.disposed=!0,tb.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))};a.prototype.hdd=function(sa){return(sa=
this.kn(sa))?sa.getDefaultIconUrl():null};a.prototype.Qvc=function(sa){if(this.WEe!==sa){this.WEe=sa;for(var ob=0,Wb=this.If.length;ob<Wb;ob++){var hc=this.If[ob];sa?hc.qHe(!1):hc.wjh()}this.kLd.Qvc(sa);this.jLd.Qvc(sa)}};a.prototype.yLh=function(sa){return(sa=this.kn(sa))?sa.getDefaultDisplayName():null};a.prototype.wf=function(sa,ob,Wb){var hc={};hc[ja.a.pg]=sa;hc[ja.a.I3]=ob;this.ZJ(451041795,hc,void 0===Wb?!0:Wb)};a.prototype.Zu=function(sa){var ob={};ob[ja.a.I3]=sa;this.ZJ(1237877382,ob)};a.prototype.ZJ=
function(sa,ob,Wb){var hc=this;Wb=void 0===Wb?!0:Wb;var pc=new Qc.a(sa,0,this.$.Xc,0,null),xd=ob?ob[ja.a.I3]:null;this.U0a&&Qa.g(this.$).isEditing&&I.KZg(sa,ob)?this.U0a.kch(sa,ob):(sa=this.$.Ka.Wb(pc,ob),Wb&&ma.TaskExtensions.Ba(sa,function(Gd){Ze.a(Gd)?hc.wf(wa.a.internalError,xd,!1):Gd.result||(Qa.g(hc.$).isEditing?hc.wf(wa.a.cyb,xd,!1):hc.wf(wa.a.internalError,xd,!1))},this.la,8))};a.prototype.k1g=function(sa){var ob=this;return!!this.Tia(function(Wb){return a.getSolutionId(Wb.ml,ob.$)===a.getSolutionId(sa,
ob.$)&&Wb.ml.PrimaryMarketplace.MarketplaceType===sa.PrimaryMarketplace.MarketplaceType&&Wb.ml.PrimaryMarketplace.MarketplaceRef===sa.PrimaryMarketplace.MarketplaceRef&&Wb.ml.PrimaryMarketplace.SolutionVersion===sa.PrimaryMarketplace.SolutionVersion})};a.prototype.kn=function(sa){return this.Tia(function(ob){return ob.controlId.startsWith(sa)})};a.prototype.Zzh=function(sa){return this.Tia(function(ob){return ob.VHa===sa})};a.prototype.qSe=function(sa){return this.Tia(function(ob){return ob.BU===
sa&&!!ob.VHa})};a.prototype.JSe=function(sa,ob,Wb,hc){return this.Tia(function(pc){return pc.BU===sa&&pc.ml.PrimaryMarketplace.MarketplaceRef.toLowerCase()===ob.toLowerCase()&&pc.ml.PrimaryMarketplace.MarketplaceType.toLowerCase()===Wb.toLowerCase()&&!!pc.ml.SharedRuntime&&!!pc.ml.SharedRuntime.Resid&&!!hc&&!!hc.Resid&&pc.ml.SharedRuntime.Resid.toLowerCase()===hc.Resid.toLowerCase()})};a.prototype.mLg=function(sa,ob){if(sa=this.kn(sa))sa.ka(ob),sa.showHide(!0)};a.prototype.jyj=function(sa){(sa=this.kn(sa))&&
sa.showHide(!1)};a.prototype.w0a=function(sa){var ob;if(1!==sa.WebExtensionType||this.$.Qd&8388608&&sa.TaskpaneVisible||this.$.Qd&8388608&&!sa.TaskpaneVisible&&xb.HelperMethods.Bw(sa)){var Wb=null;xb.HelperMethods.Bw(sa)&&(Wb=a.Wua(sa,this.$),sa.TaskpaneWidth||(sa.TaskpaneWidth=this.R5b));var hc=(new P(this,this.hi,sa)).Wkd();tb.ULS.sendTraceTag(51263011,0,50,"DdaFacade::CreateOsfControl: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(sa.PrimaryMarketplace.SolutionId,
sa.PrimaryMarketplace.MarketplaceType,null===(ob=sa.AssetMarketplace)||void 0===ob?void 0:ob.SolutionId,null,null,sa.PrimaryMarketplace.MarketplaceRef),sa.PrimaryMarketplace.MarketplaceType,xb.HelperMethods.Bw(sa));Wb&&(hc.VHa=Wb);this.If.push(hc);this.lxa=null;this.B5a(sa.InstanceId)||(sa=String.format("{0}|{1}|{2}|{3}|{4}",sa.PrimaryMarketplace.SolutionId,sa.PrimaryMarketplace.SolutionVersion,sa.PrimaryMarketplace.MarketplaceRef,sa.PrimaryMarketplace.MarketplaceType,sa.WebExtensionType),this.raiseEvent("ci",
sa))}};a.prototype.Qzj=function(sa,ob){function Wb(){hc.aQa(xd.controlId);hc.Ei.purgeOsfControl(xd.controlId,!1);ob()}var hc=this;sa.TaskpaneWidth=this.R5b;sa.TaskpaneVisible=!0;var pc={};pc.SolutionId=sa.PrimaryMarketplace.SolutionId;pc.TargetType=sa.WebExtensionType;pc.Version=sa.PrimaryMarketplace.SolutionVersion;pc.StoreType=sa.PrimaryMarketplace.MarketplaceType;pc.StoreId=sa.PrimaryMarketplace.MarketplaceRef;pc.AssetId=sa.PrimaryMarketplace.SolutionId;pc.AssetStoreId=sa.PrimaryMarketplace.MarketplaceRef;
pc.Width=sa.TaskpaneWidth;var xd=new P(this,this.hi,sa,!0);xd.Wkd();this.If.push(xd);var Gd=null;Gd=Ge.a.instance.tC(function(){xd.vy&&(qd.a.Ha(Gd),Gd=null,hc.Ei.insertBlankControlWithErrorUX(hc.iGb(xd,pc),Wb))},100,kf.a.bbh)};a.prototype.Y4g=function(sa){var ob=this;if(sa&&sa.length){var Wb=[];sa.forEach(function(hc){if(hc.ContainsCustomFunctions){var pc=a.Wua(hc,ob.$);ob.WCd.contains(pc)||(ob.WCd.add(pc),ob.DFf.push(hc));ob.k1g(hc)||Wb.push(hc)}});Wb.length&&this.fCe(Wb)}};a.prototype.bEe=function(sa,
ob){this.kn(sa.InstanceId)||(ob=ob(),sa=(new P(this,this.hi,sa)).r9e(ob),this.If.push(sa),this.lxa=null)};a.prototype.Exj=function(sa){a.O0a.yb(sa)&&a.O0a.oa(sa).initializeAndShowWithTitle()};a.prototype.S4h=function(sa){a.O0a.yb(sa)&&a.O0a.oa(sa).hide()};a.prototype.iSh=function(sa){var ob=this,Wb=null,hc,pc=null;var xd=a.Wgd(sa,!0);if(!xd)return tb.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),Sb.Task.Sa(null);(hc=this.En.getOsfControl(a.getSolutionId(xd,
this.$)))&&(Wb=hc.getManifest())&&(pc=Wb.getSharedRuntimeForCustomFunctions("Workbook"));if(Wb=pc&&1===pc.LifeTime?this.JSe(xd.PrimaryMarketplace.SolutionId,xd.PrimaryMarketplace.MarketplaceRef,xd.PrimaryMarketplace.MarketplaceType,pc):this.Zzh(sa))return Sb.Task.Sa(Wb.controlId);var Gd=new Hb.a;xb.HelperMethods.qic(pc)&&(xd.SharedRuntime=pc);sa=hc?hc.getNotificationParams():[];if(!sa.length)return this.JCe(xd);this.X1f(sa,function(){ma.TaskExtensions.Ba(Gd.task,function(){ob.JCe(xd)},ob.la,3)},function(){});
return Gd.task};a.prototype.BGh=function(sa){sa=a.Wgd(sa,!1);if(!sa)return tb.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;var ob=null,Wb=this.En.getOsfControl(a.getSolutionId(sa,this.$));Wb&&(Wb=Wb.getManifest())&&(ob=Wb.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return xb.HelperMethods.qic(ob)&&(sa=this.JSe(sa.PrimaryMarketplace.SolutionId,sa.PrimaryMarketplace.MarketplaceRef,sa.PrimaryMarketplace.MarketplaceType,ob))?sa.controlId:
null};a.prototype.u3g=function(sa,ob){var Wb=this,hc=a.Wgd(sa,!1);if(hc){var pc=null,xd=this.En.getOsfControl(a.getSolutionId(hc,this.$));xd&&(xd=xd.getManifest())&&(pc=xd.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(xb.HelperMethods.qic(pc)){hc.SharedRuntime=pc;var Gd=hc.PrimaryMarketplace.SolutionId;xd=hc.PrimaryMarketplace.SolutionVersion;var te=OSF.OsfManifestManager.getCachedManifest(Gd,xd);if(te)if(this.IZb.yb(sa))pc=this.IZb.oa(sa),ma.TaskExtensions.Ba(pc,function(pf){(pf=pf.result)&&
OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(pf,ob,Wb.hi.GJb)},this.la,3);else{var Sd={solutionId:Gd,version:xd};Sd.storeType=hc.PrimaryMarketplace.MarketplaceType;Sd.storeId=hc.PrimaryMarketplace.MarketplaceRef;Sd.assetId=Gd;Sd.assetStoreId=null;Sd.targetType=OSF.OsfControlTarget.TaskPane;var If=new Hb.a;hc=ma.TaskExtensions.sk();hc=new ub.a(this.$,this,Sd,hc);pc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(Gd,pc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(te,
pc,xd);hc.createUILessSandbox(Sd,te,function(pf,Ef){pf&&!Ef?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(pf,ob,Wb.hi.GJb),If.setResult(pf)):If.setResult(null);Wb.IZb.remove(sa)});this.IZb.ia(sa,If.task)}}}else tb.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")};a.prototype.bxe=function(sa){(sa=this.qSe(sa))&&(sa.ml.SharedRuntime||this.yHb(sa.controlId))};a.prototype.yHb=function(sa){(sa=this.qSe(sa))&&this.aQa(sa.controlId)};
a.prototype.dgh=function(sa,ob){if(!this.If||!sa||!ob)return!1;if(sa.toLowerCase()===ob.toLowerCase())return!0;for(var Wb=null,hc=null,pc=0,xd=this.If.length;pc<xd;pc++){var Gd=this.If[pc];if(Gd.ownerAddinSolutionId&&(Gd.controlId===sa&&(Wb=Gd.ownerAddinSolutionId.toLowerCase()),Gd.controlId===ob&&(hc=Gd.ownerAddinSolutionId.toLowerCase()),Wb&&hc))break}return Wb&&Wb===hc?!0:!1};a.prototype.sBg=function(sa){this.kn(sa.InstanceId)||(sa=new P(this,this.hi,sa),this.If.push(sa),this.lxa=null)};a.prototype.nOf=
function(sa){if(this.If&&0<=sa&&sa<this.If.length){var ob=this.If[sa],Wb=ob.vy;Array.removeAt(this.If,sa);this.gvf(ob);kd.DOMElementExtensions.zf(Wb)}};a.prototype.aQa=function(sa){if(this.If)for(var ob=0,Wb=this.If.length;ob<Wb;ob++)if(this.If[ob].controlId===sa){this.nOf(ob);break}};a.prototype.f9i=function(sa){if(this.If){sa=sa.toLowerCase();for(var ob=0,Wb=this.If.length;ob<Wb;ob++)if(sa===this.If[ob].ownerAddinSolutionId.toLowerCase()){this.nOf(ob);break}}};a.prototype.RLg=function(sa){sa.rn&&
(this.kn(sa.floatingObject.ml.InstanceId)||(this.efc(sa.floatingObject.ml.InstanceId)||this.Uoc.push(sa.floatingObject.ml.InstanceId),this.w0a(sa.floatingObject.ml)),this.ea.isNamedObjectViewMode&&this.mLg(sa.floatingObject.ml.InstanceId,sa.Td))};a.prototype.waa=function(sa){if(this.If)for(var ob=0,Wb=this.If.length;ob<Wb;ob++)if(1===this.If[ob].controlType&&$f.a.equals(this.If[ob].BU,sa,!0))return this.If[ob].controlId;return null};a.prototype.Azh=function(sa){var ob=[];if(this.If)for(var Wb=0,hc=
this.If.length;Wb<hc;Wb++)$f.a.equals(this.If[Wb].BU,sa,!0)&&ob.push(this.If[Wb].controlId);return ob};a.prototype.fAh=function(sa,ob){if(!ob||!sa)return null;if(this.If)for(var Wb=0,hc=this.If.length;Wb<hc;Wb++)if(1===this.If[Wb].controlType&&$f.a.equals(this.If[Wb].BU,sa,!0)&&this.If[Wb].ml.SharedRuntime&&$f.a.equals(this.If[Wb].ml.SharedRuntime.Resid,ob.Resid,!0))return this.If[Wb].controlId;return null};a.prototype.$2a=function(sa,ob){ob=void 0===ob?null:ob;return sa?ob?String.format("{0}.{1}",
sa,ob):sa:""};a.prototype.exe=function(sa,ob,Wb){if(this.lxa===sa)return!0;this.lxa=sa;var hc=null,pc=!1;if(!hc&&this.If)for(var xd=0,Gd=this.If.length;xd<Gd;xd++)if(1===this.If[xd].controlType&&$f.a.equals(this.If[xd].BU,sa,!0)){var te=!1,Sd=!1;ob?(te=!0,Sd=!!this.If[xd].ml.SharedRuntime&&$f.a.equals(this.If[xd].ml.SharedRuntime.Resid,ob.Resid,!0)):Wb&&(te=!0,Sd=$f.a.equals(this.If[xd].ml.SharedRuntimeId,Wb,!0));if(!te||Sd){Sd&&this.If[xd].lg(!0);hc=this.If[xd].controlId;pc=!0;this.lxa=null;break}}hc&&
this.raiseEvent("ca",hc);return pc};a.prototype.setAppRuntimeState=function(sa,ob){var Wb;if(sa){var hc=this.kn(sa);if(hc&&xb.HelperMethods.Bw(hc.ml))hc.lg(ob),ob&&(this.raiseEvent("ca",sa),(null===(Wb=hc.vy)||void 0===Wb?0:Wb.firstChild)&&(sa=hc.vy.firstChild.title)&&0<sa.length&&this.P_b.plj(sa));else throw tb.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(mg.a.instance.ga(2209));}else throw tb.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),
Error.invalidOperation(mg.a.instance.ga(2210));};a.prototype.getAppRuntimeState=function(sa){if(sa)if((sa=this.kn(sa))&&xb.HelperMethods.Bw(sa.ml))sa=sa.ml.TaskpaneVisible;else throw tb.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(mg.a.instance.ga(2209));else throw tb.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(mg.a.instance.ga(2210));return sa};a.prototype.w2a=function(sa,ob){return(sa=
this.kn(sa))?sa.w2a(ob):null};a.prototype.B5a=function(sa){return this.gxe(this.Uoc,sa)};a.prototype.efc=function(sa){return this.gxe(this.REe,sa)};a.prototype.Fke=function(sa){this.REe.push(sa)};a.prototype.tZ=function(sa){return(sa=this.kn(sa))?sa.ml:null};a.prototype.Lxd=function(sa){this.raiseEvent("ekros",sa,this)};a.prototype.tBd=function(sa){if(sa){var ob=this.kn(sa.InstanceId);ob&&(sa.SharedRuntime||sa.SharedRuntimeId||(this.aQa(ob.controlId),this.Ei.purgeOsfControl(ob.controlId,!1)),ob={},
ob.SolutionId=sa.PrimaryMarketplace.SolutionId,ob.TargetType=sa.WebExtensionType,ob.Version=sa.PrimaryMarketplace.SolutionVersion,ob.StoreType=sa.PrimaryMarketplace.MarketplaceType,ob.StoreId=sa.PrimaryMarketplace.MarketplaceRef,ob.AssetId=sa.PrimaryMarketplace.SolutionId,ob.AssetStoreId=sa.PrimaryMarketplace.MarketplaceRef,ob.Width=sa.TaskpaneWidth,ob.SharedRuntimeId=sa.SharedRuntimeId,this.I9f(ob))}};a.prototype.zia=function(){this.hi.zia()};a.prototype.xM=function(sa,ob,Wb){this.hi.xM(sa,ob,Wb)};
a.prototype.ylj=function(sa,ob){var Wb=Array(2);Wb[0]=ob;Wb[1]=null;this.hi.uAh(sa,JSON.stringify(Wb))};a.prototype.USe=function(sa,ob){ob=a.G8g(ob);sa=this.tZ(sa);this.hi.K9b(sa.InstanceId,2202,Hc.a.cX,ob)};a.prototype.fad=function(sa){for(var ob=0,Wb=this.If.length;ob<Wb;ob++)this.USe(this.If[ob].controlId,sa)};a.prototype.qAh=function(sa,ob){ob=a.$3g(ob);this.hi.K9b(sa,65539,"",ob)};a.prototype.sAh=function(sa,ob,Wb){this.hi.K9b(sa,1,ob,Wb)};a.prototype.pAh=function(sa,ob){this.hi.tAh(sa,ob)};
a.prototype.r3g=function(sa,ob){return[[2,1E3,"",JSON.stringify([sa,ob]),0,!1]]};a.prototype.Cdi=function(){return!!this.ina&&this.ina.H5e()};a.prototype.jXg=function(){this.ina&&this.ina.clear()};a.prototype.rAh=function(){if(this.ina&&this.ina.H5e()){var sa=this.ina.DGh();sa=Gl(sa);for(var ob=sa.next();!ob.done;ob=sa.next()){ob=this.Azh(ob.value);ob=Gl(ob);for(var Wb=ob.next();!Wb.done;Wb=ob.next())this.hi.K9b(Wb.value,65540,"","{}")}}};a.prototype.a6i=function(sa){this.ina.add(sa)};a.prototype.fNj=
function(sa){this.ina.remove(sa)};a.prototype.Tia=function(sa){if(!this.If)return null;for(var ob=Gl(this.If),Wb=ob.next();!Wb.done;Wb=ob.next())if(Wb=Wb.value,sa(Wb))return Wb;return null};a.prototype.JCe=function(sa){var ob=this,Wb=new Hb.a,hc=a.Wua(sa,this.$);if(xb.HelperMethods.Bw(sa))tb.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.AFf(sa,function(xd){xd?(sa.InstanceId=xd.InstanceId,sa.WebExtensionOsfControlType=3,sa.TaskpaneVisible=!1,ob.w0a(sa),Wb.setResult(sa.InstanceId)):
(tb.ULS.sendTraceTag(537170530,0,10,"InsertAgaveTaskPane for customfunction: {0} failed",Telemetry.PrivacyRules.GetPrivacyCompliantId(sa.PrimaryMarketplace.SolutionId,sa.PrimaryMarketplace.MarketplaceType,null,null,null,sa.PrimaryMarketplace.MarketplaceRef)),Wb.setException(Error.create("Null insert data")))});else{a.O0a.ia(sa.InstanceId,new db.a);var pc=a.O0a.oa(sa.InstanceId).g1a;this.X4g(sa,pc,hc);this.AFf(sa,null);Wb.setResult(sa.InstanceId)}return Wb.task};a.prototype.X4g=function(sa,ob,Wb){this.kn(sa.InstanceId)||
(sa=new P(this,this.hi,sa),sa.VHa=Wb,sa.r9e(ob),this.If.push(sa),this.lxa=null)};a.prototype.AFf=function(sa,ob){var Wb=a.Wua(sa,this.$);if(!this.WCd.contains(Wb))this.KFb.push(sa),1<=this.KFb.length&&this.BFf(sa,ob);else if(ob){sa=Gl(this.DFf);for(var hc=sa.next();!hc.done;hc=sa.next())if(hc=hc.value,a.Wua(hc,this.$)===Wb){ob(hc,0);break}}};a.prototype.BFf=function(sa,ob){function Wb(pf){pf&&!Wf.a(pf)||tb.ULS.sendTraceTag(537170527,0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {1}",
Telemetry.PrivacyRules.GetPrivacyCompliantId(Gd.SolutionId,Gd.StoreType,Gd.AssetId,null,null,Gd.StoreId),of.a.Tc(pf.Errors));pc.KFb.shift();0<pc.KFb.length&&pc.BFf(pc.KFb[0],ob)}function hc(pf){pf=sd.a.ig(pf.data);tb.ULS.sendTraceTag(537170528,0,10,"DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: {0}",of.a.Tc(pf))}var pc=this,xd=null,Gd={};Gd.SolutionId=a.getSolutionId(sa,this.$);Gd.TargetType=sa.WebExtensionType;Gd.Version=sa.PrimaryMarketplace.SolutionVersion;
Gd.StoreType=sa.PrimaryMarketplace.MarketplaceType;Gd.StoreId=sa.PrimaryMarketplace.MarketplaceRef;Gd.AssetId=sa.PrimaryMarketplace.SolutionId;Gd.AssetStoreId=sa.PrimaryMarketplace.MarketplaceRef;Gd.Width=sa.TaskpaneWidth;Gd.ContainsCustomFunctions=!0;xb.HelperMethods.Bw(sa)&&(Gd.SharedRuntimeId=sa.SharedRuntime.Resid);var te=this.$.na.va;sa=this.$.na.va.hc();var Sd=te.Na(9,sa);Sd.sharedInfo=Gd;if(ob){var If=function(pf){var Ef=pf.Result;(xd=Ef?Ef.AgaveData:null)||ob(null,pf.Errors?pf.Errors[0].ErrorCause:
5001);ob(xd,0)};sa=function(pf,Ef,pg){return ce.i(te,"InsertAgaveTaskpane",Sd,Qf.b(pf,Wb,If),Qf.a(Ef,hc),pg,null,0)}}else sa=function(pf,Ef,pg){return ce.i(te,"InsertAgaveTaskpane",Sd,Qf.b(pf,Wb),Qf.a(Ef,hc),pg,null,0)};Ib.EwaSettings.qc()?Te.a(this.$.userOperationManager,sa,function(pf){return new Kd.a(519,0,pf,64)},null):Te.a(this.$.userOperationManager,sa,function(pf){return new ne.a(519,0,pf)},null)};a.prototype.Luj=function(){return this.$.Yf.get(35)};a.prototype.fId=function(sa){sa=this.kn(sa);
(null===sa||void 0===sa?0:sa.zda)&&sa.xOf()};a.prototype.vCi=function(sa){var ob=this.Tia(function(Wb){return a.QLa(Wb.BU)});ob&&(ob=this.Ei.getOsfControl(ob.controlId))&&ob.notifyAgave(OSF.AgaveHostAction.SendMessage,sa)};a.prototype.pei=function(){return!!this.Tia(function(sa){return 1===sa.controlType&&a.QLa(sa.BU)})};a.prototype.oei=function(){var sa=this.Tia(function(ob){return a.QLa(ob.BU)});return sa?sa.vy?kd.DOMElementExtensions.isVisible(sa.vy):!1:!1};a.prototype.soj=function(){var sa=this.Tia(function(ob){return a.QLa(ob.BU)});
sa&&(sa.lg(!0),this.raiseEvent("ca",sa.controlId))};a.prototype.initialize=function(){var sa=b(1407).DdaEventDispatch,ob=void 0===this.$||null===this.$||Ib.EwaSettings.ma(260);void 0!==this.$&&null!==this.$||tb.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");ob&&tb.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(f.jGa(this.$),this.ea=this.$.ea,this.hi=new sa(this.$),this.$.dl(this.vd),
this.ea.hk(this.od),this.ea.XL(this.Fo),this.ea.Nt(this.Hf),this.$.userOperationManager.xq(this.ER),this.dkf(),this.DMi(),this.w9h(),this.$.da.Ga(35,this),this.QVc.ka(this),ob&&tb.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.Eee=new Hc.a,ob&&tb.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.Hee=new t(this.$,this.hj,this.hi),this.xug=new w(this.$,this.hj,this.hi),this.Fee=new A(this.$,this.hj,this.hi),this.Dee=
new D(this.$,this.hj,this.hi),this.Cee=new B(this.$,this.hj,this.hi),this.Gee=new z(this.$,this.hj,this.hi),this.Iee=new u(this.$,this.hj,this.hi),this.Jee=new x(this.$,this.hj,this.hi),this.$.Eba&&(this.Kee=new h(this.$,this.hj,this.hi)),Ib.EwaSettings.ma(191)&&(this.U0a=new I(this,Qa.g(this.$))),Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&(this.Bee=new N),this.initialized=!0,tb.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))};a.prototype.lAh=
function(sa){if(!this.SBa)return null;for(var ob=0,Wb=this.SBa.length;ob<Wb;ob++)if(sa.startsWith(this.SBa[ob].WebExtensionId))return this.SBa[ob];return null};a.prototype.dkf=function(){var sa,ob=this.ea;if(ob.rc&&!this.bPb){if(ob.workbookContext){if(this.NSc=this.$.ea.Yg.get(22),null===(sa=ob.workbookContext.WebExtensions)||void 0===sa?0:sa.length){sa=ob.workbookContext.WebExtensions;ob=!1;for(var Wb={},hc=sa.length-1;0<=hc;Wb={wPb:Wb.wPb},hc--){if(!this.ea.isNamedObjectViewMode){this.Uoc.push(sa[hc].InstanceId);
if(1!==sa[hc].WebExtensionType){Array.removeAt(sa,hc);continue}if(xb.HelperMethods.Bw(sa[hc])&&0!==sa[hc].SharedRuntime.State)1===sa[hc].SharedRuntime.State?sa[hc].TaskpaneVisible=!1:2===sa[hc].SharedRuntime.State?sa[hc].TaskpaneVisible=!0:tb.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!sa[hc].ContainsCustomFunctions&&!sa[hc].TaskpaneVisible&&!jb.a(sa[hc])){Array.removeAt(sa,hc);continue}}var pc=OSF.OsfControl.isFirstPartyStoreString(sa[hc].PrimaryMarketplace.MarketplaceType);
Ib.EwaSettings.ma(187)&&!pc&&(Array.removeAt(sa,hc),ob||(ob=!0,Wb.wPb=kc.GetServiceTaskFactory.Xa(this.$.da,5,4,3),ma.TaskExtensions.Ba(Wb.wPb,function(xd){return function(){xd.wPb.result.fg(35,null)}}(Wb),this.la,3)));Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&sa[hc].PrimaryMarketplace&&a.QLa(sa[hc].PrimaryMarketplace.SolutionId)&&(tb.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Array.removeAt(sa,
hc))}this.fCe(sa)}}else this.NSc=!1;this.bPb=!0}};a.prototype.g4e=function(sa){var ob=Qa.g(this.$),Wb=ob.ha.Oa.nc;if(Wb&&sa){sa=!1;if(this.If)for(var hc=Gl(this.If),pc=hc.next();!pc.done;pc=hc.next())if(pc=pc.value,a.QLa(pc.BU)||a.vhi(pc.BU)){sa=!0;break}sa||ob.ha.Oa.ZG(Wb)}};a.prototype.DMi=function(){this.Ei&&this.ea.isNamedObjectViewMode&&this.$.qa&&Ke.o(this.$.qa)&&(this.$.da.za(34).dR?this.$.da.za(34).ild():this.$.da.za(34).Mt(this.zSi))};a.prototype.fCe=function(sa){var ob=this,Wb=null;Wb=function(xd){function Gd(){ob.bPa.shift();
0<ob.bPa.length&&Wb(ob.bPa[0])}var te=xd.WebExtensionData,Sd=xd.IsTaskPane,If=xd.RecordHandler;if(ob.waa(te.PrimaryMarketplace.SolutionId))Gd();else{Sd&&(te.WebExtensionOsfControlType=1);var pf=jb.a(te);if(!Sd||te.TaskpaneVisible||pf||te.SharedRuntime&&0!==te.SharedRuntime.State||te.ContainsCustomFunctions){var Ef=new P(ob,ob.hi,te,!Sd);tb.ULS.sendTraceTag(537170517,0,50,"DdaFacade::CreateAllOsfControls: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(te.PrimaryMarketplace.SolutionId,
te.PrimaryMarketplace.MarketplaceType,null,null,null,te.PrimaryMarketplace.MarketplaceRef),te.PrimaryMarketplace.MarketplaceType,xb.HelperMethods.Bw(te));Ef.Wkd();xb.HelperMethods.Bw(te)&&(Ef.VHa=a.Wua(te,ob.$),te.TaskpaneWidth=ob.R5b);pf&&(te.WebExtensionToolTip="");Sd&&te.TaskpaneVisible&&!pf&&(te.TaskpaneWidth=ob.R5b);ob.If.push(Ef);var pg=ob.lxa=null;pg=Ge.a.instance.tC(function(){Ef.vy&&(qd.a.Ha(pg),pg=null,If&&If(xd,Ef),Gd())},100,kf.a.abh)}else Gd()}};for(var hc={},pc=0;pc<sa.length;hc={o1:hc.o1},
pc++)if(!this.kn(sa[pc].InstanceId))if(1!==sa[pc].WebExtensionType)this.w0a(sa[pc]);else if(!Ib.EwaSettings.ma(54))this.umb(sa[pc],Wb);else if(this.$.Qd&8388608||sa[pc].TaskpaneVisible)hc.o1={},hc.o1.marketplaceId=sa[pc].PrimaryMarketplace.SolutionId,hc.o1.marketplaceVersion=sa[pc].PrimaryMarketplace.SolutionVersion,hc.o1.storeType=sa[pc].PrimaryMarketplace.MarketplaceType,hc.o1.storeId=sa[pc].PrimaryMarketplace.MarketplaceRef,hc.o1.targetData=sa[pc],this.Ei.isAddinCommandsAsync(hc.o1,function(xd){return function(Gd,
te,Sd){if(Gd){var If=Sd.targetData;if(te){if(Ib.EwaSettings.ma(88))if(xd.o1.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Gd=xd.o1.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),te=Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForPrivateCatalog")&&xd.o1.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(Gd||te)&&xb.HelperMethods.Bw(If)&&ob.umb(If,Wb);else if(Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))ob.X1h(Sd,
Wb);else{var pf=!1;ob.Uca(function(Ef){if(!Ef.errorCode){if(Ef.value){Ef=Gl(Ef.value);for(var pg=Ef.next();!pg.done&&!pf;pg=Ef.next())pf=ke.e(pg.value[1])===ke.e(If.PrimaryMarketplace.SolutionId)}pf?xb.HelperMethods.Bw(If)&&ob.umb(If,Wb):(Ef={},Ef.SolutionId=Sd.marketplaceId,Ef.TargetType=If.WebExtensionType,Ef.Version=Sd.marketplaceVersion,Ef.StoreType=If.PrimaryMarketplace.MarketplaceType,Ef.StoreId=Sd.storeId,Ef.AssetId=Sd.marketplaceId,Ef.AssetStoreId=Sd.storeId,Ef.Width=If.TaskpaneWidth,If.TaskpaneVisible=
!0,ob.sje(Ef,If,Wb))}},!0)}}else ob.umb(If,Wb)}else Gd=Sd.targetData,tb.ULS.sendTraceTag(542185164,220,15,"Judging AddinCommands failed for {0} from {1} during document loading",Telemetry.PrivacyRules.GetPrivacyCompliantId(Gd.PrimaryMarketplace.SolutionId,Gd.PrimaryMarketplace.MarketplaceType,null,null,null,Gd.PrimaryMarketplace.MarketplaceRef),Gd.PrimaryMarketplace.MarketplaceType)}}(hc))};a.prototype.X1h=function(sa,ob){var Wb=this,hc=!1;this.Uca(function(pc){var xd=sa.targetData;if(!pc.errorCode){if(pc.value){pc=
Gl(pc.value);for(var Gd=pc.next();!Gd.done&&!hc;Gd=pc.next())hc=ke.e(Gd.value[1])===ke.e(xd.PrimaryMarketplace.SolutionId)}hc?xb.HelperMethods.Bw(xd)&&Wb.umb(xd,ob):(pc={},pc.SolutionId=sa.marketplaceId,pc.TargetType=xd.WebExtensionType,pc.Version=sa.marketplaceVersion,pc.StoreType=xd.PrimaryMarketplace.MarketplaceType,pc.StoreId=sa.storeId,pc.AssetId=sa.marketplaceId,pc.AssetStoreId=sa.storeId,pc.Width=xd.TaskpaneWidth,xd.TaskpaneVisible=!0,Wb.sje(pc,xd,ob))}},!0)};a.prototype.umb=function(sa,ob){var Wb=
{};Wb.WebExtensionData=sa;Wb.IsTaskPane=!0;this.bPa.push(Wb);1===this.bPa.length&&ob(Wb)};a.prototype.sje=function(sa,ob,Wb){var hc=this,pc={};pc.ActivationInfo=sa;pc.WebExtensionData=ob;pc.IsTaskPane=!1;pc.RecordHandler=function(xd,Gd){var te=xd.ActivationInfo;hc.Ei.insertBlankControlWithErrorUX(hc.iGb(Gd,te),function(){hc.aQa(Gd.controlId);hc.Ei.purgeOsfControl(Gd.controlId,!1);hc.I9f(te)})};this.bPa.push(pc);1===this.bPa.length&&Wb(pc)};a.prototype.I9f=function(sa){var ob={};ob.solutionId=sa.SolutionId;
ob.version=sa.Version;ob.storeType=sa.StoreType;ob.storeId=sa.StoreId;ob.assetId=sa.AssetId;ob.assetStoreId=sa.AssetStoreId;ob.targetType=sa.TargetType;ob.sharedRuntimeId=sa.SharedRuntimeId;sa=new sc.a;sa.add(ob);ob={};ob[zc.a.tnb]=sa;ob[zc.a.ZT]=3;sa=new Qc.a(dc.a.nBb,0,this.$.Xc,0,null);this.$.Ka.Wb(sa,ob)};a.prototype.iGb=function(sa,ob){var Wb={};Wb.div=sa.vy;Wb.id=sa.controlId;Wb.solutionId=ob.SolutionId;Wb.version=ob.Version;Wb.storeId=ob.StoreId;Wb.storeType=ob.StoreType;Wb.osfControlType=
OSF.OsfControlTarget.TaskPane;return Wb};a.prototype.hSf=function(){var sa=this;if(Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){for(var ob=[],Wb=0;Wb<this.If.length;Wb++){var hc=this.If[Wb];0!==hc.osfControlType&&3!==hc.osfControlType&&4!==hc.osfControlType||ob.push(hc)}Wb=!1;for(hc=0;hc<ob.length;hc++){var pc=ob[hc];this.aQa(pc.controlId);!Wb&&pc&&pc.ml&&(Wb=xb.HelperMethods.Bw(pc.ml))}Wb&&(ob={},ob=(ob.DynamicAddinCommandsMethodDispatchId=4,ob),this.ZJ(-1014260128,
ob))}Ib.EwaSettings.ma(403)&&ma.TaskExtensions.Ba(kc.GetServiceTaskFactory.Xa(this.$.da,278,279,3),function(xd){xd&&(xd=xd.result)&&(sa.$.da.za(278)||sa.$.da.Ga(278,xd),xd.w$e().lna())},this.la,3)};a.prototype.RK=function(){var sa=this,ob=new n(this.$,this.hj,this.iTf);void 0===this.$||null===this.$?tb.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):Ib.EwaSettings.ma(260)&&tb.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+
(void 0===this.hj||null===this.hj));if(ob.hBi()){var Wb=function(){},hc=function(Gd){Gd=sd.a.ig(Gd.data);tb.ULS.sendTraceTag(537170511,0,10,"ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: {0}.",of.a.Tc(Gd))},pc=ob.HQg();ob=function(Gd,te,Sd){return ce.i(sa.$.na.va,"ExecuteRichApiRequest",sa.IQg(pc),Qf.b(Gd,Wb),Qf.a(te,hc),Sd,null,0)};var xd=a.bfd(pc);Ib.EwaSettings.qc()?this.$.userOperationManager.Zt(new Kd.a(507,0,ob,xd|64)):this.$.userOperationManager.Zt(new ne.a(507,
0,ob,xd))}};a.prototype.IQg=function(sa){var ob=this.$.na.va.Na(1);ob.request=sa;return ob};a.prototype.gxe=function(sa,ob){if(sa)for(var Wb=0;Wb<sa.length;Wb++)if($f.a.equals(sa[Wb],ob,!0))return!0;return!1};a.prototype.LPg=function(sa){var ob={};ob.navigationMode=OSF.OsfNavigationMode.DefaultMode;ob.assetId=null;ob.category=null;if(!sa||3>sa.length)return ob;if(sa[0]){var Wb=parseInt(sa[0],10);isNaN(parseInt(Wb,10))||(ob.navigationMode=Wb)}sa[1]&&(ob.assetId=sa[1]);sa[2]&&(ob.category=sa[2]);return ob};
a.prototype.w9h=function(){if(Ib.EwaSettings.ma(62)){var sa=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(sa&&"*"!==sa.trim()){this.DIa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new ba(this),sa,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.Yf.get(2));try{this.DIa.init()}catch(ob){try{this.DIa.dispose()}catch(Wb){}this.DIa=null;tb.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+ob.message)}sa={};sa.a=this.$.ya.UserSessionId;
Kc.b().Pe(39,sa)}}};a.prototype.X1f=function(sa,ob,Wb){var hc=this,pc=a.YOg(sa[0]),xd=pc.yha,Gd=pc.nia;pc.yha=function(){xd&&xd();var te=pc.tLa!==OSF.InfoType.Error?ob:null;sa.shift();sa.length?hc.X1f(sa,te,Wb):te&&te()};pc.nia=function(){Gd&&Gd();Wb&&pc.tLa!==OSF.InfoType.Error&&Wb()};Bb.a.VQd(pc)};a.prototype.WOh=function(){var sa={};sa.AddinRibbonControlsOverriddenByApi=Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();sa.AddinActionDefinitionHybridMode=
Ib.EwaSettings.ma(640).toString();sa.UseActionIdForUILessCommand=Ib.EwaSettings.ma(643).toString();sa.AllowStorageAccessByUserActivationOnIFrame=Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();sa.RequirementSetRibbonApiOnePointTwo=Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();sa.flightingTreatmentVariables=Ra.AFrameworkApplication.fa.U9b;sa.ShortcutInfoArrayInUserPreferenceData=
Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return sa};a.getSolutionId=function(sa){var ob=sa.PrimaryMarketplace.SolutionId;Ib.EwaSettings.ma(294)&&sa.OwnerAddinSolutionId&&(ob=sa.OwnerAddinSolutionId);return ob};a.bfd=function(sa){var ob=0;Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?sa.RequestFlags&1&&256!==(sa.RequestFlags&256)||(ob=16):ob=sa.RequestFlags&1?0:16;return ob};a.Wua=function(sa,
ob){ob=a.getSolutionId(sa,ob);return a.FXe(ob,sa.PrimaryMarketplace.SolutionVersion,sa.PrimaryMarketplace.MarketplaceType,sa.PrimaryMarketplace.MarketplaceRef)};a.G8g=function(sa){var ob={};sa=(ob.recording=sa,ob);return JSON.stringify(sa)};a.$3g=function(sa){var ob={};ob.visibility=sa?"Visible":"Hidden";return JSON.stringify(ob)};a.dLh=function(sa){var ob=sa.getSolutionId(),Wb=sa.getVersion(),hc=sa.getStoreType();sa=sa.getStoreId();return a.FXe(ob,Wb,hc,sa)};a.FXe=function(sa,ob,Wb,hc){return String.format("{0}|{1}|{2}|{3}|{4}|||",
"2",sa,ob,a.VWh(Wb).toString(),hc)};a.Wgd=function(sa,ob){var Wb=sa.split("|");if(7>Wb.length)return tb.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==Wb[0])return tb.ULS.sendTraceTag(537170508,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='{0}'.",Wb[0]),null;var hc=Wb[1],pc=Wb[2],xd=a.WWh(Wb[3]),Gd=Wb[4];Wb=Wb[5];hc&&hc.length||(hc=Wb);Wb={};Wb.InstanceId=String.format("{{{0}}}",cc.a.create().toString());
Wb.WebExtensionOsfControlType=4;Wb.WebExtensionType=1;Wb.PrimaryMarketplace={};Wb.PrimaryMarketplace.SolutionId=hc;Wb.PrimaryMarketplace.SolutionVersion=pc;Wb.PrimaryMarketplace.MarketplaceRef=Gd;Wb.PrimaryMarketplace.MarketplaceType=xd;Wb.ContainsCustomFunctions=ob?!0:!1;ob&&(Wb.OsfPropertyBag=[["customFunctionAddinId",sa]]);return Wb};a.WWh=function(sa){sa=parseInt(sa,10);return sa===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:sa===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:sa===OSF.StoreTypeEnum.SPApp?
OSF.StoreType.SPApp:sa===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:sa===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:sa===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:sa===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:sa===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:sa===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:sa===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:sa===OSF.StoreTypeEnum.WopiCatalog?
OSF.StoreType.WopiCatalog:null};a.VWh=function(sa){return sa===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:sa===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:sa===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:sa===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:sa===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:sa===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:sa===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:sa===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:
sa===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:sa===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:sa===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1};a.orb=function(sa){var ob={};ob.Version=sa.version;ob.AssetId=sa.assetId;ob.AssetStoreId=null!==sa.assetStoreId?sa.assetStoreId.toString():null;ob.StoreType=sa.storeType;ob.Height=sa.height;ob.SolutionId=sa.solutionId;ob.StoreId=sa.storeId;ob.TargetType=sa.targetType;ob.Width=1===ob.TargetType?0:sa.width;
ob.SharedRuntimeId=sa.sharedRuntimeId;return ob};a.Nyb=function(sa){return sa===OSF.DDA.EventDispId.dispidSettingsChangedEvent||sa===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||sa===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||sa===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||sa===OSF.DDA.EventDispId.dispidRichApiMessageEvent||sa===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||sa===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||sa===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};
a.YOg=function(sa){return Object(Ya.a)(new nd.a,{tLa:sa.infoType,id:sa.id,title:sa.title,description:sa.description,buttonText:sa.buttonTxt,yha:sa.buttonCallback,Jdc:sa.highPriority,nia:sa.dismissCallback,errorCode:sa.errorCode,y8e:sa.iframeNotificationUrl})};a.QLa=function(sa){var ob="FA000000014"===sa;ob||(ob="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===sa);return ob};a.vhi=function(sa){return"FA000000005"===sa};Ck.Object.defineProperties(a.prototype,{P_b:{configurable:!0,enumerable:!0,get:function(){return this.Yea||
(this.Yea=new Ja.a(this.$.jw))}},Ei:{configurable:!0,enumerable:!0,get:function(){if(!this.En){var sa={},ob=!(this.$.Qd&1),Wb=Ub.a.current.UN,hc=this.$.workbookContext,pc=Rb.a.yI+Rb.a.a3b,xd=0;Ib.EwaSettings.ma(489)&&(xd|=2);sa.pageBaseUrl=Wb.LayoutsContentUrlPrefix;sa.appName=OSF.AppName.ExcelWebApp;sa.appVersion="16";sa.appSettings=this.WOh();sa.singleSignOnSettings=Nb.AppsForOfficeSingleSignOnManager.zWh();sa.clientMode=ob?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;sa.appUILocale=this.$.ya.UICultureTag;
sa.dataLocale=this.$.ya.DataCultureTag;sa.docUrl=hc.ClientUrl;sa.hostControl=this;sa.formFactor=OSF.FormFactor.Default;sa.lcid=this.$.jG.toString();sa.localizedScriptsUrl=Rb.a.yI+Rb.a.w1c;sa.localizedImagesUrl=pc;sa.localizedStylesUrl=Rb.a.yI+Rb.a.eAe;sa.localizedResourcesUrl=pc;sa.osfOmexBaseUrl=Wb.OsfOmexBaseUrl;sa.firstPartyManifestCDNUrl=Wb.FirstPartyAddInManifestCDN;sa.sdxAssetsToPrefetchMapping=Ra.AFrameworkApplication.fa.Va("SdxAssetsToPrefetchMapping");sa.sdxCdnUrl=Wb.SdxCdnUrl;sa.sdxDmsUrl=
Wb.SdxDmsUrl;sa.devCatalogUrl=Wb.DevCatalogUrl;sa.controlStatusChanged=this.Onc;sa.notifyHost=this.vzf;sa.allowExternalMarketplace=this.$.ea.Yg.get(27)&&a.f2c;sa.enableAddinCommands=Ib.EwaSettings.ma(54);sa.enableBlackForestRedirect=Ib.EwaSettings.ma(89);sa.enableMyOrg=this.$.ea.Yg.get(33);sa.enableMyApps=this.$.ea.Yg.get(34);sa.enableDevCatalog=Ib.EwaSettings.ma(45);sa.enablePrivateCatalog=this.Luj();sa.enableTaskpaneUpgradeToAppCommand=Ib.EwaSettings.ma(94);sa.showSignOutFromPrivateCatalogMessage=
this.$.ea.Yg.get(36);sa.enableUploadFileDevCatalog=Ib.EwaSettings.ma(54)&&!Ib.EwaSettings.ma(283);sa.userNameHashCode=Cb.a.ew(Ra.AFrameworkApplication.userName);sa.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();sa.enableSingleSignOnForAddin=!Ib.EwaSettings.ma(24)&&Ra.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;sa.enableDisplayBlockedMinorError=Ib.EwaSettings.ma(184);sa.hideAppsExtensionUrl=Ra.AFrameworkApplication.hideAppsExtensionUrl;sa.enableAnonymousUseLegacyCatalogService=
Ib.EwaSettings.ma(174);sa.enableInsertDialogAccessibilityFix=Ib.EwaSettings.ma(181);sa.disableAppsForOfficeThirdParty=Ib.EwaSettings.ma(187);sa.enableFirstPartySSO=Ib.EwaSettings.ma(199);sa.wacSessionId=this.$.ya.UserSessionId;sa.disableLogging=!this.$.ya.AriaLoggingIsEnabled;sa.enableFirstPartySDXErrorMessages=Ib.EwaSettings.ma(212);sa.enableRichApiCellEditDelay=Ib.EwaSettings.ma(191);sa.isHostDocumentDomain=Ib.EwaSettings.ma(227);sa.loggableUserId=Ra.AFrameworkApplication.fa.Va("LoggableUserId");
sa.sessionStartInfoJson=Ra.AFrameworkApplication.fa.Va("SessionStartInfoJson");sa.wopiHostOriginFromPostMessage=Ra.AFrameworkApplication.wopiHostOriginFromPostMessage;sa.wopiHostOriginFromWacPropBag=Ra.AFrameworkApplication.fa.Va("PostMessageOrigin");sa.wacIsEmbedded=Ra.AFrameworkApplication.fa.ra("IsEmbedded");sa.accessibilityAllowFocusAddinTaskpane=Ra.AFrameworkApplication.fa.ra("AccessibilityAllowFocusAddinTaskpane");sa.enableRemoveAppCommandsAddin=Ra.AFrameworkApplication.fa.ra("RemoveAppCommandsAddinIsEnabled");
sa.isHostFrameTrustCheckEnabledForAddIns=Ra.AFrameworkApplication.fa.ra("HostFrameTrustCheckIsEnabledForAddIns");sa.isHostFrameTrusted=Ra.AFrameworkApplication.isHostFrameTrusted;sa.agaveAddinUploadEnabled=Ib.EwaSettings.ma(47);sa.hostAllowedOfficeStore=Ra.AFrameworkApplication.fa.ra("HostAllowedOfficeStore");sa.hostAllowedSdxEmbedding=Ra.AFrameworkApplication.fa.ra("HostAllowedSdxEmbedding");sa.hostInstallAddIns=Ra.AFrameworkApplication.fa.Va("HostInstallAddIns");sa.hostInstallAddInsIsEnabled=Ra.AFrameworkApplication.fa.ra("HostInstallAddInsIsEnabled");
sa.approvedAddIns=Ra.AFrameworkApplication.fa.Va("ApprovedAddIns");sa.addinEnforceHttpsIsEnabled=this.Vtj(sa.sessionStartInfoJson);sa.hostFeatureGateFlag=xd;sa.isUpnCheckEnabled=Ra.AFrameworkApplication.fa.ra("IsUpnCheckEnabled");sa.wacUpn=Ra.AFrameworkApplication.fa.Va("UserPrincipalName");sa.isReactRibbonEnabled=hd.a.isReactRibbonEnabled();sa.enableSetFocusOnTaskpaneOnUserAction=Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);sa.isSafariWithIndexedDBDisabled=
Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&mb.a.CMa;sa.isIndexedDBDisabled=Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&mb.a.CMa||Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&mb.a.Nf;sa.enableCustomShortcuts=Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");sa.changeGetModifierKeyStringOutputOrder=Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");
sa.officeJsUrlBase=Rb.a.yI+Rb.a.c3b+"OfficeJs/";sa.enableOfficeJsUrlBaseQueryParam=Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlBaseQueryParam",!1);this.En=new OSF.ContextActivationManager(sa);sa={};this.En.setIframeAttributeBag((sa.frameborder=0,sa.marginheight=0,sa.marginwidth=0,sa));this.En.setWSA(Ra.AFrameworkApplication.Xm);this.En&&"undefined"!==typeof this.En.hostCheckReadyHandler&&Ra.AFrameworkApplication.LEg(Object(va.a)(this.En,this.En.hostCheckReadyHandler,
"hostCheckReadyHandler"));try{var Gd=yc.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.En.setOAuthManager(Gd)}catch(te){}}return this.En}},cVj:{configurable:!0,enumerable:!0,get:function(){return this.NSc}},hj:{configurable:!0,enumerable:!0,get:function(){return this.Eee}},ina:{configurable:!0,enumerable:!0,get:function(){return this.Bee}},kLd:{configurable:!0,enumerable:!0,get:function(){return this.Fee}},jLd:{configurable:!0,enumerable:!0,get:function(){return this.Dee}},Bgj:{configurable:!0,
enumerable:!0,get:function(){return this.Hee}},zgj:{configurable:!0,enumerable:!0,get:function(){return this.Cee}},Agj:{configurable:!0,enumerable:!0,get:function(){return this.Gee}},Cgj:{configurable:!0,enumerable:!0,get:function(){return this.Iee}},Dgj:{configurable:!0,enumerable:!0,get:function(){return this.Jee}},lLd:{configurable:!0,enumerable:!0,get:function(){return this.Kee}},JV:{configurable:!0,enumerable:!0,get:function(){return this.Mpg}},$:{configurable:!0,enumerable:!0,get:function(){return this.xb}}});
Ck.Object.defineProperties(a,{f2c:{configurable:!0,enumerable:!0,get:function(){return a.z3d},set:function(sa){a.z3d=sa}}});a.O0a=new nc.a;a.z3d=!0;Object(Ia.a)(a,"DdaFacade",zb.a,[461,506,503,507,508,3])},947:function(y,C,b){function a(){this.CHd=0;this.PW={};this.gta={}}b.d(C,"a",function(){return a});y=b(0);var c=b(15),e=b(113);a.prototype.oSh=function(f,l){return this.PW[a.AYc(f,l)]};a.prototype.uKe=function(f,l){l||void 0!==this.gta[f]&&null!==this.gta[f]?l&&void 0!==this.gta[f]&&null!==this.gta[f]&&
delete this.gta[f]:this.gta[f]=1};a.prototype.G_b=function(f){return void 0===this.gta[f]||null===this.gta[f]};a.prototype.a1h=function(f){var l=a.AYc(f.messageType,f.targetId);1===f.actionType?this.v2h(f.controlId,f.messageType,l):2===f.actionType&&this.e3h(f.controlId,f.messageType,l)};a.prototype.J8i=function(f){if(f){var l=Object.keys(this.PW);if(!(void 0===l||null===l||0>=l.length)){l=Gl(l);for(var n=l.next();!n.done;n=l.next()){n=n.value;var m=this.PW[n];m[f]&&(delete m[f],Object.keys(m).length||
delete this.PW[n])}}}};a.prototype.c_=function(f,l){f=a.AYc(f,l);f=this.PW[f];return!!f&&0<Object.keys(f).length};a.prototype.V3h=function(){return!e.a.isEmpty(this.PW)};a.prototype.Bgf=function(){return 0<this.CHd};a.prototype.OMh=function(){var f=[],l=this.PW,n;for(n in l){var m=n,h=l[n],x;for(x in h){h=x;var u={};u.eventType=parseInt(m.split("#")[0],10);u.targetId=m.split("#")[1];u.addinId=h;f.push(u)}}return f};a.prototype.v2h=function(f,l,n){if(this.PW[n])n=this.PW[n],n[f]=n[f]?n[f]+1:1;else{var m=
{};m[f]=1;this.PW[n]=m}100===l&&this.CHd++};a.prototype.e3h=function(f,l,n){if(this.PW[n]){var m=this.PW[n];if(f){var h=m[f];1===h?(delete m[f],Object.keys(m).length||delete this.PW[n]):m[f]=h-1;100===l&&this.CHd--}else c.ULS.sendTraceTag(537170459,0,50,"The OsfControl[{0}] doesn't register event with key[{1}].",f,n)}else c.ULS.sendTraceTag(537170460,0,50,"The event with key[{0}] that will be unregistered doesn't exist.",n)};a.AYc=function(f,l){return String.format("{0}#{1}",f,l)};a.cX="Workbook";
Object(y.a)(a,"RichApiEventRegistration",null,[])},973:function(y,C,b){function a(c,e,f,l){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=c;this.controlId=e;this.ddaBinding=f;this.ArrayData=void 0===l?null:l}b.d(C,"a",function(){return a});y=b(0);a.prototype.getDispid=function(){return this.dispid};a.prototype.getDdaBinding=function(){return this.ddaBinding};Object(y.a)(a,"DdaEventArgs",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.agave.js.map/0f8a74d105aa31e652134b7492856665/EwaDS.agave.js.map