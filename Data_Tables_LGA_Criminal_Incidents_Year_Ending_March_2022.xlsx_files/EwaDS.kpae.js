(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1015:function(y,C,b){function a(Y,U,ha){this.CQb=null;this.EF={};this.tRb=this.sx=null;n.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=Y;this.I3d=a.j5c;this.J3d=a.borderStyleSolidLine;this.Sg=U;this.Ta=ha;z.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ga(296,this);this.WU=new c(this.$,this.Sg);this.TC=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1);n.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName {0}","296")}function c(Y,U){var ha=this;this.oGb=this.ribbonCommandInfo=this.cellFormat=this.Nr=this.Db=this.ha=null;this.Lrc=!1;this.CHf=this.wLa=this.KHf=this.t7d=this.dza=this.Dma=null;this.H0b=this.dua=this.JHf=0;this.borderStyle=this.JZa=this.borderColor=null;this.mB=!1;this.l5b=this.R$a=null;this.s0=function(){if(!ha.mB||I.g(ha.$).wz)ha.mB=!1,I.g(ha.$).wz=!1,ha.dua=0,I.g(ha.$).ug.Jo(x.a.J4),
1===ha.$.Ka.lH()&&(I.g(ha.$).xV(A.a.clone(ha.KHf),ha.JHf,ha.$.qa?ha.$.qa.sheetName:null,null,ha.CHf.clone(),null,null,0,G.a.lhh,!0),I.g(ha.$).WRa(!0)),ha.Kv(),ha.cXd(),ha.al(),ha.Lrc=!1,ha.Dma=null,ha.dza=null,ha.Nr&&(ha.Nr.cancel(),ha.Nr.dispose()),n.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=function(ta){try{if(ta=ha.ie(ta),I.g(ha.$).wz=!0,ha.Dma={},ha.dza={},ha.R$a=null,ha.Tob(ha.H0b),2===ta.zb){var xa=I.g(ha.$).ha.Xn(ta.clientPoint,
ta.Lb,5,void 0,void 0,!1);xa&&(ha.wLa=xa,ha.l5b=xa,ha.n6i())}}catch(oa){I.g(ha.$).wz=!1}return!0};this.Ih=function(ta){try{ta=ha.ie(ta);var xa=I.g(ha.$).ha.Xn(ta.clientPoint,ta.Lb,5,void 0,void 0,!1),oa=I.g(ha.$).Ea.cs(xa);if(!ha.oGb||oa&&(oa.cK!==ha.oGb.cK||oa.bK!==ha.oGb.bK))if(ha.mB=!0,ha.oGb=oa,xa){var qa=new M.Range(ha.wLa.top,ha.wLa.left,ha.wLa.top,ha.wLa.left,!0,!1);qa.union(xa);qa=I.g(ha.$).ha.RTh(qa);ha.L0b(xa);ha.GSf(ha.R$a,qa);if(ha.bottomRightCorner(qa.bottom,qa.right))return n.ULS.sendTraceTag(537159515,
0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),!1;var Ea=new M.Range(qa.top,qa.left,qa.bottom+1,qa.right+1,!0,!1),ka=I.g(ha.$).N$("DrawBorderBehavior.OnPointerMove",[Ea]);if(ha.Dma&&ha.dza)for(;ka.$$mn();){var za=ka.$$cu(),La=za.cell.getRange().toString();La in ha.Dma&&1!==ha.dua||(ha.Dma[La]=za,ha.dza[La]=za.cell.BM())}ha.R$a=Ea;ha.l5b=qa;I.g(ha.$).xV([qa],0,ha.$.qa.sheetName,null,qa.topLeft,null,null,0,G.a.ihh,!0);ha.Sg.Sda(I.g(ha.$),-1690267012,
ha.cellFormat,!0,null,[qa])}return!0}catch(Ia){return I.g(ha.$).wz=!1}};this.Gf=function(ta){ta=ha.ie(ta);(ta=I.g(ha.$).ha.Xn(ta.clientPoint,ta.Lb,5,void 0,void 0,!1))?ha.mB&&(ha.L0b(ta),ha.wLa.union(ta),3===ha.dua?ha.Tob(0):ha.Tob(ha.H0b),I.g(ha.$).xV([ha.wLa],0,ha.$.qa.sheetName,null,null,null,null,0,G.a.jhh,!0),ha.Sg.formatCells(-1690267012,ha.cellFormat,ha.ribbonCommandInfo)):(3===ha.dua?ha.Tob(0):ha.Tob(ha.H0b),I.g(ha.$).xV([ha.l5b],0,ha.$.qa.sheetName,null,null,null,null,0,G.a.khh,!0),ha.Sg.formatCells(-1690267012,
ha.cellFormat,ha.ribbonCommandInfo));ha.mB=!1;ha.cXd();ha.Dma=null;ha.dza=null;return!0};this.onKeyDown=function(ta){ta=ha.ie(ta);if(ha.mB||Array.contains([17,16,18,20],ta.Ca.keyCode))return!0;ha.s0();return!1};this.onKeyUp=function(ta){ta=ha.ie(ta);if(ta.Ca.keyCode===B.a.pL&&ha.mB)return ha.mB=!1,ha.GSf(ha.R$a,ha.l5b,!0),ha.cXd(),!0;if(ha.mB||ta.Ca.keyCode===B.a.i8||ta.Ca.keyCode===B.a.v0d||ta.Ca.keyCode===B.a.u0d||Array.contains([17,16,18,20,37,39,38,40,33,34,9,13],ta.Ca.keyCode)||ta.Ca.keyCode===
B.a.gjg||ta.Ca.keyCode===B.a.cjg||ta.Ca.keyCode===B.a.Zig)return!0;ha.s0();return!1};this.uN=function(ta,xa){I.g(ha.$).wz&&!Array.contains(ha.H6h,xa.Sd.command)&&(n.ULS.sendTraceTag(537159512,0,50,"DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : {0} ",xa.Sd),ha.s0())};this.$=Y;this.Sg=U}function e(Y){Y.lNf()}function f(){this.iconName=this.title=this.key=null}function l(Y,U,ha,ta,xa,oa,qa,Ea){this.Gkg=Y;this.Hkg=U;this.Fkg=ha;this.Bga=ta;this.iwg=xa;this.rsg=oa;this.vjb=qa;this.prg=
Ea}b.r(C);y=b(0);var n=b(15),m=b(1022),h=b(932),x=b(5),u=b(79),w=b(54),v=b(203),t=b(35),z=b(1),D=b(14);l.kPg=function(){return new l("BorderStyleSolidLine",1928,1,"1","",1,8,0)};l.gPg=function(){return new l("BorderStyleDashedLine",1929,3,"1","5,3",1,8,0)};l.hPg=function(){return new l("BorderStyleDottedLine",1930,4,"1","1,1",1,8,0)};l.jPg=function(){return new l("BorderStyleMediumLine",1931,2,"2","",1,8,0)};l.lPg=function(){return new l("BorderStyleThickLine",1932,5,"3","",1,8,0)};l.iPg=function(){return new l("BorderStyleDoubleLine",
1933,6,"1","",2,8,3)};Ck.Object.defineProperties(l.prototype,{tte:{configurable:!0,enumerable:!0,get:function(){return this.Gkg}},F0b:{configurable:!0,enumerable:!0,get:function(){return this.Hkg}},ste:{configurable:!0,enumerable:!0,get:function(){return this.Fkg}},width:{configurable:!0,enumerable:!0,get:function(){return this.Bga}},dEj:{configurable:!0,enumerable:!0,get:function(){return this.iwg}},tDi:{configurable:!0,enumerable:!0,get:function(){return this.rsg}},lineHeight:{configurable:!0,enumerable:!0,
get:function(){return this.vjb}},Jqi:{configurable:!0,enumerable:!0,get:function(){return this.prg}}});Object(y.a)(l,"BorderLineStyleProperties",null,[]);Object(y.a)(f,"BorderLineStyleProps",null,[]);e.prototype.getBorderLineStyleProps=function(){var Y=b(1015).BorderFormatManager.IZa,U=Array(Object.keys(Y).length),ha=0,ta;for(ta in Y){var xa=ta,oa=Y[ta];U[ha]=new f;U[ha].key=xa;xa=oa;U[ha].title=D.a.instance.ga(xa.F0b);U[ha].iconName=xa.tte;ha++}return U};Object(y.a)(e,"BorderMenuController",null,
[787]);var A=b(277),B=b(86),N=b(244),P=b(13),Q=b(109),M=b(25),ba=b(47),V=b(43),aa=b(214),E=b(10),G=b(105),I=b(22),R=b(33);c.prototype.Qyg=function(Y){n.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=I.g(this.$).ha;this.Db=I.g(this.$).Db;this.ribbonCommandInfo=Y;this.KHf=A.a.clone(this.ha.ta.selectedRanges);this.JHf=this.ha.ta.nt;this.CHf=this.ha.ta.activeCell.clone();this.Db&&this.Db.njd();this.sv();this.Ej()};c.prototype.dispose=function(){this.s0();
this.oGb=this.ribbonCommandInfo=this.cellFormat=null};c.prototype.Tob=function(Y){var U=b(1015).BorderFormatManager;this.cellFormat={};var ha={};this.borderColor=this.borderColor||U.j5c;var ta=v.a.gH(this.borderColor,!1);ha.Color=[ta,ta,ta,ta];z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.JZa&&(ha.ThemeBorderColor=[this.JZa,this.JZa,this.JZa,this.JZa],ha.ColorTypeOption=1);ta=b(1015).BorderFormatManager.IZa;this.borderStyle=this.borderStyle||U.borderStyleSolidLine;
U=ta[this.borderStyle].ste;ha.LineStyle=[U,U,U,U];this.cellFormat.BorderFormat=ha;this.cellFormat.ValidMembers=128;this.cellFormat.Border=Y};c.prototype.sv=function(){for(var Y=Gl(I.g(this.$).vn),U=Y.next();!U.done;U=Y.next())N.a.instance.pa(P.a.pointerDown,U.value.domElement,this.onPointerDown);Q.KeyInputManager.instance.pa(P.a.Xb,document.documentElement,this.onKeyDown);Q.KeyInputManager.instance.pa(P.a.Vd,document.documentElement,this.onKeyUp)};c.prototype.n6i=function(){for(var Y=Gl(I.g(this.$).vn),
U=Y.next();!U.done;U=Y.next())U=U.value,N.a.instance.pa(P.a.vh,U.domElement,this.Ih),N.a.instance.pa(P.a.Zd,U.domElement,this.Gf);N.a.instance.pa(P.a.Zd,document.documentElement,this.Gf);N.a.instance.pa(P.a.xy,document.documentElement,this.Gf);this.Lrc=!0};c.prototype.Kv=function(){try{for(var Y=Gl(I.g(this.$).vn),U=Y.next();!U.done;U=Y.next())N.a.instance.Aa(P.a.pointerDown,U.value.domElement,this.onPointerDown);Q.KeyInputManager.instance.Aa(P.a.Xb,document.documentElement,this.onKeyDown);Q.KeyInputManager.instance.Aa(P.a.Vd,
document.documentElement,this.onKeyUp)}catch(ha){I.g(this.$).wz=!1,n.ULS.sendTraceTag(537159514,0,10,"DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception {0}",ha)}};c.prototype.cXd=function(){if(this.Lrc)try{this.Lrc=!1;for(var Y=Gl(I.g(this.$).vn),U=Y.next();!U.done;U=Y.next()){var ha=U.value;N.a.instance.Aa(P.a.vh,ha.domElement,this.Ih);N.a.instance.Aa(P.a.Zd,ha.domElement,this.Gf)}N.a.instance.Aa(P.a.Zd,document.documentElement,this.Gf);N.a.instance.Aa(P.a.xy,
document.documentElement,this.Gf)}catch(ta){I.g(this.$).wz=!1,n.ULS.sendTraceTag(537159513,0,10,"DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception {0}",ta)}};c.prototype.Ej=function(){this.$.xa.og(this.s0);I.g(this.$).pc.ql(this.s0);I.g(this.$).eE(this.s0);this.$.Ka.Wra(this.uN)};c.prototype.al=function(){this.$.xa.Wg(this.s0);I.g(this.$).pc.kl(this.s0);I.g(this.$).KF(this.s0);this.$.Ka.Dza(this.uN)};c.prototype.GSf=function(Y,U,ha){ha=void 0===ha?!1:ha;
if(Y&&this.Dma&&this.dza)for(Y=I.g(this.$).N$("DrawBorderBehavior.ApplyBordersOnPreviewCells",[Y]);Y.$$mn();){var ta=Y.$$cu().cell.getRange();if(ha||!U.contains(ta)||1===this.dua){ta=ta.toString();var xa=t.a.Nc(this.Dma,ta);if(xa){var oa=t.a.Nc(this.dza,ta);this.setBorders(xa,oa);delete this.Dma[ta];delete this.dza[ta]}}}};c.prototype.setBorders=function(Y,U){var ha=Y.cell,ta=ha.getRange();ha.Pab();ta.right!==this.R$a.right&&(ha=new M.Range(ta.top,ta.left-1,ta.bottom,ta.left-1,!0,!1),I.g(this.$).Ea.cs(ha).YPa(3));
ta.bottom!==this.R$a.bottom&&(ha=new M.Range(ta.top-1,ta.left,ta.top-1,ta.right,!0,!1),I.g(this.$).Ea.cs(ha).YPa(1));if(null===U||void 0===U?0:U.Borders.length){var xa={};ha=0;for(var oa=Array(4),qa=Array(4),Ea=0;4>Ea;Ea++)oa[Ea]=1,qa[Ea]=0;U=Gl(U.Borders);for(Ea=U.next();!Ea.done;Ea=U.next()){Ea=Ea.value;var ka=Ea.BorderPosition;oa[ka]=Ea.BorderLineStyle;var za=new aa.a(Ea.Color.Red,Ea.Color.Green,Ea.Color.Blue);qa[ka]=za.BS();ha|=E.HelperMethods.j3a(Ea.BorderPosition)}xa.LineStyle=oa;xa.Color=qa;
xa={BorderFormat:xa};xa.Border=ha;this.Sg.jqj(Y,xa,ta)}};c.prototype.L0b=function(Y){var U=this,ha=new M.Range(Math.max(1,Y.top-1),Math.max(1,Y.left-1),Y.bottom+1,Y.right+1,!1,!1);I.g(this.$).i_(ha)||this.Nr&&this.Nr.yo||(this.Nr=ba.a.instance.create(function(){I.g(U.$).jt(ha,60,G.a.ghh)},40,V.a.hhh))};c.prototype.bottomRightCorner=function(Y,U){return 1048576<=Y||16384<=U?!0:!1};c.prototype.ie=function(Y){return R.a(this.$).ie(Y)};Ck.Object.defineProperties(c.prototype,{H6h:{configurable:!0,enumerable:!0,
get:function(){return this.t7d||(this.t7d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}}});Object(y.a)(c,"DrawBorderBehavior",null,[3]);b.d(C,"BorderFormatManager",function(){return a});a.prototype.i4e=function(Y,U){n.ULS.sendTraceTag(537159564,0,50,"HandleBorderCommand : Begin handling, Command being executed: {0}",U.command.toString());var ha=
{},ta={};var xa=v.a.gH(this.y3,!1);ta.Color=[xa,xa,xa,xa];this.TC&&this.yta&&(ta.ThemeBorderColor=[this.yta,this.yta,this.yta,this.yta],ta.ColorTypeOption=1);Y=-600086683===U.command?"OutsideBorders":Y[u.a.kd];ta.LineStyle=t.a.Nc(a.OGf,Y);ta.LineStyle?n.ULS.sendTraceTag(537159562,0,50,"RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is {0}",Y):(xa=a.IZa[this.IHa].ste,ta.LineStyle=[xa,xa,xa,xa],n.ULS.sendTraceTag(537159563,0,50,"RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is {0}",
this.IHa));xa=t.a.mq(a.hOg,Y,0);n.ULS.sendTraceTag(40732555,0,50,"RibbonCommand.Border is using the BorderFormat information, the border type requested is {0}, the border color selected is {1}",Y,this.y3);ha.BorderFormat=ta;4!==xa&&8!==xa||!this.$.qa.displayRtl||(xa=4===xa?8:4);ha.ValidMembers=128;ha.Border=xa;this.Sg.formatCells(-1690267012,ha,U);n.ULS.sendTraceTag(537159561,0,50,"HandleBorderCommand : Successfully handled, Command executed: {0}",U.command.toString());return!0};a.prototype.vhd=function(Y,
U,ha){n.ULS.sendTraceTag(537159560,0,50,"RibbonCommand:{0} is being executed, the previous border color is {1}",Y.toString(),this.y3);if(this.TC){if((U.SqmControlId||"").includes("ThemeColorPicker")){var ta=this.themesManager.getThemeColor(U.Color);var xa=ta.themeIndex;var oa=ta.dBa;ta.returnValue?(this.tRb={},this.yta.ThemeColorIndex=xa,this.yta.ThemeColorRow=oa):this.tRb=null}else this.tRb=null;this.WU.JZa=this.yta}this.I3d=-1803452024===Y?a.j5c:U.Color;this.WU.borderColor=this.y3;this.sKe(ha);
this.$.Bf();n.ULS.sendTraceTag(40944211,0,50,"RibbonCommand:{0} is being executed, the updated border color is {1}",Y.toString(),this.y3);return!0};a.prototype.d2h=function(Y){n.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");var U=this.Ta.Cq(),ha=this.Ta.Pc();U.Ec.push(ha);var ta=this.Ta.uC("StyleDashGallery",1,"Size120by20");ha.buttons.push(ta);ha=a.IZa;for(var xa in ha){var oa=xa,qa=ha[xa],Ea=D.a.instance.ga(qa.F0b);ta.Kt(oa,-2118943501,"QueryBorderStyle",
qa.F0b,oa,oa,void 0,void 0,Ea)}n.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");Y.MenuItems=U.jE();n.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")};a.prototype.C0h=function(Y,U){n.ULS.sendTraceTag(537159555,0,50,"RibbonCommand.BorderStyle: Begin handling, Current Border Style is {0}",this.IHa);Y=Y[u.a.kd];if(a.Omi(Y))this.J3d=Y,n.ULS.sendTraceTag(537159554,0,50,"RibbonCommand.BorderStyle: Updated Border Style is {0}",this.IHa);else return n.ULS.sendTraceTag(537159553,
0,15,"RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : {0}",Y),!0;this.WU.borderStyle=this.IHa;this.sKe(U);this.$.Bf();n.ULS.sendTraceTag(40944220,0,50,"RibbonCommand.BorderStyle: Successfully handled Current Border Style is {0}",this.IHa);return!0};a.prototype.Ahd=function(Y){n.ULS.sendTraceTag(537159552,0,50,"HandleDrawBorderCommand : Begin handling, Command being executed: {0}",Y.command.toString());this.nTc(Y,64,this.y3,87,1);return!0};a.prototype.Bhd=function(Y){n.ULS.sendTraceTag(537159523,
0,50,"HandleDrawBorderGridCommand : Begin handling, Command being executed: {0}",Y.command.toString());this.nTc(Y,112,this.y3,88,2);return!0};a.prototype.v4e=function(Y){n.ULS.sendTraceTag(537159522,0,50,"HandleEraseBorderCommand : Begin handling, Command being executed: {0}",Y.command.toString());this.nTc(Y,112,"white",89,3);return!0};a.prototype.g2h=function(Y){this.Roj(this.jOg,Y,Y.MenuItemId?Y.MenuItemId:a.borderStyleSolidLine)};a.prototype.Roj=function(Y,U,ha){ha in Y?(Y=Y[ha],n.ULS.sendTraceTag(537159521,
0,50,"HandleQueryBorderStyleCommand:SetIcon command {0}",ha),this.Toj(U,Y)):n.ULS.sendTraceTag(537159520,0,15,"HandleQueryBorderStyleCommand: cannot find dashes '{0}' in BorderLineStyleButtons dictionary",ha)};a.prototype.r2h=function(Y,U){var ha=Y[u.a.kd];return"DrawBorder"===ha?this.Ahd(U):"DrawBorderGrid"===ha?this.Bhd(U):"EraseBorder"===ha?this.v4e(U):this.i4e(Y,U)};a.prototype.lNf=function(){this.CQb||this.mPg()};a.prototype.fIh=function(){return new e(this)};a.prototype.mPg=function(){this.CQb=
{};var Y=0,U=a.IZa,ha={},ta;for(ta in U){ha.Kea=U[ta];var xa=ha.Kea.tte;D.a.instance.ga(ha.Kea.F0b);var oa=function(qa){return function(){return appChrome.buildBorderStyleIconNew(qa.Kea.dEj,qa.Kea.width,qa.Kea.tDi,qa.Kea.lineHeight,qa.Kea.Jqi)}}(ha);this.CQb[xa]=xa;this.Iab(xa,oa);Y++;ha={Kea:ha.Kea}}};a.prototype.Iab=function(Y,U){if(!(Y in this.EF)){var ha={};U=U();ha[Y]=U;appChrome.api.registerIconProvider(function(){return ha});this.EF[Y]=!0}return Y};a.prototype.Toj=function(Y,U){Y.MenuItemId&&
(Y[m.a.On]=Y.MenuItemId===this.IHa,Y[h.a.Icon]=U)};a.prototype.nTc=function(Y,U,ha,ta,xa){n.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.dWg(Y,xa)?(n.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),this.WU.s0()):(I.g(this.$).wz&&this.WU.s0(),w.a.current&&(ta=String.format(x.a.Dta,w.a.current.hp(ta)),I.g(this.$).ug.Jo(ta)),this.WU.H0b=U,this.WU.borderColor=
ha,I.g(this.$).wz=!0,this.WU.Qyg(Y),this.WU.dua=xa)};a.prototype.sKe=function(Y){if(Y)switch(this.WU.dua){case 2:this.Bhd(Y);break;default:this.Ahd(Y)}};a.prototype.dWg=function(Y,U){return this.WU.dua===U&&-236759591!==Y.command&&-2118943501!==Y.command?!0:!1};a.Omi=function(Y){return Y?Y in a.OGf||Y in a.IZa:!1};Ck.Object.defineProperties(a.prototype,{IHa:{configurable:!0,enumerable:!0,get:function(){return this.J3d}},y3:{configurable:!0,enumerable:!0,get:function(){return this.I3d}},yta:{configurable:!0,
enumerable:!0,get:function(){return this.tRb}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.sx||(this.sx=this.$.da.za(422));return this.sx}},jOg:{configurable:!0,enumerable:!0,get:function(){this.lNf();return this.CQb}}});Ck.Object.defineProperties(a,{IZa:{configurable:!0,enumerable:!0,get:function(){var Y={};return a.U1d||(a.U1d=(Y.BorderStyleSolidLine=l.kPg(),Y.BorderStyleDashedLine=l.gPg(),Y.BorderStyleDottedLine=l.hPg(),Y.BorderStyleMediumLine=l.jPg(),Y.BorderStyleThickLine=
l.lPg(),Y.BorderStyleDoubleLine=l.iPg(),Y))}},hOg:{configurable:!0,enumerable:!0,get:function(){var Y={};return a.T1d||(a.T1d=(Y.NoBorder=0,Y.BottomBorder=1,Y.TopBorder=2,Y.LeftBorder=4,Y.RightBorder=8,Y.OutsideBorders=64,Y.AllBorders=112,Y.ThickOutsideBorders=64,Y.InsideBorders=48,Y.InsideHorizontalBorders=16,Y.InsideVerticalBorders=32,Y.BottomDoubleBorder=1,Y.ThickBottomBorder=1,Y.TopBottomBorder=3,Y.TopThickBottomBorder=3,Y.TopDoubleBottomBorder=3,Y))}},OGf:{configurable:!0,enumerable:!0,get:function(){var Y=
{};return a.lde||(a.lde=(Y.ThickOutsideBorders=[2,2,2,2],Y.BottomDoubleBorder=[1,6,1,1],Y.ThickBottomBorder=[1,2,1,1],Y.TopBottomBorder=a.Obh,Y.TopThickBottomBorder=[1,2,1,1],Y.TopDoubleBottomBorder=[1,6,1,1],Y))}}});a.T1d=null;a.U1d=null;a.lde=null;a.j5c="black";a.borderStyleSolidLine="BorderStyleSolidLine";a.Obh=[1,1,1,1];Object(y.a)(a,"BorderFormatManager",null,[756])},1048:function(y,C,b){function a(A,B,N){window.performance.measure(A,B,N);B=window.performance.getEntriesByName(A);B.length||x.ULS.sendTraceTag(537167063,
0,10,"ContextMenuHelper.MeasureTime: measure name [{0}] returned no measures.",A);return B[B.length-1]?B[B.length-1].duration:-1}function c(){if(u.a.Oob){var A=a("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),B=a("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),N=a("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");x.ULS.sendTraceTag(537167064,0,50,"ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[{0}], PrepInfraWork=[{1}], EWAPopulation =[{2}]",
A,B,N)}}function e(A,B){z.HelperMethods.sYc&&window.performance.mark(B)}function f(A){A=D.g(A).ha.ta;return A.Hg&&(A.qd.isRow||A.qd.hf)}function l(A){return A.Nb.Ika(A.ha.ta.activeCell)}function n(A,B,N,P,Q){A=P.xk("ContextMenuHelper.FindFirstCellInViewportArea",A,B,N);try{for(A.$$rst();A.$$mn();){var M=A.$$cu();if(M&&m(M,P,Q))return M.cell}}finally{A&&A.dispose()}return null}function m(A,B,N){var P=B.rtl,Q=N.isChromeRtl;A=A.cell;return(N=D.g(N).SJ(A))?(N=N.topLeft,P=N.x+=P===Q?A.offsetWidth:0,Q=
N.y+=A.offsetHeight,B.view.visibleArea.contains(new v.a(P,Q,0,0))):!1}function h(A,B){var N=A.lc(null);if((null===N||void 0===N?0:N.cell.mk)&&m(N,A,B))return A.getCellBounds(N.cell);N=A.ha.ta.activeCell;return(B=n(new t.Range(N.top,N.left,w.a.Hh,N.left,!1,!1),2,!0,A,B)||n(new t.Range(1,N.left,N.top,N.left,!1,!1),2,!1,A,B)||n(new t.Range(N.top,N.right,N.top,w.a.Rh,!1,!1),1,!0,A,B)||n(new t.Range(N.top,1,N.top,N.right,!1,!1),1,!1,A,B)||null)&&B.mk?A.getCellBounds(B):Sys.UI.DomElement.getBounds(A.P4a.wc)}
b.d(C,"i",function(){return"ContextMenuPerf.A"});b.d(C,"b",function(){return"ContextMenuPerf.B"});b.d(C,"d",function(){return"ContextMenuPerf.C1"});b.d(C,"a",function(){return"ContextMenuPerf.C2"});b.d(C,"c",function(){return"ContextMenuPerf.D"});b.d(C,"e",function(){return h});b.d(C,"f",function(){return l});b.d(C,"g",function(){return f});b.d(C,"h",function(){return e});b.d(C,"j",function(){return c});var x=b(15),u=b(332),w=b(9),v=b(60),t=b(25),z=b(10),D=b(22)},1049:function(y,C,b){function a(){}
b.d(C,"a",function(){return a});y=b(0);a.edit="Edit";a.clipboard="Clipboard";a.copy="Copy";a.color="Color";a.lMg="AutoFill";a.Vgj="RowOperations";a.vZg="ColumnOperations";a.oUj="ViewModeRowOperations";a.nUj="ViewModeColumnOperations";a.hyperlink="Hyperlink";a.openHyperlink="OpenHyperlink";a.Xsj="ShapeStyle";a.cBh="FloatingObjectClipboard";a.OFf="PivotTableCopyDelete";a.QFf="PivotTableFieldListActions";a.Bwe="CellFloatie";a.Tsj="ShapeFloatie";a.contextMenu="ContextMenu";a.M_h="GridContextMenu";a.FWi=
"PivotTableContextMenu";a.dBh="FloatingObjectContextMenu";a.gVg="CellRTEFloatie";a.Y_f="ShapeRTEFloatie";Object(y.a)(a,"FloatieGroupIdentifiers",null,[])},1050:function(y,C,b){function a(w,v,t){var z=u.call(this,v)||this;z.rR=!1;z.Gjc=!1;z.sNa=null;z._selectedRowListBox=null;z.Un=null;z.Pxf=function(D){return z.onItemClick(D)};z.gAd=function(D){h.g(D.Ca);z.raiseEvent(a.m4a);z.raiseEvent(a.ENd);return!0};z.onScroll=function(D){h.g(D);z.FFd();z.raiseEvent(a.m4a)};z.onBlur=function(D){h.g(D);z.FFd()};
z.onPointerDown=function(){z.FFd();z.raiseEvent(a.m4a);z.raiseEvent(a.jPa);return!1};z.oEb=function(D){var A=D.Ca;if(A.button===Sys.UI.MouseButton.leftButton||A.button===Sys.UI.MouseButton.rightButton||n.EwaSettings.isChangeGateEnabled("OfficeVSO:6154487_EnableTouchInputInDVDropDown")&&A.type.includes("touch"))z.Wk=z.jac(A),z.onPointerDown(D);z.raiseEvent(a.jrd);return!1};z.xb=w;z.yBb=t;z.QAa(!0);return z}b.d(C,"a",function(){return a});y=b(0);var c=b(91),e=b(230),f=b(13),l=b(244);C=b(243);var n=
b(1),m=b(12),h=b(72),x=b(22),u=C.a;Wl(a,u);a.prototype.K9=function(w){this.get_events().addHandler(a.m4a,w)};a.prototype.mda=function(w){this.get_events().removeHandler(a.m4a,w)};a.prototype.gZb=function(w){this.get_events().addHandler(a.fkd,w)};a.prototype.Dsc=function(w){this.get_events().removeHandler(a.fkd,w)};a.prototype.qnb=function(w){this.get_events().addHandler(a.ENd,w)};a.prototype.cIb=function(w){this.get_events().removeHandler(a.ENd,w)};a.prototype.BYa=function(w){this.get_events().addHandler(a.jPa,
w)};a.prototype.ebb=function(w){this.get_events().removeHandler(a.jPa,w)};a.prototype.XUc=function(w){this.get_events().addHandler(a.jrd,w)};a.prototype.FId=function(w){this.get_events().removeHandler(a.jrd,w)};a.prototype.dispose=function(){this.O7(!1);this.QAa(!1);c.a.Dc([this.sNa]);this.sNa=null;u.prototype.dispose.call(this)};a.prototype.jac=function(w){return m.DOMElementExtensions.Jdd(w.target,"tr",!0)};a.prototype.tB=function(w){if(w){if(!this.Wk){var v=this.Un;if(!v||!v.rows.length)return;
this.Wk=v.rows[0];0<w?w--:w++}v=this.Wk;for(var t=0,z=Math.abs(w);t<z;t++)if(0>w){if(!v.previousSibling)break;v=v.previousSibling}else{if(!v.nextSibling)break;v=v.nextSibling}v&&(this.Wk=v)}};a.prototype.Wmb=function(w,v){m.DOMElementExtensions.toggleCssClass(w,this.yBb.ListTableClassInTouch,v)};a.prototype.O7=function(w){var v=this.Un;v&&(w&&!this.Gjc?(e.a.instance.pa(f.a.click,v,this.Pxf),e.a.instance.pa(f.a.lk,v,this.gAd),l.a.instance.pa(f.a.pointerDown,v,this.oEb),this.Gjc=!0):this.Gjc&&(e.a.instance.Aa(f.a.click,
v,this.Pxf),e.a.instance.Aa(f.a.lk,v,this.gAd),l.a.instance.Aa(f.a.pointerDown,v,this.oEb),this.Gjc=!1))};a.prototype.jBa=function(w){var v=null;w&&(v=m.DOMElementExtensions.Oj(w,this.yBb.ListCellClass))&&v.classList.toggle(this.yBb.ListCellSelectedClass);return v};a.prototype.QAa=function(w){this.dg&&(w&&!this.rR?(this.sNa=this.Ae.je(this.dg),this.sNa.ka("scroll",this.onScroll),this.sNa.ka("blur",this.onBlur),l.a.instance.pa(f.a.pointerDown,this.domElement,this.onPointerDown),this.rR=!0):this.rR&&
(c.a.Ha(this.sNa),this.sNa=null,l.a.instance.Aa(f.a.pointerDown,this.domElement,this.onPointerDown),this.rR=!1))};a.prototype.onItemClick=function(w){return this.gAd(w)};a.prototype.Kuc=function(w){if(w){var v=w.offsetTop,t=this.dg.scrollTop;v<t?this.CVf(!0):v+w.offsetHeight>t+this.dg.clientHeight&&this.CVf(!1)}};a.prototype.CVf=function(w){this.dg.scrollTop=w?this.Wk.offsetTop:this.Wk.offsetTop+this.Wk.offsetHeight-this.dg.clientHeight};a.prototype.FFd=function(){x.g(this.$).isEditing&&this.raiseEvent(a.fkd)};
Ck.Object.defineProperties(a.prototype,{Wk:{configurable:!0,enumerable:!0,get:function(){return this._selectedRowListBox},set:function(w){this.jBa(this._selectedRowListBox);w?(this._selectedRowListBox=w,this.jBa(this._selectedRowListBox),this.Kuc(w)):this._selectedRowListBox=null}},v_:{configurable:!0,enumerable:!0,get:function(){return this.yBb.ListCellClass}},Wba:{configurable:!0,enumerable:!0,get:function(){return this.yBb.ListTableClass}},UH:{configurable:!0,enumerable:!0,get:function(){return 8}},
sCb:{configurable:!0,enumerable:!0,get:function(){return 5}},Fjc:{configurable:!0,enumerable:!0,get:function(){return 24}},Ejc:{configurable:!0,enumerable:!0,get:function(){return 35}},dg:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},$:{configurable:!0,enumerable:!0,get:function(){return this.xb}}});a.m4a="GotFocus";a.fkd="IgnoreBlur";a.ENd="SetCell";a.jPa="PointerDown";a.jrd="ItemPointerDown";Object(y.a)(a,"ListBox",C.a,[798,3])},1116:function(y,C,b){function a(m,h){var x=
n.call(this,h.textBox.domElement)||this;x.nXc=null;x.UEi=function(){x.Hyd()};x.Kvf=function(u,w){x.Tf(u,w)};x.Ovf=function(u,w){x.fj(u,w)};x.xb=m;x.QI=h;h.DY&&(h.DY.add(x),h.ql(x.Ovf),h.Kn(x.Kvf));return x}b.d(C,"a",function(){return a});y=b(0);var c=b(91);C=b(88);var e=b(47),f=b(43),l=b(72),n=C.a;Wl(a,n);a.prototype.dispose=function(){var m=this.QI;if(null===m||void 0===m?0:m.DY)m.DY.remove(this),m.kl(this.Ovf),m.Um(this.Kvf);c.a.Ha(this.nXc);this.QI=null;n.prototype.dispose.call(this)};a.prototype.Xh=
function(m,h){switch(h){case -1470715894:case -1231471547:this.uU(!1);break;default:if(this.jFd(m,h))return l.g(m),!0;a.Hii(h)||this.uU(!1)}return!1};a.prototype.uU=function(){c.a.Ha(this.nXc);this.nXc=e.a.instance.create(this.UEi,10,f.a.Qqi)};a.prototype.fj=function(){this.uU(!1)};a.Hii=function(m){switch(m){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1};Ck.Object.defineProperties(a.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.xb}},Ya:{configurable:!0,
enumerable:!0,get:function(){return this.QI}}});Object(y.a)(a,"ListAutoCompleteBehavior",C.a,[797,3])},1259:function(y,C,b){function a(u){var w=x.call(this,document.createElement("div"))||this;w.lIa=!1;w.mIa=!1;w.kIa=!1;w.iIa=!1;w.jIa=!1;w.rR=!1;w.QI=null;w.visible=void 0;w.hnc=function(v,t){w.qt(v,t)};w.nLa=function(){w.Ya.textBox.aK=!0};w.zya=function(){w.Xy(!0)};w.otf=function(){w.Ya.textBox.focus()};w.Sh=function(){n.g(w.$).inRangePicker||(w.isListVisible=!1)};w.$=u;n.g(u)&&n.g(u).ha&&n.g(w.$).ha.oJ(w.Sh);
w.Hk=e.a.d5();w.W5a=f.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",!1);return w}b.d(C,"a",function(){return a});y=b(0);C=b(243);var c=b(5),e=b(36),f=b(1),l=b(10),n=b(22),m=b(33),h=b(4),x=C.a;Wl(a,x);a.prototype.get_visible=function(){return this.W5a?void 0!==this.visible?this.visible:this.visible=x.prototype.get_visible.call(this):x.prototype.get_visible.call(this)};a.prototype.set_visible=function(u){if(!this.W5a)return x.prototype.set_visible.call(this,
u);if(this.visible===u)return u;this.visible=u;return x.prototype.set_visible.call(this,u)};a.prototype.qt=function(){this.ABa(!1);this.Rt.qt()};a.prototype.dispose=function(){this.$&&n.g(this.$)&&n.g(this.$).ha&&n.g(this.$).ha.aO(this.Sh);this.$=null;x.prototype.dispose.call(this)};a.prototype.Xh=function(u,w,v){u=!1;if((this.E0a||(void 0===v?0:v))&&!this.Jwa()&&this.get_visible()&&this.isListVisible)switch(this.Hk&&this.gBc(w),w){case 1872288872:this.isListVisible=!1;u=!0;break;case -798660877:this.Rt.tB(1);
u=!0;break;case 137938150:this.Rt.tB(-1);u=!0;break;case 2091832999:this.Rt.tB(this.UH-1);u=!0;break;case 742457698:this.Rt.tB(-(this.UH-1));u=!0;break;case 125627505:u=this.Xy(!1);break;case 267796030:e.a.d5()&&(u=this.Xy(!1))}return u};a.prototype.ABa=function(u){if(this.isListVisible||u){var w=n.g(this.$);u=w.domElement;var v=this.QI.textBox.domElement,t=m.a(this.$).Di(v.offsetHeight),z=m.a(this.$).Di(v.offsetTop),D=m.a(this.$).Di(v.offsetWidth);v=m.a(this.$).Di(v.offsetLeft);w=w.Bj;var A=h.AFrameworkApplication.sa&&
h.AFrameworkApplication.sa.Qa.Vg,B=$get(this.$.Mb+c.a.H_a,this.$.domElement);A&&(B=document.getElementById("EditorContainer"));var N=new Sys.UI.Point(w?this.Rt.p$b:0,w?this.MCh:a.i0h);t=B.offsetTop+N.y+(e.a.VM(this.$)&&w?0:t+z);this.$.wba||(z=$get(c.a.cGa,this.$.domElement),t+=z&&!A?z.offsetHeight:0);z=this.domElement;z.style.top=l.HelperMethods.uc(t);v=B.offsetLeft+v+N.x;!e.a.VM(this.$)&&this.$.isChromeRtl?z.style.right=l.HelperMethods.uc(w?this.Rt.p$b:u.offsetLeft+u.offsetWidth-v-D):z.style.left=
l.HelperMethods.uc(v)}};a.prototype.ASa=function(u){this.Rt&&(u&&!this.rR?(this.Rt.K9(this.otf),this.Rt.gZb(this.nLa),this.Rt.qnb(this.zya),this.rR=!0):this.rR&&(this.Rt.mda(this.otf),this.Rt.Dsc(this.nLa),this.Rt.cIb(this.zya),this.rR=!1))};a.prototype.gBc=function(u){switch(u){case -798660877:case 137938150:case 2091832999:case 742457698:this.lIa=!0;break;case 125627505:this.kIa=!0;break;case 267796030:e.a.d5()&&(this.iIa=!0)}};Ck.Object.defineProperties(a.prototype,{UH:{configurable:!0,enumerable:!0,
get:function(){return this.Rt.UH}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.Rt.isListVisible},set:function(u){this.Rt.isListVisible=u}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.QI},set:function(u){(this.QI=u)&&this.QI.CZd.add(this)}},MCh:{configurable:!0,enumerable:!0,get:function(){return e.a.VM(this.$)?-5:-40}}});a.p$b=0;a.i0h=1;Object(y.a)(a,"AutoCompleteControl",C.a,[746])},1260:function(y,C,b){function a(e,f,l,n){f=void 0===f?0:f;l=void 0===
l?"":l;n=void 0===n?"":n;var m=c.call(this)||this;m.length=e;m.selectedIndex=f;m.UF=l;m.description=n;return m}b.d(C,"a",function(){return a});y=b(0);var c=Sys.EventArgs;Wl(a,c);Object(y.a)(a,"ListEventArgs",Sys.EventArgs,[])},1261:function(y,C,b){function a(z,D){z=t.call(this,z,D,new v.a(f.a.listItem,f.a.zBb,f.a.CBb,f.a.DBb))||this;z.Fcc=!1;z.Fq=null;z.plb=null;z.pUe=!1;z.visible=void 0;z.QAa(!0);z.pUe=x.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash");z.W5a=x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",
!1);return z}b.d(C,"a",function(){return a});y=b(0);var c=b(15),e=b(24);C=b(1050);var f=b(981),l=b(5),n=b(79),m=b(36),h=b(12),x=b(1),u=b(117),w=b(22),v=b(1115),t=C.a;Wl(a,t);a.prototype.Uxa=function(){var z=460,D=w.g(this.$),A=D.domElement,B=this.XSa.style,N=this.dg.offsetTop+this.Wk.offsetHeight*this.Wk.sectionRowIndex-this.dg.scrollTop;B.width="auto";B.whiteSpace="nowrap";B.position=e.a.ygc?"relative":"absolute";var P=A.offsetLeft+A.offsetWidth-(this.domElement.offsetLeft+this.dg.offsetLeft+this.dg.offsetWidth+
3);A=this.domElement.offsetLeft-3-(A.offsetLeft+this.p$b);z=Math.min(this.XSa.offsetWidth,z,Math.max(P,A));h.DOMElementExtensions.Hr(this.XSa,z);B.whiteSpace="";B.position="absolute";N+3>this.dg.offsetTop+this.dg.offsetHeight||N<this.dg.offsetTop||(z=this.dg.offsetLeft-3-this.XSa.offsetWidth,B=this.dg.offsetLeft+this.dg.offsetWidth+3,h.DOMElementExtensions.updatePosition(this.XSa,A>P!==D.rtl?z:B,N,!1))};a.prototype.tB=function(z){t.prototype.tB.call(this,z);this.Uxa()};a.prototype.qt=function(){this.Uxa()};
a.prototype.Zra=function(){var z=this.Un,D=this.dg,A=3===n.a.Sb||e.a.pp,B=A?this.sCb:this.UH;this.isListVisible=!0;D.style.height="auto";this.lGa.set_visible(!0);this.Wmb(z,A);this.Fq.length>B?(h.DOMElementExtensions.EI(D,Math.floor(D.offsetHeight*B/this.Fq.length)),D.style.overflowY="auto"):(D.style.height="auto",D.style.overflowY="hidden");h.DOMElementExtensions.Hr(D,z.offsetWidth+(this.Fq.length>B?u.a.vv:0))};Ck.Object.defineProperties(a.prototype,{p$b:{configurable:!0,enumerable:!0,get:function(){if(m.a.VM(this.$)){var z=
document.getElementById(this.$.Mb+l.a.oUe);return!this.pUe||z?h.DOMElementExtensions.getBoundingClientRect(z).x:0}z=x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(l.a.Bwd):document.getElementById(this.$.Mb+l.a.Bwd+"-"+l.a.lqf);c.ULS.shipAssertTag(537170323,0,!!z||this.$.XM,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return z?z.offsetWidth:0}},ye:{configurable:!0,enumerable:!0,get:function(){return this.plb},
set:function(z){this.plb=z}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.W5a?void 0!==this.visible?this.visible&&0<this.Fq.length:(this.visible=h.DOMElementExtensions.isVisible(this.dg))&&0<this.Fq.length:h.DOMElementExtensions.isVisible(this.dg)&&0<this.Fq.length},set:function(z){this.W5a&&this.visible===z||(h.DOMElementExtensions.setVisible(this.dg,z),h.DOMElementExtensions.setVisible(this.XSa,z),this.W5a&&(this.visible=z));var D=w.g(this.$).view;z?this.Fcc||(D.Rs(this.lGa.hnc),
this.Fcc=!0):(Array.clear(this.Fq),this.Fcc&&(D.Xq(this.lGa.hnc),this.Fcc=!1))}}});Object(y.a)(a,"AutoCompleteListBox",C.a,[])},1309:function(y,C,b){function a(bc,Vb,mc,sb){var Yb=qd.call(this,bc,"PopulateGridContextMenu",1247109494,-2064931494,a.V_h,!0,!1,a.PIb,Vb,mc,!0,sb)||this;Yb.DAa=!1;Yb.Vva=!1;Yb.pZ=!1;Yb.refresh=!1;Yb.expandCollapse=!1;Yb.gic=!1;Yb.uDe=!0;Yb.grid=Ia.g(bc);Yb.Skc=!0;Yb.Efc=za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1);if(Yb.Efc){var Hb=
Tb.GetServiceTaskFactory.Xa(Yb.$.da,309,310,3),sc=Tb.GetServiceTaskFactory.create(Yb.$.da,18,Yb.la,3);qa.TaskExtensions.Ba(qa.TaskExtensions.te([Hb,sc],Yb.la),function(){Yb.$.da.$a(268,function(zb){Yb.p4a=new c(bc,Hb.result,sc.result,zb)})},Yb.la,3)}return Yb}function c(bc,Vb,mc,sb){this.rWc=this.deb=this.feb=0;this.$=bc;this.gridView=Ia.g(this.$);this.namedSheetViewPublic=Vb;this.Sg=mc;this.instantaneousSupportInformationManager=sb;this.wMa=Bb.a.rmd()}function e(bc){this.ranges=null;this.ranges=
bc}function f(bc,Vb,mc,sb,Yb,Hb,sc,zb){this.$=Vb;this.Ta=mc;this.zl=sb;this.selectedRanges=Yb;this.grid=Hb;this.Fy=zb;this.oba=sc;this.dsa=x.a.all(Yb,function(vc){return vc.isRow});this.Yga=x.a.all(Yb,function(vc){return vc.hf});this.kDb=x.a.all(Yb,function(vc){return!vc.isRow&&!vc.hf});Vb=Hb.Nb.qgd(Yb);this.z4b=!!Vb;this.GQf=!!Vb&&Vb.hasActiveFilter;this.menuSection=mc.Pc();bc.Ec.push(this.menuSection);this.jka=this.dsa||this.Yga?this.menuSection:mc.Pc();this.Nta=this.dsa||this.Yga?this.menuSection:
mc.Pc()}b.r(C);y=b(0);var l=b(15),n=b(289),m=b(93),h=b(39),x=b(277),u=b(608),w=b(4),v=b(85),t=b(437),z=b(925),D=b(9),A=b(31),B=b(19),N=b(60),P=b(5),Q=b(996),M=b(1240),ba=b(1049),V=b(14),aa=b(36);f.prototype.Lbd=function(){this.LEh();this.pEh();var bc=this.Fy.K6a(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Ta.Cb(bc?149:148))};f.prototype.QEh=function(){var bc=0;this.z4b?this.oba.Nm(942362098)?bc=this.Fy.Nm(this.zl,942362098,this.selectedRanges,this.grid)?161:169:this.GQf&&(bc=
this.Fy.Nm(this.zl,-1113896058,this.selectedRanges,this.grid)?177:181):this.oba.Nm(-1113896058)&&(bc=this.dsa?this.Fy.Nm(this.zl,-1113896058,this.selectedRanges,this.grid)?49:116:this.Fy.Nm(this.zl,-1113896058,this.selectedRanges,this.grid)?177:181);0!==bc&&this.jka.buttons.push(this.Ta.Cb(bc))};f.prototype.MEh=function(){var bc=0;this.z4b?this.oba.Nm(622604322)&&(bc=this.grid.rtl?this.Fy.Nm(this.zl,622604322,this.selectedRanges,this.grid)?191:192:this.Fy.Nm(this.zl,622604322,this.selectedRanges,
this.grid)?162:170):this.oba.Nm(1415868706)&&(bc=aa.a.tzb()&&this.grid.rtl?this.Yga?this.Fy.Nm(this.zl,1415868706,this.selectedRanges,this.grid)?288:289:this.Fy.Nm(this.zl,1415868706,this.selectedRanges,this.grid)?290:291:this.Yga?this.Fy.Nm(this.zl,1415868706,this.selectedRanges,this.grid)?50:117:this.Fy.Nm(this.zl,1415868706,this.selectedRanges,this.grid)?178:182);0!==bc&&this.jka.buttons.push(this.Ta.Cb(bc))};f.prototype.KEh=function(){this.oba.Nm(1035996630)&&(this.Fy.Nm(this.zl,1035996630,this.selectedRanges,
this.grid)?(this.jka.buttons.push(this.Ta.Cb(this.grid.rtl?187:165)),this.jka.buttons.push(this.Ta.Cb(166))):(this.jka.buttons.push(this.Ta.Cb(this.grid.rtl?188:173)),this.jka.buttons.push(this.Ta.Cb(174))))};f.prototype.LEh=function(){var bc=b(1309).GridContextMenu,Vb=null;this.kDb&&(Vb=this.Ta.lw("ContextMenu.InsertCells",null,V.a.instance.ga(349),1896159024),Vb.menu.Ec.push(this.jka));bc.NEh(this.jka,this.Ta,this.$);this.QEh();this.MEh();this.KEh();Vb&&0<this.jka.buttons.length&&this.menuSection.buttons.push(Vb)};
f.prototype.rEh=function(){var bc=0;this.z4b?this.oba.Nm(1405456548)?bc=this.Fy.Nm(this.zl,1405456548,this.selectedRanges,this.grid)?163:171:this.GQf&&(bc=this.Fy.Nm(this.zl,1554436520,this.selectedRanges,this.grid)?179:183):this.oba.Nm(1554436520)&&(bc=this.dsa?this.Fy.Nm(this.zl,1554436520,this.selectedRanges,this.grid)?51:118:this.Fy.Nm(this.zl,1554436520,this.selectedRanges,this.grid)?179:183);0!==bc&&this.Nta.buttons.push(this.Ta.Cb(bc))};f.prototype.qEh=function(){var bc=0;this.z4b?this.oba.Nm(284490184)&&
(bc=this.Fy.Nm(this.zl,284490184,this.selectedRanges,this.grid)?164:172):this.oba.Nm(674605324)&&(bc=this.Yga?this.Fy.Nm(this.zl,674605324,this.selectedRanges,this.grid)?52:119:this.Fy.Nm(this.zl,674605324,this.selectedRanges,this.grid)?180:184);0!==bc&&this.Nta.buttons.push(this.Ta.Cb(bc))};f.prototype.oEh=function(){this.oba.Nm(1035996630)&&(this.Fy.Nm(this.zl,1035996630,this.selectedRanges,this.grid)?(this.Nta.buttons.push(this.Ta.Cb(this.grid.rtl?189:167)),this.Nta.buttons.push(this.Ta.Cb(168))):
(this.Nta.buttons.push(this.Ta.Cb(this.grid.rtl?190:175)),this.Nta.buttons.push(this.Ta.Cb(176))))};f.prototype.pEh=function(){var bc=null;this.kDb&&(bc=this.Ta.lw("ContextMenu.DeleteCells",null,V.a.instance.ga(412),-1554384558),bc.menu.Ec.push(this.Nta));this.rEh();this.qEh();this.oEh();bc&&0<this.Nta.buttons.length&&this.menuSection.buttons.push(bc)};Object(y.a)(f,"CellsContextMenuGenerator",null,[]);Object(y.a)(e,"MacroRecorderRangeHyperlinkRemovedPayload",null,[450]);var E=b(587),G=b(25),I=b(102),
R=b(79),Y=b(75),U=b(45),ha=b(175),ta=b(83),xa=b(699),oa=b(151),qa=b(37),Ea=b(614),ka=b(618),za=b(1),La=b(186),Ia=b(22),Ya=b(388),tb=b(33),Tb=b(51),va=b(248),la=b(21),$a=b(29),Ra=b(1251),eb=b(1114),mb=b(133),Pa=b(560),Da=b(386),Ta=b(168),Sa=b(159),Cb=b(356),cc=b(95),nc=b(30),Nb=b(293),nb=b(292),db=b(134),Bb=b(979),zc=b(980),Eb=b(112),Ja=b(41),Rb=b(58),yc;(function(bc){bc[bc.none=0]="none";bc[bc.once=1]="once";bc[bc.twice=2]="twice"})(yc||(yc={}));Object(y.b)("ToggleState",yc);c.prototype.cgh=function(){var bc=
this.oV(),Vb={};bc=(Vb.CommandValueId=Ja.c(bc),Vb);Vb=new cc.a(-2058042992,2,this.$.Xc,19,null);l.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.Wb(Vb,bc)};c.prototype.sgh=function(){var bc=new cc.a(644342024,2,this.$.Xc,19,null);l.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ka.Wb(bc)};c.prototype.hgh=function(){var bc=this.gridView.ha.ta.activeCell,
Vb=this.$.da.za(66).Eg,mc=this.$.da.za(66).Bub(bc);return Vb||mc?this.jgh(Vb,mc,bc):this.igh(bc)};c.prototype.jgh=function(bc,Vb,mc){if(this.SVg(bc,Vb,mc))return l.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),Rb.Task.Sa(!1);if(null!=bc&&bc.hasAutoFilter||null!=Vb&&Vb.WZa.every(function(sb){return 0!=sb.length}))return this.feb=yc.none,this.pWc();this.feb=yc.once;return this.U6b(yc.once)};c.prototype.igh=function(bc){var Vb=
U.v(this.gridView.ha.ta.qd,this.$);Vb=this.gridView.$.xa.getItemByName(Vb.SheetName);var mc=U.D(Vb.J0);if(this.RVg(mc,bc))return l.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),Rb.Task.Sa(!1);if(Vb.hasAutoFilter){if(mc&&mc.contains(this.gridView.ha.ta.activeCell))return this.feb=yc.none,this.pWc();this.feb=yc.twice;return this.U6b(yc.twice)}this.feb=yc.once;return this.U6b(yc.once)};c.prototype.U6b=function(bc){function Vb(zb){Nb.a(zb)?
l.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}",nc.a.Tc(zb.Errors)):(l.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),bc===yc.twice?sb.U6b(yc.once):sb.pWc())}function mc(){return new Ra.a(Yb)}var sb=this,Yb=U.v(this.gridView.ha.ta.qd,this.$);if(!Yb)return Rb.Task.Sa(!1);this.deb||(this.deb=Date.now());var Hb=new cc.a(368460465,2,this.$.Xc,19,null),sc=this.$.na.va.hc();return za.EwaSettings.qc()?
Da.a(this.$.userOperationManager,function(zb,vc,ad){return ta.kb(sb.$.na.va,Yb,nb.b(zb,Vb),vc,ad,null,sc)},function(zb){return new ha.a(516,0,zb,64,mc)},Hb):Da.a(this.$.userOperationManager,function(zb,vc,ad){return ta.kb(sb.$.na.va,Yb,nb.b(zb,Vb),vc,ad,null,sc)},function(zb){return new Pa.a(516,0,zb,void 0,mc)},Hb)};c.prototype.SVg=function(bc,Vb,mc){return null!=bc&&Ta.d(bc)&&mc.top===bc.usedRange.top||null!=Vb&&Vb.dba&&mc.top===Vb.top?(this.Sqc(this.$,224),!0):null!=bc&&Ta.g(bc)&&mc.top===bc.usedRange.bottom?
(this.Sqc(this.$,225),!0):!1};c.prototype.RVg=function(bc,Vb){if(bc&&bc.contains(Vb)&&Vb.top===bc.top||!bc&&this.SUg(Vb.top,Vb.left))return this.Sqc(this.$,226),!0;bc=new G.Range(Vb.top,Vb.left,Vb.top+1,Vb.left+1,!1,!1);return this.gridView.Nb.Uwa(bc)?(this.Sqc(this.$,227),!0):!1};c.prototype.Sqc=function(bc,Vb){Vb=nc.a.gd(1,1,753,Vb,0,147079615,"ContextMenuFilterByCellValueError");za.EwaSettings.Az()?new Cb.a(bc,Vb):(bc=new Sa.ErrorDialog(bc,Vb),bc.initialize(),bc.Af())};c.prototype.pWc=function(){function bc(zb){var vc=
{};vc=(vc.ToggleFilterOperationCount=Vb.feb,vc.ApplyFilterTime=Vb.rWc?Date.now()-Vb.rWc:-1,vc.ToggleAndApplyFilterTime=Vb.deb?Date.now()-Vb.deb:-1,vc.FilterByValueType=sb.AutoFilterType,vc);l.ULS.sendTraceTag(527500295,0,50,"GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : {0}",JSON.stringify(vc));Vb.deb&&(Vb.deb=0);Bb.a.dxc(zb)&&(vc=Bb.a.U$b(zb),Vb.wMa?Bb.a.iQa(zc.a.filterByCellValue,vc.MessageIdName,Eb.a.tsa,!0,Bb.a.isSessionEndingError(vc.MessageId)):l.ULS.sendTraceTag(527500294,0,10,
"GridContextMenuFilter::ApplyFilterByValue failed with FilterException -{0}",vc.MessageIdName));Nb.a(zb)?l.ULS.sendTraceTag(527500292,0,50,"GridContextMenuFilter::ApplyFilterByValue service call failed with errors : {}",nc.a.Tc(zb.Errors)):(l.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),db.b(Vb.$).Rd(mb.a.Hwf,Vb.lm(),void 0,!0),zb={},zb.FirstRow=Vb.lNh(),zb.FirstColumn=sb.Column,-1!==zb.FirstRow&&(zb=U.C(zb),Vb.mL(zb)))}var Vb=this;this.rWc=Date.now();
var mc=this.mZh();if(!mc)return l.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),Rb.Task.Sa(!1);var sb=this.oV(),Yb={FirstRow:0};Yb.FirstColumn=sb.Column;Yb.SheetName=sb.SheetName;db.b(this.$).Rd(mb.a.dtf,this.lm(),void 0,!0);var Hb=this.O2c(sb,Yb),sc=new ha.a(208,0,function(zb,vc,ad){return ta.a(Vb.$.na.va,Hb,mc,nb.b(zb,bc),vc,ad,null,null)},6,function(){return new eb.a(mc,Hb)});this.namedSheetViewPublic?this.namedSheetViewPublic.GAa().continueWith(function(zb){zb.result&&
Vb.$.userOperationManager.jc(sc,null)}):this.$.userOperationManager.jc(sc,null);return Rb.Task.Sa(!0)};c.prototype.mL=function(bc){aa.a.Fba(this.$)&&qa.TaskExtensions.Ba(Tb.GetServiceTaskFactory.Xa(this.$.da,430,431,1),function(Vb){Vb.result.pea(bc);l.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},this.$.la,3)};c.prototype.lm=function(){var bc={};return bc.Location="contextMenu",bc};c.prototype.oV=function(){var bc=
0,Vb=this.gridView.ha.ta.activeCell;var mc=this.$.da.za(66).Eg;var sb=this.$.da.za(66).Bub(Vb);if(mc){var Yb="Table";bc=mc.objectId}else sb?(Yb="Table",bc=sb.id):Yb="Sheet";mc=Vb.left;Vb={};Vb.AutoFilterType=Yb;Vb.Column=mc;Vb.Id=bc;Yb={};this.$.Pj(Yb);Yb.FirstRow=0;Yb.FirstColumn=Vb.Column;bc=this.$.ea.isNamedObjectViewMode;Vb.NamedObjectView=bc;Vb.SheetName=bc?Yb.NamedObjectName:Yb.SheetName;Vb.ItemListOptions=null;return Vb};c.prototype.SUg=function(bc,Vb){bc=G.Range.hd(bc,Vb);return this.gridView.Ea.i$(bc,
this.$.qa.name)&&(bc=this.gridView.Ea.M3a(bc))&&bc.autoFilterMenu?!0:!1};c.prototype.mZh=function(){var bc=null,Vb=this.gridView.lc(this.gridView.ha.ta.activeCell);if(!Vb)return null;var mc=Vb.cell.OSd;var sb=this.instantaneousSupportInformationManager.lTa(mc,!1).category;if(1===Vb.ix.type)if(3===sb){if(!Vb.cell.W8a)return l.ULS.sendTraceTag(527500290,0,15,"GridContextMenuFilter::GetValueForFilter() for category : {0}. NumFmt is null. ",sb),null;bc=(Vb.cell.W8a.Start+Vb.cell.W8a.End).trim()}else if(!sb&&
(la.a.j0a(Vb.ix.value,"E")||la.a.j0a(Vb.originalText,"E"))){bc=this.Sg.eUe(Vb.ix.value,mc,1,Number.POSITIVE_INFINITY,Vb.cell.O$);if(!bc.success)return l.ULS.sendTraceTag(527500289,0,50,"GridContextMenuFilter::GetValueForFilter() for category : {0}. Failed to acquire formatted value",sb),null;bc=bc.pz}bc||(bc=Vb.originalText);return $a.a.O_c(bc)?["[Blanks]"]:["i"+bc.trim()]};c.prototype.lNh=function(){var bc=this.gridView.ha.ta.activeCell,Vb=this.$.da.za(66).Eg,mc=this.$.da.za(66).Bub(bc);if(Vb)return Vb.usedRange.top;
if(null!=mc)return mc.top;Vb=this.$.xa.getItemByName(this.$.qa.sheetName);return(Vb=U.D(Vb.J0))&&Vb.contains(bc)?Vb.top:-1};c.prototype.O2c=function(bc,Vb){var mc={};mc.Location=Vb;mc.FieldId=bc.Id.toString();mc.DataSourceIndex=-1;mc.FilterType=bc.AutoFilterType;mc.AnchorType=0;mc.ChartId=null;mc.AnchorValue1=-1;mc.AnchorValue2=-1;mc.Property=bc.RichProperty;return mc};Object(y.a)(c,"GridContextMenuFilter",null,[]);b.d(C,"GridContextMenu",function(){return a});var qd=z.a;Wl(a,qd);a.prototype.dispose=
function(){qd.prototype.dispose.call(this);this.grid=null};a.prototype.$c=function(bc,Vb){bc=!this.Jpd(bc,Vb);if(!bc)switch(Vb){case -1977666927:bc=null==this.p4a||this.yuj();break;case 1549396389:bc=null==this.p4a||!this.eei();break;case 2045563128:case 1803952894:bc=null==this.p4a||!this.$.isEditMode&&!this.fei()}return bc};a.prototype.Jpd=function(bc,Vb){var mc=this.grid.ha.ta.selectedRanges;return(new oa.a(this.$.xa)).Nm(bc,Vb,mc,this.grid)};a.prototype.executeCommand=function(bc,Vb,mc){var sb=
Vb.command;bc=null;switch(sb){case -1396319072:if(Vb=this.grid.lc(null))n.a.instance.DZc(!0),m.EventHandlerManager.instance.Yad(),a.dTi(Vb);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.ta.selectedRanges,Vb);break;case 324156914:bc=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(mc);break;case -1977666927:bc=this.p4a.cgh();break;case 1549396389:bc=this.p4a.sgh();break;case 1803952894:bc=this.p4a.hgh();break;default:bc=La.a(sb)}return bc||qa.TaskExtensions.G4()};
a.prototype.Mc=function(bc,Vb,mc){bc=!1;switch(Vb.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:bc=!0;break;case 1441131127:bc=!!mc}return bc};a.prototype.$Y=function(bc){bc=void 0===bc?!1:bc;var Vb=!1,mc=!1,sb=0;za.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(sb=h.a.Ce());var Yb=this.Ta.Cq(this.menuId),Hb=this.grid.ha.ta,sc=Hb.Hg,zb=sc&&Hb.qd.hf,vc=sc&&Hb.qd.isRow;Hb=Hb.selectedRanges;var ad=
x.a.all(Hb,function(ja){return ja.hf}),ub=x.a.all(Hb,function(ja){return ja.isRow}),Za=U.O(Hb),wa=U.P(Hb);this.Nef(zb,vc)?(Vb=!0,this.qFh(Yb)):this.$.isEditMode?Ya.a(this.$)?this.rFh(Yb,zb,vc):(this.sEh(Yb,!(vc||zb||!this.gic)),this.OEh(Yb,Hb,bc),this.EEh(Yb,ad,ub,Za,wa),this.rVe(Yb,sc,zb,vc),this.JFh(Yb),this.XUe(Yb,zb,vc),this.hFh(Yb,sc,zb,vc,Hb),this.vEh(Yb),this.tEh(Yb,Hb),this.VEh(Yb),this.EFh(Yb,sc),za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.IEh(Yb)):
(mc=!0,Ya.a(this.$)?this.mVe(Yb):this.ZFh(Yb,sc,zb,vc,Hb));za.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(bc=h.a.Ce()-sb,l.ULS.sendTraceTag(537167046,0,50,"GridContextMenu::CreateMenuModel, ExecutionTimeTotal: {0}, isPivotMenu: {1}, isViewMenu: {2}, firstTimeEntry: {3}",bc,Vb,mc,this.uDe));this.uDe=!1;return Yb};a.prototype.WJa=function(bc){var Vb=[];if(Ya.a(this.$))return Vb;if(3===bc){bc=this.grid.ha.ta;var mc=bc.Hg,sb=mc&&bc.qd.hf,Yb=mc&&bc.qd.isRow,
Hb=!1,sc=!1,zb=!1;this.$.isMobileMode&&(sc=bc.selectedRanges,Hb=U.O(sc),sc=U.P(sc));if(mc){var vc=Ia.e(this.grid);vc&&vc.range.contains(bc.qd)&&this.QV(vc)&&(zb=!0)}this.$.isEditMode?this.Nef(sb,Yb)?Array.addRange(Vb,[ba.a.OFf,ba.a.QFf]):sb||Yb?(Vb.push(ba.a.clipboard),Yb?Vb.push(ba.a.Vgj):sb&&Vb.push(ba.a.vZg)):(Array.addRange(Vb,[ba.a.edit,ba.a.clipboard]),zb?Vb.push(ba.a.hyperlink):Vb.push(ba.a.color),mc&&Vb.push(ba.a.lMg)):(Vb.push(ba.a.copy),zb&&Vb.push(ba.a.openHyperlink),!Yb||this.$.isMobileMode&&
sc?!sb||this.$.isMobileMode&&Hb||Vb.push(ba.a.nUj):Vb.push(ba.a.oUj));Vb.push(ba.a.M_h)}else 2===bc&&Vb.push(ba.a.Bwe);return Vb};a.prototype.Nef=function(bc,Vb){return(this.DAa||this.Vva||this.pZ||this.refresh||this.expandCollapse)&&!(bc||Vb)};a.prototype.showGridContextMenu=function(bc){this.expandCollapse=this.refresh=this.pZ=this.Vva=this.DAa=!1;var Vb=this.$,mc=Ea.a(Vb).kKa(),sb=this.grid.ha.ta,Yb=sb.Hg,Hb=Yb&&sb.qd.hf;sb=Yb&&sb.qd.isRow;if(mc&&!Hb&&!sb){Hb=ka.a(Vb);if(null===Hb||void 0===Hb?
0:Hb.gQd)this.DAa=Hb=I.f(Vb.mg),this.Vva=!Hb;Hb=Vb.xc;this.pZ=mc.supportsBIExplore&&!!Q.a(Vb)&&Hb.O2(32768);Hb.allowInteractivity&&(Vb=this.grid.lc(null),(null===Vb||void 0===Vb?0:Vb.cell)&&(Vb.cell.sZc||Vb.cell.E1f)&&(this.expandCollapse=!0),Hb.allowManualDataRefresh&&(this.refresh=!0))}Vb=null;mc=1;Hb=Object(v.a)(u.a,bc.eventArgs);bc=Object(v.a)(M.a,bc.creationParams);sb=this.pKh();bc?(Vb=bc.clientPoint,mc=bc.inputMethod):Hb&&1!==Hb.zb?(Vb=new Sys.UI.Point(Hb.clientPoint.x,Hb.clientPoint.y),mc=
Hb.zb):sb&&(Vb=new Sys.UI.Point(sb.x+(this.$.isChromeRtl?0:sb.width),sb.y+sb.height));R.a.Sb=mc;this.gic=3===mc;bc=A.a.ltb;this.Fp(Vb,!Hb||Hb.Ca.target.className!==bc,mc)};a.prototype.removeHyperlinksFromRange=function(bc,Vb){var mc=this;if(!za.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Aq(bc,!0)){var sb=U.r(bc,this.$),Yb=this.$.na.va.hc();this.$.userOperationManager.jc(new ha.a(125,0,function(Hb,sc,zb){mc.$.By();return ta.c(mc.$.na.va,
sb,"","",!0,!1,127,Hb,sc,zb,null,Yb)},void 0,function(){return new e(sb)}),Vb);this.grid.ug.SG(!1)}};a.prototype.pKh=function(){var bc=this.grid.lc(null);if((null===bc||void 0===bc?0:bc.cell.mk)&&this.Qdf(bc))return this.grid.getCellBounds(bc.cell);bc=this.grid.ha.ta.activeCell;return(bc=this.E9b(new G.Range(bc.top,bc.left,D.a.Hh,bc.left,!1,!1),2,!0)||this.E9b(new G.Range(1,bc.left,bc.top,bc.left,!1,!1),2,!1)||this.E9b(new G.Range(bc.top,bc.right,bc.top,D.a.Rh,!1,!1),1,!0)||this.E9b(new G.Range(bc.top,
1,bc.top,bc.right,!1,!1),1,!1)||null)&&bc.mk?this.grid.getCellBounds(bc):Sys.UI.DomElement.getBounds(this.grid.P4a.wc)};a.prototype.Qdf=function(bc){var Vb=this.grid.rtl,mc=this.$.isChromeRtl;bc=bc.cell;var sb=Ia.g(this.$).SJ(bc);return sb?(sb=sb.topLeft,Vb=sb.x+=Vb===mc?bc.offsetWidth:0,mc=sb.y+=bc.offsetHeight,this.grid.view.visibleArea.contains(new N.a(Vb,mc,0,0))):!1};a.prototype.E9b=function(bc,Vb,mc){bc=this.grid.xk("GridContextMenu.FindFirstCellInViewportArea",bc,Vb,mc);try{for(bc.$$rst();bc.$$mn();){var sb=
bc.$$cu();if(sb&&this.Qdf(sb))return sb.cell}}finally{bc&&bc.dispose()}return null};a.prototype.qFh=function(bc){var Vb=this.Ta,mc=Vb.Pc();this.refresh&&mc.buttons.push(Vb.Cb(100));this.pZ&&mc.buttons.push(Vb.Cb(99));this.DAa?mc.buttons.push(Vb.Cb(59)):this.Vva&&mc.buttons.push(Vb.Cb(58));if(this.expandCollapse){var sb=Vb.lw("ContextMenu.PivotExpandCollapse",null,V.a.instance.ga(1142),589118293);var Yb=Vb.Pc();Yb.buttons.push(Vb.Cb(243));Yb.buttons.push(Vb.Cb(244));Yb.buttons.push(Vb.Cb(245));Yb.buttons.push(Vb.Cb(246));
sb.menu.Ec.push(Yb);sb&&0<Yb.buttons.length&&mc.buttons.push(sb)}bc.Ec.push(mc)};a.prototype.rVe=function(bc,Vb,mc,sb){if(Vb&&!mc&&!sb){Vb=this.Ta.Pc();this.Efc&&!this.$.XM&&this.Qbd(Vb);this.Ybd(Vb);this.NFh(Vb);if(za.EwaSettings.ma(482)&&Ia.g(this.$).ha.ta.dK()&&Ia.g(this.$).ha.ta.k_)switch(za.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Vb.buttons.push(this.Ta.Cb(237));break;case 2:Vb.buttons.push(this.Ta.Cb(238));break;
default:Vb.buttons.push(this.Ta.Cb(236))}bc.Ec.push(Vb)}};a.prototype.Ybd=function(bc){if(!za.EwaSettings.isChangeGateEnabled("OfficeVSO:6172529_FixAllowSort")||this.$.xc.allowSorting)if(!za.EwaSettings.isChangeGateEnabled("OfficeVSO:5230917_HideSortForProtectedSheetInMobiles")||!this.$.isMobileMode||(new oa.a(this.$.xa)).me(2048)){var Vb=this.Ta.Pc();Vb.buttons.push(this.Ta.Cb(223));Vb.buttons.push(this.Ta.Cb(224));za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PutSelectedItemOnTop",
!1)&&(Vb.buttons.push(this.Ta.Cb(292)),Vb.buttons.push(this.Ta.Cb(293)),Vb.buttons.push(this.Ta.Cb(294)));this.$.isMobileMode||Vb.buttons.push(this.Ta.Cb(225));var mc=this.Ta.lw("ContextMenu.sort",null,V.a.instance.ga(228),-864298118);mc.menu.Ec.push(Vb);bc.buttons.push(mc)}};a.prototype.Qbd=function(bc){var Vb=this.Ta.lw("ContextMenu.filter",null,V.a.instance.ga(1935),2045563128),mc=this.Ta.Pc(),sb=this.MOh(),Yb=this.Ta.Cb(234);Yb.label=sb;mc.buttons.push(Yb);mc.buttons.push(this.Ta.Cb(235));sb=
this.Ta.Pc();sb.buttons.push(this.Ta.Cb(233));Vb.menu.Ec.push(mc);Vb.menu.Ec.push(sb);bc.buttons.push(Vb)};a.prototype.NFh=function(bc){if(Ia.g(this.$).ha.ta.dK()){var Vb=this.Ta.Pc();Vb.buttons.push(this.Ta.Cb(232));za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&(Vb.buttons.push(this.Ta.Cb(285)),Vb.buttons.push(this.Ta.Cb(286)));var mc=this.Ta.lw("ContextMenu.table",null,V.a.instance.ga(1934),-697806646);mc.menu.Ec.push(Vb);bc.buttons.push(mc)}};
a.prototype.hVe=function(bc,Vb,mc,sb,Yb){if(Vb){var Hb=U.K(Yb),sc=Ia.e(this.grid);if(sc&&!mc&&!sb){mc=new oa.a(this.$.xa);if(sc.range.contains(Hb)&&this.QV(sc)){(Vb=!sc.kMa&&!mc.tj)&&this.$.isEditMode&&bc.buttons.push(this.Ta.Cb(45));sc.bba&&bc.buttons.push(this.Ta.Cb(53));Vb&&this.$.isEditMode&&bc.buttons.push(this.Ta.Cb(47));return}!sc.kMa&&this.$.isEditMode&&(sc=mc.me(128),bc.buttons.push(this.Ta.Cb(sc?46:121)))}}this.X2i(Yb)&&bc.buttons.push(this.Ta.Cb(48));(sc=this.$.xa.qa)&&sc.Yd&&(sc=sc.Yd.jy||
sc.Yd.iK,!Vb||this.$.XM||!za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||sc||(Vb=U.K(Yb),this.W2i(Vb)?bc.buttons.push(this.Ta.Cb(276)):Vb.hf||Vb.isRow||bc.buttons.push(this.Ta.Cb(275))))};a.prototype.X2i=function(bc){bc=Gl(bc);for(var Vb=bc.next();!Vb.done;Vb=bc.next()){Vb=this.grid.getRangeInformation(Vb.value);for(var mc=0;mc<Vb.length;mc++)if(Object(t.a)(E.HyperlinkRange,Vb[mc])){var sb=this.grid.lc(Vb[mc]);
if(sb&&this.QV(sb)&&!sb.kMa)return!0}}return!1};a.prototype.W2i=function(bc){if(Ia.g(this.$).ha.ta.dK()){var Vb=Ia.g(this.$).Nb.rj(bc);if(Vb&&Vb.usedRange.equals(bc))return!0}return!1};a.prototype.XUe=function(bc,Vb,mc){var sb,Yb;if(1===Ia.g(this.$).ha.We&&!Vb&&!mc){Vb=Ya.a(this.$);mc=this.Ta;var Hb=mc.Pc(),sc=this.$.da.za(65);(null===(sb=null===sc||void 0===sc?void 0:sc.Rm)||void 0===sb?0:sb.$E)&&!Vb&&Hb.buttons.push(mc.Cb(227));sc&&sc.isCommentOperationEnabled(3)&&Hb.buttons.push(mc.Cb(221));(null===
(Yb=null===sc||void 0===sc?void 0:sc.Rm)||void 0===Yb?0:Yb.Jid)&&!Vb&&Hb.buttons.push(mc.Cb(228));(null===sc||void 0===sc?0:sc.hasCommentAtActiveCell)?sc.mC.isResolved||Hb.buttons.push(mc.Cb(159)):sc&&sc.hasCommentAtActiveCell||(sc&&sc.Rm&&sc.Rm.$E?Vb||(Hb.buttons.push(mc.Cb(229)),Hb.buttons.push(mc.Cb(230))):(Hb.buttons.push(mc.Cb(160)),Vb||Hb.buttons.push(mc.Cb(226))));bc.Ec.push(Hb)}};a.prototype.JFh=function(bc){if(za.EwaSettings.ma(135)){var Vb=this.Ta,mc=Vb.Pc();mc.buttons.push(Vb.Cb(250));
bc.Ec.push(mc)}};a.prototype.OEh=function(bc,Vb,mc){if(!mc){mc=this.$.Ka.lH();var sb=new oa.a(this.$.xa),Yb=new xa.a(mc,Vb,this.grid);(new f(bc,this.$,this.Ta,mc,Vb,this.grid,Yb,sb)).Lbd()}};a.prototype.EEh=function(bc,Vb,mc,sb,Yb){var Hb=(new oa.a(this.$.xa)).me(8),sc=this.Ta,zb=sc.Pc();Vb&&zb.buttons.push(sc.Cb(Hb?152:153));mc&&zb.buttons.push(sc.Cb(Hb?150:151));Vb&&(sb||zb.buttons.push(sc.Cb(Hb?109:155)),zb.buttons.push(sc.Cb(Hb?111:157)));mc&&(Yb||zb.buttons.push(sc.Cb(Hb?108:154)),zb.buttons.push(sc.Cb(Hb?
110:156)));bc.Ec.push(zb)};a.prototype.sEh=function(bc,Vb){var mc=this.Ta,sb=mc.Pc();bc.Ec.push(sb);Vb&&sb.buttons.push(mc.Cb(102));sb.buttons.push(mc.Cb(42));sb.buttons.push(mc.Cb(43));Vb=this.nFh(mc);bc.Ec.push(Vb)};a.prototype.nFh=function(bc){var Vb=bc.Pc();Vb.title=V.a.instance.ga(1122);Vb.y3f=!1;Vb.x3f=!1;Vb.F8f=!1;var mc=5,sb=aa.a.ard(this.$);sb&&(mc=6);bc=bc.uC("PasteOptionsGallery",mc,"Size24by24",Vb.title);Vb.buttons.push(bc);bc.Kt("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",
1123,void 0,"Paste_24",1,B.a.Wrh);bc.Kt("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1124,void 0,"PasteValues_24",1,B.a.ash);bc.Kt("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1125,void 0,"PasteFormulas_24",1,B.a.Yrh);bc.Kt("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1126,void 0,"PasteTranspose_24",1,B.a.$rh);bc.Kt("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",
1127,void 0,"PasteFormatting_24",1,B.a.Xrh);sb&&bc.Kt("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1128,void 0,"PasteLink_24",1,B.a.Zrh);return Vb};a.prototype.ZFh=function(bc,Vb,mc,sb,Yb){var Hb,sc=this.Ta,zb=sc.Pc();zb.buttons.push(sc.Cb(43));bc.Ec.push(zb);this.Efc&&!this.$.XM&&(zb=this.Ta.Pc(),this.Qbd(zb),bc.Ec.push(zb));za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.xc.isMobileMode&&this.$.ea.xc.isReadOnlyEditMode&&
!this.$.ya.IsMeetingLiveSession||(zb=this.Ta.Pc(),this.Ybd(zb),bc.Ec.push(zb),l.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));zb=this.$.da.za(65);if(null===(Hb=null===zb||void 0===zb?void 0:zb.Rm)||void 0===Hb?0:Hb.$E)Hb=this.Ta.Pc(),Hb.buttons.push(sc.Cb(229)),bc.Ec.push(Hb);Hb=this.Ta.Pc();this.hVe(Hb,Vb,mc,sb,Yb);bc.Ec.push(Hb);w.AFrameworkApplication.isMobileMode&&
!Y.a(this.$.ya,30)&&(Vb=sc.Pc(),Vb.buttons.push(sc.Cb(272)),bc.Ec.push(Vb))};a.prototype.hFh=function(bc,Vb,mc,sb,Yb){var Hb=this.Ta.Pc();this.iFh(Hb);this.hVe(Hb,Vb,mc,sb,Yb);0<Hb.buttons.length&&bc.Ec.push(Hb)};a.prototype.iFh=function(bc){bc.buttons.push(this.Ta.Cb(135))};a.prototype.IEh=function(bc){var Vb=this.Ta.Pc();Vb.buttons.push(this.Ta.Cb(185));bc.Ec.push(Vb)};a.prototype.EFh=function(bc,Vb){za.EwaSettings.ma(483)&&Vb&&(Vb=this.Ta.Pc(),Vb.buttons.push(this.Ta.Cb(262)),bc.Ec.push(Vb))};
a.prototype.VEh=function(bc){var Vb=this.grid.ha.ta.selectedRanges;if(Vb&&Vb.length){for(var mc=!1,sb=0;sb<Vb.length;sb++)if(this.grid.Nb.axa(Vb[sb])){mc=!0;break}if(mc){mc=!1;if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:6411410_RemoveConvertToTextForRichValueRange"))for(sb=0;sb<Vb.length;sb++){var Yb=this.grid.Nb.QSh(Vb[sb]);if(null!=Yb&&null!=Yb[0]){for(var Hb=0;Hb<Yb.length;Hb++)if(this.grid.Nb.axa(Yb[Hb])){mc=!0;break}if(mc)break}}Hb=this.Ta;sb=Hb.Pc();Yb=Hb.Pc();for(var sc=1===Vb.length&&
(Vb[0].isSingle||this.grid.Nb.Zzb(Vb[0])),zb=!1,vc=!1,ad=!1,ub=!1,Za=0;Za<Vb.length&&!(zb&&ad&&vc&&ub);Za++)!zb&&this.grid.Nb.Lii(Vb[Za])&&(zb=!0),!ad&&this.grid.Nb.Idf(Vb[Za],!1)&&(ad=!0),!vc&&this.grid.Nb.zpd(Vb[Za])&&(vc=!0),!ub&&this.grid.Nb.hei(Vb[Za])&&(ub=!0);za.EwaSettings.ma(105)&&sc&&!this.grid.Nb.ffc(Vb[0])&&(ub?sb.buttons.push(Hb.Cb(217)):sb.buttons.push(Hb.Cb(216)));ub=zb;ub=!(new oa.a(this.$.xa)).tj&&ub;ad&&!mc&&(za.EwaSettings.ma(131)&&I.l(this.$.mg)&&(za.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",
!1)&&(za.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?Yb.buttons.push(Hb.Cb(220)):Yb.buttons.push(Hb.Cb(ub?220:271))),vc&&Yb.buttons.push(Hb.Cb(ub?218:269)),sc&&(this.grid.Nb.zpd(Vb[0])||this.grid.Nb.ffc(Vb[0]))&&Yb.buttons.push(Hb.Cb(ub?219:270))),Yb.buttons.push(Hb.Cb(ub?215:268)));0<Yb.buttons.length&&(Vb=Hb.lw(zb?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,V.a.instance.ga(1755),798637440),
Vb.menu.Ec.push(Yb),sb.buttons.push(Vb));0<sb.buttons.length&&bc.Ec.push(sb)}}};a.prototype.tEh=function(bc,Vb){this.grid.Nb.bcf(Vb)&&(Vb=this.Ta.Pc(),this.grid.ha.ta.Iba()?(Vb.buttons.push(this.Ta.Cb(241)),Vb.buttons.push(this.Ta.Cb(239))):Vb.buttons.push(this.Ta.Cb(240)),bc.Ec.push(Vb))};a.prototype.QV=function(bc){return bc.cell.hasHyperlink};a.prototype.mVe=function(bc){this.sFh(bc);var Vb=this.Ta.Pc();this.Ybd(Vb);bc.Ec.push(Vb);this.Efc&&(Vb=this.Ta.Pc(),this.Qbd(Vb),bc.Ec.push(Vb))};a.prototype.rFh=
function(bc,Vb,mc){this.mVe(bc);this.XUe(bc,Vb,mc)};a.prototype.sFh=function(bc){if(this.grid.ha.ta.Hg&&!this.grid.rb.$i){var Vb=this.Ta,mc=Vb.Pc();tb.a(this.$).LQd()?mc.buttons.push(Vb.Cb(265)):mc.buttons.push(Vb.Cb(264));bc.Ec.push(mc)}};a.dTi=function(bc){var Vb=bc.cKa(a.Zjd);Vb&&Vb.Nld&a.Zjd&&bc.invoke(a.Zjd,null)};a.NEh=function(bc,Vb,mc){if(za.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(mc=mc.da.za(254),!mc){l.ULS.sendTraceTag(537167044,
0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");return}}else if(mc=mc.da.za(254,!0),!mc)return;mc.qod()&&mc.Jif()&&bc.buttons.push(Vb.Cb(212));mc.qod()&&mc.cjc()&&bc.buttons.push(Vb.Cb(213))};a.prototype.yuj=function(){var bc=this.$.da.za(66).Eg,Vb=this.grid.ha.ta.activeCell;return null!=bc&&!bc.hasActiveFilter||va.c(this.$,Vb)||!this.gei(Vb)};a.prototype.gei=function(bc){var Vb=bc.left,mc=this.Zbc();if(null!=mc&&null!=mc.u9b&&Array.contains(mc.u9b,
Vb-1))return!0;mc=this.Rbc();return null!=mc&&U.D(mc).contains(bc)&&null!=mc.FilteredColumns&&Array.contains(mc.FilteredColumns,Vb-1)?!0:!1};a.prototype.eei=function(){var bc=this.$.da.za(66).Eg,Vb=this.Zbc();if(null!=bc)return bc.hasAutoFilter&&bc.hasActiveFilter;if(null!=Vb)return null!=Vb.u9b&&0<Vb.u9b.length;bc=this.Rbc();return null!=bc&&null!=bc.FilteredColumns&&0<bc.FilteredColumns.length};a.prototype.fei=function(){var bc=this.$.da.za(66).Eg,Vb=this.Zbc();if(null!=bc&&bc.hasAutoFilter||null!=
Vb&&Vb.WZa.every(function(mc){return 0!=mc.length}))return!0;bc=U.D(this.Rbc());return null!=bc&&bc.contains(this.grid.ha.ta.activeCell)?!0:!1};a.prototype.Zbc=function(){var bc=this.$.da.za(66);bc.nn(this.grid.ha.ta.activeCell);return bc.Bub(this.grid.ha.ta.activeCell)};a.prototype.Rbc=function(){return this.$.xa.getItemByName(this.$.qa.sheetName).J0};a.prototype.MOh=function(){var bc=this.grid.ha.ta.activeCell,Vb=0,mc=!1,sb=this.$.da.za(66),Yb=this.Zbc();sb=sb.Eg;null!=sb?(Vb=sb.usedRange.top,mc=
!0):null!=Yb?(Vb=Yb.top,mc=!0):(Yb=this.Rbc(),null!=Yb&&U.D(Yb).contains(bc)&&(Vb=Yb.FirstRow+1,mc=!0));return mc?(bc=bc.left,Vb=G.Range.hd(Vb,bc),Vb=this.grid.lc(Vb),mc="",null!=Vb&&(mc=Vb.text),this.wPg(mc,bc)):V.a.instance.ga(221)};a.prototype.wPg=function(bc,Vb){null==bc||la.a.Fh(bc.trim())?bc=String.format(V.a.instance.Bb(157),G.Range.YP(Vb)):bc.length>a.k0d?(bc=bc.substring(0,a.k0d),bc=String.format(V.a.instance.Bb(155),bc)):bc=String.format(V.a.instance.Bb(156),bc);return bc};Ck.Object.defineProperties(a.prototype,
{Qw:{configurable:!0,enumerable:!0,get:function(){return"PopulateGridContextMenu"}},AB:{configurable:!0,enumerable:!0,get:function(){return P.a.OKf}}});a.PIb="GridContextMenuRootName";a.V_h=P.a.cBe;a.Zjd=192;a.k0d=26;Object(y.a)(a,"GridContextMenu",z.a,[])},1310:function(y,C,b){function a(ka,za){var La=Ea.call(this,ka)||this;La.NCa=null;La.g_c=[];La.a4d=null;La.Zva=!1;La.Mdc=!1;La.qq=null;La.J$d=null;La.aJe=function(){La.QY.fJa(La.items,La.NCa);La.raiseEvent("ACLBUpdated",new v.a(La.items.length));
La.show()};La.tableManager=za;La.domElement.className=u.a.ZLe;La.domElement.innerHTML=qa;V.DOMElementExtensions.setVisible(La.domElement,!1);oa.d(La.style,La.$.isChromeRtl);La.ycf=N.EwaSettings.Gl();La.wwe=$get(l.z6f,La.domElement);La.QY=new c(La.$,La.wwe,La);La.ASa(!0);La.$.domElement.appendChild(La.domElement);La.kob(ka,U.a(ka));La.kob(ka,Q.g(ka).pc);La.ycf||La.$.da.Ga(1,La);La.mei=N.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1);return La}function c(ka,
za,La){ka=I.call(this,ka,za)||this;ka.cellAutoCompleteControl=null;ka.rra=null;ka.nyb=N.EwaSettings.Gl();ka.nyb&&(ka.cellAutoCompleteControl=La);ka.Fq=[];return ka}function e(ka,za,La){var Ia=M.call(this,ka,za)||this;Ia.QQb=null;Ia.Yic=0;Ia.F7a=null;Ia.V0=null;Ia.k6=function(Ya,tb){if(Ya=Ia.cellAutoCompleteControl.items)if(1===Ya.length&&Ia.cellAutoCompleteControl.E0a.length<Ya[0].ssa.length&&Ia.cellAutoCompleteControl.Zva&&P.a.fL(Ya[0].ssa,Ia.cellAutoCompleteControl.E0a)&&(tb.newValue=Ya[0].ssa),
Ia.Ya&&N.EwaSettings.ma(136)){var Tb=-1;1<Ya.length?Tb=Ia.cellAutoCompleteControl.Wbc(Ia.Ya.text,!0):1===Ya.length&&(Ia.cellAutoCompleteControl.Zva||Ia.cellAutoCompleteControl.Mdc)&&(Tb=0);if(0<=Tb&&Ya.length>Tb&&Ya[Tb].mXc){var va=B.C(Ya[Tb].mXc);va&&Q.g(Ia.$).Nb.axa(va)&&(tb.Waf=!0,tb.xwe=Ya[Tb].mXc)}}};Ia.VEb=function(){Ia.cellAutoCompleteControl.Zva=!1};Ia.Ya.tYa(Ia.k6);Ia.nyb=N.EwaSettings.Gl();Ia.nyb&&(Ia.QQb=La);Ia.V0=Ia.Ae.je(Ia.Ya.textBox.domElement);Ia.V0.ka("mousedown",Ia.VEb);return Ia}
function f(ka,za){this.rkg=ka;this.qkg=za}function l(){}b.r(C);y=b(0);var n=b(15),m=b(91),h=b(1259),x=b(9),u=b(981);l.z6f="suggested_cells_list_box";Object(y.a)(l,"CssElementIds",null,[]);var w=b(5),v=b(1260);Ck.Object.defineProperties(f.prototype,{ssa:{configurable:!0,enumerable:!0,get:function(){return this.rkg}},mXc:{configurable:!0,enumerable:!0,get:function(){return this.qkg}}});Object(y.a)(f,"CellAutoCompleteItem",null,[786]);var t=b(4),z=b(85),D=b(1116),A=b(405),B=b(45),N=b(1),P=b(21),Q=b(22),
M=D.a;Wl(e,M);e.prototype.dispose=function(){this.Ya.NHb(this.k6);M.prototype.dispose.call(this)};e.prototype.uU=function(ka){ka&&!this.cellAutoCompleteControl.isListVisible||M.prototype.uU.call(this,ka)};e.prototype.Xh=function(ka,za){this.cellAutoCompleteControl.Ya=this.Ya;this.Yic=ka.keyCode;if(this.Ya.isEditing){var La=this.Ya.text;P.a.equals(this.F7a,La,!1)||(this.F7a=La)}else this.F7a=null;if(237279923===za)return this.cellAutoCompleteControl.isListVisible=!1;N.EwaSettings.ma(136)&&17===this.Yic&&
this.cellAutoCompleteControl.Zva&&(this.cellAutoCompleteControl.Mdc=!0);return M.prototype.Xh.call(this,ka,za)};e.prototype.Hyd=function(){var ka;if(!N.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!t.AFrameworkApplication.Ng)if(this.cellAutoCompleteControl.Ya=this.Ya,this.cellAutoCompleteControl.Zva=!1,this.Ya.isEditing){var za=!P.a.equals(this.F7a,this.Ya.text,!0),La=this.Ya.rnd;La||!za&&229!==this.Yic?La&&(this.cellAutoCompleteControl.isListVisible&&
(this.cellAutoCompleteControl.isListVisible=!1),null===(ka=this.cellAutoCompleteControl.tNa)||void 0===ka?void 0:ka.cancel()):this.cellAutoCompleteControl.bLg(this.Yic)}else this.F7a=null};e.prototype.fj=function(){};e.prototype.Tf=function(){this.UV=!1;this.cellAutoCompleteControl.set_visible(!1);this.F7a=null;this.cellAutoCompleteControl.Zva=!1;this.cellAutoCompleteControl.Mdc=!1;this.cellAutoCompleteControl.tNa&&this.cellAutoCompleteControl.tNa.cancel()};e.prototype.jFd=function(ka,za){return this.cellAutoCompleteControl.Xh(ka,
za)};Ck.Object.defineProperties(e.prototype,{Cyb:{configurable:!0,enumerable:!0,get:function(){return!1}},UV:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl.isListVisible},set:function(ka){this.cellAutoCompleteControl.isListVisible=ka}},l5a:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return A.a.h_c}},cellAutoCompleteControl:{configurable:!0,enumerable:!0,get:function(){if(this.nyb)return this.QQb;var ka=
b(1310).CellAutoCompleteControl;return this.QQb||(this.QQb=Object(z.a)(ka,this.$.da.za(1)))}}});Object(y.a)(e,"CellAutoCompleteListAutoCompleteBehavior",D.a,[]);var ba=b(29);D=b(1261);var V=b(12),aa=b(10),E=b(117),G=b(67),I=D.a;Wl(c,I);c.prototype.dispose=function(){I.prototype.dispose.call(this);this.rra=null};c.prototype.ezc=function(ka){this.O7(!1);var za=""+String.format("<table class='{0}' aria-live='polite'><tbody>",this.Wba);for(var La=0,Ia=this.Fq.length;La<Ia;La++){var Ya=ba.a.vg(ka[this.Fq[La]].ssa);
Ya=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",this.v_,c.i_c,w.a.Toe,Ya,ba.a.E7b(Ya));za+=Ya}this.dg.innerHTML=za+"</tbody></table>";this.Un=V.DOMElementExtensions.Oj(this.domElement,this.Wba);this.O7(!0);this.Zra()};c.prototype.fJa=function(ka,za){if(ka&&ka.length){var La=[];if(za)for(var Ia=0,Ya=ka.length;Ia<Ya;Ia++)P.a.fL(ka[Ia].ssa,za)&&La.push(Ia);this.Fq=La;this.ezc(ka)}else this.isListVisible=!1,this.rra=null};c.prototype.Uxa=function(){};c.prototype.FSg=
function(ka,za,La){var Ia=Math.min(ka,Math.max(200,La));za&&ka<La&&(Ia+=E.a.vv);V.DOMElementExtensions.Hr(this.dg,Ia);za&&(Ia-=E.a.vv);return Ia};c.prototype.Zra=function(){I.prototype.Zra.call(this);var ka=V.DOMElementExtensions.Oj(this.get_element(),this.Wba),za=this.Fq.length>this.UH,La=Q.g(this.$);if(La=La.lc(La.ha.ta.activeCell))for(ka=this.FSg(ka.offsetWidth,za,La.width),za=this.dg.getElementsByClassName(c.i_c),La=0;La<za.length;La++)za[La].style.maxWidth=aa.HelperMethods.uc(ka);else n.ULS.sendTraceTag(537167964,
0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")};c.prototype.onItemClick=function(ka){if(ka=I.prototype.onItemClick.call(this,ka)){var za=Q.g(this.$);za.Gp(!1);za.focus()}return ka};Ck.Object.defineProperties(c.prototype,{Wk:{configurable:!0,enumerable:!0,get:function(){return this.rra},set:function(ka){this.jBa(this.Wk);this.rra=ka;var za=this.jBa(this.Wk);this.ye=ka?za.innerText:null;this.Kuc(ka)}},isListVisible:{configurable:!0,enumerable:!0,
get:function(){return Object(G.a)(c.prototype,this,"isListVisible")},set:function(ka){Object(G.b)(c.prototype,this,"isListVisible",ka);ka||(this.Wk=null)}},XSa:{configurable:!0,enumerable:!0,get:function(){return null}},lGa:{configurable:!0,enumerable:!0,get:function(){return this.nyb?this.cellAutoCompleteControl:this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.za(1))}}});c.i_c=u.a.prh;Object(y.a)(c,"CellAutoCompleteListBox",D.a,[]);var R=b(25),Y=b(63),U=b(114),ha=b(177),ta=b(43),
xa=b(35),oa=b(260);D=b(19);b.d(C,"CellAutoCompleteControl",function(){return a});var qa="<div id='"+l.z6f+"' class='"+u.a.M8c+" "+D.a.Zo+"' ></div>",Ea=h.a;Wl(a,Ea);a.prototype.kZb=function(ka){this.addHandler("ACLBUpdated",ka)};a.prototype.Gsc=function(ka){this.removeHandler("ACLBUpdated",ka)};a.prototype.J2=function(ka){this.addHandler("ACLBSelectionChanged",ka)};a.prototype.nda=function(ka){this.removeHandler("ACLBSelectionChanged",ka)};a.prototype.NEg=function(ka){this.addHandler("ACLBMatchedItem",
ka)};a.prototype.T$i=function(ka){this.removeHandler("ACLBMatchedItem",ka)};a.prototype.O5f=function(ka){for(var za=0;za<ka.length;za++){var La=ka.charCodeAt(za);if(N.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?P.a.isLetter(La):P.a.yod(La))return!0}return!1};a.prototype.Jwa=function(){return!this.items};a.prototype.dispose=function(){if(this.$){this.ASa(!1);var ka=Q.g(this.$);ka&&ka.view.Xq(this.hnc)}m.a.Dc([this.QY,this.tNa]);m.a.Dc(this.g_c);
this.g_c=this.wwe=this.QY=this.Ya=null;Ea.prototype.dispose.call(this)};a.prototype.Xh=function(ka,za){var La=!1;if(this.Wuj())switch(za){case -798660877:if(1===this.items.length&&this.ye)break;this.Rt.tB(1);this.raiseEvent("ACLBSelectionChanged",new v.a(this.items.length,this.Wbc(this.ye),this.ye));La=this.Xy(!1);break;case 137938150:if(1===this.items.length&&this.ye)break;this.Rt.tB(-1);this.raiseEvent("ACLBSelectionChanged",new v.a(this.items.length,this.Wbc(this.ye),this.ye));La=this.Xy(!1);break;
case 2091832999:this.Rt.tB(this.UH-1);La=this.Xy(!1);break;case 742457698:this.Rt.tB(-(this.UH-1));La=this.Xy(!1);break;case 125627505:this.Ya.textBox.caretPosition=this.Ya.text.length;this.isListVisible=!1;La=!0;break;case 267796030:this.Xy(!0);break;default:La=Ea.prototype.Xh.call(this,ka,za)}return La};a.prototype.show=function(){this.items&&this.items.length&&(this.QY.Wk=this.ye?this.Rt.Un.rows[this.Wbc(this.ye)]:null,this.isListVisible=0<this.QY.Fq.length,this.ABa(!0),this.QY.Uxa())};a.prototype.bLg=
function(ka){var za=!!this.Ya&&!Y.f(this.$.qa);this.Mdc=this.Zva=!1;this.Ya&&!this.Ya.isEditing?this.set_visible(!1):za&&!this.Oah(this.activeCell)&&this.zyj(ka)};a.prototype.Oah=function(ka){return!!this.dataValidationControl&&this.dataValidationControl.A6c(ka)};a.prototype.Xy=function(ka){if(!this.Ya||!this.isListVisible)return!1;var za=this.NCa;if(this.ye){var La=V.DOMElementExtensions.yZ(V.DOMElementExtensions.Oj(this.QY.Wk,c.i_c),w.a.Toe,""),Ia=La.substring(za.length,La.length);ka?this.Ya.text=
La:this.Ya.insertTextAt(Ia,za.length,this.Ya.text.length)}La=Q.g(this.$);La.Bj&&(La=La.pc,La.text=this.Ya.text,La.setCaretPosition(this.Ya.textBox.caretPosition));ka?this.isListVisible=!1:this.Ya.textBox.selectRange(za.length,this.Ya.text.length);return!0};a.prototype.Wbc=function(ka,za){za=void 0===za?!1:za;if(!this.QY.Un)return-1;for(var La=this.QY.Un.children[0],Ia=La.children.length,Ya,tb=0;tb<Ia;++tb)if(Ya=La.children[tb],P.a.equals(Ya.innerText.trim(),ka,za))return tb;return-1};a.prototype.Vzg=
function(ka,za,La,Ia,Ya,tb,Tb){var va=La.originalText.replace(a.frf,String.fromCharCode(32)),la=new R.Range(ka.top-1,ka.left,ka.bottom-1,ka.right,!1,!1),$a=Tb?Tb.nn(La.range):null;(!La.hF||La.range.left===ka.left)&&1<va.length&&!Ia.yb(va.toUpperCase())&&P.a.fL(va,za)&&!P.a.equals(va,za,!0)&&!a.ZSe(za)&&this.O5f(va)&&(!Ya&&!$a||!Ya&&$a.equals(Tb.nn(la))||Ya&&La.range.Ed(tb)&&La.range.top!==tb.top)&&(ka=La.formulaBarText,P.a.equals(ka,La.text,!1)||!ka)&&(ka={},ka.FirstRow=La.range.top-1,ka.FirstColumn=
La.range.left-1,La=new f(va,ka),Ia.add(va.toUpperCase(),La))};a.prototype.zyj=function(ka){this.qq=this.jXh();this.tNa&&this.tNa.cancel();0<this.Ya.text.length&&0!==ka?this.items&&((1<this.items.length||this.isListVisible)&&this.qhh(),8!==ka&&127!==ka&&46!==ka&&(1===this.items.length?this.ykd(!1):this.QY.Wk&&this.Xy(!1))):this.isListVisible=!1};a.prototype.qhh=function(){this.isListVisible?this.aJe():this.J$d=ha.AsyncMethodContext.Zs(this.aJe,500,ta.a.QUg,this.tNa)};a.prototype.ykd=function(ka){n.ULS.shipAssertTag(537167966,
0,!this.Jwa()&&1===this.items.length,"Invalid Items");var za=this.items[0].ssa,La=this.Ya.text,Ia=za.substring(La.length,za.length);if(ka&&!Ia.length)this.Ya.text=za;else if(!ka&&0<Ia.length)this.Ya.appendText(Ia),this.Ya.textBox.selectRange(La.length,this.Ya.text.length);else return;this.raiseEvent("ACLBMatchedItem",new v.a(this.items.length,0,za));this.Zva=!0};a.prototype.jXh=function(){this.qq=null;var ka=new xa.a(!1),za=this.activeCell;this.NCa=this.Ya.text.replace(a.frf,String.fromCharCode(32));
var La=this.tableManager.nn(za),Ia=za.Ed(La);if(a.ZSe(this.NCa)||!this.O5f(this.NCa))return this.items;var Ya=new R.Range(1,za.left,za.top-1,za.left,!1,!1),tb=new R.Range(za.top+1,za.left,x.a.Hh,za.left,!1,!1),Tb=Q.g(this.$);tb=Tb.xk("CellAutoCompleteControl.GetSuggestedCells",tb);try{var va=Tb.xk("CellAutoCompleteControl.GetSuggestedCells2",Ya);try{for(var la=Gl([va,tb]),$a=la.next();!$a.done;$a=la.next())for(var Ra=$a.value;Ra.$$mn();){var eb=Ra.$$cu();this.Vzg(za,this.NCa,eb,ka,Ia,La,this.tableManager)}}finally{va&&
va.dispose()}}finally{tb&&tb.dispose()}this.qq=Array(ka.values.length);for(za=0;za<this.items.length;za++)this.items[za]=ka.values[za];this.items.sort(function(mb,Pa){return mb.ssa.localeCompare(Pa.ssa)});return this.items};a.prototype.kob=function(ka,za){ka&&za&&this.g_c.push(new e(ka,za,this.ycf?this:void 0))};a.prototype.Wuj=function(){return this.mei?this.E0a&&!this.Jwa()&&this.isListVisible?this.get_visible():!1:this.E0a&&!this.Jwa()&&this.get_visible()&&this.isListVisible};a.ZSe=function(ka){ka=
0<ka.length?ka.charCodeAt(0):-1;return 35===ka||61===ka||43===ka||45===ka||64===ka};Ck.Object.defineProperties(a.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return this.QY}},E0a:{configurable:!0,enumerable:!0,get:function(){return this.NCa}},ye:{configurable:!0,enumerable:!0,get:function(){return this.QY.ye}},items:{configurable:!0,enumerable:!0,get:function(){return this.qq}},tNa:{configurable:!0,enumerable:!0,get:function(){return this.J$d}},activeCell:{configurable:!0,enumerable:!0,
get:function(){return Q.g(this.$).ha.ta.activeCell}},dataValidationControl:{configurable:!0,enumerable:!0,get:function(){return this.a4d||(this.a4d=this.$.da.za(14))}}});Ck.Object.defineProperties(a,{frf:{configurable:!0,enumerable:!0,get:function(){return a.qbe||(a.qbe=new RegExp(String.fromCharCode(160),"g"))}}});a.qbe=null;Object(y.a)(a,"CellAutoCompleteControl",h.a,[751,746,752,3])},1438:function(y,C,b){function a(){this.tb=null;this.mx=!1}function c(k,F){var X=wl.call(this)||this;X.nqa=Al.a.bGh;
X.KOc=!!window.PointerEvent;X.Mhe=window.hasOwnProperty("ontouchstart");X.jkb=null;X.LVa=null;X.S8=!1;X.rT=new $k.a;X.Dkb=new $k.a;X.mog=new Ka.a;X.Kpa=null;X.cmb=!1;X.M2d=!1;X.oee=!1;X.HMc=!1;X.aGc=!1;X.G2d=!1;X.eJc=!1;X.OUa=!1;X.Ljb=-1;X.sRc=null;X.session=null;X.handlers=null;X.element=null;X.curRecognizer=null;X.Xd=lj.EventHandlerManager.instance;X.KOc?(Wd.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),X.jkb=Object(Df.a)(X,X.Wnc,"onPointerEvent"),X.LVa=Gg.a.dGh):X.Mhe?(Wd.ULS.sendTraceTag(593893140,
310,50,"Using touch events"),X.jkb=Object(Df.a)(X,X.Dya,"onTouchEvent"),X.LVa=Gg.a.touchEvents):(Wd.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),X.jkb=Object(Df.a)(X,X.Gnc,"onMouseEvent"),X.LVa=Gg.a.cGh);X.Dh=F;X.kfa=k;Rf.AFrameworkApplication.fa&&(X.cmb=Rf.AFrameworkApplication.fa.ra("UsePointerCaptureIsEnabled"),X.M2d=Rf.AFrameworkApplication.fa.ra("ClearCacheOnPrimaryPointerIsEnabled"),X.oee=Rf.AFrameworkApplication.fa.ra("ResetHandledBeforeInputHandlerIsEnabled"),X.HMc=Rf.AFrameworkApplication.fa.ra("LogCoalescedEventsIsEnabled"),
X.aGc=Rf.AFrameworkApplication.fa.ra("CheckExistenceOfGetCoalescedEventsIsEnabled"),X.G2d=Rf.AFrameworkApplication.fa.ra("CheckIfHammerExistsAfterDownloadIsEnabled"),X.eJc=Rf.AFrameworkApplication.fa.ra("HammerJsPerformanceTimersIsEnabled"),X.OUa=X.cmb&&Rf.AFrameworkApplication.fa.ra("CancelDragFromGestureInputManagerIsEnabled")&&Rf.AFrameworkApplication.fa.ra("UseGestureInputManagerPointerCacheIsEnabled"));return X}function e(){}function f(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=
null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}function l(k,F,X,ra,ab,Qb,Fc,ld,ud){k=yl.call(this,k,X,ra,Qb)||this;k.Vgb=F;k.lga=Fc;k.QX=ld;k.PXj=ud;k.kog=ab;return k}function n(){this.rHc=null}function m(){this.ada=this.yVe=null}function h(k){var F=
zl.call(this)||this;F.$=k;F.Tb();return F}function x(k){this.$=k;this.show=function(){};this.hide=function(){};this.handler=new u(this.$,this);this.cache=[this.handler]}function u(k,F){this.cache=void 0;var X=this;X.$=k;X.callbacks=F;X.Xmc=function(ra,ab){if(!(0<ra.textBox.selection.length))switch(ab.state){case 0:X.Wzd(ra,ab.event);break;case 1:X.oLi(ra);break;default:return Wd.ULS.shipAssertTag(521446489,0,!1,"FormulaAssistanceValuePreviewHandler.onHoverChange unxpected HoverState"),ab}};X.Wmc=
function(ra,ab){var Qb;X.clearCache();ab=null!==(Qb=ab.selection)&&void 0!==Qb?Qb:ra.textBox.selection;if(0<ab.length)X.onSelectionChange(ra,ab);else X.xBf(ra)};X.editBox=Object(ff.g)(X.$).tc;X.formulaBar=Object(rk.a)(X.$);X.Ej();return X}function w(k){this.cache=k}function v(k){return Dl.call(this,k)||this}function t(k){this.$=k}function z(k){var F=Cl.call(this)||this;F.$=k;F.Tb();return F}function D(k){var F=this;this.$=k;this.oB=null;this.lBb=-1;this.ojc=null;this.pjc=0;this.b$=Object.assign({},
tj);this.mV=Object.assign({},Yj);this.FY=Object.assign({},Oj);this.tob=Object.assign({},pj);this.Kda=Object.assign({},Hj);this.uob={};this.Bbd=Object.assign(Object.assign({},lk),{isReactDialog:O.a.ief(this.$)});this.Tf=function(X,ra){null!=F.oB&&(1==Math.abs(F.lBb-F.$.ea.Te)&&(X=F.$.xa.qa.sheetId,ra.rqb&&ra.el.equals(F.oB.el)&&F.ojc===X&&F.oB.Cpb!==ra.Cpb&&F.pjc++),1<=Math.abs(F.lBb-F.$.ea.Te)&&(F.oB=null,F.lBb=-1,F.ojc=null))};this.Zc=function(){F.erj();F.E9&&F.orj();F.$.sendBeaconTraceTag(88392384,
50,!1,"{0}",F.getJsonForLogging())};this.E9=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");this.x$a=new $k.a;k.cl(this.Zc);this.E9&&ff.g(this.$).Nj.Kn(this.Tf)}function A(k){var F=this;this.tpf=k;this.X_=Object.assign({},vk);this.l7b=[];this.Qkc=-1;(this.qpf=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&k&&(this.X_.countAboveThresholds={},k.forEach(function(X){return F.X_.countAboveThresholds[X]=0}))}function B(k){var F=
ui.call(this)||this;F.$=k;F.Tb();return F}function N(k,F,X,ra,ab){var Qb=xh.call(this)||this;Qb.UO=null;Qb.u0=null;Qb.nFa=null;Qb.Puc=null;Qb.INc=null;Qb.pXa=null;Qb.Fde=0;Qb.BEc=!1;Qb.Lfc=!1;Qb.TBb=!1;Qb.Jg=function(){Qb.pwa&&(Qb.gridView?1===Qb.gridView.ha.We?(Qb.gridView.ha.ta.activeCell.equals(Qb.nFa)||Qb.bN||Qb.ay(),Qb.fob.Zq()):Qb.ay():Wd.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};Qb.fj=function(){Qb.ay()};Qb.vd=function(){Qb.nX()};Qb.Zc=function(){Qb.ay()};Qb.xd=
function(){Qb.showCallout()};Qb.mya=function(){if(Qb.gh.Ok&&Qb.gh.Ok.length)if(Qb.MYc)Qb.gh.Mri||(Qb.BEc=Qb.gh.Ok[0].BlockingDataForExpand),Qb.gh.aNh&&Wd.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),Qb.Fde=Qb.gh.u4c&&Qb.gh.BUe<Qb.gh.u4c.left-1?Qb.gh.u4c.left-1-Qb.gh.BUe:-1,Qb.showCallout();else if(Qb.gridView.ha.ta.Hg){var Fc=Qb.gridView.ha.ta.activeCell;if(Fc&&Qb.u0){var ld=Qb.tableManager.nn(Fc);Qb.wLc=!!ld;var ud=Qb.gridView.ha.ta.qd;
ld=Qb.bN&&Qb.u0.Ed(ld);var jd=Qb.mhd&&!Qb.bN&&ud.equals(Qb.selectedRange);ld||jd?(Wd.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),Qb.l9b=!0,ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!Qb.bN&&Qb.tableManager.vva(Fc)?Wd.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?
Qb.bN?Qb.Zh.CAa(Qb.u0,Qb.bN):Qb.Zh.CAa(ud,Qb.bN):Qb.Zh.CAa(Qb.u0,Qb.bN),Qb.ztc())):Wd.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};Qb.ej=function(){Qb.p6a()&&Qb.Zh.hide();1===Qb.gridView.ha.We&&Qb.nX()};Qb.CR=function(){var Fc=Qb.gridView.ha.We;Qb.gridView.ha.ta.activeCell&&1===Fc&&Qb.nX()};Qb.qt=function(){if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(Qb.bN){if(Qb.u0&&Qb.nFa){var Fc=
Qb.tableManager.nn(Qb.nFa);Fc&&1<Fc.bottom-Fc.top&&(--Fc.bottom,Qb.gridView.r5(Fc)&&Qb.fob.Zq())}}else Qb.gridView.ha.ta.Hg&&Qb.gridView.r5(Qb.gridView.ha.ta.qd)&&Qb.fob.Zq();else Qb.u0&&Qb.nFa&&Qb.bN&&(Fc=Qb.tableManager.nn(Qb.nFa))&&1<Fc.bottom-Fc.top&&(--Fc.bottom,Qb.gridView.r5(Fc)&&Qb.fob.Zq())};Qb.nX=function(){if(Qb.$&&Qb.gridView){if(Qb.l9b&&Qb.bN){var Fc=Qb.gridView.ha.ta.activeCell;Qb.u0=Qb.HSe();var ld=!!Qb.Puc&&Qb.Puc.contains(Fc);if(Qb.u0&&(Fc.equals(Qb.nFa)||ld)){Qb.Zh.CAa(Qb.u0,Qb.bN);
return}}Qb.l9b=!1;Qb.u0=Qb.HSe();Qb.u0&&Qb.Gla&&Qb.gridView&&Qb.gridView.Ea.cs(Qb.Gla)?(Qb.MYc=!1,Qb.BZ()):(Qb.gh.FZc(),Qb.gh.x1b());Qb.l9b||Qb.Zh.hide()}};Qb.$=k;Qb.tableManager=X;Qb.contextMenuManager=ra;Qb.Zh=new P(k,Qb.xd,F,ab);Qb.gh=F.a3c(k,X);Qb.MYc=!1;Qb.l9b=!1;Qb.mhd=ve.EwaSettings.ma(136);Qb.wLc=!0;Qb.GKc=!1;Qb.gridView=ff.g(Qb.$);Qb.gridView.pc.ql(Qb.fj);Qb.gridView.Mt(Qb.CR);Qb.$.dl(Qb.vd);Qb.$.cl(Qb.Zc);Qb.$.GA(Qb.ej);Qb.gridView.view.Rs(Qb.qt);Qb.gridView.ha.EP(Qb.Jg);Qb.fob=mi.a.instance.create(Qb.nX,
250,$i.a.z0i);Wd.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");Qb.gh.cZb(Qb.mya);O.a.Ayb()&&(Qb.Lfc=!0);Qb.nX();k.da.Ga(261,Qb);return Qb}function P(k,F,X,ra){var ab=Ki.call(this)||this;ab.isMac=mj.a.isMac;ab.$=k;ab.ariaLiveNotifier=ra;ab.Tp=X.C4b(k,null,F,pb.a.hsh,uh.a.gf(9),we.a.instance.ga(1713),"PulloutPointerDown");return ab}function Q(k){var F=dh.call(this)||this;F.E4b=null;F.$=k;F.Tb();return F}function M(k){var F=uf.call(this)||this;F.$=k;ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6198510_AddServiceCreatedEvent")&&
F.Tb();return F}function ba(){}function V(k,F,X,ra,ab){X=void 0===X?null:X;ra=void 0===ra?null:ra;ab=void 0===ab?0:ab;k=E.call(this,k,F)||this;k.zNa=null;k.jec=X||uh.a.current.hp(83);k.xkf=ab;k.x4c=ra;k.WAg();return k}function aa(k,F,X,ra){k=E.call(this,k,F)||this;k.IBb=null;k.Omg=X;k.L4h=ra;k.XAg();return k}function E(k,F){k=df.call(this,k)||this;k.JBb=null;k.F7h=Math.max(1,F);return k}function G(k,F,X,ra,ab,Qb,Fc,ld){ld=void 0===ld?"":ld;var ud=Be.call(this)||this;ud.hwa=null;ud.X7e=!1;ud.llc=null;
ud.klc=null;ud.buttons={};ud.OLe={};ud.$=k;ud.svgIconProvider=F;ud.gGi=X;ud.tkd=ra;ud.skd=ab;ud.altText=Qb;ud.XFb=Fc;ud.buttonText=ld;return ud}function I(k,F,X,ra,ab,Qb,Fc,ld){function ud(Ye){Ng.g(Ye)}var jd=Vc.call(this,document.createElement("div"))||this;jd.Iif=null;jd.URd=!1;jd.$Ra=null;jd.NMb=null;jd.CN=function(){jd.raiseEvent("OnObjectButtonMouseOver")};jd.BN=function(){jd.raiseEvent("OnObjectButtonMouseOut")};jd.Zzj=function(){jd.zje()};jd.xd=function(Ye){jd.raiseEvent(jd.XFb,Ye);jd.VFb();
return!0};jd.OHi=function(Ye){100<Jj.a(Vh.a.Ua,jd.Iif)&&jd.Nhd(new Sys.UI.Point(Math.round(Ye.clientX),Math.round(Ye.clientY)))};jd.xN=function(Ye){Ng.g(Ye.Ca,!1);return!1};jd.iZ=jd.Ae.zHa();jd.set_visible(!1);jd.Shc=ab;jd.XFb=Qb;jd.Plc=k;jd.v2b=F;jd.Shc&&(jd.$Ra=mi.a.instance.create(jd.Zzj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));k&&jd.domElement.classList.add(k);jd.UZa=document.createElement("div");jd.domElement.appendChild(jd.UZa);X&&jd.UZa.classList.add(X);ra&&(jd.UZa.innerHTML=ra);Fc&&(jd.NMb=
document.createElement("div"),jd.domElement.appendChild(jd.NMb),jd.NMb.classList.add(ld),jd.NMb.innerText=Fc,jd.domElement.style.padding="3px",Ij.a.instance.pa(Gg.a.pointerDown,jd.domElement,jd.xN));jd.LZa=new Nc.a(jd.domElement,7);rj.a.instance.pa(Gg.a.click,jd.domElement,jd.xd);ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&Ij.a.instance.pa(Gg.a.pointerDown,jd.domElement,jd.xN);jd.Kc.ka("mouseup",ud);jd.Kc.ka("click",ud);jd.Kc.ka("dblclick",ud);return jd}
function R(){}function Y(k,F,X,ra){var ab=U.call(this,k,F)||this;ab.F1a=null;ab.dwf=function(){ab.ysc(ab.dwf);if(ab.Ok&&ab.Ok.length&&ab.contextMenuManager){var Qb=ab.contextMenuManager.Vcd("autoFilterRichFieldList"),Fc=window.document.getElementById(ab.F1a);Qb.K0(null,Fc,ab,null,!0)}};ab.skg=X;ab.contextMenuManager=ra;return ab}function U(k,F){var X=Lb.call(this)||this;X.nP=null;X.$ub=null;X.Ddd=null;X.FIb=null;X.STb=!1;X.O3d=null;X.CFd=!1;X.DJi=function(ra,ab,Qb){Wd.ULS.sendTraceTag(25264350,0,
10,"Call to GetRichValueFieldListContextList failed in: "+Qb);X.FIb&&X.FIb.stop();X.nP=null;X.raiseEvent("GetFieldInfoListContextOperationFailed")};X.EJi=function(ra){qc.a(ra)||(X.FIb&&X.FIb.stop(),X.STb=!1,X.nP=ra.Result,X.nP&&0<X.nP.length&&Wd.ULS.sendTraceTag(25264351,0,50,"Retrieved {0} rich value field list context for autocomplete",X.nP.length),X.aWa=!0,X.Rqc())};X.aWa=!1;X.xb=k;X.BSb=-1;X.tableManager=F;X.CFd=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&
O.a.NV(k);return X}function ha(k){var F=H.call(this)||this;F.firstElement=null;F.Gw=null;F.cMa=!1;F.Ds=null;F.$tj=mj.a.Nf||mj.a.lB;F.dyf=function(X){var ra=X.Ca.keyCode;return ra===ec.a.ei?F.hIi():ra===ec.a.AD&&X.Ca.shiftKey?F.Cwh(F.firstElement):!1};F.yDf=function(X){if(!F.cMa||X.Ca.keyCode!==ec.a.pL)return!1;ha.t7e();Xf.Task.delay(1).CWRCC(function(){F.Gw.focus();return!0},F.la);return!0};F.JSi=function(){document.activeElement&&document.activeElement.id===F.Gw.id||(ha.t7e(),Xf.Task.delay(1).CWRCC(function(){F.Gw.focus();
return!0},F.la))};F.jwf=function(){F.u9f(F.Gw)};F.cyf=function(X){X.stopPropagation();X.preventDefault();F.cMa&&(F.cMa=!1)};F.$=k;(k=F.$.ea.xc)&&Wd.ULS.sendTraceTag(39350791,0,50,"EmbedViewFocusControl: PermissionSet = {0}; InWebPart = '{1}', InEmbedView = '{2}'",k.cta,k.inWebPart?"Classic":"Non Classic",k.inEmbedView?"True (+Modern)":"False (not Modern)");k&&(k.inWebPart||k.inEmbedView)?Wd.ULS.sendTraceTag(537153856,0,15,"EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '{0}', InEmbedView = '{1}'",
k.inWebPart?"Classic":"Non Classic",k.inEmbedView?"True (+Modern)":"False (not Modern)"):(F.K5g(),F.I6g(),Hk.KeyInputManager.instance.pa(Gg.a.Xb,F.$.domElement,F.yDf));F.$.da.Ga(238,F);return F}function ta(k,F,X,ra,ab){ab=void 0===ab?null:ab;var Qb=Mj.call(this)||this;Qb.ynb=null;Qb.NOa=null;Qb.QYc=0;Qb.Poc=null;Qb.rPi=function(){var Fc=Qb.NOa.cYe();Wd.ULS.sendTraceTag(537153861,0,50,"ActionAggregator<{0}>.OnRunningLong: Operation running for more than {1}ms",Qb.kla,Fc);Qb.Poc=mi.a.instance.create(Qb.z6,
Math.max(Qb.Bue-Fc,0),$i.a.nje)};Qb.z6=function(){Wd.ULS.sendTraceTag(537153860,0,50,"ActionAggregator<{0}>.OnTimeout: Operation running for more than {1}ms, timing out. Has pending actions: {2}",Qb.kla,Qb.NOa.cYe(),Qb.z5a);Qb.QYc++;Qb.QYc>Qb.Aue&&Wd.ULS.sendTraceTag(537153859,0,50,"ActionAggregator<{0}>.OnTimeout: passed the allowed bypassed count",Qb.kla);Qb.NOa.Cx.C();Qb.QSe()};Qb.lya=function(){Qb.z5a&&Wd.ULS.sendTraceTag(537153858,0,50,"ActionAggregator<{0}>.OnDocumentUnhidden: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",
Qb.kla,Qb.DLa,Qb.z5a);Qb.Qld()};Qb.Jyg=k;Qb.Kyg=F;Qb.documentVisibilityObserver=X;Qb.kla=ra;Qb.HO=ab;X&&Qb.documentVisibilityObserver.fnb(Qb.lya);Qb.PYc=!!X&&ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);Qb.Aue=ve.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);F=ve.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);Qb.Bue=k.dcd(F);k=ve.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",
1E3);Qb.TRg=Math.max(Qb.Bue-F,0)+k;return Qb}function xa(){this.startTime=Vh.a.Ua.Vb;this.Cx=new Ni.a}function oa(k){var F=oh.call(this)||this;F.$=k;F.Tb();return F}function qa(k,F,X,ra,ab,Qb,Fc){var ld=this;this.$=k;this.functionInfoManager=F;this.calcManager=X;this.pluginScheduler=ra;this.formulaAssistanceUIControl=ab;this.formulaAssistanceTelemetryManager=Qb;this.gh=Fc;this.JRa=!0;this.NLa=this.isCellContentOnlyEqualDuringEdit=!1;this.eNa=null;this.dNa=-1;this.Gca=0;this.Sh=function(ud,jd){ld.gridView.isEditing||
ld.gridView.Li||ld.nDb(null===jd||void 0===jd?void 0:jd.cell)};this.onFunctionInfoLoaded=function(){ld.functionInfoManager.Zab(ld.onFunctionInfoLoaded);ld.jRj();ld.tda()};this.ftf=function(){ld.JRa=!1};this.ntf=function(ud,jd){var Ye=ld.Ya;ud=Ye.text;Ye=Ye.textBox.caretPosition;0<ld.Gca&&ld.formulaAssistanceTelemetryManager.FY.commitWhileRequestPending++;ld.formulaAssistanceTelemetryManager.sX(["argumentAssistanceComputation","argumentAssistanceOverall"]);jd.shouldRequestAutocompleteOnCommit?ld.sWf(ud,
Ye):ld.WJd(ud,Ye)};this.Tf=function(){ld.z2&&(ld.isCellContentOnlyEqualDuringEdit&&(ld.formulaAssistanceTelemetryManager.mV.isCellContentOnlyEqualDuringEditCounter++,ld.isCellContentOnlyEqualDuringEdit=!1),ld.NLa&&(ld.formulaAssistanceTelemetryManager.mV.isCellContentFormulaCounter++,ld.NLa=!1));ld.JRa=!0;ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&ld.e6c()};this.k6=function(ud,jd){ld.CLd(jd.newValue)};this.Oi=function(){ld.Dbg()};this.Dbg=function(){ld.pluginScheduler.notifier().setDefinedNamesInfo(ld.U5b.oGe)};
this.Xdd=function(ud,jd){ud=ld.pluginScheduler.syncRequester().formulaHighlighting({content:ud,caretPosition:null===jd||void 0===jd?void 0:jd.index,selectionLength:null===jd||void 0===jd?void 0:jd.length});if(isNullOrUndefined(ud)||isNullOrUndefined(ud.formulaHighlights))Wd.ULS.sendTraceTag(521211933,0,10,"FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:{0}",!isNullOrUndefined(ud));else return ud};this.functionInfoManager=
F;this.formulaAssistanceUIControl=ab;this.pluginScheduler=ra;this.gridView=ff.g(this.$);this.gef=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.rba=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.Ixd=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.z2=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");this.gef&&(this.U5b=
new Yb(k),this.gridView.Ea.yx(this.Oi),this.Dbg());this.hqa=new La(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.vfa=new za(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);if(this.Ogi=O.a.vba(k))this.NCh=new Ea(this.$);k.da.Ga(464,this);this.calcManager=X;O.a.OV()&&this.sld();this.z2&&this.gridView.tc.Kn(this.Tf);this.rba&&(this.z2||this.gridView.tc.Kn(this.Tf),this.hqa.XDg(this.ftf));this.Vmd=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",
!1)}function Ea(k){this.$=k}function ka(k,F){var X=this,ra,ab;this.gh=k;this.$=F;this.mya=function(){X.k9b.resolve(X.gh.Ok);X.Y$f()};this.Mwf=function(){X.k9b.reject(null);X.Y$f()};this.Tf=function(){X.gh.xbb();X.Nrd=null};null===(ab=null===(ra=ff.g(this.$))||void 0===ra?void 0:ra.tc)||void 0===ab?void 0:ab.Kn(this.Tf)}function za(k,F,X){var ra=ue.call(this,za.CJa())||this;ra.$=k;ra.formulaAssistanceUIControl=F;ra.formulaAssistanceTelemetryManager=X;ra.Ya=null;ra.rr=null;ra.lIa=!1;ra.mIa=!1;ra.kIa=
!1;ra.iIa=!1;ra.jIa=!1;ra.Qt=null;ra.gX=0;ra.Yq=null;ra.Zv=!1;ra.Efa=!1;ra.KAa=!1;ra.iSa=!1;ra.hSa=!1;ra.ENb=wd.Dismissed;ra.onRestoreFocus=function(){};ra.dismiss=function(){ra.Zv=!1;ra.ltd();ra.IH&&ra.Ya.isEditing&&ra.Vma();ra.Yq=null;ra.formulaAssistanceUIControl&&(ra.formulaAssistanceUIControl.dismiss(ra.domElement),ra.rr.canReceiveFocus=!1,ra.ENb=wd.Dismissed)};ra.thd=function(){ra.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};ra.wca=function(ab,Qb){0==Qb.Dp&&(170==Qb.Pf.operation.operationName&&
ra.formulaAssistanceTelemetryManager.pjc++,ra.$.userOperationManager.Ul(ra.wca))};ra.DOa=function(ab,Qb){0==Qb.Dp&&(12==Qb.Pf.operation.operationName&&ra.$.userOperationManager.xq(ra.wca),ra.$.userOperationManager.Ul(ra.DOa))};ra.HHi=function(){ra.dismiss();ff.g(ra.$).Nj.textBox.focus()};ra.YQa=function(){var ab={};ra.KDf?ab[We.a.AQ]="SmartSuggestionsCard":ab[We.a.AQ]="FunctionAndSmartSuggestionsCard";ra.$.Ud(802602464,0,8,ab)};ra.Tf=function(){ra.$yb&&ra.YHg()};ra.hzd=function(ab,Qb){ra.Yeb(Qb);
ra.mIa=!0};ra.ld=function(){ra.visible=!1};ra.gzd=function(ab){ra.jIa=!0;ra.pqb(ab)};ra.Th=function(){ra.dismiss()};ra.qt=function(){void 0!==ra.Yq&&null!==ra.Yq&&ra.Yq()};ra.rr=new bc(ra.$,ra.formulaAssistanceUIControl,1,Ii.a.hbd,ra.thd);ff.g(ra.$).view.Rs(ra.qt);ff.g(ra.$).ha.GG(ra.ld);ra.$.xa.og(ra.Th);ra.$yb=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");ra.E9=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");
ra.$yb&&ff.g(ra.$).tc.Kn(ra.Tf);ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&ra.$.domElement.appendChild(ra.domElement);ra.bii=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents");return ra}function La(k,F,X){var ra=pd.call(this,La.CJa())||this;ra.$=k;ra.formulaAssistanceUIControl=F;ra.formulaAssistanceTelemetryManager=X;ra.R2=0;ra.rr=null;ra.Yq=null;ra.$ka=null;ra.Zv=!1;ra.fR=!1;ra.ld=function(){ra.visible=!1};ra.onCardModeChange=
function(ab){ra.PNb(ab);1===ab?ra.formulaAssistanceTelemetryManager.b$.argumentAssistanceCollapseCounter++:ra.formulaAssistanceTelemetryManager.b$.argumentAssistanceExpandCounter++};ra.YQa=function(ab){var Qb={};Qb[We.a.AQ]="ArgumentAssistanceCard";var Fc={};Fc.FunctionName=ab.functionName;Qb[We.a.p$c]=Fc;ra.$.Ud(802602464,0,8,Qb)};ra.qt=function(){void 0!==ra.Yq&&null!==ra.Yq&&ra.Yq()};ra.onDismissClick=function(){ra.formulaAssistanceTelemetryManager.b$.argumentAssistanceDismissCounter++;ra.dismiss();
ra.raiseEvent("DC");ra.fR&&ra.$G.clear();0===ra.R2&&ra.PNb(1)};ra.Tf=function(){ra.fR&&ra.$G.clear()};ra.rba=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);ra.hOd();ra.rr=new bc(ra.$,ra.formulaAssistanceUIControl,0,Ii.a.ebd);ff.g(ra.$).view.Rs(ra.qt);ff.g(ra.$).ha.GG(ra.ld);ra.fR=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",
!1);ra.fR&&(ra.$G=new nb(ra.formulaAssistanceUIControl,ra.formulaAssistanceTelemetryManager),ff.g(ra.$).tc.Kn(ra.Tf));ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&ra.$.domElement.appendChild(ra.domElement);return ra}function Ia(k,F,X,ra,ab,Qb,Fc,ld,ud){var jd=Cc.call(this,k)||this;jd.functionInfoManager=F;jd.calcManager=ra;jd.instantaneousSupportInformationManager=ab;jd.formulaAssistanceUIControl=Fc;jd.formulaAssistanceTelemetryManager=ld;jd.pluginScheduler=
ud;jd.udc=!1;jd.rr=null;jd.mGa=null;jd.Eg=null;jd.aW=null;jd.ird=null;jd.D5=null;jd.W2a=0;jd.x$b=0;jd.R3=0;jd.CIe=0;jd.psb=0;jd.Ndb=0;jd.g5b=0;jd.bxc=!1;jd.Pia=null;jd.tpc=null;jd.columnName="";jd.C5c=!1;jd.Tve=!1;jd.sJa=[];jd.jQ=null;jd.gSa=[];jd.Yq=null;jd.Hbd=null;jd.t8=null;jd.Efa=!1;jd.KAa=!1;jd.iSa=!1;jd.hSa=!1;jd.isCellContentOnlyEqualDuringEdit=!1;jd.NLa=!1;jd.eNa=null;jd.dNa=0;jd.u1d=null;jd.HCb=0;jd.qmd=!1;jd.onRestoreFocus=function(){};jd.rfb=void 0;jd.thd=function(){jd.Hk&&jd.raiseEvent(Ia.Kad,
null)};jd.ZRe=function(){jd.Pia=!1;jd.aW=jd.Ya.text;jd.rh.fJa(jd.Qt,jd.aW,!0,jd.columnName,void 0,!1);1===jd.rh.Fq.length&&1===jd.rh.BW.length?(jd.set_visible(!1),jd.Tve||jd.ykd()):jd.show()};jd.NKi=function(Ye){if(qc.a(Ye))-315732528!==Ye.Errors[0].MessageId&&Wd.ULS.sendTraceTag(537162013,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : {0}",Vf.a.Tc(Ye.Errors));else if((Ye=Ye.Result)&&Ye.length){jd.Eg.DO||(jd.Eg.DO={},jd.Eg.DO.HeadersList=
[]);jd.Eg.DO.IsFullTableHeaders=!0;for(var Bf=0;Bf<Ye.length;++Bf)jd.Eg.DO.HeadersList[Bf]={},jd.Eg.DO.HeadersList[Bf].Index=Bf,jd.Eg.DO.HeadersList[Bf].Name=Ye[Bf];jd.sGf(!0);jd.aW=jd.k2e();jd.rh.fJa(jd.Qt,jd.aW,!0,void 0,void 0,!0);jd.show()}else Wd.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};jd.MKi=function(Ye){Ye=pi.a.ig(Ye.data);Wd.ULS.sendTraceTag(537162011,0,10,"FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: {0}",
Vf.a.Tc(Ye))};jd.Hsf=function(Ye,Bf){jd.gridView.isEditing||jd.gridView.Li||jd.nDb(null===Bf||void 0===Bf?void 0:Bf.cell)};jd.k6=function(Ye,Bf){jd.CLd(Bf.newValue)};jd.ld=function(){(ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)||jd.Hk)&&jd.set_visible(!1)};jd.Ewf=function(){jd.mGa=null;jd.t8=null};jd.Th=function(){jd.Hk&&jd.m1a()};jd.onFunctionInfoLoaded=function(){jd.cob()};jd.mya=function(){jd.bka?(jd.t8=null,jd.mGa=null,jd.cob()):jd.gh.Ok&&jd.Are()};
jd.tca=function(){jd.jQ&&Ha(jd.$,jd.jQ.HelpId,jd.jQ.IsDynamicUdf);return!0};jd.wca=function(Ye,Bf){0==Bf.Dp&&(170==Bf.Pf.operation.operationName&&jd.formulaAssistanceTelemetryManager.pjc++,jd.$.userOperationManager.Ul(jd.wca))};jd.DOa=function(Ye,Bf){0==Bf.Dp&&(12==Bf.Pf.operation.operationName&&jd.$.userOperationManager.xq(jd.wca),jd.$.userOperationManager.Ul(jd.DOa))};jd.m1a=function(){jd.Hk&&jd.ltd();jd.IH&&jd.Ya.isEditing&&jd.Vma();jd.Yq=null;jd.formulaAssistanceUIControl&&(jd.formulaAssistanceUIControl.dismiss(jd.j0b),
jd.rr.canReceiveFocus=!1);jd.qmd=!1};jd.wBf=function(){jd.IH&&jd.Vma();jd.g3f();1===jd.bWf.type&&ve.EwaSettings.Gb()&&!jd.Ya.text.includes("\n")&&jd.gEd(jd.bWf)};jd.onDismiss=function(){jd.isListVisible=!1;jd.gridView.Nj.textBox.focus()};jd.YQa=function(){var Ye={};jd.rh.Rhc?Ye[We.a.AQ]="SmartSuggestionsCard":Ye[We.a.AQ]="FunctionAndSmartSuggestionsCard";jd.$.Ud(802602464,0,8,Ye)};jd.hzd=function(Ye,Bf){jd.rh.Icg(Bf);jd.Hk&&(jd.mIa=!0)};jd.gzd=function(Ye){jd.Hk&&(jd.jIa=!0);jd.IH?(jd.Zze(),jd.E9&&
jd.BUf(),jd.gridView.Nj.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):Ye.textEdit?jd.pqb(Ye.textEdit):jd.Xy(!0)};jd.fr=ff.g(k);jd.domElement.className=ai.a.ZLe;jd.gh=Qb.a3c(k,X);jd.U5b=new Yb(k);jd.Awg=X;Ia.Ujd||(Ia.Ujd=Ia.CJa());jd.domElement.innerHTML=Ia.Ujd;jd.gyd=RegExp("\\d+");Vi.d(jd.style,jd.$.isChromeRtl);jd.aja=new Nb(jd.$,jd.domElement,jd.functionInfoManager,jd.formulaAssistanceUIControl,jd.formulaAssistanceTelemetryManager,jd.pluginScheduler);F=$get($b.Ebd,jd.domElement);
X=$get($b.zbd,jd.domElement);ra=$get($b.Gbd,jd.domElement);jd.aog=new mb(jd.$,F,ra,X,jd);jd.gh.cZb(jd.mya);jd.functionInfoManager.vYa(jd.onFunctionInfoLoaded);jd.functionInfoManager.qEg(jd.Ewf);jd.j0b=jd.domElement;jd.Hk&&(jd.$.xa.og(jd.Th),jd.rh.lVc(jd.wBf),ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&(jd.j0b=document.createElement("div")));jd.ASa(!0);jd.p6f(!0);jd.$.domElement.appendChild(jd.j0b);jd.qQc=0;(X=rk.a(k))&&jd.sJa.push(new cc(k,X,jd,jd.formulaAssistanceTelemetryManager));
jd.sJa.push(new cc(k,jd.fr.pc,jd,jd.formulaAssistanceTelemetryManager));jd.dub=jd.sJa[0];jd.Bpb=jd.sJa[jd.sJa.length-1];k.da.Ga(221,jd);jd.instantaneousSupportInformationManager||jd.$.da.$a(268,function(Ye){jd.instantaneousSupportInformationManager=Ye});jd.rRe=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);ve.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&(void 0===jd.formulaAssistanceTelemetryManager.Kda.anyPluginInitialized?
Wd.ULS.sendTraceTag(523511372,0,15,"FormulaAssistanceControl - tried to initiailize mockSetActiveCellExperimentStage before pluginInitialized data is set."):jd.formulaAssistanceTelemetryManager.Kda.anyPluginInitialized||(jd.HCb=ve.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)));jd.JAa=O.a.eMa(jd.$);jd.eyc=O.a.oqd();jd.Ixd=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");jd.z2=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");
O.a.OV()&&jd.sld();O.a.VM(jd.$)&&F.classList.add("ewa-fb-refactor");jd.Hk?jd.gridView.ha.GG(jd.ld):jd.gridView.ha.EP(jd.ld);jd.rr=new bc(jd.$,jd.formulaAssistanceUIControl,1,Ii.a.hbd,jd.thd);jd.Vmd=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);jd.E9=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");jd.lcf=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6279033_logAutocompletionStatistics");jd.chi=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceGridView",
!1);jd.Bcf=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixKeydownLayoutTrashingBottleneck",!1)&&ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6347847_FormulaAssistanceLayoutFix");return jd}function Ya(){}function tb(){this.caretPosition=this.content=null}function Tb(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}function va(){this.onRestoreFocus=this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}function la(){this.x9=
this._name=null}function $a(){this._name=null}function Ra(){this._name=null}function eb(){this.x9=this._name=null}function mb(k,F,X,ra,ab){k=Wa.call(this,k,F)||this;k.rra=null;k.Yuc=0;k.ULb=0;k.j3b=null;k.KUe=X;k.lub=ra;k.formulaAssistanceControl=ab;k.Fq=[];k.BW=[];k.Hk=O.a.d5();k.jef=k.Hk&&ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations");return k}function Pa(){this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.data=this.isPrefixed=this.detail=
this.type=null}function Da(k,F){this.$=k;this.items=F;this.eMa=O.a.eMa(this.$)}function Ta(k,F){this.IZi=k;this.Oqf=F}function Sa(){}function Cb(k){this.index=k}function cc(k,F,X,ra){k=Qi.call(this,k,F)||this;k.formulaAssistanceControl=X;k.formulaAssistanceTelemetryManager=ra;k.JDf=!1;k.NRa=null;k.Ekd=0;k.QFc=null;k.THa=null;k.kQ=0;k.nob=F.textBox;k.Hk=O.a.d5();k.Q8i=ve.EwaSettings.Gb();k.z2=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");return k}function nc(){this.Qha=
this.Xsa=this.Ysa=!1;this.XDf=40;this.Uye=41;this.L_a=this.XBd=this.YBd=this.zFb=0;this.$uf=!0;this.yAd=!1;this.$Se=this.sMd=-1}function Nb(k,F,X,ra,ab,Qb){var Fc=Gj.call(this,Nb.CJa(O.a.d5()))||this;Fc.$=k;Fc.Lj=F;Fc.functionInfoManager=X;Fc.formulaAssistanceUIControl=ra;Fc.formulaAssistanceTelemetryManager=ab;Fc.pluginScheduler=Qb;Fc.z1a=null;Fc.R2=0;Fc.rr=null;Fc.EWc=!1;Fc.Yq=null;Fc.$ka=null;Fc.JRa=!0;Fc.fR=!1;Fc.onCardModeChange=function(ld){Fc.PNb(ld);1===ld?Fc.formulaAssistanceTelemetryManager.b$.argumentAssistanceCollapseCounter++:
Fc.formulaAssistanceTelemetryManager.b$.argumentAssistanceExpandCounter++};Fc.YQa=function(ld){var ud={};ud[We.a.AQ]="ArgumentAssistanceCard";var jd={};jd.FunctionName=ld.functionName;ud[We.a.p$c]=jd;Fc.$.Ud(802602464,0,8,ud)};Fc.onDismissClick=function(){Fc.formulaAssistanceTelemetryManager.b$.argumentAssistanceDismissCounter++;Fc.JRa=!1;Fc.dsb();Fc.fR&&Fc.$G.clear();0===Fc.R2&&Fc.PNb(1)};Fc.Tf=function(){Fc.JRa=!0;Fc.fR&&Fc.$G.clear()};Fc.dJi=function(ld){ld.button===Sys.UI.MouseButton.leftButton&&
ld.target&&(Ng.g(ld),Fc.z1a&&Fc.z1a.pSa(ld))};Fc.qt=function(){void 0!==Fc.Yq&&null!==Fc.Yq&&Fc.Yq()};Fc.Hk=O.a.d5();Fc.rba=Fc.Hk&&ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);Fc.Hk?(Fc.hOd(),Fc.rr=new bc(Fc.$,Fc.formulaAssistanceUIControl,0,Ii.a.ebd),Fc.rba&&ff.g(Fc.$).tc.Kn(Fc.Tf),Fc.fR=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",
!1)&&!!Fc.formulaAssistanceUIControl,Fc.fR&&(Fc.$G=new nb(Fc.formulaAssistanceUIControl,Fc.formulaAssistanceTelemetryManager)),ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&Fc.$.domElement.appendChild(Fc.domElement)):(Fc.z1a=new Rb(Fc.domElement,Fc.$.qE,void 0,O.a.VM(Fc.$)),Fc.Kc.ka("mousedown",Fc.dJi),k=$get($b.Ebd,Fc.Lj),Fc.Lj.insertBefore(Fc.domElement,k));ff.g(Fc.$).view.Rs(Fc.qt);return Fc}function nb(k,F){this.n$b=k;this.formulaAssistanceTelemetryManager=
F;this.rn=!1;k={};this.usageCount=(k[fj.Drag]=0,k[fj.Move]=0,k);this.YCc=this.n$b.getWindowEdgeBuffer()+1;this.Mpf=new Bb(this);this.RIe=new db(this)}function db(k){this.$G=k;this.rn=!1}function Bb(k){var F=this;this.$G=k;this.QZ=this.kQd=this.rn=!1;this.onKeyDown=function(X){return!F.QZ&&X.keyCode===ec.a.Soa&&X.altKey&&X.ctrlKey?(F.U7b(),X.stopPropagation(),X.preventDefault(),!0):!1};this.TMa=function(X){if(!F.QZ)return!1;if(X.eventName===Gg.a.Xb){var ra=X.Ca.ctrlKey?1:X.Ca.shiftKey?50:10;switch(X.Ca.keyCode){case ec.a.MTa:F.Y5(0,
-ra);break;case ec.a.Qoa:F.Y5(0,ra);break;case ec.a.Roa:F.Y5(-ra,0);break;case ec.a.ifb:F.Y5(ra,0);break;case ec.a.pL:case ec.a.ei:F.kQd=!0;break;default:return!1}}X.eventName===Gg.a.Vd&&F.kQd&&F.i4(!0);X.Ca.preventDefault();return!0};this.WFb=function(X){if(!F.QZ)return!1;X.Ca.preventDefault();F.i4();return!0};this.onBlur=function(){if(!F.QZ)return!1;F.i4();return!0};this.vr=Hk.KeyInputManager.instance;this.pointerInputManager=Ij.a.instance}function zc(){this.content=null;this.caretPosition=0}function Eb(){this.callbacks=
this.functionRenderingInfo=null;this.cardMode=0}function Ja(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onCardModeChange=null}function Rb(k,F,X,ra){ra=void 0===ra?!1:ra;F=yc.call(this,k,F,!1,void 0===X?null:X)||this;F.vRa(ra);F.kj=Z.a.equals("rtl",k.dir,!0);return F}function yc(k,F,X,ra){var ab=fl.call(this,k,void 0===ra?null:ra)||this;ab.V3=null;ab.ITd=!1;ab.rMb=!1;ab.x1a=null;ab.J7=null;ab.offsetParent=null;ab.YDi=null;ab.rJc=!1;ab.frg=null;ab.szd=function(Qb){return ab.m6(Qb)};ab.rzd=
function(Qb){return ab.wN(Qb)};ab.Avf=function(Qb){var Fc=Sc.HelperMethods.Rn(Qb);Fc.button===Sys.UI.MouseButton.leftButton&&2===Qb.zb&&(ab.Ind(Fc.target)||ab.pSa(Fc));return!1};ab.R4d=F;X&&(ab.ITd=!0,Ij.a.instance.pa(Gg.a.pointerDown,ab.VIe,ab.Avf));ab.lfa=!1;return ab}function qd(k,F){var X=Mh.call(this)||this;X.fog=[];X.Ibd={};X.NUe={};X.lT=null;X.Q8=[];X.zJa={};X.Twf=function(ra,ab){Wd.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");X.Fwf(ra,!!ab&&1!==
ab.FilterType,!0)};X.Swf=function(){Wd.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");X.lT=null};X.Cwf=function(ra){Wd.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");X.VGd(ra.ija,!0,!1)};X.Rwf=function(ra){Wd.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");X.Fwf(ra,!0,!1)};X.UKc=!1;X.SKc=!1;X.xb=k;X.pluginScheduler=
F;X.$.da.Ga(19,X);return X}function bc(k,F,X,ra,ab){this.vZc=!1;this.$=k;this.formulaAssistanceUIControl=F;this.kUe=X;this.Tjj=ra;this.G4e=void 0===ab?null:ab}function Vb(k,F,X){var ra=ti.call(this)||this;ra.Fbd=k;ra.GMd=F;ra.MUi=X;return ra}function mc(k){var F=bi.call(this)||this;F.GMd=k;return F}function sb(k,F){var X=Oh.call(this)||this;X.functionName=k;X.Fbd=F;return X}function Yb(k){this.pGe={};this.$=k}function Hb(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}function sc(k){this.pT=
0;this.o8d=!1;this.KVa=this.M9d=null;this.Lqg=void 0===k?!1:k;this.textEdit=null}function zb(k){var F=this;this.srb=this.Aha=this.calcManager=this.Ya=null;this.o9a=function(){F.U4a(!1,!1)};this.$=k;this.cub=new ad(k);this.l$b=new Za(k);this.m$b=new vc(this);ff.g(k).pc.Kn(this.o9a);this.$.da.Ga(317,this)}function vc(k){this.U7=0;this.fbd=k}function ad(k){this.Cqa=this.CSa=this.Z1a=this.bQ=this.I$=this.Ya=null;this.Did=!1;this.Rc=k}function ub(){}function Za(k){var F=this;this.Hxi=30;this.calcManager=
null;this.Pd=!1;this.OOa=this.NFb=this.w$a=null;this.cD=function(){F.Cha.VZ()};this.$=k;this.Cha=new ja;this.KRf=-1;this.$.ea.FG(this.cD)}function wa(k,F,X,ra,ab,Qb,Fc){Fc=k.Na(1,void 0===Fc?null:Fc);Fc.getPartialCalcResultsParameters=F;return Yg.i(k,"GetPartialCalcResults",Fc,X,ra,ab,Qb,4)}function ja(){this.uQa={}}function Ua(k){var F=Wi.call(this)||this;F.$=k;F.Tb();return F}function bb(k,F){var X=this;this.yJa=this.Nua=this.bja=null;this.mAf=function(ra,ab){X.$3i(ab.functionName,ab.Fbd)};this.oAf=
function(ra,ab){X.Z3i(ab.Fbd,ab.GMd,ab.MUi)};this.nAf=function(ra,ab){ra=[];ab=Gl(ab.GMd);for(var Qb=ab.next();!Qb.done;Qb=ab.next())Qb=Qb.value,(!X.qwa||void 0!==Qb&&null!==Qb)&&(Qb=Qb.trim())&&ra.push(Qb);if(!X.qwa||ra.length){ab="";for(Qb=0;Qb<ra.length;Qb++){var Fc=X.GYc(ra[Qb]),ld=bb.xDd(Qb,ra.length);ab+=Fc+ld;ld&&(ab+=X.ariaLiveNotifier.Cxa)}X.ariaLiveNotifier.readText(ab)}};this.pAf=function(ra,ab){X.ariaLiveNotifier.b4i(ab.UF,ab.description,ab.selectedIndex.toString(),ab.length.toString())};
this.iAf=function(ra,ab){X.ariaLiveNotifier.eLf(ab.description,ab.length)};this.ywf=function(){X.ariaLiveNotifier.sab(we.a.instance.ga(880),We.a.gZa)};this.rwf=function(){X.ariaLiveNotifier.readText(we.a.instance.ga(881))};this.uwf=function(){X.ariaLiveNotifier.readText(we.a.instance.ga(882))};this.$=F;this.ariaLiveNotifier=k;this.$.da.Ga(219,this);this.qwa=O.a.d5()}function Xa(k){return ej.call(this,k)||this}function yb(k,F,X){var ra=this;this.$=k;this.Ta=F;this.functionInfoManager=X;this.CDh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");
this.menuId=null;this.onFunctionInfoLoaded=function(){ra.menuId&&Array.contains(ra.CDh,ra.menuId)&&ra.frame.Lv(ra.menuId)};if(this.NV=O.a.NV(this.$))this.formulaAssistanceManager=this.$.da.za(464);this.LY={};this.frame=this.$.frame;this.functionInfoManager.vYa(this.onFunctionInfoLoaded);this.formulaAssistanceTelemetryManager=k.da.za(491)}function Ib(k,F){var X=Ji.call(this,k,we.a.instance.ga(1025),void 0,void 0,void 0,ve.EwaSettings.ma(398))||this;X.xJa=null;X.hja=null;X.wJa=null;X.nub=null;X.HUe=
null;X.gja=null;X.IUe=null;X.LUe=null;X.zkf=null;X.mub=null;X.Tid=!1;X.H1b=null;X.a6=null;X.Zwb=null;X.onFunctionInfoLoaded=function(){if(!X.wJa.count){for(var ra=X.functionInfoManager.ybd,ab=0,Qb=ra.length;ab<Qb;++ab)X.wJa.VL(ra[ab],ra[ab],!1).className=Ic.a.inh;X.wJa.selectedIndex=0;zg.a.Dc([X.H1b,X.a6,X.Zwb]);X.H1b=X.Ae.je(X.xJa);X.a6=X.Ae.je(X.hja);X.Zwb=X.Ae.je(X.mub);X.H1b.ka("change",X.Dwf);X.a6.ka("change",X.eJi);X.a6.ka("dblclick",X.fJi);X.Zwb.ka("click",X.tca);X.Zwb.ka("keyup",X.iLi);nf.DOMElementExtensions.setVisible(X.hja,
!0);nf.DOMElementExtensions.setVisible(X.HUe,!1);X.$.P4c&&nf.DOMElementExtensions.setVisible(X.zkf,!0)}X.Dwf(null);X.getButton(0).get_element().disabled=!1;X.xJa.disabled=!1;X.nRa();X.Tid=!0};X.tca=function(){X.Q$&&Ha(X.$,X.Q$.HelpId,X.Q$.IsDynamicUdf)};X.iLi=function(ra){13!==ra.keyCode&&32!==ra.keyCode||X.tca(ra)};X.Dwf=function(){var ra=X.functionInfoManager.Tac(X.wJa.ye.value);X.Sua(ra);X.hja.scrollTop=0;X.VXf()};X.eJi=function(){X.VXf()};X.fJi=function(ra){X.Q$&&(Ng.g(ra),X.close(0))};X.od=function(ra,
ab){Bd.b(ab)&&X.Ut()};X.functionInfoManager=k.da.za(19);X.formulaAssistanceControl=k.da.za(221);X.gbd=O.a.NV(X.$);X.gbd&&(X.formulaAssistanceManager=k.da.za(464));X.yIa=F;X.a_c=F.textBox.caretPosition;return X}function Qa(k){var F=Oc.call(this,k)||this;F.EUe=function(X,ra){if(1===X){F.hide();X=new jh.a(-433697611,0,F.$.Xc,8,null);var ab={};ra=(ab[Sf.a.kd]=ra.functionName,ab);F.$.Ka.Wb(X,ra)}};F.onFunctionInfoLoaded=function(){F.functionInfoManager.Zab(F.onFunctionInfoLoaded);F.x9e()};F.lvb=function(X){lb(F.$,
X,!1)};F.nef=function(X){return!F.functionInfoManager.kgc(X)};F.Jm=we.a.instance.ga(1025);F.functionInfoManager=k.da.za(19);F.Ug();return F}function cb(k){var F=ih.a.N_,X=k.da.za(368);X&&!ff.g(k).Bj&&(F=X.zoom);return F}function lb(k,F,X){if(X){if(F&&(!F||F.startsWith("http://")||F.startsWith("https://"))){if(k.ma(157)&&(k=k.da.za(269))&&k.sBa(F))return;Sc.HelperMethods.mf(F,"_blank",gd.a)}}else Sc.HelperMethods.D6(k.jG,"XLWAEndUser_"+F,k.LS)}function Ha(k,F,X){if(k){var ra=k.da.za(491);ra?ra.b$.argumentAssistanceLearnMoreCounter++:
Wd.ULS.sendTraceTag(523551513,0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager");X?lb(k,F,X):(X=new jh.a(-859308420,Sf.a.Sb,k.Xc,0,null),ra={},F=(ra[Sf.a.kd]=We.a.XQ,ra[Sf.a.pg]="HelpID="+F,ra),k.Ka.Wb(X,F))}}function $b(){}function Jb(k){var F=Jc.call(this)||this;F.$=k;F.Tb();return F}function kc(k){var F=ac.call(this,document.createElement("div"))||this;F.rR=!1;F.UQ=!1;F.X0b=!1;F.Qh=null;F.$h=null;F.mfi=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");
F.nfi=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");F.Aod=!1;F.rpd=!1;F.Cmd=!1;F.F5b=[];F.Sh=function(){F.n2f(!1)};F.COa=function(ra,ab){F.show(F.kR,!F.isListVisible,!0,mj.a.pp||3===ab.zb||3===Sf.a.Sb);F.mzd(null,null)};F.mzd=function(){F.gridView.setFocus()};F.nLa=function(){F.Ya.textBox.aK=!0};F.qt=function(){F.pcg()};F.onContentReady=function(){F.n2f(F.isListVisible)};F.Zc=function(){F.ay()};F.zya=function(){F.gRa()};F.Ivf=function(){F.pcg()};F.$=k;F.gridView=
ff.g(F.$);F.QI=F.gridView.pc;var X="<div id='dv_reader_description' class='"+ik.a.WMe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+Ub.wnh+" "+pb.a.$p+"'></div>\r\n<div id='dv_list_box' class='"+Ub.Dmh+" "+pb.a.Zo+" "+pb.a.$p+"'></div>\r\n<div id='dv_prompt_box' class='"+Ub.unh+" "+pb.a.$p+"'></div>";F.domElement.className=Ub.vnh;F.domElement.innerHTML=X;Vi.d(F.style,F.isGridRtl);F.dg=$get("dv_list_box",F.domElement);F.b0=$get("dv_prompt_box",F.domElement);F.Csa=$get("dv_list_button",
F.domElement);F.BBb=$get("dv_reader_description",F.domElement);(X=rk.a(k))&&F.F5b.push(new ma(k,X,F));F.F5b.push(new ma(k,F.gridView.pc,F));F.gridView.ha.oJ(F.Sh);F.gridView.Mt(F.onContentReady);F.gridView.tc.aEg(F.Ivf);F.$.cl(F.Zc);X=F.gridView.Lj;X.insertBefore(F.domElement,X.firstChild);F.onContentReady(null,null);k.da.Ga(14,F);return F}function uc(k,F,X,ra,ab,Qb,Fc,ld,ud,jd){var Ye=Uk.call(this,document.createElement("a"))||this;Ye.Cl=!1;Ye.xd=function(Bf){Ye.raiseEvent("ClickButton",Bf);return!0};
Ye.onKeyDown=function(Bf){Ye.raiseEvent("KeyDown",Bf);return!1};Ye.Lw=function(){Ye.hovered=!0;Ye.raiseEvent("PointerOver");return!1};Ye.HN=function(){Ye.hovered=!1;Ye.raiseEvent("PointerOut");return!1};Ye.onBlur=function(Bf){Ng.g(Bf);Ye.focused=!1;Ye.raiseEvent("Blur")};Ye.onFocus=function(Bf){Ng.g(Bf);Ye.focused=!0;Ye.raiseEvent("Focus")};Ye.Ejh=ld;Ye.Teh=ud;Ye.$I=uc.Cb(Ye.domElement,F,X,ra,ab,Qb,Fc,jd);Ye.Kc.ka("contextmenu",function(Bf){Ng.g(Bf)});Ye.enable();Ye.hovered=!1;Ye.focused=!1;k.appendChild(Ye.domElement);
return Ye}function hd(k,F,X){k=el.call(this,k,F,new ll.a(Ub.listItem,Ub.zBb,Ub.CBb,Ub.DBb))||this;k.qlb=null;k.ye=null;k.Dda=null;k.eW=null;k.XHa=null;k.vNa=0;k.nFb=[];k.qPj=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");k.BBb=X;return k}function ma(k,F,X){k=dl.call(this,k,F)||this;k.dataValidationControl=X;return k}function jb(k,F,X){var ra=Gk.call(this,k)||this;ra.FE=null;ra.cV=null;ra.xff=!1;ra.errorMessage=null;ra.S6e=null;ra.Hm=null;ra.$da=null;ra.vFe=
function(ab){var Qb=ra.$,Fc=ra.xff;ra.hide();var ld=ff.g(Qb);ld.isEditing&&ld.pc.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===ab&&Fc&&Ud.TaskExtensions.Ba(ld.startEdit(!1,1),function(){var jd=ld.pc.textBox;jd.text&&jd.selectRange(0,jd.text.length)},ra.la,11,qj.a.current);if(1===ab&&!Fc){if(Fc=ld.lc(null)){ld.Ea.MV();var ud=Object(na.a)(new pa.a,{Text:Fc.cell.userInput});ld.setCell(ud,Fc.range,0,63,null)}Qb.Ud(-798660877,Sf.a.Sb,8,null)}2===ab&&Ud.TaskExtensions.Ba(ld.startEdit(!1,
0),function(){var jd=ld.pc.textBox;jd.text&&jd.selectRange(0,jd.text.length)},ra.la,11,qj.a.current)};ra.r9a=function(){Sc.HelperMethods.D6(ra.$.jG,ra.error.HelpTopicId,ra.$.LS)};ra.ZKi=function(){ra.hxb();ra.$.Ud(802602464,2,8,ra.cV)};ra.wJi=function(){Wd.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};ra.xJi=function(ab){!ab||qc.a(ab)?Wd.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):
(ab=ra.lVh(ab.Result),ra.FE.errorInformation=ab,ra.Leb(ra.JIa,ra.Uvb(ra.vFe),ra.FE))};ra.Bzd=function(){ra.show(ra.ORb)};ra.ELe=X;ra.sqmManager=kl.a(ra.$);ra.error=jb.NQ(F,k,X);ra.Ab.Wp=ra;k=k.da.za(14);ra.Su=k.r3a(ra.ELe);ra.JIa=ra.Su&&ra.Su.JIa?ra.Su.JIa:we.a.instance.ga(1709);ra.Pnj();ra.initializeAndShow(ra.JIa,ra.vFe,ra.FE);return ra}function Zb(k,F,X){var ra=Sk.call(this,k,Zb.NQ(F,k,X))||this;ra.ld=function(){ra.setFocus()};ff.g(ra.$).ha.GG(ra.ld);(k=k.da.za(14).r3a(X))&&k.options&1&&Wd.ULS.sendTraceTag(537163291,
0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.");return ra}function Ub(){}function Qc(k){var F=Rk.call(this)||this;F.$=k;F.Tb();return F}function kd(k,F){var X=this;this.uZa=null;this.jAf=function(ra,ab){1<ab.length&&(ra=we.a.instance.ga(855),X.ariaLiveNotifier.eLf(ra,ab.length))};this.kAf=function(ra,ab){Wd.ULS.shipAssertTag(537167961,0,0<=ab.selectedIndex&&0<=ab.length&&ab.selectedIndex<ab.length,"Invalid ListEventArgs: SelectedIndex/Length");
Wd.ULS.shipAssertTag(537167960,0,!!ab.UF,"ListEventArgs: SelectedValue should not be null");X.ariaLiveNotifier.a4i(ab.UF,ab.selectedIndex+1,ab.length)};this.lAf=function(ra,ab){X.ariaLiveNotifier.GPa(ab.UF)};this.ariaLiveNotifier=k;ve.EwaSettings.Gl()||F.Ga(213,this)}function xb(k){var F=Kk.call(this)||this;F.$=k;F.Tb();return F}function bd(k){var F=jl.call(this)||this;F.$=k;F.Tb();return F}function Qd(k,F){var X=this;this.gNa=1;this.Ega=[];this.active=!1;this.Mw=function(){var ra=X.gridView.Fgd();
if(!(0>=ra||ra===X.gNa||X.gridView.lq)){for(var ab=!1,Qb=[],Fc=[],ld=X.Ega.length-1;0<=ld;ld--){var ud=X.Ega[ld];if(X.Egd(ud)>ra||ud.bottom<ra)Qb.push(ud),Array.removeAt(X.Ega,ld),ab=!0}for(ld=X.tableManager.rangeList.length-1;0<=ld;ld--){ud=X.tableManager.rangeList[ld];var jd=X.Egd(ud);jd<=ra&&ud.bottom>=ra&&!(jd<=X.gNa&&ud.bottom>=X.gNa)&&ud.dba&&(Fc.push(ud),ab=!0)}if(ab)for(ud=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?X.gridView.jpc:[X.gridView.l3],
ld=Gl(ud),ud=ld.next();!ud.done;ud=ld.next())for(jd=Gl(ud.value),ud=jd.next();!ud.done;ud=jd.next()){var Ye=Gl(ud.value);for(ud=Ye.next();!ud.done;ud=Ye.next()){for(var Bf=ud.value,Tg=Bf.Sn,$g=il.a(Bf.P4),Wg=Qb.length-1;0<=Wg;Wg--)ud=Qb[Wg],X.Zzc(ud,!1,$g,Tg)&&Array.removeAt(Qb,Wg);for(Wg=Fc.length-1;0<=Wg;Wg--)ud=Fc[Wg],X.Zzc(ud,!0,$g,Tg)&&X.Ega.push(ud);ab&&Bf.fOd($g)}}else Wd.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");
X.gNa=ra}};this.sxf=function(ra,ab){ab.isRow||ab.wVc(X.RKa)};this.txf=function(ra,ab){ab.isRow||(X.tableManager.rangeList.length||X.deactivate(),ab.eJd(X.RKa))};this.RKa=function(ra,ab){if(X.me())X.activate();else if(ra=X.active,X.deactivate(),!ra){Wd.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");return}(ab=ab.du)&&X.o4f(ab.Sn[0],ab.Sn[ab.Sn.length-1],ab.P4,ab.Sn)};this.dAf=function(ra,ab){!X.gridView.lq&&(X.me()?X.activate():
(ra=X.active,X.deactivate(),ra||Wd.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),ab=ab.du)&&(ra=il.a(ab.P4),X.o4f(ab.Sn[0],ab.Sn[ab.Sn.length-1],ra,ab.Sn)&&ab.fOd(ra))};this.Ge=function(){X.gridView.rb.N4?X.deactivate():X.activate()};this.tableManager=k;this.gridView=F;this.$=F.$;k.pne(this.dAf);F.wEg(this.sxf);F.xEg(this.txf);this.$.xa.og(this.Ge);this.$.Hb.og(this.Ge);this.Nqe(function(ra){ra.wVc(X.RKa)});this.me()&&(this.activate(),
this.Mw(this,null));this.$.da.Ga(68,this)}function zd(k){return Qk.call(this,k)||this}function Jd(k,F,X,ra,ab,Qb,Fc){var ld=this;this.$=k;this.gridView=F;this.Sg=X;this.yB=ra;this.borderFormatManager=ab;this.moreColorsHelper=Qb;this.Oad=Fc;this.QA=null;this.b_a=1461300262;this.sx=this.ZZa=this.x8a=this.k$b=null;this.ILi=function(ud,jd){if(!qc.a(ud)&&jd){var Ye=!!ud&&!!ud.RequestTelemetryData;ff.g(ld.$).Ii.qla(jd,ud.StateId,Ye?ud.RequestTelemetryData.EcsOperationDuration:0,Ye?ud.RequestTelemetryData.EcsRequestDuration:
0,Ye?ud.RequestTelemetryData.WfeRequestDuration:0)}};this.Wpb=function(){if(ld.gridView.Z5a){var ud=ld.$.da.za(254,!0);ud&&ud.Caj(ld.Wpb);ld.gridView.Z5a=!1;ld.gridView.ug.Jo(We.a.J4);ld.gridView.ha.QW(ld.dbd);ff.g(ld.$).$.Bf()}};this.dbd=function(){var ud=ld.k$b;ld.k$b=hi.d(ld.$.xa.qa);if(ud===ld.k$b)if(ld.gridView.ha.QW(ld.dbd),(ud=ld.$.da.za(254,!0))&&ud.uZc(36,ff.g(ld.$).ha.ta.selectedRanges)){ud=new jh.a(1804571062,2,2,0,null);var jd={};ld.$.Ka.Wb(ud,(jd[We.a.skipClipboardAccess]=!0,jd[We.a.X_c]=
!0,jd[We.a.isFormatPainter]=!0,jd)).continueWith(function(){ld.Wpb()})}else ld.gridView.ug.SG(!1)};this.Gb=ve.EwaSettings.Gb();this.Ykc=new gc(this.$,X);this.TC=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Om=ve.EwaSettings.Om();this.iu=O.a.iu()}function gc(k,F){this.$=k;this.Sg=F;this.Bx=new he(ff.g(this.$).Ea,this.$);this.aff=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5412627_MergeCellRangeBorderScenariosTelemetry");this.wyb=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");
this.Fod=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");this.Hgc=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.Ycf=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.bfi=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.Zgf=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",
!1);this.thc=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");this.pzb=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.Igc=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1);this.nii=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix");this.ifi=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6350260_MergeCellCSEDataLossScenarioUnmergeConditionFix");
this.Xaf=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6209366_MergeCellCSECellFormatAssertFix")}function Hc(){this.scenario=0;this.GQ=null}function Tc(){this.AQa=this.sGa=this.nNa=this.ZSa=0}function Md(k,F,X,ra){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=k;this.targetSheetRange=F;this.fillRangeType=X;this.fillRangeDirection=ra}function Xc(k,F,X){var ra=cl.call(this,k)||this;ra.Jm=null;ra.W5c=0;ra.Dai=function(ab,Qb){if(0===
ab)Wd.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");else{ab={};var Fc="",ld=1035996630;switch(Qb.selectedKey){case 0:Fc=1896159024===ra.Br?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:Fc=1896159024===ra.Br?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===ra.Br?(Fc="InsertRows",ld=-1113896058):(Fc="DeleteRows",ld=1554436520);break;case 3:1896159024===ra.Br?(Fc="InsertColumns",ld=1415868706):(Fc="DeleteColumns",
ld=674605324)}Wd.ULS.sendTraceTag(574993490,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:{0}",Fc);Qb=new jh.a(ld,1,2,8,null);ab[Sf.a.kd]=Fc;ra.$.Ka.Wb(Qb,ab)}};ra.Br=F;ra.selectedRanges=X;k=Object(ca.a)(mf.a,ra.$.xa.qa);ra.isRtl=k.displayRtl;return ra}function Cd(k,F,X,ra,ab,Qb){var Fc=this;this.F_d=!1;this.G_d=null;this.xDc=0;this.jj=null;this._state=0;this.moveNext=function(){try{for(Fc._state=1;1===Fc._state;)Fc.Ju=Fc.Ju()}catch(ld){Fc.dispose(),
Fc._state=3}};this.Cf=k;this.dCa=F;this.cCa=this.t_d=ab;this.jPb=Qb;this.Ju=this.tL;this.moveNext()}function Sb(k,F,X,ra,ab,Qb,Fc,ld){var ud=this;this.uDc=0;this.I_d=this.yDc=!1;this.jj=this.K_d=null;this._state=0;this.moveNext=function(){try{for(ud._state=1;1===ud._state;)ud.Ju=ud.Ju()}catch(jd){ud.dispose(),ud._state=3}};this.Cf=k;this.dCa=F;this.igg=ab;this.cCa=this.t_d=Qb;this.jPb=Fc;this.s_d=ld;this.Ju=this.tL;this.moveNext()}function Mc(k,F,X,ra,ab){this.STe=0;this.Zng=k;this.$ng=F;this.lwg=
X;this.GWb=ra;this.STe=void 0===ab?0:ab}function md(k){var F=this;this.menuId=null;this.$tb=0;this.hzi="+mn-lt";this.nwi="+mj-lt";this.nOi=function(X){F.Qef=!0;F.BSg=null;F.$.LC(function(ra){ra.mPa("FontName_New")});Wd.ULS.sendTraceTag(537159511,1,15,String.format("PreviewFont Status is {0}",X))};this.WIi=function(X,ra,ab){Wd.ULS.sendTraceTag(524042310,1,50,"FontDropdownHelper.onFontPreviewRequestComplete: Attempt to request FontUrl method: {0} has succeeded.",ab);F.bZi(X);F.$tb=2;F.xMf()};this.XIi=
function(X,ra,ab){Wd.ULS.sendTraceTag(524042309,1,10,"FontDropdownHelper.onFontPreviewRequestFailed: Encountered errors for {0}.",ab);F.$tb=3;F.xMf()};this.$=k;this.frame=this.$.frame;this.Qdi=!!String.fromCodePoint&&!mj.a.Of&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.Qef=!1;this.BSg=null;this.Om=ve.EwaSettings.Om();(this.iu=O.a.iu())&&this.Ldj()}function wc(k){this.Yu=k}function ed(){}function Nd(k){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=
k}function pe(k){var F=pk.call(this)||this;F.$=k;F.Tb();return F}function Ec(k){return Gh.call(this,k)||this}function rd(k,F){var X=this;this.s$b=this.gFd=null;this.zwf=function(){ve.EwaSettings.ma(662)||X.Btc();if(X.s$b){var ra=hk.a(Vh.a.Ua.oe,X.s$b);Wd.ULS.sendTraceTag(570949840,5,50,"FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: {0}",ra);X.s$b=null}X.aEf()};this.$=k;this.gridView=ff.g(k);this.qF=F.qrb(this.$.domElement,500,
null,null);this.GKa=this.FKa=-1}function Dd(k){this.freezeOptions=null;this.freezeOptions=k}function wb(){}function lf(k){var F=li.call(this)||this;F.cjj="formulaAssistance";F.$=k;F.Tb();return F}function qf(){this.isFeedbackAllowed=!1;this.zoomLevel=0}function Cf(k){var F=Dk.call(this)||this;F.$=k;F.Tb();return F}function Fe(k){var F=this;this.Bx=this.calcManager=this.vz=this.cSa=null;this.YIi=function(X,ra){if(X&&!qc.a(X)&&ra){var ab=!!X&&!!X.RequestTelemetryData;ff.g(F.$).Ii.qla(ra.toString(),
X.StateId,ab?X.RequestTelemetryData.EcsOperationDuration:0,ab?X.RequestTelemetryData.EcsRequestDuration:0,ab?X.RequestTelemetryData.WfeRequestDuration:0)}};this.$=k;this.$.da.$a(268,function(X){F.vz=X});this.lCh=new Id(ff.g(this.$).Ea,this.$);this.Y2=new ne(this.$,ff.g(this.$),this);this.$.da.$a(266,function(X){F.calcManager=X});this.Gb=ve.EwaSettings.Gb();this.Om=ve.EwaSettings.Om();this.mAb=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.erd=
ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.$6a=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);this.Bni=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}function Ke(k,F){this.success=k;this.pz=F}function $d(){this.oeg=this.ZUj=!1;this.source=0;this.lwa=this.phc=!1}function Id(k,F){this.Bx=null;this.Ea=k;this.r2a=F}function he(k,F){this.Ea=k;this.r2a=F}
function Af(k,F,X){this.success=k;this.amc=void 0===F?null:F;this.reason=void 0===X?"":X}function ne(k,F,X){var ra=this;this.Zca=[];this.calcManager=this.Yyc=this.lastSetCellInstantaneousOperation=null;this.$=k;this.grid=F;this.Sg=X;this.Tca=ne.cGe;this.$.da.$a(268,function(ab){ra.Yyc=ab});this.$.da.$a(266,function(ab){ra.calcManager=ab});this.mAb=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.erd=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");
this.Ani=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}function Te(k,F,X,ra){this.rangeDelta=k;this.stateId=F;this.isFinished=X;this.priorityGroup=ra}function Ac(k,F,X,ra,ab,Qb,Fc,ld,ud,jd,Ye,Bf,Tg,$g,Wg,qh,Ri,ci,Tf,ph,ei,Rh,Li,ij,aj){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=
this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=
this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=void 0===k?0:k;this.numberOfNonUpdatedCells=void 0===F?0:F;this.numberOfUpdatedCells=void 0===X?0:X;this.numberOfCellsUpdatedAlreadyByServer=void 0===ra?0:ra;this.numberOfCellsSkippedDueToTimeout=void 0===ab?0:ab;this.numberOfCellsWithNoFormattedCell=void 0===Qb?0:Qb;this.numberOfUnsupportedErrorCellTypes=void 0===Fc?0:Fc;this.numberOfUnsupportedBlankCellTypes=void 0===ld?0:ld;this.numberOfUnsupportedRichCellTypes=
void 0===ud?0:ud;this.numberOfSkippedCellsDueToMissingLocaleInfo=void 0===jd?0:jd;this.totalExecutionTime=void 0===Ye?0:Ye;this.originalProcessingTimeLimit=void 0===Bf?0:Bf;this.newProcessingTimeLimit=void 0===Tg?0:Tg;this.numberOfEditedRecalcedCellsInBatch=void 0===$g?0:$g;this.numberOfDependentRecalcedCellsInBatch=void 0===Wg?0:Wg;this.isNewTask=void 0===qh?!1:qh;this.lastSetCellInstantaneousOperation=void 0===Ri?"":Ri;this.taskId=void 0===ci?0:ci;this.isNewNumberFormatter=void 0===Tf?null:Tf;this.numberOfRecalcedCellsWithFormattedValue=
void 0===ph?null:ph;this.numberOfRecalcedCellsWithoutFormattedValue=void 0===ei?null:ei;this.totalNumberFormatterTime=void 0===Rh?null:Rh;this.newNumberFormatterFinalizeFailures=void 0===Li?null:Li;this.numberOfMeasureTextWidthCalls=void 0===ij?null:ij;this.numberOfHashFormattedValues=void 0===aj?null:aj}function Kd(){}function ce(k,F,X,ra,ab){this.hM=void 0===k?0:k;this.cellValue=void 0===F?"":F;this.ifmt=void 0===X?0:X;this.priorityGroup=void 0===ra?"":ra;this.pz=void 0===ab?"":ab}function sd(k){k=
Ge(k);if(0===k)return 1;if(1===k)return 2;Wd.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0}function Ge(k){if(k.priorityGroup===Wf.editCell)return 0;if(k.priorityGroup===Wf.dependentCell)return 1;Wd.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2}function kf(k,F){var X=Ge(F),ra=!(void 0===F.rangeDelta.data.format||null===F.rangeDelta.data.format);Wd.ULS.shipAssertTag(537162187,
0,0===X||!ra,"CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only {0}",F.priorityGroup);k=Math.max(k.cell.il,0);ra&&(ra=excelOnlineCalc.calc.getCellFormatKind(F.rangeDelta.data.format.format),"number"===ra?k=F.rangeDelta.data.format.format:"string"===ra?Wd.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===ra?Wd.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):
Wd.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return k}function Ze(k){var F=k.value;switch(k.type){case 2:return void 0===F||null===F?"":F;case 1:return k=parseFloat(F),isNaN(k)?null:k;case 3:return k=parseFloat(F),isNaN(k)?null:1===k;case 4:return k=parseFloat(F),isNaN(k)?null:excelOnlineCalc.calc.errorValue(k);default:return excelOnlineCalc.calc.blankValue}}function je(k){k=excelOnlineCalc.calc.getCellValueKind(k.rangeDelta.data.value);
var F=0;switch(k){case "number":F=1;break;case "string":F=2;break;case "boolean":F=3;break;case "Error":F=4;break;case "Blank":F=0;break;default:Wd.ULS.shipAssertTag(537162191,0,!1,"CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type {0}",k)}return F}function dg(k,F){k=excelOnlineCalc.calc.getCellValueKind(k.rangeDelta.data.value);switch(k){case "number":case "string":case "boolean":return!0;case "Blank":if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5477761_Calc_BlankCellValueTypeSupported"))return!0;
F.numberOfUnsupportedBlankCellTypes++;return!1;case "Error":if(ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",!1))return!0;F.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return F.numberOfUnsupportedRichCellTypes++,!1;default:return Wd.ULS.shipAssertTag(537162192,0,!1,"CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type {0}",k),!1}}function Zd(k){if(k=k.color){if("String"===Object.getType(k).getName())return Zg.a.cp(k);if("Number"===
Object.getType(k).getName())return null}else return null;Wd.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null}function of(k){switch(k.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;default:return Wd.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}}function Wf(){}function $f(k,F,X,ra,ab,Qb,Fc,ld,ud,jd,Ye,Bf,Tg){Bf=void 0===
Bf?null:Bf;Tg=void 0===Tg?null:Tg;ld=rg.call(this,11,0,ld,Ye)||this;ld.kCh=k;ld.cbd=F;ld.format=ra;ld.activeCell=X;ld.Hqe=ab;ld.UFf=Qb;ld.PFf=Fc;ld.$Ea=ud;ld.clientCorrelationId=jd;ld.Llb=Bf;ld.cib=Tg;return ld}function mg(){}function Qf(k){var F=K.call(this)||this;F.nSb=null;F.$=k;F.Tb();return F}function lc(k){var F=ek.call(this)||this;F.FHf=0;F.bH=null;F.iZg=function(X,ra){if(1===X&&F.bH.FileCollectionErrorStateId){X=F.$.na.va;var ab=F.bH.MessageId,Qb=F.bH.OriginalEcsServerId,Fc=F.bH.FileCollectionErrorStateId,
ld=X.Na(0);ld.errorMessageId=ab;ld.ecsServerId=Qb;ld.fileCollectionErrorStateId=Fc;ld.userComment=ra;X.oZc("CollectFile",ld,null,null,null,null,0)}F.raiseEvent("fileCollectionComplete",null,F)};F.$=k;return F}function Kc(k){var F=Si.call(this,!1,!1,Kc.Au)||this;F.Iud=!1;F.Knf=!0;F.Umf=0;F.ic=1;F.Ac(1,CommonUIStrings.l_Send);F.Ac(0,CommonUIStrings.l_NoThanks);F.hg=Fd.Rhg;F.Nmf=k;F.Ne=Kc.cSg;return F}function Fd(){}function re(k){return Nk.call(this,k)||this}function ke(){}function nd(k,F,X,ra){var ab=
Bj.call(this,k)||this;ab.VCb=null;ab.alc=null;ab.Jec=null;ab.r3=null;ab.ska=!1;ab.disposed=!1;ab.RMa=!1;ab.kh=null;ab.lzd=function(Qb){Wd.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");if(ab.disposed)Wd.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(qc.a(Qb)){Wd.ULS.sendTraceTag(537163267,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",
Qb?Vf.a.Tc(Qb.Errors):null);if(Qb.Errors&&1===Qb.Errors.length){var Fc=Qb.Errors[0].MessageId,ld=ab.gdd(Fc);if(ld){ab.Fwj(Fc)?ab.Trj(ld):ab.Cr(ld);ab.fla("OkInvalidByServer",Qb.Errors[0].MessageIdName);return}}Wd.ULS.sendTraceTag(537163266,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",Vf.a.Tc(Qb.Errors))}ab.fla("OkValid","None");ab.hide()}};ab.Q4c=function(Qb){ab.VW(Qb);2!==Qb&&(ab.kh=ab.$.Pb.Gc("UserAction","DataValidationEditTimeToDialogTryClose"));
1===Qb?ab.I9a():2===Qb?ab.jya():ab.Tla()};ab.uca=function(){ab.NOj();ab.RMa?ab.nye():ab.Y_c();return ab.ska=!1};ab.selectedRanges=F;ab.NRb=X;ab.command=ra;3===ra&&(ab.ska=!0);ab.ic=2;ab.Sv=!1;ab.hg=xd.hg;return ab}function dc(k,F){this.options=this.cellRange=null;this.cellRange=k;this.options=F}function Xd(k,F){var X=nk.call(this,k)||this;X.P9=null;X.pha=null;X.VTa=null;X.R9=null;X.Q9=null;X.nnc=function(){X.P9.checked?(X.pha.disabled=!1,X.VTa.disabled=!1,X.R9.disabled=!1,X.Q9.disabled=!1):(X.pha.disabled=
!0,X.VTa.disabled=!0,X.R9.disabled=!0,X.Q9.disabled=!0);return!1};X.get_visible=X.Kja;X.set_visible=X.Kna;X.Ck=F;X.eka();return X}function sa(k,F){var X=Pi.call(this,k)||this;X.kba=null;X.g$e=null;X.mba=null;X.lba=null;X.onc=function(){X.kba.checked?(X.mba.disabled=!1,X.lba.disabled=!1):(X.mba.disabled=!0,X.lba.disabled=!0);return!1};X.get_visible=X.Kja;X.set_visible=X.Kna;X.Ck=F;X.eka();return X}function ob(){}function Wb(k,F,X,ra){var ab=zi.call(this,k)||this;ab.Itb=null;ab.uMd=null;ab.ska=!1;ab.disposed=
!1;ab.RMa=!1;ab.kh=null;ab.wTj=function(Qb,Fc){ab.Eac(Qb);var ld=ab.$Yd();Qb=ld.errorString;var ud=ld.Eq;if(ld.returnValue)return ab.ALa(121,ab.lLh(ab.$,Fc),0,ab.o5,!1),"";ab.fla("OkInvalidByClient",ud);return Qb};ab.Q4c=function(Qb){ab.VW(Qb);ab.kh=ab.$.Pb.Gc("UserAction","DataValidationEditTimeToDialogTryClose");0===Qb&&ab.Tla()};ab.selectedRanges=F;ab.NRb=X;ab.command=ra;3===ra&&(ab.ska=!0);ab.ic=2;ab.Sv=!1;return ab}function hc(k,F,X,ra,ab,Qb,Fc,ld){ld=k.Na(9,void 0===ld?null:ld);ld.selectedRanges=
F;ld.ruleOptions=X;return Yg.i(k,"CreateOrEditDataValidation",ld,ra,ab,Qb,Fc,0)}function pc(k,F,X){var ra=$h.call(this,F)||this;ra.ewa=null;ra.kec=null;ra.cU=null;ra.zK=null;ra.Hya=null;ra.Iya=null;ra.k5a=null;ra.uNa=null;ra.b$a=null;ra.UOa=null;ra.Soc=null;ra.RBd=null;ra.EAh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];ra.Jjj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,1],[12,12]];ra.mnc=
function(ab){var Qb=!1;(null===ab||void 0===ab?0:ab.Ca)&&(ab.Ca.keyCode===ec.a.Soa||ab.Ca.keyCode===ec.a.ei)&&(Qb=ra.uca(ab),ra.cU.blur(),ra.zK.blur());return Qb};ra.uca=function(){var ab=ra.cU.selectedIndex,Qb=ra.zK.selectedIndex;ra.Soc.innerText=ra.avb(ab,Qb);ra.RBd.innerText=ra.Sfd(ab,Qb);switch(ab){case 0:return ra.zK.disabled=!0,nf.DOMElementExtensions.setVisible(ra.b$a,!1),nf.DOMElementExtensions.setVisible(ra.UOa,!1),nf.DOMElementExtensions.setVisible(ra.k5a,!1),nf.DOMElementExtensions.setVisible(ra.uNa,
!1),ra.ewa.disabled=!0,!1;case 3:return ra.zK.disabled=!0,nf.DOMElementExtensions.setVisible(ra.b$a,!0),nf.DOMElementExtensions.setVisible(ra.UOa,!1),nf.DOMElementExtensions.setVisible(ra.k5a,!0),nf.DOMElementExtensions.setVisible(ra.uNa,!0),ra.ewa.disabled=!1;case 7:return ra.zK.disabled=!0,nf.DOMElementExtensions.setVisible(ra.b$a,!0),nf.DOMElementExtensions.setVisible(ra.UOa,!1),nf.DOMElementExtensions.setVisible(ra.k5a,!1),nf.DOMElementExtensions.setVisible(ra.uNa,!1),ra.ewa.disabled=!1;default:ra.ewa.disabled=
!1,nf.DOMElementExtensions.setVisible(ra.b$a,!0),nf.DOMElementExtensions.setVisible(ra.uNa,!1)}switch(Qb){case 0:case 1:nf.DOMElementExtensions.setVisible(ra.UOa,!0);break;default:nf.DOMElementExtensions.setVisible(ra.UOa,!1)}ra.zK.disabled=!1;ra.Soc.disabled=!1;nf.DOMElementExtensions.setVisible(ra.k5a,!1);nf.DOMElementExtensions.setVisible(ra.uNa,!1);return!1};ra.get_visible=ra.Kja;ra.set_visible=ra.Kna;ra.pR=new Ka.a;ra.pR.add(we.a.instance.ga(1649));ra.pR.add(we.a.instance.ga(1650));ra.pR.add(we.a.instance.ga(1653));
ra.pR.add(we.a.instance.ga(1651));ra.pR.add(we.a.instance.ga(1652));ra.pR.add(we.a.instance.ga(1654));ra.pR.add(we.a.instance.ga(1655));ra.pR.add(we.a.instance.ga(1656));ra.pR.add(we.a.instance.ga(1657));ra.pR.add(we.a.instance.ga(1658));ra.pR.add(we.a.instance.ga(1659));ra.pR.add(we.a.instance.ga(1660));ra.pR.add("");ra.$=k;ra.Ck=X;ra.eka();return ra}function xd(){}function Gd(k,F){var X=this;this.LB=this.S0a=this.selectedRanges=null;this.iJe=!1;this.kh=null;this.vJi=function(ra){Wd.ULS.sendTraceTag(537163284,
0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!ra||qc.a(ra)?Wd.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):(X.S0a=ra.Result,X.tZi())};this.Gwh=function(ra){X.VW("DataValidationEdit.ExpandExisitngDialog",ra);X.LB.c=Gd.lia(ra);1===ra?X.xHa(new te(X.S0a)):2===ra?X.xHa(new te):X.amf()};this.sUi=function(ra){X.VW("DataValidationEdit.OverrideExisitngDialog",ra);
X.LB.c=Gd.lia(ra);1===ra?X.xHa(new te):X.amf()};this.$=k;this.R4c=F}function te(k){this.k5=(k=void 0===k?null:k)?k.IsIgnoreBlank:!0;this.l5=k?k.IsInCellDropDown:!0;this.ON=k?k.LowerBoundary:"";this.PN=k?k.UpperBoundary:"";this.BB=k?k.ConditionType:0;this.ruleType=k?k.RuleType:0;this.ZZ=k?k.IsAlertBlocking:!0;this.bU=k?k.AlertTitle:"";this.aU=k?k.AlertMessage:"";this.IV=k?k.InputMessage:"";this.dF=k?k.InputTitle:"";this.w5=k?k.IsShowErrorAlert:!0;this.x5=k?k.IsShowInputMessage:!0}function Sd(k){switch(k){case 0:k=
"AnyValue";break;case 1:k="WholeNumber";break;case 2:k="Decimal";break;case 3:k="List";break;case 4:k="Date";break;case 5:k="Time";break;case 6:k="TextLength";break;case 7:k="Custom";break;default:k="Unknown"}return k}function If(k){switch(k){case 0:k="Between";break;case 1:k="NotBetween";break;case 2:k="Equal";break;case 3:k="NotEqual";break;case 4:k="GreaterThan";break;case 5:k="LessThan";break;case 6:k="GreaterThanOrEqual";break;case 7:k="LessThanOrEqual";break;default:k="Unknown"}return k}function pf(k){var F=
yj.call(this)||this;F.$=k;F.Tb();return F}function Ef(k,F,X){var ra=this;this.Xxc={};this.Pd=!1;this.Ql=function(ab,Qb){ra.showContextMenu(void 0===Qb?null:Qb)};this.Wuf=function(ab,Qb){Qb.zyi===Ef.N_h&&ff.g(ra.$).focus()};this.uN=function(ab,Qb){ab=ra.$.Ka.Jaa(Qb.Sd.command);(null===ab||void 0===ab?0:ab.dismissesContextualUI)&&ra.L3()};this.j6=function(){ra.$.da.QU(342);Ud.TaskExtensions.Ba(eh.GetServiceTaskFactory.create(ra.$.da,338,ra.$.la,3),function(ab){ab=ab.result;for(var Qb=Gl(ra.Xxc),Fc=
Qb.next();!Fc.done;Fc=Qb.next())Fc.value.WMf(ab)},ra.$.la)};this.$=k;this.contextMenuController=X;this.Q5d=new pg(this.$);k.da.Ga(8,this);for(X=0;X<F.length;X++)this.Xxc[Ef.L1g[X]]=F[X];this.ha=ff.g(k).ha;this.ha.ZYb(this.Ql);this.$.Ka.zYa(this.Wuf);Qj.a.instance.jrj();ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka.Wra(this.uN);ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.E2(this.j6)}
function pg(k){this.dSe=null;this.$=k;this.u8a=new Lg;ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.dSe=new Ag(this.$))}function Ag(k){var F=this;this.vZa=null;this.xQd=!1;this.qBb=0;this.w8c=1;this.SLe=0;this.jEb=function(X){F.uJf(X.domElement,X.hashCode)};this.kNf=function(X){for(var ra=0;window.performance.now()-X<F.vlh&&0<F.vZa.length;)F.rle(F.vZa.shift()),ra++;Wd.ULS.sendTraceTag(537167052,
1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: {0}, Events Registered in this frame: {1}, Events in queue: {2}",F.w8c,ra,F.vZa.length);0<F.vZa.length?F.qBb=window.requestAnimationFrame(F.kNf):(Wd.ULS.sendTraceTag(537167051,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: {0}, Total time in MS: {1}",F.w8c,window.performance.now()-F.SLe),F.w8c++,F.qBb=0)};this.onPointerDown=function(X){Pg.a.slim(X.Ca.rawEvent);return!1};this.$=k;this.gridView=
ff.g(this.$);this.Y7h();this.vlh=this.$.ya.AutoFilterEventRegistrationTimeLimit}function Nf(){this.$d=this.qse=this.cell=null}function Lg(){this.qdc={}}function Mg(){this.menuModel=null;this.GEe=0}function Hg(){this.dictionary=this.Sd=null}function nh(k){var F=zj.call(this)||this;F.w9e=!1;F.Xkd=function(){var X;(X=F.$.da.za(342))?F.Eb(X):F.$.LC(function(ra){ra.tec().then(function(ab){(X=F.$.da.za(342))?F.Eb(X):(X=new Ae(F.$,ab),F.Eb(F.$.da.Ga(342,X)))})})};F.$=k;F.Tb();return F}function Ae(k,F){this.Iqb=
F;this.$=k}function Dg(k){return Fg.call(this,k)||this}function Jf(k,F,X,ra){k=Bh.call(this,k,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,Jf.zHj,!0,!1,Jf.PIb,F,X,!1,ra)||this;k.I0a=0;k.Nsa=null;k.eKa=null;k.BJe=null;return k}function fg(k,F,X){this.type=k;this.G1g=F;this.Br=X}function Jg(k,F,X,ra){return di.call(this,k,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",F,X,!0,ra)||this}function Og(k,F,X,ra){k=qg.call(this,k,"PopulateSheetOpsContextMenu",
274207288,-1497523576,bg,!0,!1,"SheetTabContextMenuRootName",F,X,!1,ra)||this;k.qgc=!1;k.Thc=!1;return k}function ef(k,F,X,ra){F=Td.call(this,k,"PopulateRichTextContextMenu",679816325,1151222423,Uc,!0,!1,Uc,F,X,!0,ra)||this;F.grid=ff.g(k);return F}function ng(k,F,X,ra){F=vb.call(this,k,"PopulateTableFieldListContextMenu",-751848458,-1085236154,rc,!0,!1,"TableFieldListContextMenuRoot",F,X,!1,ra)||this;F.d5b=null;F.Yxd=0;F.tEa=null;F.grid=ff.g(k);return F}function Xb(){}function da(k,F,X,ra){var ab=
T.call(this,k,"PopulatePivotTableContextMenu",-1475408662,1114549926,fe,!0,!1,"PivotTableContextMenuRootName",F,X,!0,ra)||this;ab.Fc=null;ab.activeCell=null;ab.SZd=null;ab.gic=!1;ab.Nnd=!1;ab.expandCollapse=!1;ab.refresh=!1;ab.pZ=!1;ab.$f=null;ab.bA=null;ab.l0a=null;ab.Fb=null;ab.N$a=null;ab.Cba=!1;ab.pKi=function(Qb){Qb&&!Vf.a.oh(Qb.Errors)&&ab.Fc&&(ab.Fc.To=Qb.Result,ab.dKb());ab.showPivotTableContextMenu()};ab.oKi=function(){};ab.$Ni=function(){ab.wbb()};ab.ZNi=function(){ab.wbb()};ab.TEi=function(){ab.wbb()};
ab.SEi=function(){ab.wbb()};ab.sy=function(){ab.nXd();ab.Cba=!1};ab.Tq=function(){if(ab.Cba){Wd.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");var Qb=ab.Fc;ab.grid.Nb.gp(ab.grid.ha.ta.activeCell)!==Qb&&(ab.wbb(),ab.b5h())}};ab.Ogh=new DOMParser;ab.quj=!0;ab.grid=ff.g(k);ab.Skc=!0;return ab}function Aa(k,F,X,ra){return le.call(this,k,"PopulatePivotContextMenu",2123758504,912277356,F,X,ra)||this}function qb(k,
F,X,ra){k=ze.call(this,k,"PopulateFieldWellContextMenu",1374696078,495005930,cf,!0,!1,cf,F,X,!1,ra)||this;k.cell=null;k.uo=null;k.Go=null;k.externalSourceIndex=-1;k.l_d=-1;k.lSa=0;k.jyc=-1;k.qL=null;k.isOlap=!1;k.VV=!1;k.t2a=!1;return k}function jc(k,F,X,ra,ab,Qb,Fc,ld,ud){var jd=xe.call(this,ab,we.a.instance.Bb(61),!0,2,!0)||this;jd.T1f=!0;jd.zie=null;jd.ZRa=null;jd.Ofa=null;jd.Jrb=null;jd.M4c=null;jd.ARc=null;jd.NEi=function(Ye){Bg.a.any(Ye.Errors,function(Bf){return-103190598===Bf.MessageId})&&
jd.ESa.Efj()};jd.XKi=function(Ye){Ye&&!qc.a(Ye)&&(Ye=Ye.Result,jd.M4c.innerHTML=we.a.instance.ga(1076)+wg.a.vg(Ye.ValueFieldSourceName),jd.isOlap&&!jd.VV?(jd.ESa.enabled=!1,jd.Ofa.activeTab=jd.Ofa.gzc-1):(jd.ESa.enabled=!0,jd.Ofa.activeTab=0),jd.ESa.cqj(Ye.PivotValueFieldSettingsSummarizeValueByInfo),jd.ZRa.dqj(Ye.PivotValueFieldShowValueAsInitialInfo),jd.Af())};jd.cell=k;jd.Go=F;jd.externalSourceIndex=X;jd.jeg=ra;jd.Sd=Qb;jd.$ha=Fc;jd.isOlap=ld;jd.VV=ud;return jd}function id(k,F,X){X=void 0===X?
null:X;this.Olb=this.Wlb=null;this.p1=-1;this.gk=k;this.rga=(void 0===F?null:F)||new Ka.a;this.ywg=X||new Ce;this.REa=new Ka.a;k=0;F=Gl(this.rga);for(X=F.next();!X.done;X=F.next()){X=X.value;this.Tqd(this.p1)||(this.p1=k);var ra=k++;this.REa.add(new Gc(document.createElement("li"),X.title,this.A5g(ra)))}}function Gc(k,F,X){this.gk=k;this.Qp=F;this.iGc=X;this.Cfa=document.createElement("a");yd.a.Rvc(this.Cfa,this.Qp);Sys.UI.DomElement.addCssClass(this.Cfa,Rd.DFj);Sys.UI.DomElement.addCssClass(this.gk,
Rd.CFj);this.gk.appendChild(this.Cfa);this.Cfa.tabIndex=0;this.fBc();rb.a.addHandler(this.gk,"click",this.iGc);rb.a.addHandler(this.gk,"keyup",Object(Df.a)(this,this.Q9a,"onTitleKeyUp"))}function Rd(){}function Ce(){}function Re(k){k=Pj.call(this,k)||this;k.$ce=null;k.get_visible=k.Kja;k.set_visible=k.Kna;k.eka();return k}function Pf(){}function Le(k,F,X,ra,ab,Qb,Fc,ld){var ud=Oi.call(this,k)||this;ud.qF=null;ud.D5b=null;ud.r0b=null;ud.G1d=null;ud.H1d=null;ud.Y3d=null;ud.cvf=function(){var jd=parseInt(ud.G3.ye.value,
10);ud.STg(jd)?(ud.iU.$n.disabled=!0,ud.JP.$n.disabled=!0,ud.JP.clear(),Le.Jaf(jd)?(ud.iU.$n.disabled=!1,ud.NNb(!0)):Le.Kaf(jd)?(ud.iU.$n.disabled=!1,ud.JP.$n.disabled=!1,ud.NNb(!0),ud.akf()):ud.NNb(!1)):(jd=Vf.a.gd(1,0,0,1106,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),Uh.a(ud.$).Cr([jd]),ud.G3.Ifj())};ud.YEi=function(){0>ud.iU.selectedIndex||ud.JP.$n.disabled||(ud.NNb(!0),ud.akf())};ud.YKi=function(jd){ud.qF.Adb();ud.JP.$n.style.overflowY="scroll";if(jd&&!qc.a(jd)){jd=jd.Result;ud.JP.clear();
for(var Ye=Gl(jd.BaseItems),Bf=Ye.next();!Bf.done;Bf=Ye.next())Bf=Bf.value,ud.JP.VL(Bf.DisplayString,Bf.Id.toString(),Bf.Id===jd.SelectedBaseItem);ud.NNb(!1)}};ud.get_visible=ud.Kja;ud.set_visible=ud.Kna;ud.$=F;ud.cell=X;ud.Go=ra;ud.externalSourceIndex=ab;ud.Sd=Qb;ud.$ha=Fc;ud.Gii=ld;ud.yQj=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");ud.eka();return ud}function kg(){}function vg(k,F,X,ra,ab){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=
null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=k;this.activeCell=F;this.pivotFieldTitle=X;this.summarizeBy=ra;this.showAsValueParameters=ab}function gg(k,F,X){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=k;this.baseFieldIndex=F;this.baseItemIndex=X}function Bc(){}function od(){}function td(k,F,X,ra){return le.call(this,k,"PopulateFieldListPivotMenu",-1793121409,1378457149,F,X,ra,fi)||this}function le(k,F,X,ra,ab,Qb,Fc,ld){ld=void 0===ld?
Ui:ld;var ud=Zh.call(this,k,F,X,ra,ld,!0,!1,"PivotFilterMenuRootName",ab,Qb,!1,Fc)||this;ud.Z4b=null;ud.tif=null;ud.jmb=null;ud.pivotData=null;ud.iyd=null;ud.imc=null;ud.yDb=0;ud.X1b=0;ud.AY=0;ud.wrb=null;ud.dKi=function(jd,Ye){if(Ye)if(qc.a(jd))ud.kvd(Ye,!1);else if(jd=jd.Result){ud.hsb=Pe.Jed(Ye,ud.$,ud.pivotData.cell,ud.AY);var Bf=ud.Yof(jd.MenuModel.Sections);ud.wrb=Bf;le.jN.set(ud.pivotData.cell,Ye,Bf,ud.AY);uj.a(ud.$).TDj(jd);ud.kvd(Ye,!0)}};ud.cKi=function(jd,Ye){ud.kvd(Ye,!1)};ud.yf=function(jd,
Ye){le.jN.k7b(Ye.nd.hash)};ud.Sm=function(jd,Ye){le.jN.k7b(Ye.nd.hash)};ud.Yca=null;ud.jyd=ud.yDb=-1;ud.Wwe=ud.X1b=-1;ud.Zoe=ud.AY=0;ud.hy=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");le.jN||(le.jN=new Pe(ud.$),ff.g(ud.$).Ea.Qs(ud.yf),ff.g(ud.$).Ea.EG(ud.Sm),ff.g(ud.$).Ea.Oga(ud.yf));return ud}function Ve(){this.cell=null;this.dataSourceIndex=0;this.Go=this.pivotName=null}function Pe(k){this.$=k;this.jN={}}function yf(k,F,X,ra){k=kh.call(this,k,"PopulateFieldListContextMenu",
-1045020714,-170383950,Ci,!0,!1,Ci,F,X,!1,ra)||this;k.uo=null;k.qL=null;k.a_=!1;k.VV=!1;k.isOlap=!1;k.RTd=!1;return k}function Cg(k,F,X,ra){k=hg.call(this,k,F,X,ra,"PopulateChartContextMenu",-498523270,1640762262,yh)||this;k.DAa=!1;k.Vva=!1;k.pZ=!1;k.refresh=!1;k.isPivotChart=!1;return k}function hg(k,F,X,ra,ab,Qb,Fc,ld,ud,jd){ld=void 0===ld?We.a.E1g:ld;k=xf.call(this,k,void 0===ab?"PopulateFloatingObjectContextMenu":ab,void 0===Qb?-2017893763:Qb,void 0===Fc?1350204367:Fc,ld,void 0===ud?!0:ud,void 0===
jd?!1:jd,ld,F,X,!0,ra)||this;k.floatingObject=null;k.zb=0;k.Skc=!0;return k}function Lf(k,F,X,ra){k=Fb.call(this,k,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,Lf.Yxh,!0,!1,Lf.PIb,F,X,!1,ra)||this;k.km=null;return k}function $e(){}function lg(){}function ae(k,F){k=se.call(this,k,2,0,null)||this;k.pse=F;return k}function se(k,F,X,ra){this.Urg=k;this.lmg=F;this.pmg=X;this.rwg=ra}function Wh(){}function zf(k,F,X,ra){var ab=r.call(this,k,"PopulateAutoFilterContextMenu",1675506831,1651433993,
d,!0,!1,"AutoFilterContextMenuRoot",F,X,!1,ra)||this;ab.wrb=null;ab.sheetName=null;ab.$Sa=null;ab.qWc=null;ab.vkf=!1;ab.u2a=!1;ab.CDd=null;ab.WLb=null;ab.G9c=null;ab.Bbc=null;ab.cPa=null;ab.XEe=null;ab.s$a=null;ab.i4c=null;ab.sN=function(){ab.hyc();ab.$.ea.Yn(ab.sN)};ab.KJi=function(Qb){function Fc($g,Wg,qh){ab.i4c=Yg.t(ab.$.na.va,jd,hh.b($g,Ye),ab.u2a?hh.a(Wg,Bf):Wg,qh,null,Tg);return ab.i4c}ab.u2a||Ph.b(ab.$).Rd(Th.a.Nwf,ab.lm(),void 0,!0);var ld={};ab.$.Pj(ld);var ud=ab.$.ea.isNamedObjectViewMode,
jd=jg.a.ni(ab.qWc);jd.SheetName=ud?ld.NamedObjectName:ld.SheetName;jd.NamedObjectView=ud;ld=!!Qb.searchText;ud=586;ab.u2a&&(ld&&(jd.ItemListOptions=ab.i4g(Qb.searchText),ud=597),Qb={},Ph.b(ab.$).Rd(Th.a.Nwf,(Qb.UserOperation=ud.toString(),Qb),void 0,!0));var Ye=ab.Nzd(ld),Bf=ab.LJi(),Tg=ab.$.na.va.hc();ab.XEe=Tg.RequestId;ab.u2a&&ab.Bbc&&!ab.Bbc.dequeueUtcTime&&(ab.$.userOperationManager.Ota(ab.Bbc),ab.dUg());Qb=ve.EwaSettings.qc()?new cg.a(ud,0,Fc,80):new vf.a(ud,0,Fc,16);ab.Bbc=ab.$.userOperationManager.jc(Qb,
null);ab.s$a=ab.i4c;ab.cPa=ab.XEe};ab.onMenuItemClick=function(Qb,Fc,ld){Ph.b(ab.$).Rd(Th.a.EOi,ab.lm(),void 0,!0);var ud={};Fc=(ud.CommandValueId=Fc,ud.MenuItemId=Fc,ud.InputMethod=ld,ud.TopCellAddress=ab.$Sa,ud);ud=new jh.a(Qb,ld,ab.$.isEditMode?2:1,19,null);ab.$.Ka.Wb(ud,Fc);Wd.ULS.sendTraceTag(537167131,0,50,"AutoFilterContextMenu::OnMenuItemClick {0}, {1}",Qb,ld)};ab.JEi=function(Qb){if(Qb.checkedItems&&Qb.checkedItems.length){Ph.b(ab.$).Rd(Th.a.dtf,ab.lm(),void 0,!0);var Fc=jg.a.ni(ab.qWc),
ld={};ab.$.Pj(ld);ld.FirstRow=0;ld.FirstColumn=Fc.Column;var ud=ab.$.ea.isNamedObjectViewMode;Fc.NamedObjectView=ud;Fc.SheetName=ud?ld.NamedObjectName:ld.SheetName;var jd=function(Tg){if(Mf.a.dxc(Tg)){var $g=Mf.a.U$b(Tg);ab.wMa?Mf.a.iQa(rf.a.applyItemFilter,$g.MessageIdName,oi.a.tsa,!0,Mf.a.isSessionEndingError($g.MessageId)):Wd.ULS.sendTraceTag(537167129,0,10,"AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -{0}",$g.MessageIdName)}qc.a(Tg)||(Wd.ULS.sendTraceTag(537167128,
0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),Ph.b(ab.$).Rd(Th.a.Hwf,ab.lm(),void 0,!0),Tg=Object(na.a)(new He,{isSuccess:!0}),ab.WLb.onApplyFilterByValueFinish(Tg),ab.mL(ab.$Sa))},Ye=ab.O2c(Fc,ld),Bf=new cg.a(208,0,function(Tg,$g,Wg){return Yg.a(ab.$.na.va,Ye,Qb.checkedItems,hh.b(Tg,jd),$g,Wg,null,null)},6,function(){return new sg.a(Qb.checkedItems,Ye)});ab.Q2f(function(){ab.$.userOperationManager.jc(Bf,null)})}else Wd.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};
ab.cKg=function(Qb){var Fc=vd.o(ab.$Sa,ab.$),ld=vd.v(ab.$Sa,ab.$),ud=Object(na.a)(new Vd.a,{SortConditionType:Qb.type,RowColOffset:Fc.FirstColumn-ld.FirstColumn,SortColor:Qb.color,SortIconSet:Qb.icon.IconSet,SortIcon:Qb.icon.Icon,IsAscending:!0}),jd={SortOptions:Object(na.a)(new Oe,{OperationType:1,ActiveCell:Fc,SelectedRange:ld,SortConditions:[ud],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1}),SelectedRange:ld,OriginalActiveCell:Fc,ShouldRestoreSelection:!1};jd.ShouldPromptNamedSheetViewTeachingDialog=
ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures");Wd.ULS.sendTraceTag(537167119,0,50,"AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: {0}",Qb.type);ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?(Qb={},ab.$.Ud(-1089513346,Sf.a.Sb,19,(Qb.CustomSortCommandData=jd,Qb))):ab.Q2f(function(){var Ye={};ab.$.Ud(1659552324,Sf.a.Sb,19,(Ye.CustomSortCommandData=jd,Ye))})};ab.wMa=Mf.a.rmd();ab.hy=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
return ab}function fh(){this.top=this.left=0}function ya(){this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}function Ob(){this.autoFilterMenu=this.targetPoint=null}function Lc(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}function Ad(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=
null}function Pd(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}function He(){this.isSuccess=!1}function Me(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}function Se(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}function Ff(){this.Sections=this.Id=null}function Oe(){this.ActiveCell=this.SelectedRange=
null;this.SortTopToBottom=this.IsCaseSensitive=this.GuessHeader=this.HasHeader=this.IsAscending=!1;this.SortInfoMode=this.OperationType=0;this.ExpandSortSelection=this.SortConditions=null;this.ExpandSortSelectionSupported=!1}function Na(){}function kb(k,F,X,ra){var ab=this;this.b2d=this.t1=this.Vi=this.LD=this.w8=null;this.EWb=k;this.vvg=ra;this.EWb.KLa&&(this.Vi=new Sh.a(3,2,5E3,Object(Df.a)(this,this.dMg,"authenticationCheckTask"),2),Rf.AFrameworkApplication.Pi.Qg(this.Vi),this.Og(F,X));this.EWb.$mb(function(){ab.ltf()});
this.EWb.rYa(function(){ab.mtf()})}function ic(){}function Rc(k){return de.call(this,k)||this}function dd(k,F,X){var ra=Dc.call(this)||this;ra.aGi=function(ab,Qb){if(!qc.a(ab)&&Qb){var Fc=!!ab&&!!ab.RequestTelemetryData;ff.g(ra.$).Ii.qla(Qb.toString(),ab.StateId,Fc?ab.RequestTelemetryData.EcsOperationDuration:0,Fc?ab.RequestTelemetryData.EcsRequestDuration:0,Fc?ab.RequestTelemetryData.WfeRequestDuration:0)}};ra.$=k;ra.tableManager=F;ra.Sg=X;return ra}function Od(k,F){this.command=0;this.selectedRanges=
null;this.command=k;this.selectedRanges=F}function me(k){return Yh.call(this,k)||this}function Ie(k){var F=jj.call(this)||this;F.ptf=function(X){var ra=ff.g(F.$);if(X=X.Result){var ab=vd.D(X.NewSelection),Qb=vd.D(X.NewActiveCell);if(ab&&Qb)if(!X.Committed&&X.AutoSumFormula){var Fc=ra.lc(Qb);Fc&&(ra.ha.updateSelection(ab,Qb,60),ab=Qb=vd.D(X.MarkedArea),ra.KJ=2,wf(ra.tc,Fc,X.AutoSumFormula,!!ab,X.FormulaMarkStart,X.FormulaMarkEnd),ab&&Qb&&ra.ha.updateSelection(ab,Qb,0),ra.tc.qpd=!1,Ud.TaskExtensions.Ba(eh.GetServiceTaskFactory.create(F.$.da,
153,F.la,0),function(ld){ld.result.Q1a(null)},F.la,3))}else ra.ha.updateSelection(ab,Qb,60)}};F.$=k;return F}function Xe(k,F){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=k;this.type=F}function wf(k,F,X,ra,ab,Qb){if(F){var Fc=k.textBox;k.isEditing||k.startEdit(F,!0);k.qpd=!0;k.text=X;Fc.caretPosition=ab;ab<Qb&&(ra&&k.MAa(),Fc.selectRange(0,Qb+1),Fc.selectRange(ab,Qb))}}function De(k,F,X,ra,ab,Qb,Fc,ld,ud,jd){jd=k.Na(9,jd);jd.selectedRange=F;jd.activeCell=X;jd.autoSumType=ra;jd.topLeftCell=
ab;return Yg.i(k,"AutoSum",jd,Qb,Fc,ld,ud,0)}function oc(k,F,X,ra,ab,Qb){if(0===ra)return Object(gh.a)(Cj.UnsupportedZeroResize);if(0>ra||0===X.length)return Object(gh.a)(Cj.InvalidInput);if(k.$3h())return Object(gh.a)(Cj.UnsupportedSkeletonInView);var Fc=k.tf;if(!Fc)return Object(gh.a)(Cj.NullSPD);var ld=Fc.fZe(X);if(ld&&0<ld.length)return Object(gh.a)(ld.length.toString()+" "+Cj.UnsupportedHiddenInRange);a:{ld=Gl(X);for(var ud=ld.next();!ud.done;ud=ld.next())ud=ud.value,ab?ud.right=ih.a.Rh:ud.bottom=
ih.a.Hh;ld=k.N$("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",X);try{for(ld.$$rst();ld.$$mn();)if(ld.Mn.JBj){var jd=!0;break a}}finally{ld&&ld.dispose()}jd=!1}if(jd)return Object(gh.a)(Cj.UnsupportedMergeCell);if(ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!ab&&"undefined"!==typeof gridRenderer)for(jd=Gl(X),ld=jd.next();!ld.done;ld=jd.next())gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(ld.value.left);k=k.Ea;jd=ii.a.create().toString();
Fc.Fcg(X,ra,ab);Qb=k.wOj(ab,Qb);F.t5i(X,ab);k.B1i(Qb,jd,ab?"row":"column");return Object(gh.d)(ra)}function Yc(k,F,X){if(k===F)return X;if(F.textContent!==F.parentElement.textContent)for(;null!==F.previousSibling;)F=F.previousSibling,X+=F.textContent.length;return Yc(k,F.parentElement,X)}b.r(C);var hf=b(555),ie=b(0),bf=b(903),Wd=b(15),ee=b(207),Yg=b(83),Sf=b(79);Xe.prototype.b4a=function(){return this.sharedSheetRange};Object(ie.a)(Xe,"MacroRecorderAutoSumPayload",null,[450]);var vd=b(45),vf=b(560),
rh=b(386),cg=b(175),eh=b(51),Ud=b(37),lh=b(159),Eg=b(356),Vf=b(30),ve=b(1),Rg=b(186),hh=b(292),ff=b(22),Ih=b(126),Eh=b(625),Xf=b(58),jj=ee.a;Wl(Ie,jj);Ie.prototype.$c=function(){return!1};Ie.prototype.executeCommand=function(k,F,X){k=F.command;switch(k){case 1220954656:F=this.iIe(0,F);break;case -1537138325:F=this.iIe(parseInt(X[Sf.a.kd].toString(),10),F);break;default:F=Rg.a(k)}return F};Ie.prototype.Mc=function(k,F){if(k=1===k)switch(F.command){case 1220954656:case -1537138325:break;default:k=!1}return k};
Ie.prototype.jd=function(){return!1};Ie.prototype.iIe=function(k,F){function X(){return new Xe(Fc,k)}var ra=this,ab=ff.g(this.$);ab.ug.SG(!1);if(!ff.g(this.$).ha.ta.Hg)return Wd.ULS.sendTraceTag(537170308,0,50,"AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type {0} due to discontinuous selection. Number of selected ranges is {1}",k,ff.g(this.$).ha.ta.xK),this.Yya(),Xf.Task.Sa(!1);var Qb=ab.XJ();if(!Qb)return null;var Fc=vd.v(ab.ha.ta.qd,this.$),ld=vd.o(ab.ha.ta.activeCell,this.$),ud=vd.o(Qb,
this.$),jd=this.$.na.va.hc();return this.$.Aq(ab.ha.ta.selectedRanges,!0)?ve.EwaSettings.qc()?rh.a(this.$.userOperationManager,function(Ye,Bf,Tg){return De(ra.$.na.va,Fc,ld,k,ud,hh.b(Ye,ra.ptf),Bf,Tg,k,jd)},function(Ye){return new cg.a(502,0,Ye,64,X)},F):rh.a(this.$.userOperationManager,function(Ye,Bf,Tg){return De(ra.$.na.va,Fc,ld,k,ud,hh.b(Ye,ra.ptf),Bf,Tg,k,jd)},function(Ye){return new vf.a(502,0,Ye,void 0,X)},F):Xf.Task.Sa(!1)};Ie.prototype.Yya=function(){Eh.a(Ih.a.discontinuousSelectionBlocking,
["OtherICE"],!0,!0,!1,!1,null);var k=Vf.a.gd(1,1,753,2155,0,371863010,"DiscontinuousSelectionBlocking");ve.EwaSettings.Az()?new Eg.a(this.$,k):(k=new lh.ErrorDialog(this.$,k),k.initialize(),k.Af())};Object(ie.a)(Ie,"AutoSumCommandHandler",ee.a,[428]);var Yh=bf.a;Wl(me,Yh);me.prototype.Od=function(){this.Cd([new Ie(this.$)])};me.ka=function(k){bf.a.ee(96,new me(k))};Object(ie.a)(me,"AutoSumCommandHandlerFactory",bf.a,[]);var sh=b(11),ii=b(176),Bg=b(277),Ga=b(38),Kb=b(337);Od.prototype.au=function(){return this.command};
Object(ie.a)(Od,"MacroRecorderRangeOperationAppliedPayload",null,[450]);var qc=b(293),Wc=b(71),Dc=Ga.a;Wl(dd,Dc);dd.prototype.zDg=function(k){this.addHandler("ekcvc",k)};dd.prototype.T9i=function(k){this.removeHandler("ekcvc",k)};dd.prototype.$c=function(){return!1};dd.prototype.executeCommand=function(k,F){k=F.command;switch(k){case -730106152:F=this.xhd(F,3);break;case -1228228458:F=this.xhd(F,4);break;case -848953656:case 2045211913:if(this.vji()){F=Xf.Task.Sa(!0);break}F=this.xhd(F,1);break;default:F=
Rg.a(k)}return F};dd.prototype.Mc=function(k,F){if(k=1===k)switch(F.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:k=!1}return k};dd.prototype.jd=function(){return!1};dd.prototype.xhd=function(k,F){function X(){return new Od(F,jd)}function ra(Bf,Tg,$g){ab.$.By();return Yg.f(ab.$.na.va,F,jd,!1,hh.b(Bf,ab.aGi),Tg,$g,ud,Ye)}var ab=this,Qb=ff.g(this.$),Fc=Qb.ha.ta.selectedRanges,ld=k.command,ud=ii.a.create().toString();if(!this.$.Aq(Fc,!0)&&-730106152!==ld)return Xf.Task.Sa(!0);
var jd=vd.r(Fc,this.$);this.uyj(ld,Qb,Fc,ud);ve.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.E1i();var Ye=this.$.na.va.hc({ola:!0,kka:1});return ve.EwaSettings.qc()?rh.a(this.$.userOperationManager,ra,function(Bf){return new cg.a(508,0,Bf,67,X)},k):rh.a(this.$.userOperationManager,ra,function(Bf){return new vf.a(508,0,Bf,3,X)},k)};dd.prototype.uyj=function(k,F,X,ra){var ab=this;if(-848953656!==k&&2045211913!==k&&-730106152!==k&&-1228228458!==k)Wd.ULS.sendTraceTag(537167938,
0,10,"ClearCommandHandler.ShowInstantaneousClear: Unexpected command {0}.",k);else if(!Bg.a.any(X,function(Fc){return 0<F.getRangeInformation(Fc).length})){var Qb=Bg.a.any(X,function(Fc){return ab.tableManager.yqd(Fc)});if(-730106152!==k&&-1228228458!==k||!Qb)this.pCj(F,k,ra,X),-730106152!==k&&-1228228458!==k||this.Sg.Sda(F,-730106152,{}),-1228228458!==k&&2045211913!==k&&-848953656!==k||this.Sg.OXg(X,ra),F.Ii.N0(ra,Wc.BasicTelemetryCalculator.aR)}};dd.prototype.pCj=function(k,F,X,ra){var ab="";switch(F){case -1228228458:ab=
"ClearAll";break;case 2045211913:case -848953656:ab="ClearContent";break;case -730106152:ab="ClearFormat";break;default:Wd.ULS.sendTraceTag(537167937,0,15,"ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command {0}.",F)}F=ra.length;ra=vd.b(ra);k.Ii.I7(15,X,ab+(", ranges to clear: "+F+", cells to clear: "+ra))};dd.prototype.E1i=function(){this.raiseEvent("ekcvc",new Kb.a)};dd.prototype.vji=function(){if(ff.g(this.$).wz){var k=this.$.da.za(296);return!!k&&k.WU.mB}return!1};Object(ie.a)(dd,
"ClearCommandHandler",Ga.a,[428,771]);var de=bf.a;Wl(Rc,de);Rc.prototype.Od=function(){var k=this,F=eh.GetServiceTaskFactory.create(this.$.da,134,this.la,this.vb),X=eh.GetServiceTaskFactory.create(this.$.da,18,this.la,this.vb);Ud.TaskExtensions.Ba(Ud.TaskExtensions.te([F,X],this.la),function(){var ra=new dd(k.$,F.result,X.result);k.Cd([ra]);k.$.da.Ga(313,ra)},this.la,3)};Rc.ka=function(k){bf.a.ee(101,new Rc(k))};Object(ie.a)(Rc,"ClearCommandHandlerFactory",bf.a,[]);var ye=b(629),Gf=b(622),jf=b(620),
Hf=b(1199);ic.prototype.o8g=function(k,F){if(k&&!(1>k.length)&&F){var X=Object.assign(new jf.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.O5g(k,X.ControlList);F.push(X)}};ic.prototype.O5g=function(k,F){var X=Object.assign(new ye.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Gf.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(F,X);F=Object.assign(new jf.a,{Title:"",ControlList:[]});
Array.add(X.Menu.MenuSectionList,F);this.V7g(k,F.ControlList)};ic.prototype.V7g=function(k,F){for(var X=0;X<k.length;X++){var ra=Object.assign(new Hf.a,{ExternalId:String.format("CoauthorPersona_{0}",X),Command:"336231556",DisplayName:k[X].userName,LabelText:k[X].userName,ImageBackColor:k[X].color,PersonaId:k[X].email,IsAnonymous:k[X].isAnonymous});Array.add(F,ra)}};Object(ie.a)(ic,"PresenceContextMenuSectionBuilder",null,[241]);var Df=b(82),Rf=b(4),Of=b(180),Ig=b(621),Sh=b(108),Fh=b(135),zg=b(91),
ki=b(84),Hi=b(107),ug=b(27);kb.prototype.Og=function(k,F){var X=Rf.AFrameworkApplication.Ib;X.Ve(ug.a.authenticationLost,Hi.a.frame,k,96);X.Ve(ug.a.ise,Hi.a.frame,F,96);X.fc(ug.a.cwe,Hi.a.frame,Of.ActionManager.u6c);X.fc(ug.a.dwe,Hi.a.frame,Of.ActionManager.u6c);X.fc(ug.a.qsd,Hi.a.frame,Of.ActionManager.u6c)};kb.prototype.ltf=function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);Rf.AFrameworkApplication.Ib.processAction(ug.a.authenticationLost,2)};kb.prototype.mtf=function(){this.iGj();
Rf.AFrameworkApplication.Ib.processAction(ug.a.ise,2)};kb.prototype.dMg=function(){this.EWb.authenticationCheck()};kb.prototype.iGj=function(){this.LD&&(this.LD.hide(),this.LD.dispose(),this.LD=null);this.w8&&this.businessBar&&(Rf.AFrameworkApplication.Ng||this.businessBar.removeEntry(this.w8),this.w8.dispose(),this.w8=null)};kb.prototype.showDialog=function(k){zg.a.Ha(this.LD);this.LD=new Fh.StandardDialog;this.vvg||(this.LD.fv=!1,this.LD.ic=0);this.LD.Ac(1,CommonUIStrings.l_SignIn);this.LD.pX(CommonUIStrings.l_DefaultDialogTitle,
k,Object(Df.a)(this,this.rw,"dialogHandler"))};kb.prototype.rw=function(k){1===k?(Ig.a.I6(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),Rf.AFrameworkApplication.Ib.processAction(ug.a.qsd,2)):(this.YQd(),Rf.AFrameworkApplication.Ib.processAction(ug.a.dwe,2))};kb.prototype.YQd=function(){this.businessBar&&this.oue&&(this.w8=this.oue.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.w8.closeable=!0,this.w8.addButton(CommonUIStrings.l_SignIn,
kb.ARg,""),this.w8.z$=Object(Df.a)(this,this.DRg,"businessBarEntryCloseHandler"),this.businessBar.cE(this.w8,!1))};kb.prototype.DRg=function(){this.Reh();Rf.AFrameworkApplication.Ib.processAction(ug.a.cwe,2)};kb.prototype.Reh=function(){this.Vi&&(Rf.AFrameworkApplication.Pi.Xp(this.Vi),this.Vi=null)};kb.prototype.dispose=function(){this.Vi=this.LD=this.w8=null};kb.ARg=function(){Ig.a.I6();Rf.AFrameworkApplication.Ib.processAction(ug.a.qsd,2)};Ck.Object.defineProperties(kb.prototype,{businessBar:{configurable:!0,
enumerable:!0,get:function(){return this.t1||(this.t1=ki.a.instance.Lh("CommonUI.IBusinessBar"))}},oue:{configurable:!0,enumerable:!0,get:function(){return this.b2d||(this.b2d=ki.a.instance.Lh("CommonUI.IBusinessBarEntryFactory"))}}});Object(ie.a)(kb,"SignOutResponseUI",null,[3]);var wi=b(257);Na.prototype.fi=function(k){k.register(ic,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").Hc()};Na.prototype.init=function(){};Na.prototype.dispose=
function(){zg.a.Ha(Na.g2);Na.g2=null};Na.main=function(){wi.a.instance.gj(new Na)};Ck.Object.defineProperties(Na.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.UI"}}});Na.g2=null;Object(ie.a)(Na,"CommonAppUIPackage",null,[4,5]);var Fa=b(154),na=b(7),Gb=b(162),Vd=b(1252);Object(ie.a)(Oe,"SharedSortOptions",null,[]);var ge=b(925),We=b(5),Vg=b(492),Qg=b(623),jg=b(55),sg=b(1114),Th=b(133),Bi=b(958),ri=b(151),pi=b(121),vi=b(214),jh=b(95),Ng=b(72),ji=b(35),we=b(14),vh=b(61),
Ph=b(134),Mf=b(979),rf=b(980),oi=b(112),bh=b(50),ah=b(33),wh=b(442);Object(ie.a)(Ff,"AutoFilterMenu",null,[]);Object(ie.a)(Se,"MenuItem",null,[]);Object(ie.a)(Me,"MenuSection",null,[]);Object(ie.a)(He,"ApplyFilterByValueResponse",null,[]);Object(ie.a)(Pd,"FilterByValueItem",null,[]);Object(ie.a)(Ad,"GetColorsAndIconsResponse",null,[]);Object(ie.a)(Lc,"GetFilterByValueItemsResponse",null,[]);Object(ie.a)(Ob,"ShowSortFilterMenuParams",null,[]);Object(ie.a)(ya,"SortFilterControllerFactoryParams",null,
[]);Object(ie.a)(fh,"TargetPoint",null,[]);var xi=b(258),O=b(36),fa=b(163),Va=b(221),d=We.a.y1g,r=ge.a;Wl(zf,r);zf.prototype.executeCommand=function(k,F,X){var ra=this;k=F.command;switch(k){case 1701016594:return ge.a.gwh(X),Xf.Task.Sa(!0);case 966232027:if(ve.EwaSettings.Gl()){var ab=new Gb.a;Ud.TaskExtensions.Ba(eh.GetServiceTaskFactory.Xa(this.$.da,8,9,0),function(Qb){ra.s5e(F,X,Qb.result);ab.setResult(!0)},this.la,3).CWCT(function(){ab.setResult(!1)},this.la,5,Va.a.instance);return ab.task}this.s5e(F,
X);return Xf.Task.Sa(!0);default:return Rg.a(k)}};zf.prototype.s5e=function(k,F,X){var ra=this,ab=F.domEvent;if(Ng.e(ab.rawEvent)&&(Ng.g(ab),ab.target)){var Qb=new ri.a(this.$.xa);if(Qb.me(4096)||Qb.me(2048)){var Fc=jg.a.ni(F[Sf.a.pg]);this.s1f(Fc)&&(this.vkf?this.$sc(ab,ab.target,Fc,k,X):(this.CDd=function(){ra.s1f(Fc)&&(ra.O$h(),ra.$sc(ab,ab.target,Fc,k,X),ra.u2a=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1),ra.vkf=!0)},this.hyc()))}}};zf.prototype.Mc=function(k,
F,X){if(k=!!X)switch(F.command){case 1701016594:case 966232027:ve.EwaSettings.Gl()||Vg.a(this.$)||(k=!1,Wd.ULS.sendTraceTag(537167137,0,15,"AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was {0}",bh.b().ri(F.command)));break;default:k=!1}return k};zf.prototype.nDd=function(k){Array.addRange(k.MenuSectionList,this.wrb)};zf.prototype.O$h=function(){var k=this;wh.a(function(){k.WLb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(na.a)(new ya,
{getFilterByValueItemsRequest:k.KJi,applyFilterByValueRequest:k.JEi,onMenuItemClick:k.onMenuItemClick,autoFilterMenuWidth:zf.ose,applySortByColorOrIconRequest:k.cKg}))});this.G9c=ki.a.instance.Lh("Common.IExternalUICommandDefinitionMapping")||new Qg.a(this.$.Mb,this.$)};zf.prototype.$sc=function(k,F,X,ra,ab){Ph.b(this.$).Rd(Th.a.$sc,this.lm(),void 0,!0);Wd.ULS.shipAssertTag(537167135,0,!!X,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");k=this.GHh(X,ab);ab=Sys.UI.DomElement.getBounds(F);
ra=ab.x+ab.width;ab=ab.y;if(this.hy&&!X.IsHeaderSnapped){if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!ge.a.Tmd(this.$,X.Cell))return;X=ge.a.Wcd(this.$,X.Cell,!0);ra=X.x;ab=X.y}X=ff.g(this.$).rtl?new Sys.UI.Point(ra-ah.a(this.$).RFa(zf.ose),ab):new Sys.UI.Point(ra,ab);this.vTa(X,F);X=ah.a(this.$).Aja(X);F=Object(na.a)(new Ob,{targetPoint:Object(na.a)(new fh,{left:X.x,top:X.y}),autoFilterMenu:k});this.WLb.showSortFilterMenu(F);this.$.Ud(-544117314,-1,0,null)};
zf.prototype.s1f=function(k){return ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5819197_CheckActiveItemBeforeRenderingAutofilterMenu")&&k.Cell.SheetName?ff.g(this.$).p5?k.Cell.SheetName===this.$.qa.name:k.Cell.SheetName===this.$.qa.sheetName:!0};zf.prototype.GHh=function(k,F){return(k=this.HHh(k,F))?this.oIf(k):null};zf.prototype.oIf=function(k){for(var F=[],X=Gl(k.Sections),ra=X.next();!ra.done;ra=X.next())ra=ra.value,Object(fa.e)(this.$)&&ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&
ra.Title===we.a.instance.ga(1921)||(ra=this.x_i(ra),F.push(ra));return Object(na.a)(new Ff,{Id:k.Id,Sections:F})};zf.prototype.x_i=function(k){for(var F=[],X=Gl(k.MenuItems),ra=X.next();!ra.done;ra=X.next())if(ra=ra.value,2===ra.Identifier)this.qWc=ra.CommandData;else switch(ra.Type){case 3:case 2:F.push(this.v_i(ra,2===ra.Type));break;case 1:F.push(this.w_i(ra))}return Object(na.a)(new Me,{MenuItems:F,DisplayType:k.DisplayType,Id:this.bFh(k)})};zf.prototype.w_i=function(k){var F=this.nVe(k);var X=
F.label;var ra=F.jLa;F=this.oIf(k.SubMenu);var ab=this.dVe(k);ra=this.G9c.Pac(ra);X=X||k.Label;return Object(na.a)(new Se,{Disabled:k.Disabled,Type:k.Type,Identifier:k.Identifier,Id:ab,CommandData:k.CommandData,Label:X,SubMenu:F,IsChecked:k.IsChecked,IconName:"MissingIcon_20"===ra?null:ra})};zf.prototype.v_i=function(k,F){var X=this.E$b(k,F&&k.IsChecked);F=X.label;var ra=X.jLa;X=X.Br;var ab=this.Sbd(k,F);ra=this.G9c.Pac(ra);return Object(na.a)(new Se,{Disabled:k.Disabled,Type:k.Type,Identifier:k.Identifier,
Id:ab,RibbonCommand:X,CommandData:k.CommandData,Label:F||k.Label,SubMenu:null,IsChecked:k.IsChecked,IconName:"MissingIcon_20"===ra?null:ra})};zf.prototype.HHh=function(k,F){var X;this.$Sa=X=vd.C(k.Cell);this.sheetName=this.$.qa.sheetName;F=F||Vg.a(this.$);if(k.IsHeaderSnapped)X=F.t9b.OOh(X);else{F=ff.g(this.$).Ea.M3a(X);if(!F)return this.wMa?Mf.a.iQa(rf.a.FKf,Ih.a.W_h,oi.a.wZa,!0,!1):Wd.ULS.sendTraceTag(537167134,0,10,"AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested {0}, visible range: {1}",
X,ff.g(this.$).view.visibleArea),null;X=F.autoFilterMenu}if(!X)return this.wMa?Mf.a.iQa(rf.a.FKf,Ih.a.vyi,oi.a.wZa,!0,!1):Wd.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;this.hsb=k.Cell.FirstRow+"_"+k.Cell.FirstColumn;return X};zf.prototype.hyc=function(){var k=this;if(this.$.ea.sh){var F=eh.GetServiceTaskFactory.Xa(this.$.da,283,284,1);Ud.TaskExtensions.Ba(F,function(){k.wMa?F.result.Fn.loadScript("sortFilter").then(function(){k.CDd()},
function(X){vh.a.Ek(X,"AutoFilterContextMenu.SortFilterScriptLoad");Mf.a.iQa(rf.a.hyc,Ih.a.uBj,oi.a.wZa,!1,!1)}):Ud.TaskExtensions.Ba(xi.c(F.result.Fn.loadScript("sortFilter")),function(){k.CDd()},k.$.la,3)},this.$.la,3)}else this.$.ea.Fl(this.sN)};zf.prototype.i4g=function(k){var F={};F.SearchText=k;F.Page=1;F.DateNodeType=-1;return F};zf.prototype.dUg=function(){this.cPa&&(Wd.ULS.sendTraceTag(537167132,0,15,"AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID={0}",
this.cPa),Yg.j(this.$.na.va,this.cPa,null,null,null),this.cPa=null);this.s$a&&(Rf.AFrameworkApplication.Jd.yu(this.s$a.Pt),this.s$a=null)};zf.prototype.Nzd=function(k){var F=this;return function(X){F.cPa=null;F.s$a=null;if(Mf.a.dxc(X)){var ra=Mf.a.U$b(X);F.wMa?Mf.a.iQa(k?rf.a.searchAutoFilterItemList:rf.a.getAutoFilterItemList,ra.MessageIdName,oi.a.wZa,!0,!0):Wd.ULS.sendTraceTag(537167127,0,10,"AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -{0}",ra.MessageIdName)}if(!qc.a(X)){Wd.ULS.sendTraceTag(537167126,
0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");X=X.Result;ra=new ji.a(!0);var ab=X.AutoFilterDateNodes?!0:!1;X.AutoFilterItems&&ra.add("AutoFilterItemsCount",X.AutoFilterItems.length);ab&&ra.add("AutoFilterDateItemsCount",X.AutoFilterDateNodes.length);ra.add("Location","contextMenu");Ph.b(F.$).Rd(Th.a.Nzd,ra.ku,void 0,!0);ra=F.u2a?Object(na.a)(new Lc,{filterByValueItems:F.qBe(X),hasMoreRecords:X.ItemListMaxExceeded,searchText:X.SearchText}):Object(na.a)(new Lc,{filterByValueItems:F.qBe(X),
hasMoreRecords:X.ItemListMaxExceeded});F.WLb.onGetFilterByValueItemsFinish(ra);k||(Wd.ULS.shipAssertTag(529063959,0,null!==X.FontColors&&null!==X.CellColors&&null!==X.Icons&&null!==X.SelectedSortFontColors&&null!==X.SelectedSortCellColors&&null!==X.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),X=Object(na.a)(new Ad,{fontColors:X.FontColors,cellColors:X.CellColors,icons:X.Icons,selectedSortFontColor:0<X.SelectedSortFontColors.length?
X.SelectedSortFontColors[0]:null,selectedSortCellColor:0<X.SelectedSortCellColors.length?X.SelectedSortCellColors[0]:null,selectedSortIcon:0<X.SelectedSortIcons.length?X.SelectedSortIcons[0]:null,getColorName:F.getColorName}),F.WLb.onGetColorsAndIconsFinish(X))}}};zf.prototype.LJi=function(){var k=this;return function(F){k.cPa=null;k.s$a=null;F=pi.a.ig(F.data);Wd.ULS.sendTraceTag(537167125,0,10,"AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [{0}].",Vf.a.Tc(F))}};zf.prototype.qBe=
function(k){var F=this.$1g(k),X=this.g2g(k.AutoFilterItems),ra=[],ab=0;k.HasBlanks&&(k=zf.b3c(we.a.instance.ga(780),k.IsBlanksSelected?1:0,We.a.nse),ra[ab++]=k);F=Gl(F);for(k=F.next();!k.done;k=F.next())k=k.value,ra[ab++]=k;X=Gl(X);for(k=X.next();!k.done;k=X.next())F=k.value,ra[ab++]=F;return ra};zf.prototype.$1g=function(k){var F=[];if(!k.AutoFilterDateNodes||!k.AutoFilterDateNodes.length)return F;for(var X=[this.J3a(k.YearKeys,k.YearValues),this.J3a(k.MonthKeys,k.MonthValues),this.J3a(k.DayKeys,
k.DayValues),this.J3a(k.HourKeys,k.HourValues),this.J3a(k.MinuteKeys,k.MinuteValues),this.J3a(k.SecondKeys,k.SecondValues)],ra=!1,ab=!1,Qb=0,Fc=null,ld=Array(6),ud=null,jd=Gl(k.AutoFilterDateNodes),Ye=jd.next();!Ye.done;Ye=jd.next()){Ye=Ye.value;ld[0]&&(ud.Year!==Ye.Year?(ra=!0,Qb=0,Fc=null):ud.Month!==Ye.Month?(ab=!0,Qb=1,Fc=ld[0]):ud.Day!==Ye.Day?(Qb=2,Fc=ld[1]):k.ShowTime&&(ud.Hour!==Ye.Hour?(Qb=3,Fc=ld[2]):ud.Minute!==Ye.Minute?(Qb=4,Fc=ld[3]):(Qb=5,Fc=ld[4])));for(;6>Qb;){switch(Qb){case 0:var Bf=
Ye.Year;ud=X[0].getItem(Bf.toString());break;case 1:Bf=Ye.Month;ud=X[1].getItem(Bf.toString());break;case 2:Bf=Ye.Day;ud=X[2].getItem(Bf.toString());break;case 3:Bf=Ye.Hour;ud=X[3].getItem(Bf.toString());break;case 4:Bf=Ye.Minute;ud=X[4].getItem(Bf.toString());break;case 5:Bf=Ye.Second;ud=X[5].getItem(Bf.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}ud=zf.b3c(ud,-1!==Ye.NodeType&&Qb>=Ye.NodeType?1:0,Fc?Fc.key+";"+Bf:We.a.qXc+Bf,!1,[]);Fc=Fc?Fc.children:
F;Fc=Fc[Fc.length]=ud;ld[Qb]=ud;switch(Qb){case 5:Qb=6;break;case 2:Qb=k.ShowTime?Qb+1:6;break;default:Qb++}}ud=Ye}ra||(ld[0].expanded=!0,ab||(ld[1].expanded=!0));return F};zf.prototype.g2g=function(k){var F=[];if(!k)return F;var X=0;k=Gl(k);for(var ra=k.next();!ra.done;ra=k.next())ra=ra.value,F[X++]=zf.b3c(ra.DisplayString,ra.Selected?1:0,We.a.rXc+ra.DisplayString);return F};zf.prototype.J3a=function(k,F){var X=new ji.a(!0);if(!k||!F)return X;for(var ra=k.length<F.length?k.length:F.length,ab=0;ab<
ra;ab++)X.add(k[ab].toString(),F[ab]);return X};zf.prototype.O2c=function(k,F){var X={};X.Location=F;X.FieldId=k.Id.toString();X.DataSourceIndex=-1;X.FilterType=k.AutoFilterType;X.AnchorType=0;X.ChartId=null;X.AnchorValue1=-1;X.AnchorValue2=-1;X.Property=k.RichProperty;return X};zf.prototype.mL=function(k){O.a.Fba(this.$)&&Ud.TaskExtensions.Ba(eh.GetServiceTaskFactory.Xa(this.$.da,430,431,1),function(F){F.result.pea(k);Wd.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},
this.$.la,3)};zf.prototype.lm=function(){var k={};return k.Location="contextMenu",k};zf.prototype.getColorName=function(k){return Bi.a.fKa(vi.a.fH(k))};zf.prototype.Q2f=function(k){Ud.TaskExtensions.Ba(eh.GetServiceTaskFactory.Xa(this.$.da,309,310,3),function(F){F.result.GAa().continueWith(function(X){X.result&&k()})},this.$.la,3)};zf.b3c=function(k,F,X,ra,ab){k=void 0===k?null:k;F=void 0===F?0:F;X=void 0===X?null:X;ra=void 0===ra?!1:ra;ab=void 0===ab?null:ab;return Object(na.a)(new Pd,{displayText:k?
ge.a.gg(k):k,state:F,key:X,parent:null,children:ab,indentationLevel:0,expanded:ra})};Ck.Object.defineProperties(zf.prototype,{Qw:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterContextMenu"}},AB:{configurable:!0,enumerable:!0,get:function(){return We.a.DKf}}});zf.ose=268;Object(ie.a)(zf,"AutoFilterContextMenu",ge.a,[]);var S=b(932),ca=b(85),Ka=b(202),fc=b(65),pb=b(19);Wh.$Re=26;Wh.L$c=[229,230,0,98,0,94,93];Object(ie.a)(Wh,"Constants",null,[]);Ck.Object.defineProperties(se.prototype,
{mii:{configurable:!0,enumerable:!0,get:function(){return 3===this.O4b}},Lli:{configurable:!0,enumerable:!0,get:function(){return 4===this.O4b&&!!this.subMenu}},subMenu:{configurable:!0,enumerable:!0,get:function(){return this.rwg}},bpf:{configurable:!0,enumerable:!0,get:function(){return this.Urg}},O4b:{configurable:!0,enumerable:!0,get:function(){return this.lmg}},y4c:{configurable:!0,enumerable:!0,get:function(){return this.pmg}}});Object(ie.a)(se,"FiltersMenuData",null,[]);Wl(ae,se);Object(ie.a)(ae,
"AutoFilterFiltersMenuData",se,[]);lg.yGj=[new se(99,2,0,null),new se(100,2,1,null),new se(0,3,0,null),new se(171,2,2,null),new se(173,2,4,null),new se(0,3,0,null),new se(175,2,6,null),new se(176,2,7,null),new se(0,3,0,null),new se(107,0,0,null)];lg.hDi=[new se(99,2,0,null),new se(100,2,1,null),new se(0,3,0,null),new se(101,2,8,null),new se(102,2,10,null),new se(103,2,12,null),new se(0,3,0,null),new se(104,1,0,null),new ae(105,1),new ae(106,2),new se(0,3,0,null),new se(107,0,0,null)];lg.Tah=[new se(99,
2,0,null),new se(0,3,0,null),new se(111,2,10,null),new se(112,2,8,null),new se(103,2,12,null),new se(0,3,0,null),new ae(109,8),new ae(108,9),new ae(110,10),new se(0,3,0,null),new ae(114,11),new ae(113,12),new ae(115,13),new se(0,3,0,null),new ae(116,14),new ae(117,15),new ae(118,16),new se(0,3,0,null),new ae(119,17),new ae(120,18),new ae(121,19),new se(0,3,0,null),new ae(122,20),new ae(123,21),new ae(124,22),new se(0,3,0,null),new ae(125,23),new se(126,2,12,[new ae(127,24),new ae(128,25),new ae(129,
26),new ae(130,27),new se(0,3,0,null),new ae(131,28),new ae(132,29),new ae(133,30),new ae(134,31),new ae(135,32),new ae(136,33),new ae(137,34),new ae(138,35),new ae(139,36),new ae(140,37),new ae(141,38),new ae(142,39)]),new se(0,3,0,null),new se(107,0,0,null)];Object(ie.a)(lg,"Constants",null,[]);var Z=b(21);$e.prototype.compare=function(k,F){return Z.a.compare(k,F,!0)};Object(ie.a)($e,"IgnoreCaseComparer",null,[807]);var Ba=b(74),Fb=ge.a;Wl(Lf,Fb);Lf.prototype.executeCommand=function(k,F,X){k=F.command;
switch(k){case -699941697:this.applyAutoFilterFieldList(F,X);break;case 216058793:String.format("TableFieldListContextMenu:AutoFilterFieldListContextMenuClose");break;case -1494291901:break;default:return Rg.a(k)}return Xf.Task.Sa(!0)};Lf.prototype.Mcd=function(k,F){return!k||k.length<=F?(Wd.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(k[F],10)};Lf.prototype.TEd=function(k,F,X,ra,ab,Qb){var Fc=this.Mcd(ab,Qb);0>Fc&&Wd.ULS.sendTraceTag(537167116,
0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(Wh.L$c[Fc]){case 98:k=new jh.a(-2058042992,F.method,F.mode,F.Ze,F.tabName);this.km.LG.ptb(this.$,ra,0,k);break;case 229:k=new jh.a(504133448,F.method,F.mode,F.Ze,F.tabName);this.km.LG.ptb(this.$,ra,0,k);break;case 230:k=new jh.a(-798968736,F.method,F.mode,F.Ze,F.tabName);this.km.LG.ptb(this.$,ra,0,k);break;case 234:k=new jh.a(-1677817820,F.method,F.mode,F.Ze,F.tabName);this.km.LG.ptb(this.$,ra,0,k);break;case 94:this.DIf(k,
F,ra,X,ab,Qb+1);break;case 93:this.km.LG.Epi(this.$,ra)}};Lf.prototype.DIf=function(k,F,X,ra,ab,Qb){var Fc=this.Mcd(ab,Qb);0>Fc&&Wd.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!ra||Fc>=ra.length)Wd.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(ra=ra[Fc],ra.O4b){case 1:this.km.LG.Zpi(this.$,X);break;case 2:(ab=Object(ca.a)(ae,ra))?(k=new jh.a(-2058042992,F.method,
F.mode,F.Ze,F.tabName),this.km.LG.ptb(this.$,X,ab.pse,k)):this.km.LG.jjf(this.$,k,X,ra.y4c);break;case 0:this.km.LG.jjf(this.$,k,X,ra.y4c);break;case 4:this.DIf(k,F,X,ra.subMenu,ab,Qb+1)}};Lf.prototype.applyAutoFilterFieldList=function(k,F){var X=F[S.a.YF];if(X)if(X=X.split(fc.a.VU),3>X.length)Wd.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var ra=this.Mcd(X,1),ab=this.UJa(ra),Qb=this.Xof(ra).returnValue;Qb?
this.TEd(F,k,Qb,ab,X,2):Wd.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+ra.toString()+fc.a.VU)}else Wd.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")};Lf.prototype.Mc=function(k,F){if(k=this.$.isEditMode)switch(F.command){case 216058793:break;case -699941697:break;case -1494291901:k=!0;break;default:k=!1}return k};Lf.prototype.K0=function(k,
F,X){this.$.isEditMode&&((this.km=Object(ca.a)(801,X))||Wd.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.$Y(),Fb.prototype.K0.call(this,k,F,null,null,!0))};Lf.prototype.W2c=function(){if(!this.km||!this.km.Ok||1!==this.km.Ok.length)return Wd.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;var k=this.km.Ok[0],F=new Ka.a;F.add(we.a.instance.ga(250));F=Ba.OBc(Ba.concat(F,
Ba.select(Ba.asEnumerable(k.FieldInfoDataList),function(X){return X.Name})),function(X){return X},new $e);return Ba.toArray(F)};Lf.prototype.fieldIndex=function(k){if(!this.km||!this.km.Ok||1!==this.km.Ok.length||!this.km.Ok[0].FieldInfoDataList)return-1;for(var F=0;F<this.km.Ok[0].FieldInfoDataList.length;++F)if(this.km.Ok[0].FieldInfoDataList[F].Name===k)return F;return-1};Lf.prototype.UJa=function(k){return 0>k||!this.km||!this.km.Ok||1!==this.km.Ok.length||!this.km.Ok[0].FieldInfoDataList||this.km.Ok[0].FieldInfoDataList.length<
k?null:this.km.Ok[0].FieldInfoDataList[k].Name};Lf.prototype.$Y=function(){var k=this,F=this.W2c();if(!F||!F.length)return null;for(var X=this.Ta,ra=X.Pc(),ab={},Qb=0;Qb<F.length;ab={Ofb:ab.Ofb},++Qb){var Fc=F[Qb];ab.Ofb=0<Qb?this.fieldIndex(Fc):-1;for(var ld=Lf.s4f+ab.Ofb.toString()+fc.a.VU,ud=null,jd=this.km.LG.E3h(0<Qb?Fc:null),Ye=this.e3c(X,jd,Lf.s4f+ab.Ofb.toString(),Fc),Bf={},Tg=0;Tg<Wh.L$c.length;Bf={uPb:Bf.uPb,Nfb:Bf.Nfb},++Tg){var $g=Wh.L$c[Tg],Wg=ld+Tg.toString();ud||(ud=X.Pc());switch($g){case 229:ud.buttons.push(X.fd(223,
Wg,-699941697,this.km.LG.wli(0<Qb?Fc:null)?pb.a.x8b:pb.a.NIa,8,229,!1,null));break;case 230:ud.buttons.push(X.fd(224,Wg,-699941697,this.km.LG.xli(0<Qb?Fc:null)?pb.a.y8b:pb.a.OIa,8,230,!1,null));break;case 234:ud.buttons.push(X.fd(225,Wg,-699941697,pb.a.v8b,1,234,!1,null));break;case 98:$g=this.DQg(Fc);Wg=X.wHa(Wg+(jd?".enabled":".disabled"),$g,-699941697,null,"None",null,!jd,void 0,!0);Wg.qS("Image16by16",8,pb.a.i2a);ud.buttons.push(Wg);break;case 94:Bf.uPb=void 0;Bf.Nfb=void 0;var qh=function(Ri,
ci){return function(){var Tf=k.Xof(Ri.Ofb);ci.uPb=Tf.iSe;ci.Nfb=Tf.isChecked;return Tf}}(ab,Bf)().returnValue;if(!qh)return null;$g=this.e3c(X,Bf.Nfb&&jd,Wg,Bf.uPb);Wg=this.sVe($g.menu,X,Wg+fc.a.VU,qh,Bf.Nfb&&jd);$g.menu.Ec.push(Wg);ud.buttons.push($g);break;case 0:ud&&(Ye.menu.Ec.push(ud),ud=null);break;default:Wg=X.wHa(Wg,we.a.instance.ga($g),-699941697,null,"None",null,!1,void 0,!0),this.GXf(Wg,jd&&93===$g&&this.km.LG.filter(),we.a.instance.ga($g)),ud.buttons.push(Wg)}}Ye.menu.Ec.push(ud);ra.buttons.push(Ye)}F=
X.Cq(this.menuId);F.Ec.push(ra);return F};Lf.prototype.sVe=function(k,F,X,ra,ab){for(var Qb=null,Fc=0;Fc<ra.length;++Fc){var ld=ra[Fc],ud=X+Fc.toString(),jd=!1;switch(ld.O4b){case 1:jd=ab&&this.km.LG.Wh.IsTop10;break;case 2:jd=Object(ca.a)(ae,ld);jd=ab&&this.km.LG.Zei(jd?jd.pse:0,ld.y4c);break;case 0:jd=ab&&this.km.LG.Wh.IsCustomSupportedAndNotPresent}Qb||(Qb=F.Pc());if(ld.mii)Qb&&(k.Ec.push(Qb),Qb=null);else if(ld.Lli){var Ye=we.a.instance.ga(ld.bpf);Ye=this.e3c(F,jd,ud,Ye);Ye.menu.Ec.push(this.sVe(Ye.menu,
F,ud+fc.a.VU,ld.subMenu,jd));Qb.buttons.push(Ye)}else ld=we.a.instance.ga(ld.bpf),ud=F.wHa(ud,ld,-699941697,null,"None",null,!1,void 0,!0),this.GXf(ud,jd,ld),Qb.buttons.push(ud)}return Qb};Lf.prototype.GXf=function(k,F,X){F?k.qS("Image16by16",8,pb.a.vua):k.qS("None",0,null);k.oS(X);k.label=X};Lf.prototype.e3c=function(k,F,X,ra){return F?k.X2c(X,this.menuId,ra,798637440,8,pb.a.vua):k.lw(X,this.menuId,ra,798637440)};Lf.prototype.Fh=function(k){return!k||!k.length};Lf.prototype.Xof=function(k){var F=
0>k?0:this.km.Ok[0].FieldInfoDataList[k].MajorityDataTypeForField;var X=null;k=this.km.LG.D3h(F);switch(F){case 0:X=95;F=lg.yGj;break;case 1:X=94;F=lg.hDi;break;case 2:X=96;F=lg.Tah;break;default:return Wd.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,iSe:X,isChecked:k}}X=we.a.instance.ga(X);return{returnValue:F,iSe:X,isChecked:k}};Lf.prototype.DQg=function(k){!k||this.Fh(k.trim())?k=we.a.instance.ga(97):k.length>Wh.$Re?
(k=k.substring(0,Wh.$Re),k=String.format(we.a.instance.Bb(155),k)):k=String.format(we.a.instance.Bb(156),k);return k};Ck.Object.defineProperties(Lf.prototype,{Qw:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterFieldListContextMenu"}},AB:{configurable:!0,enumerable:!0,get:function(){return We.a.EKf}}});Lf.Yxh=We.a.x1g;Lf.PIb="AutoFilterFieldListContextMenuRoot";Lf.s4f="ApplyAutoFilterFieldList.";Object(ie.a)(Lf,"AutoFilterFieldListContextMenu",ge.a,[]);var xc=b(608),Pc=b(1049),
Sc=b(10),oe=b(122),gf=b(388),xf=ge.a;Wl(hg,xf);hg.prototype.executeCommand=function(k,F,X){k=Object(ca.a)(xc.a,X.eventArgs);switch(F.command){case -1372040782:X=ff.g(this.$).ha.Oa.nc;Wd.ULS.shipAssertTag(537167048,0,!!X);X&&(this.floatingObject=X.floatingObject,this.zb=F.method,F=this.wac(k),this.Fp(F,!0,k.zb));break;case 848910589:k&&(F=[Pc.a.Y_f],k=new Sys.UI.Point(k.Ca.clientX,k.Ca.clientY),this.showFloatie(F,new Sys.UI.Bounds(k.x,k.y,0,0),2))}return Xf.Task.Sa(!0)};hg.prototype.Mc=function(k,
F,X){switch(F.command){case -1372040782:return!!X&&this.wgf(k);case 848910589:return k=ff.g(this.$).ha.Oa.nc,!!X&&!!k&&k.isEditing;default:return!1}};hg.prototype.wgf=function(k){switch(k){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}};hg.prototype.YTc=function(k,F,X){gf.a(this.$)?ff.g(this.$).rb.$i||(ah.a(this.$).LQd()?X.buttons.push(k.Cb(265)):X.buttons.push(k.Cb(264))):(this.$.isEditMode&&3===this.zb&&!this.Y9b()&&X.buttons.push(k.Cb(101)),5!==this.floatingObject.type||oe.a.GH(this.floatingObject.Kb)||
this.floatingObject.Kb.IsGroup||(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.Tpd()?X.buttons.push(k.Cb(186)):X.buttons.push(k.Cb(147))),this.Y9b()||this.Tpd()||X.buttons.push(k.Cb(146)),ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",!1)&&(this.eEh(X),this.CFh(X)),ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&X.buttons.push(k.Cb(287)),ve.EwaSettings.ma(167)&&
0===this.floatingObject.type&&X.buttons.push(k.Cb(249)),5===this.floatingObject.type&&ff.g(this.$).ha.Oa.nc.u5()&&this.$.Eka&&this.$.dha&&X.buttons.push(k.Cb(273)))};hg.prototype.WJa=function(k){var F=[];if(gf.a(this.$))return F;3===k?(k=!!this.$.Yf.get(5)&&this.floatingObject.PTd(),this.Y9b()||(this.$.isEditMode?(k&&F.push(Pc.a.cBh),5===ff.g(this.$).ha.Oa.wC.floatingObject.type&&F.push(Pc.a.Xsj)):k&&F.push(Pc.a.copy)),F.push(Pc.a.dBh)):2===k&&(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?
ff.g(this.$).ha.Oa.nc&&this.i_e(ff.g(this.$).ha.Oa.nc,F):this.i_e(ff.g(this.$).ha.Oa.wC,F));return F};hg.prototype.$Y=function(){var k=this.Ta,F=k.Cq(this.menuId),X=gf.a(this.$);if(this.$.isEditMode){var ra=k.Pc();this.YTc(k,F,ra);F.Ec.push(ra)}this.$.Yf.get(5)&&this.floatingObject.PTd()&&!this.Y9b()&&!X&&(ra=k.Pc(),this.jAg(k,ra),F.Ec.push(ra));(ra=this.$.xa.qa)&&ra.Yd&&(ra=ra.Yd.jy||ra.Yd.iK,!ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||
this.$.ea.isNamedObjectViewMode||X||this.$.isMobileMode||ra||(X=k.Pc(),this.dCg(k,X),F.Ec.push(X)));return F};hg.prototype.wac=function(k){var F=ff.g(this.$).ha.Oa.nc;k=k&&1!==k.zb&&k.clientPoint?k.clientPoint:Sys.UI.DomElement.getLocation(F.domElement);var X=this.$.domElement,ra=ff.g(this.$).rtl;(F=Sc.HelperMethods.KC(F.qg.domElement,X,ra))?(k.y=Math.max(k.y,F.y),k.x=Math.max(k.x,F.x)):Wd.ULS.sendTraceTag(537167047,5,15,"FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : {0}",
Rf.AFrameworkApplication.Ng);return k};hg.prototype.Tpd=function(){var k=ff.g(this.$).ha.Oa.nc;return!!k&&k.isEditing};hg.prototype.jAg=function(k,F){if(this.$.isEditMode){F.buttons.push(k.Cb(42));F.buttons.push(k.Cb(43));var X=this.$.da.za(254,!0);(X&&2===X.bBb()||ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.Tpd())&&F.buttons.push(k.Cb(44))}else F.buttons.push(k.Cb(43))};hg.prototype.dCg=function(k,F){F.buttons.push(k.Cb(274))};hg.prototype.Y9b=function(){return ve.EwaSettings.ma(468)&&
!!ff.g(this.$).ha.Oa.Ko};hg.prototype.i_e=function(k,F){5===k.floatingObject.type?ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&k.isEditing?F.push(Pc.a.Y_f):F.push(Pc.a.Tsj):F.push(ge.a.qTe)};hg.prototype.eEh=function(k){var F=this.Ta.Pc();F.buttons.push(this.Ta.Cb(282));F.buttons.push(this.Ta.Cb(281));var X=this.Ta.lw("BringToFront","BringToFrontMenuId",we.a.instance.ga(820),-1777747317);X.menu.Ec.push(F);k.buttons.push(X)};hg.prototype.CFh=function(k){var F=this.Ta.Pc();
F.buttons.push(this.Ta.Cb(284));F.buttons.push(this.Ta.Cb(283));var X=this.Ta.lw("SendToBack","SendToBackMenuId",we.a.instance.ga(821),-1777747317);X.menu.Ec.push(F);k.buttons.push(X)};Ck.Object.defineProperties(hg.prototype,{Qw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFloatingObjectContextMenu"}},AB:{configurable:!0,enumerable:!0,get:function(){return We.a.MKf}}});Object(ie.a)(hg,"FloatingObjectContextMenu",ge.a,[]);var Uf=b(996),Zf=b(102),Ne=b(618),ch=b(561),yh=We.a.A1g;Wl(Cg,
hg);Cg.prototype.executeCommand=function(k,F,X){var ra=this.$;this.zb=F.method;F=X[Cg.z_c];if(!(k&68)){if(!F){if(8===k)F=ch.a(ra).dd;else{var ab=ff.g(ra).ha.Oa.nc;if(null===ab||void 0===ab?0:ab.floatingObject)F=ab.floatingObject.dd}if(!F)return Xf.Task.Sa(!0)}this.isPivotChart=!!(F.Attributes&4)}if(this.isPivotChart||ra.isEditMode)if(this.refresh=this.pZ=this.Vva=this.DAa=!1,ab=ff.g(this.$).ha.Oa.nc,Wd.ULS.shipAssertTag(537167107,0,!!ab),ab){this.floatingObject=ab.floatingObject;ab=Ne.a(ra);if(null===
ab||void 0===ab?0:ab.gQd)this.DAa=ab=Zf.f(ra.mg),this.Vva=!ab;ab=ra.xc;this.pZ=!!Uf.a(ra)&&!!F&&!!(F.Attributes&512)&&!(k&8)&&ab.O2(32768);ab.allowManualDataRefresh&&ab.allowInteractivity&&(this.refresh=!0);k=this.wac(Object(ca.a)(xc.a,X.eventArgs));this.Fp(k,!0)}return Xf.Task.Sa(!0)};Cg.prototype.Mc=function(k,F,X){return-149612405===F.command&&!!X&&this.wgf(k)};Cg.prototype.YTc=function(k,F,X){this.isPivotChart&&(this.refresh&&X.buttons.push(k.Cb(100)),this.pZ&&X.buttons.push(k.Cb(99)),this.DAa?
X.buttons.push(k.Cb(59)):this.Vva&&X.buttons.push(k.Cb(58)));hg.prototype.YTc.call(this,k,F,X)};Ck.Object.defineProperties(Cg.prototype,{Qw:{configurable:!0,enumerable:!0,get:function(){return"PopulateChartContextMenu"}},AB:{configurable:!0,enumerable:!0,get:function(){return We.a.GKf}}});Ck.Object.defineProperties(Cg,{z_c:{configurable:!0,enumerable:!0,get:function(){return"chartMetaData"}}});Object(ie.a)(Cg,"ChartContextMenu",hg,[]);var nf=b(12),Ci=We.a.C1g,kh=ge.a;Wl(yf,kh);yf.prototype.executeCommand=
function(k,F,X){k=F.command;switch(k){case 330754562:F=X.domElement;this.isOlap=X.isOlap;this.qL=X.versionkey;this.uo=X.fieldItem;this.a_=X.isChart;this.VV=X.isPpm;this.RTd="supportsImplicitMeasures"in X?X.supportsImplicitMeasures:!1;ff.g(this.$).Gp(!0);k=nf.DOMElementExtensions.getBounds(F);k=new Sys.UI.Point(k.x+k.width,k.y+k.height/2);this.vTa(k,F);"isKeyboardInput"in X&&X.isKeyboardInput?this.Fp(k,!1,1):this.Fp(k,!1);break;case 926905850:this.RTd&&this.uo&&5===this.uo.TypeTag&&!this.uo.IsCollapsible&&
Wd.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");Ne.a(this.$).JJ(this.uo,8,-1,this.qL,F);break;case -67292059:Ne.a(this.$).JJ(this.uo,1,-1,this.qL,F);break;case 745182485:Ne.a(this.$).JJ(this.uo,2,-1,this.qL,F);break;case 359279088:Ne.a(this.$).JJ(this.uo,4,-1,this.qL,F);break;case 547535945:Ne.a(this.$).q3i(this.uo);break;default:return Rg.a(k)}return Xf.Task.Sa(!0)};yf.prototype.Mc=function(k,F,X){k=!1;switch(F.command){case 330754562:k=!!X;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:k=
!0}return k};yf.prototype.$Y=function(){var k=this.Ta.Cq(this.menuId);this.QXi(k);this.a_||this.isOlap||this.PXi(k);return k};yf.prototype.QXi=function(k){var F=this.Ta,X=F.Pc(),ra=!1;ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(ra=this.isOlap&&!this.VV&&this.RTd&&5===this.uo.TypeTag&&!this.uo.IsCollapsible);3!==this.uo.TypeTag&&37!==this.uo.TypeTag||this.uo.IsSet?17===this.uo.TypeTag||this.VV?(X.buttons.push(F.Cb(79)),X.buttons.push(F.Cb(this.a_?91:80)),
X.buttons.push(F.Cb(this.a_?92:81)),X.buttons.push(F.Cb(82))):13===this.uo.TypeTag||this.uo.IsSet?(X.buttons.push(F.Cb(83)),X.buttons.push(F.Cb(this.a_?91:80)),X.buttons.push(F.Cb(this.a_?92:81)),X.buttons.push(F.Cb(86))):(X.buttons.push(F.Cb(79)),X.buttons.push(F.Cb(this.a_?91:80)),X.buttons.push(F.Cb(this.a_?92:81)),X.buttons.push(F.Cb(ra?82:86))):(X.buttons.push(F.Cb(83)),X.buttons.push(F.Cb(this.a_?93:84)),X.buttons.push(F.Cb(this.a_?94:85)),X.buttons.push(F.Cb(82)));k.Ec.push(X)};yf.prototype.PXi=
function(k){var F=this.Ta.Pc();F.buttons.push(this.Ta.Cb(78));k.Ec.push(F)};Ck.Object.defineProperties(yf.prototype,{Qw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListContextMenu"}},AB:{configurable:!0,enumerable:!0,get:function(){return We.a.aGd}}});Object(ie.a)(yf,"FieldListContextMenu",ge.a,[]);var Xi=b(437),hi=b(63);Pe.prototype.get=function(k,F,X){var ra=this.f$f(k,"PivotFilterContextMenuCache.Get");return ra&&this.jN[ra]?this.jN[ra][Pe.Jed(F,this.$,k,X)]:null};Pe.prototype.set=
function(k,F,X,ra){var ab=this.f$f(k,"PivotFilterContextMenuCache.Set");ab&&(this.jN[ab]||(this.jN[ab]={}),this.jN[ab][Pe.Jed(F,this.$,k,ra)]=X)};Pe.prototype.k7b=function(k){k in this.jN&&this.jN[k]&&(this.jN[k]=null)};Pe.prototype.f$f=function(k,F){return hi.f(this.$.qa)?this.$.activeItemName:(k=this.kLj(k,F))?k.$d:null};Pe.prototype.kLj=function(k,F){k=vd.C(k);k=ff.g(this.$).Ea.mva(k,this.$.activeItemName);Wd.ULS.shipAssertTag(537167008,0,!!k,"PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: {0}",
F);return k};Pe.Jed=function(k,F,X,ra){return ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===ra?F.qa.index+"_"+k.id+"_"+X.FirstRow.toString()+"_"+X.FirstColumn.toString():F.qa.index+"_"+k.id};Object(ie.a)(Pe,"PivotFilterContextMenuCache",null,[]);Object(ie.a)(Ve,"ShowPivotFilterData",null,[]);var Mi=b(614),uj=b(1343),uh=b(54),Ui=We.a.dBe,Zh=ge.a;Wl(le,Zh);le.prototype.N9c=function(k,F){var X=this,ra=k.rawEvent,ab=k.cell,Qb=k.requiresConfirmation;Mi.a(this.$).Jx(Qb,function(Fc){if(Fc){Fc=
ra?new Sys.UI.DomEvent(ra):null;X.pivotData=new Ve;X.pivotData.pivotName=k.pivotName;X.pivotData.dataSourceIndex=k.dataSourceIndex;X.pivotData.cell=ab;X.pivotData.Go=k.optionalPivotMenuAnchorParameter;if(X.pivotData.Go&&0<X.pivotData.Go.AnchorType){X.imc=k.objectId;X.yDb=k.objectVersion;var ld=X.pivotData.Go.AnchorType;if(4===ld||5===ld||6===ld||11===ld||9===ld||10===ld||8===ld)X.jmb=k.location}else X.iyd=X.imc=null,X.jyd=X.yDb=-1;ff.g(X.$).Gp(!0);X.$.Pj(ab);X.K0(Fc,Fc?Fc.target:k.domElement,X.pivotData,
F,X.ULa())}});return!0};le.prototype.K0=function(k,F,X,ra){var ab=this;if(Object(Xi.a)(Ve,X)){this.pivotData=X;this.Z4b=F;this.tif=k;this.X1b=this.pivotData.Go?this.pivotData.Go.AnchorValue1:-1;this.AY=this.pivotData.Go?this.pivotData.Go.AnchorType:0;var Qb=!1,Fc=null;Fc=le.jN.get(this.pivotData.cell,F,this.AY);Qb=!!Fc;var ld=!0;switch(this.AY){case 4:case 5:case 6:this.Yca=new Sys.UI.Point(this.jmb.x,this.jmb.y);ld=!1;break;case 7:var ud=Sys.UI.DomElement.getBounds(F);ld=ud.x+(0<=ud.x?0:ud.width);
ud=ud.y+(0<=ud.y?0:ud.height);this.Yca=new Sys.UI.Point(0<=ld?ld:0,0<=ud?ud:0);ld=!1;break;case 8:case 10:case 9:case 11:this.Yca=new Sys.UI.Point(this.jmb.x,this.jmb.y);break;default:this.Yca=null}Qb&&this.imc===this.iyd&&this.yDb===this.jyd&&this.X1b===this.Wwe&&this.AY===this.Zoe?(Wd.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.wrb=Fc,this.Yca?(this.vTa(this.Yca,F),this.Fp(this.Yca,this.ULa())):this.hy?(!ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")||
ge.a.Tmd(this.$,this.pivotData.cell))&&this.Fp(ge.a.Wcd(this.$,this.pivotData.cell,!1),this.ULa()):Zh.prototype.K0.call(this,k,F,X,ra,this.ULa())):1!==le.$Mh(F)&&(ld&&(F.parentNode.menuFetchStates=1,this.Anj(F),this.oXf(!0)),this.$.userOperationManager.jc(new cg.a(126,0,function(jd,Ye,Bf){var Tg=ab.$;return Yg.A(Tg.na.va,ab.pivotData.cell,ab.pivotData.dataSourceIndex,ab.pivotData.pivotName,Tg.domElement.id,Tg.isChromeRtl,Tg.workbookContext.NovMode,hh.b(jd,ab.dKi),hh.a(Ye,ab.cKi),Bf,F,ab.pivotData.Go)},
16),ra))}};le.prototype.nDd=function(k){Array.addRange(k.MenuSectionList,this.wrb)};le.prototype.kvd=function(k,F){k.parentNode.menuFetchStates=2;this.oXf(!1);if(F){if(this.Z4b!==k||this.wyi())this.vTa(this.Yca,k),this.Fp(this.Yca,this.ULa());else if(this.hy&&!this.Yca){if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!ge.a.Tmd(this.$,this.pivotData.cell))return;this.Fp(ge.a.Wcd(this.$,this.pivotData.cell,!1),this.ULa())}else Zh.prototype.K0.call(this,this.tif,
k,null,null,this.ULa());this.iyd=this.imc;this.jyd=this.yDb;this.Zoe=this.AY;this.Wwe=this.X1b}};le.prototype.ULa=function(){return 8!==this.AY&&9!==this.AY&&10!==this.AY&&11!==this.AY};le.prototype.wyi=function(){switch(this.pivotData.Go?this.pivotData.Go.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}};le.prototype.oXf=function(k){var F=this.Z4b;if(F){if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var X=nf.DOMElementExtensions.yZ(F,
"ewaprevsrc","");X=!!X&&"null"!==X}else X=!!nf.DOMElementExtensions.yZ(F,"ewaprevsrc","");k&&X||!k&&!X||(k?(F.setAttribute("ewaprevsrc",F.src),F.src=uh.a.current.hp(78)):(k=nf.DOMElementExtensions.yZ(F,"ewaprevsrc",""),F.src=k,F.setAttribute("ewaprevsrc",null)))}};le.prototype.Anj=function(k){this.Z4b=k};le.$Mh=function(k){var F=k.parentNode.menuFetchStates;void 0===F&&(k.parentNode.menuFetchStates=0);return F};le.jN=null;Object(ie.a)(le,"PivotFilterContextMenuBase",ge.a,[]);var fi="FieldList"+We.a.dBe;
Wl(td,le);td.prototype.executeCommand=function(k,F,X){return this.N9c(X,F)?Xf.Task.Sa(!0):Rg.a(F.command)};td.prototype.Mc=function(k,F,X){return-1065117584===F.command&&!!X};Ck.Object.defineProperties(td.prototype,{Qw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListPivotMenu"}},AB:{configurable:!0,enumerable:!0,get:function(){return We.a.KKf}}});Object(ie.a)(td,"FieldListPivotContextMenu",le,[]);var wg=b(29),gj=b(936);Object(ie.a)(od,"PivotValueFieldSettingsApplyData",null,
[]);Bc.yah="dataFieldCustomLabel";Bc.nFe="dataFieldSourceLabel";Bc.TRd="showValueAsSelect";Bc.RRd="showValueAsBaseFieldSelect";Bc.SRd="showValueAsBaseItemSelect";Bc.eZd="valueFieldsSettingsFieldName";Bc.keg="valueFieldSettingTabs";Object(ie.a)(Bc,"CssElementIds",null,[]);var Ei=b(118);Object(ie.a)(gg,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);vg.prototype.getActiveCell=function(){return this.activeCell};Object(ie.a)(vg,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[450]);var Fi=
b(243);Object(ie.a)(kg,"PivotValueFieldShowValueAsApplyData",null,[]);var ck=b(935),Uh=b(44),Xg="<div id='showValueAsControlBody'><label for='"+Bc.TRd+"' class='"+Ei.a.Qn+" valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='"+Bc.TRd+"' class='"+Ei.a.GC+"'></select></div><div class='showValueAsControlSelectRegion'><label for='"+Bc.RRd+"'>{1}</label><div><select size=6 id='"+Bc.RRd+"' class='"+Ei.a.GC+"'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='"+
Bc.SRd+"'>{2}</label><div><select size=6 id='"+Bc.SRd+"' class='"+Ei.a.GC+"'></select></div></div></div>",Oi=Fi.a;Wl(Le,Oi);Le.prototype.Kja=function(){return this.isVisible};Le.prototype.Kna=function(k){return this.isVisible=k};Le.prototype.setFocus=function(){nf.DOMElementExtensions.setFocus(this.G3.$n)};Le.prototype.render=function(k){k.appendChild(this.domElement)};Le.prototype.dispose=function(){zg.a.Dc([this.G3,this.iU,this.JP,this.D5b,this.r0b]);Oi.prototype.dispose.call(this)};Le.prototype.dqj=
function(k){zg.a.Dc([this.D5b,this.r0b]);this.G3.clear();for(var F=Gl(k.DataFormatTypes),X=F.next();!X.done;X=F.next())X=X.value,this.G3.VL(Le.kLh(X),X.toString(),X===k.SelectedDataFormat);this.D5b=this.Ae.je(this.G3.domElement);this.D5b.ka("change",this.cvf);this.iU.clear();F=Gl(k.BaseFieldList);for(X=F.next();!X.done;X=F.next())X=X.value,this.iU.VL(X.DisplayString,X.Id.toString(),X.Id===k.SelectedBaseField);this.r0b=this.Ae.je(this.G3.domElement);this.r0b.ka("change",this.YEi);this.qF=this.$ha.qrb(this.JP.$n.parentNode,
1E3,null,"",738);this.cvf(null)};Le.prototype.YQ=function(k){this.G3.YQ(k);this.iU.YQ(k);this.JP.YQ(k)};Le.prototype.eka=function(){this.domElement.innerHTML=String.format(Xg,we.a.instance.ga(1095),we.a.instance.ga(1096),we.a.instance.ga(1097));this.Y3d=new ck.a(nf.DOMElementExtensions.getElementById(this.domElement,Bc.TRd),!1);this.G1d=new ck.a(nf.DOMElementExtensions.getElementById(this.domElement,Bc.RRd),!1);this.H1d=new ck.a(nf.DOMElementExtensions.getElementById(this.domElement,Bc.SRd),!1)};
Le.prototype.STg=function(k){return this.Gii||!Le.Jaf(k)&&!Le.Kaf(k)?!0:!!this.iU.count};Le.prototype.getValueFieldSettingsShowValueAsBaseItemsInfo=function(){var k=this;this.$.userOperationManager.jc(new cg.a(108,0,function(F,X,ra){var ab=k.$.na.va,Qb=parseInt(k.iU.ye.value,10);F=hh.b.call(null,F,k.YKi);var Fc=Yg.nb(ab,k.cell,k.externalSourceIndex,k.Go);Fc.selectedBaseField=Qb;return Yg.i(ab,"GetPivotValueFieldSettingsShowValueAsBaseItems",Fc,F,X,ra,null,4)},16),this.Sd)};Le.prototype.akf=function(){this.JP.clear();
this.iU.ye&&(this.qF.qSa(),this.JP.$n.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())};Le.prototype.NNb=function(k){var F=document.getElementById("WACDialogActionButton");this.yQj&&F&&(F.disabled=k)};Le.kLh=function(k){switch(k){case 0:return we.a.instance.ga(1098);case 1:return we.a.instance.ga(1099);case 2:return we.a.instance.ga(1100);case 3:return we.a.instance.ga(1101);case 4:return we.a.instance.ga(1102);case 5:return we.a.instance.ga(1103);case 6:return we.a.instance.ga(1104);
case 7:return we.a.instance.ga(1105);case 8:return we.a.instance.ga(1107);case 9:return we.a.instance.ga(1108);case 10:return we.a.instance.ga(1109);case 11:return we.a.instance.ga(1110);case 12:return we.a.instance.ga(1111);case 13:return we.a.instance.ga(1112);case 14:return we.a.instance.ga(1113);default:return""}};Le.Jaf=function(k){return 11===k||12===k||14===k||13===k||4===k};Le.Kaf=function(k){return 1===k||3===k||2===k};Ck.Object.defineProperties(Le.prototype,{title:{configurable:!0,enumerable:!0,
get:function(){return we.a.instance.ga(1094)}},Kvb:{configurable:!0,enumerable:!0,get:function(){var k=this.G3.ye?parseInt(this.G3.ye.value,10):-1,F=this.iU.ye?parseInt(this.iU.ye.value,10):-1,X=this.JP.ye?parseInt(this.JP.ye.value,10):-1;return Object(na.a)(new kg,{SelectedDataFormat:0<=k?k:-1,SelectedBaseField:F,SelectedBaseItem:X})}},iU:{configurable:!0,enumerable:!0,get:function(){return this.G1d}},JP:{configurable:!0,enumerable:!0,get:function(){return this.H1d}},G3:{configurable:!0,enumerable:!0,
get:function(){return this.Y3d}}});Object(ie.a)(Le,"ShowValueAsControl",Fi.a,[811,3]);Object(ie.a)(Pf,"PivotValueFieldSummarizeValueByApplyData",null,[]);var Wj="<div id='summarizeValuesByControlBody'><label class='"+(Ei.a.Qn+" valueFielsSettingsControlTitle' for='pivotDataFieldSelect'>{0}</label><div id='pivotDataFieldSelectDescription' class='")+(Ei.a.Qn+" summarizeValuesByControlDescription'>{1}</div><div><select class='")+(Ei.a.GC+"' size=6 id='pivotDataFieldSelect' style='width: 100%' "+We.a.JG+
"='pivotDataFieldSelectDescription'></select></div></div>"),Pj=Fi.a;Wl(Re,Pj);Re.prototype.Kja=function(){return this.isVisible};Re.prototype.Kna=function(k){return this.isVisible=k};Re.prototype.setFocus=function(){nf.DOMElementExtensions.setFocus(this.jl.$n)};Re.prototype.render=function(k){k.appendChild(this.domElement)};Re.prototype.dispose=function(){zg.a.Ha(this.jl);Pj.prototype.dispose.call(this)};Re.prototype.focus=function(){nf.DOMElementExtensions.setFocus(this.jl.$n)};Re.prototype.cqj=
function(k){this.jl.RSd();for(var F=Gl(k.AggregationTypes),X=F.next();!X.done;X=F.next()){X=X.value;var ra=X===k.SelectedAggregation;this.jl.VTc(Re.TGh(X),X.toString(),ra,"")}this.jl.z7c();this.jl.$n.disabled=k.AggregationsDisabled};Re.prototype.Efj=function(){this.jl.Ffj()};Re.prototype.eka=function(){this.domElement.innerHTML=String.format(Wj,we.a.instance.ga(1078),we.a.instance.ga(1079));this.$ce=new ck.a(nf.DOMElementExtensions.getElementById(this.domElement,Re.KFf),!1)};Re.TGh=function(k){switch(k){case 0:return we.a.instance.ga(1081);
case 1:return we.a.instance.ga(1082);case 2:return we.a.instance.ga(1083);case 3:return we.a.instance.ga(1084);case 4:return we.a.instance.ga(1085);case 5:return we.a.instance.ga(1086);case 6:return we.a.instance.ga(1087);case 7:return we.a.instance.ga(1088);case 8:return we.a.instance.ga(1089);case 9:return we.a.instance.ga(1090);case 10:return we.a.instance.ga(1091);case 11:return we.a.instance.ga(1092);default:return""}};Ck.Object.defineProperties(Re.prototype,{Kvb:{configurable:!0,enumerable:!0,
get:function(){var k=this.jl.ye?parseInt(this.jl.ye.value,10):-1;return Object(na.a)(new Pf,{Aggregation:0<=k?k:-1})}},title:{configurable:!0,enumerable:!0,get:function(){return we.a.instance.ga(1093)}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.jl.$n.disabled},set:function(k){this.jl.$n.disabled=!k}},jl:{configurable:!0,enumerable:!0,get:function(){return this.$ce}}});Re.KFf="pivotDataFieldSelect";Object(ie.a)(Re,"SummarizeValuesByControl",Fi.a,[811,3]);var L=b(215),Ma=b(494);
Ce.prototype.hFj=function(k,F){k.set_visible(!1);F.set_visible(!0)};Object(ie.a)(Ce,"DefaultTabSwitchBehaviour",null,[826]);Rd.VFj="TabsContainer";Rd.EFj="TabTitlesContainer";Rd.CFj="TabTitle";Rd.DFj="TabTitleText";Rd.oUd="TabTitleActive";Object(ie.a)(Rd,"MultitabControlStyles",null,[]);var rb=b(42),ec=b(86),fd=b(90),yd=b(56);Gc.prototype.dispose=function(){rb.a.removeHandler(this.gk,"keyup",Object(Df.a)(this,this.Q9a,"onTitleKeyUp"));rb.a.removeHandler(this.gk,"click",this.iGc);this.gk=this.Cfa=
null};Gc.prototype.setActive=function(k){k?Sys.UI.DomElement.addCssClass(this.gk,Rd.oUd):Sys.UI.DomElement.removeCssClass(this.gk,Rd.oUd);this.Cfa&&this.Cfa.setAttribute(fd.a.eha,k)};Gc.prototype.Q9a=function(k){k.keyCode!==ec.a.ei&&k.keyCode!==ec.a.Soa||this.iGc(k)};Gc.prototype.fBc=function(){this.gk.setAttribute(fd.a.Wd,fd.a.Ts);this.Cfa.setAttribute(fd.a.Ot,this.Qp);this.Cfa.setAttribute(fd.a.Wd,fd.a.Ynb)};Ck.Object.defineProperties(Gc.prototype,{wc:{configurable:!0,enumerable:!0,get:function(){return this.gk}},
title:{configurable:!0,enumerable:!0,get:function(){return this.Qp}},isActive:{configurable:!0,enumerable:!0,get:function(){return Sys.UI.DomElement.containsCssClass(this.gk,Rd.oUd)},set:function(k){this.setActive(k)}}});Object(ie.a)(Gc,"TabTitleControl",null,[3]);var be=b(39);id.prototype.bQf=function(){this.Wlb=document.createElement("ul");this.Wlb.className=Rd.EFj;this.Olb=document.createElement("div");this.Olb.className=Rd.VFj;for(var k=0;k<this.gzc;++k){var F=this.rga.oa(k),X=this.REa.oa(k);
F.set_visible(!1);X.isActive=!1;var ra=document.createElement("div");F.render(ra);this.Olb.appendChild(ra);this.Wlb.appendChild(X.wc)}this.wc.appendChild(this.Wlb);this.wc.appendChild(this.Olb);this.Tqd(this.p1)&&(this.REa.oa(this.p1).isActive=!0,this.rga.oa(this.p1).set_visible(!0))};id.prototype.dispose=function(){for(var k=0;k<this.gzc;++k)this.rga.oa(k).dispose(),this.REa.oa(k).dispose();this.REa=this.rga=this.gk=this.Olb=this.Wlb=null};id.prototype.setFocus=function(){this.rga.oa(this.p1).setFocus()};
id.prototype.Tqd=function(k){return 0<=k&&k<this.gzc};id.prototype.U6f=function(k){this.p1!==k&&this.Tqd(k)&&(this.ywg.hFj(this.rga.oa(this.p1),this.rga.oa(k)),this.REa.oa(this.p1).isActive=!1,this.REa.oa(k).isActive=!0,this.p1=k,this.setFocus())};id.prototype.A5g=function(k){var F=this;return function(){F.U6f(k)}};Ck.Object.defineProperties(id.prototype,{gzc:{configurable:!0,enumerable:!0,get:function(){return this.rga.count}},activeTab:{configurable:!0,enumerable:!0,get:function(){return this.p1},
set:function(k){this.U6f(k)}},wc:{configurable:!0,enumerable:!0,get:function(){return this.gk}},visible:{configurable:!0,enumerable:!0,get:function(){return be.a.isVisible(this.gk)},set:function(k){this.gk.style.visibility=k?"visible":"hidden"}}});Object(ie.a)(id,"MultitabControl",null,[810,3]);var xe=gj.a;Wl(jc,xe);jc.prototype.dispose=function(){this.M4c=this.Jrb=this.ZRa=this.ARc=null;zg.a.Ha(this.Ofa);this.Ofa=null;xe.prototype.dispose.call(this)};jc.prototype.initialize=function(){var k="<div id='"+
Bc.nFe+"' class='"+Ei.a.Qn+"'></div><div id='"+Bc.yah+"' class='"+Ei.a.Qn+"'><label for='"+Bc.eZd+"'>{0}</label><input type='text' id='"+Bc.eZd+"' value='{1}' class='"+Ei.a.GC+" UIFont' /></div><div id='"+Bc.keg+"'></div>";k=String.format(k,we.a.instance.ga(1077),wg.a.vg(this.jeg));this.Qb.innerHTML=k;this.Oe||(this.C2(),this.Ll());this.zie=[-103190598];this.lZh();xe.prototype.initialize.call(this)};jc.prototype.close=function(k){1===k&&(this.T1f=!1);xe.prototype.close.call(this,k)};jc.prototype.sHe=
function(k){this.eR=k;this.domElement.disabled=k;for(var F=["input","option","select"],X=0,ra=F.length;X<ra;++X)for(var ab=this.domElement.getElementsByTagName(F[X]),Qb=0;Qb<ab.length;++Qb)ab[Qb].disabled=k};jc.prototype.Ll=function(){this.Jrb=document.getElementById(Bc.eZd);this.M4c=nf.DOMElementExtensions.getElementById(this.Qb,Bc.nFe);var k=nf.DOMElementExtensions.getElementById(this.Qb,Bc.keg);this.ARc=new Re(document.createElement("div"));this.ZRa=new Le(document.createElement("div"),this.$,
this.cell,this.Go,this.externalSourceIndex,this.Sd,this.$ha,!this.isOlap);var F;this.Ofa=new id(k,(F=new Ka.a,F.add(this.ESa),F.add(this.ZRa),F));this.Ofa.bQf()};jc.prototype.zDd=function(){var k=new jc(this.cell,this.Go,this.externalSourceIndex,this.jeg,this.$,this.Sd,this.$ha,this.isOlap,this.VV);k.initialize();k.Af()};jc.prototype.lfb=function(){var k=new Ma.a;if(!this.T1f)return k.isValid=!0,k;this.Jrb.value.length?k.isValid=!0:(this.sHe(!0),k.error=Vf.a.gd(1,0,753,768,0,1783218700,"PivotTableValueFieldNoBlank"),
this.eR=!0,this.Oe||(this.Hx.disabled=!0),k.isValid=!1);return k};jc.prototype.w4e=function(){this.eR=!1;this.Oe||(this.Hx.disabled=!1);this.sHe(!1)};jc.prototype.jya=function(k){var F=new jh.a(2105621672,0,this.$.Xc,30,null);this.$.Ka.Wb(F);this.VW(5,k.zb,"Number Format");return!0};jc.prototype.Bn=function(){this.iBa=String.format(we.a.instance.Bb(61),null);xe.prototype.Bn.call(this)};jc.prototype.setFocus=function(){if(this.Oe){var k=nf.DOMElementExtensions.getElementById(this.Qb,Re.KFf);L.a.HAc(k)}else this.Ofa.setFocus()};
jc.prototype.oj=function(){var k=this,F=this.ZRa.Kvb,X=new gg(F.SelectedDataFormat,F.SelectedBaseField,F.SelectedBaseItem);return function(){return new vg(k.externalSourceIndex,k.cell,k.Jrb.value,k.ESa.Kvb.Aggregation,X)}};jc.prototype.Zy=function(){var k=this,F=Object(na.a)(new od,{PivotValueFieldSummarizeValueByApplyData:this.ESa.Kvb,PivotValueFieldShowValueAsApplyData:this.ZRa.Kvb,PivotValueFieldTitle:this.Jrb.value});return function(X,ra,ab){var Qb=k.$.na.va;X=hh.b(X,k.NEi);var Fc=Yg.nb(Qb,k.cell,
k.externalSourceIndex,k.Go);Fc.pivotValueFieldSettingsApplyData=F;return Yg.i(Qb,"ApplyPivotValueFieldSettings",Fc,X,ra,ab,null,0)}};jc.prototype.YQ=function(k){var F=this;this.$.da.$a(40,function(){F.ZRa.YQ(k)})};jc.prototype.lZh=function(){var k=this;this.$.userOperationManager.jc(new cg.a(123,0,function(F,X,ra){var ab=k.$.na.va;F=hh.b.call(null,F,k.XKi);var Qb=Yg.nb(ab,k.cell,k.externalSourceIndex,k.Go);return Yg.i(ab,"GetPivotValueFieldSettingsInitial",Qb,F,X,ra,null,4)},16),this.Sd)};Ck.Object.defineProperties(jc.prototype,
{Cc:{configurable:!0,enumerable:!0,get:function(){return"ValueFieldSettingsDialog"}},Eea:{configurable:!0,enumerable:!0,get:function(){return this.zie}},VCb:{configurable:!0,enumerable:!0,get:function(){return this.Ofa}},ESa:{configurable:!0,enumerable:!0,get:function(){return this.ARc}},Mv:{configurable:!0,enumerable:!0,get:function(){return 560}}});Object(ie.a)(jc,"ValueFieldSettingsDialog",gj.a,[]);var cf=We.a.D1g,ze=ge.a;Wl(qb,ze);qb.prototype.executeCommand=function(k,F,X,ra){var ab=this;k=F.command;
switch(k){case -1453503574:ra=X.domElement;this.uo=X.fieldItem;this.l_d=X.zoneCount;this.lSa=X.sourceAxis;this.jyc=X.sourceAxisPos;this.Go=X.optionalPivotMenuAnchorParameter;this.qL=X.versionkey;this.isOlap=X.isOlap;this.VV=X.isPpm;this.t2a="fieldItemsupportsImplicitMeasures"in X?X.fieldItemsupportsImplicitMeasures:!1;this.cell=X.cell;this.externalSourceIndex=X.externalSourceIndex;ff.g(this.$).Gp(!0);k=nf.DOMElementExtensions.getBounds(ra);var Qb=new Sys.UI.Point(k.x,k.y+k.height);this.$.isChromeRtl&&
(Qb.x+=k.width);this.vTa(Qb,ra);"isKeyboardInput"in X&&X.isKeyboardInput?this.Fp(Qb,!1,1):this.Fp(Qb,!1);break;case 495005930:break;case -1170196828:Ne.a(this.$).JJ(this.uo,this.lSa,this.jyc-1,this.qL,F);break;case -889576107:Ne.a(this.$).JJ(this.uo,this.lSa,this.jyc+2,this.qL,F);break;case 2033235475:Ne.a(this.$).JJ(this.uo,this.lSa,this.l_d,this.qL,F);break;case 389774337:Ne.a(this.$).JJ(this.uo,this.lSa,0,this.qL,F);break;case -96230454:Ne.a(this.$).JJ(this.uo,4,-1,this.qL,F);break;case 74086617:Ne.a(this.$).JJ(this.uo,
1,-1,this.qL,F);break;case 1529312473:Ne.a(this.$).JJ(this.uo,2,-1,this.qL,F);break;case 563292088:this.t2a&&Wd.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");Ne.a(this.$).JJ(this.uo,8,-1,this.qL,F);break;case -1092351914:Ne.a(this.$).JJ(this.uo,0,-1,this.qL,F);break;case -2141589616:var Fc=eh.GetServiceTaskFactory.Xa(this.$.da,12,477,ra.Dja());return Ud.TaskExtensions.Ba(Fc,function(){(new jc(ab.cell,ab.Go,ab.externalSourceIndex,ab.uo.Name,ab.$,F,Fc.result,
ab.isOlap,ab.VV)).initialize()},this.la);default:return Rg.a(k)}return Xf.Task.Sa(!0)};qb.prototype.Mc=function(k,F,X){k=!1;switch(F.command){case -1453503574:k=!!X;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:k=!0}return k};qb.prototype.$Y=function(){var k=this.Ta.Cq(this.menuId);this.XXi(k,this.jyc,this.l_d);this.YXi(k,this.lSa);this.ZXi(k);8===this.lSa&&this.VXi(k);
return k};qb.prototype.XXi=function(k,F,X){var ra=this.Ta,ab=ra.Pc();F||F!==X-1?!F&&F<X-1?(ab.buttons.push(ra.Cb(64)),ab.buttons.push(ra.Cb(61)),ab.buttons.push(ra.Cb(66)),ab.buttons.push(ra.Cb(63))):0<F&&F<X-1?(ab.buttons.push(ra.Cb(60)),ab.buttons.push(ra.Cb(61)),ab.buttons.push(ra.Cb(62)),ab.buttons.push(ra.Cb(63))):0<F&&F===X-1&&(ab.buttons.push(ra.Cb(60)),ab.buttons.push(ra.Cb(65)),ab.buttons.push(ra.Cb(62)),ab.buttons.push(ra.Cb(67))):(ab.buttons.push(ra.Cb(64)),ab.buttons.push(ra.Cb(65)),ab.buttons.push(ra.Cb(66)),
ab.buttons.push(ra.Cb(67)));k.Ec.push(ab)};qb.prototype.YXi=function(k,F){var X=this.Ta,ra=X.Pc(),ab=1!==F&&(!this.isOlap||this.VV||8!==F||this.t2a),Qb=2!==F&&(!this.isOlap||this.VV||8!==F||this.t2a),Fc=8!==F&&-2!==this.uo.PivotTableIndex&&(!this.isOlap||this.VV||this.t2a);ra.buttons.push(X.Cb(4===F||this.uo.IsSet||-2===this.uo.PivotTableIndex||this.isOlap&&!this.VV&&8===F&&!this.t2a?72:68));8===this.Go.AnchorType||10===this.Go.AnchorType?(ra.buttons.push(X.Cb(ab?95:97)),ra.buttons.push(X.Cb(Qb?96:
98))):(ra.buttons.push(X.Cb(ab?69:73)),ra.buttons.push(X.Cb(Qb?70:74)));ra.buttons.push(X.Cb(Fc?71:75));k.Ec.push(ra)};qb.prototype.ZXi=function(k){var F=this.Ta.Pc();F.buttons.push(this.Ta.Cb(76));k.Ec.push(F)};qb.prototype.VXi=function(k){var F=this.Ta.Pc();F.buttons.push(this.Ta.Cb(77));k.Ec.push(F)};Ck.Object.defineProperties(qb.prototype,{Qw:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldWellContextMenu"}},AB:{configurable:!0,enumerable:!0,get:function(){return We.a.bGd}}});
Object(ie.a)(qb,"FieldWellContextMenu",ge.a,[]);var Yf=b(1309);Wl(Aa,le);Aa.prototype.executeCommand=function(k,F,X){var ra=!1,ab=F.command;switch(ab){case 37023044:ra=this.N9c(X,F);break;case 541421805:case -569786022:ra=this.gid(k,F)}return ra?Xf.Task.Sa(!0):Rg.a(ab)};Aa.prototype.Mc=function(k,F,X){k=!1;switch(F.command){case 37023044:k=!!X;break;case 541421805:case -569786022:k=!0}return k};Aa.prototype.gid=function(k,F){var X=8===k,ra=this.$,ab=ch.a(ra),Qb=ff.g(ra).ha.Oa.nc,Fc=k=null;X&&ab?(k=
ab.chartId,Fc=ab.dd):!X&&Qb&&(k=Qb.floatingObject.id,Fc=Qb.floatingObject.dd);return Aa.Yqe(Fc,260)?(X={},ra.Pj(X),X.FirstColumn=X.FirstRow=-1,ra={},Fc=(ra.rawEvent=null,ra.pivotName=null,ra.cell=X,ra.requiresConfirmation=Aa.Yqe(Fc,64),ra.dataSourceIndex=Fc.ExternalSourceIndex,ra),Qb?(ab=Qb.floatingObject,Fc.domElement=Qb.domElement,Fc.objectId=ab.id,Fc.objectVersion=ab.version):ab&&(Fc.domElement=ab.wl,Fc.objectId=ab.chartId,Fc.objectVersion=ab.Ywe),Qb={AnchorType:7},Qb.ChartId=k,Qb.AnchorValue1=
-1,Qb.AnchorValue2=-1,Fc.optionalPivotMenuAnchorParameter=Qb,this.N9c(Fc,F)):!1};Aa.Yqe=function(k,F){return(k.Attributes&F)===F};Ck.Object.defineProperties(Aa.prototype,{Qw:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotContextMenu"}},AB:{configurable:!0,enumerable:!0,get:function(){return We.a.QKf}}});Object(ie.a)(Aa,"PivotFilterContextMenu",le,[]);var Sg=b(1342),eg=b(1048),Pg=b(160),Vh=b(28),fe=We.a.H1g,af=fe+".RemoveField",zh=fe+".Subtotal",yi=fe+".ClearFilter",ag=fe+".LayoutSameColumn",
Zj=fe+".LayoutNextColumn",T=ge.a;Wl(da,T);da.prototype.executeCommand=function(k,F,X){F=F.command;k=null;this.grid=ff.g(this.$);this.activeCell=vd.o(this.grid.ha.ta.activeCell,this.$);if(this.$.isEditMode&&(this.Fc=this.grid.Nb.gp(this.grid.ha.ta.activeCell),!this.Fc))return Wd.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),Ud.TaskExtensions.G4();this.SZd=this.$.na.va;this.l0a=Object(ca.a)(xc.a,X.eventArgs);switch(F){case 671488277:this.bwj()?this.NSh():(this.wbb(),this.showPivotTableContextMenu());
break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,
5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.xRa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.xRa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);break;case 786592977:this.xRa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.xRa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);
break;case 282586693:this.xRa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.xRa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:X=Number.parseInvariant(X.MenuItemId.split(".")[2]);this.xRa(11,X);this.applyValueFieldSettingsToPivotTable(-2031744961);break;case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Ud(-1556797033,Sf.a.Sb,8,null);break;case 1514686611:this.Mpi();
break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:X=Number.parseInvariant(X.MenuItemId);this.LXg(X);break;case 1778578888:X=Number.parseInvariant(X.MenuItemId);this.PJg(X);break;default:k=Rg.a(F)}return k||Ud.TaskExtensions.G4()};da.prototype.Mc=function(k,F){k=!1;switch(F.command){case 671488277:k=eg.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:k=!0;break;case 1600778266:k=!0;break;case -556893687:k=!0;break;case -1966978671:k=
!0;break;case -1951357930:k=!0;break;case -1390365353:case -1457478532:k=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:k=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:k=!0;break;case -1007663920:case 234234584:case 1194992911:k=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:k=
!0}return k};da.prototype.bwj=function(){if(!this.$.isEditMode||this.Fc.Zfc)return!1;var k=this.U0f(!1);return ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?!this.Fc.isOlap||k:!this.Fc.Wod()||k};da.prototype.$c=function(k,F){var X=!1;switch(F){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:X=this.sS();break;case -1007663920:case 234234584:X=
this.Guj()||this.sS();break;case 1194992911:X=this.Huj()||this.sS();break;case 1217404289:X=!Sg.j(this.Fb.LabelOrDateFilterType)||this.sS();break;case -743135194:X=!Sg.m(this.Fb.ValueFilterType)&&!Sg.l(this.Fb.ValueFilterType)||this.sS();break;case 771421327:X=0===this.Fb.LabelOrDateFilterType&&0===this.Fb.ValueFilterType&&!this.Fb.HasManualFilter||this.sS();break;case 1015867427:X=!Sg.i(this.Fb.LabelOrDateFilterType)||this.sS();break;case 1105960559:X=!Sg.k(this.Fb.LabelOrDateFilterType)||this.sS()}return X||
T.prototype.$c.call(this,k,F)};da.prototype.wbb=function(){this.N$a=this.Fb=this.$f=null};da.prototype.CTd=function(){this.grid.zP(this.Tq);this.$.Ka.zYa(this.sy)};da.prototype.nXd=function(){this.grid.LK(this.Tq);this.$.Ka.XHb(this.sy)};da.prototype.dKb=function(){if(this.Fc&&this.Fc.To){this.$f=this.Fc.To;this.Fb=this.Fc.Aac();if(this.H1f()){var k=this.Fc.WK[4===this.$f.CellType?this.Fc.O4c-1:this.$f.CurrentFieldIndex-1];k&&(this.N$a=-2===k.Index?this.Fc.sFe:k.Caption)}this.Q8h();this.Fb&&8===this.$f.CellArea&&
(this.bA.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.Fb.DataFieldAggregationType,this.bA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.Fb.DataFieldFormatType,this.bA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.Fb.BaseFieldIndex,this.bA.PivotValueFieldTitle=this.Fb.Caption)}};da.prototype.U0f=function(k){return this.Fc?this.Fc.isOlap&&!this.Fc.b7a(!k):!1};da.prototype.Ouj=function(){var k=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",
!1);return 1!==this.Fb.MeasureType&&(!this.Fc.nff||k&&2===this.Fb.MeasureType)};da.prototype.$Y=function(){var k=this.Ta.Cq(this.menuId),F=this.Ta.Pc();if(this.Fc)this.$f&&this.Fc.To&&this.$f!==this.Fc.To&&Wd.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.Fb&&this.Fb!==this.Fc.Aac()&&Wd.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return k;this.iEh(k);if(this.$.isEditMode){this.refresh&&
this.vFh(k);if(this.$f&&this.Fb){var X=this.Ta.Pc();this.KFh(X);this.xEh(X);k.Ec.push(X)}this.pZ&&F.buttons.push(this.Ta.Cb(99));this.$f&&this.Fb&&this.UEh(k);if(this.expandCollapse){X=this.Ta.lw("ContextMenu.PivotExpandCollapse",null,we.a.instance.ga(1142),589118293);var ra=this.Ta.Pc();ra.buttons.push(this.Ta.Cb(243));ra.buttons.push(this.Ta.Cb(244));ra.buttons.push(this.Ta.Cb(245));ra.buttons.push(this.Ta.Cb(246));X.menu.Ec.push(ra);X&&0<ra.buttons.length&&F.buttons.push(X)}this.$f&&this.wFh(k);
this.$f&&this.Fb&&8===this.$f.CellArea&&8!==this.$f.CellType&&(X=this.Ta.Pc(),this.Ouj()&&this.MFh(X),3!==this.$f.CellType&&this.HFh(X),k.Ec.push(X));!this.Fc.isOlap&&this.$f&&0===this.$f.CellType&&ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.GFh(k);this.nji()?F.buttons.push(this.Ta.Cb(257)):F.buttons.push(this.Ta.Cb(258));this.Nnd?F.buttons.push(this.Ta.Cb(59)):F.buttons.push(this.Ta.Cb(58))}k.Ec.push(F);return k};da.prototype.PQd=function(){return this.Fb&&
this.Fb.Caption?20<this.Fb.Caption.length:!1};da.prototype.Edd=function(k){return this.Fb&&this.Fb.Caption?k?this.Fb.Caption.substring(0,20)+"...":this.Fb.Caption:""};da.prototype.nva=function(k){return ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?Z.a.hashCode(k).toString():k};da.prototype.KFh=function(k){if(this.$f&&this.Fb&&4!==this.$f.CellArea){var F=this.Rua(this.jH("PivotTableContextMenu.Sort",this.nva(this.Fb.Caption)),-1777747317,0,0!==this.Fb.SortInfo,
we.a.instance.ga(228)),X=this.Ta.Pc();X.buttons.push(this.fe("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.Fb.SortInfo,we.a.instance.ga(229)));X.buttons.push(this.fe("PivotTableContextMenu.SortDescending",234234584,0,2===this.Fb.SortInfo,we.a.instance.ga(230)));1!==this.$f.CellArea&&2!==this.$f.CellArea||X.buttons.push(this.fe("PivotTableContextMenu.SortByValue",1194992911,0,3===this.Fb.SortInfo||4===this.Fb.SortInfo,we.a.instance.ga(155)));F.menu.Ec.push(X);F&&0<X.buttons.length&&
k.buttons.push(F)}};da.prototype.xEh=function(k){if(this.$f&&this.Fb&&(1===this.$f.CellArea||2===this.$f.CellArea)){var F=this.awj(),X=this.Rua(this.jH("PivotTableContextMenu.Filter",this.nva(this.Fb.Caption)),-1777747317,0,F,we.a.instance.ga(653)),ra=this.Ta.Pc(),ab="",Qb=this.PQd(),Fc=String.format(we.a.instance.Bb(156),this.Edd(Qb));Qb&&(ab=String.format(we.a.instance.Bb(156),this.Fb.Caption));F=this.nva(this.Fb.Caption)+"."+(F?"enabled":"disabled");ab=this.fe(this.jH(yi,F),771421327,0,!1,Fc,"0",
ab,8,pb.a.i2a);F=this.nva(this.Fb.Caption)+"."+this.Fb.LabelOrDateFilterType.toString();this.Fb.IsDateField?(Fc=this.Rua(this.jH("PivotTableContextMenu.DateFilter",F),-1777747317,0,0!==this.Fb.LabelOrDateFilterType,we.a.instance.ga(96)),this.lEh(Fc.menu)):(Fc=this.Rua(this.jH("PivotTableContextMenu.LabelFilter",F),-1777747317,0,0!==this.Fb.LabelOrDateFilterType,we.a.instance.ga(651)),this.TEh(Fc.menu));F=this.nva(this.Fb.Caption)+"."+this.Fb.ValueFilterType.toString();F=this.Rua(this.jH("PivotTableContextMenu.ValueFilter",
F),-1777747317,0,0!==this.Fb.ValueFilterType,we.a.instance.ga(652));this.YFh(F.menu);Qb=this.Ta.Pc();Qb.buttons.push(this.fe("PivotTableContextMenu.ManualFilter",1514686611,0,this.Fb.HasManualFilter,we.a.instance.ga(93)));ra.buttons.push(ab);ra.buttons.push(Fc);ra.buttons.push(F);X.menu.Ec.push(ra);X.menu.Ec.push(Qb);X&&0<ra.buttons.length&&k.buttons.push(X)}};da.prototype.lEh=function(k){k.Ec.push(this.Uac(!0,!1));k.Ec.push(this.oLh());k.Ec.push(this.nLh());k.Ec.push(this.eNh());k.Ec.push(this.hNh());
k.Ec.push(this.fNh());k.Ec.push(this.gNh());k.Ec.push(this.iNh());k.Ec.push(this.jNh());k.Ec.push(this.bLh())};da.prototype.aEh=function(k){k.Ec.push(this.Uac(!0,!0));k.Ec.push(this.KTh());k.Ec.push(this.ZQh())};da.prototype.TEh=function(k){k.Ec.push(this.Uac(!0,!1));k.Ec.push(this.hYe(!0));k.Ec.push(this.MHh());k.Ec.push(this.lKh());k.Ec.push(this.iXe(!0));k.Ec.push(this.pWe(!0))};da.prototype.YFh=function(k){k.Ec.push(this.Uac(!1,!1));k.Ec.push(this.hYe(!1));k.Ec.push(this.iXe(!1));k.Ec.push(this.pWe(!1));
k.Ec.push(this.hYh())};da.prototype.hYh=function(){var k=this.Ta.Pc();k.buttons.push(this.fe("PivotTableContextMenu.Top10",-1611233597,0,Sg.l(this.Fb.ValueFilterType),we.a.instance.ga(104)));return k};da.prototype.lKh=function(){var k=this.Ta.Pc();this.Fb&&(k.buttons.push(this.fe("PivotTableContextMenu.Contains",786260386,0,10===this.Fb.LabelOrDateFilterType,we.a.instance.ga(654),"10")),k.buttons.push(this.fe("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.Fb.LabelOrDateFilterType,we.a.instance.ga(655),
"11")));return k};da.prototype.MHh=function(){var k=this.Ta.Pc();this.Fb&&(k.buttons.push(this.fe("PivotTableContextMenu.BeginsWith",786260386,0,6===this.Fb.LabelOrDateFilterType,we.a.instance.ga(656),"6")),k.buttons.push(this.fe("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.Fb.LabelOrDateFilterType,we.a.instance.ga(657),"7")),k.buttons.push(this.fe("PivotTableContextMenu.EndsWith",786260386,0,8===this.Fb.LabelOrDateFilterType,we.a.instance.ga(658),"8")),k.buttons.push(this.fe("PivotTableContextMenu.DoesNotEndWith",
786260386,0,9===this.Fb.LabelOrDateFilterType,we.a.instance.ga(659),"9")));return k};da.prototype.hYe=function(k){var F=this.Ta.Pc();if(this.Fb){var X=k?Sg.c:Sg.f;F.buttons.push(this.fe(this.jH("PivotTableContextMenu.Equals",X),786260386,0,k?4===this.Fb.LabelOrDateFilterType:18===this.Fb.ValueFilterType,we.a.instance.ga(99),k?"4":"18"));F.buttons.push(this.fe(this.jH("PivotTableContextMenu.DoesNotEqual",X),786260386,0,k?5===this.Fb.LabelOrDateFilterType:19===this.Fb.ValueFilterType,we.a.instance.ga(100),
k?"5":"19"))}return F};da.prototype.iXe=function(k){var F=this.Ta.Pc();if(this.Fb){var X=k?Sg.c:Sg.f;F.buttons.push(this.fe(this.jH("PivotTableContextMenu.GreaterThan",X),786260386,0,k?12===this.Fb.LabelOrDateFilterType:20===this.Fb.ValueFilterType,we.a.instance.ga(101),k?"12":"20"));F.buttons.push(this.fe(this.jH("PivotTableContextMenu.GreaterThanOrEqualTo",X),786260386,0,k?13===this.Fb.LabelOrDateFilterType:21===this.Fb.ValueFilterType,we.a.instance.ga(660),k?"13":"21"));F.buttons.push(this.fe(this.jH("PivotTableContextMenu.LessThan",
X),786260386,0,k?14===this.Fb.LabelOrDateFilterType:22===this.Fb.ValueFilterType,we.a.instance.ga(102),k?"14":"22"));F.buttons.push(this.fe(this.jH("PivotTableContextMenu.LessThanOrEqualTo",X),786260386,0,k?15===this.Fb.LabelOrDateFilterType:23===this.Fb.ValueFilterType,we.a.instance.ga(661),k?"15":"23"))}return F};da.prototype.pWe=function(k){var F=this.Ta.Pc();if(this.Fb){var X=k?Sg.c:Sg.f;F.buttons.push(this.fe(this.jH("PivotTableContextMenu.Between",X),786260386,0,k?16===this.Fb.LabelOrDateFilterType:
24===this.Fb.ValueFilterType,we.a.instance.ga(103),k?"16":"24"));F.buttons.push(this.fe(this.jH("PivotTableContextMenu.NotBetween",X),786260386,0,k?17===this.Fb.LabelOrDateFilterType:25===this.Fb.ValueFilterType,we.a.instance.ga(662),k?"17":"25"))}return F};da.prototype.Uac=function(k,F){var X=this.Ta.Pc();if(this.Fb){var ra=we.a.instance.ga(97),ab=k?this.Fb.LabelOrDateFilterType.toString():this.Fb.ValueFilterType.toString(),Qb=["PivotTableContextMenu.ClearFilter",this.nva(this.Fb.Caption),ab];k=
k?this.Fb.IsDateField?F?1015867427:1105960559:1217404289:-743135194;Qb.push(k.toString());Qb=Qb.join(".");ra=this.fe(Qb,k,0,!1,ra,ab,ra,8,pb.a.i2a);X.buttons.push(ra)}return X};da.prototype.oLh=function(){var k=this.Ta.Pc();this.Fb&&k.buttons.push(this.fe(this.jH("PivotTableContextMenu.Equals",Sg.d),786260386,0,26===this.Fb.LabelOrDateFilterType,we.a.instance.ga(99),"26"));return k};da.prototype.nLh=function(){var k=this.Ta.Pc();this.Fb&&(k.buttons.push(this.fe("PivotTableContextMenu.Before",786260386,
0,27===this.Fb.LabelOrDateFilterType,we.a.instance.ga(111),"27")),k.buttons.push(this.fe("PivotTableContextMenu.After",786260386,0,28===this.Fb.LabelOrDateFilterType,we.a.instance.ga(112),"28")),k.buttons.push(this.fe("PivotTableContextMenu.Between",786260386,0,29===this.Fb.LabelOrDateFilterType,we.a.instance.ga(103),"29")));return k};da.prototype.eNh=function(){var k=this.Ta.Pc();this.Fb&&(k.buttons.push(this.fe("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.Fb.LabelOrDateFilterType,we.a.instance.ga(109),
"30")),k.buttons.push(this.fe("PivotTableContextMenu.Today",1778578888,0,31===this.Fb.LabelOrDateFilterType,we.a.instance.ga(108),"31")),k.buttons.push(this.fe("PivotTableContextMenu.Yesterday",1778578888,0,32===this.Fb.LabelOrDateFilterType,we.a.instance.ga(110),"32")));return k};da.prototype.hNh=function(){var k=this.Ta.Pc();this.Fb&&(k.buttons.push(this.fe("PivotTableContextMenu.NextWeek",1778578888,0,33===this.Fb.LabelOrDateFilterType,we.a.instance.ga(114),"33")),k.buttons.push(this.fe("PivotTableContextMenu.ThisWeek",
1778578888,0,34===this.Fb.LabelOrDateFilterType,we.a.instance.ga(113),"34")),k.buttons.push(this.fe("PivotTableContextMenu.LastWeek",1778578888,0,35===this.Fb.LabelOrDateFilterType,we.a.instance.ga(115),"35")));return k};da.prototype.fNh=function(){var k=this.Ta.Pc();this.Fb&&(k.buttons.push(this.fe("PivotTableContextMenu.NextMonth",1778578888,0,36===this.Fb.LabelOrDateFilterType,we.a.instance.ga(116),"36")),k.buttons.push(this.fe("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.Fb.LabelOrDateFilterType,
we.a.instance.ga(117),"37")),k.buttons.push(this.fe("PivotTableContextMenu.LastMonth",1778578888,0,38===this.Fb.LabelOrDateFilterType,we.a.instance.ga(118),"38")));return k};da.prototype.gNh=function(){var k=this.Ta.Pc();this.Fb&&(k.buttons.push(this.fe("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.Fb.LabelOrDateFilterType,we.a.instance.ga(119),"39")),k.buttons.push(this.fe("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.Fb.LabelOrDateFilterType,we.a.instance.ga(120),"40")),
k.buttons.push(this.fe("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.Fb.LabelOrDateFilterType,we.a.instance.ga(121),"41")));return k};da.prototype.iNh=function(){var k=this.Ta.Pc();this.Fb&&(k.buttons.push(this.fe("PivotTableContextMenu.NextYear",1778578888,0,42===this.Fb.LabelOrDateFilterType,we.a.instance.ga(122),"42")),k.buttons.push(this.fe("PivotTableContextMenu.ThisYear",1778578888,0,43===this.Fb.LabelOrDateFilterType,we.a.instance.ga(123),"43")),k.buttons.push(this.fe("PivotTableContextMenu.LastYear",
1778578888,0,44===this.Fb.LabelOrDateFilterType,we.a.instance.ga(124),"44")));return k};da.prototype.jNh=function(){var k=this.Ta.Pc();if(this.Fb){k.buttons.push(this.fe("PivotTableContextMenu.YearToDate",1778578888,0,45===this.Fb.LabelOrDateFilterType,we.a.instance.ga(125),"45"));var F=this.Rua("PivotTableContextMenu.AllDatesInThePeriod",1778578888,0,Sg.i(this.Fb.LabelOrDateFilterType),we.a.instance.ga(126));this.aEh(F.menu);k.buttons.push(F)}return k};da.prototype.bLh=function(){var k=this.Ta.Pc();
this.Fb&&k.buttons.push(this.fe("PivotTableContextMenu.CustomFilter",786260386,0,this.Yvj(this.Fb.LabelOrDateFilterType),we.a.instance.ga(107),"26"));return k};da.prototype.KTh=function(){var k=this.Ta.Pc();this.Fb&&(k.buttons.push(this.fe("PivotTableContextMenu.Quarter1",1778578888,0,46===this.Fb.LabelOrDateFilterType,we.a.instance.ga(127),"46")),k.buttons.push(this.fe("PivotTableContextMenu.Quarter2",1778578888,0,47===this.Fb.LabelOrDateFilterType,we.a.instance.ga(128),"47")),k.buttons.push(this.fe("PivotTableContextMenu.Quarter3",
1778578888,0,48===this.Fb.LabelOrDateFilterType,we.a.instance.ga(129),"48")),k.buttons.push(this.fe("PivotTableContextMenu.Quarter4",1778578888,0,49===this.Fb.LabelOrDateFilterType,we.a.instance.ga(130),"49")));return k};da.prototype.ZQh=function(){var k=this.Ta.Pc();this.Fb&&(k.buttons.push(this.fe("PivotTableContextMenu.January",1778578888,0,50===this.Fb.LabelOrDateFilterType,we.a.instance.ga(131),"50")),k.buttons.push(this.fe("PivotTableContextMenu.February",1778578888,0,51===this.Fb.LabelOrDateFilterType,
we.a.instance.ga(132),"51")),k.buttons.push(this.fe("PivotTableContextMenu.March",1778578888,0,52===this.Fb.LabelOrDateFilterType,we.a.instance.ga(133),"52")),k.buttons.push(this.fe("PivotTableContextMenu.April",1778578888,0,53===this.Fb.LabelOrDateFilterType,we.a.instance.ga(134),"53")),k.buttons.push(this.fe("PivotTableContextMenu.May",1778578888,0,54===this.Fb.LabelOrDateFilterType,we.a.instance.ga(135),"54")),k.buttons.push(this.fe("PivotTableContextMenu.June",1778578888,0,55===this.Fb.LabelOrDateFilterType,
we.a.instance.ga(136),"55")),k.buttons.push(this.fe("PivotTableContextMenu.July",1778578888,0,56===this.Fb.LabelOrDateFilterType,we.a.instance.ga(137),"56")),k.buttons.push(this.fe("PivotTableContextMenu.August",1778578888,0,57===this.Fb.LabelOrDateFilterType,we.a.instance.ga(138),"57")),k.buttons.push(this.fe("PivotTableContextMenu.September",1778578888,0,58===this.Fb.LabelOrDateFilterType,we.a.instance.ga(139),"58")),k.buttons.push(this.fe("PivotTableContextMenu.October",1778578888,0,59===this.Fb.LabelOrDateFilterType,
we.a.instance.ga(140),"59")),k.buttons.push(this.fe("PivotTableContextMenu.November",1778578888,0,60===this.Fb.LabelOrDateFilterType,we.a.instance.ga(141),"60")),k.buttons.push(this.fe("PivotTableContextMenu.December",1778578888,0,61===this.Fb.LabelOrDateFilterType,we.a.instance.ga(142),"61")));return k};da.prototype.UEh=function(k){var F=this.Ta.Pc();if(this.H1f()){var X=this.Fc.WK[4===this.$f.CellType?this.Fc.O4c-1:this.$f.CurrentFieldIndex-1];if(X&&this.N$a){var ra=this.Ta.lw("ContextMenu.PivotTableLayout",
null,we.a.instance.ga(649),-1777747317);var ab=this.Ta.Pc(),Qb=String.format(we.a.instance.Bb(161),this.N$a),Fc=String.format(we.a.instance.Bb(162),this.N$a);ab.buttons.push(this.fe(Zj,-1457478532,0,!X.IsCompactLayout,Qb));ab.buttons.push(this.fe(ag,-1390365353,0,X.IsCompactLayout,Fc));ra.menu.Ec.push(ab);ra&&F.buttons.push(ra)}}if(1===this.$f.CellArea||2===this.$f.CellArea)this.Fb.Caption&&(X="",ab=this.PQd(),ra=String.format(we.a.instance.Bb(159),this.Edd(ab)),ab&&(X=String.format(we.a.instance.Bb(159),
this.Fb.Caption)),1===this.$f.CellArea?(X=this.Rua("ContextMenu.PivotTableSubtotal",1801458190,0,this.Fb.ShowSubtotal,ra),ra=this.Ta.Pc(),ra.buttons.push(this.Ta.Cb(259)),ra.buttons.push(this.fe("ContextMenu.PivotTableSubtotalOnTop",671485366,641,this.Fb.ShowSubtotal&&this.Fb.ShowSubtotalAtTop)),ra.buttons.push(this.fe("ContextMenu.PivotTableSubtotalOnBottom",772221736,642,this.Fb.ShowSubtotal&&!this.Fb.ShowSubtotalAtTop)),X.menu.Ec.push(ra),X&&0<ra.buttons.length&&F.buttons.push(X)):(ab=ab?this.jH(zh,
this.nva(ra)):zh,F.buttons.push(this.fe(ab,1801458190,0,this.Fb.ShowSubtotal,ra,null,X)))),F.buttons.push(this.fe("ContextMenu.RepeatItemLabels",-556893687,644,this.Fb.RepeatItemLabels));1===this.$f.CellArea&&F.buttons.push(this.fe("ContextMenu.PivotBlankLineAfterEachItem",1600778266,643,this.Fb.ShowBlankLineAfterEachItem));k.Ec.push(F)};da.prototype.GFh=function(k){var F=this.Ta.Pc();F.buttons.push(this.Ta.Cb(247));k.Ec.push(F)};da.prototype.wFh=function(k){var F="",X="",ra=!1;3===this.$f.CellType?
F=we.a.instance.ga(646):8===this.$f.CellType?this.Fc&&(F=String.format(we.a.instance.Bb(160),this.Fc.sFe)):this.Fb&&((ra=this.PQd())&&(X=String.format(we.a.instance.Bb(160),this.Fb.Caption)),F=String.format(we.a.instance.Bb(160),this.Edd(ra)));if(F){var ab=this.Ta.Pc();ra=ra?this.jH(af,this.nva(F)):af;F=this.fe(ra,-1951357930,0,!1,F,null,X,8,pb.a.k9c);ab.buttons.push(F);k.Ec.push(ab)}};da.prototype.iEh=function(k){var F=this.Ta.Pc();F.buttons.push(this.Ta.Cb(43));this.Fb&&this.$f&&this.$.isEditMode&&
(0===this.$f.CellType||4===this.$f.CellType)&&F.buttons.push(this.Ta.Cb(136));k.Ec.push(F)};da.prototype.vFh=function(k){var F=this.Ta.Pc();F.buttons.push(this.Ta.Cb(100));k.Ec.push(F)};da.prototype.MFh=function(k){var F=2===this.Fb.MeasureType&&!this.Fb.IsNumeric,X=this.Ta.lw("ContextMenu.SummarizeValuesBy",null,we.a.instance.ga(647),-249874296),ra=this.Ta.Pc();ra.buttons.push(this.fe("ContextMenu.SummarizeValuesBySum",-1255320719,1081,0===this.Fb.DataFieldAggregationType,void 0,void 0,void 0,void 0,
void 0,F));ra.buttons.push(this.fe("ContextMenu.SummarizeValuesByCount",1746132849,1082,1===this.Fb.DataFieldAggregationType));ra.buttons.push(this.fe("ContextMenu.SummarizeValuesByAverage",-771066011,1083,2===this.Fb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,F));ra.buttons.push(this.fe("ContextMenu.SummarizeValuesByMax",835007294,1084,3===this.Fb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,F));ra.buttons.push(this.fe("ContextMenu.SummarizeValuesByMin",929115636,
1085,4===this.Fb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,F));ra.buttons.push(this.fe("ContextMenu.SummarizeValuesByProduct",1935475057,1086,5===this.Fb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.U0f(!0)||F));2!==this.Fb.MeasureType&&(ra.buttons.push(this.fe("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1087,6===this.Fb.DataFieldAggregationType)),ra.buttons.push(this.fe("ContextMenu.SummarizeValuesByStdDeviation",588680636,1088,7===this.Fb.DataFieldAggregationType)),
ra.buttons.push(this.fe("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1089,8===this.Fb.DataFieldAggregationType)),ra.buttons.push(this.fe("ContextMenu.SummarizeValuesByVariant",1668427539,1090,9===this.Fb.DataFieldAggregationType)),ra.buttons.push(this.fe("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1091,10===this.Fb.DataFieldAggregationType)));this.Fc&&this.Fc.Wod()&&ra.buttons.push(this.fe("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1092,11===this.Fb.DataFieldAggregationType));
X.menu.Ec.push(ra);k.buttons.push(X)};da.prototype.HFh=function(k){var F=this.Ta.lw("ContextMenu.ShowValuesAs",null,we.a.instance.ga(648),-1128612833),X=this.Ta.Pc();X.buttons.push(this.fe("ContextMenu.ShowValuesAsNoCalculation",-841863025,1098,0===this.Fb.DataFieldFormatType));X.buttons.push(this.fe("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1105,7===this.Fb.DataFieldFormatType));X.buttons.push(this.fe("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1104,6===this.Fb.DataFieldFormatType));
X.buttons.push(this.fe("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1103,5===this.Fb.DataFieldFormatType));X.buttons.push(this.fe("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1108,9===this.Fb.DataFieldFormatType));X.buttons.push(this.fe("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1109,10===this.Fb.DataFieldFormatType));if(this.Fc&&this.Fc.WK&&0<this.Fc.WK.length||this.Fc.D$&&0<this.Fc.D$.length){for(var ra=this.Rua("ContextMenu.ShowValuesAsPercentOfParentTotal",
-1128612833,1110,11===this.Fb.DataFieldFormatType),ab=this.Ta.Pc(),Qb=this.LFh(),Fc=0;Fc<Qb.length;Fc++){var ld=Qb[Fc];ab.buttons.push(this.fe("ContextMenu.ShowValuesAsPercentOfParentTotal."+ld.Caption,-2031744961,1110,11===this.Fb.DataFieldFormatType&&this.Fb.BaseFieldIndex===ld.Index,ld.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+ld.Index))}ra.menu.Ec.push(ab);X.buttons.push(ra)}F.menu.Ec.push(X);k.buttons.push(F)};da.prototype.showPivotTableContextMenu=function(){this.Nnd=!0;this.expandCollapse=
this.pZ=this.refresh=!1;var k=this.$,F=ff.g(k),X=Mi.a(k).kKa();if(X){var ra=Ne.a(k);if(null===ra||void 0===ra?0:ra.gQd)this.Nnd=Zf.f(k.mg);ra=k.xc;this.pZ=X.supportsBIExplore&&!!Uf.a(k)&&ra.O2(32768);ra.allowInteractivity&&(k=F.lc(null),(null===k||void 0===k?0:k.cell)&&(k.cell.sZc||k.cell.E1f)&&(this.expandCollapse=!0),ra.allowManualDataRefresh&&(this.refresh=!0))}k=null;X=1;this.l0a&&1!==this.l0a.zb?(k=new Sys.UI.Point(this.l0a.clientPoint.x,this.l0a.clientPoint.y),X=this.l0a.zb):(F=eg.e(F,this.$))&&
(k=new Sys.UI.Point(F.x+(this.$.isChromeRtl?0:F.width),F.y+F.height));Sf.a.Sb=X;this.gic=3===X;this.Fp(k,!0,X);this.Cba=!0;this.CTd()};da.prototype.b5h=function(){var k=new jh.a(1114549926,0,this.$.Xc,19,null);this.$.Ka.Wb(k)};da.prototype.NSh=function(){var k=this;if(this.Fc&&this.Fc.To){var F=this.Fc.To.CurrentCol;if(this.Fc.To.CurrentRow===this.activeCell.FirstRow&&F===this.activeCell.FirstColumn){this.dKb();this.showPivotTableContextMenu();return}}F=new cg.a(228,0,function(X,ra,ab){return Yg.C(k.$.na.va,
k.activeCell,hh.b(X,k.pKi),hh.a(ra,k.oKi),ab,null)},16);this.$.userOperationManager.jc(F,null)};da.prototype.nji=function(){if(O.a.Ld(this.$)){var k=this.$.da.za(441);if(k)return k.Wr}else if(k=this.$.da.za(346))return k.Wr;return!1};da.prototype.jH=function(k,F){return k+"."+F};da.prototype.performPivotTableOperation=function(k,F){var X=this,ra=Vh.a.Ua.Vb;if(!this.Fc||!this.Fb&&this.$f&&3!==this.$f.CellType)this.si();else{var ab=this.Fc.isOlap;Mi.a(this.$).Jx(ab,function(Qb){Qb&&X.$.jc(k,function(Fc,
ld,ud){var jd=X.SZd,Ye=X.activeCell,Bf=X.Fb?X.Fb.Caption:null,Tg=X.N$a;Fc=hh.b(Fc,X.$Ni);ld=hh.a(ld,X.ZNi);var $g=X.$.na.va.hc();$g=jd.Na(41,void 0===$g?null:$g);$g.activeCell=Ye;$g.operationType=F;$g.fieldCaption=Bf;$g.prevFieldCaption=Tg;return Yg.i(jd,"ExecutePivotTableOperation",$g,Fc,ld,ud,null,0)},ra,0,4,229)})}};da.prototype.applyValueFieldSettingsToPivotTable=function(k,F){var X=this;F=void 0===F?!1:F;var ra=Vh.a.Ua.Vb;this.Fc&&this.Fb?(F&&2===this.Fb.MeasureType&&Wd.ULS.sendTraceTag(537167002,
0,50,"change aggregation type for an implicit measure from right click context menu."),F=this.Fc.isOlap,Mi.a(this.$).Jx(F,function(ab){ab&&X.$.jc(k,function(Qb,Fc,ld){var ud=X.SZd,jd=X.activeCell,Ye=X.bA;Qb=hh.b(Qb,X.TEi);Fc=hh.a(Fc,X.SEi);var Bf=X.$.na.va.hc();Bf=ud.Na(41,void 0===Bf?null:Bf);Bf.activeCell=jd;Bf.pivotValueFieldSettingsApplyData=Ye;return Yg.i(ud,"ApplyValueFieldSettingsToPivotTable",Bf,Qb,Fc,ld,null,0)},ra,0,4,231)})):this.si()};da.prototype.fe=function(k,F,X,ra,ab,Qb,Fc,ld,ud,jd){ab=
void 0===ab?null:ab;Qb=void 0===Qb?null:Qb;Fc=void 0===Fc?null:Fc;ld=void 0===ld?8:ld;ud=void 0===ud?null:ud;jd=void 0===jd?!1:jd;ra&&(k+=".Checked");jd&&(k+=".Disabled");this.Ta.Bmd(k)&&this.Ta.MHd(k);X=ab||we.a.instance.ga(X);k=this.Ta.wHa(k,X,F,null,"None",Qb,jd,null);k.Lvc(null);Fc&&k.oS(Fc);ra?k.qS("Image16by16",3,pb.a.jaa):ud?k.qS("Image16by16",ld,ud):k.n2b();return k};da.prototype.Rua=function(k,F,X,ra,ab){X=(void 0===ab?null:ab)||we.a.instance.ga(X);this.Ta.Bmd(k)?this.Ta.MHd(k):this.Ta.MHd(k+
".Checked");ra&&(k+=".Checked");this.quj&&(X=this.Ogh.parseFromString(X,"text/html").body.innerText);k=this.Ta.X2c(k,null,X,F,3,pb.a.jaa);k.J8e=ra;!ra&&ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&k.n2b();return k};da.prototype.Q8h=function(){this.bA=Object(na.a)(new od,{PivotValueFieldSummarizeValueByApplyData:Object(na.a)(new Pf,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(na.a)(new kg,{SelectedDataFormat:-1,SelectedBaseField:-1,
SelectedBaseItem:-1}),PivotValueFieldTitle:null})};da.prototype.xRa=function(k,F){this.bA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=k;this.bA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=F;this.bA.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1};da.prototype.LFh=function(){var k=[];if(this.Fc&&this.Fc.D$&&0<this.Fc.D$.length)for(var F=Gl(this.Fc.D$),X=F.next();!X.done;X=F.next())(X=X.value)&&k.push(X);if(this.Fc&&this.Fc.WK&&0<this.Fc.WK.length)for(F=Gl(this.Fc.WK),X=
F.next();!X.done;X=F.next())(X=X.value)&&k.push(X);k.sort(function(ra,ab){return ra.Index-ab.Index});return k};da.prototype.H1f=function(){if(!this.$f||!this.Fc||!this.Fc.WK)return!1;var k=1===this.$f.CellArea||4===this.$f.CellType&&this.$f.IsRowAxis,F=4===this.$f.CellType?0<this.Fc.O4c:0<this.$f.CurrentFieldIndex;return 1<this.Fc.WK.length&&k&&F};da.prototype.WJa=function(k){var F=[];3===k?this.$.isEditMode?Array.addRange(F,[Pc.a.OFf,Pc.a.QFf,Pc.a.FWi]):Array.addRange(F,[Pc.a.copy]):2===k&&F.push(Pc.a.Bwe);
return F};da.prototype.si=function(){var k=Vf.a.gd(1,0,0,650,0,104573951,"PivotTableContextMenuOperationFailure");Uh.a(this.$).si(k)};da.prototype.awj=function(){return this.Fb?0!==this.Fb.LabelOrDateFilterType||0!==this.Fb.ValueFilterType||this.Fb.HasManualFilter:!1};da.prototype.Yvj=function(k){return 62<=k&&65>=k};da.prototype.Mpi=function(){if(this.activeCell&&this.Fb&&this.Fc){var k={};k.cell=this.activeCell;k.dataSourceIndex=this.Fc.externalSourceIndex;k.fieldId=this.Fb.Index.toString();k.isOlap=
this.Fc.isOlap;k.confirmationRequired=this.Fc.confirmationRequiredForDataOps;this.$.Ud(492140419,Sf.a.Sb,19,{showPivotFilterDialogCommandData:k})}};da.prototype.LXg=function(k){var F=this;this.activeCell&&this.Fb&&this.Fc&&this.$.userOperationManager.jc(new cg.a(153,0,function(X,ra,ab){return Yg.X(F.$.na.va,F.activeCell,F.Fc.externalSourceIndex,F.Fb.Index.toString(),k,X,ra,ab,null,null)}),null)};da.prototype.PJg=function(k){var F=this;!(30>k||61<k)&&this.activeCell&&this.Fb&&this.Fc&&this.$.userOperationManager.jc(new cg.a(152,
0,function(X,ra,ab){return Yg.g(F.$.na.va,F.activeCell,F.Fc.externalSourceIndex,F.Fb.Index.toString(),k,X,ra,ab,null,null)}),null)};da.prototype.applyPivotSort=function(k){var F=this;if(this.Fc&&this.Fb&&this.activeCell&&this.$f){var X=1===this.$f.CellArea||2===this.$f.CellArea;8===this.$f.CellArea?rh.a(this.$.userOperationManager,function(ra,ab,Qb){return Yg.e(F.$.na.va,F.activeCell,k,F.Fb.Caption,ra,ab,Qb,null)},function(ra){return new cg.a(1015,0,ra,void 0,null)},null):X&&(X=1===this.$f.CellArea?
1:2,this.$.ma(696)?Pg.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Fc.externalSourceIndex,this.Fb.Index.toString(),this.Fb.Caption,this.Fc.isOlap?"":this.Fb.Caption,X,1===k):Pg.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Fc.externalSourceIndex,this.Fb.Index.toString(),1===k))}};da.prototype.sS=function(){return!this.Fc||!this.Fc.isActionable};da.prototype.Guj=function(){return(this.$f||this.Fc)&&4!==this.$f.CellType&&(0!==
this.$f.CellType||8!==this.$f.CellArea||this.Fc.D$&&this.Fc.D$.length||this.Fc.WK&&this.Fc.WK.length)?!1:!0};da.prototype.Huj=function(){return this.$f&&this.Fc&&(1===this.$f.CellArea||2===this.$f.CellArea)&&this.Fc.FOb&&this.Fc.FOb.length?!1:!0};Ck.Object.defineProperties(da.prototype,{Qw:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotTableContextMenu"}},AB:{configurable:!0,enumerable:!0,get:function(){return We.a.RKf}}});Object(ie.a)(da,"PivotTableContextMenu",ge.a,[]);Xb.prototype.compare=
function(k,F){return(k||"").localeCompare(F||"",void 0,{numeric:!0,sensitivity:"accent"})};Object(ie.a)(Xb,"DigitsAsNumberComparer",null,[807]);var pa=b(274),hb=b(25),Db=b(187),rc=We.a.J1g,vb=ge.a;Wl(ng,vb);ng.prototype.executeCommand=function(k,F,X){k=F.command;switch(k){case 639960842:this.applyTableFieldList(X);this.EK.vda();break;case -1085236154:X=String.format("TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, {0}",this.Yxd);Wd.ULS.sendTraceTag(537166999,0,50,X);this.EK.vda();
break;case 1833782813:this.EK.showCallout();break;default:return Rg.a(k)}return Xf.Task.Sa(!0)};ng.prototype.applyTableFieldList=function(k){var F=k.MenuItemId.toString();ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&(F=F.replace("'","''"),F=F.replace("[","'["),F=F.replace("]","']"));var X=Object(ca.a)(String,k.SourceControlId),ra={};ra.PulloutField=F;ra.PulloutCardPath=k.SourceCardKeyPath;ra.PulloutCardSourceRow=k.SourceCardRow;ra.PulloutCardSourceColumn=
k.SourceCardColumn;if(this.EK.bN){Wd.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");ra.ParameterType=2;k=k.ColumnIndex;if(void 0===k||null===k){if(void 0===X||null===X){Wd.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");return}k=0<=this.EK.UIf?this.EK.UIf:parseInt(X.substring(20+F.length+1,X.length),10);if(isNaN(k)){ra=String.format("TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, {0}",
X);Wd.ULS.shipAssertTag(537166997,0,!1,ra);return}}ra.PulloutRichColumnSourceIndex=k;if(this.tEa.pHg){this.eIg(F,ra);return}}else Wd.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),ra.ParameterType=4,X=this.EK.selectedRange.right,O.a.Ayb()&&this.tEa.bnd&&(ra.ParameterType=8,k=this.EK.Gla.top,k=hb.Range.YP(X)+k,"Days from Today"==F?(F="=DAYS("+k+", TODAY())",Db.a("DateFormulaPulledOut_DaysFromToday")):"Total Weekdays from Today"==F?(F="=IF(TODAY() < "+k+", NETWORKDAYS(TODAY(), "+k+
"), NETWORKDAYS("+k+", TODAY()))",Db.a("DateFormulaPulledOut_WeekdaysFromToday")):"Years from Today"==F?(F="=IF(TODAY() < "+k+", DATEDIF(TODAY(), "+k+', "Y"), DATEDIF('+k+', TODAY(), "Y"))',Db.a("DateFormulaPulledOut_YearsFromToday")):"Day of the Week"==F?(F="=TEXT("+k+', "dddd")',Db.a("DateFormulaPulledOut_DayOfWeek")):"Month of the Year"==F?(F="=TEXT("+k+', "mmmm")',Db.a("DateFormulaPulledOut_MonthOfYear")):"End of Month"==F?(F="EOMONTH("+k+", 0)",F="=DATE(YEAR("+F+"), MONTH("+F+"), DAY("+F+"))",
Db.a("DateFormulaPulledOut_EndOfMonth")):"Next Month"==F?(F="EDATE("+k+", 1)",F="=DATE(YEAR("+F+"), MONTH("+F+"), DAY("+F+"))",Db.a("DateFormulaPulledOut_AddOneMonth")):"Next Week"==F?(F="="+k+" + 7",Db.a("DateFormulaPulledOut_AddOneWeek")):"Next Day"==F&&(F="="+k+" + 1",Db.a("DateFormulaPulledOut_AddOneDay"))),void 0!==ra.PulloutCardSourceColumn&&null!==ra.PulloutCardSourceColumn&&(X=ra.PulloutCardSourceColumn+1),ra.PulloutRichColumnSourceIndex=X;this.UNd(F,ra)};ng.prototype.UNd=function(k,F,X){X=
void 0===X?0:X;var ra=String.format("TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, {0}, SelectedColumnIndex, {1}",this.Yxd,F.PulloutRichColumnSourceIndex);Wd.ULS.sendTraceTag(537166996,0,50,ra);String.format("TableFieldListContextMenu:ApplyTableFieldList, richValueParameterType, {0}, PulloutRichColumnSourceIndex, {1}",F.ParameterType,F.PulloutRichColumnSourceIndex);k=Object(na.a)(new pa.a,{Text:k});this.grid.setCell(k,this.EK.Gla,0,127,F,X);this.grid.focus();this.d5b=null;this.EK.vda();
this.EK.Eej()};ng.prototype.Mc=function(k,F,X){if(k=this.$.isEditMode&&ve.EwaSettings.ma(136)&&!!this.EK)switch(F.command){case -1085236154:break;case 639960842:k=!!X;break;case 1833782813:k=this.EK.pwa&&this.EK.pBb;break;default:k=!1}return k};ng.prototype.K0=function(k,F,X){this.$.isEditMode&&(this.d5b=this.$Eh(Object(ca.a)(802,X)),vb.prototype.K0.call(this,k,F,null,null,!1))};ng.prototype.$Y=function(){return this.d5b};ng.prototype.W2c=function(k){if(!this.EK||!k||!k.Ok)return Wd.ULS.shipAssertTag(537166994,
0,!!this.EK,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),Wd.ULS.shipAssertTag(537166993,0,!!k,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),k&&Wd.ULS.shipAssertTag(537166992,0,!!k.Ok,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;var F=new Ka.a;k=Gl(k.Ok);for(var X=k.next();!X.done;X=k.next()){var ra=X.value;X=new Ka.a;X.add(ra.ColumnName);X.add(ra.ColumnIndex.toString());var ab=
new Ka.a,Qb=null;O.a.Ayb()&&this.tEa.bnd?ab=Ba.toList(Ba.select(Ba.asEnumerable(ra.FieldInfoDataList),function(Fc){return Fc.Name})):(Qb=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new Xb:new $e,ab=Ba.OBc(Ba.concat(ab,Ba.select(Ba.asEnumerable(ra.FieldInfoDataList),function(Fc){return Fc.Name})),function(Fc){return Fc},Qb));ra=new Ka.a;ra.add(Ba.toArray(Ba.concat(X,ab)));F=Ba.toList(Ba.concat(F,ra))}return Ba.toArray(F)};ng.prototype.$Eh=function(k){var F=
this.W2c(k);if(!F||!F.length)return this.d5b=null;k=this.Ta;var X=k.Cq(this.menuId),ra=k.Pc(),ab=1<F.length,Qb=O.a.Ayb()&&this.tEa.bnd;this.Yxd=F.length;F=Gl(F);for(var Fc=F.next();!Fc.done;Fc=F.next()){var ld=Fc.value;Qb?ra.title="Calculate Date Information":ab||(ra.title=ld[0]);Fc=k.Pc();for(var ud=2,jd=ld.length;ud<jd;++ud)!Qb||"Days from Today"!=ld[ud]&&"End of Month"!=ld[ud]||(X.Ec.push(ra),ra=k.Pc()),(ab?Fc.buttons:ra.buttons).push(k.wHa("ApplyTableFieldList."+ld[ud]+"."+ld[1],ld[ud],639960842,
null,"None",ld[ud],!1,void 0,!0));ab&&(ld=k.lw("ApplyTableFieldList."+ld[0],this.menuId,ld[0],798637440),ld.menu.Ec.push(Fc),ra.buttons.push(ld))}X.Ec.push(ra);return X};ng.prototype.eIg=function(k,F){var X=this,ra=Vf.a.gd(12,1,0,896,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(ve.EwaSettings.Az()){var ab=new Eg.a(this.$,ra);ab.AP(function(){2===ab.returnValue&&X.UNd(k,F,8)})}else{var Qb=new lh.ErrorDialog(this.$,ra);Qb.AP(function(){2===Qb.returnValue&&X.UNd(k,F,8)});Qb.Af()}};Ck.Object.defineProperties(ng.prototype,
{Qw:{configurable:!0,enumerable:!0,get:function(){return"PopulateTableFieldListContextMenu"}},AB:{configurable:!0,enumerable:!0,get:function(){return We.a.TKf}},EK:{configurable:!0,enumerable:!0,get:function(){this.tEa||(this.tEa=this.$.da.za(261));return this.tEa}}});Object(ie.a)(ng,"PulloutFieldListContextMenu",ge.a,[]);var Uc=We.a.VKf,Td=ge.a;Wl(ef,Td);ef.prototype.Mc=function(k,F,X){return-1687037502===F.command&&!!X&&this.grid.isEditing};ef.prototype.executeCommand=function(k,F,X){this.showRichTextFloatie(X);
return Xf.Task.Sa(!0)};ef.prototype.WJa=function(){return[Pc.a.gVg]};ef.prototype.showRichTextFloatie=function(k){var F=Object(ca.a)(xc.a,k.eventArgs);F&&(k=this.WJa(F.zb),F=new Sys.UI.Point(F.Ca.clientX,F.Ca.clientY),this.showFloatie(k,new Sys.UI.Bounds(F.x,F.y,0,0),2))};Ck.Object.defineProperties(ef.prototype,{Qw:{configurable:!0,enumerable:!0,get:function(){return"PopulateRichTextContextMenu"}},AB:{configurable:!0,enumerable:!0,get:function(){return We.a.VKf}}});Object(ie.a)(ef,"RichTextContextMenu",
ge.a,[]);var mf=b(100),bg=We.a.I1g,qg=ge.a;Wl(Og,qg);Og.prototype.executeCommand=function(k,F,X){if(gf.a(this.$))return Xf.Task.Sa(!0);this.$.isEditMode&&(k=X[We.a.w0f],k=k.x&&k.y?new Sys.UI.Point(k.x+(this.$.isChromeRtl?10:-10),k.y):nf.DOMElementExtensions.getLocation(X[We.a.x0f]),this.Fp(k,!1));return Xf.Task.Sa(!0)};Og.prototype.Mc=function(k,F,X){return-1075099431===F.command&&!!X};Og.prototype.$Y=function(){var k=this.Ta.Cq(this.menuId),F=this.$.isEditMode;this.uRj();this.PEh(k,F);this.FEh(k);
this.FFh(k);return k};Og.prototype.KYb=function(k,F,X,ra){k.push(this.Ta.Cb(F?X:ra))};Og.prototype.PEh=function(k,F){var X=this.Ta,ra=X.Pc();ra.buttons.push(X.Cb(54));this.KYb(ra.buttons,this.Thc,127,56);ra.buttons.push(X.Cb(55));F&&this.KYb(ra.buttons,this.Thc,126,125);ra.buttons.push(X.Cb(158));this.$.ea.OKb&&this.$.ya.ExcelSheetProtectionSettingsEnabled&&(F=Object(ca.a)(mf.a,this.$.qa))&&hi.p(F)&&this.$.isEditMode&&(ra.buttons.push(X.Cb(277)),F.isLockPausedInSession?ra.buttons.push(X.Cb(279)):
F.tj&&ra.buttons.push(X.Cb(278)));F=X.lw("ContextMenu.TabColor",null,we.a.instance.ga(520),1841703919);X=X.T2c(467002767,1549407384,543,-221093529,this.AB);F.menu.Ec.push(X);ra.buttons.push(F);k.Ec.push(ra)};Og.prototype.FEh=function(k){var F=this.Ta.Pc();this.KYb(F.buttons,this.Thc,114,112);this.KYb(F.buttons,!this.qgc,115,113);k.Ec.push(F)};Og.prototype.FFh=function(k){if(ve.EwaSettings.ma(483)&&!hi.e(this.$.xa.qa)){var F=this.Ta,X=F.Pc();X.buttons.push(F.Cb(263));k.Ec.push(X)}};Og.prototype.uRj=
function(){var k=this.$.E2c();var F=k.F2c;k=k.ZBe;this.Thc=1===F;this.qgc=0<k};Ck.Object.defineProperties(Og.prototype,{Qw:{configurable:!0,enumerable:!0,get:function(){return"PopulateSheetOpsContextMenu"}},AB:{configurable:!0,enumerable:!0,get:function(){return We.a.WKf}}});Object(ie.a)(Og,"SheetOpsContextMenu",ge.a,[]);var Kg=b(562),di=ge.a;Wl(Jg,di);Jg.prototype.$c=function(k,F){var X=!0;switch(F){case -231711729:X=!1;break;case -1909381757:X=this.Sbc();X=!!X&&X.pgi;break;case 1312363469:X=!0}return!X||
di.prototype.$c.call(this,k,F)};Jg.prototype.executeCommand=function(k,F,X){if(!this.$.isEditMode)return Ud.TaskExtensions.G4();k=F.command;F=this.Sbc();var ra=null;switch(k){case 2108047455:F&&F.tye();break;case -231711729:Wd.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:F&&F.w2b();break;case 1312363469:this.showSlicerContextMenu(X);break;default:ra=Rg.a(k)}return ra||Ud.TaskExtensions.G4()};Jg.prototype.Mc=function(k,F,X){k=!1;switch(F.command){case -231711729:case 2108047455:case -1909381757:k=
!0;break;case 1312363469:k=!!X}return k};Jg.prototype.$Y=function(){var k=this.Ta.Cq(this.menuId),F=this.Ta.Pc();F.buttons.push(this.Ta.Cb(252));F.buttons.push(this.Ta.Cb(253));F.buttons.push(this.Ta.Cb(254));k.Ec.push(F);F=this.Ta.Pc();this.uli()?F.buttons.push(this.Ta.Cb(266)):F.buttons.push(this.Ta.Cb(267));k.Ec.push(F);return k};Jg.prototype.uli=function(){if(O.a.Ld(this.$)){var k=this.$.da.za(439);if(k)return k.Wr}else if(k=this.$.da.za(371))return k.Wr;return!1};Jg.prototype.showSlicerContextMenu=
function(k){var F=Object(ca.a)(xc.a,k.eventArgs);k=this.wac(Object(ca.a)(xc.a,k.eventArgs));F=F.zb;Sf.a.Sb=F;this.Fp(k,!1,F)};Jg.prototype.rVe=function(k){var F=this.Ta.Pc(),X=this.Ta.Pc();X.buttons.push(this.Ta.Cb(255));X.buttons.push(this.Ta.Cb(256));var ra=this.Ta.X2c("ContextMenu.SlicerSort",null,we.a.instance.ga(2142),-814639094,0,pb.a.pOe);ra.menu.Ec.push(X);F.buttons.push(ra);k.Ec.push(F)};Jg.prototype.rwj=function(k){return ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&
k.Lb.className===pb.a.T8c||ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===k.zb};Jg.prototype.wac=function(k){var F=ff.g(this.$).ha.Oa.nc,X=k&&1!==k.zb&&k.clientPoint?k.clientPoint:Sys.UI.DomElement.getLocation(F.domElement);if(this.rwj(k)){var ra=this.Sbc();ra&&(k.Lb.className===pb.a.T8c&&(X=Sc.HelperMethods.Mub(k.Ca)),1===k.zb&&(X=ah.a(this.$).Aja(nf.DOMElementExtensions.getLocation(ra.frame))))}else if(k=this.Sbc())k=this.dOh(k.frame),(ra=Sc.HelperMethods.KC(this.$.Lf,
this.$.domElement,ff.g(this.$).rtl,!1))?(k.x=ah.a(this.$).Di(k.x-ra.x)+ra.x,k.y=ah.a(this.$).Di(k.y-ra.y)+ra.y):Wd.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),X.y+=k.y,X.x+=k.x;k=this.$.domElement;ra=ff.g(this.$).rtl;F=Sc.HelperMethods.KC(F.qg.domElement,k,ra);X.y=Math.max(X.y,F.y);X.x=Math.max(X.x,F.x);return X};Jg.prototype.Sbc=function(){var k=ff.g(this.$).ha.Oa.nc;Wd.ULS.shipAssertTag(537166988,0,!!k);return Kg.a(this.$).rH(k.floatingObject.id)};Jg.prototype.dOh=function(k){var F=
new Sys.UI.Point(k.offsetParent.offsetLeft,k.offsetParent.offsetTop),X=ff.g(this.$);if(!X)return F;var ra=ff.g(this.$).rtl;F=Sc.HelperMethods.KC(k,this.$.lr.ownerDocument.body,ra);X.QBe(F);F.x=ra?this.$.lr.clientWidth-F.x-k.clientWidth:F.x;k=X.view.Nob;X=ra?-X.lS.lca(k.x):k.x;F.x-=X;F.y-=k.y;return F};Ck.Object.defineProperties(Jg.prototype,{Qw:{configurable:!0,enumerable:!0,get:function(){return"PopulateSlicerContextMenu"}},AB:{configurable:!0,enumerable:!0,get:function(){return We.a.XKf}}});Object(ie.a)(Jg,
"SlicerContextMenu",ge.a,[]);Object(ie.a)(fg,"TimeSlicerRibbonButtonParameter",null,[]);var Bh=ge.a;Wl(Jf,Bh);Jf.prototype.executeCommand=function(k,F,X){k=F.command;switch(k){case 2000085697:k=X.DOMElement;this.Nsa=X.ChangeLevelCallback;this.eKa=X.GetLevelLabelCallback;this.I0a=X.CurrentLevel;var ra=X.DomEvent;Ng.g(ra);var ab=X.location;X=X.levelLabelText;this.BJe=nf.DOMElementExtensions.xz(document.activeElement,"iframe")&&X?X.parentNode:null;X=Sys.UI.DomElement.getBounds(X);X.x=ab.x;X.y=ab.y;this.K0(ra,
k,X,F,!0);break;case -649826274:this.Nsa(0);break;case 149600865:this.Nsa(1);break;case -2012435159:this.Nsa(2);break;case -1979934975:this.Nsa(3);break;case 1634477200:nf.DOMElementExtensions.setFocus(this.BJe);break;default:return Rg.a(k)}return Xf.Task.Sa(!0)};Jf.prototype.Mc=function(k,F,X){k=!1;switch(F.command){case 2000085697:k=!!X;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:k=!0}return k};Jf.prototype.K0=function(k,F,X){k=Sys.UI.DomElement.getBounds(F);
X.x=ah.a(this.$).Di(X.x);X.y=ah.a(this.$).Di(X.y);k.x=ah.a(this.$).Di(k.x);k.y=ah.a(this.$).Di(k.y);k=new Sys.UI.Point(k.x+X.x,k.y+X.y);this.vTa(k,F);this.showContextMenu(new Sys.UI.Bounds(k.x,k.y-X.height,X.width,X.height))};Jf.prototype.$Y=function(){for(var k=this.Ta,F=k.Cq(this.menuId),X=k.Pc(),ra=0;3>=ra;ra++){var ab=this.eKa(ra),Qb=Jf.xIh(ra);Qb=k.F3g(Qb.G1g,Qb.Br,this.I0a===ra,Jf.xxe);Qb.label=ab;Qb.oS(ab);this.I0a===ra?Qb.qS("Image16by16",8,Jf.xxe):Qb.n2b();X.buttons.push(Qb)}F.Ec.push(X);
return F};Jf.xIh=function(k){var F=null;switch(k){case 0:F=new fg(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:F=new fg(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:F=new fg(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:F=new fg(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return F};Ck.Object.defineProperties(Jf.prototype,{Qw:{configurable:!0,enumerable:!0,get:function(){return"PopulateTimeSlicerLevelMenu"}},AB:{configurable:!0,enumerable:!0,
get:function(){return We.a.$Kf}}});Jf.zHj=We.a.K1g;Jf.PIb="TimeSlicerLevelMenuRootName";Jf.xxe=pb.a.vua;Object(ie.a)(Jf,"TimeSlicerLevelMenu",ge.a,[]);var ak=b(327),Kh=b(3),Fg=bf.a;Wl(Dg,Fg);Dg.prototype.Od=function(){var k=this,F=this.$,X=Va.a.FHa(bh.b(),this.la,"Task","IRootUser"),ra=Fa.a(F),ab=null;ab=function(ld,ud){ra.DPf(ab);X.setResult(ud.L3b)};ra.ene(ab);ra.W_e();var Qb=eh.GetServiceTaskFactory.create(F.da,102,F.la,this.vb),Fc=eh.GetServiceTaskFactory.Xa(F.da,342,338,this.vb);Ud.TaskExtensions.Ba(Ud.TaskExtensions.te([X.task,
Qb,Fc],this.la),function(){var ld=Qb.result,ud=X.task.result,jd=Fc.result;k.Cd([new zf(F,ud,ld,jd),new Cg(F,ud,ld,jd),new yf(F,ud,ld,jd),new td(F,ud,ld,jd),new qb(F,ud,ld,jd),new hg(F,ud,ld,jd),new Yf.GridContextMenu(F,ud,ld,jd),new Aa(F,ud,ld,jd),new Og(F,ud,ld,jd),new Jf(F,ud,ld,jd),new ng(F,ud,ld,jd),new Lf(F,ud,ld,jd),new da(F,ud,ld,jd),new Jg(F,ud,ld,jd),new ef(F,ud,ld,jd)])},F.la,3)};Dg.initData=function(){var k=ak.a.w2;k(2000085697,20479,0,0);k(-227942804,Kh.a.Lc|24576,0,0);k(1634477200,Kh.a.Lc|
131072,0,0);k(-649826274,4095,0,0);k(149600865,4095,0,0);k(-2012435159,4095,0,0);k(-1979934975,4095,0,0);k(1247109494,Kh.a.Lc|24576,0,0);k(-2064931494,Kh.a.Lc|131072,0,0);k(-1396319072,Kh.a.Ia,128,0);k(-425234874,Kh.a.Ia,128,0);k(-1253126584,Kh.a.Ia,0,0);k(274207288,Kh.a.Lc|24576,0,0);k(-1497523576,Kh.a.Lc|131072,0,0);k(-498523270,Kh.a.Lc|24576,64,0);k(1640762262,Kh.a.Lc|131072,64,0);k(-2017893763,Kh.a.Lc|24576,0,0);k(1350204367,Kh.a.Lc|131072,0,0);k(-889576107,Kh.a.gw,128,0);k(-1170196828,Kh.a.gw,
128,0);k(389774337,Kh.a.gw,128,0);k(1529312473,Kh.a.gw,128,0);k(2033235475,Kh.a.gw,128,0);k(-96230454,Kh.a.gw,128,0);k(74086617,Kh.a.gw,128,0);k(563292088,Kh.a.gw,128,0);k(-1092351914,Kh.a.gw,128,0);k(-2141589616,Kh.a.gw|16384,128,0);k(745182485,Kh.a.gw,0,0);k(359279088,Kh.a.gw,128,0);k(-67292059,Kh.a.gw,128,0);k(926905850,Kh.a.gw,128,0);k(547535945,Kh.a.gw,128,0);k(1374696078,Kh.a.Lc|24576,0,0);k(495005930,Kh.a.Lc|212992,0,0);k(-1045020714,Kh.a.Lc|24576,0,0);k(-170383950,Kh.a.Lc|212992,0,0);k(324156914,
Kh.a.Ia,0,0);k(-1085236154,Kh.a.Qu,0,0);k(-751848458,Kh.a.rl|16384,0,0);k(216058793,Kh.a.Qu,0,0);k(474690375,Kh.a.rl|16384,0,0);k(-1920954846,Kh.a.Lc|24576,0,0);k(723126814,Kh.a.Lc|131072,0,0);k(2108047455,128,128,0);k(-231711729,128,128,0);k(-1909381757,128,128,0);k(-814639094,128,128,0);k(1701016594,Kh.a.Lc|3072,128,0);k(-1475408662,Kh.a.Lc|24576,0,0);k(1114549926,Kh.a.Lc|131072,32,0)};Dg.ka=function(k){bf.a.ee(10,new Dg(k))};Object(ie.a)(Dg,"ContextMenuCommandHandlerFactory",bf.a,[]);var si=b(229),
xj=b(1434),lj=b(93),gk=b(263);Ae.prototype.dispose=function(){};Ae.prototype.Y$=function(){this.Iqb.L3()};Ae.prototype.AC=function(){this.Iqb.AC()};Ae.prototype.gRd=function(k,F,X){eg.h(this.$,eg.b);this.Iqb.showContextMenu(Object(na.a)(new xj.a,{x:F.x,y:F.y}),X,k);lj.EventHandlerManager.instance.Yad()};Ae.prototype.yxc=function(k,F,X){eg.h(this.$,eg.b);this.Iqb.showFloatie(Object(na.a)(new xj.a,{x:F.x,y:F.y}),k,X);gk.a(function(){lj.EventHandlerManager.instance.Yad()},this.$.la)};Ae.prototype.fRd=
function(k,F,X,ra){eg.h(this.$,eg.b);this.Iqb.fRd(Object(na.a)(new xj.a,{x:F.x,y:F.y}),k,X,ra)};Object(ie.a)(Ae,"ReactContextMenuController",null,[769,3]);var zj=si.a;Wl(nh,zj);nh.prototype.dispose=function(){this.w9e&&this.$&&this.$.ea.Yn(this.Xkd);zj.prototype.dispose.call(this)};nh.prototype.create=function(){this.$.ea.sh?(Wd.ULS.sendTraceTag(537167065,0,50,"ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = {0}",this.$.ea.sh),this.Xkd(null,null)):(this.w9e=!0,
this.$.ea.Fl(this.Xkd))};nh.ka=function(k){k.da.Ga(338,new nh(k))};Object(ie.a)(nh,"ContextMenuControllerFactory",si.a,[]);var Qj=b(161);Object(ie.a)(Hg,"RibbonCommandParams",null,[]);Object(ie.a)(Mg,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);Lg.prototype.JIh=function(k){return(k=this.qdc[k.toString()])?k.menuModel:null};Lg.prototype.qSg=function(k,F){this.qdc[F.toString()]=Object(na.a)(new Mg,{menuModel:k,GEe:Sc.HelperMethods.Zb()})};Lg.prototype.k7b=function(k){this.qdc[k.toString()]=null};
Lg.prototype.ZXh=function(k){return(k=this.qdc[k.toString()])?k.GEe:-1};Object(ie.a)(Lg,"FilterMenuCache",null,[]);var Gg=b(13),Xh=b(195),rj=b(230);Object(ie.a)(Nf,"AutoFilterEventRegistrationArgs",null,[]);Ag.prototype.dispose=function(){window.cancelAnimationFrame(this.qBb);this.gridView&&this.gridView.Csc(this.jEb);this.gridView=null};Ag.prototype.Y7h=function(){if(this.xQd=Sc.HelperMethods.x6a)this.vZa=[];this.DBg();this.gridView.fZb(this.jEb)};Ag.prototype.DBg=function(){for(var k=Gl(this.gridView.vn),
F=k.next();!F.done;F=k.next()){F=F.value.OBa;for(var X in F){var ra=F[X];this.uJf(ra.domElement,ra.hashCode)}}};Ag.prototype.uJf=function(k,F){if(ff.g(this.$).Ea.um.r1a(F))if(k){k=k.querySelectorAll('[id^="'+We.a.K$c+'"]');for(var X=0;X<k.length;X++){var ra=k[X],ab=ra.getAttribute(We.a.ezh),Qb=ra.getAttribute(We.a.Yyh);Wd.ULS.shipAssertTag(537167053,0,!!ab&&!!Qb,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: {0}, BlockHash: {1}",
ra.id,F);ab=hb.Range.hd(parseInt(ab,10),parseInt(Qb,10));ra=Object(na.a)(new Nf,{cell:ab,qse:ra,$d:F});this.xQd?(this.vZa.push(ra),this.qBb||(this.SLe=window.performance.now(),this.qBb=window.requestAnimationFrame(this.kNf))):this.rle(ra)}}else Wd.ULS.sendTraceTag(537167054,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: {0}",F);else Wd.ULS.sendTraceTag(537167055,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: {0}",
F)};Ag.prototype.rle=function(k){var F=this.gridView.Ea.M3a(k.cell,k.$d);F?this.CBg(k.qse,F):Wd.ULS.sendTraceTag(537167050,1,10,"FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: {0}, AutoFilter Cell: {1}",k.$d,k.cell)};Ag.prototype.CBg=function(k,F){F.hasAutoFilter?this.Ezg(k,F.I$c):F.O4?this.ABg(k,F.I$c,F.Mef):Wd.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");
Qj.a.instance.pa(Gg.a.Kf,k,this.onPointerDown);Xh.a.instance.pa(Gg.a.Xxa,k,this.onPointerDown)};Ag.prototype.Ezg=function(k,F){rj.a.instance.pa(Gg.a.click,k,function(X){F&&Pg.a.hrc(X.Ca.rawEvent,966232027,F,null);return!0})};Ag.prototype.ABg=function(k,F,X){var ra=jg.a.ni(F);rj.a.instance.pa(Gg.a.click,k,function(ab){X?Pg.a.spf(document.getElementById(ra.EwaElementId),ra.Cell,ra.DataSourceIndex,ra.FieldId,ra.IsOlap,ra.RequiresConfirmation,ab.Ca.rawEvent,ra.OptionalPivotMenuAnchor):Pg.a.spfm(ab.Ca.rawEvent,
ra.RequiresConfirmation,ra.Cell,ra.DataSourceIndex,ra.PivotName,ra.OptionalPivotMenuAnchor);return!1})};Object(ie.a)(Ag,"FilterMenuPointerEventsManager",null,[3]);pg.prototype.dispose=function(){ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.dSe.dispose();this.$=null};pg.prototype.OOh=function(k){var F=ff.g(this.$).Ea.i$(k,this.$.activeItemName);return F&&F.blockPresentInViewportTimeStamp>this.u8a.ZXh(k.left)?
F.ds(k).autoFilterMenu:this.u8a.JIh(k.left)};pg.prototype.gLi=function(k,F,X){this.u8a&&this.u8a.qSg(k.menuModel[F],X)};pg.prototype.hLi=function(k){this.u8a&&this.u8a.k7b(k)};Object(ie.a)(pg,"FilterMenuManager",null,[768,3]);var mk=b(235),dk=b(183);Ef.prototype.Vcd=function(k){return ji.a.Nc(this.Xxc,k)};Ef.prototype.dispose=function(){this.Pd?Wd.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Pd=!0,this.$&&(this.$.yl(Ef.vd),this.$.da.QU(8),
this.ha&&this.ha.usc(this.Ql),this.$.Ka.XHb(this.Wuf),ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.Dza(this.uN),ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.q0(this.j6)),this.$=this.ha=null,this.t9b.dispose(),this.Xxc=this.Q5d=null)};Ef.prototype.showContextMenu=function(k,F,X){F=void 0===F?null:F;X=void 0===X?null:X;this.Xvj(k)&&(eg.h(this.$,eg.i),k=this.Q4g(k,
F,X),this.$.Ka.Wb(k.Sd,k.dictionary))};Ef.prototype.L3=function(){this.contextMenuController?this.contextMenuController.Y$():Wd.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")};Ef.prototype.Xvj=function(k){return Uh.a(this.$).Mq()?(Wd.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),Uh.a(this.$).g0(dk.a.grid,mk.a.showContextMenu),!1):!this.$.Ka.zwh&&
(!k||k.Lb!==ff.g(this.$).domElement&&!Z.a.equals(k.Lb.tagName,"INPUT",!0))};Ef.prototype.Q4g=function(k,F,X){F=void 0===F?null:F;var ra={};X=(ra.eventArgs=k,ra.creationParams=void 0===X?null:X,ra);k=k?k.zb:-1;ra=this.ha.Oa.nc;var ab=1441131127;ra?(F=ra.floatingObject,Wd.ULS.shipAssertTag(537167059,0,!!F,"floatingObj shouldn't be null."),Ef.nqd(F)?ab=1312363469:Ef.isPivotChart(F)?(X[Cg.z_c]=F?F.dd:null,ab=-149612405):ab=-1372040782):Ef.Lef(F)?(X[Cg.z_c]=F,ab=-149612405):!eg.g(this.$)&&eg.f(ff.g(this.$))&&
(ab=671488277);F=new jh.a(ab,k,this.$.Xc,30,null);return Object(na.a)(new Hg,{Sd:F,dictionary:X})};Ef.ka=function(k){k.dl(Ef.vd)};Ef.isPivotChart=function(k){return!!k&&0===k.type&&Ef.Lef(k.dd)};Ef.nqd=function(k){return!!k&&2===k.type};Ef.Lef=function(k){return!!k&&!!(k.Attributes&4)};Ck.Object.defineProperties(Ef.prototype,{t9b:{configurable:!0,enumerable:!0,get:function(){return this.Q5d}}});Ef.L1g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
Ef.N_h="GridContextMenu";Ef.vd=function(k){(k=Object(ca.a)(6,k))&&eh.GetServiceTaskFactory.create(k.da,9,k.la,0)};Object(ie.a)(Ef,"ContextMenuManager",null,[727,3]);var yj=si.a;Wl(pf,yj);pf.prototype.create=function(){var k=this,F=this.$,X=F.xc;if(X.allowSelection||X.allowEdits||X.allowFiltering||X.allowSorting||X.allowPivotSpecificOperations){var ra=eh.GetServiceTaskFactory.create(F.da,10,F.la,this.vb),ab=eh.GetServiceTaskFactory.Xa(F.da,342,338,this.vb);Ud.TaskExtensions.Ba(Ud.TaskExtensions.te([ra,
ab],this.la),function(){k.Eb(Vg.a(F)||new Ef(F,ra.result,ab.result))},this.$.la,3)}else Wd.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),F.da.QU(8),this.Eb(null)};pf.ka=function(k){k.da.Ga(9,new pf(k))};Object(ie.a)(pf,"ContextMenuManagerFactory",si.a,[]);te.prototype.isEqual=function(k){return k?this.k5===k.k5&&this.l5===k.l5&&this.ON===k.ON&&this.PN===k.PN&&this.BB===k.BB&&this.ruleType===k.ruleType&&
this.ZZ===k.ZZ&&this.bU===k.bU&&this.aU===k.aU&&this.IV===k.IV&&this.dF===k.dF&&this.w5===k.w5&&this.x5===k.x5:(Wd.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)};Object(ie.a)(te,"DataValidationEditDialogState",null,[]);Gd.prototype.$c=function(){return!1};Gd.prototype.executeCommand=function(k,F){-1728432249!==F.command&&Rg.a(F.command);this.selectedRanges=vd.r(ff.g(this.$).ha.ta.selectedRanges,this.$);ff.g(this.$).WRa(!0);this.getDataValidationInitialState();
this.kh=this.$.Pb.Gc("UserAction","DataValidationEditTimeToDialogOpen");this.iJe?Wd.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(Wd.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.iJe=!0);return Xf.Task.Sa(!0)};Gd.prototype.Mc=function(k,F){return-1728432249===F.command};Gd.prototype.jd=function(){return!1};Gd.prototype.getDataValidationInitialState=function(){var k=this,F=this.$.na.va.hc();rh.a(this.$.userOperationManager,
function(X,ra,ab){return Yg.u(k.$.na.va,k.selectedRanges,hh.b(X,k.vJi),hh.a(ra),ab,F)},function(X){return new cg.a(120,0,X,16)},null)};Gd.prototype.tZi=function(){var k=this.LB={};switch(this.S0a.Command){case 0:var F="CreateNew";break;case 1:F="CreateNewFromRule";break;case 2:F="ExpandExisitng";break;case 3:F="OverrideExisitng";break;default:F="Unknown"}k.a=F;this.kh&&(this.kh.stop(),this.LB.r=this.kh.id);switch(this.S0a.Command){case 0:this.LB.b=!1;this.LB.c="None";this.xHa(new te);break;case 1:this.LB.b=
!1;this.LB.c="None";this.xHa(new te(this.S0a));break;case 2:this.LB.b=!0;this.R4c.O3g(this.$,this.Gwh);break;case 3:this.LB.b=!0;this.R4c.Q3g(this.$,this.sUi);break;default:Wd.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}};Gd.prototype.xHa=function(k){this.R4c.xHa(this.$,this.selectedRanges,k,this.S0a.Command);this.fvi(k)};Gd.prototype.fvi=function(k){Gd.asb(k,this.LB);this.LB.d=!0;bh.b().Pe(48,this.LB,!0)};Gd.prototype.amf=function(){this.LB.d=
!1;bh.b().Pe(48,this.LB,!0)};Gd.prototype.VW=function(k,F){var X={};k=(X.ButtonType=Gd.lia(F),X.DialogName=k,X.Location="dialog",X.NumberOfSelectedRanges=ff.g(this.$).ha.ta.xK,X);Ph.b(this.$).Rd(Th.a.j6b,k)};Gd.asb=function(k,F){F.e=Sd(k.ruleType);F.f=If(k.BB);F.g=!!k.ON;F.h=!!k.PN;F.i=k.k5;F.j=k.l5;F.k=k.x5;F.l=!!k.dF;F.m=!!k.IV;F.n=k.w5;F.o=k.ZZ;F.p=!!k.bU;F.q=!!k.aU};Gd.lia=function(k){switch(k){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return Wd.ULS.shipAssertTag(537163281,
0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Object(ie.a)(Gd,"DataValidationEditCommandHandler",null,[428]);var Gi=b(1006),Nh;(function(k){k[k.between=0]="between";k[k.notBetween=1]="notBetween";k[k.equal=2]="equal";k[k.notEqual=3]="notEqual";k[k.greaterThan=4]="greaterThan";k[k.lessThan=5]="lessThan";k[k.greaterThanOrEqual=6]="greaterThanOrEqual";k[k.lessThanOrEqual=7]="lessThanOrEqual"})(Nh||(Nh={}));Object(ie.b)("DataValidationRuleConditionType",
Nh);var Hh;(function(k){k[k.anyValue=0]="anyValue";k[k.wholeNumber=1]="wholeNumber";k[k.decimal=2]="decimal";k[k.list=3]="list";k[k.date=4]="date";k[k.time=5]="time";k[k.textLength=6]="textLength";k[k.custom=7]="custom"})(Hh||(Hh={}));Object(ie.b)("DataValidationRuleType",Hh);var Aj=b(150),Kf=b(179);Ck.Object.defineProperties(xd,{hg:{configurable:!0,enumerable:!0,get:function(){return Aj.a.$o(xd.zk,"")}},Zdh:{configurable:!0,enumerable:!0,get:function(){return Aj.a.$o(xd.ceh,Kf.a.ga(1647),Kf.a.ga(1662),
Kf.a.ga(1663),Kf.a.ga(1664),Kf.a.ga(1665),Kf.a.ga(1666),Kf.a.ga(1667),Kf.a.ga(1668),Kf.a.ga(1669),Kf.a.ga(1648),Kf.a.ga(1672),Kf.a.ga(1673),Kf.a.ga(1674),Kf.a.ga(1675),Kf.a.ga(1676),Kf.a.ga(1677),Kf.a.ga(1678),Kf.a.ga(1679),Kf.a.ga(1649),Kf.a.ga(1650),Kf.a.ga(1670),Kf.a.ga(1671),Kf.a.ga(1661),"255")}},feh:{configurable:!0,enumerable:!0,get:function(){return Aj.a.$o(xd.deh,Kf.a.ga(1684),Kf.a.ga(1688),Kf.a.ga(1689),"255","32")}},jeh:{configurable:!0,enumerable:!0,get:function(){return Aj.a.$o(xd.eeh,
Kf.a.ga(1683),Kf.a.ga(1686),Kf.a.ga(1685),Kf.a.ga(1687),Kf.a.ga(1688),Kf.a.ga(1689),"255","32")}}});xd.U7f=255;xd.zk="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";xd.ceh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
xd.deh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
xd.eeh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(ie.a)(xd,"DataValidationEditDialogHtml",null,[]);var sf=b(615),$h=Fi.a;Wl(pc,$h);pc.prototype.oAa=function(k){this.cU.selectedIndex=k.ruleType;this.zK.selectedIndex=k.BB;this.kec.checked=k.l5;this.ewa.checked=k.k5;this.Hya.value=k.ON;this.Iya.value=k.PN;this.uca(null)};pc.prototype.gpb=function(k){k.k5=this.ewa.checked;k.l5=this.kec.checked;k.BB=this.zK.selectedIndex;k.ruleType=this.cU.selectedIndex;k.ON=this.Hya.value;k.PN=this.Iya.value};pc.prototype.dispose=function(){this.al();this.Ck=
this.RBd=this.Soc=this.UOa=this.b$a=this.uNa=this.k5a=this.kec=this.Iya=this.Hya=this.zK=this.cU=this.ewa=null;$h.prototype.dispose.call(this)};pc.prototype.render=function(k){k.appendChild(this.domElement)};pc.prototype.Kja=function(){return this.isVisible};pc.prototype.Kna=function(k){return this.isVisible=k};pc.prototype.setFocus=function(){};pc.prototype.avb=function(k,F){return this.S_e(k,F,this.EAh)};pc.prototype.Sfd=function(k,F){return 0!==F&&1!==F?"":this.S_e(k,F,this.Jjj)};pc.prototype.eka=
function(){this.domElement.innerHTML=xd.Zdh;this.ewa=nf.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.cU=nf.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.zK=nf.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Hya=nf.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.Iya=nf.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.Soc=nf.DOMElementExtensions.getElementById(this.domElement,
"operatorInputLableId1");this.RBd=nf.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.k5a=nf.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.uNa=nf.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.b$a=nf.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.UOa=nf.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.kec=nf.DOMElementExtensions.getElementById(this.domElement,
"inCellDropdownCheckboxId");this.Ej()};pc.prototype.S_e=function(k,F,X){return X.length<k||X[k].length<F?(Wd.ULS.sendTraceTag(537163280,0,10,"DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption={0} operatorOption={1}, cannot get label.",k,F),""):this.pR.oa(X[k][F])};pc.prototype.Ej=function(){sf.a.instance.pa(Gg.a.Xb,this.cU,this.mnc);sf.a.instance.pa(Gg.a.Xb,this.zK,this.mnc);sf.a.instance.pa(Gg.a.change,this.cU,this.uca);sf.a.instance.pa(Gg.a.change,this.zK,this.uca);sf.a.instance.pa(Gg.a.change,
this.zK,this.Ck);sf.a.instance.pa(Gg.a.change,this.cU,this.Ck);sf.a.instance.pa(Gg.a.change,this.Hya,this.Ck);sf.a.instance.pa(Gg.a.Xb,this.Hya,this.Ck);sf.a.instance.pa(Gg.a.change,this.Iya,this.Ck);sf.a.instance.pa(Gg.a.Xb,this.Iya,this.Ck)};pc.prototype.al=function(){sf.a.instance.Aa(Gg.a.Xb,this.cU,this.mnc);sf.a.instance.Aa(Gg.a.Xb,this.zK,this.mnc);sf.a.instance.Aa(Gg.a.change,this.cU,this.uca);sf.a.instance.Aa(Gg.a.change,this.zK,this.uca);sf.a.instance.Aa(Gg.a.change,this.zK,this.Ck);sf.a.instance.Aa(Gg.a.change,
this.cU,this.Ck);sf.a.instance.Aa(Gg.a.change,this.Hya,this.Ck);sf.a.instance.Aa(Gg.a.Xb,this.Hya,this.Ck);sf.a.instance.Aa(Gg.a.change,this.Iya,this.Ck);sf.a.instance.Aa(Gg.a.Xb,this.Iya,this.Ck)};pc.jja=function(){var k;return k=new Ka.a,k.add("operatorInputId1"),k.add("operatorInputId2"),k};Ck.Object.defineProperties(pc.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return we.a.instance.ga(1680)}},h0g:{configurable:!0,enumerable:!0,get:function(){return this.cU.selectedIndex}}});
Object(ie.a)(pc,"DataValidationEditConditionsControl",Fi.a,[811,3,813]);var Di=b(206),zi=Gi.a;Wl(Wb,zi);Wb.prototype.QRd=function(){var k={};k=(k.RuleType=this.Hd.ruleType,k.RuleOperatorType=this.Hd.BB,k.OperatorInput1=this.Hd.ON,k.OperatorInput2=this.Hd.PN,k.IsIgnoreBlank=this.Hd.k5,k.IsInCellDropDown=this.Hd.l5,k.IsAlertBlocking=this.Hd.ZZ,k.AlertTitle=this.Hd.bU,k.AlertMessage=this.Hd.aU,k.InputTitle=this.Hd.dF,k.InputMessage=this.Hd.IV,k.IsShowErrorAlert=this.Hd.w5,k.IsShowInputMessage=this.Hd.x5,
k);this.Ac(2,we.a.instance.ga(1646));var F={};k=(F[Wb.Px]=this.Cc,F.validateDialogValues=this.wTj,F.RangePickerController=ff.g(this.$).ug.Ibc(),F.isModal=!1,F.bodyProps=k,F);this.initializeAndShow(we.a.instance.ga(1645),this.Q4c,k);Wd.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")};Wb.prototype.dispose=function(){this.disposed||(zi.prototype.dispose.call(this),this.disposed=!0)};Wb.prototype.jja=function(){return pc.jja()};Wb.prototype.lLh=function(k,F){var X=this;return function(ra,
ab,Qb){var Fc=k.na.va.hc();return hc(X.$.na.va,X.selectedRanges,X.uQg(),X.u_a(ra,X.lzd(F)),hh.a(ab),Qb,Fc)}};Wb.prototype.lzd=function(k){var F=this;return function(X){Wd.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");var ra;qc.a(X)?(Wd.ULS.sendTraceTag(537163276,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",X?Vf.a.Tc(X.Errors):null),X.Errors&&1===X.Errors.length&&((ra=F.gdd(X.Errors[0].MessageId))?
F.fla("OkInvalidByServer",X.Errors[0].MessageIdName):(F.fla("OkValid","None"),F.hide()),k(ra)),Wd.ULS.sendTraceTag(537163275,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",Vf.a.Tc(X.Errors))):F.hide()}};Wb.prototype.uQg=function(){var k={};k.Command=this.command;k.RuleType=this.Hd.ruleType;k.ConditionType=this.Hd.BB;k.IsIgnoreBlank=this.Hd.k5;k.IsInCellDropDown=this.Hd.l5;k.LowerBoundary=this.Hd.ON;k.UpperBoundary=this.Hd.PN;k.IsAlertBlocking=
this.Hd.ZZ;k.IsShowErrorAlert=this.Hd.w5;k.IsShowInputMessage=this.Hd.x5;k.AlertTitle=this.Hd.bU;k.AlertMessage=this.Hd.aU;k.InputTitle=this.Hd.dF;k.InputMessage=this.Hd.IV;k.ShouldIgnoreFormulaError=this.RMa;return k};Wb.prototype.gdd=function(k){switch(k){case 1173235830:return we.a.instance.ga(1695);case 43935303:return we.a.instance.ga(1696);case -1323438439:return we.a.instance.ga(1698);case 2112020473:return we.a.instance.ga(1692);case -219503282:return we.a.instance.ga(1693);case 1689335445:return we.a.instance.ga(1694);
case 2146493810:return we.a.instance.ga(1697);case -2104909922:return String.format(we.a.instance.Bb(105),this.Itb,this.uMd);case -869372599:return String.format(we.a.instance.Bb(104),this.Itb);case -1181828368:return we.a.instance.ga(1700);case -758480861:return we.a.instance.ga(1701);case -13729088:return we.a.instance.ga(1702);case -846654055:return we.a.instance.ga(1703);case 751854001:return we.a.instance.ga(1704);case -453846397:return we.a.instance.ga(1705);case 1102013489:return we.a.instance.ga(1706);
case 835813260:return we.a.instance.ga(1707);case 1577787509:return we.a.instance.ga(1708);case 2083564019:return we.a.instance.ga(1699);default:Wd.ULS.sendTraceTag(537163274,0,15,"DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: {0}.",k.toString())}return null};Wb.prototype.Tla=function(){this.fla("Cancel","None")};Wb.prototype.VW=function(k){Wd.ULS.sendTraceTag(537163273,0,50,"DataValidationEditDialog {0} was clicked.",1===k?"Ok":"Cancel");var F={};k=(F.ButtonType=
Wb.lia(k),F.DialogName=this.Cc,F.Location="dialog",F.NumberOfSelectedRanges=ff.g(this.$).ha.ta.xK,F);Ph.b(this.$).Rd(Th.a.j6b,k)};Wb.prototype.fla=function(k,F){var X={};Wb.asb(this.Hd,X);X.o=k;X.p=F;X.n=this.ska;this.kh&&(this.kh.stop(),X.q=this.kh.id);bh.b().Pe(49,X,!0)};Wb.prototype.Eac=function(k){this.Hd.ruleType=k.RuleType;this.Hd.BB=k.RuleOperatorType;this.Hd.ON=k.OperatorInput1;this.Hd.PN=k.OperatorInput2;this.Hd.ZZ=k.IsAlertBlocking;this.Hd.w5=k.IsShowErrorAlert;this.Hd.bU=k.AlertTitle;this.Hd.aU=
k.AlertMessage;this.Hd.x5=k.IsShowInputMessage;this.Hd.dF=k.InputTitle;this.Hd.IV=k.InputMessage;this.Hd.k5=k.IsIgnoreBlank;this.Hd.l5=k.IsInCellDropDown;this.Itb=k.firstOperatorLabel;this.uMd=k.secondOperatorLabel};Wb.prototype.COb=function(k,F,X){var ra;var ab=ra=null;if(!k)return X?(ra=String.format(we.a.instance.Bb(105),this.Itb,this.uMd),ab="DataValidationEditNoMinMaxError"):(ra=String.format(we.a.instance.Bb(104),this.Itb),ab="DataValidationEditNoValueError"),{returnValue:!1,errorString:ra,
Eq:ab};if(k.length>xd.U7f)return ra=we.a.instance.ga(1699),{returnValue:!1,errorString:ra,Eq:ab};if(Di.d(k))return{returnValue:!0,errorString:ra,Eq:ab};if(1===F||2===F||6===F){if(!Z.a.q5(k))return ra=we.a.instance.ga(1692),{returnValue:!1,errorString:ra,Eq:ab};if(1===F&&!Z.a.isInteger(k))return ra=we.a.instance.ga(1693),{returnValue:!1,errorString:ra,Eq:ab};if(6===F){if(!Z.a.isInteger(k))return ra=we.a.instance.ga(1693),{returnValue:!1,errorString:ra,Eq:ab};if(0>parseInt(k,10))return ra=we.a.instance.ga(1694),
{returnValue:!1,errorString:ra,Eq:ab}}}return{returnValue:!0,errorString:ra,Eq:ab}};Wb.prototype.$Yd=function(){var k=this,F;var X=F=null;var ra=this.Hd.ON,ab=this.Hd.PN,Qb=Hh[this.Hd.ruleType],Fc=Nh[this.Hd.BB];if(0===Qb)return{returnValue:!0,errorString:F,Eq:X};var ld=(0===Fc||1===Fc)&&3!==Qb&&7!==Qb;return!function(){var ud=k.COb(ra,Qb,ld);F=ud.errorString;X=ud.Eq;return ud}().returnValue||ld&&!function(){var ud=k.COb(ab,Qb,ld);F=ud.errorString;X=ud.Eq;return ud}().returnValue?{returnValue:!1,
errorString:F,Eq:X}:ld&&(1===Qb||2===Qb||6===Qb)&&!Di.d(ra)&&!Di.d(ab)&&parseFloat(ra)>parseFloat(ab)?(F=we.a.instance.ga(1697),X="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:F,Eq:X}):{returnValue:!0,errorString:F,Eq:X}};Wb.lia=function(k){switch(k){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return Wd.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Wb.asb=function(k,F){F.a=Sd(k.ruleType);
F.b=If(k.BB);F.c=!!k.ON;F.d=!!k.PN;F.e=k.k5;F.f=k.l5;F.g=k.x5;F.h=!!k.dF;F.i=!!k.IV;F.j=k.w5;F.k=k.ZZ;F.l=!!k.bU;F.m=!!k.aU};Ck.Object.defineProperties(Wb.prototype,{Hd:{configurable:!0,enumerable:!0,get:function(){return this.NRb}},Cc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},M1b:{configurable:!0,enumerable:!0,get:function(){return 3===this.Hd.ruleType}}});Object(ie.a)(Wb,"DataValidationEditDialog",Gi.a,[]);var xk=b(323);ob.Nah="DataValidationDialogPanel";ob.Mah=
"DataValidationButtonPanel";ob.Lah="DataValidationButtonClearAll";Object(ie.a)(ob,"CssClassNames",null,[]);var Pi=Fi.a;Wl(sa,Pi);sa.prototype.render=function(k){k.appendChild(this.domElement)};sa.prototype.Kja=function(){return this.isVisible};sa.prototype.Kna=function(k){return this.isVisible=k};sa.prototype.setFocus=function(){};sa.prototype.dispose=function(){this.al();this.Ck=this.mba=this.lba=this.g$e=this.kba=null;Pi.prototype.dispose.call(this)};sa.prototype.eka=function(){this.domElement.innerHTML=
xd.feh;this.kba=nf.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");this.g$e=nf.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.mba=nf.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.lba=nf.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.kba.checked=!0;this.Ej();this.onc(null)};sa.prototype.oAa=function(k){this.mba.value=void 0===k.dF||null===k.dF?"":k.dF;this.lba.value=void 0===
k.IV||null===k.IV?"":k.IV;this.kba.checked=k.x5;this.onc(null)};sa.prototype.gpb=function(k){k.dF=this.mba.value;k.IV=this.lba.value;k.x5=this.kba.checked};sa.prototype.Ej=function(){sf.a.instance.pa(Gg.a.change,this.kba,this.onc);sf.a.instance.pa(Gg.a.change,this.kba,this.Ck);sf.a.instance.pa(Gg.a.change,this.mba,this.Ck);sf.a.instance.pa(Gg.a.Xb,this.mba,this.Ck);sf.a.instance.pa(Gg.a.change,this.lba,this.Ck);sf.a.instance.pa(Gg.a.Xb,this.lba,this.Ck)};sa.prototype.al=function(){sf.a.instance.Aa(Gg.a.change,
this.kba,this.onc);sf.a.instance.Aa(Gg.a.change,this.kba,this.Ck);sf.a.instance.Aa(Gg.a.change,this.mba,this.Ck);sf.a.instance.Aa(Gg.a.Xb,this.mba,this.Ck);sf.a.instance.Aa(Gg.a.change,this.lba,this.Ck);sf.a.instance.Aa(Gg.a.Xb,this.lba,this.Ck)};Ck.Object.defineProperties(sa.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return we.a.instance.ga(1682)}}});Object(ie.a)(sa,"DataValidationEditInputControl",Fi.a,[811,3,814]);var nk=Fi.a;Wl(Xd,nk);Xd.prototype.render=function(k){k.appendChild(this.domElement)};
Xd.prototype.Kja=function(){return this.isVisible};Xd.prototype.Kna=function(k){return this.isVisible=k};Xd.prototype.setFocus=function(){};Xd.prototype.dispose=function(){this.al();this.Ck=this.R9=this.Q9=this.VTa=this.pha=this.P9=null;nk.prototype.dispose.call(this)};Xd.prototype.eka=function(){this.domElement.innerHTML=xd.jeh;this.P9=nf.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.pha=nf.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.VTa=
nf.DOMElementExtensions.getElementById(this.domElement,"warningId");this.R9=nf.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.Q9=nf.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.P9.checked=!0;this.pha.checked=!0;this.Ej();this.nnc(null)};Xd.prototype.oAa=function(k){this.pha.checked=k.ZZ;this.VTa.checked=!k.ZZ;this.R9.value=void 0===k.bU||null===k.bU?"":k.bU;this.Q9.value=void 0===k.aU||null===k.aU?"":k.aU;this.P9.checked=k.w5;this.nnc(null)};
Xd.prototype.gpb=function(k){k.bU=this.R9.value;k.aU=this.Q9.value;k.ZZ=this.pha.checked;k.w5=this.P9.checked};Xd.prototype.Ej=function(){sf.a.instance.pa(Gg.a.change,this.P9,this.nnc);sf.a.instance.pa(Gg.a.change,this.P9,this.Ck);sf.a.instance.pa(Gg.a.change,this.pha,this.Ck);sf.a.instance.pa(Gg.a.change,this.VTa,this.Ck);sf.a.instance.pa(Gg.a.change,this.R9,this.Ck);sf.a.instance.pa(Gg.a.Xb,this.R9,this.Ck);sf.a.instance.pa(Gg.a.change,this.Q9,this.Ck);sf.a.instance.pa(Gg.a.Xb,this.Q9,this.Ck)};
Xd.prototype.al=function(){sf.a.instance.Aa(Gg.a.change,this.P9,this.nnc);sf.a.instance.Aa(Gg.a.change,this.P9,this.Ck);sf.a.instance.pa(Gg.a.change,this.pha,this.Ck);sf.a.instance.pa(Gg.a.change,this.VTa,this.Ck);sf.a.instance.Aa(Gg.a.change,this.R9,this.Ck);sf.a.instance.Aa(Gg.a.Xb,this.R9,this.Ck);sf.a.instance.Aa(Gg.a.change,this.Q9,this.Ck);sf.a.instance.Aa(Gg.a.Xb,this.Q9,this.Ck)};Ck.Object.defineProperties(Xd.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return we.a.instance.ga(1681)}}});
Object(ie.a)(Xd,"DataValidationEditMessagesControl",Fi.a,[811,3,812]);Object(ie.a)(dc,"MacroRecorderRangeDataValidationChangedPayload",null,[450]);var Rj=b(67),Bj=xk.a;Wl(nd,Bj);nd.prototype.QRd=function(){var k={};k=(k.key=this.Hd,k);this.initializeAndShow(we.a.instance.ga(1645),this.Q4c,k);Wd.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")};nd.prototype.dispose=function(){this.disposed||(this.Jec=this.alc=this.r3=null,zg.a.Ha(this.VCb),this.VCb=null,Ph.b(this.$)&&
Ph.b(this.$).pTd("DataValidationDialogCorellation"),Bj.prototype.dispose.call(this),this.disposed=!0)};nd.prototype.zv=function(k){Bj.prototype.zv.call(this,k);this.Ac(2,we.a.instance.ga(1646));k=this.pV(2);var F=this.pV(1),X=this.pV(0),ra=F.parentNode;ra.appendChild(k);ra.appendChild(F);ra.appendChild(X);k.parentNode.classList.add(ob.Mah);k.classList.add(ob.Lah);k=document.getElementById("dataValidationTabsId");F=new pc(this.$,document.createElement("div"),this.uca);X=new sa(document.createElement("div"),
this.uca);ra=new Xd(document.createElement("div"),this.uca);this.V$h(F,X,ra);var ab;this.VCb=new id(k,(ab=new Ka.a,ab.add(F),ab.add(X),ab.add(ra),ab));this.VCb.bQf();this.dV=document.getElementById("validationErrorMessageId");this.oAa();Ph.b(this.$)&&Ph.b(this.$).$Sd("DataValidationDialogCorellation")};nd.prototype.wO=function(){Bj.prototype.wO.call(this);document.getElementById(this.oi("WACDialogPanel")).classList.add(ob.Nah)};nd.prototype.jja=function(){return pc.jja()};nd.prototype.vdd=function(){return"validationErrorMessageId"};
nd.prototype.V$h=function(k,F,X){this.r3=k;this.Jec=F;this.alc=X};nd.prototype.Okj=function(){function k(){return new dc(F.selectedRanges,X)}var F=this,X={};X.IsClearAll=this.ska;X.Command=this.command;X.RuleType=this.Hd.ruleType;X.ConditionType=this.Hd.BB;X.IsIgnoreBlank=this.Hd.k5;X.IsInCellDropDown=this.Hd.l5;X.LowerBoundary=this.Hd.ON;X.UpperBoundary=this.Hd.PN;X.IsAlertBlocking=this.Hd.ZZ;X.IsShowErrorAlert=this.Hd.w5;X.IsShowInputMessage=this.Hd.x5;X.AlertTitle=this.Hd.bU;X.AlertMessage=this.Hd.aU;
X.InputTitle=this.Hd.dF;X.InputMessage=this.Hd.IV;X.ShouldIgnoreFormulaError=this.RMa;var ra=this.$.na.va.hc();rh.a(this.$.userOperationManager,function(ab,Qb,Fc){return hc(F.$.na.va,F.selectedRanges,X,hh.b(ab,F.lzd),hh.a(Qb),Fc,ra)},function(ab){return new cg.a(121,0,ab,void 0,k)},null)};nd.prototype.Fwj=function(k){return 1577787509===k};nd.prototype.Trj=function(k){this.dV.innerText=k;this.rI(this.pV(0));this.RMa=!0};nd.prototype.nye=function(){this.RMa=!1;this.dV.innerText=""};nd.prototype.gdd=
function(k){switch(k){case 1173235830:return we.a.instance.ga(1695);case 43935303:return we.a.instance.ga(1696);case -1323438439:return we.a.instance.ga(1698);case 2112020473:return we.a.instance.ga(1692);case -219503282:return we.a.instance.ga(1693);case 1689335445:return we.a.instance.ga(1694);case 2146493810:return we.a.instance.ga(1697);case -2104909922:return String.format(we.a.instance.Bb(105),this.r3.avb(this.Hd.ruleType,this.Hd.BB),this.r3.Sfd(this.Hd.ruleType,this.Hd.BB));case -869372599:return String.format(we.a.instance.Bb(104),
this.r3.avb(this.Hd.ruleType,this.Hd.BB));case -1181828368:return we.a.instance.ga(1700);case -758480861:return we.a.instance.ga(1701);case -13729088:return we.a.instance.ga(1702);case -846654055:return we.a.instance.ga(1703);case 751854001:return we.a.instance.ga(1704);case -453846397:return we.a.instance.ga(1705);case 1102013489:return we.a.instance.ga(1706);case 835813260:return we.a.instance.ga(1707);case 1577787509:return we.a.instance.ga(1708);case 2083564019:return we.a.instance.ga(1699);default:Wd.ULS.sendTraceTag(537163265,
0,15,"DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: {0}.",k.toString())}return null};nd.prototype.I9a=function(){Wd.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.Eac();var k=this.$Yd();var F=k.errorString;var X=k.Eq;if(!k.returnValue)return this.Cr(F),this.fla("OkInvalidByClient",X),!1;this.Okj();return!0};nd.prototype.Tla=function(){this.Eac();this.fla("Cancel","None");this.hide()};nd.prototype.jya=function(){Wd.ULS.sendTraceTag(537163235,
0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.RMa?this.nye():this.Y_c();this.lej();this.ska=!0};nd.prototype.VW=function(k){var F={};k=(F.ButtonType=nd.lia(k),F.DialogName=this.Cc,F.Location="dialog",F.NumberOfSelectedRanges=ff.g(this.$).ha.ta.xK,F);Ph.b(this.$).Rd(Th.a.j6b,k)};nd.prototype.lej=function(){this.NRb=new te;this.oAa()};nd.prototype.oAa=function(){this.alc.oAa(this.Hd);this.Jec.oAa(this.Hd);this.r3.oAa(this.Hd)};nd.prototype.Eac=function(){this.r3.gpb(this.Hd);
this.alc.gpb(this.Hd);this.Jec.gpb(this.Hd)};nd.prototype.fla=function(k,F){var X={};nd.asb(this.Hd,X);X.o=k;X.p=F;X.n=this.ska;this.kh&&(this.kh.stop(),X.q=this.kh.id);bh.b().Pe(49,X,!0)};nd.prototype.COb=function(k,F){var X;var ra=X=null;if(!k)return F?(X=String.format(we.a.instance.Bb(105),this.r3.avb(this.Hd.ruleType,this.Hd.BB),this.r3.Sfd(this.Hd.ruleType,this.Hd.BB)),ra="DataValidationEditNoMinMaxError"):(X=String.format(we.a.instance.Bb(104),this.r3.avb(this.Hd.ruleType,this.Hd.BB)),ra="DataValidationEditNoValueError"),
{returnValue:!1,errorString:X,Eq:ra};if(k.length>xd.U7f)return X=we.a.instance.ga(1699),{returnValue:!1,errorString:X,Eq:ra};if(Di.d(k))return{returnValue:!0,errorString:X,Eq:ra};if(1===this.Hd.ruleType||2===this.Hd.ruleType||6===this.Hd.ruleType){if(!Z.a.q5(k))return X=we.a.instance.ga(1692),{returnValue:!1,errorString:X,Eq:ra};if(1===this.Hd.ruleType&&!Z.a.isInteger(k))return X=we.a.instance.ga(1693),{returnValue:!1,errorString:X,Eq:ra};if(6===this.Hd.ruleType){if(!Z.a.isInteger(k))return X=we.a.instance.ga(1693),
{returnValue:!1,errorString:X,Eq:ra};if(0>parseInt(k,10))return X=we.a.instance.ga(1694),{returnValue:!1,errorString:X,Eq:ra}}}return{returnValue:!0,errorString:X,Eq:ra}};nd.prototype.$Yd=function(){var k=this,F;var X=F=null;if(this.ska||0===this.Hd.ruleType)return{returnValue:!0,errorString:F,Eq:X};var ra=(0===this.Hd.BB||1===this.Hd.BB)&&3!==this.Hd.ruleType&&7!==this.Hd.ruleType;return!function(){var ab=k.COb(k.Hd.ON,ra);F=ab.errorString;X=ab.Eq;return ab}().returnValue||ra&&!function(){var ab=
k.COb(k.Hd.PN,ra);F=ab.errorString;X=ab.Eq;return ab}().returnValue?{returnValue:!1,errorString:F,Eq:X}:ra&&(1===this.Hd.ruleType||2===this.Hd.ruleType||6===this.Hd.ruleType)&&!Di.d(this.Hd.ON)&&!Di.d(this.Hd.PN)&&parseFloat(this.Hd.ON)>parseFloat(this.Hd.PN)?(F=we.a.instance.ga(1697),X="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:F,Eq:X}):{returnValue:!0,errorString:F,Eq:X}};nd.lia=function(k){switch(k){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return Wd.ULS.shipAssertTag(537163234,
0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}};nd.asb=function(k,F){F.a=Sd(k.ruleType);F.b=If(k.BB);F.c=!!k.ON;F.d=!!k.PN;F.e=k.k5;F.f=k.l5;F.g=k.x5;F.h=!!k.dF;F.i=!!k.IV;F.j=k.w5;F.k=k.ZZ;F.l=!!k.bU;F.m=!!k.aU};Ck.Object.defineProperties(nd.prototype,{Hd:{configurable:!0,enumerable:!0,get:function(){return this.NRb}},Cc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},onCommitDialogHandler:{configurable:!0,enumerable:!0,
get:function(){var k=this;return function(){k.VW(1);k.I9a()}},set:function(k){Object(Rj.b)(nd.prototype,this,"onCommitDialogHandler",k)}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}},M1b:{configurable:!0,enumerable:!0,get:function(){return 3===this.r3.h0g}}});Object(ie.a)(nd,"DataValidationEditDialogDeprecated",xk.a,[]);ke.prototype.xHa=function(k,F,X,ra){ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new Wb(k,F,X,ra)).QRd():
(new nd(k,F,X,ra)).QRd()};ke.prototype.O3g=function(k,F){var X=new Fh.StandardDialog;X.ic=3;X.EAa(k.Ab.xZ,we.a.instance.ga(1690),F)};ke.prototype.Q3g=function(k,F){var X=new Fh.StandardDialog;X.ic=1;X.pX(k.Ab.xZ,we.a.instance.ga(1691),F)};Object(ie.a)(ke,"DataValidationEditDialogFactory",null,[767]);var Nk=bf.a;Wl(re,Nk);re.prototype.Od=function(){this.Cd([new Gd(this.$,new ke)])};re.ka=function(k){bf.a.ee(245,new re(k))};Object(ie.a)(re,"DataValidationEditCommandHandlerFactory",bf.a,[]);Fd.Rhg='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(ie.a)(Fd,"FileUploadDialogHTML",null,[]);var Ik=b(157),Si=Aj.a;Wl(Kc,Si);Kc.prototype.si=function(k,F,X,ra,ab){ab=void 0===ab?!0:ab;this.Iud=void 0===ra?!1:ra;this.Hxj(F);this.Umf=k;ab&&Rf.AFrameworkApplication.PF(k)};Kc.prototype.Hxj=function(k){if(Kc.Au)this.ozj(k);else{var F={};F[Kc.ZRg]=k;F[Kc.eSg]=CommonUIStrings.l_SendFileErrorReportMessage;F[Kc.fSg]=CommonUIStrings.l_SendFileErrorReportTextCaption;F[Kc.ZYc]="";F[Kc.bSg]=CommonUIStrings.l_UserReportLinkText;F[Kc.b1b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,
Object(Df.a)(this,this.oqi,"legacyDialogHandler"),F);this.jX(Kc.kSg)}};Kc.prototype.ozj=function(k){var F={},X={},ra={},ab={},Qb={};k=(Qb.id=this.Ne,Qb.bodyControls=(ab.reportErrorCheckboxProps=this.Iud?(F.label=CommonUIStrings.l_UserReportLinkText,F):null,ab.textAreaProps=this.Knf?{}:null,ab.privacyStatementLinkProps=(ra.text=CommonUIStrings.l_PrivacyStatement,ra.handler=(X.href=Rf.AFrameworkApplication.Hma,X.target="_blank",X),ra),ab),Qb.errorMessage=k,Qb.errorReportMessage=CommonUIStrings.l_SendFileErrorReportMessage,
Qb.errorTextPrompt=CommonUIStrings.l_SendFileErrorReportTextCaption,Qb);this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(Df.a)(this,this.$Fd,"reactDialogHandler"),k)};Kc.prototype.t9a=function(){if(!Kc.Au){var k=document.getElementById(Kc.hSg);k&&(k.className=Kc.gSg,k.appendChild(Ik.createClusteredImage(32,32,Kc.dSg,null,!0,CommonUIStrings.l_DialogError)));if(k=document.getElementById(Kc.iSg))k.innerText=CommonUIStrings.l_PrivacyStatement,k.href=Rf.AFrameworkApplication.Hma,rb.a.addHandler(k,
"click",Object(Df.a)(this,this.qOi,"onPrivacyClickHandler"));this.Knf||(k=document.getElementById(Kc.ZYc))&&k.parentNode&&k.parentNode.removeChild(k);this.Iud||(k=document.getElementById(Kc.aSg))&&k.parentNode&&k.parentNode.removeChild(k)}};Kc.prototype.wO=function(){Kc.Au||(Si.prototype.wO.call(this),document.getElementById(this.oi("WACDialogPanel")).style.width=String.format("{0}px",400))};Kc.prototype.oqi=function(k,F){var X=F[Kc.ZYc]||"",ra=!0;void 0!==F[Kc.b1b]&&null!==F[Kc.b1b]&&(ra=F[Kc.b1b]);
this.rw(k,X,ra)};Kc.prototype.$Fd=function(k,F){this.rw(k,F.text||"",F.reportErrorChecked)};Kc.prototype.rw=function(k,F,X){this.Nmf&&(X&&Wd.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.Umf),this.Nmf(k,F,X))};Kc.prototype.qOi=function(k){Rf.AFrameworkApplication.Ib.se(ug.a.gza,2,k)};Ck.Object.defineProperties(Kc.prototype,{canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}}});Ck.Object.defineProperties(Kc,{Au:{configurable:!0,enumerable:!0,get:function(){return Rf.AFrameworkApplication.sa.Qa.lv&&
Rf.AFrameworkApplication.sa.Qa.Tji}}});Kc.ZRg="WACDialogErrorMessage";Kc.eSg="WACDialogErrorReportMessage";Kc.fSg="WACDialogErrorTextPrompt";Kc.ZYc="WACDialogInput";Kc.iSg="WACDialogPrivacyText";Kc.hSg="WACDialogIconPanel";Kc.dSg="CancelRequest_32x32x32";Kc.gSg="WACDialogIcon";Kc.kSg="WACDialogTextPanel";Kc.b1b="WACDialogSendFileCheckbox";Kc.aSg="WACDialogSendFileCheckboxContainer";Kc.bSg="WACDialogSendFileCheckboxText";Kc.cSg="FileUploadErrorDialog";Object(ie.a)(Kc,"FileUploadErrorDialog",Aj.a,[]);
var ek=Ga.a;Wl(lc,ek);lc.prototype.LDg=function(k){this.addHandler("fileCollectionComplete",k)};lc.prototype.c$i=function(k){this.removeHandler("fileCollectionComplete",k)};lc.prototype.hZg=function(k,F,X){this.FHf=F;this.bH=k;this.LDg(X);Rf.AFrameworkApplication.Hma=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;k=new Kc(this.iZg);Rf.AFrameworkApplication.Ib.fc(ug.a.gza,Hi.a.frame,lc.r_i);k.si(0,"",null,!1,!1)};lc.prototype.M8i=function(k){this.c$i(k)};lc.r_i=function(k,F,X,ra,ab){rb.a.St(ab);
Rf.AFrameworkApplication.Hma&&Sc.HelperMethods.mf(Rf.AFrameworkApplication.Hma,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32};Object(ie.a)(lc,"FileCollectionOperation",Ga.a,[763,3]);var K=si.a;Wl(Qf,K);Qf.prototype.create=function(){var k=this;Ud.TaskExtensions.Ba(eh.GetServiceTaskFactory.create(this.$.da,155,this.la,this.vb),function(){k.Eb(k.iyh)},this.la,3)};Qf.prototype.dispose=function(){zg.a.Ha(this.nSb);this.nSb=null;K.prototype.dispose.call(this)};Qf.ka=function(k){k.da.Ga(125,
new Qf(k))};Ck.Object.defineProperties(Qf.prototype,{iyh:{configurable:!0,enumerable:!0,get:function(){return this.nSb||(this.nSb=new lc(this.$))}}});Object(ie.a)(Qf,"FileCollectionCommandHandlerFactory",si.a,[]);var Ca=b(1008),Mb=b(189),tc=b(280),Zc=b(1083);mg.QDh="GalleryGeneral";mg.SDh="GalleryNumber";mg.ODh="GalleryCurrency";mg.MDh="GalleryAccounting";mg.VDh="GalleryShortDate";mg.RDh="GalleryLongDate";mg.XDh="GalleryTime";mg.TDh="GalleryPercentage";mg.PDh="GalleryFraction";mg.UDh="GalleryScientific";
mg.WDh="GalleryText";mg.HRg="ButtonComma";mg.buttonPercentage="ButtonPercentage";mg.keyboardNumber="KeyboardNumber";mg.keyboardCurrency="KeyboardCurrency";mg.keyboardDate="KeyboardDate";mg.keyboardTime="KeyboardTime";mg.keyboardPercentage="KeyboardPercentage";Object(ie.a)(mg,"RibbonFormatKind",null,[]);var Ee=b(307),Ue=b(714),$c=b(713),Yd=b(712),rg=Ee.a;Wl($f,rg);$f.prototype.W2=function(k){return rg.prototype.W2.call(this,k)||this.kCh.W2(this.cbd,this.activeCell,this.format,this.Hqe,this.UFf,this.PFf,
this.a_b,this.$Ea,this.clientCorrelationId,this.Llb,this.cib)};$f.prototype.oj=function(){var k=[];if(this.Ecc)for(var F=Gl(this.Ecc),X=F.next();!X.done;X=F.next())k.push(Yd.a(X.value));else k.push(new $c.a(this.format,this.cbd,this.activeCell));return function(){return new Ue.a(k)}};$f.prototype.ceb=function(){var k={OperationType:0};k.FormatCellsMultiRange=this.cbd;k.ActiveCell=this.activeCell;k.Format=this.format;k.ApplyFormatOnPivotTableValueField=this.Hqe;k.PivotTableXluid=this.UFf;k.PivotTableFieldCaption=
this.PFf;return k};Ck.Object.defineProperties($f.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return ve.EwaSettings.qc()?Object(Rj.a)($f.prototype,this,"operationWorkingState"):0}},yt:{configurable:!0,enumerable:!0,get:function(){return this.Llb}},qaa:{configurable:!0,enumerable:!0,get:function(){return this.cib}},kCc:{configurable:!0,enumerable:!0,get:function(){return this.$Ea}}});Object(ie.a)($f,"FormatCellsBatchOperation",Ee.a,[]);var xg=b(213);Wf.editCell="Edited";
Wf.dependentCell="Dependents";Object(ie.a)(Wf,"RecalcPriorityGroupType",null,[]);var Zg=b(203),ih=b(9);Object(ie.a)(ce,"RecalcAccuracyObject",null,[]);Kd.string="String";Kd.blank="Blank";Kd.general="General";Kd.UAh="Flexible";Object(ie.a)(Kd,"FormattedUnitKind",null,[]);Object(ie.a)(Ac,"RecalcResultProcessingStatistics",null,[]);Object(ie.a)(Te,"RecalcedCellInfo",null,[]);var qi=b(110),qj=b(62),gh=b(564);ne.prototype.dispose=function(){this.calcManager=this.Yyc=this.Sg=this.grid=this.$=null};ne.prototype.AIf=
function(k){var F;if(k&&k.rangeDeltas){for(var X=this.Zca.length,ra=0;ra<k.rangeDeltas.length;ra++)(null===(F=k.rangeDeltas[ra])||void 0===F?0:F.data)&&void 0!==k.rangeDeltas[ra].data.value&&null!==k.rangeDeltas[ra].data.value&&void 0!==k.rangeDeltas[ra].range&&null!==k.rangeDeltas[ra].range&&this.Zca.push(new Te(k.rangeDeltas[ra],k.stateId,k.isFinished,k.priorityGroup));Wd.ULS.sendTraceTag(574993422,0,50,"CalcResultProcessor.ProcessResults stateId={0}, priorityGroup={1}, recalcFinished={2}, cellsFromCalc={3}, initialCellsToRender={4}, recalcedCells={5}, lastSetCellInstantaneousOperation={6}",
k.stateId,k.priorityGroup,k.isFinished,k.rangeDeltas.length,X,this.Zca.length,this.lastSetCellInstantaneousOperation);!X&&this.Zca.length&&this.sAf(!1,0)}};ne.prototype.N$c=function(k,F,X,ra,ab,Qb,Fc){if(!F)return Object(gh.a)("Null");var ld=excelOnlineCalc.numfmt.renderCallback(ra,function(jd){return gridRenderer.CanvasRendererGlobals.measureTextWidth(jd,ab,!0,ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1))},Fc),ud=k.renderValue(F,ld);if(!excelOnlineCalc.util.isSuccess(ud))return Object(gh.a)("Finalize");
ra=null;if(Fc=excelOnlineCalc.numfmt.isHashesValue(ud.value)){if(ud=k.renderHashesValue(ud.value,ld),!excelOnlineCalc.util.isSuccess(ud))return Object(gh.a)("Hashes")}else ra=ne.wCh(F,ud.value);ld=ud.value;k=excelOnlineCalc.numfmt.renderedValueToString(ld);F=of(ld);ld=Zd(ld);return Object(gh.d)({text:k,valueType:X,fontColor:ld,il:Qb,W8a:ra,horizontalAlignment:F,isHashesValue:Fc})};ne.prototype.sAf=function(k,F){var X=this;this.$&&this.grid&&this.calcManager&&this.Yyc&&this.calcManager.tF?(k&&(this.Tca=
this.Yyc.z$e),this.V_i(this.grid,this.calcManager.tF,k,F),!this.Tca&&this.Zca.length?Xf.Task.delay(0).CWRCT(function(ra){X.sAf(!0,ra.id);return!0},null,0,qj.a.current):Xf.Task.Sa(!0)):(Wd.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),Xf.Task.Sa(!1))};ne.prototype.V_i=function(k,F,X,ra){var ab=Sc.HelperMethods.Zb();for(X=new Ac(this.Zca.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,
void 0,this.Tca,void 0,void 0,void 0,X,void 0,ra,!0,0,0,0,0,0,0);0<this.Zca.length;){ra=Sc.HelperMethods.Zb()-ab;if(!this.Tca||ra>this.Tca){X.numberOfCellsSkippedDueToTimeout=this.Zca.length;break}ra=Array.dequeue(this.Zca);if(dg(ra,X)){var Qb=hb.Range.hd(ra.rangeDelta.range.row+1,ra.rangeDelta.range.column+1);(Qb=k.lc(Qb))?ne.BTg(ra.stateId,Qb.cell)?(ne.Wlc(k,Qb,ra,X),this.$Jg(F,Qb,ra,X)):X.numberOfCellsUpdatedAlreadyByServer++:X.numberOfCellsWithNoFormattedCell++}}ra=Math.round(Sc.HelperMethods.Zb()-
ab);this.RRj(ra);this.GEj(X,ra);this.tdj(X)};ne.prototype.$Jg=function(k,F,X,ra){var ab,Qb,Fc,ld,ud=kf(F,X),jd=X.rangeDelta.data.formatted,Ye=je(X),Bf=Ge(X);k=this.N$c(k,jd,Ye,F.cell.ZAa,F.cell.O$,ud,!1);ud=F.cell.f0d;if(Object(gh.c)(k))if(this.mAb&&this.erd){if(0===Bf||F.text!==k.value.text)this.Ani&&0===Bf&&this.vQd(ud,k.value)&&(F.cell.formattedText=ud),this.Sg.aZa(F,k.value),X=sd(X),this.Sg.B7c(F,this.lastSetCellInstantaneousOperation,2,X,!0,!0),ra.numberOfUpdatedCells++}else F.text!==k.value.text&&
(this.Sg.aZa(F,k.value),X=sd(X),this.Sg.B7c(F,this.lastSetCellInstantaneousOperation,2,X,!0,!0),ra.numberOfUpdatedCells++);else switch(k.reason){case "Null":ra.numberOfRecalcedCellsWithoutFormattedValue=(null!==(ab=ra.numberOfRecalcedCellsWithoutFormattedValue)&&void 0!==ab?ab:0)+1;break;case "Hashes":ra.numberOfHashFormattedValues=(null!==(Qb=ra.numberOfHashFormattedValues)&&void 0!==Qb?Qb:0)+1;break;case "Finalize":ra.newNumberFormatterFinalizeFailures=(null!==(Fc=ra.newNumberFormatterFinalizeFailures)&&
void 0!==Fc?Fc:0)+1}Object(gh.b)(k)&&"Null"!==k.reason&&(ra.numberOfRecalcedCellsWithFormattedValue=(null!==(ld=ra.numberOfRecalcedCellsWithFormattedValue)&&void 0!==ld?ld:0)+1);ra=0===Bf?F.cell.userInput:F.formulaBarText;ld=Object(gh.c)(k)?k.value.text:"";X=Object(gh.b)(k)?k.reason:"";Wd.ULS.sendTraceTag(537162180,0,50,"CalcResultProcessor.ApplyRecalcResultOnCell: ({0}, {1}) 2nd pass formatting, success: {2}, reason: {3}, priority: {4}, ifmt: {5}, input: '{6}', prediction: '{7}',",F.range.top,F.range.left,
k.success,X,Bf,F.cell.il,ra?Z.a.aM(ra):"null",ld?Z.a.aM(ld):"null")};ne.prototype.RRj=function(k){this.Tca=Math.max(this.Tca-Math.max(k,1),0)};ne.prototype.GEj=function(k,F){k.numberOfNonUpdatedCells=this.Zca.length;k.totalExecutionTime=F;k.newProcessingTimeLimit=this.Tca;k.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation};ne.prototype.tdj=function(k){k=Sys.Serialization.JavaScriptSerializer.serialize(k);Wd.ULS.sendTraceTag(574993417,0,50,"CalcResultProcessor.ReportRecalcProcessingStatistics:{0}",
k)};ne.wCh=function(k,F){k=k.units;var X=F.units;if(k.length!==X.length)return Wd.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;F=[];for(var ra=-1,ab=0;ab<k.length;ab++)switch(k[ab].kind){case Kd.blank:F.push.apply(F,qi.h(" ",X[ab].str.length));break;case Kd.string:F.push(k[ab].str);break;case Kd.UAh:F.push("");ra=ab;break;case Kd.general:F.push(X[ab].str);
break;default:Wd.ULS.sendTraceTag(537162178,0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=ra||""===X[ra].str)return null;X={};X.Start=F.slice(0,ra).join("");X.Separator=k[ra].str;X.End=F.slice(ra+1,F.length).join("");return X};ne.$Ih=function(k){return k&&k&&k.cu?k.cu.sJ:ih.a.Re};ne.BTg=function(k,F){if(!F)return!1;F=ne.$Ih(F);return F===ih.a.Re||F===k};ne.Wlc=function(k,F,X,ra){var ab=X.rangeDelta.data.value.toString(),Qb=je(X),Fc=kf(F,X);ab=new ce(Qb,ab,Fc,
X.priorityGroup);F.cell.Wlc(ab,k.Ea.N5);1===Ge(X)?ra.numberOfDependentRecalcedCellsInBatch++:ra.numberOfEditedRecalcedCellsInBatch++};ne.prototype.vQd=function(k,F){return null==k?!1:!!k.TextRuns&&!!k.Fonts&&k.Text===F.text&&2===F.valueType};ne.cGe=20;Object(ie.a)(ne,"CalcResultProcessor",null,[806,3]);Object(ie.a)(Af,"GetRibbonNumberFormatResult",null,[]);he.prototype.aKb=function(k,F,X){var ra=F.Border;F=F.BorderFormat;var ab=0,Qb=!1;if(0===ra)k.cell.Pab(),this.vHb(k.cell.getRange());else{for(var Fc=
0;3>=Fc;Fc++)he.huj(k,X,Fc,ra)&&(ab|=Sc.HelperMethods.j3a(Fc),this.yXd(k.cell.getRange(),Fc,F),Qb=!0);Sc.HelperMethods.iR(ra,16)&&!Di.c(k,0,X)&&(ab|=2,this.yXd(k.cell.getRange(),0,F),Qb=!0);Sc.HelperMethods.iR(ra,32)&&!Di.c(k,2,X)&&(ab|=4,this.yXd(k.cell.getRange(),2,F),Qb=!0);Qb&&(X=k.cell.cu.uf,Sc.HelperMethods.iR(ab,2)&&this.r1f(k,X,0)&&(ab&=-3),Sc.HelperMethods.iR(ab,1)&&this.q1f(k,X,1)&&(ab&=-2),Sc.HelperMethods.iR(ab,4)&&this.r1f(k,X,2)&&(ab&=-5),Sc.HelperMethods.iR(ab,8)&&this.q1f(k,X,3)&&
(ab&=-9),k.cell.setBorders(F,ab,!1))}};he.prototype.LQ=function(k,F){k=he.MVe(k,F);return k.isValidRange?(k=this.Ea.Vua(k))&&k.length?k:null:null};he.prototype.vHb=function(k){for(var F=0;3>=F;F++){var X=he.MVe(k,F);if(X.isValidRange&&(X=this.Ea.Vua(X))&&X.length)for(var ra=he.T_e(F),ab=0;ab<X.length;ab++)X[ab].YPa(ra)}};he.prototype.yXd=function(k,F,X){if(k=this.LQ(k,F))for(var ra=he.T_e(F),ab=Sc.HelperMethods.j3a(ra),Qb=0;Qb<k.length;Qb++){var Fc=k[Qb];this.Mdi(Fc,ra)&&he.setBorders(Fc,X,ab,F,ra)}};
he.prototype.Mdi=function(k,F){var X=k.cu.uf,ra=k.getRange();ra=this.LQ(ra,F);var ab=!1,Qb=!1,Fc=!1,ld=!1;ra&&(ab=he.k6a(ra,!0),Qb=he.k6a(ra,!1),ld=he.God(ra),Fc=1===ra.length?!0:!1);switch(F){case 0:return he.ddi(k,X,ld,Qb,Fc);case 1:return he.adi(k,X,ld,ab,Fc);case 2:return he.bdi(k,X,ld,ab,Fc);case 3:return he.cdi(k,X,ld,Qb,Fc)}return!1};he.prototype.r1f=function(k,F,X){if(!k.cell.UM)return!1;var ra=k.range,ab=this.LQ(ra,X),Qb=Di.c(k,X,F),Fc=!1;F=0===X?ra.top<F.top:ra.left<F.left;!he.qzb(k.cell)&&
ab&&1!==ab.length&&(Fc=(0===X?he.k6a(ab,!0):he.k6a(ab,!1))?!1:!0);return!Qb&&Fc||F?!0:!1};he.prototype.q1f=function(k,F,X){var ra=k.cell,ab=this.LQ(ra.getRange(),X);k=Di.c(k,X,F);F=!1;if(ab){var Qb=he.k6a(ab,!0),Fc=he.k6a(ab,!1),ld=Qb&&!Fc;Fc=Fc&&!Qb;1!==X||he.oAb(ra)?3!==X||he.fzb(ra)||he.ouj(ra,ab,Fc,ld)&&(F=!0):he.nuj(ra,ab,Qb,Fc)&&(F=!0)}return!k&&F||he.qzb(ra)?!0:!1};he.fPg=function(k,F,X){var ra={};ra.LineStyle=Array(4);ra.LineStyle[X]=k.LineStyle[F];ra.Color=Array(4);ra.Color[X]=k.Color[F];
return ra};he.Naf=function(k,F,X,ra,ab){return Sc.HelperMethods.iR(k,ab)&&Di.c(F,X,ra)};he.huj=function(k,F,X,ra){return he.Naf(ra,k,X,F,Sc.HelperMethods.j3a(X))||he.Naf(ra,k,X,F,64)||112===ra};he.setBorders=function(k,F,X,ra,ab){F=he.fPg(F,ra,ab);k.setBorders(F,X,!1)};he.MVe=function(k,F){switch(F){case 0:return new hb.Range(k.top-1,k.left,k.top-1,k.right,!1,!1);case 2:return new hb.Range(k.top,k.left-1,k.bottom,k.left-1,!1,!1);case 1:return new hb.Range(k.bottom+1,k.left,k.bottom+1,k.right,!1,!1);
case 3:return new hb.Range(k.top,k.right+1,k.bottom,k.right+1,!1,!1)}return k};he.T_e=function(k){switch(k){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}};he.k6a=function(k,F){for(var X=0;X<k.length;X++){var ra=k[X];if(ra.UM)return F?he.fzb(ra):he.oAb(ra)}return!1};he.qzb=function(k){var F=k.cu.uf,X=k.getRange();return k.UM&&(X.top<F.top||X.bottom>F.bottom||X.left<F.left||X.right>F.right)?!0:!1};he.God=function(k){for(var F=0;F<k.length;F++)if(he.qzb(k[F]))return!0;return!1};he.nuj=
function(k,F,X,ra){if(!k.UM){if(!X||he.God(F))return!0}else if(he.fzb(k)&&(1===F.length&&he.tKg(k,F[0])||!X))return!0;return ra};he.ouj=function(k,F,X,ra){if(!k.UM){if(!X||he.God(F))return!0}else if(he.oAb(k)&&(1===F.length&&he.uKg(k,F[0])||!X))return!0;return k.Oka||ra};he.ddi=function(k,F,X,ra,ab){var Qb=k.getRange();return he.fzb(k)?he.qzb(k)||ab:F.top===Qb.top||!ra||X};he.adi=function(k,F,X,ra,ab){var Qb=k.getRange();return he.fzb(k)?F.bottom===Qb.bottom&&ab:ra&&!X||F.bottom===Qb.bottom};he.bdi=
function(k,F,X,ra,ab){var Qb=k.getRange();return he.oAb(k)?he.qzb(k)||ab:F.left===Qb.left||!ra||X};he.cdi=function(k,F,X,ra,ab){var Qb=k.getRange();return k.Oka?!1:he.oAb(k)?F.right===Qb.right&&ab:ra&&!X||F.right===Qb.right};he.fzb=function(k){return 0<k.getRange().right-k.getRange().left};he.oAb=function(k){return 0<k.getRange().bottom-k.getRange().top};he.uKg=function(k,F){k=k.getRange();F=F.getRange();return k.top===F.top&&k.bottom===F.bottom};he.tKg=function(k,F){k=k.getRange();F=F.getRange();
return k.left===F.left&&k.right===F.right};Object(ie.a)(he,"BorderModelAccessorHelper",null,[]);Id.prototype.qcb=function(k,F,X,ra,ab,Qb){k&&(k.t7(F,X,void 0===ab?!1:ab,void 0===Qb?!1:Qb),k.verticalAlignment=ra)};Id.prototype.aKb=function(k,F,X){this.Bx||(this.Bx=new he(this.Ea,this.r2a));this.Bx.aKb(k,F,X)};Object(ie.a)(Id,"FormatCellsActionModelAccessor",null,[805]);var Vi=b(260);Object(ie.a)($d,"FormatCellInstantaneousResult",null,[]);Object(ie.a)(Ke,"FormatStringResult",null,[]);var Vj=b(1257),
Ch=b(565),sj=b(205),Cj;(function(k){k.InvalidInput="invalid input";k.UnsupportedZeroResize="resizing to 0 - ignore";k.UnsupportedSkeletonInView="skeleton in view - ignore";k.NullSPD="ActiveSheetProcessedData is null";k.UnsupportedHiddenInRange="hiddens in resizeRanges";k.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(Cj||(Cj={}));Object(ie.b)("InstantaneousRowColumnResizeFailureReason",Cj);var Fj=b(326);Fe.prototype.dispose=function(){zg.a.Dc([this.cSa,this.Y2]);this.$=
this.Y2=this.cSa=null};Fe.prototype.FAa=function(k,F,X,ra,ab,Qb,Fc,ld,ud){return this.vyj(k,F,X,void 0===ab?!1:ab,void 0===ld?0:ld,void 0===Qb?"":Qb,void 0===ud?null:ud)};Fe.prototype.B7c=function(k,F,X,ra,ab,Qb){k.cell.cu.gQ|=ra;Fe.V_g(ff.g(this.$),k,X,ab);this.Y2.lastSetCellInstantaneousOperation=F;Qb&&ff.g(this.$).Ii.N0(F,Wc.BasicTelemetryCalculator.aR)};Fe.prototype.Sda=function(k,F,X,ra,ab,Qb){ra=void 0===ra?!1:ra;ab=void 0===ab?null:ab;var Fc=void 0===Fc?null:Fc;Qb=(void 0===Qb?null:Qb)||k.ha.ta.selectedRanges;
if(!(-1690267012===F&&1<Qb.length)){-1690267012===F&&Wd.ULS.shipAssertTag(537162176,0,1===Qb.length,"FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = {0}",Qb.length);var ld=k.N$("FormatCellsAction.ShowInstantaneousFormatting",Qb);try{ld.$$rst();for(var ud=!1;ld.$$mn();){var jd=void 0,Ye=ld.$$cu().hF?k.xJb(ld.$$cu().range):(jd=new Ka.a,jd.add(ld.$$cu()),jd);jd={};for(var Bf=Gl(Ye),Tg=Bf.next();!Tg.done;jd={Hfb:jd.Hfb},Tg=Bf.next()){var $g=Tg.value;if(ff.g(this.$).wz&&$g&&Fc&&-1690267012===
F&&(jd.Hfb=$g.range,jd.Hfb&&Fc.contains(jd.Hfb)&&Bg.a.all(Qb,function(Wg){return function(qh){return!vd.c(qh,Wg.Hfb)}}(jd))))continue;if(!$g||ld.ub.contains($g.range))if(this.I2f(F,$g,X,ra,ab,ld.$$cu().hF),ud||(k.Ea.MV(),ud=!0),ab)break}}}finally{ld&&ld.dispose()}}};Fe.prototype.aZa=function(k,F,X){if(X=void 0===X?null:X)X.lwa=!0;X=!F.text;var ra=Z.a.uef(F.text),ab,Qb=k.hF?ff.g(this.$).xJb(k.range):(ab=new Ka.a,ab.add(k),ab);ab=Gl(Qb);for(Qb=ab.next();!Qb.done;Qb=ab.next())this.YJg(this.$,Qb.value,
F.text,F.horizontalAlignment,F.fontColor,F.il,k.cell.il,X,ra,F.valueType,F.W8a);k.cell.ZBc()};Fe.prototype.PVi=function(k,F,X,ra,ab){ab=void 0===ab?null:ab;try{var Qb=vd.D(F),Fc=vd.D(X);if(k.Nb.l6a(Qb)||k.Nb.l6a(Fc))return 8;if(-185374993!==ra&&this.yli(k,Qb,Fc))return 9;if(-185374993!==ra&&(k.Nb.s5(Fc)||k.Nb.Hzb(Qb)))return 10;if(1804571062!==ra&&k.Nb.Ika(Fc))return 11;if(this.Jgh(Fc))return 12;if(this.pmi(Qb,Fc))return 13;var ld=this.$.Pb.Gc("UserAction","PasteInstantaneous");ld.start();Ch.a(ld);
ab&&bh.b().EA(ld.id,ab.id,"actions","actions");!Qb.isSingle&&Fc.isSingle&&(Fc=Fe.expandRange(Qb,Fc),k.ha.updateSelection(Fc,Fc,0));switch(ra){case 237279923:case 808159687:if(!this.fWi(Qb,Fc))return 14;this.u2c(k,Qb,Fc,!0,!1);break;case 1804571062:this.u2c(k,Qb,Fc,!0,!1);break;case -185374993:this.u2c(k,Qb,Fc,!1,!0);break;default:return 2}Wd.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(ud){return Wd.ULS.sendTraceTag(537162145,0,10,"FormatCellsAction.PasteInstantaneous: failed with the following error: {0}",
JSON.stringify(ud)),15}};Fe.prototype.OXg=function(k,F){k=Gl(k);for(var X=k.next();!X.done;X=k.next())this.h0c(X.value,!0,F)};Fe.prototype.h0c=function(k,F,X){X=void 0===X?"":X;if(k){var ra=ff.g(this.$);if(F){if(F=ra.xk("FormatCellsAction.ClearRangeInstantaneous",k),k=k.isSingle?null:k,F.$$mn()&&void 0!==F.$$cu()&&null!==F.$$cu())for(ra=Object(na.a)(new pa.a,{Text:""}),this.FAa(F.$$cu(),ra,!1,void 0,O.a.vgc(this.$),X,void 0,void 0,k);F.$$mn();)void 0!==F.$$cu()&&null!==F.$$cu()&&this.FAa(F.$$cu(),
ra,!1,void 0,!1,X)}else this.Sda(ra,-1228228458,{},void 0,void 0,[k])}else Wd.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")};Fe.prototype.t5i=function(k,F){if(!F){F=Sc.HelperMethods.Zb();var X=ff.g(this.$),ra=X.N$("FormatCellsAction.ReformatCells",k);try{ra.$$rst();for(var ab=!1;ra.$$mn();){var Qb=ra.$$cu().cell;if(0===Qb.hM||2===Qb.hM)this.updateSpillInformation(Qb,k),ab||(X.Ea.MV(),ab=!0)}}finally{ra&&ra.dispose()}Wd.ULS.sendTraceTag(537162143,
0,50,"FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: {0}.",Sc.HelperMethods.Zb()-F)}};Fe.prototype.edc=function(k,F){if(this.Gb){if(k.formulaBarText)return!Z.a.equals(F.Text,k.formulaBarText,!1);var X=k.cell.formattedText;X=Vi.a(X,k.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(X,F).isEqual}return!Z.a.equals(F.Text,k.text,!1)};Fe.prototype.rCh=function(k){if(void 0===k||null===k)return new Ke(!1,"1234.56");k=this.K2a({value:"1234.56",
type:1},k,244,"12px sans-serif");return Object(gh.b)(k)?new Ke(!1,"1234.56"):new Ke(!0,k.value.text)};Fe.prototype.wyj=function(k,F,X,ra){return oc(k,this,F,X,ra,!0)};Fe.prototype.H2f=function(k,F,X){if(!this.edc(F,X))return Object(gh.d)("Skip unchanged cell content");F=F.cell;X=this.gUe(X.Text,F.il,F.ZAa,F.O$,!0);if(Object(gh.b)(X))k=X;else{X=X.value;var ra=X.text;var ab=X.valueType;ra=F.hasRichValueIcon?"Unsupported rich value icon":F.Hea?ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EstimateWrapTextEditResize",
!1)&&2==ab&&'normal 11pt "calibri"'===F.O$&&F.VAe(ra)>=F.offsetWidth*Math.floor(F.offsetHeight/ih.a.Srb)?"Unsupported wrapped text with long input":"Unsupported wrapped text":F.lhf||null!=F.qoa&&0!==F.qoa?"Unsupported rotated text":!0;!0!==ra?k=Object(gh.a)(ra):(F.isCellWidthFixed?ra="Skip fixed width cell":(ra=X.valueType,ra=0===ra?"Skip empty cell value":2===ra?"Skip string cell value":F.UM&&!F.sli?"Skip merged cell":F.Qxc?"Skip shrunk to fit":X.isHashesValue?"Skip hashes cell value":!0),!0!==ra?
k=Object(gh.d)(ra):(X=F.VAe(X.text),X>F.offsetWidth?(F=[F.getRange().clone()],k=oc(k,this,F,X,!1,!1),k=Object(gh.b)(k)?k:Object(gh.d)(X)):k=Object(gh.d)("Column is wide enough")))}return k};Fe.prototype.eUe=function(k,F,X,ra,ab){var Qb={};Qb.value=k;Qb.type=X;F=this.K2a(Qb,F,ra,ab);return Object(gh.b)(F)?new Ke(!1,k):new Ke(!0,F.value.text)};Fe.prototype.updateSpillInformation=function(k,F){var X=k.getRange(),ra=!1;F=Gl(F);for(var ab=F.next();!ab.done;ab=F.next())if(X.left===ab.value.left){ra=!0;
break}k.MOj(ra)};Fe.prototype.vyj=function(k,F,X,ra,ab,Qb,Fc){var ld=void 0;Qb=void 0===Qb?"":Qb;ld=void 0===ld?1:ld;Fc=void 0===Fc?null:Fc;this.mAb&&this.Bni&&(k.cell.f0d=F);var ud=new $d;ud.source=0;ud.lwa=!1;k.cell.Woc=k.cell.il;var jd=F.Text,Ye=!jd,Bf=Z.a.uef(jd);Z.a.Tn(jd)&&(Wd.ULS.shipAssertTag(537162142,0,!((void 0===jd||null===jd)&&void 0!==F.TextRuns&&null!==F.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),F=Object(na.a)(new pa.a,
{Text:""}),jd="");k.cell.userInput=jd;if(!this.edc(k,F))return this.hVg(k,ab,Ye,Bf,ud);X?this.aVg(k,jd,this.$.workbookContext.DefaultHyperlinkStyle,ud):this.VUg(k,F,jd,Ye,Bf,ra,ud,Fc);this.B7c(k,Qb,ab,ld,ud.phc,ud.lwa);return ud};Fe.prototype.hVg=function(k,F,X,ra,ab){ab.oeg=!0;ab.phc=!0;ab.lwa=!1;0===F&&ff.g(this.$).Ea.MV();0===k.cell.Kya&&(X?k.cell.t7(0,!1):ra&&k.cell.t7(1,!1));return ab};Fe.prototype.aVg=function(k,F,X,ra){ra.lwa=!0;k.insertHyperlink(F,xg.a.sad(F),X)};Fe.prototype.VUg=function(k,
F,X,ra,ab,Qb,Fc,ld){ld=void 0===ld?null:ld;Fc.lwa=!1;var ud=k.cell;this.vz||(this.vz=this.$.da.za(268));this.EKj(this.vz,ud.il);ra||ab?this.XUg(k,ra,ab,Fc):(ra=this.gUe(X,ud.il,ud.ZAa,ud.O$,!1),Object(gh.c)(ra)?(this.vQd(F.TextRuns,F.Fonts)&&this.ZUg(k,F,ra.value),this.aZa(k,ra.value,Fc)):this.mAb&&this.erd?this.eVg(k,F.Text,Fc):this.fVg(k,F.Text),F=Object(gh.c)(ra)?ra.value.text:"",ab=Object(gh.b)(ra)?ra.reason:"",Wd.ULS.sendTraceTag(559724065,0,50,"FormatCellsAction.CellDataEntryCSE: ({0}, {1}) 1st pass formatting, success: {2}, reason: {3}, ifmt: {4}, input: '{5}', prediction: '{6}',",
k.range.top,k.range.left,ra.success,ab,ud.il,Z.a.VYa(ud.userInput),Z.a.VYa(F)));ud.formulaBarText=X;Qb&&this.eKj(this.vz,k,X,ld);Fc.phc=!0};Fe.prototype.XUg=function(k,F,X,ra){ra.lwa=!0;k.text="";k.formulaBarText="";k.cell.userInput="";this.I1b(k,null,null,F,X)};Fe.prototype.ZUg=function(k,F,X){F.Text===X.text&&2===X.valueType&&(k.cell.formattedText=F)};Fe.prototype.eVg=function(k,F,X){X&&(X.lwa=!0);k.text=F;k.formulaBarText=F;this.I1b(k,1)};Fe.prototype.fVg=function(k,F){k.text=F;k.formulaBarText=
F;this.I1b(k,1)};Fe.prototype.I1b=function(k,F,X,ra,ab,Qb){X=void 0===X?null:X;ra=void 0===ra?!1:ra;ab=void 0===ab?!1:ab;Qb=void 0===Qb?!1:Qb;var Fc=k.horizontalAlignment;X=null!=X?X:k.verticalAlignment;0===k.cell.Kya&&(null!=F||ra||ab||Qb)&&(ra?Fc=0:ab||Qb?Fc=1:null!=F&&(Fc=F),this.Mua.qcb(k,Fc,!1,X,!0))};Fe.prototype.EKj=function(k,F){(null===k||void 0===k?0:k.dya)&&F>=Fe.BAh&&F>k.dya.length-1&&(Wd.ULS.sendTraceTag(537162141,0,50,"FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:{0}. Triggering refresh...",
F),k.XTe())};Fe.prototype.eKj=function(k,F,X,ra){ra=void 0===ra?null:ra;if(void 0!==k&&null!==k)if(this.vz.Jld)Wd.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{var ab=this.$.da.za(266);ab&&(this.Y2.Tca=ne.cGe,k&&(this.Y2.Tca=k.z$e),ab.QSg(F,X,Object(Df.a)(this.Y2,this.Y2.AIf,"processResults"),ra))}};Fe.prototype.K2a=function(k,F,X,ra){var ab=this.$.da.za(266);if(!ab)return Object(gh.a)("calcManager is null");if(!ab.tF)return Object(gh.a)("calcManager.NumberFormatter is null");
if(!this.vz)return Object(gh.a)("instantaneousManager is null");if("number"===typeof F||"string"===typeof F){var Qb=ab.vbc(F);if(!Object(gh.c)(Qb))return Qb;var Fc=Qb.value}else Fc=F;Qb=ab.tF;var ld=Ze(k);if(void 0===ld||null===ld)return Object(gh.a)("cellValue is null");ab=excelOnlineCalc.calc.cellValueToReadOper(ab.config.mathpack,ld);if(void 0===ab||null===ab)return Object(gh.a)("readOper is null");ab=Qb.applyFormat(Fc,ab,ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));
return excelOnlineCalc.util.isSuccess(ab)?this.Y2.N$c(Qb,ab.value,k.type,X,ra,"number"===typeof F?F:-1,!1):Object(gh.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(ab.reason.kind))};Fe.prototype.gUe=function(k,F,X,ra,ab){var Qb=this.$.da.za(266);if(void 0===Qb||null===Qb)return Object(gh.a)("calcManager is null");if(void 0===Qb.tF||null===Qb.tF)return Object(gh.a)("calcManager.NumberFormatter is null");if(void 0===this.vz||null===this.vz)return Object(gh.a)("instantaneousManager is null");if(this.mAb&&
!ab)return Object(gh.a)("No main thread number formatter");var Fc=Qb.vbc(F);if(!Object(gh.c)(Fc))return Fc;var ld=Fc.value;Fc=Qb.tF;k=Fc.parseEdit(k,ld);if(!excelOnlineCalc.util.isSuccess(k))return Object(gh.a)("ParseEdit failure: reason="+k.reason.kind+", features="+k.reason.features);if(k.value.kind===Zc.a.formula)return Object(gh.a)("Main thread - skipping formula edit");Qb=excelOnlineCalc.numfmt.applyValueEdit(Fc,Qb.localeInfo,ld,k.value);if(!excelOnlineCalc.util.isSuccess(Qb))return Object(gh.a)("NumberFormatter.FormatValueEdit: "+
JSON.stringify(Qb.reason.kind));k=k.value;Wd.ULS.shipAssertTag(537162190,0,k.kind!==Zc.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");k=excelOnlineCalc.numfmt.getValueEditOperKind(k);ld=0;switch(k){case 0:case 128:ld=0;break;case 1:ld=1;break;case 2:ld=2;break;case 4:ld=3;break;case 8:ld=4;break;case 16:case 32:case 64:case 256:Wd.ULS.sendTraceTag(537162189,0,15,"CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind {0} to a CellValueType",
k);break;default:Wd.ULS.shipAssertTag(537162188,0,!1,"CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind {0}",k)}return this.Y2.N$c(Fc,Qb.value,ld,X,ra,"number"===typeof F?F:-1,ab)};Fe.prototype.yli=function(k,F,X){if(F.width<X.width)for(var ra=k.xk("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new hb.Range(F.top,F.left,F.bottom,F.left,!0,!0));ra.$$mn();){var ab=ra.$$cu();if(ab&&ab.NKa())return Wd.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),
!0}if(F.height<X.height)for(k=k.xk("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new hb.Range(F.top,F.left,F.top,F.right,!0,!0));k.$$mn();)if((F=k.$$cu())&&F.QKa())return Wd.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1};Fe.prototype.u2c=function(k,F,X,ra,ab){for(var Qb=F.DS().FirstRow,Fc=F.DS().LastRow,ld=X.DS().LastRow,ud=Qb,jd=X.DS().FirstRow;jd<=ld;jd++,ud++){ud>Fc&&(ud=Qb);var Ye=F.DS();Ye.FirstRow=Ye.LastRow=
ud;var Bf=X.DS();Bf.FirstRow=Bf.LastRow=jd;this.Q2g(k,Mb.a.JQ(Ye),Mb.a.JQ(Bf),ra,ab)}};Fe.prototype.fWi=function(k,F){var X=this.$.da.za(266);return void 0!==X&&null!==X?(X.KSg(k,F.topLeft,Object(Df.a)(this.Y2,this.Y2.AIf,"processResults")),!0):!1};Fe.prototype.pmi=function(k,F){var X=k.right-k.left+1;k=k.bottom-k.top+1;var ra=F.right-F.left+1;F=F.bottom-F.top+1;if(ra>X&&F>k){if(!(ra%X&&F%k))return!0}else if(ra===X&&F>k){if(!(F%k))return!0}else if(ra>X&&F===k&&!(ra%X))return!0;return!1};Fe.prototype.Jgh=
function(k){if(ve.EwaSettings.ma(103)){k=ff.g(this.$).k1(k).gridView.getRangeInformation(k);k=Gl(k);for(var F=k.next();!F.done;F=k.next())if(F=F.value,Object(Xi.a)(tc.DynamicArrayRange,F)&&!Object(ca.a)(tc.DynamicArrayRange,F).Nlc)return!0}return!1};Fe.prototype.OBe=function(k,F,X,ra,ab,Qb){F=Gl(F);for(var Fc=F.next();!Fc.done;Fc=F.next())Fc=Fc.value,X&&(this.U2g(Fc,ab),Fc.setCell(!0)),ra&&(Qb=this.$1h(ab,Fc)),Qb||(k.Ea.MV(),Qb=!0);return Qb};Fe.prototype.ZNh=function(k,F,X){F=new hb.Range(F,X,F,
X,!0,!0);return k.lc(F)};Fe.prototype.Q2g=function(k,F,X,ra,ab){if(X){this.cSa&&X.equals(this.cSa.range)||(zg.a.Ha(this.cSa),this.cSa=k.xk("FormatCellsAction.CopyBetweenRows",X));X=this.cSa;X.$$rst();var Qb=!1;if(ve.EwaSettings.getBooleanFeatureGate(Fj.a.JEe,!1)){var Fc=F.DS().FirstColumn+1,ld=F.DS().LastColumn+1;F=F.DS().FirstRow+1;for(var ud=Fc;X.$$mn();){ud>ld&&(ud=Fc);var jd=this.ZNh(k,F,ud);ud+=1;var Ye=void 0,Bf=X.$$cu().hF?k.xJb(X.$$cu().range):(Ye=new Ka.a,Ye.add(X.$$cu()),Ye);jd&&(Qb=this.OBe(k,
Bf,ra,ab,jd,Qb));Ba.lastOrDefault(Bf)}}else for(Fc=k.xk("FormatCellsAction.CopyBetweenRows2",F);X.$$mn();)Fc.$$mn()||(Fc.$$rst(),Fc.$$mn()),ld=Fc.$$cu(),F=void 0,ud=X.$$cu().hF?k.xJb(X.$$cu().range):(F=new Ka.a,F.add(X.$$cu()),F),ld&&(Qb=this.OBe(k,ud,ra,ab,ld,Qb)),Ba.lastOrDefault(ud)}else Wd.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")};Fe.prototype.a3f=function(){var k=Vf.a.gd(1,0,0,650,0,104573951,"PivotTableContextMenuOperationFailure");Uh.a(this.$).si(k)};
Fe.prototype.Wwi=function(k,F){var X={ValidMembers:32},ra=F.NumberFormat;switch(k){case 1890566896:if(1001===ra||1002===ra||1003===ra){X.NumberFormat=14;X.NumberFormatOptions={};switch(ra){case 1001:X.NumberFormatOptions.TimeType=2;break;case 1002:X.NumberFormatOptions.DateType=7;break;case 1003:X.NumberFormatOptions.DecimalPlaces=0}X.NumberFormatOptions.NumberFormatCategory=this.NJg(ra)}else X.NumberFormat=ra;break;case 1886928607:X.NumberFormat=13;break;case -992833457:X.NumberFormat=11;break;case 218524921:X.NumberFormat=
12;break;case 996232352:X.NumberFormat=14;X.NumberFormatOptions=Object(na.a)(new Ca.a,{DecimalPlaces:0});X.NumberFormatOptions.NumberFormatCategory=6;break;default:return F}return X};Fe.prototype.formatCells=function(k,F,X,ra,ab,Qb,Fc){ra=void 0===ra?null:ra;ab=void 0===ab?null:ab;Qb=void 0===Qb?null:Qb;Fc=void 0===Fc?null:Fc;var ld=this.$.Pb.Gc("UserAction","FormatCellsInstantaneous, command = "+bh.b().ri(k)),ud=this.$.Pb.Zg("UserAction","FormatCellsInstantaneousFrame");ud.start();Ch.a(ud);var jd=
bh.b().ri(k),Ye=this.$,Bf=ff.g(Ye),Tg=Bf.ha.ta,$g=ab||Tg.selectedRanges,Wg=qi.g($g,function(ph){return ph.eM});jd=String.format("{0}, cellCount={1}",jd,Wg);ff.g(this.$).Ii.I7(1,ld.id,jd);$g=vd.r($g,this.$);Tg=Tg.activeCell;jd=-168056295===X.command;var qh=Wg=null;if(jd){qh=Bf.Nb.gp(Tg);if(!qh){this.a3f();return}Wg=qh.Jca.substring(1,qh.Jca.length-1);qh=qh.Aac();if(!qh){this.a3f();return}qh=qh.Caption}Bf.ug.SG(!1,!0);var Ri=vd.o(Tg,Ye),ci=Ye.na.va.hc({ola:!0,kka:1}),Tf=this.Wwi(X.command,F);jd||this.Sda(Bf,
k,F,!1,ra,ab);ld.stop();ff.g(this.$).Ii.N0(ld.id,Wc.BasicTelemetryCalculator.aR);X.Zai=Vh.a.Ua.Vb;ra=this.$.Pb.Gc("UserAction","FormatCellsUserAction");this.lti(k,X.taskId,F,$g,Tg,ra.id);bh.b().EA(ld.id,ra.id,"actions","actions");bh.b().EA(ud.id,ra.id,"actions","actions");ve.EwaSettings.qc()?Ye.userOperationManager.jc(new $f(this,$g,Ri,Tf,jd,Wg,qh,ci,ra,ld.id,64,Qb,Fc),X):Ye.userOperationManager.jc(new $f(this,$g,Ri,Tf,jd,Wg,qh,ci,ra,ld.id,0,Qb,Fc),X)};Fe.prototype.W2=function(k,F,X,ra,ab,Qb,Fc,ld,
ud,jd,Ye){var Bf=this,Tg=this.$;return function($g,Wg,qh){Tg.By();$g=[$g,Bf.YIi];Wg=[Wg];jd&&$g.push(jd);Ye&&Wg.push(Ye);return Yg.q(Tg.na.va,k,F,X,ra,ab,Qb,!1,hh.b.apply(null,$g),hh.a.apply(null,Wg),qh,ud,Fc,ld)}};Fe.prototype.I2f=function(k,F,X,ra,ab,Qb,Fc){Fc=void 0===Fc?null:Fc;if(F&&X){var ld=X.Font,ud=X.HorizontalAlignment,jd=X.VerticalAlignment;X.ValidMembers&2||(ud=F.horizontalAlignment);X.ValidMembers&1||(jd=F.verticalAlignment);var Ye=0!==ud;Fe.idi(k)&&0===ud&&(ud=this.iZe(F));var Bf=!1;
switch(k){case -394785302:this.Mua.qcb(F,ud,Ye,0);break;case 1041132226:this.Mua.qcb(F,ud,Ye,1);break;case -571165336:this.Mua.qcb(F,ud,Ye,2);break;case -1150205178:case -1142465846:case -286432209:this.Mua.qcb(F,ud,Ye,jd,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.$6a&&this.gnj(F,X);break;case 1650812936:this.setFillColor(F,X,Qb);break;case -287251124:F.bold=ld.Bold;break;case -1690267012:ff.g(this.$).ha.ta.Hg&&(ld=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",
!1)?Fc?Fc:ff.g(this.$).ha.ta.qd:ff.g(this.$).ha.ta.qd,this.Mua.aKb(F,X,ld));break;case 1970784898:X=Zg.a.cp(F.color,F.backgroundColor);if(vi.a.compare(X,vi.a.red)&&(Z.a.q5(F.text)||Z.a.T5e(F.text)))break;ld=vi.a.fH(ld.FontColor);F.color=sj.e(Zg.a.eG(ld));break;case -1925065947:F.italic=ld.Italic;break;case -1293291468:X=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");this.Om?(F.rKb(ld.FontName,X,"ShowInstantaneousFormattingOnCell"),F.EYf(ld.FontScheme)):F.rKb(ld.FontName,
X,"ShowInstantaneousFormattingOnCell");break;case 862890474:case 963349338:F.fontSize=ld.FontSize;this.$.Bf();break;case -1077965542:F.fontSize=ld.FontSize;break;case 1764140053:F.underline=ld.Underline;break;case -1685033574:F.doubleUnderline=ld.DoubleUnderline;break;case -1590502662:F.fontStrikethrough=ld.Strikethrough;break;case -848953656:case 2045211913:Bf=F.Spb();break;case 2105621672:ld=Object(ca.a)(Vj.a,ab);if(!ld)break;X=vi.a.rDh(ld.color);F.color=sj.e(Zg.a.eG(X));this.Oqe(F,ld.emc);break;
case -1409276245:this.Oqe(F,X.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.XJg(F,X);break;case -1228228458:F.Spb();F.clearFormat();this.sWc(F,0);Bf=!0;break;case -730106152:F.clearFormat();this.sWc(F,0);break;case 932244020:this.fnj(F,X,Qb);break;case -1942512156:case -1920201820:this.Yoj(F,X)}ra||(Bf?F.wHb(!0):F.setCell(!0))}else Wd.ULS.shipAssertTag(537162135,0,!F,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),Wd.ULS.shipAssertTag(537162134,0,!X,
"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")};Fe.prototype.U2g=function(k,F){k&&F?(k.aqb(F),k.y0c(F),this.sWc(k,F.cell.il)):Wd.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")};Fe.prototype.sWc=function(k,F){if(0>F)this.Zba({caller:"ApplyNumberFormatIndexOnCell",cell:k,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});else{var X=this.K2a(k.ix,F,k.cell.ZAa,
k.cell.O$);Object(gh.b)(X)?this.Zba({caller:"ApplyNumberFormatIndexOnCell",cell:k,kind:"failure",reason:X.reason}):(this.aZa(k,X.value),this.Zba({caller:"ApplyNumberFormatIndexOnCell",cell:k,kind:"success",pz:X.value,format:F}))}};Fe.prototype.Oqe=function(k,F){if(void 0===F||null===F)this.Zba({caller:"ApplyNumberFormatStringOnCell",cell:k,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});else{var X=this.K2a(k.ix,F,k.cell.ZAa,k.cell.O$);Object(gh.b)(X)?this.Zba({caller:"ApplyNumberFormatStringOnCell",
cell:k,kind:"failure",reason:X.reason}):(this.aZa(k,X.value),this.Zba({caller:"ApplyNumberFormatStringOnCell",cell:k,kind:"success",pz:X.value,format:F}))}};Fe.prototype.XJg=function(k,F){if(F=void 0===F?null:F)if(F=this.$Uh(k,F),F.success){var X=this.K2a(k.ix,F.amc,k.cell.ZAa,k.cell.O$);Object(gh.b)(X)?this.Zba({caller:"ApplyNumberFormatCategoryOnCell",cell:k,kind:"failure",reason:X.reason,format:F.amc}):(this.aZa(k,X.value),this.Zba({caller:"ApplyNumberFormatCategoryOnCell",cell:k,kind:"success",
pz:X.value,format:F.amc}))}else this.Zba({caller:"ApplyNumberFormatCategoryOnCell",cell:k,kind:"failure",reason:F.reason,format:F.amc});else this.Zba({caller:"ApplyNumberFormatCategoryOnCell",cell:k,kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})};Fe.prototype.NJg=function(k){switch(k){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<k?-1:k};Fe.prototype.$Uh=
function(k,F){if(!this.vz||!this.localeInfo||!F)return k=this.vz?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new Af(!1,void 0,"GetRibbonNumberFormat: "+k);F=F.NumberFormat;switch(F){case 0:k=mg.QDh;break;case 1:k=mg.SDh;break;case 2:k=mg.ODh;break;case 3:k=mg.MDh;break;case 4:k=mg.VDh;break;case 5:k=mg.RDh;break;case 6:k=mg.XDh;break;case 7:k=mg.TDh;break;case 8:k=mg.PDh;break;case 9:k=mg.UDh;break;case 10:k=mg.WDh;break;case 11:case 12:return this.vz.XTe(),
this.rLh(k,F);case 13:k=mg.HRg;break;case 1006:k=mg.buttonPercentage;break;case 1004:k=mg.keyboardNumber;break;case 1005:k=mg.keyboardCurrency;break;case 1002:k=mg.keyboardDate;break;case 1001:k=mg.keyboardTime;break;case 1003:k=mg.keyboardPercentage;break;case 14:return k="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",Wd.ULS.shipAssertTag(537162132,0,!1,k),new Af(!1,void 0,k);default:return k="GetRibbonNumberFormat: unknown NumberFormatType!",Wd.ULS.shipAssertTag(537162131,
0,!1,k),new Af(!1,void 0,k)}return k?(k=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,k))?new Af(!0,k):new Af(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format..."):new Af(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...")};Fe.prototype.rLh=function(k,F){if(!this.calcManager||!this.tF)return F=this.calcManager?"numberFormatter is null":"calcManager is null",new Af(!1,void 0,"GetDecimalChangeNumberFormat: "+
F);k=this.calcManager.vbc(k.cell.il);if(!Object(gh.c)(k))return new Af(!1,void 0,"getDecimalChangeNumberFormat: "+k.reason);F=this.tF.changeFormatDecimals(k.value,11===F?1:-1);return excelOnlineCalc.util.isSuccess(F)?void 0===F.value||null===F.value?new Af(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result"):new Af(!0,F.value):new Af(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure")};Fe.prototype.Zba=function(k){var F=k.caller,X=k.cell,ra=k.format;
ra=null==ra?"null":"number"===typeof ra?ra:"string"===typeof ra?Z.a.VYa(ra):Z.a.VYa(ra.formatString);var ab=Z.a.VYa(X.ix.value)||"null",Qb="success"===k.kind?Z.a.VYa(k.pz.text):"null";Wd.ULS.sendTraceTag(537162130,0,50,"FormatCellsAction.LogNumberFormatEdit: {0}",{caller:F,"range.top":X.range.top,"range.left":X.range.left,result:k.kind,reason:"success"===k.kind?"":k.reason,value:ab,valueType:X.ix.type,ifmt:ra,prediction:Qb})};Fe.prototype.YJg=function(k,F,X,ra,ab,Qb,Fc,ld,ud,jd,Ye){ld=void 0===ld?
!1:ld;ud=void 0===ud?!1:ud;var Bf=F.cell;Bf.hM=void 0===jd?0:jd;jd=F.text;jd!==X&&(Bf.text=X);Bf.W8a=void 0===Ye?null:Ye;Di.e(jd)?F.formulaBarText=jd:F.formulaBarText="";k=ff.g(k).Nb.fff(F.range);this.I1b(F,ra,null,ld,ud,k);ab&&(F.color=sj.e(Zg.a.eG(ab)));F.cell.il=Qb;F.cell.Woc=Fc;F.cell.OSd=Qb};Fe.prototype.lti=function(k,F,X,ra,ab,Qb){var Fc={};Fc.a=this.$.ya.UserSessionId;Fc.b=F;Fc.c=ra.Ranges.length;Fc.d=this.R6g(ra.Ranges);Fc.e=ab.toString();Fc.f=k;Fc.h=Qb;1890566896===k?Fc.g=X.NumberFormat.toString():
2105621672===k&&(Fc.g=X.NumberFormatOptions.NumberFormatCategory.toString());bh.b().Pe(3,Fc,!0)};Fe.prototype.R6g=function(k){for(var F=0,X=0,ra=0,ab=0;ab<k.length;ab++){var Qb=vd.B(k[ab]).eM;F+=Qb;Qb>ra&&(ra=Qb,X=ab)}k=vd.B(k[X]).toString();return"TotalCellCount:"+F+"; Max range:"+k+"; MaxRangeSize:"+ra+";"};Fe.prototype.fnj=function(k,F,X){64===(F.ValidMembers&64)&&this.setFillColor(k,F,X);16===(F.ValidMembers&16)&&Fe.Eoj(k,F);128===(F.ValidMembers&128)&&this.Mua.aKb(k,F,k.range);if(2===(F.ValidMembers&
2)||1===(F.ValidMembers&1)){X=F.VerticalAlignment;F=F.HorizontalAlignment;var ra=0!==F;ve.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!ra&&this.iZe(k);this.Mua.qcb(k,F,ra,X)}};Fe.prototype.setFillColor=function(k,F,X){(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?k.aba:k.aba&&k.cdc&&!k.Bwb&&!k.Gwb)||(F=-1===F.FillColor?X?Zg.a.eG(vi.a.white):null:Zg.a.eG(vi.a.fH(F.FillColor)),k.backgroundColor=F?sj.e(F):
null)};Fe.prototype.Yoj=function(k,F){0!==k.horizontalAlignment&&2!==k.horizontalAlignment||k.t7(1,!1);0<=k.indentation+F.IndentationIncrease&&(k.indentation+=F.IndentationIncrease)};Fe.prototype.gnj=function(k,F){var X=k.qoa,ra=F.TextOrientation;ra!==ih.a.verticalText&&(0>ra||180<ra)&&Wd.ULS.shipAssertTag(523090050,0,!1,"FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server {0}",ra);X===ra||X===ih.a.duc&&ra===ih.a.euc||X===ih.a.fuc&&ra===ih.a.guc?F.TextOrientation=
0:k.qoa=F.TextOrientation};Fe.prototype.iZe=function(k){k=this.K2a(k.ix,k.cell.il,k.cell.ZAa,k.cell.O$);return Object(gh.b)(k)?0:null!=k.value.horizontalAlignment?k.value.horizontalAlignment:0};Fe.prototype.jqj=function(k,F,X){this.Bx||(this.Bx=new he(ff.g(this.$).Ea,this.$));this.Bx.aKb(k,F,X)};Fe.prototype.$1h=function(k,F){var X=new pa.a;if(k.cell.formulaBarText&&k.cell.formulaBarText.startsWith("'"))X.Text=k.cell.formulaBarText;else{var ra=k.cellValue;ra&&4!==k.cell.hM||(ra=k.text);X.Text=ra}this.FAa(F,
X,!1,void 0,O.a.vgc(this.$));return!0};Fe.prototype.vQd=function(k,F){return this.Gb&&!!k&&!!F};Fe.V_g=function(k,F,X,ra){ra&&F.setCell(!0);0===X&&k.Ea.MV()};Fe.expandRange=function(k,F){F=F.clone();F.height<k.height&&(F.bottom=F.top+k.height-1);F.width<k.width&&(F.right=F.left+k.width-1);return F};Fe.idi=function(k){switch(k){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;default:return!1}};Fe.Eoj=function(k,F){F=F.Font;var X=0!==(F.ValidMembers&
16),ra=0!==(F.ValidMembers&16),ab=0!==(F.ValidMembers&16);k.bold=0!==(F.ValidMembers&4);k.italic=0!==(F.ValidMembers&8);X&&(k.underline=X);ra&&(k.doubleUnderline=ra);ab&&(k.fontStrikethrough=ab);X=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");k.rKb(F.FontName,X,"SetFont");k.fontSize=F.FontSize;X=Zg.a.cp(k.color,k.backgroundColor);vi.a.compare(X,vi.a.red)&&(Z.a.q5(k.text)||Z.a.T5e(k.text))||(F=vi.a.fH(F.FontColor),k.color=sj.e(Zg.a.eG(F)))};Ck.Object.defineProperties(Fe.prototype,
{Mua:{configurable:!0,enumerable:!0,get:function(){return this.lCh}},tF:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.tF}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}}});Fe.BAh=36;Object(ie.a)(Fe,"FormatCellsAction",null,[753,3]);var Dk=si.a;Wl(Cf,Dk);Cf.prototype.create=function(){this.Eb(new Fe(this.$))};Cf.ka=function(k){k.da.Ga(18,
new Cf(k))};Object(ie.a)(Cf,"FormatCellsActionFactory",si.a,[]);Object(ie.a)(qf,"FormulaAssistanceUIContext",null,[]);var li=si.a;Wl(lf,li);lf.prototype.create=function(){var k=this,F=this.$.da.za(448);if(F)this.Eb(F);else{var X=eh.GetServiceTaskFactory.Xa(this.$.da,283,284,this.vb);Ud.TaskExtensions.Ba(X,function(){Ud.TaskExtensions.Ba(xi.c(X.result.Fn.loadScript(k.cjj)),function(){F=k.$.da.za(448);if(!F){var ra=Object(na.a)(new qf,{isFeedbackAllowed:k.$.isFeedbackEnabled});F=k.$.da.Ga(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(ra));
k.$.mxe(function(){var ab={};ab.isFeedbackAllowed=k.$.isFeedbackEnabled;F.updateContext(ab)})}k.Eb(F)},k.$.la,3)},this.$.la,3)}};lf.ka=function(k){k.da.Ga(449,new lf(k))};Object(ie.a)(lf,"FormulaAssistanceUIControlFactory",si.a,[]);var hj=b(739);Object(ie.a)(wb,"FreezePanesCommandParameters",null,[]);var ok=b(185),vj=b(410),hk=b(282),yk=b(304),Kj=b(117);Dd.prototype.getSheetName=function(){return this.freezeOptions.SheetName};Object(ie.a)(Dd,"MacroRecorderSheetPaneFrozenPayload",null,[450]);rd.prototype.$c=
function(k,F){var X=!1;switch(F){case 1844679312:X=1!==k&&!this.gridView.rb.N4}return X};rd.prototype.executeCommand=function(k,F){k=this.gridView.rb;var X=this.gridView.Vgd();Rf.AFrameworkApplication.sa.Qa.Bz&&this.$.Nka&&(1844679312===F.command||340334732===F.command||-806625837===F.command)&&hj.ShyRibbon.QP(1,2);switch(F.command){case 1844679312:return this.setFreezePanes(F,X,k.$i);case 340334732:return k.N9b?Xf.Task.Sa(!1):this.Hoj(F,X);case -806625837:return k.aTa?Xf.Task.Sa(!1):this.Ioj(F,X)}return Xf.Task.Sa(!1)};
rd.prototype.Mc=function(k,F){k=!1;switch(F.command){case 1844679312:case 340334732:case -806625837:case 1745254833:k=!0}return k};rd.prototype.jd=function(){return!1};rd.prototype.setFreezePanes=function(k,F,X){if(X)return this.gvc(k,!1,0,0,0,0,F,null);var ra=this.gridView.ha.ta;X=ra.activeCell.clone();ra=ra.activeRange;ra.hf&&(Wd.ULS.sendTraceTag(537159585,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top ({0}) and firstUnfreezeCell.Bottom ({1}) to equal topLeftRange.Top ({2})",
X.top,X.bottom,F.top),X.top=X.bottom=F.top);ra.isRow&&(Wd.ULS.sendTraceTag(537159584,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left ({0}) and firstUnfreezeCell.Right ({1}) to equal topLeftRange.Left ({2})",X.left,X.right,F.left),X.left=X.right=F.left);X.top===F.top&&X.left===F.left&&(X=hb.Range.hd(X.top+1,X.left));ra=X.top-1;var ab=X.left-1,Qb=ra-(F.top-1),Fc=ab-(F.left-1);return this.yTj(X,Qb,Fc)?this.gvc(k,!0,ra,ab,Qb,Fc,F,X):(this.$.Bf(),this.aEf(),
Xf.Task.Sa(!0))};rd.prototype.Hoj=function(k,F){return this.gvc(k,!0,0,F.left,0,1,F,null)};rd.prototype.Ioj=function(k,F){return this.gvc(k,!0,F.top,0,1,0,F,null)};rd.prototype.yTj=function(k,F,X){var ra=this.gridView.tg(k),ab=this.gridView.view.visibleArea;return!ra||ab.topLeft.y>ra.bottomRight.y||ab.topLeft.x>ra.bottomRight.x||ab.bottomRight.y<ra.bottomRight.y||ab.bottomRight.x<ra.bottomRight.x?(Wd.ULS.sendTraceTag(537159583,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range={0}, rangeViewportArea={1}, visibleArea={2}",
k,ra?ra.toString():"null",ab.toString()),k=Vf.a.gd(1,0,26,1468,0,2105967339,"FreezePaneSelectionNotInViewErr"),ve.EwaSettings.Az()?new Eg.a(this.$,k):(k=new lh.ErrorDialog(this.$,k),k.initialize(),k.Af()),!1):0>=F&&0>=X?(Wd.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),k=ff.g(this.$).rtl?1470:1469,F=ff.g(this.$).rtl?-2131054257:-1953454131,k=Vf.a.gd(1,0,26,k,0,F,"FreezePaneA1SelectedErr"),ve.EwaSettings.Az()?new Eg.a(this.$,
k):(k=new lh.ErrorDialog(this.$,k),k.initialize(),k.Af()),!1):!0};rd.prototype.gvc=function(k,F,X,ra,ab,Qb,Fc,ld){function ud(){return new Dd(Ye)}var jd=this;this.gFd=Uh.a(this.$).J9(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.zP(this.zwf);this.qF.qSa();this.gridView.UCj(F?"":"UnsetFreezePane");this.$qj(k,F,this.gridView.rb);var Ye=Object(na.a)(new wb,{SheetName:this.$.qa.name,Freeze:F,FrozenRows:ab,FrozenColumns:Qb,FirstRow:X,FirstColumn:ra});Wd.ULS.sendTraceTag(573101852,
0,50,"FreezePanesCommandHandler.SendFreezePanesRequest: Freeze={0}, FrozenRows={1}, FrozenColumns={2}, FirstRow={3}, FirstColumn={4} ",F,ab,Qb,X,ra);this.s$b=Vh.a.Ua.oe;return rh.a(this.$.userOperationManager,function(Bf,Tg,$g){if(ve.EwaSettings.ma(61)){var Wg=window.performance;Wg.clearMarks();Wg.mark("FreezePanes request sent")}Wg=jd.gridView.Ls;ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RequestContentOnFreezePaneOperation",!1)&&Wg?(Wg=jd.jlh(Ye,Wg,Fc,ld),jd.gKj(Wg)):jd.$.By();
Wg=jd.$.na.va;var qh=Wg.Na(9,null);qh.freezeSettings=Ye;return Yg.i(Wg,"FreezeOrUnfreezePanes",qh,Bf,Tg,$g,F,0)},function(Bf){return new cg.a(151,0,Bf,void 0,ud)},k)};rd.prototype.jlh=function(k,F,X,ra){Wd.ULS.shipAssertTag(537159580,1,!!F,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!k.Freeze)return null;var ab=yk.a();ab.State=1;ab.IsEstimated=!0;var Qb=!1,Fc=!1,ld=F.qV(hb.Range.hd(X.top,X.left)),ud=k.FrozenRows,jd=k.FrozenColumns;1!==k.FrozenRows||
k.FrozenColumns?k.FrozenRows||1!==k.FrozenColumns?(jd=F.qV(hb.Range.hd(k.FirstRow+1,k.FirstColumn+1)),F=F.qV(hb.Range.hd(X.top,X.left)),ab.Width=jd.Lk-ld.Lk,ab.Height=jd.ll-ld.ll,0<k.FrozenRows&&(ab.AbsoluteTop=jd.ll,Fc=!0),0<k.FrozenColumns&&(ab.AbsoluteLeft=jd.Lk,Qb=!0),ud=jd.XK-F.XK,jd=jd.zJ-F.zJ):(ab.Width=F.Bfd(ok.a.hd(X.top,X.left)),ra=hb.Range.hd(X.top,X.left+1),ab.AbsoluteLeft=ld.Lk+ab.Width,Qb=!0):(ab.Height=F.Afd(ok.a.hd(X.top,X.left)),ra=hb.Range.hd(X.top+1,X.left),ab.AbsoluteTop=ld.ll+
ab.Height,Fc=!0);Fc&&(ab.FirstFrozenRow=X.top,ab.FirstScrollableRow=ra.top);Qb&&(ab.FirstFrozenColumn=X.left,ab.FirstScrollableColumn=ra.left);ab.VisibleRows=ud;ab.VisibleColumns=jd;return ab};rd.prototype.gKj=function(k){var F=this;Xf.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(function(){F.$.qa&&F.$.ea&&(F.$.ea.BX(ih.a.Re,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),vj.b(F.$.qa,k,-1,void 0,!0))})};rd.prototype.$qj=function(k,F,X){if(!ve.EwaSettings.ma(662))switch(k.command){case 1844679312:if(F||
-1===this.FKa&&-1===this.GKa)this.FKa=X.wx-X.width+this.gridView.scrollLeft,this.GKa=X.xx-X.height+this.gridView.scrollTop;break;case 340334732:if(F||-1===this.FKa)this.FKa=X.wx-X.width+this.gridView.scrollLeft;break;case -806625837:if(F||-1===this.GKa)this.GKa=X.xx-X.height+this.gridView.scrollTop}};rd.prototype.Btc=function(){var k=this.gridView.rb;0<k.width?this.gridView.scrollLeft=Kj.a.M0b(this.gridView.domElement,ff.g(this.$).rtl,0):-1!==this.FKa&&(this.gridView.scrollLeft=this.FKa,this.FKa=
-1);0<k.height?this.gridView.scrollTop=0:-1!==this.GKa&&(this.gridView.scrollTop=this.GKa,this.GKa=-1)};rd.prototype.aEf=function(){this.qF.Adb();zg.a.Ha(this.gFd);this.gFd=null;this.gridView.LK(this.zwf)};Object(ie.a)(rd,"FreezePanesCommandHandler",null,[428]);var Gh=bf.a;Wl(Ec,Gh);Ec.prototype.Od=function(){var k=this;Ud.TaskExtensions.Ba(eh.GetServiceTaskFactory.Xa(this.$.da,12,477,this.vb),function(F){k.Cd([new rd(k.$,F.result)])},this.$.la)};Ec.ka=function(k){k.da.Ga(116,new Ec(k))};Object(ie.a)(Ec,
"FreezePanesCommandHandlerFactory",bf.a,[]);var Ok=b(1015),pk=si.a;Wl(pe,pk);pe.prototype.create=function(){var k=this,F=eh.GetServiceTaskFactory.create(this.$.da,18,this.la,this.vb),X=eh.GetServiceTaskFactory.create(this.$.da,102,this.la,this.vb);Ud.TaskExtensions.Ba(Ud.TaskExtensions.te([F,X],this.la),function(){k.Eb(k.$.da.za(296)||k.$.da.Ga(296,new Ok.BorderFormatManager(k.$,F.result,X.result)))},this.la,3)};pe.ka=function(k){ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&
k.da.Ga(468,new pe(k))};Object(ie.a)(pe,"BorderFormatManagerFactory",si.a,[]);var Nj=b(1031),mj=b(24),fk=b(96),Lj=b(273),bl=b(368),pl=b(365),Xj=b(98),Ek;(function(k){k[k.insert=1]="insert";k[k.delete=2]="delete";k[k.rows=4]="rows";k[k.columns=8]="columns";k[k.cellsShiftHorizontal=16]="cellsShiftHorizontal";k[k.cellsShiftVertical=32]="cellsShiftVertical";k[k.insertRows=5]="insertRows";k[k.insertColumns=9]="insertColumns";k[k.insertCellsShiftRight=17]="insertCellsShiftRight";k[k.insertCellsShiftDown=
33]="insertCellsShiftDown";k[k.deleteRows=6]="deleteRows";k[k.deleteColumns=10]="deleteColumns";k[k.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";k[k.deleteCellsShiftUp=34]="deleteCellsShiftUp"})(Ek||(Ek={}));Object(ie.b)("InsertDeleteCellFlags",Ek);var qk=b(443);Object(ie.a)(Nd,"MacroRecorderRangeInsertedOrDeletedPayload",null,[450]);var rk=b(114),Dj=b(268),Jk=b(1193);b(321);ed.Qdd="GetFontPreviewData";Object(ie.a)(ed,"FontWebServiceMethods",null,[]);wc.prototype.Qdd=function(k,F){var X=this.Yu,
ra=this.Yu.hc(),ab=ed.Qdd;ra=X.Na(5,void 0===ra?null:ra);return Yg.i(X,ab,ra,k,F,null,null,644)};Object(ie.a)(wc,"FontServiceManager",null,[]);md.prototype.eVe=function(k,F,X,ra){ra=void 0===ra?null:ra;var ab=Object(na.a)(new Gf.a,{Id:"FontDropdownMenu"});ab.MenuSectionList=[];if(this.Om&&this.themesManager){this.themesManager.B$c(ra);if(null==this.themesManager.kL||this.themesManager.Dqd)return ab;ra=Object(na.a)(new jf.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:we.a.instance.ga(1315),ControlList:this.QXh(k,
F,X)});ab.MenuSectionList.push(ra)}ra=Object(na.a)(new jf.a,{ControlsId:"FontsMenuSectionControl"});this.Om&&(ra.Title=we.a.instance.ga(1316));ra.ControlList=this.ONh(k,F,X);ab.MenuSectionList.push(ra);return ab};md.prototype.QXh=function(k,F,X){var ra,ab=[],Qb=ff.g(this.$).ha.Oa.nc;Qb=5===(null===(ra=null===Qb||void 0===Qb?void 0:Qb.floatingObject)||void 0===ra?void 0:ra.type);if(this.themesManager.kL){var Fc=this.themesManager.kL.Apf;var ld=this.themesManager.kL.Xnf}else Wd.ULS.sendTraceTag(525361436,
1,15,"ThemeFonts are Null");null!=ld?(ra=this.uEe(ld,1,Qb,k,F,X),ab.push(ra)):Wd.ULS.sendTraceTag(525361435,1,15,"Major Theme Font is Null");null!=Fc?(k=this.uEe(Fc,2,Qb,k,F,X),ab.push(k)):Wd.ULS.sendTraceTag(525361434,1,15,"Minor Theme Font is Null");return ab};md.prototype.uEe=function(k,F,X,ra,ab,Qb){var Fc=2===F?this.hzi:this.nwi;X=X?Fc:wg.a.pf(k);Fc=wg.a.pf(Sc.HelperMethods.bcc(k,F));k=wg.a.pf(k);return Object(na.a)(new Jk.a,{MenuItemId:2===F?"MinorThemeFont":"MajorThemeFont",CommandValueId:X,
LabelText:Fc,LabelCss:String.format("font-size:12pt;font-family:{0};",k),Styles:md.Fvb(k),AriaLabel:Fc,Alt:Fc,Command:ra.toString(),CommandPreviewId:ab.toString(),CommandRevertId:Qb.toString()})};md.prototype.ONh=function(k,F,X){if(md.OYc)return md.OYc.c5c;var ra=this.Qdi&&!this.Qef,ab=!1;md.G2a||(md.P9e(),ab=!0);var Qb=this.YCe(k,F,X,md.G2a,ra,ab);Qb.Uwc&&!ab&&(Wd.ULS.sendTraceTag(523903238,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),
md.P9e(),Qb=this.YCe(k,F,X,md.G2a,ra,Qb.Uwc));this.iu&&!Qb.Uwc&&(hf.a.Ji(md.styles),md.OYc=Qb);ra&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.nOi);return Qb.c5c};md.prototype.YCe=function(k,F,X,ra,ab,Qb){var Fc=[],ld=this.iu&&!Qb;var ud=ld?"msofpNew":"msofp";for(var jd in ra){var Ye=jd,Bf=ra[jd],Tg=wg.a.pf(Ye),$g;if(ld)if($g=md.eea?md.eea[Ye]:null)$g=wg.a.pf($g);else return Wd.ULS.sendTraceTag(523903237,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for {0}",
Ye),{Uwc:!0,c5c:[]};else $g=wg.a.pf(Sc.HelperMethods.eea[Ye]);Ye=wg.a.pf(Ye);ab||(Bf=0);Tg=Object(na.a)(new Jk.a,{MenuItemId:Tg,CommandValueId:Tg,LabelText:ab&&0<Bf?wg.a.pf(String.fromCodePoint(Bf)):$g,LabelCss:String.format("font-size:12pt;font-family:{0};",ab&&0<Bf?ud:Ye),Styles:md.Fvb(ab&&0<Bf?ud:Ye),AriaLabel:$g,Alt:$g,Command:k.toString(),CommandPreviewId:F.toString(),CommandRevertId:X.toString()});Fc.push(Tg)}return{Uwc:Qb,c5c:Fc}};md.prototype.ypj=function(k){this.menuId=k};md.prototype.Bgi=
function(){return 2!==this.$tb&&3!==this.$tb?!1:!0};md.prototype.Ldj=function(){this.$tb=1;this.TTe||(this.TTe=new wc(this.$.na.Yu));this.TTe.Qdd(this.WIi,this.XIi)};md.prototype.bZi=function(k){if(this.Tmi(k)){var F=Sc.HelperMethods.gca(function(){var X=k.Result;md.styles='@font-face{font-family:"msofpNew";font-style:normal;font-weight:normal;src:url(\''+X.PreviewUrl+"') format('truetype')}";var ra=X.FontFacePropertiesList;X=X.FontNameList;md.G2a={};md.eea={};X.forEach(function(ab,Qb){md.G2a[ab]=
ra[Qb].Codepoint;md.eea[ab]=ab})});10<F&&Wd.ULS.sendTraceTag(523903236,1,50,"FontDropdownHelper.prepareFontCodepointMap: Duration for prepareFontCodepointMap the model, duration={0}",F)}};md.prototype.Tmi=function(k){if(!k.Result)return Wd.ULS.sendTraceTag(523903235,1,15,"FontDropdownHelper.isValidFontPreviewData: Result in EwaResult is Null."),!1;k=k.Result;return k?k.PreviewUrl?k.FontFacePropertiesList?k.FontNameList?0==k.FontFacePropertiesList.length||k.FontFacePropertiesList.length!=k.FontNameList.length?
(Wd.ULS.sendTraceTag(523903202,1,15,"FontDropdownHelper.isValidFontPreviewData: Mismatch in length of FontFacePropertiesList and FontNameList in fontListPreviewData."),!1):!0:(Wd.ULS.sendTraceTag(523903203,1,15,"FontDropdownHelper.isValidFontPreviewData: FontNameList in fontListPreviewData is Null."),!1):(Wd.ULS.sendTraceTag(523903232,1,15,"FontDropdownHelper.isValidFontPreviewData: FontFacePropertiesList in fontListPreviewData is Null."),!1):(Wd.ULS.sendTraceTag(523903233,1,15,"FontDropdownHelper.isValidFontPreviewData: PreviewUrl in fontListPreviewData is Null."),
!1):(Wd.ULS.sendTraceTag(523903234,1,15,"FontDropdownHelper.isValidFontPreviewData: fontListPreviewData is Null."),!1)};md.prototype.xMf=function(){this.menuId&&this.frame.Lv(this.menuId)};md.P9e=function(){var k={};md.G2a=(k["Angsana New"]=983046,k["Arial Black"]=983051,k.Arial=983050,k.Batang=983061,k["Book Antiqua"]=983077,k["Browallia New"]=983082,k.Calibri=983085,k.Cambria=983089,k.Candara=983091,k.Century=983095,k["Comic Sans MS"]=983100,k.Consolas=983101,k.Constantia=983102,k.Corbel=983106,
k["Cordia New"]=983107,k["Courier New"]=983109,k.DilleniaUPC=983121,k.Dotum=983123,k.FangSong=983138,k.Garamond=983154,k.Georgia=983156,k.Gulim=983182,k.GungSuh=983186,k.KaiTi=983222,k.JasmineUPC=983218,k["Malgun Gothic"]=983258,k.Mangal=983262,k.Meiryo=983264,k["Microsoft JhengHei"]=983272,k["Microsoft YaHei"]=983284,k.MingLiU=983292,k.MingLiU_HKSCS=983296,k["MS Gothic"]=983245,k["MS Mincho"]=983247,k["MS PGothic"]=983249,k["MS PMincho"]=983251,k.PMingliU=983322,k["PMingLiU-ExtB"]=983324,k.SimHei=
983382,k.SimSun=983384,k["SimSun-ExtB"]=983386,k["Source Sans Pro"]=983396,k.Tahoma=983405,k.THSarabunPSK=983404,k["Times New Roman"]=983415,k["Trebuchet MS"]=983419,k.Verdana=983443,k["Yu Gothic"]=983464,k["Yu Mincho"]=983474,k)};md.Fvb=function(k){var F={};F["font-family"]=k;F["font-size"]="12pt";return{optionText:F}};Ck.Object.defineProperties(md.prototype,{themesManager:{configurable:!0,enumerable:!0,get:function(){this.sx||(this.sx=this.$.da.za(422));return this.sx}}});Ck.Object.defineProperties(md,
{C6f:{configurable:!0,enumerable:!0,get:function(){return md.eea}}});md.G2a=null;md.eea=null;md.OYc=null;md.styles=null;Object(ie.a)(md,"FontDropdownHelper",null,[755]);Mc.AQg=function(k,F){return new Mc(k,F,null,null,null)};Mc.HYc=function(k,F){return new Mc(k,null,F,null,null)};Mc.BQg=function(k,F){return new Mc(k,null,null,F,null)};Mc.zQg=function(k,F,X){return new Mc(k,null,F,null,X)};Ck.Object.defineProperties(Mc.prototype,{rJa:{configurable:!0,enumerable:!0,get:function(){return this.Zng}},
formattedText:{configurable:!0,enumerable:!0,get:function(){return this.$ng}},style:{configurable:!0,enumerable:!0,get:function(){return this.lwg}},size:{configurable:!0,enumerable:!0,get:function(){return this.GWb}},Daa:{configurable:!0,enumerable:!0,get:function(){return this.STe}}});Object(ie.a)(Mc,"CachedPreviewCellGroup",null,[]);var zk=b(66);Sb.prototype.tL=function(){var k=this;this.yDc=!1;if(qc.b(this.dCa,514846606)){this.yDc=!0;Wd.ULS.sendTraceTag(537159430,0,50,"Merge cells with multiple values");
zk.a(this.Cf.$).ud.bE(514846606);if(this.jPb&&this.s_d)window.setTimeout(function(){k.Cf.faa(k.Cf.gridView,k.cCa,!0,!0)},0);else return this.I_d=ff.g(this.Cf.$).rtl,this.K_d=Vf.a.gd(3,2,0,this.I_d?637:636,0,514846606,"MergeCellsLoseData"),this.jj=Uh.a(this.Cf.$).si(this.K_d).G(),this.jj.isCompleted||(this._state=2,this.jj.vN(this.moveNext)),this.rDc;return this.Afb}return this.n1};Sb.prototype.n1=function(){this.Cf.Vkf(this.yDc,this.s_d,this.igg.scenario,this.jPb);this._state=3};Sb.prototype.Afb=
function(){return this.n1};Sb.prototype.rDc=function(){this.uDc=this.jj.rz();if(0===this.uDc)return Wd.ULS.sendTraceTag(537159429,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.jj=this.Cf.faa(this.Cf.gridView,this.cCa,!0,!1).g(),this.jj.isCompleted||(this._state=2,this.jj.vN(this.moveNext)),this.sDc;1===this.uDc&&Wd.ULS.sendTraceTag(537159428,0,50,"MergeCellsLoseData Dialog: Cancel pressed");return this.Cfb};Sb.prototype.Cfb=function(){return this.Afb};Sb.prototype.sDc=function(){this.jj.rz();
return this.Cfb};Sb.prototype.dispose=function(){};Object(ie.a)(Sb,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOld",null,[3]);Cd.prototype.tL=function(){return qc.b(this.dCa,514846606)?(Wd.ULS.sendTraceTag(537159427,0,50,"Merge cells with multiple values"),zk.a(this.Cf.$).ud.bE(514846606),this.F_d=ff.g(this.Cf.$).rtl,this.G_d=Vf.a.gd(3,2,0,this.F_d?637:636,0,514846606,"MergeCellsLoseData"),this.jj=Uh.a(this.Cf.$).si(this.G_d).G(),this.jj.isCompleted||(this._state=
2,this.jj.vN(this.moveNext)),this.zfb):this.n1};Cd.prototype.n1=function(){this._state=3};Cd.prototype.zfb=function(){this.xDc=this.jj.rz();if(0===this.xDc)return Wd.ULS.sendTraceTag(537159426,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.jj=this.Cf.faa(this.Cf.gridView,this.cCa,!0,this.jPb).g(),this.jj.isCompleted||(this._state=2,this.jj.vN(this.moveNext)),this.tgg;1===this.xDc&&Wd.ULS.sendTraceTag(537159425,0,50,"MergeCellsLoseData Dialog: Cancel pressed");return this.Bfb};Cd.prototype.Bfb=
function(){return this.n1};Cd.prototype.tgg=function(){this.jj.rz();return this.Bfb};Cd.prototype.dispose=function(){};Object(ie.a)(Cd,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOldForNonDataLossCSE",null,[3]);var Pk=b(387),cl=Pk.a;Wl(Xc,cl);Xc.prototype.Ug=function(){1896159024===this.Br?(this.Jm=we.a.instance.ga(23),this.W5c=0):(this.Jm=we.a.instance.ga(22),this.W5c=1);var k=this.selectedRanges[0].l_&&!this.selectedRanges[0].y5?0:1;this.ic=1;var F={};
k=(F[Xc.Px]=this.Cc,F.dialogToDisplay=this.W5c,F.defaultSelectedKey=k,F.isRtl=this.isRtl,F);this.initializeAndShow(this.Jm,this.Dai,k)};Ck.Object.defineProperties(Xc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"InsertDeleteCellsDialog"}}});Object(ie.a)(Xc,"InsertDeleteCellsDialog",Pk.a,[]);Object(ie.a)(Md,"MacroRecorderRangeFilledPayload",null,[450]);Object(ie.a)(Tc,"RangeBorders",null,[]);Object(ie.a)(Hc,"ScenarioInfo",null,[]);gc.prototype.dispose=function(){this.$=null};gc.prototype.hfi=
function(k,F){return!(void 0===F||null===F)&&!!(F.scenario&16384)&&!this.jfi(k,F)&&this.Paf(F,k)};gc.prototype.c_e=function(){var k=be.a.Ce(),F=ff.g(this.$),X=F.ha.ta.selectedRanges,ra=0,ab=0,Qb=X.length,Fc=new Hc;if(1<Qb)return Fc.scenario=4,Fc;this.Fod&&ff.g(this.$).rtl&&(ra|=65536);if(!F.i_(X[0]))if(this.wyb)ra|=32;else return Fc.scenario=32,Fc;if(F=F.Ea.F3a(X[0],this.$.activeItemName))for(Fc.ZXc=F,F=Gl(F),Qb=F.next();!Qb.done;Qb=F.next())if(ab+=1,1<ab){this.wyb?(ra|=256,Fc.scenario=ra):Fc.scenario=
256;if(!this.pzb)return Fc;break}ab=ff.g(this.$).Ea.Vua(X[0]);if(!ab)return Fc.scenario=32768,Fc;F=ab.length;X=X[0];Qb=X.bottom-X.top+1;for(var ld=X.right-X.left+1,ud=new Tc,jd=0;jd<F;jd++)if(this.aff&&this.STh(ab[jd],X,ud),ra=ra|(void 0!==ab[jd].text&&null!==ab[jd].text&&""!==ab[jd].text?1:0)|(ab[jd].UM?2:0)|(ab[jd].Nva?8:0)|(ab[jd].zwb?16:0)|(ab[jd].vH?64:0)|(ab[jd].aba?128:0),void 0!==ab[jd].text&&null!==ab[jd].text&&""!==ab[jd].text||ab[jd].Nva)if(void 0===Fc.GQ||null===Fc.GQ)Fc.GQ=ff.g(this.$).lc(ab[jd].getRange());
else{if(ab[jd].getRange().top<Fc.GQ.range.top||ab[jd].getRange().top==Fc.GQ.range.top&&ab[jd].getRange().left<Fc.GQ.range.left)Fc.GQ=ff.g(this.$).lc(ab[jd].getRange());ra|=16384}this.aff&&(ud.ZSa===ld&&(ra|=512),ud.sGa===ld&&(ra|=2048),ud.nNa===Qb&&(ra|=4096),ud.AQa===Qb&&(ra|=1024),0<ud.ZSa&&ud.ZSa<ld||0<ud.sGa&&ud.sGa<ld||0<ud.nNa&&ud.nNa<Qb||0<ud.AQa&&ud.AQa<Qb)&&(ra|=8192);!ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||X.right!==X.maxColumns&&X.bottom!==
X.maxRows||(ra|=131072);k=be.a.Ce()-k;Wd.ULS.sendTraceTag(537159424,0,50,"Execution time of GetMergeCellScenario is : {0}",k);Fc.scenario=ra;return Fc};gc.prototype.dpf=function(k,F){var X=k.command;if(void 0===F||null===F)F=this.c_e();if(!this.Paf(F,X))return!1;k=ff.g(this.$).ha.ta.selectedRanges;var ra=ff.g(this.$).Ea.Vua(k[0]);if(!ra)return!1;if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===ra.length&&!ra[0].UM)return-167499203===X?(ra[0].t7(2,!0),!0):
!1;ra=ff.g(this.$).ha.ta.nt;var ab=this.$.qa.sheetName,Qb=!0;switch(X){case -167499203:2===(F.scenario&2)&&this.Hgc?this.mag(F.scenario,k,X):Qb=this.Ayi(F,k);break;case 1097660126:(F=this.epf(F,k))&&0!=F.length||(Qb=!1);break;case 155820588:this.mag(F.scenario,k,X);break;default:return!1}ff.g(this.$).xV(k,ra,ab,null,k[0],null,null,0,"MergeCellCommandAction");return this.pzb?Qb:!0};gc.prototype.Paf=function(k,F){var X=this.Vdi(k,F);if(!this.Ycf)return X;var ra=ff.g(this.$).ha.ta.selectedRanges[0].hB(!1);
Wd.ULS.sendTraceTag(526149324,0,50,"Merge Cell Command: {0}; Scenario Number: {1}; IsCSEPossible result: {2}; Range: {3}",F.toString(),k.scenario,X,ra);return X};gc.prototype.Vdi=function(k,F){if(-255094134===F)return!1;var X=k.scenario;if(this.Fod&&65536===(X&65536))return!1;if(this.Ygf(F,k))return this.Cmi(F,k);this.wyb&&32===(X&32)&&(X&=-33);if(256==(X&256))if(this.Cii(k))X&=-257;else return!1;return 32768===X||4===X||128===(X&128)||!this.wyb&&32===X?!1:-167499203!=F&&1097660126!==F||!this.xmd(k)?
void 0!==k.GQ&&null!==k.GQ&&k.GQ.Hea?!1:0===X?!0:16384===(X&16384)?ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(X&1)&&8!==(X&8)||!ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:this.Igc};gc.prototype.Wfi=function(k){return 131072===(k.scenario&131072)?!0:!1};gc.prototype.Cii=function(k){if(!this.pzb)return!1;var F="Multi block",X=!0;this.xmd(k)&&(F+=" with border",X=!1);this.Wfi(k)&&(X=!1,F+=
" with entire row or column selected",16384===(k.scenario&16384)&&(F+=" and a data loss scenario"));X||Wd.ULS.sendTraceTag(523511383,0,50,"CSE for {0}, is not enabled",F);return X};gc.prototype.xmd=function(k){return 16===(k.scenario&16)||this.qid(k.scenario)||this.Oid(k.scenario)||this.Fid(k.scenario)||this.Rid(k.scenario)||8192===(k.scenario&8192)?!0:!1};gc.prototype.jfi=function(k,F){return this.ifi?this.Ygf(k,F):155820588===k};gc.prototype.Ygf=function(k,F){return 155820588===k||(-167499203===
k||1097660126===k)&&2===(F.scenario&2)&&this.Hgc?!0:!1};gc.prototype.Bmi=function(k){return this.Rid(k.scenario)||this.Fid(k.scenario)||this.qid(k.scenario)||this.Oid(k.scenario)?!0:!1};gc.prototype.Cmi=function(k,F){if(1097660126===k&&2===(F.scenario&2)||this.bfi&&void 0!==F.GQ&&null!==F.GQ&&F.GQ.Hea)return!1;this.wyb&&32===(F.scenario&32)&&(F.scenario&=-33);return 32768===F.scenario||4===F.scenario||256===(F.scenario&256)&&this.nii||128===(F.scenario&128)?!1:2===(F.scenario&2)?this.Bmi(F)?ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",
!1):ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",!1):!1};gc.prototype.STh=function(k,F,X){var ra=k.getRange();if(ra.top===F.top)if(k.QKa)X.ZSa+=ra.right-ra.left+1;else{var ab=this.Bx.LQ(ra,0);if(ab){var Qb=Gl(ab);for(ab=Qb.next();!ab.done;ab=Qb.next())ab=ab.value,ab.LKa&&(X.ZSa+=ab.getRange().right-ab.getRange().left+1)}}if(ra.left===F.left)if(k.NKa)X.nNa+=ra.bottom-ra.top+1;else if(ab=this.Bx.LQ(ra,2))for(Qb=Gl(ab),ab=Qb.next();!ab.done;ab=
Qb.next())ab=ab.value,ab.OKa&&(X.nNa+=ab.getRange().bottom-ab.getRange().top+1);if(ra.bottom===F.bottom)if(k.LKa)X.sGa+=ra.right-ra.left+1;else if(ab=this.Bx.LQ(ra,1))for(Qb=Gl(ab),ab=Qb.next();!ab.done;ab=Qb.next())ab=ab.value,ab.QKa&&(X.sGa+=ab.getRange().right-ab.getRange().left+1);if(ra.right===F.right)if(k.OKa)X.AQa+=ra.bottom-ra.top+1;else if(k=this.Bx.LQ(ra,3))for(k=Gl(k),ab=k.next();!ab.done;ab=k.next())F=ab.value,F.NKa&&(X.AQa+=F.getRange().bottom-F.getRange().top+1)};gc.prototype.t8i=function(k,
F){F=Gl(F.ZXc);for(var X=F.next();!X.done;X=F.next()){X=k.Se(X.value.uf);X=ff.g(this.$).Ea.Vua(X);for(var ra=X.length,ab=1;ab<ra;ab++){var Qb=ff.g(this.$).lc(X[ab].getRange());this.Igc?Qb.cell.deleteCellFromModel():(Qb.Spb(),Qb.clearFormat(),Qb.cell.v8i());Qb.wHb(!0)}}};gc.prototype.PRj=function(k,F){k.backgroundColor=F.backgroundColor;k.color=F.color};gc.prototype.lhg=function(k,F){return{SpansBlocks:!0,OriginRow:k,OriginColumn:F,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}};
gc.prototype.Jzg=function(k,F,X,ra,ab){X=k.Se(X.uf);if(!X)return Wd.ULS.sendTraceTag(523547158,0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),null;var Qb=new hb.Range(k.top,k.left,X.top,X.left,!1,!1);if(X.top==k.top)var Fc=0;else Qb.bottom=X.top-1,Fc=F.Afd(Qb);X.left==k.left?Qb=0:(Qb.right=X.left-1,Qb=F.Bfd(Qb));F=this.lhg(k.top-1,k.left-1);F.OriginDeltaY=Fc;F.OriginDeltaX=Qb;F.Rows=X.bottom-
X.top;F.Columns=X.right-X.left;F.Height=ab;F.Width=ra;X.top==k.top&&X.left==k.left&&(F.IsOrigin=!0);k=ff.g(this.$).lc(X.topLeft);k.cell.iZf(F);return k};gc.prototype.tOd=function(k,F){var X=[],ra=ff.g(this.$).tf;if(!ra)return X;var ab=ra.Afd(k),Qb=ra.Bfd(k);if(F.ZXc){F=Gl(F.ZXc);for(var Fc=F.next();!Fc.done;Fc=F.next())if(Fc=this.Jzg(k,ra,Fc.value,Qb,ab))X.push(Fc);else{X=[];break}}return X};gc.prototype.TUh=function(k,F,X,ra){var ab=X.bottom-X.top,Qb=X.right-X.left,Fc=[],ld=ra.scenario;if(256===
(ld&256)){if(Fc=this.tOd(X,ra),!Fc||0==Fc.length)return Fc}else F.cell.tOd(ab,Qb),Fc.push(F);ab=this.e3(this.f5(F),!0,0,ld,"merge");if(void 0!==k&&null!==k){Qb=Gl(Fc);for(var ud=Qb.next();!ud.done;ud=Qb.next()){ud=ud.value;var jd=k.cell.formattedText,Ye=Object(na.a)(new pa.a,{TextRuns:jd.TextRuns,Fonts:jd.Fonts});Ye.Text=void 0!==k.cell.originalText&&null!==k.cell.originalText?k.cell.originalText:void 0!==k.cell.userInput&&null!==k.cell.userInput?k.cell.userInput:jd.Text;ab=this.e3(this.f5(ud),ab,
1,ld,"merge");this.Sg.FAa(ud,Ye,!1,null,!0,"MergeCells",void 0,2);ab=this.e3(this.f5(ud),ab,2,ld,"merge");this.Fod?ud.aqb(k):this.PRj(ud,k);ab=this.e3(this.f5(ud),ab,3,ld,"merge");ud.cell.S2g(k.cell);ab=this.e3(this.f5(ud),ab,4,ld,"merge");ud.cell.ZBc(!1);ab=this.e3(this.f5(ud),ab,6,ld,"merge")}}this.t8i(X,ra);this.e3(this.f5(F),ab,5,ld,"merge");return Fc};gc.prototype.Fid=function(k){return 4096===(k&4096)};gc.prototype.Rid=function(k){return 512===(k&512)};gc.prototype.qid=function(k){return 2048===
(k&2048)};gc.prototype.Oid=function(k){return 1024===(k&1024)};gc.prototype.bac=function(k,F){for(var X=null,ra=0;ra<k.length;ra++)if(k[ra].BorderPosition===F){X=k[ra];break}return X};gc.prototype.cQh=function(k,F){this.thc?(F=this.bac(F.cell.BM().Borders,2))&&k.push(F):(F=F.cell.BM().Borders,1<F.length&&(F=[F[1]]),k=[].concat(Hl(F),Hl(k)));return k};gc.prototype.iYh=function(k,F){this.thc?(F=this.bac(F.cell.BM().Borders,0))&&k.push(F):(F=F.cell.BM().Borders,1<F.length&&(F=[F[0]]),k=[].concat(Hl(F),
Hl(k)));return k};gc.prototype.hIh=function(k,F){F=this.Bx.LQ(F.cell.getRange(),1);if(this.thc){if(F=F[0].BM().Borders,F=this.bac(F,0))F.BorderPosition=1,k.push(F)}else{var X=[];0<F.length&&(X=F[0].BM().Borders);X[0].BorderPosition=1;k=[].concat(Hl(X),Hl(k))}return k};gc.prototype.dVh=function(k,F){F=this.Bx.LQ(F.cell.getRange(),3);if(this.thc){if(F=F[0].BM().Borders,F=this.bac(F,2))F.BorderPosition=3,k.push(F)}else{var X=[];0<F.length&&(X=F[0].BM().Borders);X[0].BorderPosition=3;k=[].concat(Hl(X),
Hl(k))}return k};gc.prototype.TTh=function(k,F,X){this.Fid(k.scenario)&&(F=this.cQh(F,X));this.Rid(k.scenario)&&(F=this.iYh(F,X));this.qid(k.scenario)&&(F=this.hIh(F,X));this.Oid(k.scenario)&&(F=this.dVh(F,X));return F};gc.prototype.zZ=function(k){if(0===k.length)return null;var F=[0,0,0,0],X=[1,1,1,1],ra=0;k.forEach(function(Qb){var Fc=Qb.BorderPosition;X[Fc]=Qb.BorderLineStyle;var ld=new vi.a(Qb.Color.Red,Qb.Color.Green,Qb.Color.Blue);F[Fc]=ld.BS();ra|=Sc.HelperMethods.j3a(Qb.BorderPosition)});
k={};k.LineStyle=X;k.Color=F;var ab={};ab.BorderFormat=k;ab.Border=ra;return ab};gc.prototype.t0d=function(k,F,X){X=void 0===X?null:X;var ra=[];ra=null!==X?[].concat(Hl(X)):this.TTh(F,ra,k);if(F=this.zZ(ra))k.cell.Pab(k.cell.getRange()),this.Bx.vHb(k.cell.getRange()),this.Sg.Sda(ff.g(this.$),-1690267012,F,!1,null,[k.cell.getRange()])};gc.prototype.Fji=function(k){return 512===(k.scenario&512)||4096===(k.scenario&4096)||1024===(k.scenario&1024)||2048===(k.scenario&2048)?!0:!1};gc.prototype.jYh=function(k){k=
this.Bx.LQ(k.cell.getRange(),1);return k&&0!==k.length?k[0].QKa?(k=k[0].BM().Borders[0],k.BorderPosition=1,k):null:null};gc.prototype.kYh=function(k){k=this.Bx.LQ(k.cell.getRange(),3);return k&&0!==k.length?k[0].NKa?(k=k[0].BM().Borders[0],k.BorderPosition=3,k):null:null};gc.prototype.L1h=function(k,F,X,ra,ab){F.cell.jcg();if(this.Fji(k))this.t0d(F,k);else{var Qb=8192===(k.scenario&8192),Fc=F.cell.getRange();Qb&&this.Xaf?(F.cell.Pab(),this.Bx.vHb(Fc)):ab?(ab=[],null!==X&&ab.push(X),null!==ra&&ab.push(ra),
0<ab.length?this.t0d(F,k,ab):(F.cell.Pab(),this.Bx.vHb(Fc))):Qb&&!this.Xaf&&(F.cell.Pab(),this.Bx.vHb(Fc))}};gc.prototype.APh=function(k,F){return null===k||void 0===k?!0:k.cell.getRange().top===F.topLeft.top&&k.cell.getRange().left===F.topLeft.left&&k.cell.getRange().bottom===F.topLeft.bottom&&k.cell.getRange().right===F.topLeft.right?!0:!1};gc.prototype.Ayi=function(k,F){F=this.epf(k,F);if(this.pzb&&(!F||0==F.length))return!1;for(var X=0;X<F.length;X++)F[X].t7(2,!0),this.e3(this.f5(F[X]),!0,8,k.scenario,
"merge");return!0};gc.prototype.epf=function(k,F){var X=k.GQ,ra=ff.g(this.$).lc(F[0]),ab=null,Qb=null;this.Igc&&(ab=this.jYh(ra),Qb=this.kYh(ra));var Fc=this.TUh(X,ra,F[0],k);if(this.pzb&&(!Fc||0==Fc.length))return Fc;ff.g(this.$).Ea.i$(F[0],this.$.activeItemName).kcg(F[0],!0);this.e3(this.f5(ra),!0,9,k.scenario,"merge");if(this.Igc&&this.xmd(k))for(F=this.APh(X,F[0]),X=Gl(Fc),ra=X.next();!ra.done;ra=X.next())this.L1h(k,ra.value,ab,Qb,F);return Fc};gc.prototype.LJg=function(k,F,X){var ra=this;if(!(1>
k.Borders.length)){var ab=this.zZ(k.Borders);X.forEach(function(Qb){Qb=ff.g(ra.$).lc(Qb.getRange());ra.Sg.I2f(-1690267012,Qb,ab,!1,null,!1,F)})}};gc.prototype.aNj=function(k,F,X){for(var ra=k.length,ab=0;ab<ra;ab++){k[ab].cell.ZBc();var Qb=k[ab].cell.getRange(),Fc=ff.g(this.$).Ea.Vua(Qb),ld=Fc.length;if(-167499203===F&&this.Hgc){var ud=0;2===k[ab].cell.qGd||1===k[ab].cell.hM?ud=3:2===k[ab].cell.hM&&(ud=1);k[ab].t7(ud,!1)}for(ud=1;ud<ld;ud++)Fc[ud].attachCellToModel(),Fc[ud].aqb(k[ab]),-167499203===
F&&this.Hgc&&Fc[ud].t7(null,!1);this.Zgf&&X&&this.LJg(X[ab],Qb,Fc)}};gc.prototype.LVe=function(k,F){for(var X=null,ra=0;ra<k.length;ra++)if(k[ra].BorderPosition===F){X=k[ra];break}return X};gc.prototype.gIh=function(k,F){var X=k.cell.BM();k.LKa()&&k.cell.YPa(1);k.OKa()&&k.cell.YPa(3);k=this.Bx.LQ(F,0);if(k[0].LKa){var ra=k[0].BM().Borders;ra=this.LVe(ra,1);ra.BorderPosition=0;X.Borders.push(ra);k.forEach(function(ab){ab.YPa(1)})}F=this.Bx.LQ(F,2);F[0].OKa&&(k=F[0].BM().Borders,k=this.LVe(k,3),k.BorderPosition=
2,X.Borders.push(k),F.forEach(function(ab){ab.YPa(3)}));return X};gc.prototype.mag=function(k,F,X){var ra=ff.g(this.$).Ea.mva(F[0],this.$.activeItemName),ab=ff.g(this.$).Ea.i$(F[0],this.$.activeItemName),Qb=[];if(void 0!==ra&&null!==ra&&(F=ff.g(this.$).tja(F[0],ra),void 0!==F&&null!==F)){F=F.$$ge();for(ra=[];F.$$mn();){var Fc=F.$$cu();if(Fc.hF){Qb.push(Fc);this.e3(this.f5(Fc),!0,10,k,"unmerge");Fc.cell.DXg();var ld=Fc.cell.getRange();this.e3(this.f5(Fc),!1,11,k,"unmerge");ab.kcg(ld,!1);this.Zgf&&
(Fc=this.gIh(Fc,ld),ra.push(Fc))}}0<Qb.length&&(ab.Df.resetCellLookup(),this.aNj(Qb,X,ra))}};gc.prototype.e3=function(k,F,X,ra,ab){if(!this.Ycf)return!1;k!==F&&Wd.ULS.sendTraceTag(526149323,0,50,"Merge Information for resultant cell is unexpectedly changed at step: {0}; Scenario: {1}; Command: {2}; Expected: {3}; Actual: {4}",X,ra,ab,F?"populated":"empty",k?"populated":"empty");return k};gc.prototype.f5=function(k){return!!k.cell.cell.Merge};Object(ie.a)(gc,"MergeCellCommandAction",null,[]);var Wk=
b(105),Ug=b(490),nj=b(394),tl=b(904),Ti=b(354);Jd.prototype.Ehi=function(k){return 1896159024===k||-1554384558===k||-1113896058===k||1554436520===k||1415868706===k||674605324===k||1035996630===k};Jd.prototype.$c=function(k,F){return 2054778433===F&&k&1?!Mi.a(this.$).whc:600686207===F?!1:this.Ehi(F)&&Bg.a.any(this.gridView.ha.ta.selectedRanges,function(X){return X.hf||X.isRow})&&!this.Tff&&!this.Off?!0:this.Qhc(k,F)};Jd.prototype.executeCommand=function(k,F,X){return this.Wb(F,X)};Jd.prototype.Mc=
function(k,F,X){if(k=1===k)switch(F.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:k=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:k=
!!X;break;case 862825906:case 1532790410:case 46555851:case -1522760979:k=!0;break;default:k=!1}return k};Jd.prototype.jd=function(k,F,X){switch(F){case "PopulateFontColor":X.MenuItems=this.yB.oac(1970784898,-803000997,null,-128950598,2036397036,1688184685,862825906,X.MenuId);break;case "PopulateFillColor":X.MenuItems=this.yB.oac(1650812936,null,87208751,673562736,1457172838,-446735083,1532790410,X.MenuId);break;case "PopulateBorderColor":X.MenuItems=this.yB.oac(-236759591,-1803452024,void 0,void 0,
void 0,void 0,46555851,X.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.d2h(X);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.iu&&(this.Oad.ypj(X.MenuId),!this.Oad.Bgi()))return!1;X.MenuItems=this.Oad.eVe(-1293291468,324978188,-1428968098,X.MenuId);break;default:return!1}return!0};Jd.prototype.Qhc=function(k,F){var X=ff.g(this.$).ha.ta.selectedRanges;return!(new ri.a(this.$.xa)).Nm(k,F,X,this.gridView)};Jd.prototype.Wb=function(k,F){var X=this,ra=this.gridView,
ab=k.command,Qb=Ud.TaskExtensions.sk(),Fc=!0;switch(ab){case -1077965542:Fc=this.J4e(F,k,!1);break;case 909774670:this.hpb(ab);Fc=this.J4e(F,k,!0);break;case -1293291468:Fc=this.H4e(F,k,!1);break;case 324978188:ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Wd.ULS.sendTraceTag(574650248,0,50,"GridCommandHandler.HandleRibbonCommand: Handle font name preview");this.hpb(ab);Fc=this.H4e(F,k,!0);break;case 862890474:case 963349338:Fc=this.z1h(k);break;case -1832800737:Fc=
this.Ncc(ab,F,!1,k);break;case 1970784898:Fc=this.Ncc(ab,F,!1,k);break;case -803000997:Fc=this.Ncc(ab,F,!1,k);break;case -128950598:case 1688184685:this.hpb(ab);Fc=this.Ncc(ab,F,!0,k);break;case 1597684571:Fc=this.pwb(ab,F,!1,k);break;case 87208751:F.Color="-1";F.IntColor=!0;Fc=this.pwb(ab,F,!1,k);break;case -446735083:this.hpb(ab);F.Color="-1";F.IntColor=!0;Fc=this.pwb(ab,F,!0,k);break;case 1650812936:Fc=this.pwb(ab,F,!1,k);break;case 673562736:this.hpb(ab);Fc=this.pwb(ab,F,!0,k);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
(k=bh.b().ri(ab),Wd.ULS.sendTraceTag(537159510,0,50,"GridCommandHandler.HandleRibbonCommand: Handle {0}",k));this.ISf(ab);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:Fc=this.j1h(ab,k);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:Fc=this.r0h(ab,k);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:Fc=this.Z1h(ab,k);break;case -1803452024:case -236759591:Fc=
this.vhd(ab,F,k);break;case -2118943501:Fc=this.borderFormatManager.C0h(F,k);break;case 1012765228:Fc=this.borderFormatManager.r2h(F,k);break;case 1256700402:Fc=this.borderFormatManager.Ahd(k);break;case -1756763834:Fc=this.borderFormatManager.Bhd(k);break;case -1418159950:Fc=this.borderFormatManager.v4e(k);break;case -1920201820:case -1942512156:Fc=this.A1h(ab,k);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:Fc=this.borderFormatManager.i4e(F,k);this.Wyh(F);
break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:Fc=this.V1h(ab,F,k);break;case -693675336:case 322710748:break;case 1696566924:Fc=this.k1h(k);break;case -167499203:case -255094134:case 1097660126:case 155820588:Qb=this.handleMergeCellsCommand(this.gridView,k);break;case 1896159024:case -1554384558:F=this.gridView.ha.ta.selectedRanges;if(this.dwj(k,F))Wd.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new Xc(this.$,
ab,F)).Ug(),Fc=!0;else if(Bg.a.any(F,function(ud){return X.gridView.Nb.Twa(ud)})){ra="";Qb=1461300262;var ld=-1554384558===ab&&this.gridView.Nb.Gji(F[0]);F=F[0].height>F[0].width&&!ld;switch(ab){case 1896159024:ra=F?"InsertColumnsTable":"InsertRowsTable";Qb=F?622604322:942362098;break;case -1554384558:ra=F?"DeleteColumnsTable":"DeleteRowsTable",Qb=F?284490184:1405456548}F=ji.a.mq(Jd.Cld,ra,1);new jh.a(Qb,1,2,6,null);Qb=this.insertOrDeleteCells(F,k,!0)}else Qb=this.insertOrDeleteCells(1896159024===
ab?1:2,k,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:Qb=this.insertOrDeleteCells(ji.a.mq(Jd.Cld,F[Sf.a.kd],1),k,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:Qb=this.insertOrDeleteCells(ji.a.mq(Jd.Cld,F[Sf.a.kd],1),k,!1);break;case 504848446:Qb=ra.startEdit(!1,1,F[We.a.event],void 0,void 0,!0);break;case 1504715724:if(ff.g(this.$).wz&&this.borderFormatManager.WU.mB)break;Qb=ra.startEdit(!0,0,F[We.a.event],void 0,void 0,!0);break;
case 1872288872:this.Wpb();break;case 41465729:Qb=this.fill(ra.ha.ta.qd,null,0,1,k);break;case -1451655532:case 1972143101:Qb=this.fillDownAbsoluteValueAndStartEdit(ra,F[We.a.event],-1451655532===ab);break;case -475861485:Qb=this.fill(ra.ha.ta.qd,null,ra.rtl?1:2,1,k);break;case -978843926:Qb=this.fill(ra.ha.ta.qd,null,3,1,k);break;case 2098035706:Qb=this.fill(ra.ha.ta.qd,null,ra.rtl?2:1,1,k);break;case -2142700828:Qb=this.fill(ra.ha.sourceRange,ra.ha.ta.qd,Jd.tYe(ra.ha.ta.qd,ra.ha.sourceRange),2,
k);break;case 1405660955:Qb=this.fill(ra.ha.sourceRange,ra.ha.ta.qd,Jd.tYe(ra.ha.ta.qd,ra.ha.sourceRange),4,k);break;case 1983983164:Qb=this.fill(ra.ha.ta.qd,null,0,0,k);break;case 478842689:(k=this.$.da.za(376))?(k.R1i(),Fc=!0):Wd.ULS.sendTraceTag(537159509,0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:Fc=ra.ha.Wb(null,ab);break;case -208772570:this.R1h();Fc=
!0;break;case -987339782:this.K0h();Fc=!0;break;case -1770246794:ra.ha.L0h();Fc=!0;break;case 748067091:case -381232414:this.O0h(ab);Fc=!0;break;case -1522760979:this.gridView.toggleFormulaView();Fc=!0;break;case 886009118:Qb=this.x1h();break;case 894341014:this.C1h();Fc=!0;break;case 862825906:Qb=this.Y4e(1970784898,k);break;case 1532790410:Qb=this.Y4e(1650812936,k);break;case 46555851:Qb=this.N1h(k);break;default:Fc=!1}Fc||(Qb=Rg.a(ab));return Qb};Jd.prototype.Wyh=function(k){k&&k.MenuItemId&&["OutsideBorders",
"AllBorders","ThickOutsideBorders"].includes(k.MenuItemId)&&ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.gOg(new Ti.a(this.gridView.ha.ta.activeRange,hi.d(this.$.xa.qa)))};Jd.prototype.gOg=function(k){Ud.TaskExtensions.Ba(eh.GetServiceTaskFactory.Xa(this.$.da,426,427,1),function(F){F.result.kWd(k,"BorderActions")},this.$.la,3)};Jd.prototype.dwj=function(k,F){var X=this,ra=Bg.a.all(F,function(Fc){return!X.gridView.Nb.Twa(Fc)}),
ab=1<F.length&&!!this.gridView.Nb.qgd(F),Qb=Bg.a.all(F,function(Fc){return!X.gridView.Nb.Ika(Fc)});F=!Bg.a.any(F,function(Fc){return Fc.isRow||Fc.hf});return 1===k.method&&6===k.Ze&&(ra||ab)&&Qb&&F};Jd.prototype.fillDownAbsoluteValueAndStartEdit=function(k,F,X){var ra=this,ab=k.ha.ta.activeCell,Qb=vd.E(ab,this.gridView.Ls);return k.startEdit(!0,0,F).CWR(function(){var Fc=k.lc(Qb),ld=k.lc(ab);if(!Fc||!ld)return Wd.ULS.shipAssertTag(537159507,0,!1,"GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: {0} and above cell: {1}",
ab.toString(),Qb.toString()),Xf.Task.Sa(!1);ra.gridView.pc.text=X?Fc.c1:Fc.text;ra.gridView.pc.textBox.setCaretPositionToEnd();return Xf.Task.Sa(!0)})};Jd.prototype.insertOrDeleteCells=function(k,F,X){function ra(){return new Nd(jd)}var ab=this,Qb=ii.a.create().toString(),Fc=Enum.toString(Ek,k);this.gridView.Ii.I7(17,Qb,Fc);Fc=this.gridView.ha.ta.selectedRanges;var ld=this.Tff,ud=this.Off;if(!this.$.Aq(null,!1,void 0,F.Ze)&&!ud&&!ld&&5!==k&&9!==k)return Xf.Task.Sa(!0);2===k?k=ud?10:ld?6:Fc[0].height>
Fc[0].width?18:34:1===k?k=ud?9:ld?5:Fc[0].height>Fc[0].width?17:33:18===k&&ld?k=34:34===k&&ud&&(k=18);Fc=this.FHg(Fc,k);if((10===k||6===k)&&!this.$.Aq(Fc,!0,1,F.Ze))return Xf.Task.Sa(!0);var jd={};jd.InsertDeleteRangeItems=Array(Fc.length);jd.SheetName=this.$.qa.sheetName;jd.IsTableCommand=X;for(X=0;X<Fc.length;X++){ld=Fc[X];var Ye={},Bf=ud=void 0;k&4?(Ye.FirstRow=ld.top-1,Ye.LastRow=ih.a.ny,Ye.FirstColumn=0,Ye.LastColumn=ih.a.mv,ud=ld.bottom-ld.top+1,Bf=0,6===k&&(ld.hf||(Ye.FirstRow=ld.bottom),ud=
-ud)):k&8?(Ye.FirstRow=0,Ye.LastRow=ih.a.ny,Ye.FirstColumn=ld.left-1,Ye.LastColumn=ih.a.mv,ud=0,Bf=ld.right-ld.left+1,10===k&&(ld.isRow||(Ye.FirstColumn=ld.right),Bf=-Bf)):k&16?(Ye.FirstRow=ld.top-1,Ye.LastRow=ld.bottom-1,Ye.FirstColumn=ld.left-1,Ye.LastColumn=ih.a.mv,ud=0,Bf=ld.right-ld.left+1,18===k&&(Ye.FirstColumn=ld.right,Bf=-Bf)):(Ye.FirstRow=ld.top-1,Ye.LastRow=ih.a.ny,Ye.FirstColumn=ld.left-1,Ye.LastColumn=ld.right-1,ud=ld.bottom-ld.top+1,Bf=0,34===k&&(Ye.FirstRow=ld.bottom,ud=-ud));Ye={InsertDeleteRange:Ye};
Ye.DeltaRow=ud;Ye.DeltaColumn=Bf;Ye.AdjustedSelectedRange=vd.j(ld);jd.InsertDeleteRangeItems[X]=Ye}this.gridView.ug.SG(!1);var Tg=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");jd.IsDecoupleRecalc=Tg;var $g=this.$.na.va.hc();return rh.a(this.$.userOperationManager,function(Wg,qh,Ri){Tg&&!ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||ab.$.By();var ci=ab.$.na.va;Wg=hh.b(Wg,ab.ILi);var Tf=ci.Na(41,void 0===$g?null:$g);Tf.insertDeleteMultiRangeParameters=
jd;return Yg.i(ci,"InsertDeleteCells",Tf,Wg,qh,Ri,Qb,0)},function(Wg){return new cg.a(237,0,Wg,void 0,ra)},F)};Jd.prototype.FHg=function(k,F){return F&32?this.MYa(k,function(X){return X.bottom},function(X){return X.top},function(X,ra){X.bottom=ra},!1,!0):F&16?this.gridView.rtl?this.MYa(k,function(X){return X.left},function(X){return X.right},function(X,ra){X.left=ra},!1,!1):this.MYa(k,function(X){return X.right},function(X){return X.left},function(X,ra){X.right=ra},!1,!1):F&4?this.MYa(k,function(X){return X.bottom},
function(X){return X.top},function(X,ra){X.bottom=ra},!0,!0):F&8?this.gridView.rtl?this.MYa(k,function(X){return X.left},function(X){return X.right},function(X,ra){X.left=ra},!0,!1):this.MYa(k,function(X){return X.right},function(X){return X.left},function(X,ra){X.right=ra},!0,!1):k};Jd.prototype.MYa=function(k,F,X,ra,ab,Qb){k=vd.d(k);k.sort(function(ud,jd){return F(jd)-F(ud)});if(ab){ab=[];Qb=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5181014_DeletingLastTwoRowsColsFix")?Qb?ih.a.Hh+1:ih.a.Rh+
1:Qb?ih.a.ny:ih.a.mv;for(var Fc=0;Fc<k.length;Fc++){var ld=k[Fc];X(ld)<Qb&&(ra(ld,Math.min(F(ld),Qb-1)),ab.push(ld),Qb=X(ld))}k=ab}return k};Jd.prototype.fill=function(k,F,X,ra,ab){function Qb(){return new Md(ud,jd,ra,X)}var Fc=this,ld=this.$;if(!ld.Aq([F],!0))return Xf.Task.Sa(!0);var ud=vd.v(k,ld),jd=F?vd.v(F,ld):ud,Ye=this.$.na.va.hc();return rh.a(this.$.userOperationManager,function(Bf,Tg,$g){Fc.$.By();var Wg=Fc.$.na.va,qh=Wg.Na(9,Ye);qh.sourceRange=ud;qh.targetRange=jd;qh.fillDirection=X;qh.fillType=
ra;return Yg.i(Wg,"FillRange",qh,Bf,Tg,$g,null,0)},function(Bf){return new cg.a(155,0,Bf,void 0,Qb)},ab)};Jd.prototype.V1h=function(k,F,X){var ra={ValidMembers:32};switch(k){case 1890566896:k=parseInt(F[Sf.a.kd].toString(),10);if(14===k)return X=new jh.a(2105621672,X.method,X.mode,X.Ze,X.tabName),F[Sf.a.kd]=null,this.$.Ka.Wb(X,F),Wd.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;ra.NumberFormat=k;break;case 1886928607:ra.NumberFormat=
13;break;case -992833457:ra.NumberFormat=11;break;case 218524921:ra.NumberFormat=12;break;case 996232352:ra.NumberFormat=1006;break;default:return Wd.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+bh.b().ri(X.command)),!1}Wd.ULS.sendTraceTag(537159504,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered {0} command, with menu item {1}.",bh.b().ri(X.command),F[Sf.a.kd]);this.Sg.formatCells(1890566896,ra,X);this.$.Bf();return!0};Jd.prototype.z1h=function(k){var F=
this.gridView.lc(this.gridView.ha.ta.activeCell);if(this.Gb&&this.gridView.isEditing){F=this.gridView.Nj.D3a(F?Di.a(F).Font:null);if(!F)return Wd.ULS.shipAssertTag(537159503,0,!1,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range {0} is null while editing",this.gridView.ha.ta.activeCell.toString()),!1;var X=F.FontSize}else if(F)X=F.fontSize;else return!1;F=k.command;var ra=0;if(862890474===F)for(;ra<Jd.pJa.length-1&&Jd.pJa[ra]<=X;)ra++;else if(963349338===F)for(ra=Jd.pJa.length-
1;0<ra&&Jd.pJa[ra]>=X;)ra--;Wd.ULS.sendTraceTag(537159501,0,50,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size {0} to size {1}",X,Jd.pJa[ra]);if(X===Jd.pJa[ra])return!0;X=Jd.Fvc(2);X.Font.FontSize=Jd.pJa[ra];this.Gb&&this.gridView.isEditing?(this.Mnb(k,!1,X),this.$.Bf()):this.Sg.formatCells(F,X,k);return!0};Jd.prototype.J4e=function(k,F,X){k=k[k[Nj.a.IsFreeForm]?Nj.a.Value:Sf.a.pg].toString();if(!Jd.kYi.test(k))return Wd.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),
ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;k=parseFloat(k);if(8>k||72<k)return Wd.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits ({0} - {1}).",8,72),ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;var ra=Math.round(2*k)/2,ab=Jd.Fvc(2);ab.Font.FontSize=ra;this.Gb&&this.gridView.isEditing?(this.Mnb(F,X,ab,
!0),ra===k||X||this.$.Bf()):X?this.Sg.Sda(this.gridView,-1077965542,ab,X):(this.Sg.formatCells(-1077965542,ab,F),this.E_a());return!0};Jd.prototype.H4e=function(k,F,X){var ra=k[Sf.a.pg];if(this.iu){var ab=md.C6f?md.C6f[ra]:null;ab||(Wd.ULS.sendTraceTag(523903201,1,15,"GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for {0}",ra),ab=Sc.HelperMethods.eea[ra])}else ab=Sc.HelperMethods.eea[ra];var Qb=0;this.Om&&(k=k.MenuItemId,"MinorThemeFont"===k?(ra==this.themesManager.kL.Apf&&
(ab=ra),Qb=2):"MajorThemeFont"===k&&(ra==this.themesManager.kL.Xnf&&(ab=ra),Qb=1));if(!ab)return!0;ra=Jd.Fvc(1);ra.Font.FontName=ab;this.Om&&(ra.Font.FontScheme=Qb);this.Gb&&this.gridView.isEditing?(this.Mnb(F,X,ra),this.$.Bf()):X?this.Sg.Sda(this.gridView,-1293291468,ra,X):(this.Sg.formatCells(-1293291468,ra,F),this.E_a());return!0};Jd.prototype.Ncc=function(k,F,X,ra){var ab=-803000997===k||1688184685===k?"black":F.Color;this.moreColorsHelper&&(-1832800737===k?ab=Z.a.compare(ab,"WindowText",!0)?
this.moreColorsHelper.$Gb:"black":X||(this.moreColorsHelper.$Gb=ab,this.moreColorsHelper.$ca(F,ab,ra)));k=Jd.Fvc(32);k.Font.FontColor=Zg.a.gH(ab,ji.a.Kg(F,"IntColor"));this.Gb&&this.gridView.isEditing?this.Mnb(ra,X,k,17===ra.Ze):X?this.Sg.Sda(this.gridView,1970784898,k,X):(this.TC&&(X=this.getThemeColor(F),F=X.themeColor,X.returnValue&&(k.Font.ThemeFontColor=F,k.Font.ColorTypeOption=1)),this.Sg.formatCells(1970784898,k,ra),this.E_a());return!0};Jd.prototype.O0h=function(k){var F=(new Date).format(748067091===
k?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat),X=this.gridView.Bj?rk.a(this.gridView.$):this.gridView.pc;k=X.textBox;if(this.gridView.isEditing)X.insertText(F);else{var ra=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6336696_ChangeEditingModeAfterInsertDateOrTime")?0:1;this.gridView.startEdit(!0,ra);X.text=F;F=F.length;k.fRa(F);k.caretPosition=F}};Jd.prototype.R1h=function(){this.gridView.i_(this.gridView.ha.ta.activeCell)||this.gridView.bvc||this.gridView.rMa()||this.gridView.jt(this.gridView.ha.ta.activeCell,
3,Wk.a.U3e)};Jd.prototype.K0h=function(){if(!(this.gridView.bvc||this.gridView.rMa()||this.gridView.isEditing&&mj.a.isMac)){var k=this.gridView.ha.ta.r4;this.gridView.Gg(vd.v(k,this.$),k,null,null,60,Wk.a.U3e)}};Jd.prototype.k1h=function(k){var F=this;this.k$b=hi.d(this.$.xa.qa);var X=this.$.da.za(254,!0);if(this.gridView.Z5a)return this.gridView.ug.SG(!1),!!X;if(!X)return Wd.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.yY(this.dbd);
var ra=String.format(We.a.Dta,uh.a.current.hp(85));this.gridView.ug.Jo(ra);k=new jh.a(-911352779,k.method,k.mode,k.Ze,k.tabName);ra={};this.$.Ka.Wb(k,(ra[We.a.silentClipboardAccessFailures]=!0,ra[We.a.isFormatPainter]=!0,ra)).continueWith(function(ab){(6>ab.status||6===ab.status&&!ab.result)&&F.Wpb()});this.gridView.Z5a=!0;X.EFg(this.Wpb);return!0};Jd.prototype.pwb=function(k,F,X,ra){var ab=87208751===k?"-1":F.Color;this.moreColorsHelper&&(1597684571===k?ab=this.moreColorsHelper.xab:X||(this.moreColorsHelper.xab=
ab===Jd.notSet?Jd.eWd:ab,this.moreColorsHelper.$ca(F,ab,ra)));k={ValidMembers:64};k.FillColor=Zg.a.gH(ab,ji.a.Kg(F,"IntColor"));X?this.Sg.Sda(this.gridView,1650812936,k,!0):(this.TC&&(X=this.getThemeColor(F),F=X.themeColor,X.returnValue&&(k.ThemeFillColor=F,k.ColorTypeOption=1)),this.Sg.formatCells(1650812936,k,ra),this.E_a());return!0};Jd.prototype.C1h=function(){Wd.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");var k=this.$.da.za(221);
if(k){var F=this.gridView.Nj;if(F){var X=k.Fai(F.text,F.textBox.caretPosition);var ra=X.Kqf;var ab=X.aTe;(X=X.returnValue)?(k.isListVisible=!1,F.text=X,F.textBox.selectRange(ra,ra+ab),Wd.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):Wd.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else Wd.ULS.shipAssertTag(537159491,
0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else Wd.ULS.sendTraceTag(537159492,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")};Jd.prototype.j1h=function(k,F){var X=0,ra=this.gridView,ab=Di.a(ra.lc(null));this.Gb&&ra.isEditing&&(ab.Font=ra.Nj.D3a(ab.Font));var Qb=ab.Font;Qb||(Qb={ValidMembers:0});switch(k){case -287251124:X|=4;Dj.e(Qb,4)?Qb.Bold=!Qb.Bold:Qb.Bold=!0;break;case -1925065947:X|=8;Dj.e(Qb,8)?Qb.Italic=
!Qb.Italic:Qb.Italic=!0;break;case 1764140053:X|=16;Dj.e(Qb,16)?Qb.Underline=!Qb.Underline:Qb.Underline=!0;break;case -1685033574:X|=64;Dj.e(Qb,64)?Qb.DoubleUnderline=!Qb.DoubleUnderline:Qb.DoubleUnderline=!0;break;case -1590502662:X|=128,Dj.e(Qb,128)?Qb.Strikethrough=!Qb.Strikethrough:Qb.Strikethrough=!0}if(!X)return!1;Qb.ValidMembers=X;ab.Font=Qb;ab.ValidMembers=16;this.Gb&&this.gridView.isEditing?this.Mnb(F,!1,ab):(ve.EwaSettings.ma(657)||ra.ug.SG(!1),this.Sg.formatCells(k,ab,F));this.$.Bf();return!0};
Jd.prototype.r0h=function(k,F){var X=0,ra=this.gridView,ab=Di.a(ra.lc(null));-571165336===k||1041132226===k||-394785302===k?(X|=1,ab.VerticalAlignment=ji.a.mq(Jd.RYa,k.toString(),2)):Jd.ohi(k)?(X|=2,this.u1h(ab,k)):-1116189897===k&&(X|=8,ab.Wrap=ab.ValidMembers&8?!ab.Wrap:!0);if(!X)return!1;ab.ValidMembers=X;ve.EwaSettings.ma(657)||ra.ug.SG(!1);this.Sg.formatCells(k,ab,F);this.$.Bf();return!0};Jd.prototype.u1h=function(k,F){!ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&
this.$.isChromeRtl&&-1142465846!==F&&(F=-1150205178===F?-286432209:-1150205178);F=ji.a.mq(Jd.RYa,F.toString(),0);k.HorizontalAlignment=F===k.HorizontalAlignment?0:F};Jd.prototype.xIf=function(k,F,X,ra){var ab=this,Qb=!1;ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(Qb=this.Ykc.dpf(F,X))&&ff.g(this.$).Ii.N0(this.x8a,Wc.BasicTelemetryCalculator.aR);return ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?
this.faa(k,F,!1,Qb,function(Fc){ab.RMi(Fc,X,F,Qb,ra)}):this.faa(k,F,!1,Qb,function(Fc,ld,ud){ab.UMi(Fc,ld,ud,X,F,Qb,ra)})};Jd.prototype.handleMergeCellsCommand=function(k,F){var X=this;this.x8a=ii.a.create().toString();var ra=null;ra=this.Ykc.c_e();var ab=qk.a(F.command),Qb=this.Ykc.hfi(F.command,ra),Fc=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario"),ld=0;Fc&&Qb?ld=be.a.Ce():ff.g(this.$).Ii.I7(4,this.x8a,ab+", Scenario = "+ra.scenario.toString());ab=
k.ha.ta.selectedRanges;Wd.ULS.sendTraceTag(537159459,0,50,"GridCommandHandler.HandleMergeCellsCommand: Merge Command: {0}, Number of ranges: {1}, Ranges: {2}",bh.b().ri(F.command),ab.length,vd.i(ab,",",this.$,!1));ab=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);k.ug.SG(!1,ab);if(10===ji.a.mq(Jd.fpf,F.command.toString(),10))return Xf.Task.Sa(!1);var ud=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(ab&&
ud)return Qb?(Fc?this.kRd(ra,F,!0,!0,ld):this.kRd(ra,F,!0),Xf.Task.Sa(!0)):this.xIf(k,F,ra,!1);var jd=!1;ab&&(jd=this.Ykc.dpf(F,ra))&&ff.g(this.$).Ii.N0(this.x8a,Wc.BasicTelemetryCalculator.aR);return ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?this.faa(k,F,!1,jd,function(Ye){X.TMi(Ye,F,jd)}):this.faa(k,F,!1,jd,function(Ye,Bf,Tg){X.VMi(Ye,Bf,Tg,F,jd)})};Jd.prototype.faa=function(k,F,X,ra,ab){function Qb(Tg,$g,Wg){ud.$.By();
Tg=ab?hh.b(Tg,ab):Tg;Tg=hh.b(Tg,Fc);return Yg.f(ud.$.na.va,Ye,Bf,X,Tg,$g,Wg,null,jd)}function Fc(Tg){var $g=!!Tg&&!!Tg.RequestTelemetryData;ff.g(ud.$).Ii.qla(ud.x8a,Tg.StateId,$g?Tg.RequestTelemetryData.EcsOperationDuration:0,$g?Tg.RequestTelemetryData.EcsRequestDuration:0,$g?Tg.RequestTelemetryData.WfeRequestDuration:0)}function ld(){return new Od(Ye,Bf)}var ud=this;ab=void 0===ab?null:ab;var jd=this.$.na.va.hc(),Ye=ji.a.mq(Jd.fpf,F.command.toString(),10),Bf=vd.r(k.ha.ta.selectedRanges,k.$);return ra?
ve.EwaSettings.qc()?rh.a(this.$.userOperationManager,Qb,function(Tg){return new cg.a(156,0,Tg,64,ld)},F):rh.a(this.$.userOperationManager,Qb,function(Tg){return new vf.a(156,0,Tg,void 0,ld)},F):rh.a(this.$.userOperationManager,Qb,function(Tg){return new cg.a(156,0,Tg,void 0,ld)},F)};Jd.prototype.kRd=function(k,F,X,ra,ab){var Qb=this;ra=void 0===ra?!1:ra;ab=void 0===ab?0:ab;Wd.ULS.sendTraceTag(537159457,0,50,"Merge cells with multiple values. isCalledBeforeCSE :- {0}",X);var Fc=ff.g(this.$).rtl,ld=
ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario");Fc=Vf.a.gd(3,2,0,Fc?637:636,0,514846606,"MergeCellsLoseData");Ud.TaskExtensions.Ba(Uh.a(this.$).si(Fc),function(ud){ud=ud.result;if(ra){var jd=be.a.Ce()-ab;Wd.ULS.sendTraceTag(528779355,0,50,"Time taken to show Dialog in Data Loss Scenario is : {0}, and the user action is : {1}",jd,ud)}0===ud?(Wd.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),X?(ra&&ld&&(ud=qk.a(F.command),ff.g(Qb.$).Ii.I7(4,
Qb.x8a,ud+", Scenario = "+k.scenario.toString())),Qb.xIf(ff.g(Qb.$),F,k,!0)):Qb.faa(Qb.gridView,F,!0,!1)):1===ud&&Wd.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11)};Jd.prototype.Vkf=function(k,F,X,ra){F!==k&&Wd.ULS.sendTraceTag(537159454,0,15,"MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- {0} and as per server is {1}. The scenario is:- {2}, The CSE is done:- {3}",F,k,X,ra)};Jd.prototype.TMi=
function(k,F,X){var ra=this;qc.b(k,514846606)&&(Wd.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),zk.a(this.$).ud.bE(514846606),k=ff.g(this.$).rtl,k=Vf.a.gd(3,2,0,k?637:636,0,514846606,"MergeCellsLoseData"),Ud.TaskExtensions.Ba(Uh.a(this.$).si(k),function(ab){ab=ab.result;0===ab?(Wd.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),ra.faa(ra.gridView,F,!0,X)):1===ab&&Wd.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,
11))};Jd.prototype.VMi=function(k,F,X,ra,ab){new Cd(this,k,F,X,ra,ab)};Jd.prototype.RMi=function(k,F,X,ra,ab){var Qb=this,Fc=!1;qc.b(k,514846606)&&(Fc=!0,zk.a(this.$).ud.bE(514846606),ra&&ab?window.setTimeout(function(){Qb.faa(Qb.gridView,X,!0,!0)},0):this.kRd(F,X,!1));this.Vkf(Fc,ab,F.scenario,ra)};Jd.prototype.UMi=function(k,F,X,ra,ab,Qb,Fc){new Sb(this,k,F,X,ra,ab,Qb,Fc)};Jd.prototype.hpb=function(k){var F=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");if(F&&
this.b_a!==k&&1461300262!==this.b_a){this.ISf(this.b_a);var X=bh.b().ri(k),ra=bh.b().ri(this.b_a);Wd.ULS.sendTraceTag(537159450,0,50,"GridCommandHandler.CacheFontStyles: Style cached during {0} was restored before caching the style for {1} command.",ra,X)}F&&(this.b_a=k);if(this.Gb&&this.gridView.isEditing)this.ZZa||(this.ZZa=this.gridView.Nj.formattedText);else if(!this.QA){this.QA=[];F=this.gridView.N$("GridCommandHandler.CacheFontStyles",this.gridView.ha.ta.selectedRanges);try{for(F.$$rst();F.$$mn();){var ab=
F.$$cu(),Qb=ab.cell.hasRichText;if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Fc=bh.b().ri(k);Wd.ULS.sendTraceTag(537159449,0,100,"GridCommandHandler.CacheFontStyles: Add CachedPreviewCellGroup following {0} command. isRichText({1}). Cache size is {2}",Fc,Qb,this.QA.length)}if(Qb)this.QA.push(Mc.AQg(ab,ab.cell.formattedText));else switch(k){case 673562736:case -446735083:this.QA.push(Mc.HYc(ab,ab.backgroundColor));ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
!ab.backgroundColor&&Wd.ULS.sendTraceTag(537159448,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null BackgroundColor. isNull({0})",!ab.backgroundColor);break;case -128950598:case 1688184685:this.QA.push(Mc.HYc(ab,ab.color));ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!ab.color&&Wd.ULS.sendTraceTag(537159447,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null Color. isNull({0})",!ab.color);break;case 909774670:this.QA.push(Mc.BQg(ab,
ab.fontSize));if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var ld=tl.c(ab.fontSize)?"null or undefined":ab.fontSize.toString();Wd.ULS.sendTraceTag(537159446,0,100,"GridCommandHandler.CacheFontStyles: cached font size is {0}",ld)}break;case 324978188:this.Om?this.QA.push(Mc.zQg(ab,ab.fontName,ab.Daa)):this.QA.push(Mc.HYc(ab,ab.fontName)),ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(ab.fontName?Wd.ULS.sendTraceTag(537159444,
0,50,"GridCommandHandler.CacheFontStyles: cached FontName is ({0}) of length({1}).",gridRenderer.CanvasRendererGlobals.getFontNameForLogging(ab.fontName),ab.fontName.length):Wd.ULS.sendTraceTag(537159445,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null FontName. isNull({0})",!ab.fontName))}}}finally{F&&F.dispose()}}};Jd.prototype.rAj=function(){return this.Gb&&this.gridView.isEditing?!this.ZZa:!this.QA};Jd.prototype.$di=function(k){return!!this.QA&&this.QA.length>k&&!!this.QA[k].formattedText};
Jd.prototype.Z$b=function(k){return this.QA[k].style};Jd.prototype.MIh=function(k){return this.QA[k].size};Jd.prototype.LIh=function(k){return this.QA[k].Daa};Jd.prototype.ISf=function(k){if(this.rAj())ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Wd.ULS.sendTraceTag(537159443,0,100,"GridCommandHandler.RestoreCachedStyles: Nothing to restore following {0} command.",k);else{if(this.Gb&&this.gridView.isEditing)ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
(k=bh.b().ri(k),Wd.ULS.sendTraceTag(537159442,0,50,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. Formatted text is enabledand IsEditing is true.",k)),this.ZZa&&(this.gridView.pc.formattedText=this.ZZa);else for(var F=this.QA.length,X=0;X<F;X++){var ra,ab=this.QA[X].rJa.cell.getRange();if(ra=this.gridView.lc(ab)){ab=void 0;var Qb=ra.hF?this.gridView.xJb(ra.range):(ab=new Ka.a,ab.add(ra),ab);ab=Gl(Qb);for(Qb=ab.next();!Qb.done;Qb=ab.next()){Qb=Qb.value;if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Fc=
bh.b().ri(k);Wd.ULS.sendTraceTag(537159440,0,100,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. formattedCell.Cell.HasRichText({1}). Cached item {2}. isMerge({3}). Cache size is {4}",Fc,Qb.cell.hasRichText,X,ra.hF,F)}if(Qb.cell.hasRichText&&1457172838!==k)this.$di(X)&&(Qb.cell.formattedText=this.QA[X].formattedText,ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Qb.cell.formattedText&&Wd.ULS.sendTraceTag(537159439,0,100,"GridCommandHandler.RestoreCachedStyles: Setting FormattedText to null."));
else switch(k){case 1457172838:Qb.backgroundColor=this.Z$b(X);ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Qb.backgroundColor&&Wd.ULS.sendTraceTag(537159438,0,100,"GridCommandHandler.RestoreCachedStyles: Setting BackgroundColor to be empty or null. isNull({0}).",!Qb.backgroundColor);break;case 2036397036:Qb.color=this.Z$b(X);ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Qb.color&&Wd.ULS.sendTraceTag(537159437,0,100,
"GridCommandHandler.RestoreCachedStyles: Setting Color to be empty or null. isNull({0}).",!Qb.color);break;case -1904244080:Qb.fontSize=this.MIh(X);ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(Qb=tl.c(Qb.fontSize)?"null or undefined":Qb.fontSize.toString(),Wd.ULS.sendTraceTag(537159436,0,100,"GridCommandHandler.RestoreCachedStyles: Setting font size to {0}",Qb));break;case -1428968098:Fc=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation"),
this.Om?(Qb.rKb(this.Z$b(X),Fc,"RestoreCachedStyles"),Qb.EYf(this.LIh(X))):Qb.rKb(this.Z$b(X),Fc,"RestoreCachedStyles")}}}else Wd.ULS.sendTraceTag(537159441,0,50,"GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: {0}",ab.hB(!1))}ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(this.b_a=1461300262);this.E_a()}};Jd.prototype.E_a=function(){this.Gb&&this.gridView.isEditing?this.ZZa=null:this.QA=null;ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
Wd.ULS.sendTraceTag(537159435,0,50,"GridCommandHandler.ClearCachedStyles: Cache cleared.")};Jd.prototype.A1h=function(k,F){var X={IndentationIncrease:0};if(-1942512156===k)X.IndentationIncrease=1;else if(-1920201820===k)X.IndentationIncrease=-1;else return!0;X.ValidMembers=256;this.Sg.formatCells(k,X,F);return!0};Jd.prototype.Z1h=function(k,F){var X=k;!ff.g(this.$).rtl||-1649235364!==k&&524773427!==k||(X=-1649235364===k?524773427:-1649235364);switch(X){case -1649235364:X=ih.a.rotateTextUp45;break;
case 524773427:X=ih.a.euc;break;case 1886217042:X=ih.a.rotateTextUp90;break;case 928057943:X=ih.a.guc;break;case -1526602249:X=ih.a.verticalText;break;default:return!1}var ra={ValidMembers:512};ra.TextOrientation=X;this.Sg.formatCells(k,ra,F);return!0};Jd.prototype.x1h=function(){var k=this,F=ff.g(this.$),X=vd.r(F.ha.ta.selectedRanges,this.$),ra=vd.o(F.ha.ta.activeCell,this.$);Wd.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return rh.a(this.$.userOperationManager,
function(ab,Qb,Fc){return Yg.L(k.$.na.va,ra,X,ab,Qb,Fc,null)},function(ab){return new cg.a(201,0,ab)},null)};Jd.prototype.Y4e=function(k,F){var X=null,ra=ff.g(this.$).ha.ta.selectedRanges;ra=this.gridView.N$("MoreColors",ra,1,!0);try{for(ra.$$rst();ra.$$mn();){var ab=ra.$$cu().cell;if(ab){var Qb=Jd.black;if(1970784898===k)Qb=ab.color;else if(1650812936===k){var Fc=ab.backgroundColor;Qb=Z.a.compare(Fc,Jd.eWd,!0)&&Z.a.compare(Fc,Jd.empty,!0)?ab.backgroundColor:Jd.white}if(!X)X=Qb;else if(X!==Qb){X=
Jd.black;break}}}}finally{ra&&ra.dispose()}this.Gb&&this.gridView.isEditing&&1970784898===k&&this.gridView.Nj.textBox.jte();return this.moreColorsHelper.uxa(k,F,X)};Jd.prototype.N1h=function(k){var F=wg.a.X3a(this.borderFormatManager.y3);return this.moreColorsHelper.uxa(-236759591,k,F)};Jd.prototype.Mnb=function(k,F,X,ra){var ab=this;ra=void 0===ra?!1:ra;F?this.gridView.Nj.zHf(X.Font):(this.Vui(k),ra?window.requestAnimationFrame(function(){fk.FocusManager.instance().fk(Lj.AFrame.pia);ab.gridView.Nj.fUe(X.Font)}):
(fk.FocusManager.instance().fk(Lj.AFrame.pia),this.gridView.Nj.fUe(X.Font)),this.E_a())};Jd.prototype.Vui=function(k){var F=qk.a(k.command);k=bl.a[k.Ze]+"_"+pl.a[k.method];var X=this.gridView.tc.Gwe.toString(),ra=new Map;ra.set("Command",F);ra.set("Source",k);ra.set("Ribbon","React");ra.set("CellTextRuns",X);Xj.Health.instance.recordKpiUsage(nj.a.nCh,0,Ug.a.kTf,ra)};Jd.prototype.vhd=function(k,F,X){k=this.borderFormatManager.vhd(k,F,X);this.moreColorsHelper&&this.moreColorsHelper.$ca(F,this.borderFormatManager.y3,
X);return k};Jd.prototype.getThemeColor=function(k){var F={};var X=!1;if((k.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return Wd.ULS.sendTraceTag(537159433,0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:F};X=this.themesManager.getThemeColor(k.Color);k=X.themeIndex;var ra=X.dBa;if(X=X.returnValue)F.ThemeColorIndex=k,F.ThemeColorRow=ra}return{returnValue:X,themeColor:F}};Jd.ohi=function(k){return-1150205178===k||-1142465846===
k||-286432209===k};Jd.Fvc=function(k){var F={},X={};F.ValidMembers=16;F.Font=X;X.ValidMembers=k;return F};Jd.tYe=function(k,F){var X=k.top<F.top?3:k.bottom>F.bottom?0:-1;return X=k.left<F.left?1:k.right>F.right?2:X};Ck.Object.defineProperties(Jd.prototype,{Tff:{configurable:!0,enumerable:!0,get:function(){return Bg.a.all(this.gridView.ha.ta.selectedRanges,function(k){return k.isRow})}},Off:{configurable:!0,enumerable:!0,get:function(){return Bg.a.all(this.gridView.ha.ta.selectedRanges,function(k){return k.hf})}},
themesManager:{configurable:!0,enumerable:!0,get:function(){this.sx||(this.sx=this.$.da.za(422));return this.sx}}});Ck.Object.defineProperties(Jd,{kYi:{configurable:!0,enumerable:!0,get:function(){return Jd.ide||(Jd.ide=RegExp("^[0-9]+[.]?[0-9]*$"))}},Cld:{configurable:!0,enumerable:!0,get:function(){var k={};return Jd.O7d||(Jd.O7d=(k.InsertRows=5,k.InsertColumns=9,k.InsertCellsShiftRight=17,k.InsertCellsShiftDown=33,k.DeleteRows=6,k.DeleteColumns=10,k.DeleteCellsShiftLeft=18,k.DeleteCellsShiftUp=
34,k.DeleteRowsTable=6,k.DeleteColumnsTable=10,k.InsertRowsTable=5,k.InsertColumnsTable=9,k))}},RYa:{configurable:!0,enumerable:!0,get:function(){var k={};return Jd.pgb||(Jd.pgb=(k["-394785302"]=0,k["-571165336"]=2,k["1041132226"]=1,k["-1150205178"]=1,k["-1142465846"]=2,k["-286432209"]=3,k))}},fpf:{configurable:!0,enumerable:!0,get:function(){var k={};return Jd.Bae||(Jd.Bae=(k["-167499203"]=2,k["-255094134"]=5,k["1097660126"]=6,k["155820588"]=7,k))}}});Jd.eWd="transparent";Jd.notSet="-1";Jd.black=
"#000000";Jd.empty="";Jd.white="#FFFFFF";Jd.O7d=null;Jd.pgb=null;Jd.Bae=null;Jd.ide=null;Jd.pJa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(ie.a)(Jd,"GridCommandHandler",null,[428]);var Qk=bf.a;Wl(zd,Qk);zd.prototype.Od=function(){var k=this;if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){var F=eh.GetServiceTaskFactory.create(this.$.da,111,this.la,this.vb),X=eh.GetServiceTaskFactory.create(this.$.da,18,this.la,this.vb),ra=eh.GetServiceTaskFactory.create(this.$.da,
397,this.la,this.vb),ab=eh.GetServiceTaskFactory.Xa(this.$.da,296,468,this.vb);Ud.TaskExtensions.Ba(Ud.TaskExtensions.te([F,X,ra,ab],this.la),function(){k.Cd([new Jd(k.$,ff.g(k.$),X.result,F.result,ab.result,ra.result,new md(k.$))])},this.la,3)}else{var Qb=eh.GetServiceTaskFactory.create(this.$.da,111,this.la,this.vb),Fc=eh.GetServiceTaskFactory.create(this.$.da,18,this.la,this.vb),ld=eh.GetServiceTaskFactory.create(this.$.da,102,this.la,this.vb),ud=eh.GetServiceTaskFactory.create(this.$.da,397,this.la,
this.vb);Ud.TaskExtensions.Ba(Ud.TaskExtensions.te([Qb,Fc,ld,ud],this.la),function(){k.Cd([new Jd(k.$,ff.g(k.$),Fc.result,Qb.result,new Ok.BorderFormatManager(k.$,Fc.result,ld.result),ud.result,new md(k.$))])},this.la,3)}};zd.ka=function(k){bf.a.ee(80,new zd(k))};Object(ie.a)(zd,"GridCommandHandlerFactory",bf.a,[]);var ik=b(31),hl=b(216),il=b(1258);Qd.prototype.dispose=function(){var k=this;this.deactivate();this.gridView&&(this.tableManager.FPf(this.dAf),this.gridView.I$i(this.sxf),this.gridView.J$i(this.txf),
this.$.xa.Wg(this.Ge),this.$.Hb.Wg(this.Ge),this.Nqe(function(F){F.eJd(k.RKa)}));this.gridView=this.tableManager=this.Ega=null};Qd.prototype.Zzc=function(k,F,X,ra){if(!hi.b(this.$.qa)||this.$.ea.isNamedObjectViewMode||this.gridView.rb.aTa)return!0;if(!X.length)return!1;var ab=ra.length;if(ra[ab-1]<k.left)return!1;var Qb=Sc.HelperMethods.Ax(new hl.a(ra),0,ab,k.left,Sc.HelperMethods.XC);if(0>Qb)return!1;var Fc=k.I8f,ld=!!k.WZa&&0<k.WZa.length,ud=!!k.menuModel&&0<k.menuModel.length,jd=Qb,Ye=0;for(ab=
Math.min(Fc.length+Qb,ab);jd<ab;jd++,Ye++)if(Qb=X[jd],!ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||Qb){var Bf=null,Tg=Qb.getElementsByClassName(ik.a.x9c);Tg&&(Bf=Tg[0]);if(Bf&&Bf.innerText){if(Tg=Qb.getElementsByClassName(ik.a.uoe))for(var $g=Tg.length-1;0<=$g;$g--)Qb.removeChild(Tg[$g]);Tg=ra[jd];F?(Bf.innerText=Fc[Ye],Qb.classList.add(ik.a.OPe),ld&&k.WZa[Ye]&&(Bf=document.createElement("div"),Bf.innerHTML=k.WZa[Ye],ud&&k.menuModel[Ye]&&this.eBg(k,Ye,
Tg),Qb.appendChild(Bf.firstChild))):(Qb.classList.remove(ik.a.OPe),Bf.textContent=hb.Range.YP(Tg),this.rhh(Tg))}}k.coa=F;return!0};Qd.prototype.eBg=function(k,F,X){this.$.da.$a(8,function(ra){ra.t9b.gLi(k,F,X)})};Qd.prototype.rhh=function(k){this.$.da.$a(8,function(F){F.t9b.hLi(k)})};Qd.prototype.o4f=function(k,F,X,ra){for(var ab=!1,Qb=this.KYh(k,F),Fc=this.Ega.length-1;0<=Fc;Fc--){var ld=this.Ega[Fc];F>=ld.left&&k<=ld.right&&(this.Zzc(ld,!1,X,ra),Array.removeAt(this.Ega,Fc),ab=!0)}k=0;for(F=Qb.length;k<
F;k++)this.Zzc(Qb[k],!0,X,ra)&&(this.Ega.push(Qb[k]),ab=!0);return ab};Qd.prototype.activate=function(){this.me()&&!this.active&&(this.gridView.view.Rs(this.Mw),this.active=!0)};Qd.prototype.deactivate=function(){this.active&&(this.gridView.view.Xq(this.Mw),this.active=!1)};Qd.prototype.me=function(){return hi.b(this.$.qa)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.rb.YO&&0<this.tableManager.rangeList.length};Qd.prototype.Nqe=function(k){var F=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?
this.gridView.jpc:[this.gridView.l3];F=Gl(F);for(var X=F.next();!X.done;X=F.next()){X=Gl(X.value);for(var ra=X.next();!ra.done;ra=X.next()){ra=Gl(ra.value);for(var ab=ra.next();!ab.done;ab=ra.next())k(ab.value)}}};Qd.prototype.KYh=function(k,F){var X=[];if(!this.active)return X;this.gNa=this.gridView.Fgd();for(var ra=this.tableManager.rangeList.length-1;0<=ra;ra--){var ab=this.tableManager.rangeList[ra];ab.bottom>=this.gNa&&this.Egd(ab)<=this.gNa&&ab.left>=k&&ab.right<=F&&ab.dba&&X.push(ab)}return X};
Qd.prototype.Egd=function(k){var F=this.gridView.Nb.rj(k);return F&&this.tableManager.Scf(k,F.usedRange.topLeft)?k.top+1:k.top};Object(ie.a)(Qd,"HeaderSnappingFeature",null,[3]);var jl=si.a;Wl(bd,jl);bd.prototype.create=function(){var k=this,F=eh.GetServiceTaskFactory.create(this.$.da,134,this.la,this.vb);Ud.TaskExtensions.Ba(Ud.TaskExtensions.te([F],this.la),function(){k.Eb(k.$.da.za(68)||new Qd(F.result,ff.g(k.$)))},this.la,11)};bd.ka=function(k){k.da.Ga(67,new bd(k))};Object(ie.a)(bd,"HeaderSnappingFactory",
si.a,[]);var oj=b(1310),Fk=b(1045),Kk=si.a;Wl(xb,Kk);xb.prototype.create=function(){var k=this,F=this.$.da,X=eh.GetServiceTaskFactory.create(F,134,this.la,this.vb),ra=eh.GetServiceTaskFactory.Xa(F,213,214,this.vb);Ud.TaskExtensions.Ba(Ud.TaskExtensions.te([X,ra],this.la),function(){if(ve.EwaSettings.Gl())k.Eb(Object(Fk.a)(k.$.da,1,function(){var Qb=new oj.CellAutoCompleteControl(k.$,X.result);ra.result.ka(Qb);return Qb}));else{var ab=F.za(1);ab||(ab=new oj.CellAutoCompleteControl(k.$,X.result),ra.result.ka(ab));
k.Eb(ab)}},this.la,3)};xb.ka=function(k){k.da.Ga(151,new xb(k))};Object(ie.a)(xb,"CellAutoCompleteControlFactory",si.a,[]);kd.prototype.dispose=function(){this.fXd();this.uZa=null};kd.prototype.ka=function(k){k&&(this.uZa=k,k.kZb(this.jAf),k.J2(this.kAf),k.NEg(this.lAf))};kd.prototype.fXd=function(){this.uZa&&(this.uZa.Gsc(this.jAf),this.uZa.nda(this.kAf),this.uZa.T$i(this.lAf))};Object(ie.a)(kd,"CellAutoCompleteReadoutHandler",null,[757,3]);var Rk=si.a;Wl(Qc,Rk);Qc.prototype.create=function(){var k=
this,F=this.$.da;Ud.TaskExtensions.Ba(eh.GetServiceTaskFactory.Xa(F,211,212,this.vb),function(X){if(ve.EwaSettings.Gl())k.Eb(Object(Fk.a)(F,213,function(){return new kd(X.result,F)}));else{var ra=F.za(213)||new kd(X.result,F);k.Eb(ra)}},this.la,3)};Qc.ka=function(k){k.da.Ga(214,new Qc(k))};Object(ie.a)(Qc,"CellAutoCompleteReadoutHandlerFactory",si.a,[]);Ub.vnh="ewa-dv";Ub.wnh="ewa-dv-buttonarea";Ub.Dmh="ewa-dlb";Ub.CBb="list-table";Ub.listItem="list-item";Ub.zBb="list-item-selected";Ub.DBb="list-table-touch";
Ub.unh="ewa-dpb";Ub.Ghh="dv-prompt-title";Ub.Fhh="dv-prompt-message";Object(ie.a)(Ub,"CssClassNames",null,[]);var kj=b(616),sk=b(48),tk=b(457),Lk=b(1026),Sk=lh.ErrorDialog;Wl(Zb,Sk);Zb.prototype.dispose=function(){ff.g(this.$).ha.MF(this.ld);Sk.prototype.dispose.call(this)};Zb.prototype.setFocus=function(){switch(this.error.Severity){case 0:var k=4;break;case 1:k=3;break;case 2:k=0;break;default:k=this.closeAction}(k=this.getButton(k))?k.get_element().focus():Sk.prototype.setFocus.call(this)};Zb.prototype.oqb=
function(){var k=ff.g(this.$);k.isEditing&&k.pc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.WSd(1);if(2===this.returnValue||0===this.returnValue){var F=k.lc(null);if(F){k.Ea.MV();var X=Object(na.a)(new pa.a,{Text:F.originalText});k.setCell(X,F.range,0,63,null)}this.$.Ud(-798660877,Sf.a.Sb,8,null)}Sk.prototype.oqb.call(this)};Zb.prototype.Hsa=function(){var k=ff.g(this.$);k.isEditing&&k.pc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",
0);3===this.returnValue&&this.WSd(0);Sk.prototype.Hsa.call(this)};Zb.prototype.WSd=function(k){var F=ff.g(this.$);Ud.TaskExtensions.Ba(F.startEdit(!1,k),function(){var X=F.pc.textBox;X.text&&X.selectRange(0,X.text.length)},this.la,11,qj.a.current)};Zb.NQ=function(k,F,X){X=F.da.za(14).r3a(X);k.MessageId=-1083021405;k.MessageIdName="DataValidationError";k.MessageIdHash=wg.a.ew(k.MessageIdName);k.Severity=X?X.m8c:1;F=(null===X||void 0===X?0:X.JIa)?wg.a.vg(X.JIa):null;X=(null===X||void 0===X?0:X.error)?
wg.a.vg(X.error):String.format("<p>{0}</p><p>{1}</p>",we.a.instance.ga(892),we.a.instance.ga(893));switch(k.Severity){case 0:k.Appearance=18;break;case 1:k.Appearance=12;X+=String.format("<p>{0}</p>",we.a.instance.ga(894));break;default:k.Appearance=3}k.Caption=F;k.Description=X;k.HelpDescription=we.a.instance.ga(1298);k.HelpTopicId=Lk.a.uFe;return k};Object(ie.a)(Zb,"DataValidationErrorDeprecatedDialog",lh.ErrorDialog,[]);var Xk=b(197),kl=b(178),Gk=Pk.a;Wl(jb,Gk);jb.prototype.dispose=function(){this===
this.Ab.Wp&&(this.Ab.Wp=null);zg.a.Ha(this.Hm);this.Hm=null;Gk.prototype.dispose.call(this)};jb.prototype.Pnj=function(){this.Su&&this.Su.error?this.errorMessage=this.Su.error:this.Su&&this.Su.options&1?(Wd.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=we.a.instance.ga(1711),this.S6e=uh.a.current.hp(97)):(this.errorMessage=we.a.instance.ga(1710),this.mLh(this.ELe));var k=this.Su?this.Su.m8c:1,F={};this.FE=
(F[jb.Px]=this.Cc,F.errorDescription=this.errorMessage,F.helpImageUri=this.S6e,F);switch(k){case 0:this.ic=1;this.Ac(1,"Retry");this.FE.dialogIcon=2;this.xff=!0;break;case 1:this.ic=4;this.FE.dialogIcon=1;this.FE.additionalInformation=we.a.instance.ga(894);break;default:this.ic=1,this.FE.dialogIcon=3}k={};this.FE.helpLink=(k.type="AppLinkProps",k[jb.Px]=this.error.HelpTopicId,k.text=we.a.instance.ga(1298),k.handler=this.r9a,k);k=Vf.a.yWc([this.error]);F={};this.cV=(F[We.a.g9b]=!0,F[We.a.t$c]=k,F[We.a.u$c]=
kl.a(this.$).Usb(this.error.MessageIdHash),F[We.a.AQ]=this.Cc,F.DismissHandler=this.Bzd,F);k={};this.FE.giveFeedbackLink=(k.type="AppLinkProps",k[jb.Px]=We.a.chd,k.text=we.a.instance.ga(1747),k.handler=this.ZKi,k)};jb.prototype.mLh=function(k){var F=this.$.na.va.hc();Yg.u(this.$.na.va,vd.q(k,this.$),hh.b(this.xJi),hh.a(this.wJi),null,F)};jb.prototype.lVh=function(k){switch(k.RuleType){case 1:switch(k.ConditionType){case 0:var F=we.a.instance.Bb(108);return String.format(F,k.LowerBoundary,k.UpperBoundary);
case 1:return F=we.a.instance.Bb(109),String.format(F,k.LowerBoundary,k.UpperBoundary);case 2:return F=we.a.instance.Bb(110),String.format(F,k.LowerBoundary);case 3:return F=we.a.instance.Bb(111),String.format(F,k.LowerBoundary);case 4:return F=we.a.instance.Bb(112),String.format(F,k.LowerBoundary);case 5:return F=we.a.instance.Bb(113),String.format(F,k.UpperBoundary);case 6:return F=we.a.instance.Bb(114),String.format(F,k.LowerBoundary);case 7:return F=we.a.instance.Bb(115),String.format(F,k.UpperBoundary);
default:return"we couldn't get the details"}case 2:switch(k.ConditionType){case 0:return F=we.a.instance.Bb(116),String.format(F,k.LowerBoundary,k.UpperBoundary);case 1:return F=we.a.instance.Bb(117),String.format(F,k.LowerBoundary,k.UpperBoundary);case 2:return F=we.a.instance.Bb(118),String.format(F,k.LowerBoundary);case 3:return F=we.a.instance.Bb(119),String.format(F,k.LowerBoundary);case 4:return F=we.a.instance.Bb(120),String.format(F,k.LowerBoundary);case 5:return F=we.a.instance.Bb(121),String.format(F,
k.UpperBoundary);case 6:return F=we.a.instance.Bb(122),String.format(F,k.LowerBoundary);case 7:return F=we.a.instance.Bb(123),String.format(F,k.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(k.ConditionType){case 0:return F=we.a.instance.Bb(124),String.format(F,k.LowerBoundary,k.UpperBoundary);case 1:return F=we.a.instance.Bb(125),String.format(F,k.LowerBoundary,k.UpperBoundary);case 2:return F=we.a.instance.Bb(126),String.format(F,k.LowerBoundary);case 3:return F=we.a.instance.Bb(127),
String.format(F,k.LowerBoundary);case 4:return F=we.a.instance.Bb(128),String.format(F,k.LowerBoundary);case 5:return F=we.a.instance.Bb(129),String.format(F,k.UpperBoundary);case 6:return F=we.a.instance.Bb(130),String.format(F,k.LowerBoundary);case 7:return F=we.a.instance.Bb(131),String.format(F,k.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(k.ConditionType){case 0:return F=we.a.instance.Bb(132),String.format(F,k.LowerBoundary,k.UpperBoundary);case 1:return F=we.a.instance.Bb(133),
String.format(F,k.LowerBoundary,k.UpperBoundary);case 2:return F=we.a.instance.Bb(134),String.format(F,k.LowerBoundary);case 3:return F=we.a.instance.Bb(135),String.format(F,k.LowerBoundary);case 4:return F=we.a.instance.Bb(136),String.format(F,k.LowerBoundary);case 5:return F=we.a.instance.Bb(137),String.format(F,k.UpperBoundary);case 6:return F=we.a.instance.Bb(138),String.format(F,k.LowerBoundary);case 7:return F=we.a.instance.Bb(139),String.format(F,k.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(k.ConditionType){case 0:return F=
we.a.instance.Bb(140),String.format(F,k.LowerBoundary,k.UpperBoundary);case 1:return F=we.a.instance.Bb(141),String.format(F,k.LowerBoundary,k.UpperBoundary);case 2:return F=we.a.instance.Bb(142),String.format(F,k.LowerBoundary);case 3:return F=we.a.instance.Bb(143),String.format(F,k.LowerBoundary);case 4:return F=we.a.instance.Bb(144),String.format(F,k.LowerBoundary);case 5:return F=we.a.instance.Bb(145),String.format(F,k.UpperBoundary);case 6:return F=we.a.instance.Bb(146),String.format(F,k.LowerBoundary);
case 7:return F=we.a.instance.Bb(147),String.format(F,k.UpperBoundary);default:return"we couldn't get the details"}case 3:return F=we.a.instance.Bb(106),String.format(F,k.LowerBoundary);case 7:return F=we.a.instance.Bb(107),String.format(F,k.LowerBoundary);default:return"we couldn't get the details"}};jb.prototype.WSd=function(k){var F=ff.g(this.$);Ud.TaskExtensions.Ba(F.startEdit(!1,k),function(){var X=F.pc.textBox;X.text&&X.selectRange(0,X.text.length)},this.la,11,qj.a.current)};jb.NQ=function(k,
F,X){F=F.da.za(14).r3a(X);k.MessageId=-1083021405;k.MessageIdName="DataValidationError";k.MessageIdHash=wg.a.ew(k.MessageIdName);k.Severity=F?F.m8c:1;k.HelpDescription=we.a.instance.ga(1298);k.HelpTopicId=Lk.a.uFe;return k};Ck.Object.defineProperties(jb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationErrorDialog"}},la:{configurable:!0,enumerable:!0,get:function(){this.Hm=this.Hm||new Xk.a;return this.Hm.token}}});Object(ie.a)(jb,"DataValidationErrorDialog",Pk.a,[451,
452,3,422]);var jk=b(1116),Yk=b(405),dl=jk.a;Wl(ma,dl);ma.prototype.dispose=function(){this.dataValidationControl=null;dl.prototype.dispose.call(this)};ma.prototype.Xh=function(k,F){this.dataValidationControl.Ya=this.Ya;var X=k.keyCode;return 1461300262!==F||16!==X&&17!==X&&18!==X?dl.prototype.Xh.call(this,k,F):!1};ma.prototype.Hyd=function(){this.UV&&(this.dataValidationControl.Ya=this.Ya,this.dataValidationControl.show(this.dataValidationControl.kR,!0,!0,mj.a.pp||3===Sf.a.Sb))};ma.prototype.Tf=
function(){};ma.prototype.fj=function(){this.dataValidationControl.show(this.dataValidationControl.kR,!0,!0,mj.a.pp||3===Sf.a.Sb)};ma.prototype.jFd=function(k,F){return this.dataValidationControl.Xh(F)};Ck.Object.defineProperties(ma.prototype,{Cyb:{configurable:!0,enumerable:!0,get:function(){return Object(Xi.a)(jb,this.$.Ab.lh)}},UV:{configurable:!0,enumerable:!0,get:function(){return this.dataValidationControl.isListVisible},set:function(k){this.dataValidationControl.isListVisible=k}},l5a:{configurable:!0,
enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return Yk.a.S4c}}});Object(ie.a)(ma,"DataValidationListAutoCompleteBehavior",jk.a,[]);var Tk=b(1050),ll=b(1115),el=Tk.a;Wl(hd,el);hd.prototype.dispose=function(){el.prototype.dispose.call(this);this.BBb=this.qlb=null};hd.prototype.sea=function(k,F,X,ra){if(k&&(!k||k.length)){this.O7(!1);this.XHa=k;this.eW=[];for(var ab=0;ab<k.length;ab++)this.eW[ab]=k[ab]?k[ab].Name:null;ab=String.format("<table class='{0}' aria-live='polite'><tbody>",
this.Wba);var Qb="",Fc="";k=0;var ld=ff.g(this.$).lc(null);ra=this.isEditing?ra?ra.text:this.editText:ld?ld.originalText:null;ld=!ra;var ud=0;Array.clear(this.nFb);var jd=[],Ye=[],Bf=[],Tg=ra?ra.split(" "):[""];ra=ra.trim();for(var $g={},Wg=0;Wg<this.eW.length;$g={HDc:$g.HDc},Wg++){var qh=this.eW[Wg],Ri=void 0;$g.HDc=qh.split(" ");Ri=Bg.a.all(Tg,function(ph){return function(ei){return Bg.a.any(ph.HDc,function(Rh){return Z.a.fL(Rh,ei)})}}($g));var ci=!qh,Tf=Array.contains(Bf,qh);ci||Tf||this.isEditing&&
!Ri||(Ri=qh?wg.a.vg(wg.a.E7b(qh)):"",Ri=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.v_,Ri),Bf.push(qh),this.isEditing&&Z.a.fL(qh,ra)?(Qb+=Ri,jd.push(Wg)):(Fc+=Ri,Ye.push(Wg)),!ld&&Z.a.equals(ra,qh,!0)&&(k=this.isEditing?jd.length-1:ud,ld=!0),ud++)}this.vNa=ud;Array.addRange(this.nFb,jd);Array.addRange(this.nFb,Ye);this.dg.innerHTML=ab+(Qb+Fc+"</tbody></table>");ab=this.Un=nf.DOMElementExtensions.Oj(this.domElement,this.Wba);this.Wmb(ab,F);this.O7(!0);this.Zra(F,X);this.Wk=0<this.vNa?
ab.rows[k]:null}};hd.prototype.gRa=function(k){var F=!1;this.isEditing&&k&&(F=!this.vNa,k.endEdit(F,"DataValidationListBox.SetCellContent",0));if(!F&&(k=ff.g(this.$),F=k.lc(null))){var X=null;this.Dda&&-1!==this.Dda.SheetId&&-1!==this.Dda.Row&&-1!==this.Dda.Column&&(X={},X.SheetName=this.Dda.SheetId.toString(),X.FirstRow=this.Dda.Row,X.FirstColumn=this.Dda.Column,X={ParameterType:6,SourceRange:X});var ra=Object(na.a)(new pa.a,{Text:this.ye});k.setCell(ra,F.range,0,63,X)}return!0};hd.prototype.Zra=
function(k,F){var X=k?this.sCb:this.UH;k=k?this.Ejc:this.Fjc;0>=this.vNa?this.dg.style.height=Sc.HelperMethods.uc(k):(this.dg.style.height="auto",this.vNa>X?(nf.DOMElementExtensions.EI(this.dg,this.qPj?Math.floor(k*X):Math.floor(this.dg.offsetHeight*X/this.vNa)),this.dg.style.overflowY="auto"):(this.dg.style.height="auto",this.dg.style.overflowY="hidden"));nf.DOMElementExtensions.Hr(this.dg,F);nf.DOMElementExtensions.Hr(this.Un,F-(this.vNa>X?Kj.a.vv:0))};Ck.Object.defineProperties(hd.prototype,{Wk:{configurable:!0,
enumerable:!0,get:function(){return this.qlb},set:function(k){this.jBa(this.qlb);if(k){this.qlb=k;this.BBb.innerText="";this.jBa(this.qlb);var F=this.nFb[k.rowIndex];this.ye=this.eW[F];this.XHa&&(this.Dda=this.XHa[F],Wd.ULS.shipAssertTag(537163286,0,!this.nFb.length||!!this.Dda,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.BBb.innerText=this.ye;this.Kuc(k)}else this.Dda=this.ye=null}},isEditing:{configurable:!0,enumerable:!0,get:function(){return ff.g(this.$).isEditing}},
editText:{configurable:!0,enumerable:!0,get:function(){return ff.g(this.$).pc.text}}});Object(ie.a)(hd,"DataValidationListBox",Tk.a,[]);var ql=b(250),Hk=b(109),Ij=b(244),Uk=Fi.a;Wl(uc,Uk);uc.prototype.NUc=function(k){this.get_events().addHandler("ClickButton",k)};uc.prototype.tId=function(k){this.get_events().removeHandler("ClickButton",k)};uc.prototype.ZUc=function(k){this.get_events().addHandler("KeyDown",k)};uc.prototype.GId=function(k){this.get_events().removeHandler("KeyDown",k)};uc.prototype.uZb=
function(k){this.get_events().addHandler("PointerOver",k)};uc.prototype.RId=function(k){this.get_events().removeHandler("PointerOver",k)};uc.prototype.tZb=function(k){this.get_events().addHandler("PointerOut",k)};uc.prototype.QId=function(k){this.get_events().removeHandler("PointerOut",k)};uc.prototype.anb=function(k){this.get_events().addHandler("Blur",k)};uc.prototype.MHb=function(k){this.get_events().removeHandler("Blur",k)};uc.prototype.K9=function(k){this.get_events().addHandler("Focus",k)};
uc.prototype.mda=function(k){this.get_events().removeHandler("Focus",k)};uc.prototype.enable=function(){this.domElement&&(this.domElement.classList.remove(kj.a.bZ),this.domElement.style.cursor="",rj.a.instance.pa(Gg.a.click,this.domElement,this.xd),Hk.KeyInputManager.instance.pa(Gg.a.Xb,this.domElement,this.onKeyDown),Ij.a.instance.pa(Gg.a.pointerOver,this.domElement,this.Lw),Ij.a.instance.pa(Gg.a.pointerOut,this.domElement,this.HN),this.Kc.rn("blur")||this.Kc.ka("blur",this.onBlur),this.Kc.rn("focus")||
this.Kc.ka("focus",this.onFocus),this.domElement.title=this.Ejh,this.Cl=!0)};uc.prototype.disable=function(){this.domElement&&(this.domElement.classList.add(kj.a.bZ),this.domElement.style.cursor="",this.isEnabled&&(rj.a.instance.Aa(Gg.a.click,this.domElement,this.xd),Hk.KeyInputManager.instance.Aa(Gg.a.Xb,this.domElement,this.onKeyDown),Ij.a.instance.Aa(Gg.a.pointerOver,this.domElement,this.Lw),Ij.a.instance.Aa(Gg.a.pointerOut,this.domElement,this.HN)),this.domElement.title=this.Teh,this.Cl=!1)};
uc.prototype.dispose=function(){this.isEnabled&&(rj.a.instance.Aa(Gg.a.click,this.domElement,this.xd),Hk.KeyInputManager.instance.Aa(Gg.a.Xb,this.domElement,this.onKeyDown),Ij.a.instance.Aa(Gg.a.pointerOver,this.domElement,this.Lw),Ij.a.instance.Aa(Gg.a.pointerOut,this.domElement,this.HN),this.Cl=!1);nf.DOMElementExtensions.setVisible(this.domElement,!1);Uk.prototype.dispose.call(this)};uc.Cb=function(k,F,X,ra,ab,Qb,Fc,ld){k.removeAttribute("Href");k.setAttribute(We.a.Wd,We.a.Ss);k.className=F;k.tabIndex=
ld;F=document.createElement("span");F.className=Fc;F.classList.add(X);F.tabIndex=-1;k.appendChild(F);k=document.createElement("img");k.src=uh.a.gf(ra);k.className=ab;k.alt=Qb;k.tabIndex=-1;F.appendChild(k);return k};Ck.Object.defineProperties(uc.prototype,{wl:{configurable:!0,enumerable:!0,get:function(){return this.$I}},isEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Cl}}});Object(ie.a)(uc,"ListButton",Fi.a,[785,3]);var rl="<p class='"+Ub.Ghh+"'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>",
ml="<p class='"+Ub.Fhh+"'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>",W=pb.a.EMe,ua=pb.a.EMe,gb=pb.a.oYg,ac=Fi.a;Wl(kc,ac);kc.prototype.dispose=function(){this.$&&(this.oMb(!1),this.gridView.ha.aO(this.Sh),this.gridView.Ww(this.onContentReady),this.gridView.tc.s$i(this.Ivf),this.$.tm(this.Zc));this.GDe(!1);this.HDe(!1);zg.a.Dc(this.F5b);this.F5b=this.Csa=this.dg=this.b0=this.QI=this.gridView=this.$=null;ac.prototype.dispose.call(this)};kc.prototype.A6c=function(k){return!!this.r3a(k)};
kc.prototype.Xqb=function(k,F){return ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new jb(this.$,k,F):new Zb(this.$,k,F)};kc.prototype.r3a=function(k){k=this.gridView.getRangeInformation(k);for(var F=0;F<k.length;F++){var X=k[F];if(Object(Xi.a)(tk.DataValidationRange,X))return X}return null};kc.prototype.sHh=function(){if(!this.E4a)return"";var k=this.m6e?String.format("{0} {1}",this.Su.NIf,this.Su.prompt):"",F=this.Hwb?we.a.instance.ga(840):"";return String.format(we.a.instance.Bb(17),
k,F)};kc.prototype.Xh=function(k){var F=!1;if(this.isListVisible||(-569786022===k||541421805===k)&&this.Hwb||1872288872===k&&this.kR)switch(k){case -569786022:case 541421805:this.show(this.kR,!this.isListVisible,!0,mj.a.pp||3===Sf.a.Sb);F=!0;break;case 1872288872:this.isListVisible?(this.show(this.kR,!1,!0,!1),F=!0):this.kR?(this.show(!1,!1,!0,!1),F=!0):this.Ya&&(this.Ya.endEdit(!1,"DataValidationControl.HandleKeyDown",0),F=!0);break;case -798660877:this.$h.tB(1);F=!0;break;case 137938150:this.$h.tB(-1);
F=!0;break;case 2091832999:this.$h.tB(this.$h.UH-1);F=!0;break;case 742457698:this.$h.tB(-(this.$h.UH-1));F=!0;break;case 125627505:case 267796030:F=this.gRa()}return F};kc.prototype.show=function(k,F,X,ra){this.ay();if(this.kAb&&this.E4a){var ab=this.mOa;if(ab){if(k||F||X)this.isVisible=!0;Vi.d(this.style,this.isGridRtl);X&&this.Hwb&&(this.HDe(!0),this.fcg(ab,!1));F&&this.Hwb&&this.TRa(ra,ab);k&&this.m6e&&this.mzj(ab);this.zmi||(this.isVisible=!1)}}};kc.prototype.rva=function(k,F){if(!F||!F.cell.mk)return null;
var X=this.gridView.tc.textBox.domElement;var ra=0<nf.DOMElementExtensions.getHeight(X)&&0<nf.DOMElementExtensions.getWidth(X)&&0<=X.offsetTop&&0<=X.offsetLeft;if(ra)X=nf.DOMElementExtensions.rva(X,k.Lj);else{X=k.getCellBounds(F.cell);var ab=nf.DOMElementExtensions.getBoundingClientRect(k.Lj);X=new Sys.UI.Bounds(X.x-ab.x,X.y-ab.y,X.width,X.height)}if(X)if(ra)2<X.height&&2<X.height&&(X.x+=1,X.y+=1,X.height-=2,X.width-=2);else if(ra=ff.g(this.$).SJ(F.cell))ra=ra.width+1,ab=Z.a.equals(ql.a.q3a(F.cell,
k.rtl),"right",!0),k.rtl&&ab&&(X.x=X.x+X.width-ra),F.Oka&&k.rtl===ab&&(X.width=ra);else return null;return X};kc.prototype.n2f=function(k){var F=this.E4a;this.oMb(F);F?this.show(!0,k,!0,!1):this.ay()};kc.prototype.gRa=function(){var k=!1;this.isListVisible&&(k=this.$h.gRa(this.Ya),this.show(this.kR,!1,!0,!1));return k};kc.prototype.ay=function(){this.mfi?(this.isListVisible&&(this.isListVisible=!1),this.MLa&&(this.MLa=!1),this.kR&&(this.kR=!1),this.isVisible&&(this.isVisible=!1)):this.isListVisible=
this.MLa=this.kR=this.isVisible=!1;this.Aod=this.Cmd=this.rpd=!1};kc.prototype.TRa=function(k,F){this.Hwb&&!this.Su.XHa?this.MLa&&this.Qh.disable():(this.GDe(!0),this.$h.sea(this.Su.XHa,k,this.oQh(F),this.Ya),this.ABa(F,!1))};kc.prototype.mzj=function(k){this.Su.prompt&&(this.kR=!0,this.aRj(this.Su.NIf,this.Su.prompt),this.Acg(k,!1))};kc.prototype.fcg=function(k,F){var X=k.y;this.Csa.style.top=Sc.HelperMethods.uc(X);k=this.isGridRtl?k.x-this.Csa.offsetWidth+1:k.x+k.width+1;this.Csa.style.left=Sc.HelperMethods.uc(k);
F?this.MLa=this.gridView.sic(new sk.a(k,X))&&this.Cmd:this.Cmd=!0};kc.prototype.ABa=function(k,F){var X=k.y+k.height;k=this.isGridRtl?k.x+k.width-this.dg.offsetWidth:k.x;this.dg.style.top=Sc.HelperMethods.uc(X);this.dg.style.left=Sc.HelperMethods.uc(k);F?this.isListVisible=this.gridView.sic(new sk.a(k,X))&&this.Aod:this.Aod=!0};kc.prototype.Acg=function(k,F){var X=k.y+k.height+5,ra=this.activeCell;ra=ra?ra.width/2:32;k=this.isGridRtl?k.x-this.b0.offsetWidth+ra:k.x+k.width-ra;this.b0.style.top=Sc.HelperMethods.uc(X);
this.b0.style.left=Sc.HelperMethods.uc(k);F?this.kR=this.gridView.sic(new sk.a(k,X))&&this.rpd:this.rpd=!0};kc.prototype.aRj=function(k,F){if(F){var X="";k&&(X+=String.format(rl,wg.a.vg(k)));X+=String.format(ml,wg.a.vg(F));this.b0.innerHTML=X;k=nf.DOMElementExtensions.Oj(this.b0,"dv-prompt-titletext");if(F=nf.DOMElementExtensions.Oj(this.b0,"dv-prompt-messagetext"))for(k=k?parseInt(String(Math.max(k.offsetWidth,F.offsetWidth)),10):F.offsetWidth,k+=6,nf.DOMElementExtensions.Hr(this.b0,k),F=0,X=this.b0.children.length;F<
X;F++)nf.DOMElementExtensions.Hr(this.b0.children[F],k)}};kc.prototype.oQh=function(k){return this.nfi?k.width+17-2+1:k.width+this.Csa.clientWidth-2+1};kc.prototype.HDe=function(k){this.$&&!this.kAb||!k?(this.o6f(!1),zg.a.Ha(this.Qh),this.Qh=null):(this.Qh||(this.Qh=new uc(this.Csa,W,kj.a.gia,1,ua,we.a.instance.ga(891),gb,we.a.instance.ga(890),"",-1),this.o6f(!0)),this.MLa=!0,this.Su.XHa?this.Qh.isEnabled||this.Qh.enable():this.Qh.disable())};kc.prototype.GDe=function(k){this.$&&!this.kAb||!k?(this.ASa(!1),
zg.a.Ha(this.$h),this.$h=null):(this.$h||(this.$h=new hd(this.$,this.dg,this.BBb),this.ASa(!0)),this.isListVisible=!0)};kc.prototype.ASa=function(k){this.$h&&(k&&!this.rR?(this.$h.K9(this.mzd),this.$h.gZb(this.nLa),this.$h.qnb(this.zya),this.rR=!0):!k&&this.rR&&(this.$h.mda(this.mzd),this.$h.Dsc(this.nLa),this.$h.cIb(this.zya),this.rR=!1))};kc.prototype.oMb=function(k){k&&!this.UQ?(this.gridView.view.Rs(this.qt),this.UQ=!0):!k&&this.UQ&&(this.gridView.view.Xq(this.qt),this.UQ=!1)};kc.prototype.o6f=
function(k){this.Qh&&(k&&!this.X0b?(this.Qh.NUc(this.COa),this.Qh.ZUc(this.COa),this.Qh.anb(this.nLa),this.X0b=!0):!k&&this.X0b&&(this.Qh.tId(this.COa),this.Qh.GId(this.COa),this.Qh.MHb(this.nLa),this.X0b=!1))};kc.prototype.pcg=function(){if(this.E4a){var k=this.mOa;k&&(this.fcg(k,!0),this.ABa(k,!0),this.Acg(k,!0))}};Ck.Object.defineProperties(kc.prototype,{kAb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Qd&16)}},zmi:{configurable:!0,enumerable:!0,get:function(){return this.isListVisible||
this.kR||this.MLa}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return nf.DOMElementExtensions.isVisible(this.dg)},set:function(k){nf.DOMElementExtensions.setVisible(this.dg,k)}},kR:{configurable:!0,enumerable:!0,get:function(){return nf.DOMElementExtensions.isVisible(this.b0)},set:function(k){nf.DOMElementExtensions.setVisible(this.b0,k)}},MLa:{configurable:!0,enumerable:!0,get:function(){return nf.DOMElementExtensions.isVisible(this.Csa)&&!!this.Qh&&nf.DOMElementExtensions.isVisible(this.Qh.domElement)},
set:function(k){nf.DOMElementExtensions.setVisible(this.Csa,k);this.Qh&&nf.DOMElementExtensions.setVisible(this.Qh.domElement,k)}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.QI},set:function(k){this.QI=k}},E4a:{configurable:!0,enumerable:!0,get:function(){return!!this.activeCell&&this.A6c(this.activeCell.range)}},activeCell:{configurable:!0,enumerable:!0,get:function(){return this.gridView.lc(null)}},m6e:{configurable:!0,enumerable:!0,get:function(){return this.E4a&&!!this.Su&&!!(this.Su.options&
2)&&!!this.Su.prompt}},Hwb:{configurable:!0,enumerable:!0,get:function(){return this.E4a&&!!this.Su&&!!(this.Su.options&1)}},isGridRtl:{configurable:!0,enumerable:!0,get:function(){return this.gridView.rtl}},Su:{configurable:!0,enumerable:!0,get:function(){return this.r3a(this.activeCell.range)}},mOa:{configurable:!0,enumerable:!0,get:function(){var k=this.activeCell;return k?this.rva(this.gridView,k):null}}});Object(ie.a)(kc,"DataValidationControl",Fi.a,[744,3]);var Jc=si.a;Wl(Jb,Jc);Jb.prototype.create=
function(){this.Eb(this.$.da.za(14)||new kc(this.$))};Object(ie.a)(Jb,"DataValidationControlFactory",si.a,[]);$b.I9c="!";$b.gEf="[";$b.fEf="]";$b.openParen="(";$b.closeParen=")";$b.Hfg=" /.(*\\".split("");$b.v7b="...";$b.yFb="param_help_link";$b.sCd="param_help_udf";$b.Ebd="function_list_box";$b.HDh="function_param_box";$b.Gbd="function_reader_description";$b.zbd="function_description_box";$b.JUe="function_param_table";$b.LUi="param_row_";$b.tCd="param_set";$b.MEf="param_row_0";$b.NEf="param_row_1";
$b.IDh="<div id='{0}' class='{1}'></div>";$b.GDh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";$b.OEf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";$b.DDh="<div id='{0}' class='{1} {2} {3}'></div>";$b.ADh="<div id='{0}' class='{1} {2} {3} {4}'></div>";$b.ujf="[@";$b.h3g=1;$b.g3g=3;$b.jch=500;$b.Nof=50;Object(ie.a)($b,
"FormulaAssistanceConstants",null,[]);var gd=b(369),cd;(function(k){k.CategoryList="categoryList";k.FunctionsMap="functionsMap";k.FunctionIdsToDisplay="functionIdsToDisplay";k.RefreshListCallback="refreshListCallback";k.HelpCallback="helpCallback";k.InitialCategory="initialCategory";k.AllCategoryName="allFunctionsCategoryName"})(cd||(cd={}));Object(ie.b)("PropsKeys",cd);var Oc=Pk.a;Wl(Qa,Oc);Qa.prototype.Ug=function(){this.functionInfoManager.Q1a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},
!0);this.ic=1;this.functionInfoManager.e_?this.x9e():this.functionInfoManager.vYa(this.onFunctionInfoLoaded)};Qa.prototype.x9e=function(){var k;this.d_b=this.functionInfoManager.w$b.filter(this.nef);var F=null!==(k=Qa.mif)&&void 0!==k?k:Qa.A_g;k=this.functionInfoManager.ybd;var X=this.functionInfoManager.Tac(F).map(function(ab){return ab.FunctionIndex}),ra={};this.FE=(ra[Qa.Px]=this.Cc,ra[cd.CategoryList]=k,ra[cd.FunctionsMap]=this.Y5g(),ra[cd.FunctionIdsToDisplay]=X,ra[cd.RefreshListCallback]=this.CLi.bind(this),
ra[cd.HelpCallback]=this.lvb,ra[cd.InitialCategory]=F,ra[cd.AllCategoryName]=Qa.AllCategoryName,ra);this.initializeAndShow(this.Jm,this.EUe,this.FE)};Qa.prototype.Y5g=function(){var k={};this.d_b.forEach(function(F){k[F.FunctionIndex]=F});return k};Qa.prototype.mPj=function(k){k=k.map(function(F){return F.FunctionIndex});this.FE[cd.FunctionIdsToDisplay]=k;this.Leb(this.Jm,this.Uvb(this.EUe),this.FE)};Qa.prototype.CLi=function(k,F){F?F=this.czh(F):(F=this.functionInfoManager.Tac(k).filter(this.nef),
Qa.mif=k);this.mPj(F)};Qa.prototype.czh=function(k){k=void 0===k?"":k;k=k.toLocaleLowerCase();var F=this.d_b.filter(function(X){return X.NameUI.toLocaleLowerCase().startsWith(k)});3<=k.length&&(F.push.apply(F,Hl(this.d_b.filter(function(X){return X.NameUI.toLocaleLowerCase().includes(k)&&!F.includes(X)}))),F.push.apply(F,Hl(this.d_b.filter(function(X){return X.Help.toLocaleLowerCase().includes(k)&&!F.includes(X)}))));return F};Ck.Object.defineProperties(Qa.prototype,{Cc:{configurable:!0,enumerable:!0,
get:function(){return"FunctionDialog"}}});Qa.AllCategoryName=we.a.instance.ga(1024);Qa.A_g=we.a.instance.ga(1023);Qa.mif=void 0;Object(ie.a)(Qa,"FunctionDialog",Pk.a,[]);var Ic=b(68),Bd=b(232),Ed=Ic.a.hnh,qe=Ic.a.zMe,Qe=Ic.a.AMe,tf=Ic.a.F8c,ig=Ic.a.jnh,yg=Ic.a.nnh,Dh=Ic.a.vMe,Jh=Ic.a.DMe,Lh=Ic.a.lnh,Yi=Ic.a.wMe,Ji=L.a;Wl(Ib,Ji);Ib.prototype.initialize=function(){this.Qb.classList.add(Ic.a.fnh);this.Qb.innerHTML=Ib.UG();this.Oe||(this.Ll(),this.C2());Ji.prototype.initialize.call(this);var k=nf.DOMElementExtensions.Oj(this.Qb,
Yi);this.rtl&&(k.align="right",this.mub.style.marginLeft="5px");this.Oe&&(k.style.padding="1px");this.functionInfoManager.Q1a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)};Ib.prototype.dispose=function(){this.functionInfoManager&&(this.functionInfoManager.Zab(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.Dk(this.od));zg.a.Dc([this.H1b,this.a6,this.Zwb,this.wJa,this.nub]);Ji.prototype.dispose.call(this)};Ib.prototype.Ll=function(){this.xJa=nf.DOMElementExtensions.Oj(this.Qb,
Ed);this.hja=nf.DOMElementExtensions.Oj(this.Qb,qe);this.xJa.setAttribute(We.a.Wd,We.a.J_b);this.wJa=new ck.a(this.xJa,!0);this.nub=new ck.a(this.hja,!0);this.HUe=nf.DOMElementExtensions.Oj(this.Qb,yg);this.mub=nf.DOMElementExtensions.Oj(this.Qb,ig);this.LUe=nf.DOMElementExtensions.Oj(this.Qb,Jh);this.zkf=nf.DOMElementExtensions.Oj(this.Qb,Lh);this.IUe=$get(Ib.Abd,this.Qb);this.gja=nf.DOMElementExtensions.Oj(this.Qb,Dh);this.Oe&&(this.gja.style.paddingLeft="1px");this.functionInfoManager.vYa(this.onFunctionInfoLoaded);
this.functionInfoManager.$.ea.hk(this.od)};Ib.prototype.YQ=function(k){var F=this;this.$.da.$a(40,function(){F.wJa.YQ(k)})};Ib.prototype.Bn=function(){this.gbd?this.formulaAssistanceManager.e6c():this.formulaAssistanceControl.set_visible(!1);Ji.prototype.Bn.call(this);this.Tid||(this.getButton(0).get_element().disabled=!0)};Ib.prototype.setFocus=function(){!this.xJa.disabled&&this.Tid&&nf.DOMElementExtensions.setFocus(this.xJa)};Ib.prototype.commit=function(){return!0};Ib.prototype.oqb=function(){var k=
this,F=this.Q$.NameDataStrings;if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")){var X=new jh.a(-433697611,0,this.$.Xc,8,null),ra={};ra=(ra[Sf.a.kd]=F,ra);this.$.Ka.Wb(X,ra)}else{F+=$b.openParen;X=ff.g(this.$);X.view.visibleArea.contains(X.tg(null))||X.jt(X.ha.ta.activeCell,3,Wk.a.BDh);var ab=this.yIa.textBox;if(this.yIa.isEditing&&this.yIa.text){ra=this.yIa.text;var Qb=this.a_c?ra.substring(0,this.a_c):"=";this.yIa.text=Qb+F+ra.substring(this.a_c+(ab.xv?ab.xv.length:
0),ra.length);ab.caretPosition=Qb.length+F.length}else Ud.TaskExtensions.Ba(X.startEdit(!0,1),function(){k.yIa.text="="+F;var Fc=F.length+1;ab.fRa(Fc);ab.caretPosition=Fc},this.la,11,qj.a.current);X.Bj&&(X=X.pc,X.text=ab.text,X.setCaretPosition(ab.caretPosition));(X=this.yIa.DY.get(Yk.a.V2a))&&X.uU(!1)}};Ib.prototype.Hsa=function(){this.gbd?this.formulaAssistanceManager.tda():this.formulaAssistanceControl.cob()};Ib.prototype.Sua=function(k){this.nub.clear();for(var F=Ib.Abd+" "+Ib.CUe,X=0,ra=k.length;X<
ra;++X){var ab=this.nub.VL(k[X].NameUI,k[X].FunctionIndex.toString(),!1);mj.a.kv&&ab.classList.add(tf);ab.setAttribute(We.a.iE,Ib.DUe);ab.setAttribute(We.a.JG,F)}this.nub.selectedIndex=0};Ib.prototype.VXf=function(){if(this.Q$){this.mub.parentNode.className=Ic.a.wMe+(this.functionInfoManager.kgc(this.Q$)?"-udf":"");var k=this.Q$.NameDataStrings;this.LUe.innerText=k;this.mub.innerText=k;this.gja.innerText=this.Q$.Help;k=this.Q$.Params.split($b.I9c);this.IUe.innerText=$b.openParen+(1<k.length?$b.v7b:
k[0])+$b.closeParen}};Ib.UG=function(){return String.format("<div class='"+Ic.a.gnh+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+Ei.a.Qn+"'>{1}</div>\r\n<div class='"+Ic.a.uMe+"'>\r\n\t<select id='{16}' class='{17} "+pb.a.$p+" "+pb.a.Zo+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+Ic.a.knh+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+pb.a.$p+"'>\r\n\t\t\t<span class='"+
pb.a.YA+" "+Ic.a.mnh+"'>\r\n\t\t\t\t<img title='{3}' class='"+pb.a.Msh+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",we.a.instance.ga(1027),we.a.instance.ga(1028),we.a.instance.ga(738),we.a.instance.Bb(3),uh.a.gf(13),we.a.instance.ga(1029),Ib.zDh,Ib.Abd,7,Ed,ig,yg,Dh,Jh,Lh,Yi,Ib.EDh,qe+(mj.a.kv?" "+Qe:""),Ib.CUe,
Ib.DUe)};Ck.Object.defineProperties(Ib.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDeprecatedDialog"}},Q$:{configurable:!0,enumerable:!0,get:function(){if(!this.hja||!this.hja.firstChild)return null;var k=Number.parseInvariant(this.hja.children[this.hja.selectedIndex].value);return this.functionInfoManager.kOh(k)}}});Ib.Abd="function_dialog_param_string";Ib.CUe="function_dialog_function_description";Ib.DUe="function_dialog_function_name";Ib.EDh="function_list";Ib.zDh=
"function_category";Object(ie.a)(Ib,"FunctionDeprecatedDialog",L.a,[]);yb.prototype.$c=function(k,F){if(!ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements"))return!1;switch(F){case 753860909:case -2060563418:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return k=ff.g(this.$).Nj,k.l5a||!k.isEditing||0>=k.text.length?!1:!0;default:return!1}};
yb.prototype.executeCommand=function(k,F,X){F=F.command;k=ff.g(this.$);var ra=k.Nj;switch(F){case 753860909:case -2060563418:k.inRangePicker&&ra.OG(!1);this.create(ra);this.formulaAssistanceManager&&this.formulaAssistanceTelemetryManager.Bbd.dialogShownCounter++;break;case -433697611:this.formulaAssistanceManager&&this.formulaAssistanceTelemetryManager.Bbd.dialogCommitedCounter++;var ab=X[Sf.a.kd]+$b.openParen;X.UILocation&&this.$.Ud(-1075437823,-1,0,null);k.view.visibleArea.contains(k.tg(null))||
k.jt(k.ha.ta.activeCell,3,Wk.a.BCh);var Qb=ra.textBox;X=ra.textBox.caretPosition;if(ra.isEditing&&ra.text){F=ra.text;var Fc=X?F.substring(0,X):"=";ra.text=Fc+ab+F.substring(X+(Qb.xv?Qb.xv.length:0),F.length);Qb.caretPosition=Fc.length+ab.length}else Ud.TaskExtensions.Ba(k.startEdit(!0,1),function(){ra.text="="+ab;var ld=ab.length+1;Qb.fRa(ld);Qb.caretPosition=ld},this.$.la,11,qj.a.current);k.Bj&&(k=k.pc,k.text=Qb.text,k.setCaretPosition(Qb.caretPosition));this.NV?this.formulaAssistanceManager.tda():
(k=ra.DY.get(Yk.a.V2a),null===k||void 0===k?void 0:k.uU(!1))}return Xf.Task.Sa(!0)};yb.prototype.Mc=function(k,F){switch(F.command){case 753860909:case -2060563418:case -433697611:return!0;default:return!1}};yb.prototype.zEh=function(k,F){F=this.Ta.Cq(F);var X=this.Ta.Pc(),ra=this.functionInfoManager.Tac(k);if(!ra)return Wd.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),F.jE();for(var ab=0;ab<ra.length;++ab){var Qb=ra[ab].NameUI,Fc=this.Ta.cQ(280,
"Formulas."+k+"MenuItem_"+ra[ab].FunctionIndex.toString(),-433697611,null,1,"None",0,0,Qb,!1,0);Fc.label=Qb;var ld=ra[ab].Params.split($b.I9c);Fc.oS(Qb+" "+($b.openParen+(1<ld.length?$b.v7b:ld[0])+$b.closeParen)+"\n"+ra[ab].Help);X.buttons.push(Fc)}k=this.Ta.Pc();ra=this.Ta.cQ(280,"Formulas.MoreFunctionsMenuItem",-2060563418,pb.a.IPe,3,"Image16by16",1026,0,"Formulas.MoreFunctionsMenuItem",!1,0);k.buttons.push(ra);F.Ec.push(X);F.Ec.push(k);return F.jE()};yb.prototype.jd=function(k,F,X){k=this.jOh(F);
if(-1===k)return!1;this.menuId=X.MenuId;if(!this.functionInfoManager.e_)return this.functionInfoManager.Q1a({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;k=this.functionInfoManager.ybd[k];this.LY[k]=this.LY[k]||this.zEh(k,X.MenuId);X.MenuItems=this.LY[k];return!0};yb.prototype.create=function(k){O.a.ief(this.$)?(this.formulaAssistanceManager.e6c(),new Qa(this.$)):(new Ib(this.$,k)).Af()};yb.prototype.jOh=function(k){switch(k){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;
case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}};Object(ie.a)(yb,"FormulaAssistanceCommandHandler",null,[428]);var ej=bf.a;Wl(Xa,ej);Xa.prototype.Od=function(){var k=this,F=eh.GetServiceTaskFactory.create(this.$.da,
102,this.la,this.vb),X=eh.GetServiceTaskFactory.create(this.$.da,153,this.la,this.vb);Ud.TaskExtensions.Ba(Ud.TaskExtensions.te([F,X],this.la),function(){k.Cd([new yb(k.$,F.result,X.result)])},this.la,3)};Xa.ka=function(k){bf.a.ee(92,new Xa(k))};Object(ie.a)(Xa,"FormulaAssistanceCommandHandlerFactory",bf.a,[]);bb.prototype.dispose=function(){this.fXd();this.yJa=this.Nua=this.bja=null};bb.prototype.cXc=function(k){k&&(this.bja=k,this.bja.Ime(this.mAf),this.bja.xne(this.oAf),this.qwa&&this.bja.wne(this.nAf))};
bb.prototype.dXc=function(k){k&&(this.Nua=k,this.qwa&&(this.Nua.Gme(this.ywf),this.Nua.Eme(this.rwf)),this.Nua.Fme(this.uwf))};bb.prototype.eXc=function(k){k&&(this.yJa=k,this.yJa.lVc(this.pAf),this.yJa.kZb(this.iAf))};bb.prototype.fXd=function(){var k,F,X;this.bja&&(this.bja.mPf(this.mAf),this.bja.JPf(this.oAf),this.qwa&&this.bja.IPf(this.nAf));this.yJa&&(this.yJa.UId(this.pAf),this.yJa.Gsc(this.iAf));this.qwa&&(null===(k=this.Nua)||void 0===k?void 0:k.lPf(this.ywf),null===(F=this.Nua)||void 0===
F?void 0:F.jPf(this.rwf));null===(X=this.Nua)||void 0===X?void 0:X.kPf(this.uwf)};bb.prototype.$3i=function(k,F){if(F){var X="";this.qwa||(X+=we.a.instance.Bb(57)+this.ariaLiveNotifier.Cxa);for(var ra=0;ra<F.length;ra++)X+=k+this.ariaLiveNotifier.Cxa+this.GYc(F[ra])+bb.xDd(ra,F.length);this.qwa&&(X+=we.a.instance.ga(879)+this.ariaLiveNotifier.Cxa);this.ariaLiveNotifier.readText(X)}};bb.prototype.Z3i=function(k,F,X){if(k){var ra="",ab=0;if(F){for(var Qb=0;Qb<F.length;Qb++)if(X>=k[Qb].split(this.$.listSeparator).length)ab++;
else{var Fc=F[Qb].trim();if(!Fc)return;Fc=this.GYc(Fc);var ld=bb.xDd(Qb-ab,F.length-ab);ra+=Fc+ld;ld&&(ra+=this.ariaLiveNotifier.Cxa)}this.ariaLiveNotifier.readText(ra)}}};bb.prototype.GYc=function(k){if(!k)return"";var F=k.split(this.$.listSeparator);k="";F=Gl(F);for(var X=F.next();!X.done;X=F.next()){var ra=X.value;bb.xnd(ra)?k+=ra:(ra=(X=bb.Vii(ra))?ra.replace("[","").replace("]",""):ra,k+=String.format(X?we.a.instance.Bb(59):we.a.instance.Bb(58),ra));k+=this.ariaLiveNotifier.Cxa}return k};bb.xDd=
function(k,F){return k>=F||1===F?(Wd.ULS.shipAssertTag(537161997,0,k<F,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""):String.format(we.a.instance.Bb(55),k+1,F)+"\r\n"};bb.xnd=function(k){return Z.a.contains(k,$b.v7b,!0)};bb.Vii=function(k){return k.trimStart().startsWith($b.gEf)||k.trimEnd().endsWith($b.fEf)};Object(ie.a)(bb,"FormulaAssistanceReadoutHandler",null,[758,3]);var Wi=si.a;Wl(Ua,Wi);Ua.prototype.create=function(){var k=this,F=this.$.da;Ud.TaskExtensions.Ba(eh.GetServiceTaskFactory.Xa(F,
211,212,this.vb),function(X){X=F.za(219)||new bb(X.result,k.$);k.Eb(X)},this.la,3)};Ua.ka=function(k){k.da.Ga(220,new Ua(k))};Object(ie.a)(Ua,"FormulaAssistanceReadoutHandlerFactory",si.a,[]);var Ni=b(736),Ej=b(113),Zi=b(1180);ja.prototype.lgd=function(k){return this.uQa&&k in this.uQa?this.uQa[k]:null};ja.prototype.M5f=function(k,F){this.uQa||(this.uQa={});this.uQa[k]=F};ja.prototype.VZ=function(){this.uQa=null};Object(ie.a)(ja,"FormulaAssistanceContextualPreviewCache",null,[]);Za.prototype.dispose=
function(){this.Pd||(this.$&&(this.$.ea.LF(this.cD),this.$=null),this.Cha=this.NFb=null,this.Pd=!0)};Za.prototype.Xcd=function(k,F,X,ra){var ab=this;if(F&&0>=F.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!k)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.da.za(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");
var Qb="="+F.substring(X.start,X.end);ve.EwaSettings.ma(597)&&(Qb=this.calcManager.fXh(ff.g(this.$).ha.ta.activeCell,k,X));var Fc=this.rKh(Qb,X);if(ve.EwaSettings.ma(597)){if(Fc&&!this.calcManager.isFormulaSubExpressionVolatile(k))return Promise.resolve(Fc)}else if(Fc)return Promise.resolve(Fc);return this.tKh(Qb,X).then(function(ld){if(ab.K_c(ra))throw Error.create("OperationCanceledException");if(!ld||ld.Ofj||ld.gna.startsWith("##UNSUPPORTED:"))return ab.nXe(F,Qb,X,ra);ab.Cha.M5f(Qb,ld.gna);return Promise.resolve(ld)})};
Za.prototype.rKh=function(k,F){return(k=this.Cha.lgd(k))?new Zi.a(k,F.start,F.end,0):null};Za.prototype.tKh=function(k,F){if(!k||0>=k.length||!F)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.ESg(ff.g(this.$).ha.ta.activeCell,k,this.Hxi,F)};Za.prototype.nXe=function(k,F,X,ra){var ab=this;if(!k||0>=k.length||!F||0>=F.length||!X)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");
if(this.OOa)return this.sKh(k,F,X,ra);var Qb={};Qb.PartialFormula=F;Qb.Formula=k;Qb.SourceRange=vd.v(ff.g(this.$).ha.ta.activeCell,this.$);return this.OOa=new Promise(function(Fc,ld){ab.NFb=new Ni.a;ab.KRf=ab.$.ea.Te;ab.w$a=wa(ab.$.na.va,Qb,function(ud){ab.CSi(F,X,ra,ud,Fc,ld)},function(ud){ab.OOa=null;ab.w$a=null;ld(ud)},null,null,null);ab.NFb.token.R(function(){ab.iUg(ld)})})};Za.prototype.CSi=function(k,F,X,ra,ab,Qb){this.w$a=this.OOa=null;if(this.KRf!==this.$.ea.Te)Qb(Error.create("OperationCanceledException"));
else if(ra.Result)if(ra=jg.a.ni(ra.Result),!ra||Ej.a.isEmpty(ra))ab(null);else{for(var Fc in ra)this.Cha.M5f(Fc,ra[Fc]);this.K_c(X)?Qb(Error.create("OperationCanceledException")):(k=this.Cha.lgd(k))?(""===k&&(k=" "),ab(new Zi.a(k,F.start,F.end,0))):Qb(Error.create("SubexpressionNotFoundException"))}else ab(null)};Za.prototype.sKh=function(k,F,X,ra){var ab=this;return new Promise(function(Qb,Fc){ab.OOa.then(function(){ab.vSf(k,F,X,ra,Qb,Fc)}).catch(function(){ab.vSf(k,F,X,ra,Qb,Fc)})})};Za.prototype.vSf=
function(k,F,X,ra,ab,Qb){if(this.K_c(ra))Qb(Error.create("OperationCanceledException"));else{var Fc=this.Cha.lgd(F);Fc?ab(new Zi.a(Fc,X.start,X.end,0)):this.nXe(k,F,X,ra).then(function(ld){ab(ld)}).catch(function(ld){Qb(ld)})}};Za.prototype.iUg=function(k){this.w$a&&(pi.a.yu(this.w$a.Pt)?(this.OOa=this.w$a=null,k(Error.create("PendingWebReqeuestCancelled"))):Wd.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))};Za.prototype.VZ=function(){this.jUg();this.Cha&&this.Cha.VZ()};
Za.prototype.jUg=function(){this.NFb&&this.NFb.C()};Za.prototype.K_c=function(k){return this.Pd||k.eK};Object(ie.a)(Za,"FormulaAssistanceContextualPreviewCalculator",null,[3]);var Ah=b(222);ub.Vnh="ewa-facp-text-box";Object(ie.a)(ub,"CssClassNames",null,[]);ad.prototype.dispose=function(){(this.I$||this.bQ)&&this.c7e();this.Ya=this.Cqa=null};ad.prototype.ZOj=function(k,F,X,ra){k&&F&&ra&&F.gna&&!(1>F.gna.length)&&(this.Ya=k,this.oOf(),this.Z1a=F,this.CSa=ra,this.Axj(F,X,ra))};ad.prototype.c7e=function(){this.R4h();
this.oOf();this.CSa=this.Z1a=null};ad.prototype.Axj=function(k,F,X){var ra=this;if(k.gna&&!(1>k.gna.length)){var ab=this.Rc.da.za(266);if(ab){var Qb=ab.pQh();Qb&&Ud.TaskExtensions.Ba(this.HBb,function(){if(F)if(ve.EwaSettings.ma(597)&&ra.Ya.isEditing&&0<X.length){ra.jxb(k.uJa,X[0].start,null);var Fc=ra.e2e(X[0],Qb),ld=ra.Ya.text.substring(X[0].start,X[0].end).trim();ld=ra.Ya.text.indexOf(ld);ld=ra.Ya.text.substring(0,ld).lastIndexOf("\n");ra.jxb(0>ld||1>=X.length?X[0].start:ld+1,X[0].end,Fc?String.format(Fc,
.3):null);for(var ud=1;ud<X.length;ud++)Fc=ra.e2e(X[ud],Qb),ld=ra.Ya.text.substring(X[ud].start,X[ud].end).trim(),ld=ra.Ya.text.indexOf(ld),ld=ra.Ya.text.substring(X[ud-1].end,ld).lastIndexOf("\n"),ra.jxb(0>ld?X[ud-1].end:ld+1+X[ud-1].end,X[ud].end,Fc?String.format(Fc,.3):null);ld=ra.Ya.text.substring(X[X.length-1].end,k.Pua).indexOf("\n");ra.jxb(0>ld?X[X.length-1].end:ld+1+X[X.length-1].end,k.Pua,null);Wd.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else ra.jxb(k.uJa,
k.Pua,null),Wd.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");ra.I$||(ra.I$=document.createElement(Ah.a.div),ra.Ya.textBox.domElement.appendChild(ra.I$));ra.bQ||(ra.bQ=document.createElement(Ah.a.div),ra.bQ.className=ub.Vnh,ra.Rc.domElement.appendChild(ra.bQ));Fc=k.Pua;ve.EwaSettings.ma(597)&&ra.Ya.isEditing&&X&&0<X.length&&X[0].start<Fc&&X[0].start!==k.uJa&&!ra.Ya.textBox.xv.length&&
(Fc=X[0].start);ud=Z.a.contains(ra.Ya.textBox.ef.id,"FormulaBar",!0)&&Z.a.contains(ra.Ya.text.substring(k.uJa,k.Pua),"\n",!0);ld=ra.Ya.isEditing?ra.Ya.textBox.caretPosition:0;Fc=excelOnline.utils.getBoundingRectForText(ra.Ya.textBox.ef,ud?ld:k.uJa,ud?ld:Fc,ve.EwaSettings.ma(597));ra.bQ.style.left=Sc.HelperMethods.uc(Fc.left);ra.bQ.style.top=Sc.HelperMethods.uc(Fc.top);ra.bQ.style.width=Sc.HelperMethods.uc(Fc.width);ra.bQ.style.height=Sc.HelperMethods.uc(Fc.height);Fc=String.format("FormulaAssistancePreviewToolTip_{0}_{1}",
k.Pua,k.Pua);dialogControls.renderToolTip(ra.I$,Fc,k.gna,ra.bQ,0,!1,!1,1)},this.Rc.la,3)}}};ad.prototype.e2e=function(k,F){var X=this.Ya.text,ra=X.substring(k.start,k.end);ra=ra.trim();k=X.indexOf(ra,k.start);F=X.indexOf(F,k);ra=X.substring(k,F);ra=ra.trim();return this.Ya.colors.getItem(k+"-"+(k+ra.length))};ad.prototype.R4h=function(){var k=this;this.Ya&&this.I$&&this.bQ&&Ud.TaskExtensions.Ba(this.HBb,function(){k.Ya.textBox.domElement.contains(k.I$)&&(dialogControls.clearToolTip(k.I$),k.Ya.textBox.domElement.removeChild(k.I$),
k.I$=null);k.Rc.domElement.contains(k.bQ)&&(k.Rc.domElement.removeChild(k.bQ),k.bQ=null)},this.Rc.la,3)};ad.prototype.jxb=function(k,F,X){if(this.Ya&&!(k>=F)){var ra={};this.Ya.textBox.formatText(k,F-k,(ra.background=X||"#E3DDCC",ra));this.Did=!0}};ad.prototype.oOf=function(){if(this.Ya&&this.Z1a&&this.Did){var k=this.Z1a.Pua;ve.EwaSettings.ma(597)&&0<this.CSa.length&&this.CSa[this.CSa.length-1].end>k&&(k=this.CSa[this.CSa.length-1].end);var F={};this.Ya.textBox.formatText(this.Z1a.uJa,k-this.Z1a.uJa,
(F.background=!1,F));this.Did=!1}};Ck.Object.defineProperties(ad.prototype,{HBb:{configurable:!0,enumerable:!0,get:function(){var k=this;if(this.Cqa)return this.Cqa;var F=new Gb.a;this.Rc.LC(function(X){Ud.TaskExtensions.Ba(X.Ssd(),function(){F.setResult(!0)},k.Rc.la,3)});return this.Cqa=F.task}}});Object(ie.a)(ad,"FormulaAssistanceContextualPreviewControl",null,[3]);var mi=b(47),$i=b(43);vc.prototype.k2f=function(k,F,X){X?this.e5g(k,F,X):this.p4e(k,F,X,!0)};vc.prototype.tej=function(){this.U7=0};
vc.prototype.e5g=function(k,F,X){var ra=this;this.U7++;var ab=this.U7;mi.a.instance.create(function(){ra.p4e(k,F,X,ab===ra.U7)},500,$i.a.CCh,!0,!0)};vc.prototype.p4e=function(k,F,X,ra){var ab=this,Qb=this.fbd.Xcd(k,F);Qb&&Qb.then(function(Fc){ra&&ab.fbd.kod(F)&&ab.fbd.YOj(k,Fc,X)}).catch(function(Fc){Fc=Object(ca.a)(Error,Fc);"OperationCanceledException"===Fc.message?Wd.ULS.sendTraceTag(537162059,0,50,"GetContextualFormulaPreviewResults - caught exception: {0}",Fc):Wd.ULS.sendTraceTag(537162058,0,
10,"GetContextualFormulaPreviewResults - caught exception: {0}",Fc)})};Object(ie.a)(vc,"FormulaAssistanceContextualPreviewHoverManager",null,[]);zb.prototype.dispose=function(){this.IZc();zg.a.Dc([this.cub,this.l$b]);this.m$b=this.l$b=this.cub=null;this.$&&ff.g(this.$).pc.Um(this.o9a);this.Aha=this.Ya=this.$=null};zb.prototype.Bxj=function(k,F){F&&Di.e(F.text)&&!(F.Awa||F.textBox.xv||this.Ya&&this.Ya.textBox.xv)&&(this.Ya=F,this.calcManager=this.$.da.za(266))&&(Wd.ULS.sendTraceTag(537162056,0,50,
"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),k=Sc.HelperMethods.Mub(k),k=this.calcManager.cXh(ff.g(this.$).ha.ta.activeCell,this.Ya.text,k.x,k.y),F=this.calcManager.getSubExpressionSpan(k),!F||F.end<=F.start||this.kod(F)||(this.Aha=F,this.m$b.k2f(k,F,!0)))};zb.prototype.iRd=function(k){if(k&&Di.e(k.text))if(k.textBox.xv&&k.textBox.xv.trim()){if(this.Ya=k,this.calcManager=this.$.da.za(266)){Wd.ULS.sendTraceTag(537162054,
0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");k={};var F=this.Ya.textBox.xv.trim();k.start=this.Ya.text.indexOf(F,this.Ya.textBox.caretPosition);k.end=k.start+F.length;(F=this.calcManager.getFormulaSubExpressionObject(ff.g(this.$).ha.ta.activeCell,this.Ya.text,this.Ya.textBox.xv))&&!this.kod(k)&&(this.Aha=k,this.m$b.k2f(F,k,!1))}}else this.U4a(!1,!0)};zb.prototype.U4a=function(k,F){!this.Ya||F&&this.Ya.textBox.xv||
(this.Aha=null,k&&(this.IZc(),this.l$b.VZ(),this.m$b.tej()),this.cub&&this.cub.c7e(),this.Ya.Awa||(this.Ya.Awa=!1,this.Ya=null))};zb.prototype.Xcd=function(k,F){if(!this.Ya||this.Ya.Awa)return null;this.IZc();this.srb=new Ni.a;return this.l$b.Xcd(k,this.Ya.text,F,this.srb.token)};zb.prototype.YOj=function(k,F,X){this.srb=null;!k||!F||!F.gna||0>=F.gna.length?this.U4a(!1,!1):(k=this.calcManager.dXh(ff.g(this.$).ha.ta.activeCell,k,this.Ya.text),this.cub.ZOj(this.Ya,F,X,k))};zb.prototype.kod=function(k){return this.Aha?
k.start===this.Aha.start&&k.end===this.Aha.end&&k.pre===this.Aha.pre&&k.post===this.Aha.post:!1};zb.prototype.IZc=function(){this.srb&&this.srb.C()};Object(ie.a)(zb,"FormulaAssistanceContextualPreviewManager",null,[749,3,750]);var bj=b(1259),ai=b(981),Ii=b(256),cj=b(168);sc.prototype.IYf=function(k){this.pT=0;this.o8d=k.IsCompatibility;this.set_name(k.NameDataStrings);this.KVa=k.Help};sc.prototype.koj=function(k){this.pT=1;this.set_name(k.Name)};sc.prototype.Mnj=function(k){this.pT=2;this.set_name(k.name);
this.KVa=k.tooltip};sc.prototype.ipj=function(k){this.pT=3;this.set_name(k.name);this.KVa=k.toolTip};sc.prototype.g_f=function(k){this.pT=4;this.set_name(k.name)};sc.prototype.Brj=function(k){this.pT=5;this.set_name(k.name);this.KVa=k.toolTip};sc.prototype.Arj=function(k){this.pT=7;this.set_name(k.name)};sc.prototype.Zpj=function(){this.pT=6;this.set_name(we.a.instance.Bb(183));this.KVa=we.a.instance.Bb(184)};sc.prototype.set_name=function(k){return this.M9d=k};sc.y9g=function(){return Object(na.a)(new sc(!0),
{})};Ck.Object.defineProperties(sc.prototype,{itemType:{configurable:!0,enumerable:!0,get:function(){return this.pT}},Mei:{configurable:!0,enumerable:!0,get:function(){return this.o8d}},name:{configurable:!0,enumerable:!0,get:function(){return this.label}},label:{configurable:!0,enumerable:!0,get:function(){return this.M9d}},gja:{configurable:!0,enumerable:!0,get:function(){return this.KVa}},cAb:{configurable:!0,enumerable:!0,get:function(){return this.Lqg}}});Object(ie.a)(sc,"AutoCompleteItem",null,
[818]);Object(ie.a)(Hb,"DefinedNameInfo",null,[]);Yb.prototype.vLj=function(k){var F=this.pGe[k.toUpperCase()];if(!F)return{returnValue:!1,sheetName:"",range:null};k=F.sheetName;F=this.d2g(F.namedRange);return{returnValue:!0,sheetName:k,range:F}};Yb.prototype.s2g=function(k){if(null!=k&&void 0!=k)return{top:k.top,left:k.left,bottom:k.bottom,right:k.right,maxRows:k.maxRows,maxColumns:k.maxColumns,sheetName:void 0}};Yb.prototype.d2g=function(k){if(null!=k&&void 0!=k)return new Mb.a(k.top,k.left,k.bottom,
k.right,k.maxRows,k.maxColumns)};Yb.prototype.l2g=function(k){switch(k){case 2:return 0;case 3:return 1;default:return-1}};Ck.Object.defineProperties(Yb.prototype,{oGe:{configurable:!0,enumerable:!0,get:function(){var k=[];if(!this.$.Hb||!this.$.Hb.items)return k;for(var F=0,X=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&O.a.NV(this.$),ra=Gl(this.$.Hb.items),ab=ra.next();!ab.done;ab=ra.next())if((ab=ab.value)&&(3===ab.type&&ab.usedRange||X&&2===ab.type)){var Qb=
new Hb;Qb.tooltip=ab.sheetName+fc.a.exclamation+ab.usedRange.toString();Qb.name=ab.name;Qb.namedRange=this.s2g(ab.usedRange);Qb.sheetName=ab.sheetName;Qb.type=this.l2g(ab.type);k.push(Qb);this.pGe[ab.name.toUpperCase()]=Qb;++F;if(F===$b.Nof){Wd.ULS.sendTraceTag(537162076,0,15,"Maximum number of defined names reached for formula assistance: {0}",$b.Nof);break}}return k}}});Object(ie.a)(Yb,"DefinedNameInfoManager",null,[]);var gi=b(128),Oh=Sys.EventArgs;Wl(sb,Oh);Object(ie.a)(sb,"FormulaAssistanceFunctionChangedEventArgs",
Sys.EventArgs,[]);var bi=Sys.EventArgs;Wl(mc,bi);Object(ie.a)(mc,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var ti=Sys.EventArgs;Wl(Vb,ti);Object(ie.a)(Vb,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var mh=b(272);bc.prototype.eg=function(k,F){k=!1;F||(ff.g(this.$).Nj.textBox.aK=!0,k=this.formulaAssistanceUIControl.focus(this.kUe));return k};bc.prototype.ph=function(k){var F=this.wc;return!(void 0===F||null===F)&&nf.DOMElementExtensions.Ff(F,k)};
bc.prototype.Aj=function(){this.G4e&&this.G4e()};bc.prototype.Qj=function(){};bc.prototype.dispose=function(){mh.a(this.$).Pz(this)};Ck.Object.defineProperties(bc.prototype,{canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.vZc},set:function(k){this.vZc!==k&&(k?mh.a(this.$).ai(this):mh.a(this.$).Pz(this),this.vZc=k)}},xe:{configurable:!0,enumerable:!0,get:function(){return this.Tjj}},wc:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceUIControl.getRootElement(this.kUe)}}});
Object(ie.a)(bc,"FormulaAssistanceFocusManager",null,[415,3]);var bk=b(1117),Mh=Ga.a;Wl(qd,Mh);qd.prototype.vYa=function(k){this.addHandler("FunctionInfoLoaded",k)};qd.prototype.Zab=function(k){this.removeHandler("FunctionInfoLoaded",k)};qd.prototype.qEg=function(k){this.addHandler("FunctionInfoReset",k)};qd.prototype.E$i=function(k){this.removeHandler("FunctionInfoReset",k)};qd.prototype.dispose=function(){var k=this.$.da.za(268);k&&k.AId(this.Cwf);this.xb=null;Mh.prototype.dispose.call(this)};qd.prototype.bSf=
function(){this.raiseEvent("FunctionInfoReset")};qd.prototype.hKd=function(){this.bSf();this.UKc=!1;this.lT=null;this.SKc=!0};qd.prototype.Q1a=function(k,F){var X=this;F=void 0===F?!1:F;if(this.e_)this.MJf();else{Wd.ULS.sendTraceTag(537161991,0,50,"Retrieving the list of function names for culture '{0}' from the server.",this.$.ya.UICultureTag);var ra=null;(ra=this.$.da.za(268))||Wd.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===ra||void 0===ra?0:ra.ija)&&
0<ra.ija.length)ve.EwaSettings.ma(122)?ra.cCh(this.Rwf):this.VGd(ra.ija,!0,!1);else{var ab=this.$.na.va.hc();k&&(this.$.ea.rc||F)&&!this.Hgi&&(F?rh.a(this.$.userOperationManager,function(Qb,Fc,ld){return Yg.x(X.$.na.va,k,hh.b(Qb,X.Twf),hh.a(Fc,X.Swf),ld,k,ab)},function(Qb){return new cg.a(130,0,Qb,16)},null):Yg.x(this.$.na.va,k,this.Twf,this.Swf,null,k,ab));!this.e_&&this.$.ea.rc&&(ra?(Wd.ULS.sendTraceTag(537161989,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded={0}, IsSessionActive={1}",
this.e_,this.$.ea.rc),ra.Hme(this.Cwf)):(Wd.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),Yg.x(this.$.na.va,{FilterType:0},this.Rwf,null,null,null,ab),this.SKc=!1))}}};qd.prototype.kOh=function(k){return 0>k||k>=this.lT.length?null:this.lT[k]};qd.prototype.$dd=function(k){return ji.a.Nc(this.Ibd,k.toUpperCase())};qd.prototype.Tac=function(k){return ji.a.Nc(this.zJa,k)};qd.prototype.kgc=function(k){return!k.GroupUI};
qd.prototype.Fwf=function(k,F,X){var ra=qc.a(k);Wd.ULS.sendTraceTag(537161955,0,50,"FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult={0}",ra);ra?(ff.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.ea.Cp(k.Errors)):(this.VGd(k.Result,F,X),O.a.OV()&&!O.a.NV(this.$)&&this.iRj())};qd.prototype.VGd=function(k,F,X){Wd.ULS.sendTraceTag(537161954,0,50,"FunctionInfoManager.RefreshFunctionList: functionsInfo count = {0}, isCategorized = {1}, partialResult = {2} IsFullyLoaded = {3}",
k.length,F,X,this.e_);this.e_||(this.lT=k,this.qPg(F),this.UKc=!X,this.MJf())};qd.prototype.MJf=function(){this.raiseEvent("FunctionInfoLoaded")};qd.prototype.iRj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.w$b)};qd.prototype.qPg=function(k){function F(Bf,Tg){return Bf.NameUI.localeCompare(Tg.NameUI)}var X=we.a.instance.ga(1023),ra=[];this.zJa={};this.Q8=[];this.zJa[X]=ra;var ab=we.a.instance.ga(1024),Qb=[];this.Q8.push(X);this.Q8.push(ab);X=0;for(var Fc=this.lT.length;X<Fc;X++){var ld=
this.lT[X];ld.IsCompatibility||Qb.push(ld);var ud=ld.NameUI,jd=ld.NameDataStrings;this.Ibd[jd.toUpperCase()]||(this.Ibd[jd.toUpperCase()]=ld);this.NUe[ud.toUpperCase()]||(this.NUe[ud.toUpperCase()]=ld);if(!this.kgc(ld)){if(k){ud=ld.GroupUI;var Ye=ji.a.Nc(this.zJa,ud);Ye||(Ye=[],this.zJa[ud]=Ye,this.Q8.push(ud));Ye.push(ld)}ld.IsCommonlyUsed&&ra.push(ld);ld.IsCompatibility||this.fog.push(jd)}}this.zJa[ab]=Qb;k&&(qd.ENf(ra,[2,3,0,5,4,9,1,7,8,6]),ra=Array(14),ra[0]=0,ra[1]=1,ra[2]=7,ra[3]=11,ra[4]=5,
ra[5]=2,ra[6]=6,ra[7]=10,ra[8]=9,ra[9]=3,ra[10]=4,ra[11]=13,ra[12]=12,ra[13]=8,qd.ENf(this.Q8,ra),ra=[],Array.addRange(ra,this.Q8),Array.removeAt(ra,13),this.Q8=ra);this.lT=Array.clone(this.lT);this.lT.sort(function(Bf,Tg){return Bf.NameDataStrings.localeCompare(Tg.NameDataStrings)});ra=1;for(ab=this.Q8.length;ra<ab&&k;ra++)this.zJa[this.Q8[ra]].sort(F);k=0;for(ra=this.lT.length;k<ra;k++)this.lT[k].FunctionIndex=k};qd.ENf=function(k,F){for(var X=Array.clone(k),ra=0;ra<X.length&&ra<F.length;ra++)k[ra]=
X[F[ra]]};Ck.Object.defineProperties(qd.prototype,{e_:{configurable:!0,enumerable:!0,get:function(){return this.UKc}},Hgi:{configurable:!0,enumerable:!0,get:function(){return this.SKc}},w$b:{configurable:!0,enumerable:!0,get:function(){var k=this.lT,F=bk.a(this.$);if(!F)return k;F=F.zNh();var X=F.length;if(0>=X)return k;var ra=[];Array.addRange(ra,k);for(k=0;k<X;k++){var ab=F[k],Qb={};Qb.FunctionIndex=ra.length;Qb.HelpId=Qb.GroupUI=null;Qb.Help=ab.description;Qb.IsCommonlyUsed=Qb.IsCompatibility=
!1;Qb.NameDataStrings=ab.name;Qb.NameUI=ab.name;Qb.Params=null;Qb.ParamsHelp=null;ra.push(Qb)}return ra}},ybd:{configurable:!0,enumerable:!0,get:function(){return this.Q8}},$:{configurable:!0,enumerable:!0,get:function(){return this.xb}}});Object(ie.a)(qd,"FunctionInfoManager",Ga.a,[741,742,3]);var kk=b(88),Sj=b(915),fl=kk.a;Wl(yc,fl);yc.prototype.dispose=function(){this.ITd&&(Ij.a.instance.Aa(Gg.a.vh,this.VIe,this.Avf),this.ITd=!1);this.rMb&&(this.rMb=!1,Ij.a.instance.Aa(Gg.a.Zd,this.domElement.ownerDocument.body,
this.szd),Ij.a.instance.Aa(Gg.a.vh,this.domElement.ownerDocument.body,this.rzd));this.V3=this.R4d=null;fl.prototype.dispose.call(this)};yc.prototype.Kke=function(k){this.V3?this.V3.push(k):this.V3=[k]};yc.prototype.Ind=function(k){if(this.V3)for(var F=0,X=this.V3.length;F<X;++F)if(nf.DOMElementExtensions.Ff(this.V3[F],k))return!0;return!1};yc.prototype.pSa=function(k){this.h7b||(this.lfa=!0,Z.a.equals(this.domElement.currentStyle.position,"absolute",!0)||(this.domElement.style.position="absolute"),
this.Ekh(),Ij.a.instance.pa(Gg.a.Zd,this.domElement.ownerDocument.body,this.szd),Ij.a.instance.pa(Gg.a.vh,this.domElement.ownerDocument.body,this.rzd),this.rMb=!0,this.drag(!0,k))};yc.prototype.drag=function(k,F){Ng.g(F);var X=new sk.a(0,0);F=new Sys.UI.Point(F.clientX,F.clientY);var ra=this.domElement.parentNode,ab=Sj.a.As(X,ra,F,this.isRtl());k?(X=Sj.a.YE(X,ra,this.domElement,this.isRtl()),this.x1a=Sj.a.xD(ab,X),this.J7=ab,this.rJc=!1):!this.N3h&&this.J3h(ab,this.J7)&&(this.rJc=!0);X=Sj.a.xD(ab,
this.x1a);Sj.a.scb(ra,this.domElement,X,this.isRtl(),k);this.frg=F};yc.prototype.lz=function(k){this.rMb&&(this.rMb=!1,Ij.a.instance.Aa(Gg.a.Zd,this.domElement.ownerDocument.body,this.szd),Ij.a.instance.Aa(Gg.a.vh,this.domElement.ownerDocument.body,this.rzd));Ng.g(k);this.lfa=!1;this.J7=this.x1a=null};yc.prototype.m6=function(k){var F=Sc.HelperMethods.Rn(k);F.button===Sys.UI.MouseButton.leftButton&&2===k.zb&&this.lz(F);return!1};yc.prototype.wN=function(k){2===k.zb&&this.drag(!1,Sc.HelperMethods.Rn(k));
return!1};yc.prototype.J3h=function(k,F){return F.x<k.x-2||F.x>k.x+2||F.y<k.y-2||F.y>k.y+2};yc.prototype.Ekh=function(){this.offsetParent=this.domElement.offsetParent||this.domElement.ownerDocument.body;this.YDi=nf.DOMElementExtensions.getLocation(this.offsetParent)};Ck.Object.defineProperties(yc.prototype,{h7b:{configurable:!0,enumerable:!0,get:function(){return this.lfa}},VIe:{configurable:!0,enumerable:!0,get:function(){return this.R4d}},N3h:{configurable:!0,enumerable:!0,get:function(){return this.rJc}}});
Object(ie.a)(yc,"BaseDraggableBehavior",kk.a,[]);Wl(Rb,yc);Rb.prototype.setVisible=function(k){nf.DOMElementExtensions.setVisible(this.domElement,k);k||(this.domElement.style.top="auto",this.domElement.style.left="auto")};Rb.prototype.isRtl=function(){return this.kj};Rb.prototype.vRa=function(k){var F=this.domElement.style;F.cursor="move";F.position=k?"relative":"absolute"};Object(ie.a)(Rb,"FunctionParamBoxDraggableItem",yc,[]);Object(ie.a)(Ja,"FormulaArgumentAssistanceCallbacks",null,[]);Object(ie.a)(Eb,
"FormulaArgumentAssistanceRenderingInfo",null,[]);Object(ie.a)(zc,"ArgumentAssistanceRequest",null,[]);Bb.prototype.ka=function(k){(this.root=k)&&!this.rn&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.rn=!0)};Bb.prototype.detach=function(){this.root&&this.rn&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.rn=!1)};Bb.prototype.U7b=function(){this.root&&(this.target=this.$G.qCf("move",!0),this.iTd=this.target.getBoundingClientRect(),this.QZ=!0,this.kQd=!1,this.sv(),this.olc||
this.A3c(),this.target.appendChild(this.olc))};Bb.prototype.i4=function(k){this.$G.Svf(void 0===k?!1:k);this.QZ=!1;this.bId();this.FHd();this.iTd=this.target=void 0};Bb.prototype.sv=function(){this.vr.capture(this.TMa,null);this.pointerInputManager.xt(Gg.a.pointerDown,this.target,this.WFb,!0);this.target.addEventListener("blur",this.onBlur)};Bb.prototype.FHd=function(){this.vr.releaseCapture();this.pointerInputManager.Dt(Gg.a.pointerDown,this.target,this.WFb,!0);this.target.removeEventListener("blur",
this.onBlur)};Bb.prototype.bId=function(){var k;this.target&&(null===(k=this.olc)||void 0===k?void 0:k.parentNode)===this.target&&this.target.removeChild(this.olc)};Bb.prototype.Y5=function(k,F){var X=this.target.getBoundingClientRect();k+=X.left-this.iTd.left;F+=X.top-this.iTd.top;this.$G.onMove(k,F)};Bb.prototype.A3c=function(){this.olc=Ik.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")};Object(ie.a)(Bb,"FormulaAssistanceMoveAdapter",null,[]);var gl=b(289);db.prototype.tba=
function(){return this.rn&&!!this.Oja};db.prototype.uOa=function(k){this.Oja.style.cursor="grabbing";this.kDj=k.clientPoint.x;this.lDj=k.clientPoint.y;this.$G.qCf("drag");return!0};db.prototype.Xla=function(k){this.$G.onMove(k.clientPoint.x-this.kDj,k.clientPoint.y-this.lDj);return!0};db.prototype.Wla=function(){this.lz()};db.prototype.Vla=function(){this.lz()};db.prototype.ka=function(k){if(this.Oja=k)this.Oja.style.cursor="grab",gl.a.instance.o0(this.Oja,this),this.rn=!0};db.prototype.detach=function(){this.rn&&
this.Oja&&(this.Oja.style.cursor="",gl.a.instance.a8(this.Oja,this),this.rn=!1)};db.prototype.lz=function(){this.Oja.style.cursor="grab";this.$G.Svf()};Object(ie.a)(db,"FormulaAssistanceDragAdapter",null,[832]);nb.prototype.ka=function(k,F,X,ra){this.root=k;this.render=X;this.dismiss=ra;this.detach();F&&(this.RIe.ka(F),this.Mpf.ka(k.firstChild),this.rn=!0)};nb.prototype.detach=function(){this.rn&&(this.RIe.detach(),this.Mpf.detach(),this.rn=!1);nf.DOMElementExtensions.zf(this.placeholder)};nb.prototype.clear=
function(){this.n$b.setOverrideTarget(void 0);this.detach();this.SJd()};nb.prototype.qCf=function(k,F){F=void 0===F?!1:F;this.usageCount[k]+=1;this.wyc=this.root.firstChild.getBoundingClientRect();this.placeholder=this.root.cloneNode(!0);k=this.placeholder.firstChild;k.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);F&&(this.sEd=document.activeElement,k.tabIndex=0,k.focus());this.dismiss();return k};nb.prototype.onMove=function(k,F){k=Math.min(Math.max(k,this.YCc-
this.wyc.left),window.innerWidth-this.wyc.right-this.YCc);F=Math.min(Math.max(F,this.YCc-this.wyc.top),window.innerHeight-this.wyc.bottom-this.YCc);this.placeholder.firstChild.style.transform="translate("+k+"px, "+F+"px)"};nb.prototype.Svf=function(k){var F=this;k=void 0===k?!0:k;var X=this.placeholder.firstChild.getBoundingClientRect(),ra=this.n$b.getDirectionalHint({top:X.top,left:X.left});this.n$b.setOverrideTarget({top:1===ra?X.bottom:X.top,left:X.left});this.render();window.requestAnimationFrame(function(){nf.DOMElementExtensions.zf(F.placeholder);
F.sEd&&(k&&F.sEd.focus(),F.sEd=void 0)})};nb.prototype.SJd=function(){var k=this.formulaAssistanceTelemetryManager.b$,F=this.usageCount[fj.Drag],X=this.usageCount[fj.Move];0<F&&(k.argumentAssistanceDragCounter+=1,k.argumentAssistanceDragTotalCounter+=F,this.usageCount[fj.Drag]=0);0<X&&(k.argumentAssistanceMoveCounter+=1,k.argumentAssistanceMoveTotalCounter+=X,this.usageCount[fj.Move]=0)};Object(ie.a)(nb,"FormulaAssistanceDragControl",null,[]);var fj;(function(k){k.Drag="drag";k.Move="move"})(fj||
(fj={}));Object(ie.b)("FormulaAssistanceDragMode",fj);var Gj=Fi.a;Wl(Nb,Gj);Nb.prototype.Ime=function(k){this.addHandler("FAFunctionNameUpdated",k)};Nb.prototype.mPf=function(k){this.removeHandler("FAFunctionNameUpdated",k)};Nb.prototype.xne=function(k){this.addHandler("FAParameterSelectionChangedOld",k)};Nb.prototype.JPf=function(k){this.removeHandler("FAParameterSelectionChangedOld",k)};Nb.prototype.wne=function(k){this.addHandler("FAParameterSelectionChanged",k)};Nb.prototype.IPf=function(k){this.removeHandler("FAParameterSelectionChanged",
k)};Nb.prototype.set_visible=function(k){this.Hk?k||this.dsb():Sys.UI.Control.prototype.set_visible.call(this,k);return k};Nb.prototype.dsb=function(){this.formulaAssistanceUIControl&&(this.Yq=null,this.fR&&this.$G.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.$ka=null,this.rr.canReceiveFocus=!1)};Nb.prototype.show=function(k){this.Hk||(this.formulaAssistanceTelemetryManager.sX(["argumentAssistanceRender"]),this.z1a.setVisible(!!k),this.formulaAssistanceTelemetryManager.uQ(["argumentAssistanceRender"]),
this.EWc&&(this.EWc=!1,this.formulaAssistanceTelemetryManager.G7b("argumentAssistanceOverall")))};Nb.prototype.WJd=function(){var k=this;if(!this.rba||this.JRa){this.formulaAssistanceTelemetryManager.sX(["argumentAssistanceComputation","argumentAssistanceOverall"]);var F=ff.g(this.$).Nj;this.pluginScheduler.requester().argumentAssistance(Object(na.a)(new zc,{content:F.text,caretPosition:F.textBox.caretPosition})).then(function(X){0===X.kind?X.payload?(k.formulaAssistanceTelemetryManager.uQ(["argumentAssistanceComputation"]),
k.fxj(k.QDd(X.payload),F.textBox.domElement)):k.dsb():k.formulaAssistanceTelemetryManager.uQ(["argumentAssistanceComputation"],!1);return null})}};Nb.prototype.update=function(k,F,X,ra){if(!this.Hk&&k){this.formulaAssistanceTelemetryManager.sX(["argumentAssistanceComputation","argumentAssistanceOverall"]);this.EWc=!0;var ab=this.$.listSeparator;try{var Qb=$get($b.Gbd,this.Lj),Fc=$get($b.zbd,this.Lj);Qb.innerText="";Fc.innerText="";var ld=$get($b.JUe,this.Lj),ud=k.Params.split($b.I9c);Qb=[];Fc=0;for(var jd=
ld.rows.length;Fc<jd;Fc++){var Ye=ld.rows[Fc];nf.DOMElementExtensions.setVisible(Ye,Fc<ud.length);var Bf=ud[Fc],Tg=$b.LUi+Fc+"_",$g=k.NameDataStrings;$get(Tg+$b.yFb,Ye).innerText=$g;$get(Tg+$b.sCd,Ye).innerText=$g;if(Bf){var Wg=ud[Fc].split(ab),qh=Nb.xnd(Wg[Wg.length-1]),Ri=Nb.Zii(k);qh&&(Ri&&(2<Wg.length?(Wg[Wg.length-2]+="1",Wg[Wg.length-3]+="1"):Wd.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",
$g,Wg.length.toString(),F)),Nb.yJg(Wg,Ri,F,k));Bf=Wg.join(ab.toString()+" ");ud[Fc]=Bf;X<Wg.length?(Qb[Fc]=Wg[X],Wd.ULS.shipAssertTag(537162072,0,!!Wg[X]&&1<=Wg[X].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",X,Wg.length,$g,Fc),Wg[X]=String.format("{0}{1}{2}","<b>",Wg[X],"</b>"),Bf=Wg.join(ab.toString()+" ")):Wd.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+
X+"currRowParamsArray.Length = "+Wg.length+", current row = "+Fc);ra&&Wd.ULS.sendTraceTag(558474578,0,50,"formula '{0}', {1} params, isElipsis = {2}, isPairsParamsFormula = {3}, currentParameterIndex = {4}",$g,Wg.length,qh,Ri,F)}$get(Tg+$b.tCd,Ye).innerHTML="("+(Bf||"")+")"}ra?this.raiseEvent("FAFunctionNameUpdated",new sb(k.NameDataStrings,ud)):this.raiseEvent("FAParameterSelectionChangedOld",new Vb(ud,Qb,X));ld.className=ai.a.Coh+(this.functionInfoManager.kgc(k)?"-udf":"")}catch(ci){throw Wd.ULS.shipAssertTag(558474577,
0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",k.NameDataStrings,F,ci),ci;}this.formulaAssistanceTelemetryManager.uQ(["argumentAssistanceComputation"])}};Nb.prototype.dispose=function(){this.Hk||(this.Kc.xC(),zg.a.Ha(this.Kc),ff.g(this.$).view.Xq(this.qt),zg.a.Ha(this.z1a),this.z1a=null);this.Hk&&zg.a.Ha(this.rr);this.rba&&ff.g(this.$).tc.Um(this.Tf);this.functionInfoManager=this.$=null;Gj.prototype.dispose.call(this)};Nb.prototype.QDd=function(k){var F=new Eb;
F.functionRenderingInfo=k;F.cardMode=this.R2;this.uHd(F);return F};Nb.prototype.uHd=function(k){k.callbacks=new Ja;k.callbacks.onHelpLink=this.lvb(k.functionRenderingInfo);k.callbacks.onCardModeChange=this.onCardModeChange;k.callbacks.onFeedback=this.YQa;this.rba&&(k.callbacks.onDismissClick=this.onDismissClick)};Nb.prototype.fxj=function(k,F){var X=this;if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.sX(["argumentAssistanceRender"]);var ra={};ra.zoomLevel=cb(this.$);this.formulaAssistanceUIControl.updateContext(ra);
this.Yq=function(){X.formulaAssistanceUIControl.renderArgumentAssistanceCard(X.domElement,F,k)};this.Yq();this.TCd(k);this.fR&&this.$G.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Yq,function(){return X.formulaAssistanceUIControl.dismiss(X.domElement)});this.rr.canReceiveFocus=!0;this.formulaAssistanceTelemetryManager.uQ(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.G7b("argumentAssistanceOverall")}};Nb.prototype.lvb=
function(k){var F=this;return function(){Ha(F.$,k.helpID,k.isUDF)}};Nb.prototype.hOd=function(){var k=gi.a.get(We.a.H_b);this.R2=k?parseInt(k,10):Nb.r5c;this.formulaAssistanceTelemetryManager.mXf(this.R2)};Nb.prototype.TCd=function(k){var F=k.functionRenderingInfo.functionName;this.$ka&&Z.a.equals(this.$ka,F,!0)?(F=Bg.a.map(k.functionRenderingInfo.signatures,function(X){var ra="";0<=X.signatureParams.activeParam&&X.signatureParams.activeParam<X.signatureParams.params.length&&(ra=X.signatureParams.params[X.signatureParams.activeParam]);
return ra}),this.raiseEvent("FAParameterSelectionChanged",new mc(F))):(this.$ka=F,k=Bg.a.map(k.functionRenderingInfo.signatures,function(X){return X.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new sb(F,k)))};Nb.prototype.PNb=function(k){this.R2=k;try{gi.a.Cv(We.a.H_b,k.toString(),Lj.AFrame.qea)}catch(F){Wd.ULS.sendTraceTag(537162070,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",F.message)}};Nb.xnd=function(k){return Z.a.contains(k,
$b.v7b,!0)};Nb.Zii=function(k){return!!k&&Z.a.M1a(k.NameDataStrings,"IFS")};Nb.yJg=function(k,F,X,ra){try{if(!k||2>k.length)Wd.ULS.shipAssertTag(537162069,0,!1,"Requested not on elipsis function, formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}.",ra.NameDataStrings,k?k.length.toString():"currRowParamsArray == null",F,X);else{for(var ab=k.pop().toString(),Qb=k.length-1;Qb<X;Qb++){var Fc=k[Qb].trim();if(F){var ld=k[Qb-1].trim();k.push(Nb.mFh(ld,Fc))}else{var ud=Nb.Y8e(Fc);
k.push(Nb.kVe(ud))}}k.push(ab)}}catch(jd){throw Wd.ULS.shipAssertTag(537162068,0,!1,"AppendNewOptionalParameters Exception. formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}. \nException: {4}",ra.NameDataStrings,k?k.length.toString():"currRowParamsArray == null",F,X,jd),jd;}};Nb.mFh=function(k,F){k=Nb.Y8e(k);var X=Nb.f0e(k);F=Nb.f0e(F);return Nb.kVe(k,!0,!!X&&!!F&&X!==F)};Nb.Y8e=function(k){var F=k.match(Nb.gyd);k=Z.a.trimEnd(Z.a.trimStart(k,$b.gEf),$b.fEf);if(F&&
F.length){F=F[F.length-1];var X=Number.parseLocale(F)+1;k=k.replace(F,X.toString())}else k=String.format("{0}{1}",k,1);return k};Nb.kVe=function(k,F,X){var ra="[{0}]";(void 0===F?0:F)&&(ra=(void 0===X?0:X)?"[{0}":"{0}]");return String.format(ra,k)};Nb.f0e=function(k){return(k=k.match(Nb.gyd))&&k.length?k[0]:null};Nb.CJa=function(k){if(k)return document.createElement("div");k=String.format($b.OEf,$b.MEf,$b.sCd,ai.a.TMe,$b.yFb,ai.a.SMe,$b.tCd);var F=String.format($b.OEf,$b.NEf,$b.sCd,ai.a.TMe,$b.yFb,
ai.a.SMe,$b.tCd);k=String.format($b.GDh,$b.HDh,ai.a.NNe,ai.a.Alh,pb.a.$p,$b.JUe,k,F);F=document.createElement("div");F.innerHTML=k;return F.firstChild};Nb.gyd=RegExp("\\d+");Nb.r5c=0;Object(ie.a)(Nb,"FormulaArgumentAssistanceControlDeprecated",Fi.a,[817]);Object(ie.a)(nc,"ParseContext",null,[]);var dj=b(335),Qi=jk.a;Wl(cc,Qi);cc.prototype.Xh=function(k,F){this.formulaAssistanceControl.Ya=this.Ya;-1470715894!==F&&-1231471547!==F||!this.kHe()||(this.UV=!1);return Qi.prototype.Xh.call(this,k,F)};cc.prototype.Hyd=
function(){var k=this.l5a;if(k||this.IQd)if(this.formulaAssistanceControl.Ya=this.Ya,this.formulaAssistanceTelemetryManager.tob.formulaAssistanceRequestAttemptedCounter++,this.kHe())if(!k&&this.IQd)this.formulaAssistanceControl.Are();else if(ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)&&this.i7h){if(k=this.$.Pb.Gc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.Cre(),k.stop(),this.nob.text.endsWith("[")&&
"["!==this.nob.text.charAt(this.nob.text.length-2)){var F=""===this.THa?this.formulaAssistanceControl.tableManager.Eg:Object(ca.a)(dj.a,this.$.Hb.getItemByName(this.THa));Wd.ULS.sendTraceTag(575776010,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id {0} in {1} ms with cell edit regression time of {2} ms and popup visibility - {3}",F.ij,k.Bc,this.Ekd,this.UV)}}else this.formulaAssistanceControl.cob(),
this.JDf&&(this.JDf=this.UV=!1);else this.formulaAssistanceTelemetryManager.tob.formulaAssistanceRequestOptimizedCounter++;else this.UV=!1};cc.prototype.fj=function(){this.Q8i||(this.NRa=null,this.IQd&&this.formulaAssistanceControl.BZ())};cc.prototype.Tf=function(){this.UV=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.ztc();this.Hk&&this.mti()};cc.prototype.jFd=function(k,F){return this.formulaAssistanceControl.Xh(k,F)};cc.prototype.mti=function(){this.formulaAssistanceControl.KAa&&
(this.formulaAssistanceTelemetryManager.mV.smartSuggestionShownCounter++,this.formulaAssistanceControl.KAa=!1);this.formulaAssistanceControl.iSa&&(this.formulaAssistanceTelemetryManager.mV.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.iSa=!1);this.formulaAssistanceControl.hSa&&(this.formulaAssistanceTelemetryManager.mV.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.hSa=!1);this.z2&&(this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.mV.isCellContentOnlyEqualDuringEditCounter++,
this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit=!1),this.formulaAssistanceControl.NLa&&(this.formulaAssistanceTelemetryManager.mV.isCellContentFormulaCounter++,this.formulaAssistanceControl.NLa=!1))};cc.prototype.CUg=function(k,F){for(var X=0,ra;-1!==X;)if(X=k.indexOf("[",X+1),-1!==X&&X<F&&(ra=k.indexOf("]",X+1),-1===ra||ra>=F))return X;return-1};cc.prototype.kHe=function(){var k=this.Ya.text,F=this.Ya.textBox.caretPosition,X=this.formulaAssistanceControl.eNa,ra=this.formulaAssistanceControl.dNa;
if(this.UV&&Z.a.equals(k,X,!0)&&F===ra)return!1;this.formulaAssistanceControl.eNa=k;this.formulaAssistanceControl.dNa=F;return!0};Ck.Object.defineProperties(cc.prototype,{Cyb:{configurable:!0,enumerable:!0,get:function(){return Object(Xi.a)(Ib,this.$.Ab.lh)}},UV:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl.isListVisible},set:function(k){this.formulaAssistanceControl.isListVisible=k}},l5a:{configurable:!0,enumerable:!0,get:function(){return this.Ya.l5a}},i7h:{configurable:!0,
enumerable:!0,get:function(){var k=this.nob.text,F=!1;if(0>=k.length)return F;var X=this.$.Pb.Gc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),ra=ff.g(this.$).ha.ta.activeCell.clone(),ab=k.charCodeAt(0);this.THa="";this.kQ=this.CUg(k,this.nob.caretPosition);ab=61===ab&&-1!==this.kQ;if(!ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))ab&&(F=!0);else if(ab){if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){ab=
0;for(var Qb=this.kQ-1;1<=Qb&&!(this.kQ-Qb>cc.Jof);Qb--)if(Array.contains(cc.zte,k.charAt(Qb))){ab=Qb;break}ab=k.substring(ab+1,this.kQ);k=""!==ab?this.$.Hb.getItemByName(ab):null;Qb=this.kQ;for(var Fc=this.kQ+1;Fc<=this.Ya.textBox.caretPosition;Fc++)if("["===this.Ya.text.charAt(Fc))Qb=Fc;else break;this.kQ=Qb}else{ab=k.lastIndexOf("[");Qb=0;for(Fc=ab-1;1<=Fc&&!(ab-Fc>cc.Jof);Fc--)if(Array.contains(cc.zte,k.charAt(Fc))){Qb=Fc;break}ab=k.substring(Qb+1,ab);k=""!==ab?this.$.Hb.getItemByName(ab):null}k&&
2===k.type?(F=!0,this.THa=ab):ff.g(this.$).Nb.rj(ra)&&(F=!0,this.THa="")}X.stop();this.Ekd=X.Bc;Wd.ULS.sendTraceTag(575776011,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is {0} milliseconds",this.Ekd);return F}},key:{configurable:!0,enumerable:!0,get:function(){return Yk.a.V2a}},calcManager:{configurable:!0,enumerable:!0,get:function(){this.QFc||(this.QFc=this.$.da.za(266,!1));return this.QFc}},IQd:{configurable:!0,
enumerable:!0,get:function(){if(null!=this.NRa)return this.NRa;if(!ve.EwaSettings.ma(136))return this.NRa=!1;var k=ff.g(this.$).ha.ta.activeCell.clone();if(1!==k.sof||!k.left||ff.g(this.$).ha.ta.Jgc())return!1;var F=this.formulaAssistanceControl.tableManager.nn(k);if(F)return this.NRa=!1;--k.left;--k.right;if(!k.isValidRange)return!1;F=this.formulaAssistanceControl.tableManager.nn(k);return this.NRa=!!F&&k.top===F.top&&this.formulaAssistanceControl.tableManager.e3g(F,ff.g(this.$))}}});cc.zte=" !%&'()*+,-/:;<=>@[]^{|}~".split("");
cc.Jof=255;Object(ie.a)(cc,"FormulaAutoCompleteListAutoCompleteBehavior",jk.a,[]);var wj;(function(k){k[k.function=0]="function";k[k.field=1]="field";k[k.definedName=2]="definedName";k[k.letVariable=3]="letVariable";k[k.tableColHeaderName=4]="tableColHeaderName";k[k.tableSpecialStructRef=5]="tableSpecialStructRef";k[k.pendingData=6]="pendingData";k[k.tableNamedObject=7]="tableNamedObject"})(wj||(wj={}));Object(ie.b)("ItemType",wj);var Tj=b(1261),Ak=b(1260);Cb.prototype.execute=function(k){k.push(this.index)};
Object(ie.a)(Cb,"AppendIndexOperation",null,[831]);Sa.prototype.execute=function(){};Object(ie.a)(Sa,"NopIndexOperation",null,[831]);Ta.prototype.execute=function(k){for(var F=0;F<k.length;F++)k[F]===this.IZi&&(k[F]=this.Oqf)};Object(ie.a)(Ta,"ReplaceIndexOperation",null,[831]);Da.prototype.EDe=function(k,F){var X=new Cb(F);if(!this.eMa)return X;k=this.Gni(k,F);return null!=k?this.items[k].cAb?new Ta(k,F):new Sa:X};Da.prototype.Gni=function(k,F){var X=this,ra=this.items[F];Wd.ULS.shipAssertTag(537162075,
0,!!ra,"Internal error: invalid item index");k=Ba.where(Ba.asEnumerable(k),function(ab){return X.items[ab].name===ra.name});return Ba.Ct(k)?Ba.first(k):null};Object(ie.a)(Da,"FilterItemOperationFactory",null,[]);Object(ie.a)(Pa,"CompletionItem",null,[]);var Bk="<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='"+pb.a.$p+"'>{3}</td>\r\n\t<td id='item_type_cell' class='"+pb.a.$p+"'>{5}</td>\r\n</tr>",Zk="<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+
pb.a.$p+"'></td>\r\n\t<td id='item_type_cell' class='"+pb.a.$p+"'>{2}</td>\r\n</tr>",J="<td>\r\n\t<div class='"+pb.a.YA+"'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",ea="<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+pb.a.$p+"'>{5}</td>\r\n\t<td id='item_type_cell' class='"+pb.a.$p+"'>{2}</td>\r\n</tr>",Wa=Tj.a;Wl(mb,Wa);mb.prototype.lVc=function(k){this.addHandler("FLBSelectedRowChanged",k)};mb.prototype.UId=
function(k){this.removeHandler("FLBSelectedRowChanged",k)};mb.prototype.kZb=function(k){this.addHandler("ACLBUpdated",k)};mb.prototype.Gsc=function(k){this.removeHandler("ACLBUpdated",k)};mb.prototype.dispose=function(){Wa.prototype.dispose.call(this);this.rra=this.KUe=this.lub=null};mb.prototype.ezc=function(k,F,X,ra){ra=void 0===ra?0:ra;this.jef||this.O7(!1);var ab="";X&&(ab+=String.format("<table aria-live='off' id='{0}'><tr><td class='{1}'>{2}</td></tr></table>","list_column_header",ai.a.uZg,
X));ab+=String.format("<table class='{0}' aria-live='off'><tbody>",this.Wba);for(var Qb=new Ka.a,Fc=0,ld=this.BW.length;Fc<ld;Fc++)ab+=this.l2e(k[this.BW[Fc]],Fc+1,F,ra),this.Hk&&Qb.add(this.jXe(k[this.BW[Fc]]));Fc=this.BW.length;ld=0;for(var ud=this.Fq.length;ld<ud;ld++)Array.contains(this.BW,this.Fq[ld])||(Fc++,ab+=this.l2e(k[this.Fq[ld]],Fc,F,ra),this.Hk&&Qb.add(this.jXe(k[this.Fq[ld]])));this.dg.innerHTML=ab+"</tbody></table>";this.Un=nf.DOMElementExtensions.Oj(this.domElement,this.Wba);this.Hk&&
(this.j3b=Qb.toArray());this.jef?(this.isListVisible=!0,this.lGa.set_visible(!0)):(this.O7(!0),this.wHg(!!X))};mb.prototype.fJa=function(k,F,X,ra,ab,Qb){ra=void 0===ra?"":ra;ab=void 0===ab?0:ab;Qb=void 0===Qb?!1:Qb;if(k){var Fc=[],ld=[];this.ULb=0;var ud=new Da(this.$,k);if(F){var jd=!!F&&0<ab,Ye=jd&&91===F.charCodeAt(ab+1)?ab+2:ab+1;Qb=jd?F.length===Ye:!1;jd&&F.length===ab&&ve.EwaSettings.ma(136)&&(Qb=!0);var Bf=null;!Qb&&jd&&F.length>ab+1&&(Bf=F.substring(Ye,F.length));if(F)for(jd=0,Ye=k.length;jd<
Ye;jd++){var Tg=k[jd].name;if(!k[jd].Mei){var $g=ud.EDe(Fc,jd);k[jd].cAb&&this.ULb++;if(!Bf&&!Qb||0===k[jd].itemType)ld=this.cSe(F,Tg,X,$g,Fc,ld),Fc=ld.f9e,ld=ld.VGf;Bf&&1===k[jd].itemType&&(ld=this.cSe(Bf,Tg,!0,$g,Fc,ld),Fc=ld.f9e,ld=ld.VGf);Qb&&1===k[jd].itemType&&$g.execute(Fc)}}}else for(X=0;X<k.length;++X)if(k[X].cAb||Qb)Bf=ud.EDe(Fc,X),Bf.execute(Fc),Bf.execute(ld),k[X].cAb&&this.ULb++;this.BW=ld;this.Fq=Fc;this.ezc(k,F,ra,ab)}};mb.prototype.mQj=function(k){if(k&&!(1<k.length)){var F=[],X=[];
F.push(0);X.push(0);this.BW=F;this.Fq=X;this.ezc(k,"","",0)}};mb.prototype.Uxa=function(){this.Wk&&Wa.prototype.Uxa.call(this)};mb.prototype.e2i=function(k,F){this.raiseEvent("ACLBUpdated",new Ak.a(k,void 0,void 0,F))};mb.prototype.Icg=function(k){var F=this.Un.rows[k];return(!this.Wk||this.Wk!==F)&&k<this.Un.rows.length?(this.Wk=F,!0):!1};mb.kXe=function(k){switch(k){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;
default:return 3}};mb.prototype.onItemClick=function(k){Ng.g(k.Ca);0===this.B0||2===this.B0||3===this.B0||4===this.B0||5===this.B0||7===this.B0?(this.raiseEvent(Tk.a.m4a),this.Uxa()):1===this.B0?this.lGa.Xy(!1):(this.lGa.Xy(!1),k=ff.g(this.$),k.Gp(!1),k.focus());return!0};mb.prototype.wHg=function(k){this.Zra();if(k){var F=this.Un.offsetWidth+(this.Fq.length>this.UH?Kj.a.vv:0);k=$get("list_column_header");k.offsetWidth>F&&nf.DOMElementExtensions.Hr(this.dg,k.offsetWidth);F=this.dg.getElementsByClassName(this.v_);
for(var X=0;X<F.length;X++)F[X].style.width=Sc.HelperMethods.uc(k.offsetWidth)}};mb.prototype.l2e=function(k,F,X,ra){if(1===k.itemType){var ab=wg.a.vg(k.name),Qb=wg.a.vg(ra?X.substring(ra+1,X.length):X),Fc=0;ab.substring(0,Qb.length).toLowerCase()!==Qb.toLowerCase()&&(Fc=mb.SCj(ab,$b.Hfg,Qb));X="";X=0<=Fc?X+(ab.substring(0,Fc)+"<b>"+ab.substring(Fc,Fc+Qb.length)+"</b>"+ab.substring(Fc+Qb.length,ab.length)):X+ab;ra=ra?String.format(J,pb.a.nOe,wg.a.MZ(uh.a.gf(0)),we.a.instance.ga(714)):"";return String.format(Zk,
ra,F,wj[k.itemType],this.v_,X)}if(5===k.itemType)return String.format(ea,"",F,wj[k.itemType],this.v_,wg.a.vg(k.name),wg.a.vg(k.gja));if(4===k.itemType)return String.format(ea,"(...)",F,wj[k.itemType],this.v_,wg.a.vg(k.name));if(6===k.itemType)return ra=ra?String.format(J,pb.a.nOe,wg.a.MZ(uh.a.gf(0)),we.a.instance.ga(714)):"",String.format(Bk,ra,this.v_,wg.a.vg(k.name),wg.a.vg(k.gja),F,wj[k.itemType]);ra=String.format(J,2===k.itemType||3===k.itemType?pb.a.Vrh:pb.a.Trh,wg.a.MZ(uh.a.gf(0)),we.a.instance.ga(711));
return String.format(Bk,ra,this.v_,wg.a.vg(k.name),wg.a.vg(k.gja),F,wj[k.itemType])};mb.prototype.jXe=function(k){var F=new Pa;F.label=k.label;F.textEdit=k.textEdit;F.kind=mb.kXe(k.itemType);F.type=k.cAb?1:0;if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===F.kind){var X=this.formulaAssistanceControl.lOh(k.label);F.detail=X?X:k.gja}else F.detail=k.gja;return F};mb.prototype.cSe=function(k,F,X,ra,ab,Qb){Z.a.equals(F,"Pretend this is the line.",!1)&&0<ab.length||
Z.a.fL(F,k)?(ra.execute(ab),ra.execute(Qb)):X&&k.length>=$b.h3g&&mb.Och(F,$b.Hfg,k)?ra.execute(ab):!X&&k.length>=$b.g3g&&Z.a.contains(F,k,!0)&&ra.execute(ab);return{f9e:ab,VGf:Qb}};mb.Och=function(k,F,X){F=Gl(F);for(var ra=F.next();!ra.done;ra=F.next())if(ra=k.split(ra.value),!(2>ra.length)){ra=Gl(ra);for(var ab=ra.next();!ab.done;ab=ra.next())if(Z.a.fL(ab.value,X))return!0}return!1};mb.SCj=function(k,F,X){F=Gl(F);for(var ra=F.next();!ra.done;ra=F.next())if(ra=k.toLowerCase().indexOf((ra.value+X).toLowerCase()),
0<ra)return ra+1;return-1};Ck.Object.defineProperties(mb.prototype,{Rhc:{configurable:!0,enumerable:!0,get:function(){return 0<this.ULb&&this.ULb===this.Fq.length}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(Rj.a)(mb.prototype,this,"isListVisible")},set:function(k){Object(Rj.b)(mb.prototype,this,"isListVisible",k);k||(this.Yuc=0,this.ye=null);0===this.Yuc?nf.DOMElementExtensions.setVisible(this.lub,k&&!this.Hk):nf.DOMElementExtensions.setVisible(this.lub,!1)}},Wk:{configurable:!0,
enumerable:!0,get:function(){return this.rra},set:function(k){this.jBa(this.Wk);if(k){this.KUe.innerText="";this.rra=k;var F=this.jBa(this.Wk),X=k.rowIndex+1,ra=$get("description_cell"+X,k);this.lub.innerText=ra.innerText;var ab=$get("item_type_cell",k);this.ye=F=F.innerText;this.Yuc="field"===ab.innerText?1:"definedName"===ab.innerText?2:"letVariable"===ab.innerText?3:"tableColHeaderName"===ab.innerText?4:"tableSpecialStructRef"===ab.innerText?5:"pendingData"===ab.innerText?6:"tableNamedObject"===
ab.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new Ak.a(this.Fq.length,X,F,ra.innerText));this.Kuc(k)}}},XSa:{configurable:!0,enumerable:!0,get:function(){return this.lub}},lGa:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl}},B0:{configurable:!0,enumerable:!0,get:function(){return this.Yuc}}});Object(ie.a)(mb,"FormulaAutoCompleteListBox",Tj.a,[808]);Ck.Object.defineProperties(eb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},
toolTip:{configurable:!0,enumerable:!0,get:function(){return this.x9}}});Object(ie.a)(eb,"LETVariableInfo",null,[]);Ck.Object.defineProperties(Ra.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(ie.a)(Ra,"TableColHeaderNameInfo",null,[]);Ck.Object.defineProperties($a.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(ie.a)($a,"TableNamedObjectInfo",null,[]);Ck.Object.defineProperties(la.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.x9}}});Object(ie.a)(la,"TableSpecialStructRefInfo",null,[]);var Pb=b(177);Object(ie.a)(va,"FormulaAutoCompleteCallbacks",null,[]);Object(ie.a)(Tb,"FormulaAutoCompleteRenderingInfo",null,[]);Object(ie.a)(tb,"FunctionSuggestionRequest",null,[]);Object(ie.a)(Ya,"RunExperimentRequest",null,[]);var Cc=bj.a;Wl(Ia,Cc);Ia.prototype.Gme=function(k){this.addHandler(Ia.obd,k)};Ia.prototype.lPf=
function(k){this.removeHandler(Ia.obd,k)};Ia.prototype.Eme=function(k){this.addHandler(Ia.Kad,k)};Ia.prototype.jPf=function(k){this.removeHandler(Ia.Kad,k)};Ia.prototype.Fme=function(k){this.addHandler("FormulaAutoCompleteShown",k)};Ia.prototype.kPf=function(k){this.removeHandler("FormulaAutoCompleteShown",k)};Ia.prototype.get_visible=function(){return this.Bcf?void 0!==this.rfb?this.rfb:this.rfb=Cc.prototype.get_visible.call(this):Cc.prototype.get_visible.call(this)};Ia.prototype.set_visible=function(k){if(this.Bcf&&
this.rfb===k)return this.Hk&&!k&&this.m1a(),k;this.aja.set_visible(k);this.Hk&&!k&&this.m1a();Sys.UI.Control.prototype.set_visible.call(this,k);return this.rfb=k};Ia.prototype.KTg=function(k,F){this.isListVisible&&(k+=$b.openParen,F++,this.xCd(k,F));var X=0<F&&k.charAt(F-1)===$b.openParen,ra=F===k.length||k.charAt(F)===$b.closeParen;if(!X||!ra)return Wd.ULS.sendTraceTag(537162053,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments Caret position: {0} is invalid. Is cell empty: {1}. Function exists in cell: {2}",
F,!k.length,!!this.jQ),!1;X=k.substring(0,F).lastIndexOf(this.$.listSeparator);ra=k.substring(0,F-1).lastIndexOf($b.openParen);k=k.substring(-1===X&&-1===ra?1:Math.max(X,ra)+1,F-1).trim();return this.functionInfoManager.$dd(k)?!0:(Wd.ULS.sendTraceTag(537162052,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: {0}",!!this.jQ),!1)};Ia.prototype.Fai=function(k,F){var X=this.KTg(k,F);if(!X||!this.jQ)return Wd.ULS.shipAssertTag(537162051,
0,!X||X&&!!this.jQ,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,Kqf:0,aTe:0};X=this.jQ.Params;X=X.replace(RegExp("[\\[\\]]","g"),"");var ra=k.charAt(F-1)===$b.openParen,ab=ra?"":"(",Qb=F===k.length?")":"";var Fc=this.$.listSeparator;Fc=X.includes(Fc)?X.indexOf(Fc):X.length;return{returnValue:k.substring(0,F)+ab+X+Qb+k.substring(F,k.length),Kqf:ra?F:F+1,aTe:Fc}};Ia.prototype.qt=function(k,F){this.Hk&&void 0!==this.Yq&&null!==this.Yq&&
this.Yq();this.Hk||Cc.prototype.qt.call(this,k,F)};Ia.prototype.dispose=function(){if(this.$){this.ASa(!1);var k=this.gridView;this.E9&&(this.$.userOperationManager.Ul(this.wca),this.$.userOperationManager.Ul(this.DOa));k&&(k.ha&&(this.Hk?k.ha.MF(this.ld):k.ha.RW(this.ld),O.a.OV()&&4!==this.HCb&&k.ha.Aza(this.Hsf)),k.view.Xq(this.hnc));this.Hk&&this.$.xa&&this.$.xa.Wg(this.Th)}this.functionInfoManager&&(this.functionInfoManager.Zab(this.onFunctionInfoLoaded),this.functionInfoManager.E$i(this.Ewf));
this.gh&&this.gh.ysc(this.mya);this.Hk&&this.rh&&this.rh.UId(this.wBf);O.a.kfc&&this.Ya&&this.Ya.NHb(this.k6);this.p6f(!1);zg.a.Ha(this.rh);zg.a.Ha(this.T_b);zg.a.Ha(this.aja);zg.a.Ha(this.rr);this.Ya=this.functionInfoManager=this.gh=null;zg.a.Dc(this.sJa);this.Eg=this.t8=this.aja=this.sJa=null;Cc.prototype.dispose.call(this)};Ia.prototype.Jwa=function(){return!this.Qt};Ia.prototype.Mhi=function(){return!this.mGa};Ia.prototype.Xh=function(k,F){if(!this.Jwa()){if(this.Hk&&this.IH){if(125627505===F||
267796030===F)return this.Hk&&this.gBc(F),this.Zze(),this.E9&&this.BUf(),!1;if(1872288872===F)return this.Vma(),this.isListVisible=!1,!0;if(this.rh.Rhc&&(-798660877===F||137938150===F))return!1}if(1!==this.rh.B0||125627505!==F&&267796030!==F)if(6===this.rh.B0){var X=k.keyCode;13!==X&&9!==X||this.Xy(!1)}else{if(4===this.rh.B0||5===this.rh.B0)return Cc.prototype.Xh.call(this,k,F,!0);1===this.rh.BW.length&&(X=k.keyCode,this.Tve=8===X||127===X||46===X?!0:!1)}else{if(this.Xy(!1)&&!this.bka)return this.gridView.ha.Xh(k,
F);if(125627505===F&&this.bka)return!0}}return Cc.prototype.Xh.call(this,k,F)};Ia.prototype.ztc=function(){this.gh.xbb();this.t8=null;null==this.Pia||this.Pia||this.Qjc("NoFieldChosen",1,2,1);this.Pia=null;this.P3=0;this.D5=this.ird=this.tpc=null};Ia.prototype.cob=function(){var k=this,F=!!this.Ya&&!hi.f(this.$.qa),X=null;this.z2&&F&&(X=this.Ya.text,X.startsWith("=")&&(this.NLa=!0,1===X.length&&(this.isCellContentOnlyEqualDuringEdit=!0)));(this.JAa||this.eyc)&&F&&(this.z2||(X=this.Ya.text),this.pluginScheduler.requester().functionSuggestion(Object(na.a)(new tb,
{content:X})).then(function(ra){0===ra.kind&&(Wd.ULS.shipAssertTag(537162050,0,!!ra&&!!ra.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion"),ra=Ba.toArray(Ba.select(Ba.asEnumerable(ra.payload.items),function(ab){return Ia.a2g(ab)})),k.eyc&&"="===X&&0<ra.length&&k.fr.D1a.lpj("="+ra[0].textEdit.newText),k.JAa&&(k.gSa=ra,Rf.AFrameworkApplication.Ng||k.Bre(F,!0)));return null}));this.JAa&&F||this.Bre(F,!1)};Ia.prototype.k2e=function(){if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var k=
this.gridView.Bj?this.dub.kQ:this.Bpb.kQ;"@"===this.Ya.text.charAt(k+1)&&this.Ya.textBox.caretPosition>k+1?this.Ndb=k+2:this.Ndb=k+1}else{k=this.Ya.text.lastIndexOf($b.ujf);var F=this.Ya.text.lastIndexOf("[");this.Ndb=k+1>=F?k+2:F+1}return this.Ya.text.substring(this.Ndb,this.Ya.textBox.caretPosition)};Ia.prototype.Cre=function(){this.s3f()&&(this.P9g(),this.Qt&&(this.Pia=!1,this.aW=this.k2e(),this.rh.fJa(this.Qt,this.aW,!0,void 0,void 0,!0),this.show(),ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&
this.aja.dsb()))};Ia.prototype.Are=function(){this.s3f()&&(this.T_b&&this.T_b.cancel(),this.gh.Qyb?(this.Jwa()&&this.sCe(!0),this.get_visible()?this.ZRe():this.u1d=Pb.AsyncMethodContext.Zs(this.ZRe,$b.jch,$i.a.DCh,this.T_b)):this.BZ())};Ia.prototype.s3f=function(){return this.Ya?0<this.$.Ab.JR||!this.Ya.text||!this.Ya.isEditing?(this.set_visible(!1),!1):hi.f(this.$.qa)?!1:!0:!1};Ia.prototype.pqb=function(k){this.Ya&&this.isListVisible&&(this.Fld(this.Ya.text,k),this.Ya.textBox.caretPosition=k.range.start.character+
k.newText.length,this.set_visible(!1))};Ia.prototype.Xy=function(){var k;if(!this.Ya||!this.isListVisible)return!1;var F=this.rh.B0;this.lcf&&this.formulaAssistanceTelemetryManager.V8e(mb.kXe(F));var X="",ra=0,ab=this.gridView,Qb=this.Ya.text,Fc=0,ld=this.rh.ye,ud=!1;if(0===F||2===F||3===F||7===F)X+=Qb.substr(0,this.W2a)+this.rh.ye,0!==F||this.rh.ye.endsWith(")")||(X+="("),ra=X.toString().length,X+=Qb.substr(this.x$b),2===F&&(Fc=4,ld="DefinedName",ud=!0,this.set_visible(!1));else if(1===F)if(this.Pia=
!0,this.bka){X+=Qb.substr(0,this.P3+2);!X.toString().endsWith(fc.a.VU)&&ve.EwaSettings.ma(136)&&(X+=fc.a.VU);Fc=this.rh.ye;Fc=Fc.replace("'","''");Fc=Fc.replace("[","'[");Fc=Fc.replace("]","']");if(this.C5c||this.fyh(Fc))Fc=fc.a.kqi+Fc+fc.a.Hgj,ud=!0;X+=Fc;ra=X.length;Fc=3;Db.a("PulloutFieldAccepted")}else return this.Ya.text=this.rh.ye,this.set_visible(!1),ab.Gp(!1),ab.focus(),this.Qjc("FieldName",1,1,1),Db.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===F)Wd.ULS.sendTraceTag(537162048,
0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),X+=Qb.substr(0,this.Ndb),Z.a.equals(this.rh.ye,"@ - "+this.instantaneousSupportInformationManager.Me.ThisRowStructRefString,!1)?X+="@":(X+=this.rh.ye,ud=!0,this.set_visible(!1)),ra=X.length;else if(4===F){Wd.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");X+=Qb.substr(0,this.Ndb);ud="";ra=!1;for(var jd=[39,91,93,64,35],Ye=0;Ye<this.rh.ye.length;Ye++){var Bf=
this.rh.ye.charCodeAt(Ye);Array.contains(jd,Bf)&&(ud+="'");ud+=this.rh.ye.charAt(Ye).toString();ra||Z.a.isNumeral(Bf)||Z.a.Cdf(Bf)||(ra=!0)}jd=this.gridView.Bj?this.dub.kQ:this.Bpb.kQ;Qb=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===Qb.charAt(jd+1)&&ra:Qb.lastIndexOf($b.ujf)+1>=Qb.lastIndexOf("[")&&ra;X+=Qb?"["+ud+"]":ud;ud=!0;this.set_visible(!1);ra=X.toString().length}else if(6===F)X+=Qb.substr(0,this.psb);else return Wd.ULS.sendTraceTag(537162019,
0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;this.Ya.text=X;this.Ya.textBox.caretPosition=ra;this.Ya.cxa()&&(null===(k=ab.Sr)||void 0===k?0:k.Oua)&&ab.Sr.LJb(this.Ya.text,this.Ya.textBox.caretPosition,this.Ya.textBox.caretPosition,this.Ya.textBox.xv.length);ab.Bj&&(k=ab.pc,k.text=this.Ya.text,k.setCaretPosition(this.Ya.textBox.caretPosition));ld=(null==this.Pia?0:this.Pia)?"FieldName":ld;this.rh.Wk.sectionRowIndex>=this.rh.BW.length?this.Qjc(ld,4,Fc,0):this.Qjc(ld,1,Fc,0);
ud||(5===F||4===F?this.Cre():this.cob());return!0};Ia.prototype.BZ=function(k,F){k=void 0===k?null:k;F=void 0===F?null:F;k?(this.gh.xbb(),this.gh.BZ(k,!1,!1,F)):(k=this.gridView,k.ha.ta.Hg&&(k=vd.v(k.ha.ta.qd,this.$),this.gh.BZ(k,!0,!0,F)))};Ia.prototype.Vma=function(){this.Efa=!1;this.Ya.MHe()};Ia.prototype.lOh=function(k){k=this.calcManager.getWorksheetFuncId(k);return this.OUe?this.OUe.descriptionsMap.get(k):null};Ia.prototype.sCe=function(k){if(this.Mhi()){if(this.gh.Qyb&&this.gh.Ok&&(!this.gh.Ok.length||
!this.gh.Ok[0].FieldInfoDataList))return;this.pOj(k)}k=Ba.asEnumerable(this.mGa);k=Ba.concat(k,this.hQh(this.Ya.text));ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.Hk&&(k=Ba.concat(k,this.oRh()));Ba.OBc(k,function(F){return F.name},new $e);this.JAa&&(k=Ba.concat(Ba.asEnumerable(this.gSa),k),ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&(0<this.gSa.length&&(this.KAa=!0),this.gSa=[]));this.t8=Ba.toArray(k)};Ia.prototype.P9g=
function(){var k=this.Ya.text;if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var F=this.gridView.Bj?this.dub.THa:this.Bpb.THa,X=!0;if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==F&&(this.Eg=Object(ca.a)(dj.a,this.$.Hb.getItemByName(F))),this.Eg||(this.Eg=this.tableManager.Eg,X=!1),!this.Eg){Wd.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d",
this.$.Hb.count,""===F);return}}else this.Eg=Object(ca.a)(dj.a,this.$.Hb.getItemByName(F)),this.Eg||(this.Eg=this.tableManager.Eg,X=!1);this.Eg.DO&&this.Eg.DO.IsFullTableHeaders?this.sGf(X):cj.d(this.Eg)?(Wd.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s",this.Eg.ij),Yg.I(this.$.na.va,this.Eg.ij,this.NKi,this.MKi,null,null)):Wd.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.",
this.Eg.ij)}else if(this.calcManager&&this.tableManager.Eg)if(F=this.calcManager.g4a(this.tableManager.Eg))if(this.calcManager.lIg(this.tableManager.Eg,F)){k=Ba.empty();if(91===this.Ya.text.charCodeAt(this.Ya.text.length-1)){var ra=this.A0a("@ - "+this.instantaneousSupportInformationManager.Me.ThisRowStructRefString);k=Ba.concat(k,(X=new Ka.a,X.add(ra),X))}k=Ba.concat(k,Ba.select(Ba.asEnumerable(F.toArray()),function(ab){var Qb=new sc,Fc=new Ra;Fc._name=ab.toString();Qb.g_f(Fc);return Qb}));this.t8=
Ba.toArray(k)}else k.endsWith("[")&&"["!==k.charAt(k.length-2)&&Wd.ULS.sendTraceTag(572381130,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with {0} columns for a table with id {1} of size {2}",F.count,this.tableManager.Eg.ij,this.tableManager.Eg.usedRange.right-this.tableManager.Eg.usedRange.left+1);else k.endsWith("[")&&"["!==k.charAt(k.length-2)&&Wd.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")};
Ia.prototype.fyh=function(k){if(!k)return!1;var F=k.charCodeAt(0);if(46===F||48<=F&&57>=F||63===F)return!0;for(var X=0;X<k.length;X++,F=k.charCodeAt(X))if(!((ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?Z.a.isLetter(F):Z.a.yod(F))||92===F||95===F||63===F||48<=F&&57>=F))return!0;return!1};Ia.prototype.xCd=function(k,F){var X=!1,ra=!1,ab=!1,Qb=0,Fc=0;this.W2a=0;this.x$b=F;this.g5b=1;for(var ld=F-1;0<=ld;--ld)switch(k.charCodeAt(ld)){case 39:ra=
!ra;break;case 34:X=!X;break;case 91:++Qb;ab=Qb>Fc;break;case 93:++Fc}ab=Object(na.a)(new nc,{Xsa:!X,Ysa:!ra,Qha:!ab,zFb:1});Qb=this.gVi(k,F,ab);F=this.hVi(k,F,ab.Xsa,ab.Ysa,ab.Qha);this.g5b=Qb+F;if(this.qQc=Qb-1)this.bxc=!1;this.Vyh(k,X,ra,ab.XBd,ab.YBd)};Ia.prototype.sld=function(){4!==this.HCb&&this.gridView.ha.Ura(this.Hsf);var k=O.a.iyb()?this.fr.lc(null):void 0;this.nDb(k);O.a.kfc&&this.gridView.Nj.tYa(this.k6);Ia.ELd(this.pluginScheduler);this.JAa&&this.gWg()};Ia.prototype.rxh=function(){return this.JAa||
this.rRe};Ia.prototype.iVi=function(){var k=this.D5;if(!this.svj||!k)return this.P3=0,this.mGa=this.t8=null,!1;k=k.endsWith(fc.a.VU);var F;if(F=ve.EwaSettings.ma(136)){F=this.MLj(this.D5.substring(0,this.R3));var X=F.sheetRange;F=F.returnValue}return F&&(F=this.D5.substring(0,this.P3),k&&F!==this.ird)?(this.ird=F,this.P3=this.D5.length-(k?1:0),this.BZ(X,this.D5),this.Pia=!1,Wd.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0):!1};Ia.prototype.hQh=function(k){var F=new Ka.a;this.calcManager&&
ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&Wd.ULS.shipAssertTag(537162014,0,!!this.calcManager.kta(hb.Range.hd(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.rRe&&(k=this.calcManager.extractLetVariables(k,this.Ya.textBox.caretPosition))){k=Gl(k);for(var X=k.next();!X.done;X=k.next()){var ra=X.value;X=new eb;X._name=ra;X.x9=we.a.instance.ga(2180);ra=new sc;ra.ipj(X);F.add(ra)}}return F};Ia.prototype.oRh=
function(){for(var k=new Ka.a,F=this.$.Hb.items,X=0,ra=F.length;X<ra;X++){var ab=F[X];if(hi.n(ab)){var Qb=new $a;Qb._name=ab.name;ab=new sc;ab.Arj(Qb);k.add(ab)}}return k};Ia.prototype.A0a=function(k){var F=new sc,X=new la;X._name=k;F.Brj(X);return F};Ia.prototype.sGf=function(k){var F=new Ka.a,X=this.Ya.text.charCodeAt(this.Ya.text.length-1),ra=this.Ya.textBox.caretPosition-1;if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.Ya.text.charCodeAt(ra):
91===X){var ab=this.A0a("@ - "+this.instantaneousSupportInformationManager.Me.ThisRowStructRefString);F.add(ab)}ab=Gl(this.Eg.DO.HeadersList);for(var Qb=ab.next();!Qb.done;Qb=ab.next()){Qb=Qb.value;var Fc=new sc,ld=new Ra;ld._name=Qb.Name;Fc.g_f(ld);F.add(Fc)}ab=this.gridView.Bj?this.dub.kQ:this.Bpb.kQ;Qb=this.Ya.text.charCodeAt(ab+1);(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!k||ra!==ab&&35!==Qb:!k||91!==X&&35!==X)||(k=this.A0a("#"+this.instantaneousSupportInformationManager.Me.AllStructRefString),
F.add(k),k=this.A0a("#"+this.instantaneousSupportInformationManager.Me.DataStructRefString),F.add(k),k=this.A0a("#"+this.instantaneousSupportInformationManager.Me.HeadersStructRefString),F.add(k),k=this.A0a("#"+this.instantaneousSupportInformationManager.Me.TotalsStructRefString),F.add(k));F&&(this.t8=F.toArray())};Ia.prototype.pOj=function(k){var F=Ba.empty();!k&&this.functionInfoManager.e_&&(F=Ba.concat(F,Ba.select(Ba.asEnumerable(this.functionInfoManager.w$b),function(X){var ra=new sc;ra.IYf(X);
return ra})),k=this.U5b.oGe,0<k.length&&(F=Ba.OBc(Ba.concat(F,Ba.select(Ba.asEnumerable(k),function(X){var ra=new sc;ra.Mnj(X);return ra})),function(X){return X.name},new $e)));if(this.gh.Qyb&&this.gh.Ok){if(!this.gh.Ok.length||!this.gh.Ok[0].FieldInfoDataList)return;F=Ba.OBc(Ba.concat(F,Ba.select(Ba.asEnumerable(this.gh.Ok[0].FieldInfoDataList),function(X){var ra=new sc;ra.koj(X);return ra})),function(X){return X.name},new $e);this.columnName=this.gh.Ok[0].ColumnName}this.mGa=Ba.toArray(F)};Ia.prototype.nDb=
function(k){var F;if(1!==this.HCb){var X=this.gridView.ha.ta.activeCell;if(X){var ra=this.calcManager.kta(X,!this.Vmd);if(ra){var ab=this.$.xa,Qb=ra.sheet.index;0>=ab.count||0>Qb||Qb>=ab.count||(Qb=ab=null,this.Ixd&&void 0!==this.calcManager&&null!==this.calcManager&&(k=null!==(F=null===k||void 0===k?void 0:k.cell)&&void 0!==F?F:this.gridView.Ea.cs(X))&&(F=this.calcManager.xbc(k.il),void 0!==F&&null!==F&&(ab=F.FormatString,Qb=F.Builtin)),2!==this.HCb&&this.pluginScheduler.notifier().setActiveCell({colIndex:ra.range.col,
rowIndex:ra.range.row,sheetIndex:this.$.xa.getItem(ra.sheet.index).sheetId,docName:ra.sheet.document.name,docPath:ra.sheet.document.path,formatString:ab,builtIn:Qb}))}}}};Ia.prototype.BUf=function(){this.formulaAssistanceTelemetryManager.oB={el:this.gridView.ha.ta.activeCell,Cpb:this.gridView.pc.text,rqb:!0};this.formulaAssistanceTelemetryManager.lBb=this.$.ea.Te;this.formulaAssistanceTelemetryManager.ojc=this.$.xa.qa.sheetId;this.$.userOperationManager.xq(this.DOa)};Ia.prototype.gWg=function(){this.gridView.Bj?
this.dub.uU(!1):this.Bpb.uU(!1)};Ia.prototype.hhf=function(k){var F=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?Z.a.isLetter(k):Z.a.yod(k);return 48<=k&&57>=k||46===k||95===k||F};Ia.prototype.show=function(){if(this.Qt){var k=this.rh.Icg(0);this.Hk?0<this.rh.Fq.length?k||this.g3f():this.m1a():((k=0<this.rh.Fq.length)&&this.formulaAssistanceTelemetryManager.sX(["autoCompleteRender"]),!this.isListVisible&&this.columnName&&k&&this.rh.e2i(this.rh.Fq.length,
this.columnName),this.isListVisible=k,this.aja.show(this.jQ),this.ABa(!0),this.rh.Uxa(),k&&this.formulaAssistanceTelemetryManager.uQ(["autoCompleteRender"]))}};Ia.prototype.hVi=function(k,F,X,ra,ab){for(X=Object(na.a)(new nc,{XDf:41,Uye:40,Xsa:X,Ysa:ra,Qha:ab});F<k.length&&!this.SEf(k,F,X);++F);return X.zFb};Ia.prototype.gVi=function(k,F,X){for(--F;0<=F&&!this.SEf(k,F,X);--F);return X.zFb};Ia.prototype.SEf=function(k,F,X){var ra=k.charCodeAt(F);0>=this.R3&&(this.R3=k.substring(0,F).lastIndexOf(fc.a.VU));
46===ra&&(F<this.R3?this.R3=F:F>this.psb&&(this.P3=this.psb=F));if(!this.hhf(ra)&&!Ia.bni(ra)&&(!this.bka||F<=this.R3||!Ia.I6h(ra,X))){X.$uf&&(X.$uf=!1,this.W2a=F+1);if(X.yAd){X.YBd=F+1;if(this.functionInfoManager.$dd(k.substring(X.YBd,X.XBd)))return!0;X.yAd=!1}switch(ra){case 39:X.Ysa=!X.Ysa;break;case 34:X.Xsa=!X.Xsa;break;case 91:X.Qha=!1;break;case 93:X.Qha=!0}ra===this.$.listSeparator.toString().charCodeAt(0)&&X.Ysa&&X.Xsa&&!X.L_a&&(!this.bka||X.Qha)&&(F<X.sMd||-1===X.sMd)&&(X.zFb+=1,this.g5b++);
ra===X.Uye&&X.Xsa&&X.Ysa&&(!this.bka||X.Qha)?X.L_a+=1:ra===X.XDf&&X.Xsa&&X.Ysa&&(!this.bka||X.Qha)?0<X.L_a?--X.L_a:(X.sMd=X.$Se,X.$Se=F,0<F&&this.hhf(k.charCodeAt(F-1))&&(X.yAd=!0,X.XBd=F)):this.bka&&46===ra&&F>this.R3&&(F<this.R3?this.R3=F:F>this.psb&&(this.P3=this.psb=F))}return!1};Ia.prototype.Vyh=function(k,F,X,ra,ab){this.x$b>this.W2a&&0<=this.W2a?F||X||(this.aW=k.substring(this.W2a,this.x$b)):this.aW=null;ra!==ab?(k=k.substring(ab,ra),this.jQ&&Z.a.equals(this.jQ.NameDataStrings,k,!0)||(this.bxc=
!0),this.jQ=this.functionInfoManager.$dd(k)):(this.bxc=!1,this.jQ=null)};Ia.prototype.p6f=function(k){var F=$get($b.MEf+"_"+$b.yFb,this.domElement),X=$get($b.NEf+"_"+$b.yFb,this.domElement);k&&!this.udc?(F&&rj.a.instance.pa(Gg.a.click,F,this.tca),X&&rj.a.instance.pa(Gg.a.click,X,this.tca),this.udc=!0):this.udc&&(F&&rj.a.instance.Aa(Gg.a.click,F,this.tca),X&&rj.a.instance.Aa(Gg.a.click,X,this.tca),this.udc=!1)};Ia.prototype.MLj=function(k){var F=this;var X=null;var ra;if(function(){var ld=vd.Z(k,F.$.ea.xa);
Qb=ld.sheetName;ra=ld.range;return ld}().returnValue&&ra){if(!Qb){var ab=Object(ca.a)(mf.a,this.$.qa);if(!ab)return{returnValue:!1,sheetRange:X};var Qb=ab.name}X=vd.v(ra,this.$);X.SheetName=Qb;this.C5c=!1;return{returnValue:!0,sheetRange:X}}var Fc=null;return function(){var ld=F.U5b.vLj(k);Qb=ld.sheetName;Fc=ld.range;return ld}().returnValue?(X=vd.v(Fc,this.$),X.SheetName=Qb,this.C5c=!0,{returnValue:!0,sheetRange:X}):{returnValue:!1,sheetRange:X}};Ia.prototype.CLd=function(k){this.pluginScheduler.requester().runAuthoringExperiment({content:k,
isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit})};Ia.prototype.ykd=function(){if(1===this.rh.BW.length&&this.Qt.length){var k=this.Qt[this.rh.BW[0]];if(1===k.itemType){var F=k.name;k=this.Ya.text;F=F.substring(k.length,F.length);F.length&&(this.Ya.text=k+F,this.Ya.textBox.selectRange(k.length,this.Ya.text.length))}}else Wd.ULS.shipAssertTag(537162007,0,!1,"InCellAutoComplete should only be called when there is 1 item (number of items: {0})",this.rh.BW.length)};Ia.prototype.Qjc=
function(k,F,X,ra){var ab={};ab.a=k;ab.b=F;ab.c=X;ab.d=ra;bh.b().Pe(38,ab,!0)};Ia.prototype.Bre=function(k,F){if(!this.functionInfoManager.e_){if(k)if(this.xCd(this.Ya.text,this.Ya.textBox.caretPosition),this.JAa||this.aW){var X={};X.Filter=this.aW?this.aW.charAt(0).toString():"";X.FilterType=1;X.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.Q1a(X)}else ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)&&this.get_visible()&&this.set_visible(!1);
if(!F)return}0<this.$.Ab.JR||this.Ya&&!this.Ya.isEditing?this.set_visible(!1):k&&(this.xCd(this.Ya.text,this.Ya.textBox.caretPosition),this.aja.update(this.jQ,this.g5b,this.qQc,this.bxc),this.D5=this.Ya.text.substring(1,this.Ya.textBox.caretPosition),this.R3=this.D5.indexOf(fc.a.VU),this.P3=this.D5.lastIndexOf(fc.a.VU),this.iVi()?(k=new sc,k.Zpj(),this.mGa=this.t8=k=[k],this.rh.mQj(k),this.show()):((this.rxh()||this.Jwa())&&this.sCe(!1),0<this.P3?this.rh.fJa(this.Qt,this.D5,!1,void 0,this.D5.lastIndexOf(fc.a.VU),
!1):this.rh.fJa(this.Qt,this.aW,!1,void 0,this.P3,!1),this.show(),this.Hk&&(this.rh.Fq.length||this.gridView.Nj.FK?this.aja.dsb():(this.aja.WJd(),this.Hk&&this.m1a()))))};Ia.prototype.g3f=function(){var k=this;if(0<this.rh.Fq.length){this.formulaAssistanceTelemetryManager.sX(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var F={};F.zoomLevel=cb(this.$);this.formulaAssistanceUIControl.updateContext(F);this.Yq=function(){k.formulaAssistanceUIControl.renderAutoCompleteMenu(k.j0b,k.gridView.Nj.textBox.domElement,
k.Wdd())};this.Yq();this.Hk&&this.rh.Rhc&&this.raiseEvent(Ia.obd,null);this.qmd||this.rh.Rhc||this.raiseEvent("FormulaAutoCompleteShown");this.qmd=this.rr.canReceiveFocus=!0;this.lcf&&this.formulaAssistanceTelemetryManager.W8e(this.rh.j3b)}this.formulaAssistanceTelemetryManager.uQ(["autoCompleteRender"]);!ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.gSa&&null!==this.gSa&&0<this.gSa.length&&(this.KAa=!0)}};Ia.prototype.ltd=function(){this.lIa&&
(this.formulaAssistanceTelemetryManager.FY.selectByArrowKeyCounter++,this.lIa=!1);this.mIa&&(this.formulaAssistanceTelemetryManager.FY.selectByMouseHoverCounter++,this.mIa=!1);this.kIa&&(this.formulaAssistanceTelemetryManager.FY.commitByTabKeyCounter++,this.kIa=!1);this.iIa&&(this.formulaAssistanceTelemetryManager.FY.commitByEnterKeyCounter++,this.iIa=!1);this.jIa&&(this.formulaAssistanceTelemetryManager.FY.commitByMouseClickCounter++,this.jIa=!1)};Ia.prototype.Wdd=function(){var k=new Tb;k.completionItems=
this.rh.j3b;k.activeItemIndex=this.rh.Wk?this.rh.Wk.rowIndex:-1;this.sHd(k);return k};Ia.prototype.sHd=function(k){k.callbacks=new va;k.callbacks.onCompletionItemSelected=this.hzd;k.callbacks.onCompletionItemCommitted=this.gzd;k.callbacks.onFeedback=this.YQa;k.callbacks.onDismiss=this.onDismiss;k.callbacks.onRestoreFocus=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?this.onRestoreFocus:void 0};Ia.prototype.gEd=function(k){this.Efa=!0;var F=k.textEdit.newText;this.Ya.VRa(F.substring(this.Ya.text.length-
k.textEdit.range.start.character,F.length))};Ia.prototype.Zze=function(){this.Xy(!0);this.Efa=this.isListVisible=!1;this.hSa=this.iSa=!0};Ia.prototype.Fld=function(k,F){this.Ya.text=k.substring(0,F.range.start.character)+F.newText+k.substring(F.range.end.character,k.length);this.gridView.Bj&&(this.gridView.pc.text=this.Ya.text)};Ia.ELd=function(k){k.requester().runExperiment(new Ya)};Ia.a2g=function(k){var F=sc.y9g(),X={IsCompatibility:!1};X.NameDataStrings=k.label;X.Help=k.detail;F.IYf(X);F.textEdit=
k.textEdit;return F};Ia.CJa=function(){var k=String.format($b.IDh,$b.Gbd,ik.a.WMe),F=String.format($b.DDh,$b.Ebd,ai.a.M8c,pb.a.Zo,pb.a.$p),X=String.format($b.ADh,$b.zbd,ai.a.M8c,pb.a.Zo,ai.a.NNe,pb.a.$p);return String.format("{0}\r\n{1}\r\n{2}",k,F,X)};Ia.bni=function(k){return 36===k||58===k||33===k||39===k||32===k};Ia.I6h=function(k,F){return 32===k||91===k||!F.Qha};Ck.Object.defineProperties(Ia.prototype,{Rt:{configurable:!0,enumerable:!0,get:function(){return this.rh}},Qt:{configurable:!0,enumerable:!0,
get:function(){return this.t8}},BJb:{configurable:!0,enumerable:!0,get:function(){return this.rh.ye}},GUe:{configurable:!0,enumerable:!0,get:function(){return this.rh}},jUe:{configurable:!0,enumerable:!0,get:function(){return this.aja}},rh:{configurable:!0,enumerable:!0,get:function(){return this.aog}},E0a:{configurable:!0,enumerable:!0,get:function(){return this.JAa?this.Ya?this.Ya.text:null:this.aW}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.Rt.isListVisible},set:function(k){this.Hk&&
!k&&this.m1a();this.Rt.isListVisible=k}},tableManager:{configurable:!0,enumerable:!0,get:function(){return this.Awg}},bka:{configurable:!0,enumerable:!0,get:function(){return 0<this.P3}},IH:{configurable:!0,enumerable:!0,get:function(){return this.Efa}},gridView:{configurable:!0,enumerable:!0,get:function(){return this.chi?this.fr:ff.g(this.$)}},T_b:{configurable:!0,enumerable:!0,get:function(){return this.u1d}},P3:{configurable:!0,enumerable:!0,get:function(){return this.CIe},set:function(k){this.CIe=
k;k||(this.R3=0)}},svj:{configurable:!0,enumerable:!0,get:function(){if(null==this.tpc){var k=this.$.xc;this.tpc=!!k&&!k.inEmbedView}return this.tpc}},bWf:{configurable:!0,enumerable:!0,get:function(){return this.rh.j3b[this.rh.Wk.rowIndex]}},OUe:{configurable:!0,enumerable:!0,get:function(){!this.Hbd&&this.pluginScheduler&&(this.Hbd=this.pluginScheduler.getFunctionsShortDescriptions());return this.Hbd}}});Ia.obd="FACardOpened";Ia.Kad="FAFocusOnSmartSuggestionsCard";Ia.Ujd=null;Object(ie.a)(Ia,"FormulaAssistanceControl",
bj.a,[745,746,3,747,748]);var pd=Fi.a;Wl(La,pd);La.prototype.Ime=function(k){this.addHandler("FAFunctionNameUpdated",k)};La.prototype.mPf=function(k){this.removeHandler("FAFunctionNameUpdated",k)};La.prototype.xne=function(k){this.addHandler("FAParameterSelectionChangedOld",k)};La.prototype.JPf=function(k){this.removeHandler("FAParameterSelectionChangedOld",k)};La.prototype.wne=function(k){this.addHandler("FAParameterSelectionChanged",k)};La.prototype.IPf=function(k){this.removeHandler("FAParameterSelectionChanged",
k)};La.prototype.XDg=function(k){this.addHandler("DC",k)};La.prototype.p$i=function(k){this.removeHandler("DC",k)};La.prototype.dismiss=function(){this.Zv=!1;this.formulaAssistanceUIControl&&(this.Yq=null,this.fR&&this.$G.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.$ka=null,this.rr.canReceiveFocus=!1)};La.prototype.show=function(k,F){var X=this;this.Zv=!0;var ra=this.QDd(k);this.formulaAssistanceUIControl&&(this.formulaAssistanceTelemetryManager.sX(["argumentAssistanceRender"]),
k={},k.zoomLevel=cb(this.$),this.formulaAssistanceUIControl.updateContext(k),ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Yq=function(){X.formulaAssistanceUIControl.renderArgumentAssistanceCard(X.domElement,F,ra)},this.Yq()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,F,ra),this.TCd(ra),this.fR&&this.$G.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Yq,function(){return X.formulaAssistanceUIControl.dismiss(X.domElement)}),
this.rr.canReceiveFocus=!0,this.formulaAssistanceTelemetryManager.uQ(["argumentAssistanceRender"]),this.formulaAssistanceTelemetryManager.G7b("argumentAssistanceOverall"))};La.prototype.dispose=function(){if(this.$){var k=ff.g(this.$);k&&(k.ha&&k.ha.MF(this.ld),k.view.Xq(this.qt),this.fR&&k.tc.Um(this.Tf))}zg.a.Ha(this.rr);this.$=null};La.prototype.QDd=function(k){var F=new Eb;F.functionRenderingInfo=k;F.cardMode=this.R2;this.uHd(F);return F};La.prototype.uHd=function(k){k.callbacks=new Ja;k.callbacks.onHelpLink=
this.lvb(k.functionRenderingInfo);k.callbacks.onCardModeChange=this.onCardModeChange;k.callbacks.onFeedback=this.YQa;this.rba&&(k.callbacks.onDismissClick=this.onDismissClick)};La.prototype.lvb=function(k){var F=this;return function(){Ha(F.$,k.helpID,k.isUDF)}};La.prototype.hOd=function(){var k=gi.a.get(We.a.H_b);this.R2=k?parseInt(k,10):La.r5c;this.formulaAssistanceTelemetryManager.mXf(this.R2)};La.prototype.TCd=function(k){var F=k.functionRenderingInfo.functionName;this.$ka&&Z.a.equals(this.$ka,
F,!0)?(F=Bg.a.map(k.functionRenderingInfo.signatures,function(X){var ra="";0<=X.signatureParams.activeParam&&X.signatureParams.activeParam<X.signatureParams.params.length&&(ra=X.signatureParams.params[X.signatureParams.activeParam]);return ra}),this.raiseEvent("FAParameterSelectionChanged",new mc(F))):(this.$ka=F,k=Bg.a.map(k.functionRenderingInfo.signatures,function(X){return X.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new sb(F,k)))};La.prototype.PNb=function(k){this.R2=
k;try{gi.a.Cv(We.a.H_b,k.toString(),Lj.AFrame.qea)}catch(F){Wd.ULS.sendTraceTag(537162074,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",F.message)}};La.CJa=function(){return document.createElement("div")};Ck.Object.defineProperties(La.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.Zv},set:function(k){k||this.dismiss();this.Zv=k}}});La.r5c=0;Object(ie.a)(La,"FormulaArgumentAssistanceControl",Fi.a,[821]);var wd;(function(k){k[k.Dismissed=
0]="Dismissed";k[k.Smart=1]="Smart";k[k.Simple=2]="Simple";k[k.Mixed=3]="Mixed"})(wd||(wd={}));Object(ie.b)("UIState",wd);var ue=Fi.a;Wl(za,ue);za.prototype.Gme=function(k){this.addHandler("FACardOpened",k)};za.prototype.lPf=function(k){this.removeHandler("FACardOpened",k)};za.prototype.Eme=function(k){this.addHandler("FAFocusOnSmartSuggestionsCard",k)};za.prototype.jPf=function(k){this.removeHandler("FAFocusOnSmartSuggestionsCard",k)};za.prototype.Fme=function(k){this.addHandler("FormulaAutoCompleteShown",
k)};za.prototype.kPf=function(k){this.removeHandler("FormulaAutoCompleteShown",k)};za.prototype.lVc=function(k){this.addHandler("SelectedRowChanged",k)};za.prototype.UId=function(k){this.removeHandler("SelectedRowChanged",k)};za.prototype.kZb=function(k){this.addHandler("ListBoxUpdated",k)};za.prototype.Gsc=function(k){this.removeHandler("ListBoxUpdated",k)};za.prototype.dispose=function(){if(this.$){var k=ff.g(this.$);this.E9&&(this.$.userOperationManager.Ul(this.wca),this.$.userOperationManager.Ul(this.DOa));
k&&(k.ha&&k.ha.MF(this.ld),k.tc&&this.$yb&&k.tc.Um(this.Tf),k.view.Xq(this.qt));this.$.xa&&this.$.xa.Wg(this.Th)}zg.a.Ha(this.rr);this.$=null};za.prototype.KDg=function(k){this.addHandler("CVIC",k)};za.prototype.b$i=function(k){this.removeHandler("CVIC",k)};za.prototype.Xh=function(k,F){if(!this.visible)return!1;this.gBc(F);var X;return(X=this.f2h(F)).Zcc?X.result:this.Xuj(F)};za.prototype.qwb=function(k){if(!this.visible)return!1;var F=!1;switch(k){case 1872288872:this.IH&&this.Vma();this.visible=
!1;F=!0;break;case -798660877:this.Yeb(this.Yvb(this.gX+1));F=!0;break;case 137938150:this.Yeb(this.Yvb(this.gX-1));F=!0;break;case 2091832999:this.Yeb(this.Yvb(this.gX+8));F=!0;break;case 742457698:this.Yeb(this.Yvb(this.gX-8));F=!0;break;case 125627505:case 267796030:this.pqb(this.Qt.items[this.gX]),F=!0}return F};za.prototype.show=function(k){this.Ya=ff.g(this.$).Nj;this.Zv=!0;this.gX=0;this.Qt=k;0<this.Qt.items.length&&(this.render(),this.Yeb(this.Yvb(this.gX)),1===this.Qt.items[0].type&&this.$yb&&
(this.KAa=!0));this.formulaAssistanceTelemetryManager.W8e(k.items)};za.prototype.Vma=function(){this.Efa=!1;this.Ya.MHe()};za.prototype.Xuj=function(k){return[1872288872,-798660877,137938150,2091832999,742457698,125627505,267796030].includes(k)};za.prototype.f2h=function(k){return this.IH?125627505===k||267796030===k?(this.pqb(this.Qt.items[this.gX]),{Zcc:!0,result:!1}):!this.KDf||-798660877!==k&&137938150!==k?{Zcc:!1}:{Zcc:!0,result:!1}:{Zcc:!1}};za.prototype.render=function(){var k=this;this.formulaAssistanceTelemetryManager.sX(["autoCompleteRender"]);
if(this.formulaAssistanceUIControl){var F={};F.zoomLevel=cb(this.$);this.formulaAssistanceUIControl.updateContext(F);this.Yq=function(){k.formulaAssistanceUIControl.renderAutoCompleteMenu(k.domElement,k.Ya.textBox.domElement,k.Wdd())};this.Yq();this.U1i();this.rr.canReceiveFocus=!0;this.formulaAssistanceTelemetryManager.uQ(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.G7b("autoCompleteOverall")}};za.prototype.U1i=function(){var k=this.ENb;this.ENb=this.EYh(this.Qt.items);k!==wd.Dismissed&&
k!==wd.Smart||this.ENb!==wd.Simple&&this.ENb!==wd.Mixed||this.raiseEvent("FormulaAutoCompleteShown")};za.prototype.w2i=function(){var k;if(this.bii&&0!==this.Qt.items.length){var F=0<=this.gX?this.gX:0,X=this.Qt.items[F];X={UF:X.label,description:null!==(k=X.detail)&&void 0!==k?k:"",selectedIndex:F+1,length:this.Qt.items.length};this.raiseEvent("SelectedRowChanged",X)}};za.prototype.pqb=function(k){if(this.Ya&&this.visible){var F=k.textEdit;this.Fld(this.Ya.text,F);this.Ya.textBox.caretPosition=F.range.start.character+
F.newText.length;this.IH&&(this.Efa=!1,this.$yb&&(this.hSa=this.iSa=!0),this.E9&&this.opj(),this.Ya.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:k.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.V8e(k.kind)}};za.prototype.opj=function(){var k=ff.g(this.$);this.formulaAssistanceTelemetryManager.oB={el:k.ha.ta.activeCell,Cpb:k.pc.text,rqb:!0};this.formulaAssistanceTelemetryManager.ojc=
this.$.xa.qa.sheetId;this.formulaAssistanceTelemetryManager.lBb=this.$.ea.Te;this.$.userOperationManager.xq(this.DOa)};za.prototype.YHg=function(){this.KAa&&(this.formulaAssistanceTelemetryManager.mV.smartSuggestionShownCounter++,this.KAa=!1);this.iSa&&(this.formulaAssistanceTelemetryManager.mV.smartSuggestionSelectedCounter++,this.iSa=!1);this.hSa&&(this.formulaAssistanceTelemetryManager.mV.smartSuggestionCommittedCounter++,this.hSa=!1)};za.prototype.Wdd=function(){var k=new Tb;k.completionItems=
this.Qt.items;k.activeItemIndex=this.gX;this.sHd(k);return k};za.prototype.sHd=function(k){k.callbacks=new va;k.callbacks.onCompletionItemSelected=this.hzd;k.callbacks.onCompletionItemCommitted=this.gzd;k.callbacks.onFeedback=this.YQa;k.callbacks.onDismiss=this.HHi;k.callbacks.onRestoreFocus=ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?this.onRestoreFocus:void 0};za.prototype.gEd=function(k){this.Efa=!0;var F=k.textEdit.newText;this.Ya.VRa(F.substring(this.Ya.text.length-
k.textEdit.range.start.character,F.length))};za.prototype.Yeb=function(k){var F=this.gX;this.gX=k;var X=this.Qt.items[k];this.IH&&this.Vma();F!==k&&this.render();1===X.type&&ve.EwaSettings.Gb()&&!ff.g(this.$).Nj.text.includes("\n")&&this.gEd(X);this.w2i()};za.prototype.Yvb=function(k){return 0>k?0:Math.min(k,this.Qt.items.length-1)};za.prototype.Fld=function(k,F){this.Ya.text=k.substring(0,F.range.start.character)+F.newText+k.substring(F.range.end.character,k.length);ff.g(this.$).Bj&&(ff.g(this.$).pc.text=
this.Ya.text)};za.prototype.ltd=function(){this.lIa&&(this.formulaAssistanceTelemetryManager.FY.selectByArrowKeyCounter++,this.lIa=!1);this.mIa&&(this.formulaAssistanceTelemetryManager.FY.selectByMouseHoverCounter++,this.mIa=!1);this.kIa&&(this.formulaAssistanceTelemetryManager.FY.commitByTabKeyCounter++,this.kIa=!1);this.iIa&&(this.formulaAssistanceTelemetryManager.FY.commitByEnterKeyCounter++,this.iIa=!1);this.jIa&&(this.formulaAssistanceTelemetryManager.FY.commitByMouseClickCounter++,this.jIa=
!1)};za.prototype.gBc=function(k){switch(k){case -798660877:case 137938150:case 2091832999:case 742457698:this.lIa=!0;break;case 125627505:this.kIa=!0;break;case 267796030:this.iIa=!0}};za.CJa=function(){return document.createElement("div")};za.prototype.EYh=function(k){return k.reduce(function(F,X){return F|=0===X.type?wd.Simple:wd.Smart},wd.Dismissed)};Ck.Object.defineProperties(za.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.Zv},set:function(k){k||this.dismiss();
this.Zv=k}},IH:{configurable:!0,enumerable:!0,get:function(){return this.Efa}},KDf:{configurable:!0,enumerable:!0,get:function(){return 1===this.Qt.items.length&&1===this.Qt.items[0].type}}});Object(ie.a)(za,"FormulaAutoCompleteControl",Fi.a,[820,3,747]);var Je=b(1084);ka.prototype.getRichValueFieldListContext=function(k,F,X,ra){var ab={r$:k,DIe:F},Qb;if(Qb=Object(Je.b)(this.Nrd))Qb=this.Nrd,Qb=!(ab.r$.FirstRow===Qb.r$.FirstRow&&ab.r$.FirstColumn===Qb.r$.FirstColumn&&ab.r$.LastRow===Qb.r$.LastRow&&
ab.r$.LastColumn===Qb.r$.LastColumn&&ab.r$.SheetName===Qb.r$.SheetName&&ab.DIe===Qb.DIe);Qb&&this.gh.xbb();this.Nrd=ab;this.gh.BZ(k,X,ra,F);this.k9b=new Je.a;this.gh.Qyb?this.k9b.resolve(this.gh.Ok):this.w6i();return this.k9b.promise};ka.prototype.dispose=function(){var k,F;null===(F=null===(k=ff.g(this.$))||void 0===k?void 0:k.tc)||void 0===F?void 0:F.Um(this.Tf)};ka.prototype.w6i=function(){this.gh.cZb(this.mya);this.gh.sEg(this.Mwf)};ka.prototype.Y$f=function(){this.gh.ysc(this.mya);this.gh.G$i(this.Mwf)};
Object(ie.a)(ka,"ServerDataProvider",null,[819]);Ea.prototype.m1h=function(k,F,X){return isNullOrUndefined(this.coloredReferencesManager)?!1:this.coloredReferencesManager.TWd(k,F,X)};Ck.Object.defineProperties(Ea.prototype,{coloredReferencesManager:{configurable:!0,enumerable:!0,get:function(){this.TUa||(this.TUa=this.$.da.za(281));return this.TUa}}});Object(ie.a)(Ea,"FormulaHighlightsControl",null,[]);var tg=b(1183);qa.prototype.dispose=function(){if(this.$){var k=this.gridView;k&&(k.ha&&O.a.OV()&&
k.ha.Aza(this.Sh),this.gef&&k.Ea&&k.Ea.tv(this.Oi))}this.z2&&this.gridView.tc.Um(this.Tf);this.rba&&(this.z2||this.gridView.tc.Um(this.Tf),this.hqa.p$i(this.ftf));this.vfa.b$i(this.ntf);this.functionInfoManager&&this.functionInfoManager.Zab(this.onFunctionInfoLoaded);O.a.kfc&&this.Ya&&this.Ya.NHb(this.k6);zg.a.Ha(this.hqa);zg.a.Ha(this.vfa);this.vfa=this.hqa=this.functionInfoManager=this.$=null};qa.prototype.dej=function(){this.dNa=-1;this.eNa=null};qa.prototype.e6c=function(){this.vfa.visible=!1;
this.hqa.visible=!1};qa.prototype.Xh=function(){this.tda();return!1};qa.prototype.tda=function(){if(!this.Ya.FK)if(this.formulaAssistanceTelemetryManager.tob.formulaAssistanceRequestAttemptedCounter++,this.Jvj()){this.functionInfoManager.e_||(this.functionInfoManager.vYa(this.onFunctionInfoLoaded),this.functionInfoManager.Q1a({}));var k=this.Ya,F=k.text;k=k.textBox.caretPosition;this.z2&&F.startsWith("=")&&(this.NLa=!0,1===F.length&&(this.isCellContentOnlyEqualDuringEdit=!0));!this.rba||this.JRa?
(this.formulaAssistanceTelemetryManager.sX(["argumentAssistanceComputation","autoCompleteComputation","argumentAssistanceOverall","autoCompleteOverall"]),this.sWf(F,k)):(this.formulaAssistanceTelemetryManager.sX(["autoCompleteComputation","autoCompleteOverall"]),this.Mdj(F,k))}else this.formulaAssistanceTelemetryManager.tob.formulaAssistanceRequestOptimizedCounter++};qa.prototype.sWf=function(k,F){var X=this;k=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:k,
caretPosition:F},argumentAssistance:{content:k,caretPosition:F}});this.Gca+=1;k.then(function(ra){--X.Gca;0===ra.kind&&(X.h4e(ra.payload.argumentAssistance),X.L4e(ra.payload.functionSuggestion));return null})};qa.prototype.Mdj=function(k,F){var X=this;k=this.pluginScheduler.requester().functionSuggestion({content:k,caretPosition:F});this.Gca+=1;k.then(function(ra){--X.Gca;0===ra.kind&&X.L4e(ra.payload);return null})};qa.prototype.WJd=function(k,F){var X=this;k=this.pluginScheduler.requester().argumentAssistance({content:k,
caretPosition:F});this.Gca+=1;k.then(function(ra){--X.Gca;0===ra.kind&&X.h4e(ra.payload)})};qa.prototype.Jvj=function(){var k=this.Ya,F=k.text;k=k.textBox.caretPosition;if(this.vfa.visible&&Z.a.equals(F,this.eNa,!0)&&k===this.dNa)return!1;this.eNa=F;this.dNa=k;return!0};qa.prototype.ELd=function(){this.pluginScheduler.requester().runExperiment(new Ya)};qa.prototype.h4e=function(k){k&&this.Ya.isEditing?(this.formulaAssistanceTelemetryManager.uQ(["argumentAssistanceComputation"]),this.hqa.show(k,this.Ya.textBox.domElement)):
this.hqa.dismiss()};qa.prototype.L4e=function(k){k&&0<k.items.length&&this.Ya.isEditing?(this.formulaAssistanceTelemetryManager.uQ(["autoCompleteComputation"]),this.vfa.show(k)):this.vfa.dismiss()};qa.prototype.CLd=function(k){this.pluginScheduler.requester().runAuthoringExperiment({content:k,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit})};qa.prototype.nDb=function(k){var F,X=this.gridView.ha.ta.activeCell;if(X){var ra=this.calcManager.kta(X,!this.Vmd);if(ra){var ab=this.$.xa,
Qb=ra.sheet.index;0>=ab.count||0>Qb||Qb>=ab.count||(Qb=ab=null,this.Ixd&&void 0!==this.calcManager&&null!==this.calcManager&&(k=null!==(F=null===k||void 0===k?void 0:k.cell)&&void 0!==F?F:this.gridView.Ea.cs(X))&&(F=this.calcManager.xbc(k.il),void 0!==F&&null!==F&&(ab=F.FormatString,Qb=F.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:ra.range.col,rowIndex:ra.range.row,sheetIndex:this.$.xa.getItem(ra.sheet.index).sheetId,docName:ra.sheet.document.name,docPath:ra.sheet.document.path,
formatString:ab,builtIn:Qb}))}else Wd.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}};qa.prototype.jRj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.functionInfoManager.w$b)};qa.prototype.sld=function(){this.gridView.ha.Ura(this.Sh);var k=O.a.iyb()?this.gridView.lc(null):void 0;this.nDb(k);O.a.kfc&&this.Ya.tYa(this.k6);this.ELd();this.vfa.KDg(this.ntf);this.pluginScheduler.setServerDataProvider(new ka(this.gh,
this.$));this.tda()};qa.prototype.TWd=function(k,F,X){X=Object(Je.b)(F)?this.Xdd(F,Object(Je.b)(X)?X:tg.a):this.Xdd(k.text,k.textBox.selection);return this.NCh.m1h(k,F,X)};Ck.Object.defineProperties(qa.prototype,{cja:{configurable:!0,enumerable:!0,get:function(){return this.vfa}},iUe:{configurable:!0,enumerable:!0,get:function(){return this.hqa}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.gridView.Nj}}});Object(ie.a)(qa,"FormulaAssistanceManager",null,[743,3]);var oh=si.a;Wl(oa,
oh);oa.prototype.create=function(){var k=this,F=O.a.OV(),X=ve.EwaSettings.ma(375),ra=ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),ab=O.a.NV(this.$),Qb=this.$.da,Fc=eh.GetServiceTaskFactory.create(Qb,134,this.la,this.vb),ld=eh.GetServiceTaskFactory.Xa(this.$.da,12,477,this.vb);var ud=O.a.d5()?eh.GetServiceTaskFactory.create(this.$.da,449,this.$.la,1):Xf.Task.Sa(null);var jd=O.a.OV()?eh.GetServiceTaskFactory.create(this.$.da,414,this.$.la,1):Xf.Task.Sa(null);
if(ra||F){var Ye=eh.GetServiceTaskFactory.Xa(Qb,266,265,this.vb),Bf=eh.GetServiceTaskFactory.Xa(Qb,219,220,this.vb),Tg=eh.GetServiceTaskFactory.Xa(Qb,491,492,this.vb);Ud.TaskExtensions.Ba(Ud.TaskExtensions.te([Ye,jd,ud,Bf,Tg],this.la),function(){var qh=Qb.za(19)||new qd(k.$,jd.result),Ri=Bf.result;if(ab){var ci=Qb.za(464);ci||(ci=new qa(k.$,qh,Ye.result,jd.result,ud.result,Tg.result,ld.result.a3c(k.$,Fc.result)),Ri.cXc(ci.iUe),Ri.dXc(ci.cja),ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")&&
Ri.eXc(ci.cja))}else ci=Qb.za(221),ci||(ci=new Ia(k.$,qh,Fc.result,Ye.result,null,ld.result,ud.result,Tg.result,jd.result),Ri.cXc(ci.jUe),Ri.eXc(ci.GUe),Ri.dXc(ci)),X&&(Qb.za(317)||new zb(k.$));k.Eb(qh)},this.la,3)}else{var $g=eh.GetServiceTaskFactory.Xa(Qb,219,220,this.vb),Wg=eh.GetServiceTaskFactory.Xa(Qb,491,492,this.vb);Ud.TaskExtensions.Ba(Ud.TaskExtensions.te([$g,ud,jd],this.la),function(){var qh=Qb.za(19)||new qd(k.$,jd.result),Ri=$g.result,ci=Qb.za(221);ci||(ci=new Ia(k.$,qh,Fc.result,null,
null,ld.result,ud.result,Wg.result,jd.result),Ri.cXc(ci.jUe),Ri.eXc(ci.GUe),Ri.dXc(ci));X&&(Qb.za(317)||new zb(k.$));k.Eb(qh)},this.la,3)}};oa.ka=function(k){k.da.Ga(153,new oa(k))};Object(ie.a)(oa,"FunctionInfoManagerFactory",si.a,[]);var Qh=b(212),ni=b(77),Jj=b(119);xa.prototype.cYe=function(){return Jj.a(Vh.a.Ua,this.startTime)};Object(ie.a)(xa,"OngoingAction",null,[]);var Mj=ni.a;Wl(ta,Mj);ta.prototype.yFf=function(k){Wd.ULS.sendTraceTag(537153864,0,50,"ActionAggregator<{0}>.PerformThrottledAction: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",
this.kla,this.DLa,this.z5a);this.ynb=this.Kyg.RVc(k,this.ynb);this.Qld()};ta.prototype.dispose=function(){this.documentVisibilityObserver&&this.documentVisibilityObserver.QHb(this.lya);this.ewe();Mj.prototype.dispose.call(this)};ta.prototype.uZf=function(k){this.PYc?(this.NOa=k?new xa:null,k?this.startTimer():this.ewe()):this.NOa=k?{}:null};ta.prototype.QSe=function(k){k=void 0===k?null:k;this.PYc&&k&&k.eK?Wd.ULS.sendTraceTag(537153863,0,50,"ActionAggregator<{0}>.FinishedCallback: timedout, skipping",
this.kla):(Wd.ULS.sendTraceTag(537153862,0,50,"ActionAggregator<{0}>.FinishedCallback: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.kla,this.DLa,this.z5a),this.uZf(!1),this.Qld())};ta.prototype.Qld=function(){var k=this;if(!this.nLb()){var F=this.ynb;this.ynb=null;this.uZf(!0);Wd.ULS.sendTraceTag(537153857,0,50,"ActionAggregator<{0}>.InternalPerformAction: Calling PerformAction.",this.kla);var X=this.PYc?this.NOa.Cx.token:Qh.a.none;Ud.TaskExtensions.Ba(this.Jyg.SCd(F),function(){k.QSe(X)},
X,0,this.HO)}};ta.prototype.nLb=function(){return!this.z5a||this.DLa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.zi?(Wd.ULS.sendTraceTag(593376846,0,50,"ActionAggregator<{0}>.ShouldThrottle: Not Calling PerformAction as document is hidden.",this.kla),!0):!1};ta.prototype.ewe=function(){this.Poc&&this.Poc.cancel()};ta.prototype.startTimer=function(){this.QYc<=this.Aue&&(this.Poc=mi.a.instance.create(this.rPi,this.TRg,$i.a.nje))};Ck.Object.defineProperties(ta.prototype,{DLa:{configurable:!0,
enumerable:!0,get:function(){return!!this.NOa}},z5a:{configurable:!0,enumerable:!0,get:function(){return!!this.ynb}}});Object(ie.a)(ta,"ActionAggregator",ni.a,[804,3]);var uk=b(130),H=Ga.a;Wl(ha,H);ha.prototype.SEg=function(k){this.addHandler("KBIS",k)};ha.prototype.Y$i=function(k){this.removeHandler("KBIS",k)};ha.prototype.dispose=function(){this.firstElement&&rb.a.removeHandler(this.firstElement,Gg.a.focus,this.jwf);this.Ds&&this.Ds.detach("focus");this.Gw&&(rb.a.removeHandler(this.Gw,Gg.a.focus,
this.cyf),rb.a.removeHandler(this.Gw,Gg.a.blur,ha.onBlur),Hk.KeyInputManager.instance.Aa(Gg.a.Xb,this.Gw,this.dyf));Hk.KeyInputManager.instance.Aa(Gg.a.Xb,this.$.domElement,this.yDf);this.Ds=this.Gw=this.firstElement=this.$=null;H.prototype.dispose.call(this)};ha.prototype.K5g=function(){this.$tj?(this.firstElement=document.documentElement,this.Ds=uk.a.instance.VG(document.parentWindow),this.Ds.ka("focus",this.JSi)):(this.firstElement=ha.XCe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),
rb.a.addHandler(this.firstElement,Gg.a.focus,this.jwf))};ha.prototype.I6g=function(){this.Gw=ha.XCe();this.Gw.id=We.a.eKe;this.Gw.setAttribute(We.a.Ot,we.a.instance.ga(860));document.body.appendChild(this.Gw);rb.a.addHandler(this.Gw,Gg.a.focus,this.cyf);rb.a.addHandler(this.Gw,Gg.a.blur,ha.onBlur);Hk.KeyInputManager.instance.pa(Gg.a.Xb,this.Gw,this.dyf)};ha.prototype.Cwh=function(k){this.u9f(k);return!1};ha.prototype.hIi=function(){this.cMa=!0;ff.g(this.$).focus();ff.g(this.$).ha.F4e();this.raiseEvent("KBIS");
return!0};ha.prototype.u9f=function(k){this.cMa?this.cMa=!1:(this.cMa=!0,k&&k.focus())};ha.XCe=function(){var k=document.createElement("div");k.tabIndex=0;return k};ha.t7e=function(){document.body.classList.add(pb.a.FMe)};ha.onBlur=function(){document.body.classList.remove(pb.a.FMe)};Object(ie.a)(ha,"EmbedViewFocusControl",Ga.a,[803,3]);var ia=b(60),ib=b(567),Lb=Ga.a;Wl(U,Lb);U.prototype.cZb=function(k){this.addHandler("FieldInfoListContextLoaded",k)};U.prototype.ysc=function(k){this.removeHandler("FieldInfoListContextLoaded",
k)};U.prototype.sEg=function(k){this.addHandler("GetFieldInfoListContextOperationFailed",k)};U.prototype.G$i=function(k){this.removeHandler("GetFieldInfoListContextOperationFailed",k)};U.prototype.dispose=function(){this.xb=null;this.xbb();Lb.prototype.dispose.call(this)};U.prototype.uXi=function(){var k=Array(9);k[0]={Name:"Day of the Week"};k[1]={Name:"Month of the Year"};k[2]={Name:"Days from Today"};k[3]={Name:"Total Weekdays from Today"};k[4]={Name:"Years from Today"};k[5]={Name:"End of Month"};
k[6]={Name:"Next Month"};k[7]={Name:"Next Week"};k[8]={Name:"Next Day"};var F={ColumnName:"",ColumnIndex:-1};F.FieldInfoDataList=k;k=[];k[0]=F;this.SNd(k)};U.prototype.BZ=function(k,F,X,ra){ra=void 0===ra?null:ra;if(k){this.FZc();this.x1b();var ab=null,Qb=!1,Fc;if(Fc=!ra)Fc=this.nLj(k,F,X),Qb=Fc.o$a,ab=Fc.Ok,Fc=Fc.returnValue;if(Fc)if(this.CFd||this.SNd(ab),this.STb=!0,this.nP=ab,this.CFd){if(!Qb){this.aWa=!0;this.Rqc();return}}else if(this.nP&&0<this.nP.length&&(this.aWa=!0,this.Rqc()),!Qb)return;
this.ccg(k,ra,F,X,!1)}};U.prototype.ccg=function(k,F,X,ra,ab){if(this.$.ea.rc){this.$.Pb&&(this.FIb=this.$.Pb.Gc("WebServiceCall","GetRichValueFieldInfoListContext"));this.$ub=null;var Qb=this.$.na.va.hc(),Fc=this.$.na.va,ld=this.EJi,ud=this.DJi,jd=Fc.Na(1,null);jd.selectedRange=k;jd.richValueKeyPath=F;jd.singleColumn=X;jd.searchForRange=ra;jd.calculateMajorityDataType=ab;this.$ub=Yg.i(Fc,"GetRichValueFieldListContextList",jd,ld,ud,null,Qb,4)}else this.nP=null};U.prototype.xbb=function(){this.nP=
null;this.aWa=!1;this.FZc();this.x1b();this.$ub=null;this.BSb=-1};U.prototype.FZc=function(){U.ypb(this.$ub)};U.prototype.x1b=function(){U.ypb(this.Ddd)};U.prototype.Rqc=function(){this.raiseEvent("FieldInfoListContextLoaded")};U.prototype.nn=function(k){k=vd.D(k);--k.left;--k.right;return this.tableManager.nn(k)};U.prototype.TJa=function(k){var F=this;k.FirstColumn=k.FirstColumn;k.LastColumn=k.LastColumn;k.FirstRow=k.FirstRow;k.LastRow=k.LastRow;this.x1b();this.Ddd=null;return rh.a(this.$.userOperationManager,
function(X,ra,ab){return Yg.w(F.$.na.va,k,hh.b(X,function(Qb){F.OJi(Qb)}),hh.a(ra,ra,function(Qb){F.NJi(Qb)}),ab,null)},function(X){return new cg.a(264,0,X,80)},null)};U.prototype.NJi=function(k){k=pi.a.ig(k.data);Wd.ULS.sendTraceTag(525336847,0,10,"FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: {0}",Vf.a.Tc(k))};U.prototype.OJi=function(k){if(qc.a(k))-315732528!==k.Errors[0].MessageId&&Wd.ULS.sendTraceTag(525336846,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : {0}",
Vf.a.Tc(k.Errors));else if(k&&k.Result){k=k.Result;var F=k.HasHeaderRow;F=new ib.AutofilterRange(k.TableRange.FirstRow+(F?1:0)+1,k.TableRange.FirstColumn+1,k.TableRange.LastRow+1,k.TableRange.LastColumn+1,null,null,null,0,F);this.BSb=k.TableRange.FirstColumn;(k=this.CIf(!1,!0,F))||Wd.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.SNd(k)}else Wd.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")};
U.prototype.nLj=function(k,F,X){var ra=null;var ab=!1;if(k.SheetName!==this.$.ea.qa.sheetName)return{returnValue:!1,o$a:ab,TJa:!1,Ok:ra};this.BSb=-1;if(X){var Qb=this.nn(k);if(!Qb||!Qb.dba)return{returnValue:!1,o$a:ab,TJa:!1,Ok:ra};var Fc=ff.g(this.$).Nb.c1e(Qb);this.O3d=Qb;if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&Fc&&0<Fc.count)return--k.FirstColumn,--k.LastColumn,this.Ddd=this.TJa(k),{returnValue:!0,o$a:ab,TJa:!0,
Ok:ra};Qb.top+=1;Qb.right=vd.D(k).right-1}else Qb=new ib.AutofilterRange(k.FirstRow+1,k.FirstColumn+1,k.LastRow+1,k.LastColumn+1,null,null,null,0,!1);if(Qb.top>Qb.bottom||Qb.left>Qb.right)return{returnValue:!0,o$a:ab,TJa:!1,Ok:ra};k=ff.g(this.$);var ld=k.rb.width,ud=k.rb.height;Fc=k.view.visibleArea;ld=new ia.a(Fc.x-ld,Fc.y-ud,Fc.width+ld,Fc.height+ud);ud=k.tg(Qb);if(!Fc||!ud||!k.uhc(Qb))return{returnValue:!1,o$a:ab,TJa:!1,Ok:ra};ld.contains(ud)||(ab=!0);ra=this.CIf(F,X,Qb);return{returnValue:!0,
o$a:ab,TJa:!1,Ok:ra}};U.prototype.SNd=function(k){k&&Wd.ULS.sendTraceTag(25264348,0,50,"Retrieved {0} rich value field contexts from block cache",k.length);this.STb=!0;(this.nP=k)&&0<this.nP.length&&(this.aWa=!0,this.Rqc())};U.prototype.CIf=function(k,F,X){var ra=null;var ab=X.clone();if(F){F=X.right;for(var Qb=0;F>=X.left;--F){ab.left=F;ab.right=F;var Fc=this.qYe(ab,!0,X.left);if(Fc){ra||(ra=[]);ra[Qb]=Fc;if(k)break;++Qb}}}else if(k=this.qYe(ab,!1))ra=[],ra[0]=k;return ra};U.prototype.qYe=function(k,
F,X){X=void 0===X?0:X;var ra=null;if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var ab=ff.g(this.$).Nb.cVh(k);if(ab&&0<ab.count){var Qb=Array(ab.count),Fc=0;ab=Gl(ab.values);for(ra=ab.next();!ra.done;ra=ab.next()){var ld={};ld.Name=ra.value;Qb[Fc]=ld;++Fc}Fc="";ab=-1;0<k.top&&F&&(k=new hb.Range(k.top-1,k.left,k.top-1,k.left,!1,!1),null!=ff.g(this.$).lc(k)&&null!=ff.g(this.$).lc(k).originalText&&(Fc=ff.g(this.$).lc(k).originalText),ab=k.left-X);ra={};
ra.ColumnName=Fc;ra.ColumnIndex=ab;ra.FieldInfoDataList=Qb}}else if((ab=ff.g(this.$).Nb.c1e(k))&&0<ab.count){Qb=Array(ab.count);Fc=0;ab=Gl(ab);for(ra=ab.next();!ra.done;ra=ab.next())ld={},ld.Name=ra.value,Qb[Fc]=ld,++Fc;Fc="";ab=-1;0<k.top&&F&&(k=new hb.Range(k.top-1,k.left,k.top-1,k.left,!1,!1),Fc=ff.g(this.$).lc(k).originalText,ab=k.left-X);ra={};ra.ColumnName=Fc;ra.ColumnIndex=ab;ra.FieldInfoDataList=Qb}return ra};U.ypb=function(k){k&&Rf.AFrameworkApplication.Jd.yu(k.Pt)};Ck.Object.defineProperties(U.prototype,
{Qyb:{configurable:!0,enumerable:!0,get:function(){return this.aWa}},Mri:{configurable:!0,enumerable:!0,get:function(){return this.STb}},BUe:{configurable:!0,enumerable:!0,get:function(){return this.BSb}},u4c:{configurable:!0,enumerable:!0,get:function(){return this.O3d}},$:{configurable:!0,enumerable:!0,get:function(){return this.xb}},Ok:{configurable:!0,enumerable:!0,get:function(){return this.nP}},aNh:{configurable:!0,enumerable:!0,get:function(){return!!this.$ub}}});Object(ie.a)(U,"FieldInfoManager",
Ga.a,[802,3]);Wl(Y,U);Y.prototype.kNh=function(k,F){this.F1a=F;Wd.ULS.sendTraceTag(537153825,0,100,"FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col ({0}, {1}, {2}, {3})",k.FirstRow,k.FirstColumn,k.LastRow,k.LastColumn);this.ccg(k,null,!0,!1,!0)};Ck.Object.defineProperties(Y.prototype,{LG:{configurable:!0,enumerable:!0,get:function(){return this.skg}}});Object(ie.a)(Y,"FilterInfoManager",U,[801,802,3]);R.yqh="ewa-sharedUi-launchButton";
R.Bqh="ewa-sharedUi-launchButtonWithText";R.zqh="ewa-sharedUi-launchButtonClick";R.Cqh="ewa-sharedUi-launchButtonWithTextClick";R.Aqh="ewa-sharedUi-launchButtonText";Object(ie.a)(R,"CssClassNames",null,[]);var Nc=b(295),Vc=Fi.a;Wl(I,Vc);I.prototype.G2=function(k){this.addHandler(this.XFb,k)};I.prototype.lda=function(k){this.get_events().removeHandler(this.XFb,k)};I.prototype.iFg=function(k){this.addHandler("OnObjectButtonMouseOver",k)};I.prototype.oaj=function(k){this.get_events().removeHandler("OnObjectButtonMouseOver",
k)};I.prototype.hFg=function(k){this.addHandler("OnObjectButtonMouseOut",k)};I.prototype.naj=function(k){this.get_events().removeHandler("OnObjectButtonMouseOut",k)};I.prototype.kbg=function(k){k&&(this.UZa.innerHTML=k)};I.prototype.BOj=function(k,F,X){this.UZa.innerHTML="";k?k.nba(F,16,16,this.UZa,16,16,void 0,X):Wd.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")};I.prototype.COj=function(k,F){k&&(this.NMb.innerText=k);this.domElement.title=
F};I.prototype.dispose=function(){this.get_isInitialized()&&(this.hide(),this.Kc.xC(),zg.a.Dc([this.iZ,this.LZa]),rj.a.instance.Aa(Gg.a.click,this.domElement,this.xd),Ij.a.instance.Aa(Gg.a.pointerDown,this.domElement,this.xN),this.$Ra&&this.$Ra.dispose(),Vc.prototype.dispose.call(this))};I.prototype.vbb=function(){this.v2b&&this.domElement.classList.remove(this.v2b);this.Plc&&this.domElement.classList.add(this.Plc)};I.prototype.VFb=function(){this.Plc&&this.domElement.classList.remove(this.Plc);this.v2b&&
this.domElement.classList.add(this.v2b);this.T1a()};I.prototype.T1a=function(){this.Shc&&(this.$Ra.cancel(),this.A5f(),this.setOpacity(1));this.set_visible(!0)};I.prototype.Fp=function(k,F,X,ra,ab){ab=void 0===ab?!1:ab;k=ah.a(ra).Di(k);F=ah.a(ra).Di(F);ah.a(ra).ewc(this.domElement);this.domElement.style.top=Sc.HelperMethods.uc(F);this.domElement.style.left=this.domElement.style.right="";F=k;ab&&(F=k-this.domElement.offsetWidth);Vi.c(this.domElement.style,X,Sc.HelperMethods.uc(F));this.set_visible(!0);
this.setOpacity(1);this.Shc&&(this.URd=!1,this.QCj(),this.$Ra.Zq())};I.prototype.hide=function(){this.vbb();this.set_visible(!1);this.Shc&&(this.A5f(),this.$Ra.cancel())};I.prototype.A7b=function(){this.Kc.ka("mouseover",this.CN,!0);this.Kc.ka("mouseout",this.BN,!0)};I.prototype.QCj=function(){this.iZ.rn("mousemove")||this.iZ.ka("mousemove",this.OHi)};I.prototype.A5f=function(){this.iZ.rn("mousemove")&&this.iZ.detach("mousemove")};I.prototype.Nhd=function(k){if(this.domElement.parentNode){var F=Sys.UI.DomElement.getBounds(this.domElement),
X=new Sys.UI.Point(Math.round(F.x+F.width),Math.round(F.y+F.height));F=Math.abs(X.x-k.x);k=Math.abs(X.y-k.y);k=F>k?F:k;this.URd?this.setOpacity(I.XSg(k)):100>=k&&this.zje()}};I.prototype.zje=function(){this.URd=!0;this.$Ra.cancel()};I.prototype.setOpacity=function(k){mj.a.setOpacity(this.domElement,k);this.Iif=Vh.a.Ua.Vb};I.XSg=function(k){return 100>=k?1:250<=k?0:.01*(100-(k-100)/150*100)};Object(ie.a)(I,"OnObjectButton",Fi.a,[809,27,3]);var Hd=b(999),Ld=R.Aqh,Be=ni.a;Wl(G,Be);G.prototype.dispose=
function(){this.Ffh();this.$=null;Be.prototype.dispose.call(this)};G.prototype.getButton=function(k,F){return this.ava(k,void 0===F?!0:F)};G.prototype.ava=function(k,F){var X=k.toString();X in this.buttons||this.K6g(k,void 0===F?!0:F);return this.buttons[X]};G.prototype.Fp=function(k,F,X,ra,ab,Qb){ab=void 0===ab?!0:ab;Qb=void 0===Qb?!1:Qb;this.hide();if(this.$.ea.isNamedObjectViewMode&&hi.i(this.$.qa)){var Fc=ff.g(this.$).lS.domElement,ld=k+this.buttonWidth-Fc.scrollWidth;Fc=F+this.buttonWidth-Fc.scrollHeight;
k=0<ld?k-ld:k;F=0<Fc?F-Fc:F}this.ava(ra,ab).Fp(k,F,X,this.$,Qb)};G.prototype.hide=function(){var k=this.buttons,F;for(F in k)k[F].hide()};G.prototype.A7b=function(k,F){!this.X7e&&(F=this.buttons[F.toString()])&&(this.llc=function(X,ra){k(ra,!0)},F.iFg(this.llc),this.klc=function(X,ra){k(ra,!1)},F.hFg(this.klc),this.X7e=!0,F.A7b())};G.prototype.K6g=function(k,F){function X(Qb,Fc){ra.gGi(Fc,k)}var ra=this;this.hwa=String.format(this.tkd===pb.a.q8b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':
'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',wg.a.vg(this.tkd),wg.a.vg(this.skd),"{0}");var ab=String.format(this.hwa,wg.a.vg(this.altText));F=new I(""===this.buttonText?R.yqh:R.Bqh,""===this.buttonText?R.zqh:R.Cqh,pb.a.YA,ab,F,this.XFb,this.buttonText,Ld);F.G2(X);this.buttons[k.toString()]=F;this.OLe[k.toString()]=X;ab=ff.g(this.$).Uf(k);ab.domElement.insertBefore(F.domElement,ab.domElement.firstChild)};G.prototype.Ffh=function(){for(var k=Gl(Hd.a(this.buttons)),F=k.next();!F.done;F=
k.next()){F=F.value;var X=this.buttons[F];X.lda(this.OLe[F]);zg.a.Ha(X);delete this.buttons[F];this.llc&&X.oaj(this.llc);this.klc&&X.naj(this.klc)}};G.prototype.domElement=function(k){return this.ava(k).domElement};G.prototype.T1a=function(k){this.ava(k).T1a()};G.prototype.lOb=function(k,F,X){X=void 0===X?!0:X;this.hwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',wg.a.vg(this.tkd),wg.a.vg(this.skd),"{0}");k=String.format(this.hwa,wg.a.vg(k));
this.ava(F,X).kbg(k)};G.prototype.ATa=function(k,F,X){this.ava(X,!1).COj(k,F)};G.prototype.$bg=function(){var k=void 0===k?!1:k;this.hwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",wg.a.vg(this.skd),"{1}");var F=String.format(this.hwa,void 0,wg.a.vg(void 0));this.ava(void 0,k).kbg(F)};G.prototype.acg=function(k,F,X){this.ava(X,!1).BOj(this.svgIconProvider,k,F)};Ck.Object.defineProperties(G.prototype,{sz:{configurable:!0,enumerable:!0,
get:function(){return ah.a(this.$).RFa(ih.a.HNi)}},W1b:{configurable:!0,enumerable:!0,get:function(){return ih.a.GNi}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return ah.a(this.$).RFa(ih.a.INi)}}});Object(ie.a)(G,"OnObjectLaunchButton",ni.a,[793,3]);var df=kk.a;Wl(E,df);E.prototype.dispose=function(){zg.a.Ha(this.JBb);this.JBb=null;df.prototype.dispose.call(this)};E.prototype.qSa=function(){zg.a.Ha(this.JBb);this.JBb=mi.a.instance.create(Object(Df.a)(this,this.display,"display"),
this.F7h,$i.a.Qri)};E.prototype.Adb=function(){zg.a.Ha(this.JBb);this.hide()};Object(ie.a)(E,"LoadingIndicatorBehavior",kk.a,[800,3]);Wl(aa,E);aa.prototype.dispose=function(){this.IBb=null;E.prototype.dispose.call(this)};aa.prototype.display=function(){this.Omg(this.IBb)};aa.prototype.hide=function(){this.L4h(this.IBb)};aa.prototype.XAg=function(){this.IBb=document.createElement("div");this.domElement.appendChild(this.IBb)};Object(ie.a)(aa,"ShimmerLoadingIndicatorBehavior",E,[]);Wl(V,E);V.prototype.dispose=
function(){this.zNa=null;E.prototype.dispose.call(this)};V.prototype.display=function(){nf.DOMElementExtensions.setVisible(this.zNa,!0)};V.prototype.hide=function(){nf.DOMElementExtensions.setVisible(this.zNa,!1)};V.prototype.WAg=function(){this.zNa=document.createElement("div");this.zNa.classList.add(Ic.a.Woh);var k=document.createElement("div");k.classList.add(Ic.a.Xoh);this.x4c&&""!=this.x4c&&k.classList.add(this.x4c);var F=0===this.xkf?"":we.a.instance.ga(this.xkf),X=String.format('<div class="'+
Ic.a.Yoh+'">{0}</div>',F);this.jec?(F=String.format('<img src="{0}" alt="{1}" title="{1}"/>',this.jec,F),k.innerHTML=F+X):k.innerHTML=X;this.zNa.appendChild(k);this.domElement.appendChild(this.zNa)};Object(ie.a)(V,"SpinnerLoadingIndicatorBehavior",E,[]);ba.prototype.y3c=function(k,F,X){return new Tk.a(k,F,X)};ba.prototype.y4b=function(k,F,X,ra,ab,Qb,Fc,ld,ud,jd){return new uc(k,F,X,ra,ab,Qb,Fc,ld,ud,jd)};ba.prototype.qrb=function(k,F,X,ra,ab){return new V(k,F,X,ra,void 0===ab?0:ab)};ba.prototype.ffd=
function(k){return k.da.za(238)||new ha(k)};ba.prototype.C4b=function(k,F,X,ra,ab,Qb,Fc,ld){return new G(k,F,X,ra,ab,Qb,Fc,void 0===ld?"":ld)};ba.prototype.a3c=function(k,F){return new U(k,F)};ba.prototype.F5g=function(k,F,X,ra){return new Y(k,F,X,ra)};ba.prototype.H2c=function(k,F,X,ra){return new ta(k,F,X,ra)};Object(ie.a)(ba,"SharedUIControlsFactory",null,[754]);var uf=si.a;Wl(M,uf);M.prototype.create=function(){ve.EwaSettings.Gl()?this.Eb(this.$.da.za(12)||new ba):this.Eb(new ba)};M.ka=function(k){k.da.Ga(477,
new M(k))};Object(ie.a)(M,"SharedUIControlsFactoryServiceFactory",si.a,[]);var og=b(1085),dh=si.a;Wl(Q,dh);Q.prototype.create=function(){var k=this;Wd.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");og.a.then(this.c8g(),function(F){k.Eb(F);return!0})};Q.prototype.c8g=function(){var k=this;if(this.E4b)return this.E4b;var F=Va.a.FHa(bh.b(),Qh.a.none,"LoadResource","x10Scheduler loading");if(ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&
mj.a.kv){var X=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();this.$.da.Ga(413,X);F.setResult(X);return this.E4b=F.task}this.$.da.$a(266,function(){k.$.da.$a(283,function(ra){var ab=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();ra=xi.b(Xf.Task.Sa(ra.Fn));excelOnlineCalc.x10.ensureAllPluginsAttached(ra).then(function(Qb){k.$.da.Ga(413,ab);F.setResult(ab);ve.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&k.$.da.$a(491,function(Fc){Fc.Kda.anyPluginInitialized=
Qb})})})});return this.E4b=F.task};Q.ka=function(k){k.da.Ga(414,new Q(k))};Object(ie.a)(Q,"PluginSchedulerFactory",si.a,[]);var th=b(240),Ki=ni.a;Wl(P,Ki);P.prototype.dispose=function(){this.Tp.dispose();this.$=null;Ki.prototype.dispose.call(this)};P.prototype.domElement=function(k){return this.Tp.domElement(k)};P.prototype.getButton=function(k){return this.Tp.getButton(k,!1)};P.prototype.lOb=function(k,F){this.Tp.lOb(k,F,!1)};P.prototype.CAa=function(k,F){var X=ff.g(this.$),ra=X.rb.qj(k);this.Tp.lOb(F?
we.a.instance.ga(1713):we.a.instance.ga(1714),ra);F=this.isMac?F?we.a.instance.ga(1717):we.a.instance.ga(1718):F?we.a.instance.ga(1715):we.a.instance.ga(1716);var ab=X.tg(k,ra);k=X.Uf(ra).wn;if(ab&&0<=ab.x&&0<=ab.y){var Qb=ab.bottomRight.x+this.sz;ab=ab.topLeft.y-this.sz-this.buttonWidth;if(ab<k.topLeft.y+this.sz){if(X.rb.aTa){this.hide();return}ab=k.topLeft.y+this.sz}this.Fp(Qb,ab,X.rtl,ra);this.ariaLiveNotifier.GPa(F)}else this.hide()};P.prototype.Fp=function(k,F,X,ra){this.Tp.Fp(k,F,X,ra,!1)};
P.prototype.hide=function(){this.Tp.hide()};Ck.Object.defineProperties(P.prototype,{sz:{configurable:!0,enumerable:!0,get:function(){return this.Tp.sz}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return this.Tp.buttonWidth}}});Object(ie.a)(P,"PulloutLaunchButton",ni.a,[]);var xh=ni.a;Wl(N,xh);N.prototype.dispose=function(){this.gridView&&(this.gridView.ha.RW(this.Jg),this.gridView.view.Xq(this.qt),this.gridView.pc&&this.gridView.pc.kl(this.fj));if(this.$){var k=this.$;k.yl(this.vd);
k.tm(this.Zc);k.rD(this.ej);ff.g(k).Ww(this.CR)}this.gh&&this.gh.ysc(this.mya);zg.a.Ha(this.Zh);this.gh=this.$=this.gridView=this.fob=this.Zh=null;xh.prototype.dispose.call(this)};N.prototype.ay=function(){this.Zh.hide()};N.prototype.vda=function(){this.Zh?this.Zh.getButton(this.yea).vbb():Wd.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")};N.prototype.Eej=function(){this.u0=null};N.prototype.pIf=function(){this.Zh&&this.Zh.hide()};N.prototype.jZh=function(){if(!this.mhd||
1!==this.selectedRange.width)return null;for(var k=this.selectedRange.clone();this.gridView.r5(k);){k.left+=1;k.right+=1;if(!this.gridView.Uf(this.gridView.rb.qj(k)).Gh.Se(k))break;if(this.gridView.Ea.cs(k)){var F=this.gridView.xk("PulloutManager.GetValidatedRangeToFill",k,2);try{if(N.lTj(F))return k}finally{F&&F.dispose()}}}return null};N.prototype.ztc=function(){this.gh.xbb()};N.prototype.showCallout=function(){var k=this;this.pwa&&(this.gh.Qyb?(this.Zh.getButton(this.yea).VFb(),ve.EwaSettings.Gl()?
Ud.TaskExtensions.Ba(eh.GetServiceTaskFactory.Xa(this.$.da,8,9,0),function(F){k.a2f(F.result)},this.$.la,3):this.a2f(this.contextMenuManager)):(this.MYc=!0,this.BZ()))};N.prototype.a2f=function(k){k.Vcd("tableFieldList").K0(null,this.Zh.domElement(this.yea),this.gh,null,!0);this.ztc()};N.prototype.HSe=function(){if(!this.pwa||!this.gridView||this.gridView.ha.Oa.nc||!this.gridView.ha.ta.Hg)return null;var k=this.gridView.ha.ta.activeCell,F=ff.g(this.$).rb.qj(k);if(!k)return null;this.nFa=k.clone();
var X=this.tableManager.nn(k);this.wLc=!!X;if(this.bN){this.Zh.lOb(we.a.instance.ga(1713),F);this.UO=N.geg(X);if(!this.UO)return null;F=this.tableManager.VBe(X,this.gridView);k=F.GY;F=F.returnValue||k;this.BEc=k;if(F)return this.Puc=new hb.Range(X.top,X.left,X.bottom,X.right,!1,!1),this.INc=new hb.Range(this.UO.top,this.UO.right+1,this.UO.top,this.UO.right+1,!1,!1),this.UO}else if(this.mhd){this.Zh.lOb(we.a.instance.ga(1714),F);this.pXa=this.gridView.ha.ta.qd.clone();X=ff.g(this.$).Nb.axa(this.selectedRange);
(F=this.selectedRange.isSingle&&ff.g(this.$).Nb.Ebf(this.selectedRange))&&!this.TBb&&ve.EwaSettings.isChangeGateEnabled("OfficeVSO:6253558_DatePulloutExperimentTrigger")&&Z.a.equals(Rf.AFrameworkApplication.uiCulture,"en-us",!0)&&(Rf.AFrameworkApplication.z_("XLS-DateSuggestion-Treatment;XLS-DateSuggestion-Control"),this.TBb=!0);this.UO=N.geg(this.selectedRange);if(!(this.Lfc&&F||X)||!this.UO||!this.selectedRange)return null;this.Lfc&&(this.GKc=F&&!X);if(ve.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",
!1)&&this.tableManager.vva(this.selectedRange))return null;this.INc=this.jZh();if((ve.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.r5(this.selectedRange):this.gridView.r5(this.UO))&&this.Gla)return this.Puc=this.UO,X=String.format("PulloutManager:FindSelection, NextRange, {0}, RightColumnHeader, {1}, ActiveCell, {2}",this.Gla?this.Gla.toString():"null",this.UO?this.UO.toString():"null",k?k.toString():"null"),Wd.ULS.sendTraceTag(537154137,
0,50,X),this.UO}return null};N.prototype.BZ=function(){this.bN?this.gh.BZ(vd.v(this.Gla,this.$),!1,!0):this.Lfc&&this.GKc?this.gh.uXi():ve.EwaSettings.ma(136)&&this.gh.BZ(vd.v(this.selectedRange,this.$),!0,!1)};N.prototype.p6a=function(){return this.$.ea.isNamedObjectViewMode&&hi.f(this.$.qa)};N.lTj=function(k){for(;k.$$mn();)if(k.$$cu().text||k.$$cu().hF||k.$$cu().zi||k.Mn.f6e)return!1;return!0};N.geg=function(k){return k.right===ih.a.Rh?null:new hb.Range(k.top,k.right,k.top,k.right,!1,!1)};Ck.Object.defineProperties(N.prototype,
{wc:{configurable:!0,enumerable:!0,get:function(){return this.Zh.domElement(1)}},Gla:{configurable:!0,enumerable:!0,get:function(){return this.INc}},selectedRange:{configurable:!0,enumerable:!0,get:function(){return this.pXa}},bN:{configurable:!0,enumerable:!0,get:function(){return this.wLc}},bnd:{configurable:!0,enumerable:!0,get:function(){return this.GKc}},UIf:{configurable:!0,enumerable:!0,get:function(){return this.Fde}},pBb:{configurable:!0,enumerable:!0,get:function(){var k=this.Zh.domElement(this.yea);
return k?nf.DOMElementExtensions.isVisible(k):!1}},pwa:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&ve.EwaSettings.ma(136)?!(new ri.a(this.$.xa)).tj:!1}},pHg:{configurable:!0,enumerable:!0,get:function(){return this.BEc}},yea:{configurable:!0,enumerable:!0,get:function(){return this.Gla?this.gridView.rb.qj(this.UO):1}}});Object(ie.a)(N,"PulloutManager",ni.a,[732,3]);var ui=si.a;Wl(B,ui);B.prototype.create=function(){var k=this;sh.a.Fa(function(F){var X=eh.GetServiceTaskFactory.Xa(F.da,
12,477,k.vb),ra=eh.GetServiceTaskFactory.Xa(F.da,66,134,k.vb),ab=eh.GetServiceTaskFactory.Xa(F.da,211,212,k.vb),Qb=th.a.Sa(null),Fc=!ve.EwaSettings.Gl();Fc&&(Qb=eh.GetServiceTaskFactory.Xa(F.da,8,9,k.vb));Ud.TaskExtensions.Ba(Ud.TaskExtensions.te([X,ra,Qb,ab],F.la),function(){Fc?k.Eb(k.$.da.za(261)||new N(k.$,X.result,ra.result,Qb.result,ab.result)):k.Eb(k.$.da.za(261)||new N(k.$,X.result,ra.result,null,ab.result))},F.la)})};B.ka=function(k){k.da.Ga(262,new B(k))};Object(ie.a)(B,"PulloutManagerFactory",
si.a,[]);var Ai={average:0,max:0,median:0,P75:0,P95:0},Oj={selectByArrowKeyCounter:0,selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,commitByMouseClickCounter:0,commitWhileRequestPending:0},pj={formulaAssistanceRequestAttemptedCounter:0,formulaAssistanceRequestOptimizedCounter:0},tj={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDismissCounter:0,argumentAssistanceDragCounter:0,
argumentAssistanceDragTotalCounter:0,argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0},Yj={smartSuggestionShownCounter:0,smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0,smartSuggestionKeptCounter:0,isCellContentOnlyEqualDuringEditCounter:0,isCellContentFormulaCounter:0},lk={dialogCommitedCounter:0,dialogShownCounter:0},vk={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},Ai),excludingFirstAction:Object.assign({},
Ai)},Hj={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,smartFormulaBarAutoCompleteFlight:void 0,smartFormulaBarAutoCompletePluginFlight:void 0,anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0};A.prototype.rSa=function(){this.Qkc=Vh.a.Ua.oe.m};A.prototype.xia=function(k){-1!==this.Qkc&&(k?(this.Umb(Vh.a.Ua.oe.m-this.Qkc),this.Qkc=-1):this.X_.failedCount++)};A.prototype.kzh=function(){this.X_.excludingFirstAction=A.jSe(this.l7b);this.l7b.push(this.X_.firstAction);
this.X_.includingFirstAction=A.jSe(this.l7b)};A.prototype.Umb=function(k){var F=this;this.X_.count?1E3>this.X_.count&&this.l7b.push(k):this.X_.firstAction=k;this.qpf&&this.tpf&&this.tpf.forEach(function(X){k>X&&F.X_.countAboveThresholds[X]++});this.X_.count++};A.jSe=function(k){var F=Object.assign({},Ai);0<k.length&&(qi.i(k),F.median=k[Math.floor(.5*k.length)],F.P75=k[Math.floor(.75*k.length)],F.P95=k[Math.floor(.95*k.length)],F.max=k[k.length-1],F.average=qi.g(k,function(X){return X})/k.length);
return F};Object(ie.a)(A,"PerformanceMeasurement",null,[]);var ul=b(41),$k=b(99),al;(function(k){k[k.function=3]="function";k[k.namedRange=100]="namedRange";k[k.tableHeader=101]="tableHeader";k[k.letVariable=102]="letVariable";k[k.richEntity=103]="richEntity";k[k.lambda=104]="lambda";k[k.customFunction=105]="customFunction";k[k.table=106]="table";k[k.tableSpecialStructRef=107]="tableSpecialStructRef";k[k.richEntityEmptyCellRef=108]="richEntityEmptyCellRef"})(al||(al={}));Object(ie.b)("CompletionItemKind",
al);var nl={},sl=(nl.argumentAssistanceOverall=[50,80,100,130,150,170,200],nl.autoCompleteOverall=[50,80,100,130,150,170,200],nl);D.prototype.dispose=function(){this.$&&this.E9&&ff.g(this.$).Nj.Um(this.Tf)};D.prototype.sX=function(k){var F=this;k.forEach(function(X){F.x$a.yb(X)||F.x$a.ia(X,new A(sl[X]));F.x$a.oa(X).rSa()})};D.prototype.uQ=function(k,F){var X=this;F=void 0===F?!0:F;k.forEach(function(ra){X.x$a.yb(ra)&&X.x$a.oa(ra).xia(F)})};D.prototype.mXf=function(k){var F="Undefined";switch(k){case 1:F=
"Collapsed";break;case 0:F="Expanded";break;case 2:F="Hidden"}this.b$.argumentAssistanceCardInitialMode=F};D.prototype.G7b=function(k){var F=this;window.requestAnimationFrame(function(){F.uQ([k])})};D.prototype.W8e=function(k){var F=this;k.forEach(function(X){X=al[X.kind];F.teg(X);F.uob[X].shownCounter++})};D.prototype.V8e=function(k){k=al[k];this.teg(k);this.uob[k].committedCounter++};D.prototype.getJsonForLogging=function(){return"{"+this.xU("SessionDetails",this.Kda)+","+this.xU("ArgumentAssistanceUsage",
this.b$)+","+this.xU("FormulaSuggestionsUsage",this.mV)+","+this.xU("FunctionDialogUsage",this.Bbd)+","+this.xU("AutocompleteCardInteraction",this.FY)+","+this.xU("AutocompleteRenderOptimization",this.tob)+","+this.xU("AutocompleteUsageByKind",this.uob)+","+this.PVh()+"}"};D.prototype.orj=function(){this.mV.smartSuggestionKeptCounter=this.mV.smartSuggestionCommittedCounter-this.pjc};D.prototype.erj=function(){this.Kda.argumentAssistanceFlight=this.A3a("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");
this.Kda.autoCompleteUIFlight=this.A3a("Microsoft.Office.Excel.","AutoCompleteNewUI");this.Kda.smartFormulaBarAutoCompleteFlight=this.A3a("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled");this.Kda.smartFormulaBarAutoCompletePluginFlight=this.A3a("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled");this.Kda.formulaAssistanceRedesignFlight=this.A3a("Microsoft.Office.Excel.","FormulaAssistanceRedesign");this.Kda.NewInsertFunctionDialogFlight=this.A3a("Microsoft.Office.Excel.",
"NewInsertFunctionDialog")};D.prototype.PVh=function(){for(var k=new Ka.a,F=Gl(this.x$a),X=F.next();!X.done;X=F.next())X=X.value,X.value.kzh(),k.add(String.format('"{0}":{1}',X.key,jg.a.Jc(X.value.X_)));return String.format('"PerfMeasurements": {{{0}}}',k.toArray().join(","))};D.prototype.A3a=function(k,F){return Z.a.contains(this.$.ya.FlightHolder.FlightId,F,!0)?ve.EwaSettings.getBooleanFeatureGate(k+F,!1)?"T":"C":"None"};D.prototype.xU=function(k,F){return String.format('"{0}":{1}',k.toString(),
ul.c(F))};D.prototype.teg=function(k){this.uob[k]||(this.uob[k]={shownCounter:0,committedCounter:0})};Object(ie.a)(D,"FormulaAssistanceTelemetryManager",null,[734]);var Cl=si.a;Wl(z,Cl);z.ka=function(k){k.da.Ga(492,new z(k))};z.prototype.create=function(){var k;this.Eb(null!==(k=this.$.da.za(491))&&void 0!==k?k:this.$.da.Ga(491,new D(this.$)))};Object(ie.a)(z,"FormulaAssistanceTelemetryManagerFactory",si.a,[]);t.prototype.$c=function(){return!1};t.prototype.executeCommand=function(k,F){k=!1;F=F.command;
switch(F){case 1910465940:k=!0}return k?Xf.Task.Sa(!0):Rg.a(F)};t.prototype.Mc=function(k,F){switch(F.command){case 1910465940:return!0;default:return!1}};t.prototype.jd=function(){return!1};Object(ie.a)(t,"NameManagerCommandHandler",null,[428]);var Dl=bf.a;Wl(v,Dl);v.prototype.Od=function(){this.Cd([new t(this.$)])};v.ka=function(k){bf.a.ee(493,new v(k))};Object(ie.a)(v,"NameManagerCommandHandlerFactory",bf.a,[]);w.prototype.clearCache=function(){this.cache=void 0};Object(ie.a)(w,"Cacheable",null,
[]);Wl(u,w);u.prototype.dispose=function(){this.al()};u.prototype.Ej=function(){this.editBox.UUc(this.Xmc);this.formulaBar.UUc(this.Xmc);this.editBox.rme(this.Wmc);this.formulaBar.rme(this.Wmc)};u.prototype.al=function(){this.editBox.CId(this.Xmc);this.formulaBar.CId(this.Xmc);this.editBox.aPf(this.Wmc);this.formulaBar.aPf(this.Wmc)};u.prototype.Wzd=function(k,F){var X=new Sys.UI.Point(F.clientX,F.clientY);F=k.textBox.ef;var ra=void 0,ab=X.x,Qb=X.y;ra=void 0===ra?document:ra;X=-1;var Fc=null;void 0!==
ra.caretPositionFromPoint?(ra=ra.caretPositionFromPoint(ab,Qb),null!==ra&&(X=ra.offset,Fc=ra.offsetNode)):void 0!==ra.caretRangeFromPoint&&(ra=ra.caretRangeFromPoint(ab,Qb),null!==ra&&(X=ra.startOffset,Fc=ra.startContainer));null===Fc||-1===X?(Wd.ULS.sendTraceTag(521446491,0,15,"getEditorCaretPositionFromPoint - failed to get relevant range"),F=-1):F.contains(Fc)?F=Yc(F,Fc,X):(Wd.ULS.sendTraceTag(521446490,0,15,"getEditorCaretPositionFromPoint - relavant node not inside root"),F=-1);if(-1!==F)this.onSelectionChange(k,
{index:F,length:0})};u.prototype.oLi=function(k){this.xBf(k)};u.prototype.onSelectionChange=function(k,F){this.Zuj(F)&&(this.cache=F,this.callbacks.show(k,F))};u.prototype.xBf=function(k){this.clearCache();this.callbacks.hide(k)};u.prototype.Zuj=function(k){var F;(F=!this.cache)||(F=this.cache,F=!(F.index===k.index&&F.length===k.length));return F};Object(ie.a)(u,"FormulaAssistanceValuePreviewHandler",w,[3]);x.prototype.dispose=function(){var k;null===(k=this.handler)||void 0===k?void 0:k.dispose()};
x.prototype.clearCache=function(){this.cache.forEach(function(k){return k.clearCache()})};Object(ie.a)(x,"FormulaAssistanceValuePreview",null,[730,731,3]);var zl=si.a;Wl(h,zl);h.ka=function(k){k.da.Ga(497,new h(k))};h.prototype.create=function(){var k;this.Eb(null!==(k=this.$.da.za(496))&&void 0!==k?k:this.$.da.Ga(496,new x(this.$)))};Object(ie.a)(h,"FormulaAssistanceValuePreviewFactory",si.a,[]);var Al=b(407);Object(ie.a)(m,"GestureAdapterInfo",null,[]);var El=b(390),Bl=b(233);n.prototype.gri=function(){if(!this.rHc){var k=
"hammer.min.js";Rf.AFrameworkApplication.fa.ro("IsServerFlavorDebug")&&(k=Rf.AFrameworkApplication.fa.ra("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");k=Rf.AFrameworkApplication.jO(String.format("{0}",k),5);k=Bl.a.create(k,null,null);El.a.yia(k);this.rHc=k.Q7a}return this.rHc};Ck.Object.defineProperties(n,{instance:{configurable:!0,enumerable:!0,get:function(){n.Ma||(n.Ma=new n);return n.Ma}}});n.Ma=null;Object(ie.a)(n,"HammerJsDependencyLoader",null,[542]);var Vk;(function(k){k[k.none=-1]=
"none";k[k.pinch=0]="pinch";k[k.pan=1]="pan";k[k.swipe=2]="swipe"})(Vk||(Vk={}));Object(ie.b)("GestureEvent",Vk);var xl=b(73),yl=xl.a;Wl(l,yl);l.create=function(k,F,X,ra,ab,Qb){if(X.rawEvent)if(Qb){var Fc=X.rawEvent;Fc=new Sys.UI.Point(Fc.clientX,Fc.clientY)}else Fc=xl.a.Nub(X);else Fc=new Sys.UI.Point(X.clientX,X.clientY);return new l(k,Fc,F,X,ra,ab,X.shiftKey,X.ctrlKey,Qb)};Ck.Object.defineProperties(l.prototype,{shiftKey:{configurable:!0,enumerable:!0,get:function(){return this.lga}},ctrlKey:{configurable:!0,
enumerable:!0,get:function(){return this.QX}},clientPoint:{configurable:!0,enumerable:!0,get:function(){return this.Vgb}},Uua:{configurable:!0,enumerable:!0,get:function(){return this.kog}}});Object(ie.a)(l,"GestureEventArgs",xl.a,[]);Object(ie.a)(f,"GestureManagerData",null,[]);e.Big=2;e.Cig=4;e.Dig=8;e.Eig=8;Object(ie.a)(e,"HammerConstants",null,[]);var vl=b(210),wl=rb.a;Wl(c,wl);c.prototype.rOh=function(){return this.KOc?0:this.Mhe?1:2};c.prototype.pn=function(k){wl.prototype.pn.call(this,k);this.Xd.fka(this.LVa,
k,0,this.jkb)};c.prototype.im=function(k){wl.prototype.im.call(this,k);this.Xd.cIa(k,this.LVa)};c.prototype.D6i=function(k,F,X){var ra=this;X=void 0===X?null:X;var ab=void 0===ab?null:ab;Rf.AFrameworkApplication.Mgc()?n.instance.gri().continueWith(function(Qb){ra.$Cj();if(Qb.kg||Qb.Ph)Wd.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",Qb.status);else{Wd.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",Qb.status);if(ra.G2d){Qb=window.Hammer;if("undefined"===
typeof Qb){Wd.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");ra.Hyc();return}if("undefined"===typeof Qb.inputHandler){Wd.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");ra.Hyc();return}}if(!k)throw ra.Hyc(),Error.argumentNull("source element can not be null");Qb=vl.a.qva(k,ra.nqa);if(void 0===Qb||null===Qb)Qb=new $k.a,vl.a.ycb(k,ra.nqa,Qb),ra.E6i(k);var Fc=null;if(!Qb.yb(Vk[0])){Fc=Object;var ld=Fc.assign,ud=new m,jd=Vk[0],Ye=ab;Ye=void 0===Ye?null:Ye;if(void 0===
ra||null===ra)throw Wd.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");var Bf=null;switch(jd){case Gg.a.pinch:Bf=new Hammer.Pinch(Ye);break;case Gg.a.pan:Bf=new Hammer.Pan(Ye)}Bf&&(Bf.manager=ra);Fc=ld.call(Fc,ud,{ada:Bf,yVe:F});Qb.add(Vk[0],Fc)}if(void 0!==X&&null!==X)for(ld=0;ld<X.length;ld++)Qb.yb(Vk[X[ld]])&&(ud=Qb.oa(Vk[X[ld]]),Fc.ada.recognizeWith(ud.ada))}ra.Hyc()}):Wd.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")};
c.prototype.$Cj=function(){this.eJc&&(this.Dh?this.sRc=this.Dh.Gc("Task","RegisterGestureAdapterAfterLoad"):Wd.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))};c.prototype.Hyc=function(){this.eJc&&(this.sRc?this.sRc.stop():Wd.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))};c.prototype.E6i=function(k){this.mog.add(k);this.Xd.fka(this.LVa,k,0,this.jkb)};c.prototype.recognize=function(k){for(var F=Array(k.pointers.length),X=0;X<k.pointers.length;X++)F[X]=
k.pointers[X].target;X=null;for(this.Kpa=this.DQh(F);void 0!==this.Kpa&&null!==this.Kpa&&(X=vl.a.qva(this.Kpa,this.nqa),void 0===X||null===X);this.Kpa=this.Kpa.parentNode);if(void 0!==X&&null!==X){this.curRecognizer&&this.curRecognizer.state===e.Eig&&(this.curRecognizer=null);F=Gl(X.keys);for(var ra=F.next();!ra.done;ra=F.next()){ra=X.oa(ra.value);void 0!==ra&&null!==ra&&void 0!==ra.ada&&null!==ra.ada&&(void 0===this.curRecognizer||null===this.curRecognizer||ra.ada===this.curRecognizer||ra.ada.canRecognizeWith(this.curRecognizer))&&
ra.ada.recognize(k);var ab=ra.ada.state;this.curRecognizer||e.Big!==ab&&e.Cig!==ab&&e.Dig!==ab||(this.curRecognizer=ra.ada)}}};c.prototype.emit=function(k,F){if("hammer.input"!==k){this.S8=!1;F=l.create(k,this.Kpa,F.srcEvent,F,3,this.KOc);var X=vl.a.qva(this.Kpa,this.nqa);if(this.kji(k))var ra=0;else if(this.aji(k))ra=1;else if(this.Uli(k))ra=2;else{Wd.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}X=X.Nc(Vk[ra]).value;void 0!==X&&null!==X&&((X=X.yVe,X.Xgi())?
k.endsWith("start")?this.S8=X.kJi(F):k.endsWith("end")?(X.iJi(F),this.S8=!0):k.endsWith("cancel")?(X.hJi(F),this.S8=!0):k.endsWith("move")&&(this.S8=X.jJi(F)):Wd.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",k))}};c.prototype.get=function(k){return Object(ca.a)(Hammer.Recognizer,k)};c.prototype.DQh=function(k){if(1>k.length)return null;if(1===k.length)return k[0];for(var F=k[0],X=!0,ra=1;ra<k.length;ra++){if(!k[ra])return null;if(F!==k[ra]){X=!1;break}}if(X)return F;
F=this.TVe(k[0]);X=0;k=Gl(k);for(ra=k.next();!ra.done;ra=k.next()){ra=this.TVe(ra.value);if(F.oa(F.count-1)!==ra.oa(ra.count-1))return null;for(var ab=F.count-2,Qb=ra.count-2;ab>=X&&0<=Qb;ab--,Qb--)if(F.oa(ab)!==ra.oa(Qb)){X=ab+1;break}}return F.oa(X)};c.prototype.TVe=function(k){for(var F=new Ka.a;void 0!==k&&null!==k;k=k.parentNode)F.add(k);return F};c.prototype.vZe=function(k){switch(k){case Gg.a.Kf:case Gg.a.sha:return 1;case Gg.a.Bg:case Gg.a.tha:return 2;case Gg.a.De:case Gg.a.vGa:return 4;
case Gg.a.nAc:case Gg.a.pYc:return 8}return 0};c.prototype.Dya=function(k,F,X){k=this.vZe(k);F=this.pPh(X);Hammer.inputHandler(this,k,F);this.S8&&X.preventDefault();return this.S8};c.prototype.F5e=function(){return 1<this.rT.count};c.prototype.z1b=function(){Wd.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.cmb)for(var k=Gl(this.rT),F=k.next();!F.done;F=k.next())this.rOf(F.value.key);else this.rT=new $k.a;this.session=null};c.prototype.nBg=function(k,F,X){Wd.ULS.sendTraceTag(594055959,
310,50,"AddOrReplacePointerInCaches: pointerId: {0}",k);if(!this.Dkb.yb(k)){try{F.setPointerCapture(k)}catch(ra){Wd.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",ra)}this.Dkb.add(k,F)}this.rT.ia(k,X);this.OUa&&1<this.rT.count&&this.kfa&&!this.kfa.vpb&&(this.kfa.vpb=!0)};c.prototype.rOf=function(k){Wd.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",k);if(this.Dkb.yb(k)){try{this.Dkb.oa(k).releasePointerCapture(k)}catch(F){Wd.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",
F)}this.Dkb.remove(k)}else Wd.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",k);this.rT.remove(k);this.OUa&&1>=this.rT.count&&this.kfa&&this.kfa.vpb&&(this.kfa.vpb=!1)};c.prototype.Wnc=function(k,F,X){var ra=X.rawEvent.pointerType.toString(),ab=X.rawEvent.pointerId.toString();if("touch"!==ra)return!1;k=this.vZe(k);if(1!==k&&!this.rT.yb(ab))return!1;this.M2d&&1===k&&X.rawEvent.isPrimary&&this.rT.count&&(Wd.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),
this.z1b());this.cmb?this.nBg(ab,F,X):this.rT.ia(ab,X);this.HMc&&2===k&&(!this.aGc||this.aGc&&"function"===typeof X.rawEvent.getCoalescedEvents)&&(F=X.rawEvent.getCoalescedEvents())&&this.F5e()&&(this.Ljb=Math.max(this.Ljb,F.length));this.oee&&(this.S8=!1);ra=this.oPh(this.rT,X,ra);Hammer.inputHandler(this,k,ra);if(4===k||8===k)this.cmb?this.rOf(ab):this.rT.remove(ab),this.rT.count||(this.session=null,this.HMc&&-1!==this.Ljb&&(Wd.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",
this.Ljb),this.Ljb=-1));this.S8&&X.preventDefault();return this.S8};c.prototype.Gnc=function(){return!1};c.prototype.pPh=function(k){var F=new f,X=k.rawEvent,ra=X.touches;X=X.changedTouches;F.pointers=Array.clone(ra);F.pointers=Array.clone(0<ra.length?ra:X);F.changedPointers=Array.clone(X);F.srcEvent=k;F.pointerType="touch";return F};c.prototype.oPh=function(k,F,X){var ra=new f;ra.pointers=Ba.toArray(k.values);ra.changedPointers=[F];ra.pointerType=X;ra.srcEvent=F;return ra};c.prototype.kji=function(k){return wg.a.startsWith(k,
Gg.a.pinch)};c.prototype.aji=function(k){return wg.a.startsWith(k,Gg.a.pan)};c.prototype.Uli=function(k){return wg.a.startsWith(k,Gg.a.swipe)};Object(ie.a)(c,"GestureInputManager",rb.a,[492,493]);a.prototype.fi=function(k){k.register(c,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").Hc().Oc(function(){return new c(gl.a.instance,Rf.AFrameworkApplication.sa.yD)});this.tb=k};a.prototype.init=function(){this.mx||(this.tb.resolve("Common.App.GestureManager.GestureInputManager"),
this.mx=!0)};a.prototype.dispose=function(){};a.main=function(){wi.a.instance.gj(new a)};Ck.Object.defineProperties(a.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.GestureInputManager"}}});Object(ie.a)(a,"GestureInputManagerPackage",null,[4,5]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");Type.registerNamespace("_Ewa");hf.a.Ji('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;-ms-touch-action:manipulation;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}');
sh.a.Fa(me.ka);sh.a.Fa(Rc.ka);Type.registerNamespace("Common.App.MultitabControl");Type.registerNamespace("CAUI");Na.main();hf.a.Ji(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}");
(function(){Dg.initData();sh.a.Fa(function(k){nh.ka(k);pf.ka(k);Dg.ka(k);Ef.ka(k)})})();hf.a.Ji(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}");
hf.a.Ji(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}");
sh.a.Fa(re.ka);sh.a.Fa(Qf.ka);sh.a.Fa(Cf.ka);hf.a.Ji(".ewa-facp-text-box{position:absolute}");(function(){sh.a.Fa(function(k){lf.ka(k)})})();(function(){sh.a.Fa(function(k){Ec.ka(k)})})();sh.a.Fa(zd.ka);sh.a.Fa(pe.ka);sh.a.Fa(bd.ka);hf.a.Ji('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
sh.a.Fa(xb.ka);sh.a.Fa(Qc.ka);(function(){sh.a.Fa(function(k){k.da.Ga(150,new Jb(k))})})();(function(){sh.a.Fa(function(k){Xa.ka(k);Ua.ka(k);oa.ka(k)})})();sh.a.Fa(M.ka);(function(){sh.a.Fa(function(k){Q.ka(k)})})();(function(){sh.a.Fa(function(k){k.ma(136)&&B.ka(k)})})();(function(){sh.a.Fa(function(k){v.ka(k)})})();Type.registerNamespace("Common.App.GestureManager");a.main();(function(){sh.a.Fa(function(k){z.ka(k)})})();(function(){sh.a.Fa(function(k){h.ka(k)})})()},925:function(y,C,b){function a(ha,
ta,xa,oa,qa,Ea,ka,za,La,Ia,Ya,tb){var Tb=U.call(this)||this;Tb.Skc=!1;Tb.contextMenuController=null;Tb.KIc=null;Tb.WFc=null;Tb.Snd=!1;Tb.mZj=0;Tb.lZj=0;Tb.hsb=null;Tb.auc=null;Tb.AC=function(){Tb.contextMenuController?Tb.contextMenuController.AC():e.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");Tb.zag()};Tb.xb=ha;Tb.apf=qa;Tb.LPc=Ia;Tb.tYj=xa;Tb.sYj=oa;Tb.WXj=ta;Tb.jGf=Ea;Tb.populateOnlyOnce=ka;
Tb.F3h=Ya;Tb.WMf(tb);return Tb}b.d(C,"a",function(){return a});y=b(0);var c=b(7),e=b(15),f=b(622),l=b(91),n=b(24),m=b(620),h=b(391),x=b(650),u=b(629),w=b(113),v=b(277),t=b(84),z=b(437),D=b(1433);C=b(77);var A=b(19),B=b(5),N=b(1048),P=b(79),Q=b(45),M=b(59),ba=b(151),V=b(114),aa=b(1),E=b(10),G=b(21),I=b(14),R=b(22),Y=b(33),U=C.a;Wl(a,U);a.prototype.$c=function(ha,ta){ha=!0;switch(ta){case 1651433993:case 1675506831:case 966232027:ha=this.me(4096)||this.me(2048);break;case 2045563128:ha=this.me(4096);
break;case 912277356:case 2123758504:case -1793121409:case 1378457149:ha=this.me(8192)}return!ha};a.prototype.jd=function(ha,ta,xa){xa.IsShadowMenuOpen||N.h(this.$,N.d);ha=!1;ta===this.Qw&&(xa.IsShadowMenuOpen||N.h(this.$,N.a),ta=Object(c.a)(new f.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.nDd(ta,xa.IsShadowMenuOpen),xa.MenuItems=ta,xa.IsShadowMenuOpen||N.h(this.$,N.c),ha=!0);ha&&this.Skc&&E.HelperMethods.N0b&&!xa.IsShadowMenuOpen&&N.j(this.$);return ha};a.prototype.nDd=
function(ha,ta){(ta=this.$Y(ta))?(this.d8e(ta),Array.addRange(ha.MenuSectionList,ta.jE().MenuSectionList),this.GBg(ha)):e.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")};a.prototype.$Y=function(){e.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null};a.prototype.K0=function(ha,ta,xa,oa,qa){ha=Sys.UI.DomElement.getBounds(ta);
xa=new Sys.UI.Point(ha.x,ha.y+ha.height);this.vTa(xa,ta);this.$.isChromeRtl&&(xa.x+=ha.width);this.Fp(xa,qa)};a.prototype.Fp=function(ha,ta,xa){xa=void 0===xa?0:xa;ta&&(ha=Y.a(this.$).Aja(ha));ta=!0;if(this.F3h){var oa;3===xa?(oa=this.WJa(3))&&0<oa.length?(ta=!1,this.showFloatie(oa,new Sys.UI.Bounds(ha.x,ha.y,0,0),xa)):e.ULS.sendTraceTag(537167075,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: {0}",
this.menuId):2===xa&&this.$.isEditMode&&((oa=this.WJa(2))&&0<oa.length?oa[0]!==a.qTe?(ta=!1,this.hRd(oa,new Sys.UI.Bounds(ha.x,ha.y,0,0),xa)):e.ULS.sendTraceTag(537167074,0,50,"ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: {0}",this.menuId):e.ULS.sendTraceTag(537167073,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: {0}",this.menuId))}ta&&this.showContextMenu(new Sys.UI.Bounds(ha.x,
ha.y,0,0),xa)};a.prototype.WJa=function(){return null};a.prototype.wfd=function(ha,ta){var xa="";3===ha?xa="touch":2===ha&&(xa="mouse");ha={};return ha.ContextMenuId=this.menuId,ha.IsEditMode=this.$.isEditMode,ha.IsSLR=!!M.a.Fg&&M.a.Fg.hK,ha.IsReactMLR=!!M.a.Fg&&M.a.Fg.WV,ha.IsNov=this.$.ea.isNamedObjectViewMode,ha.InputType=xa,ha.FloatieGroups=JSON.stringify(void 0===ta?null:ta),ha};a.prototype.showContextMenu=function(ha,ta){ta=void 0===ta?0:ta;var xa=this.wfd(ta);e.ULS.sendTraceTag(595359709,0,
50,"ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: {0}",JSON.stringify(xa));this.contextMenuController?this.AB!==B.a.aGd&&this.AB!==B.a.bGd||0===ta?this.contextMenuController.gRd(this.AB,ha,P.a.Sb):this.contextMenuController.gRd(this.AB,ha,ta):e.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")};a.prototype.showFloatie=function(ha,ta,xa){var oa=this.wfd(xa,ha);e.ULS.sendTraceTag(595359710,
0,50,"ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: {0}",JSON.stringify(oa));this.contextMenuController?(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.bNf(),this.contextMenuController.yxc(ha,ta,xa)):e.ULS.sendTraceTag(537167071,0,10,"ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups {0}.",JSON.stringify(ha))};a.prototype.hRd=function(ha,ta,xa){var oa=
this.wfd(xa,ha);e.ULS.sendTraceTag(537167070,0,50,"ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: {0}",JSON.stringify(oa));this.contextMenuController?(aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.bNf(),this.contextMenuController.fRd(ha,ta,xa,this.AB)):e.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")};
a.prototype.WMf=function(ha){this.contextMenuController=ha};a.prototype.dispose=function(){this.$&&this.$.Ka.Qab(this);this.xb=null;aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.zag();this.auc&&(l.a.Ha(this.auc),this.auc=null);U.prototype.dispose.call(this)};a.prototype.vEh=function(ha){var ta=this.$.da.za(204);ta&&(ta=ta.aFh(this.apf))&&ha.Ec.push(ta)};a.prototype.vTa=function(ha,ta){ha&&ta&&this.$.ea.xc.isDivSyndicated&&n.a.Of&&(ta=ta.ownerDocument.documentElement,
ha.x-=ta.scrollLeft,ha.y-=ta.scrollTop)};a.prototype.me=function(ha){return(new ba.a(this.$.xa)).me(ha)};a.prototype.d8e=function(ha){ha=Gl(ha.Ec);for(var ta=ha.next();!ta.done;ta=ha.next())if(ta=ta.value,Object(z.a)(689,ta)){ta.title&&(ta.title=a.gg(ta.title));ta=Gl(ta.buttons);for(var xa=ta.next();!xa.done;xa=ta.next())xa=xa.value,Object(z.a)(581,xa)?(xa.label=a.gg(xa.label),xa.oS(a.gg(xa.alt))):Object(z.a)(692,xa)&&this.d8e(xa.menu)}};a.prototype.Yof=function(ha,ta){ta=void 0===ta?!1:ta;var xa=
[];ha=Gl(ha);for(var oa=ha.next();!oa.done;oa=ha.next())xa.push(this.CU(oa.value,ta));return xa};a.prototype.CU=function(ha){for(var ta=[],xa=Gl(ha.MenuItems),oa=xa.next();!oa.done;oa=xa.next())switch(oa=oa.value,oa.Type){case 3:ta.push(this.p4g(oa));break;case 2:ta.push(this.Z9g(oa));break;case 1:ta.push(this.P5g(oa))}return Object(c.a)(new m.a,{ControlList:ta,Title:ha.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})};a.prototype.Sbd=
function(ha,ta){ta=[this.hsb,ha.RibbonCommand.toString(),ta?this.$Ye(ta):this.$Ye(ha.Label),ha.Disabled?ha.Disabled.toString():"False"];var xa=ha.CommandData;xa=G.a.hashCode(xa).toString();ta.push(xa,ha.Identifier.toString());ta=ta.join("_");ha.IsChecked&&(ta+="_Checked");return ta};a.prototype.bFh=function(ha){var ta=[this.hsb,G.a.hashCode(ha.Title).toString()];ha=Gl(ha.MenuItems);for(var xa=ha.next();!xa.done;xa=ha.next())ta.push(xa.value.RibbonCommand.toString());return ta.join("_")};a.prototype.dVe=
function(ha){var ta=ha.Label;ta=G.a.hashCode(ta).toString();ta=[this.hsb,ta];aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&ha.Id&&ta.push(G.a.hashCode(ha.Id).toString());ta=ta.join("_");ha.IsChecked&&(ta+="_Checked");return ta};a.prototype.p4g=function(ha){var ta=this.E$b(ha,!1);var xa=ta.label;var oa=ta.jLa;ta=ta.Br;var qa=this.Sbd(ha,xa);return Object(c.a)(new h.a,{Command:ha.Disabled?(-251203935).toString():ta.toString(),ExternalId:qa,Id:qa,
Image16by16Class:oa,LabelText:xa||ha.Label,MenuItemId:ha.CommandData,CommandValueId:ha.CommandData})};a.prototype.Z9g=function(ha){var ta=this.E$b(ha,ha.IsChecked);var xa=ta.label;var oa=ta.jLa;ta=ta.Br;var qa=this.Sbd(ha,xa);return Object(c.a)(new x.a,{Command:ha.Disabled?(-251203935).toString():ta.toString(),ExternalId:qa,Id:qa,Image16by16Class:oa,LabelText:xa||ha.Label,MenuItemId:ha.CommandData,CommandValueId:ha.CommandData,IsChecked:ha.IsChecked})};a.prototype.P5g=function(ha){var ta=this.nVe(ha);
var xa=ta.label;ta=ta.jLa;var oa=Object(c.a)(new f.a,{MenuSectionList:[],UpdateDynamically:!0});Array.addRange(oa.MenuSectionList,this.Yof(ha.SubMenu.Sections,!0));var qa=this.dVe(ha);ha=xa||ha.Label;return Object(c.a)(new u.a,{ExternalId:qa,Id:qa,LabelText:ha,PopulateOnlyOnce:!1,Menu:oa,Image16by16Class:ta,ImageIsVisible:!!ta})};a.prototype.nVe=function(ha){ha=this.E$b(ha,!0);return{label:ha.label,jLa:ha.jLa,Br:ha.Br}};a.prototype.E$b=function(ha,ta){switch(ha.Identifier){case 26:var xa=912804500;
ta=A.a.vPe;ha=I.a.instance.ga(1921);break;case 3:xa=-1902148570;ta=ta?A.a.jaa:null;ha=I.a.instance.ga(1881);break;case 4:xa=-1902148570;ta=ta?A.a.jaa:null;ha=I.a.instance.ga(1882);break;case 5:xa=-1902148570;ta=ta?A.a.jaa:null;ha=null;break;case 1:xa=-1677817820;ta=A.a.v8b;ha=I.a.instance.ga(234);break;case 2:xa=-1649376918;ta=ha.IsChecked?A.a.vua:null;ha=I.a.instance.ga(2087);break;case 23:xa=1701016594;ta=ha.IsChecked?A.a.vua:null;ha=I.a.instance.ga(2087);break;case 6:xa=-87741481;ta=null;ha=I.a.instance.ga(2088);
break;case 7:xa=1948650742;ta=A.a.jOe;ha=I.a.instance.ga(1919);break;case 8:xa=1933713114;ta=A.a.iOe;ha=I.a.instance.ga(1920);break;case 14:xa=504133448;ta=A.a.NIa;ha=I.a.instance.ga(144);break;case 30:xa=504133448;ta=A.a.NIa;ha=I.a.instance.ga(148);break;case 32:xa=504133448;ta=A.a.NIa;ha=I.a.instance.ga(150);break;case 34:xa=504133448;ta=A.a.NIa;ha=I.a.instance.ga(152);break;case 27:xa=1701016594;ta=ta?A.a.x8b:A.a.NIa;ha=I.a.instance.ga(144);break;case 15:xa=-798968736;ta=A.a.OIa;ha=I.a.instance.ga(146);
break;case 31:xa=-798968736;ta=A.a.OIa;ha=I.a.instance.ga(149);break;case 33:xa=-798968736;ta=A.a.OIa;ha=I.a.instance.ga(151);break;case 35:xa=-798968736;ta=A.a.OIa;ha=I.a.instance.ga(153);break;case 28:xa=1701016594;ta=ta?A.a.y8b:A.a.OIa;ha=I.a.instance.ga(146);break;case 21:xa=-2058042992;ta=A.a.i2a;ha=null;break;case 29:xa=1701016594;ta=A.a.i2a;ha=null;break;case 9:xa=1701016594;ha=ta=null;break;case 11:xa=-1494291901;ha=ta=null;break;case 25:xa=-1045020714;ta=ha.IsChecked?A.a.vua:null;ha=null;
break;case 13:xa=1701016594;ta=ha.IsChecked?A.a.vua:null;ha=I.a.instance.ga(155);break;case 16:xa=1701016594;ta=A.a.o8b;ha=I.a.instance.ga(1057);break;case 17:xa=1701016594;ta=A.a.h2a;ha=null;break;case 18:xa=1701016594;ta=A.a.g2a;ha=null;break;case 19:xa=1701016594;ta=A.a.p8b;ha=I.a.instance.ga(1062);break;case 20:xa=1701016594;ta=A.a.S8c;ha=I.a.instance.ga(1063);break;case 24:xa=1675506831;ha=ta=null;break;case 22:xa=ha.RibbonCommand;ta=ha.IsChecked?A.a.jaa:null;ha=null;break;case 36:xa=1461300262;
ta=null;ha=I.a.instance.ga(154);break;case 38:xa=ha.RibbonCommand;ta=A.a.z8b;ha=I.a.instance.ga(1792);break;default:e.ULS.shipAssertTag(537167069,0,!1,"Unable to map menu item: {0}",JSON.stringify(ha)),xa=1461300262,ha=ta=null}return{label:ha,jLa:ta,Br:xa}};a.prototype.$Ye=function(ha){return aa.EwaSettings.isChangeGateEnabled("OfficeVSO:6130289_FixLoggingColumnNameInButtonId")?G.a.hashCode(ha+E.HelperMethods.zmj).toString():ha};a.prototype.GBg=function(ha){if(!this.$.ea.amIAlone){var ta=this.$.da.za(25);
if((void 0!==ta&&null!==ta||!aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!w.a.isEmpty(ta.JBa)&&(ta=ta.yZh(),!v.a.Fh(ta))){var xa=[];t.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").o8g(ta,xa);Array.addRange(ha.MenuSectionList,xa)}}};a.prototype.bNf=function(){this.Snd||(this.eub&&this.eub.iZb(this.AC),this.Dpb&&this.Dpb.iZb(this.AC),this.Snd=!!this.eub||!!this.Dpb)};a.prototype.zag=function(){this.eub&&this.eub.Fsc(this.AC);this.Dpb&&this.Dpb.Fsc(this.AC);
this.Snd=!1};a.Tmd=function(ha,ta){ta=Q.C(ta);ha=R.g(ha).Ea.M3a(ta);return!(null===ha||void 0===ha||!ha.mk)};a.Wcd=function(ha,ta,xa){ta=Q.C(ta);var oa=R.g(ha).Ea.M3a(ta);ta=R.g(ha).getCellBounds(oa);var qa=oa.oMg;oa=oa.nMg;var Ea=ta.x+qa.x;ta=ta.y+qa.y;xa&&aa.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(R.g(ha).rtl||(Ea+=oa),ta-=oa);return new Sys.UI.Point(Ea,ta)};a.gwh=function(ha){try{Object(D.a)(ha.CommandValueId)}catch(ta){}};a.gg=function(ha){var ta=a.t1a.parseFromString(ha,
"text/html");return ta?ta.body.innerText:(e.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),ha)};Ck.Object.defineProperties(a.prototype,{contextMenuRoot:{configurable:!0,enumerable:!0,get:function(){return this.auc}},$:{configurable:!0,enumerable:!0,get:function(){return this.xb}},Ta:{configurable:!0,enumerable:!0,get:function(){return this.LPc}},menuId:{configurable:!0,enumerable:!0,get:function(){return this.$.Mb+this.apf}},eub:{configurable:!0,enumerable:!0,get:function(){this.KIc||
(this.KIc=V.a(this.$));return this.KIc}},Dpb:{configurable:!0,enumerable:!0,get:function(){this.WFc||(this.WFc=R.g(this.$).pc);return this.WFc}}});a.t1a=new DOMParser;a.qTe="Unsupported";Object(y.a)(a,"ContextMenuBase",C.a,[428,792,3])},981:function(y,C,b){function a(){}b.d(C,"a",function(){return a});y=b(0);a.ZLe="ewa-ac";a.Alh="ewa-ac-param";a.SMe="ewa-function-help-link";a.M8c="ewa-lb";a.MMe="ewa-fb-refactor";a.listItem="list-item";a.zBb="list-item-selected";a.DBb="list-table-touch";a.CBb="list-table";
a.prh="ewa-suggested-cell-name";a.uZg="columnName-header";a.NNe="ewa-tt";a.Coh="ewa-function-link-container";a.TMe="ewa-function-udf-name";a.rtl="rtl";Object(y.a)(a,"CssClassNames",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kpae.js.map/fd55be75ed1f1037fa68025955479fa1/EwaDS.kpae.js.map