(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1047:function(y,C,b){function a(){}b.d(C,"a",function(){return a});y=b(0);var c=b(15),e=b(4),f=b(39),l=b(24);a.aWe=function(n,m){switch(n){case 3:return a.IZh(m);case 2:return a.ySh(m);case 1:return a.PMh(m)}return""};a.IZh=function(n){switch(n){case 1:return e.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return e.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""};
a.ySh=function(n){switch(n){case 1:return e.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return e.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""};a.PMh=function(n){switch(n){case 1:return e.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return e.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""};a.openInClient=function(n,m,h){if(l.a.Eh||l.a.kp)window.setTimeout(function(){a.lMf(h,
a.kcc())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(a.Epe(h),n,0,!1)};a.hYg=function(n,m,h,x){m&&x&&x();a.openInClient(n,m,h)};a.kcc=function(){return l.a.Eh?1:l.a.kp?2:l.a.k7a?3:l.a.isMac?4:0};a.EZh=function(n){switch(n){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}};a.FZh=function(n){switch(n){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";
default:return""}};a.lMf=function(n,m){1===m?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),n=a.aWe(n,m),8<l.a.b5a?f.a.mf(n,void 0,void 0,"RedirectToAppStore"):f.a.kV(n)):document.hidden||(a.mzb?(n=e.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),f.a.kV(n)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),
MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(a.aWe(n,m),null,null)))};a.Epe=function(n){switch(n){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}};a.ucd=function(n){switch(n){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}};a.Cod=function(n){return(n=a.FPh(n))&&""!==n?Boolean.parse(n):!1};a.SOd=function(n){a.epj(n)};a.FPh=function(n){try{return localStorage.getItem(n)}catch(m){return c.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+m.message),null}};a.epj=function(n){try{localStorage.setItem(n,"true")}catch(m){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+m.message)}};Ck.Object.defineProperties(a,{mzb:{configurable:!0,enumerable:!0,get:function(){return"zh-CN"===window.navigator.language}},mxc:{configurable:!0,enumerable:!0,get:function(){return(l.a.k7a||l.a.isMac)&&l.a.lp}},pwj:{configurable:!0,enumerable:!0,
get:function(){return l.a.Eh||l.a.kp}}});a.Bxe="ChromeExtensionBarDismiss";Object(y.a)(a,"WildFireUtilities",null,[])},1154:function(y,C,b){function a(t,z){var D=this;this.od=function(){m.a.Kg(x.a(D.$).ud.activityState,v.a.tyd)||D.taa.reset()};this.$=z;this.qkc=t;this.ea=z.ea;this.ea.hk(this.od);this.taa=w.a.Qre(this.$)}function c(t){var z=this;this.jj=this.tDc=null;this._state=0;this.moveNext=function(){try{for(z._state=1;1===z._state;)z.Ju=z.Ju()}catch(D){z.dispose(),z._state=3}};this.Cf=t;this.Ju=
this.tL;this.moveNext()}b.r(C);y=b(0);var e=b(15),f=b(37),l=b(213),n=b(121),m=b(35),h=b(1),x=b(66),u=b(58);c.prototype.tL=function(){this.tDc=this.Cf.$.Pb.Gc("LoadResource","DownloadACopyOperation");return this.w_d};c.prototype.w_d=function(){var t=b(1154).DownloadACopyOperation;if(this.Cf.taa.x8e||!(this.tDc.Bc<t.Mkc))return this.rgg;this.jj=u.Task.delay(t.QIe).g();this.jj.isCompleted||(this._state=2,this.jj.vN(this.moveNext));return this.zfb};c.prototype.rgg=function(){var t=b(1154).DownloadACopyOperation;
this.tDc.Bc>=t.Mkc&&e.ULS.sendTraceTag(537154819,0,15,"Download did not complete after 10 seconds.");x.a(this.Cf.$).ud.yJ();this._state=3};c.prototype.zfb=function(){this.jj.rz();return this.w_d};c.prototype.dispose=function(){};Object(y.a)(c,"$$sm_Microsoft$Office$Excel$WebUI$Client$OpenInClient$DownloadACopyOperation$IframeCompleteLoadOld",null,[3]);var w=b(1249),v=b(146);b.d(C,"DownloadACopyOperation",function(){return a});a.prototype.Vgh=function(){var t=this,z=this.wRg(this.$),D=this.$.userOperationManager.operationCount;
0<D&&e.ULS.sendTraceTag(537154822,0,15,"flushing queue in downloadcopy. Queue is {0}",D);this.$.userOperationManager.m4("DownloadACopyOperation.DownloadForkedFile");this.qkc&&e.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.taa.downloadFile(z,-21742208);h.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?f.TaskExtensions.Ba(u.Task.delay(1),function(){t.w8e()},this.taa.la,3):f.TaskExtensions.Ba(u.Task.delay(1),
function(){t.G6h()},this.taa.la,3)};a.prototype.dispose=function(){this.ea&&this.ea.Dk(this.od);this.$=this.ea=null};a.prototype.w8e=function(t){var z=this;(t=void 0===t?null:t)||(t=this.$.Pb.Gc("LoadResource","DownloadACopyOperation"));!this.taa.x8e&&t.Bc<a.Mkc?window.setTimeout(function(){z.w8e(t)},a.QIe):(t.Bc>=a.Mkc&&e.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),x.a(this.$).ud.yJ())};a.prototype.G6h=function(){new c(this)};a.prototype.wRg=function(t){var z=new Sys.StringBuilder,
D=t.workbookContext,A=t.ya;z.append(t.Jda);z.append(A.FileHandlerRelativeUri);z.append("?id=");z.append(encodeURIComponent(l.a.IHb(D.WorkbookUri,"sc")));t.ea.rc&&(z.append("&sessionId="),z.append(encodeURIComponent(t.ea.sessionId)));z.append("&workbookType=FullForkedWorkbook");z.append("&dataloss=");z.append(this.qkc?"true":"false");n.a.YYa(z,A);return z.toString()};a.Mkc=1E5;a.QIe=100;Object(y.a)(a,"DownloadACopyOperation",null,[3])},1241:function(y,C,b){function a(n,m){n=l.call(this,n,m)||this;
c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");n.title="";n.message=a.Gxa;n.Pva=!0;return n}b.d(C,"a",function(){return a});y=b(0);var c=b(15),e=b(39),f=b(80);b=b(916);var l=b.a;Wl(a,l);a.prototype.fma=function(n){l.prototype.fma.call(this,n);e.a.openWindow(4,f.a.nH(a.unf))};a.prototype.ZC=function(n){l.prototype.ZC.call(this,n);a.Aud&&a.Aud(null)};a.initialize=function(n,m,h,x){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");
a.Gxa=n;a.vnf=m;a.unf=h;a.Aud=x};Ck.Object.defineProperties(a.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return a.vnf}}});a.Gxa=null;a.vnf=null;a.unf=null;a.Aud=null;Object(y.a)(a,"WacGdprNoticeBusinessBarEntry",b.a,[])},1242:function(y,C,b){function a(){}b.d(C,"a",function(){return a});y=b(0);a.Hlh="ewa-bb";a.Jlh="ewa-bb-entry";a.Rlh="ewa-bb-react";a.Klh="ewa-bb-entry-body";a.Qlh="ewa-bb-icon";a.Mlh="ewa-bb-entry-icon";a.Plh="ewa-bb-entry-title";a.Olh="ewa-bb-entry-message";
a.$Le="ewa-bb-entry-button";a.Nlh="ewa-bb-entry-link";a.Llh="ewa-bb-entry-close";a.aMe="ewa-bb-entry-button-holder";a.Ilh="ewa-bb-content";Object(y.a)(a,"CssClassNames",null,[])},1243:function(y,C,b){function a(e,f){e=c.call(this,e,f)||this;e.ev=!0;e.title=a.ipa;e.message=a.gpa;return e}b.d(C,"a",function(){return a});y=b(0);b=b(916);var c=b.a;Wl(a,c);a.prototype.Co=function(e){c.prototype.Co.call(this,e);(e=a.hpa)&&e(null)};a.initialize=function(e,f,l,n){a.ipa=e;a.gpa=f;a.fpa=l;a.hpa=n};Ck.Object.defineProperties(a.prototype,
{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.fpa}}});a.ipa=null;a.gpa=null;a.fpa=null;a.hpa=null;Object(y.a)(a,"AutomaticSensitivityLabelBusinessBarEntry",b.a,[])},1244:function(y,C,b){function a(e,f){e=c.call(this,e,f)||this;e.ev=!0;e.title=a.ipa;e.message=a.gpa;return e}b.d(C,"a",function(){return a});y=b(0);b=b(916);var c=b.a;Wl(a,c);a.prototype.Co=function(e){c.prototype.Co.call(this,e);(e=a.hpa)&&e(null)};a.initialize=function(e,f,l,n){a.ipa=e;a.gpa=f;a.fpa=l;a.hpa=n};
Ck.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.fpa}}});a.ipa=null;a.gpa=null;a.fpa=null;a.hpa=null;Object(y.a)(a,"RecommendedSensitivityLabelBusinessBarEntry",b.a,[])},1245:function(y,C,b){function a(e,f){e=c.call(this,e,f)||this;e.ev=!0;e.title=a.ipa;e.message=a.gpa;return e}b.d(C,"a",function(){return a});y=b(0);b=b(916);var c=b.a;Wl(a,c);a.prototype.Co=function(e){c.prototype.Co.call(this,e);(e=a.hpa)&&e(null)};a.initialize=function(e,
f,l,n){a.ipa=e;a.gpa=f;a.fpa=l;a.hpa=n};Ck.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.fpa}}});a.ipa=null;a.gpa=null;a.fpa=null;a.hpa=null;Object(y.a)(a,"MandatorySensitivityLabelBusinessBarEntry",b.a,[])},1246:function(y,C,b){function a(e,f){e=c.call(this,e,f)||this;e.ev=!0;e.title=a.kCb;e.message=a.Gxa;return e}b.d(C,"a",function(){return a});y=b(0);b=b(916);var c=b.a;Wl(a,c);a.prototype.Co=function(e){c.prototype.Co.call(this,e);a.Ixa&&
a.Ixa(null)};a.initialize=function(e,f,l,n){a.kCb=e;a.Gxa=f;a.c8a=l;a.Ixa=n};Ck.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.c8a}}});a.kCb=null;a.Gxa=null;a.c8a=null;a.Ixa=null;Object(y.a)(a,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",b.a,[])},1247:function(y,C,b){function a(e,f){e=c.call(this,e,f)||this;a.c8a&&a.Ixa&&(e.ev=!0);e.title=a.kCb;e.message=a.Gxa;return e}b.d(C,"a",function(){return a});y=b(0);b=b(916);var c=b.a;
Wl(a,c);a.prototype.Co=function(e){c.prototype.Co.call(this,e);a.Ixa&&a.Ixa(null)};a.initialize=function(e,f,l,n){a.kCb=e;a.Gxa=f;a.c8a=l;a.Ixa=n};Ck.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.c8a}}});a.kCb=null;a.Gxa=null;a.c8a=null;a.Ixa=null;Object(y.a)(a,"SensitivityApplicationSetLabelErrorBusinessBarEntry",b.a,[])},1248:function(y,C,b){function a(n,m,h,x,u,w){this.eY=n;this.fY=m;this.OJc=h;this.FD=x;this.LRb=u;this.FUa=w}b.d(C,"a",
function(){return a});y=b(0);var c=b(1303),e=b(4),f=b(52),l=b(84);a.prototype.C3i=function(n){this.zsf(n)};a.prototype.uqi=function(n){this.zsf(n)};a.prototype.zsf=function(n){var m=10;1===n?(l.a.instance.resolve("Common.IOfficeTrialExperience").sjc(this.FUa),m=3):2===n&&((!this.OJc||this.OJc(this.FD))&&this.fY&&c.a.instance.z7g(this.fY,this.eY,this.FD),m=5);(0===n||1===n)&&this.eY&&this.eY(this.FD);e.AFrameworkApplication.jtc(f.a.VDf,this.LRb,m);this.dispose()};a.prototype.dispose=function(){this.FD=
this.fY=this.eY=null};Ck.Object.defineProperties(a.prototype,{D2f:{configurable:!0,enumerable:!0,get:function(){return!this.fY&&!this.OJc}},dsf:{configurable:!0,enumerable:!0,get:function(){return 2===this.FUa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithTrial"}},CLe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessageNoOffice}},j8e:{configurable:!0,enumerable:!0,
get:function(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}},Tva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},T6e:{configurable:!0,enumerable:!0,get:function(){return"OICFailure"}},icon:{configurable:!0,enumerable:!0,get:function(){return 3}},PXb:{configurable:!0,enumerable:!0,get:function(){return 2===this.FUa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}},Jm:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});
Object(y.a)(a,"AOICErrorDialogWithTrial",null,[3])},1249:function(y,C,b){function a(w,v){var t=u.call(this,w)||this;t.pSj=["id","sessionId","workbookType","workbookFileType","dataloss"];t.command=0;t.hEb=function(){var z=t.MMh();if(z){t.$.fI(!0);if(-2028960985!==t.command&&1461300262!==t.command){var D=h.a(t.$).ud.activityState;D[m.a.gYa]=n.a.download;D[x.a.GTc]=t.command}l.a(t.$).Cr(z.Errors)}};t.iframe=w;t.$=v;t.Kc.ka("load",t.hEb);return t}b.d(C,"a",function(){return a});y=b(0);var c=b(15),e=b(39);
C=b(243);var f=b(213),l=b(44),n=b(6),m=b(34),h=b(66),x=b(649),u=C.a;Wl(a,u);a.prototype.downloadFile=function(w,v){var t={};(w=this.kxh(w,t))&&e.a.aqc("dlfr",w,t);this.command=v};a.prototype.kxh=function(w,v){var t=w.split("?");if(2!==t.length)return w=null,c.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),w;t=t[1].split("&");t=Gl(t);for(var z=t.next();!z.done;z=t.next()){var D=z.value.split("=",2);if(2!==D.length){w=null;c.ULS.sendTraceTag(537154787,
0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}z=D[0];Array.contains(this.pSj,z)&&(D=decodeURIComponent(D[1]),v[z]=D,w=f.a.IHb(w,z))}return w};a.prototype.reset=function(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262};a.prototype.MMh=function(){try{return this.iframe.contentWindow.ewaResult}catch(v){if(!this.$.ea.xc.isDivSyndicated){var w=window.document.referrer.match(RegExp("://(.[^/]+)/"));c.ULS.sendTraceTag(537154785,
0,50,"FileLoader.OnFrameLoad: parent domain: {0}, current domain: {1}, iframe domain: {2}. ewaControl IsCrossDomain: {3}",1<w.length?w[1]:"",escape(window.location.host),escape(this.iframe.contentWindow.location.host),this.$.xwa);throw v;}return null}};a.Qre=function(w){var v=document.createElement("iframe");v.id="ewaFileLoader";v.style.cssText="height:0;width:0;display:none";v.src="about:blank";v.setAttribute("name","dlfr");v=w.domElement.appendChild(v);return new a(v,w)};Ck.Object.defineProperties(a.prototype,
{x8e:{configurable:!0,enumerable:!0,get:function(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}}});Object(y.a)(a,"FileLoader",C.a,[])},1250:function(y,C,b){function a(){this.BaseDocQuerySignature=null;this.RoamingApp=0}b.d(C,"a",function(){return a});y=b(0);var c=b(1402),e=b(4),f=b(41),l=b(80);a.prototype.hNd=function(){return f.c([this.Iaa(),this])};a.prototype.execute=function(n,m,h){var x="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&
0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(x=l.a.El(x,"wdEnableRoaming","1"));e.AFrameworkApplication.Jd.gm(x,2,this.hNd(),{"Content-Type":"application/json; charset=utf-8"},!1,this.W3a(),n,m,h,void 0,void 0,void 0,void 0,"6")};Object(y.a)(a,"ARoamingAppsRequest",null,[])},1255:function(y,C,b){function a(){this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=this.logger=this.printPreviewPaneCallbacks=
this.backActionButtonText=null}b.d(C,"a",function(){return a});y=b(0);Object(y.a)(a,"PrintPreviewPaneProps",null,[])},1256:function(y,C,b){function a(){}b.d(C,"a",function(){return a});y=b(0);a.YZi="PrintDialogBody";a.printDialogTitle="PrintDialogTitle";a.g8b="ewa-dlg-elements-container-rtl";a.ZZi="PrintDialogLeftContainer";a.$Zi="PrintDialogRightContainer";a.W$a="PrintDialogRadioButtonContainer";a.WHf="PrintRadioButtonElementInnerDiv";a.f_i="PrintRadioButtonElementOuterDiv";a.X$a="PrintDialogTitleSection";
a.FEd="PrintDialogComboBoxContainer";a.g_i="PrintRadioButtonIcon";a.XZi="PrintButtonArea";a.Sw="PrintPreviewerContainer";Object(y.a)(a,"CssClassNames",null,[])},1295:function(y,C,b){function a(zb,vc){var ad=sc.call(this,vc)||this;ad.YBh=G.DOMElementExtensions.$r+",div";ad.IU=Array(67);ad.Cm=!1;ad.nW=function(ub){if(ub.Ca.keyCode===Q.a.AD){var Za=ad.wc.querySelectorAll(ad.YBh),wa=G.DOMElementExtensions.mn(Za);Za=G.DOMElementExtensions.JC(Za);return G.DOMElementExtensions.Bna(ub.Ca,wa,Za)}return!1};
ad.xb=zb;ad.set_visible(!1);ad.addCssClass(R.a.Hlh);Yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&ad.addCssClass(R.a.Rlh);M.KeyInputManager.instance.pa(ba.a.Xb,ad.wc,ad.nW);U.a(zb).ai(ad);return ad}function c(zb,vc,ad,ub,Za,wa){var ja=N.call(this,zb,vc,ad)||this;sb.a.instance.create(function(){if(ja.businessBar&&ja.businessBar.bMa(vc.wGa)){var Ua=new oa.a(-847286761,0,ja.businessBar.$.Xc,0,null),bb={};bb=(bb.CalloutName=ub,bb.Target=Yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)?ja.domElement.getElementsByClassName("ms-Button")[0]:ja.XS.domElement,bb);ja.businessBar.$.Ka.Wb(Ua,bb)}},Za,wa,!0,!0);return ja}function e(zb,vc,ad,ub){zb=mc.call(this,zb,vc)||this;zb.automateCommandManager=ad.da.za(352);P.ULS.shipAssertTag(526787654,0,!!zb.automateCommandManager);zb.id=yc.a.create();zb.$=ad;zb.title=za.a.instance.ga(2240);zb.message="";zb.mTd=za.a.instance.ga(2236);zb.rUj=za.a.instance.ga(2237);zb.Ieg=za.a.instance.ga(2238);zb.d1g=za.a.instance.ga(2239);zb.update(ub);return zb}
function f(zb,vc){zb=nb.call(this,zb,vc)||this;zb.WBa=Nb.a.M4b();zb.ev=!0;zb.LZ=zb.WBa.zSj;zb.title=zb.WBa.title;zb.message=zb.WBa.message;return zb}function l(zb,vc){zb=cc.call(this,zb,vc)||this;zb.ev=!0;zb.title="";return zb}function n(zb,vc){vc=mb.call(this,zb,vc)||this;vc.policyManager=zb.$.da.za(274);if(!vc.policyManager)return P.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered."),vc;vc.message=vc.policyManager.Rpc;vc.title=
vc.policyManager.title;vc.Pva=!0;return vc}function m(zb,vc){zb=Ra.call(this,zb,vc)||this;zb.ev=!0;zb.LZ=!0;return zb}function h(zb,vc,ad,ub){zb=$a.call(this,zb,vc)||this;zb.$wb=ad;zb.command=ub;zb.Pva=!0;zb.ev=1461300262!==ub;return zb}function x(zb,vc,ad){zb=va.call(this,zb,vc)||this;zb.$wb=ad;zb.Pva=!0;return zb}function u(zb,vc,ad){zb=Tb.call(this,zb,vc)||this;zb.$wb=ad;zb.ev=!0;return zb}function w(zb,vc){zb=Ya.call(this,zb,vc)||this;zb.ev=!0;zb.LZ=!1;return zb}function v(zb,vc){zb=Ia.call(this,
zb,vc)||this;zb.ev=!0;zb.LZ=!0;return zb}function t(zb,vc,ad,ub,Za,wa,ja,Ua){return z.call(this,zb,0,vc,ad,ub,Za,wa,ja,Ua)||this}function z(zb,vc,ad,ub,Za,wa,ja,Ua,bb){this.bJ=this.r8=this.XS=0;this.Skg=zb;this.gIj=vc;this.qP=ad;this.ppg=ja;this.Eib=E.a.ew(bb);this.ing=bb;this.Xkg=Ua;0!==ub&&(this.XS=ub);0!==Za&&(this.r8=Za);0!==wa&&(this.bJ=wa)}function D(zb,vc,ad,ub,Za){zb=A.call(this,zb,vc,ad,ub)||this;zb.command=Za;zb.LZ=!0;return zb}function A(zb,vc,ad,ub){zb=ka.call(this,zb,vc)||this;zb.error=
ad;zb.options=ub;zb.error&&zb.options&2&&(zb.message=zb.error.Description);zb.error&&zb.options&1&&(zb.title=zb.error.Caption);zb.ev=!(ub&4);return zb}function B(zb,vc,ad){return N.call(this,zb,vc,ad)||this}function N(zb,vc,ad){zb=qa.call(this,zb,vc)||this;zb.ev=!0;zb.command=ad;return zb}b.r(C);y=b(0);var P=b(15),Q=b(86),M=b(109),ba=b(13),V=b(91),aa=b(52),E=b(29),G=b(12),I=b(243),R=b(1242),Y=b(5),U=b(272),ha=b(1243),ta=b(916),xa=b(1322),oa=b(95),qa=ta.a;Wl(N,qa);N.prototype.Co=function(zb){qa.prototype.Co.call(this,
zb);this.businessBar.$.Ka.Wb(new oa.a(this.command,zb,this.businessBar.$.Xc,10,null))};Object(y.a)(N,"CommandActionBusinessBarEntry",ta.a,[]);Wl(B,N);B.prototype.ZC=function(zb){N.prototype.ZC.call(this,zb)};Object(y.a)(B,"EditAttemptReadOnlyBusinessBarEntry",N,[]);var Ea=b(44),ka=ta.a;Wl(A,ka);A.prototype.Co=function(zb){ka.prototype.Co.call(this,zb);this.error.Appearance&=-33;Ea.a(this.businessBar.$).Cr([this.error])};Object(y.a)(A,"ErrorBusinessBarEntry",ta.a,[]);Wl(D,A);D.prototype.O_=function(zb){A.prototype.O_.call(this,
zb);this.businessBar.$.Ka.Wb(new oa.a(this.command,zb,this.businessBar.$.Xc,10,null))};Object(y.a)(D,"ErrorAndCommandBusinessBarEntry",A,[]);var za=b(14);z.ga=function(zb){return za.a.instance.ga(zb)};Ck.Object.defineProperties(z.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return z.ga(this.gIj)}},message:{configurable:!0,enumerable:!0,get:function(){return z.ga(this.qP)}},messageId:{configurable:!0,enumerable:!0,get:function(){return this.qP}},wGa:{configurable:!0,enumerable:!0,
get:function(){return this.Skg}},actionButton:{configurable:!0,enumerable:!0,get:function(){return z.ga(this.XS)}},ZFa:{configurable:!0,enumerable:!0,get:function(){return z.ga(this.r8)}},link:{configurable:!0,enumerable:!0,get:function(){return z.ga(this.bJ)}},Rk:{configurable:!0,enumerable:!0,get:function(){return this.ppg}},ERg:{configurable:!0,enumerable:!0,get:function(){return this.Xkg}},hash:{configurable:!0,enumerable:!0,get:function(){return this.Eib}},alt:{configurable:!0,enumerable:!0,
get:function(){var zb=b(1295).BusinessBarControl;switch(this.Rk){case zb.Aia:return z.ga(26);case zb.NB:return z.ga(25);case zb.aj:return z.ga(24);default:return z.ga(0)}}},f8c:{configurable:!0,enumerable:!0,get:function(){return this.ing}}});Object(y.a)(z,"EwaBusinessBarEntry",null,[]);Wl(t,z);Ck.Object.defineProperties(t.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return""}}});Object(y.a)(t,"EwaNoTitleBusinessBarEntry",z,[]);var La=b(72),Ia=ta.a;Wl(v,Ia);v.prototype.Co=function(zb){Ia.prototype.Co.call(this,
zb);this.set_visible(!1);this.businessBar.$.QK();this.businessBar.$.Ka.Wb(new oa.a(1038998010,zb,this.businessBar.$.Xc,10,null))};v.prototype.O_=function(zb){Ia.prototype.O_.call(this,zb);this.businessBar.$.Ka.Wb(new oa.a(-722953877,zb,this.businessBar.$.Xc,10,null))};v.prototype.ZC=function(zb){this.businessBar.removeEntry(53);La.g(zb)};Object(y.a)(v,"ExternalLinksEnableContentBusinessBarEntry",ta.a,[]);var Ya=ta.a;Wl(w,Ya);w.prototype.Co=function(zb){Ya.prototype.Co.call(this,zb);this.businessBar.$.Ka.Wb(new oa.a(-722953877,
zb,this.businessBar.$.Xc,10,null))};w.prototype.ZC=function(zb){this.businessBar.removeEntry(5);La.g(zb)};Object(y.a)(w,"ExternalLinksShowErrorBusinessBarEntry",ta.a,[]);var tb=b(10),Tb=ta.a;Wl(u,Tb);u.prototype.Co=function(zb){Tb.prototype.Co.call(this,zb);tb.HelperMethods.D6(this.businessBar.$.jG,this.$wb,this.businessBar.$.LS)};Object(y.a)(u,"HelpButtonBusinessBarEntry",ta.a,[]);var va=ta.a;Wl(x,va);x.prototype.fma=function(zb){va.prototype.fma.call(this,zb);tb.HelperMethods.D6(this.businessBar.$.jG,
this.$wb,this.businessBar.$.LS)};Object(y.a)(x,"HelpTextBusinessBarEntry",ta.a,[]);var la=b(79),$a=ta.a;Wl(h,$a);h.prototype.Co=function(zb){$a.prototype.Co.call(this,zb);this.businessBar.$.Ka.Wb(new oa.a(this.command,zb,this.businessBar.$.Xc,10,null))};h.prototype.fma=function(zb){$a.prototype.fma.call(this,zb);var vc=new oa.a(-859308420,zb,this.businessBar.$.Xc,12,null),ad={};zb=(ad[la.a.pg]="HelpID="+this.$wb,ad.InputMethod=zb,ad[la.a.kd]=Y.a.XQ,ad[Y.a.fea]=!0,ad);this.businessBar.$.Ka.Wb(vc,zb)};
Object(y.a)(h,"HelpTextTaskPaneAndCommandBusinessBarEntry",ta.a,[]);var Ra=ta.a;Wl(m,Ra);m.prototype.Co=function(zb){Ra.prototype.Co.call(this,zb);this.set_visible(!1);this.businessBar.$.QK();this.businessBar.$.Ka.Wb(new oa.a(-1081442996,zb,this.businessBar.$.Xc,10,null))};m.prototype.O_=function(zb){Ra.prototype.O_.call(this,zb);this.businessBar.$.Ka.Wb(new oa.a(1702917262,zb,this.businessBar.$.Xc,10,null))};m.prototype.ZC=function(zb){this.businessBar.removeEntry(57);La.g(zb)};Object(y.a)(m,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",
ta.a,[]);var eb=b(1245),mb=ta.a;Wl(n,mb);n.prototype.fma=function(zb){mb.prototype.fma.call(this,zb);(zb=this.policyManager.yMi)&&zb(null)};Ck.Object.defineProperties(n.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return this.policyManager.linkText}}});Object(y.a)(n,"PolicyBusinessBarEntry",ta.a,[]);var Pa=b(1244),Da=b(1247),Ta=b(1246);b(439);var Sa=b(187),Cb=b(27),cc=ta.a;Wl(l,cc);l.prototype.Co=function(zb){cc.prototype.Co.call(this,zb);Sa.c(Cb.a.rBi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ",
"_blank")};Object(y.a)(l,"UnsupportedBrowserBusinessBarEntry",ta.a,[]);var nc=b(1241),Nb=b(1336),nb=ta.a;Wl(f,nb);f.prototype.Co=function(zb){nb.prototype.Co.call(this,zb);this.WBa.Htf(null)};f.prototype.O_=function(zb){nb.prototype.O_.call(this,zb);this.WBa.Ktf(null)};f.prototype.ZC=function(zb){nb.prototype.ZC.call(this,zb);this.WBa.IHe(null)};Ck.Object.defineProperties(f.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return this.WBa.xue}},ZFa:{configurable:!0,enumerable:!0,
get:function(){return this.WBa.zue}}});Object(y.a)(f,"WildFireMobileAppBusinessBarEntry",ta.a,[]);var db=b(256),Bb=b(21),zc=b(224),Eb=b(178),Ja=b(46),Rb=b(7),yc=b(176),qd=b(1165),bc=b(78),Vb=b(133),mc=ta.a;Wl(e,mc);e.prototype.update=function(zb){this.scriptLink=zb.scriptLink;this.runStatus=zb.runStatus;this.buttonText=zb.buttonText||"";this.rsi(zb.clickId);this.gej();"preparing"===this.runStatus?(this.message=String.format(za.a.instance.Bb(199),this.buttonText),this.ev=!0,this.VXa=this.mTd,this.dqb=
this.kFa=this.O9a):"running"===this.runStatus?(this.message=String.format(za.a.instance.Bb(198),this.buttonText),this.ev=!0,this.VXa=this.mTd,this.dqb=this.kFa=this.O9a):"succeeded"===this.runStatus?(this.message=String.format(za.a.instance.Bb(201),this.buttonText),this.ev=!0,this.VXa=this.Ieg,this.kFa=this.mDf,this.LZ=!0,this.VVc=this.rUj,this.WVc=this.uSi):"runFailed"===this.runStatus?(this.message=String.format(za.a.instance.Bb(200),this.buttonText),this.c5a=a.Aia,this.ev=!0,this.VXa=this.Ieg,
this.kFa=this.mDf,"false"===zb.isOwner&&(this.LZ=!0,this.VVc=this.d1g,this.WVc=this.KGi)):"fetchFailed"===this.runStatus?(this.c5a=a.Aia,this.message=String.format(za.a.instance.Bb(202),this.buttonText)):"canceled"===this.runStatus?(this.c5a=a.NB,this.message=String.format(za.a.instance.Bb(204),this.buttonText)):"alreadyRunning"===this.runStatus?(this.c5a=a.NB,this.message=String.format(za.a.instance.Bb(203),this.buttonText),this.ev=!0,this.VXa=this.mTd,this.dqb=this.kFa=this.O9a):"initializing"===
this.runStatus&&(this.c5a=a.aj,this.message=za.a.instance.ga(2241))};e.prototype.Co=function(zb){mc.prototype.Co.call(this,zb);this.kFa&&this.kFa()};e.prototype.O_=function(zb){mc.prototype.O_.call(this,zb);this.ZFa&&this.WVc()};e.prototype.ZC=function(zb){mc.prototype.ZC.call(this,zb);this.dqb&&this.dqb()};e.prototype.gej=function(){this.message="";this.c5a=a.aj;this.ev=!1;this.VXa="";this.kFa=void 0;this.LZ=!1;this.VVc="";this.WVc=void 0;this.T4a=!1;this.dqb=void 0};e.prototype.O9a=function(){var zb=
yc.a.create().toString();this.automateCommandManager.y0h(zb);this.Rjc(-2186799,zb)};e.prototype.mDf=function(){var zb=yc.a.create().toString();this.automateCommandManager.x0h(zb);this.Rjc(1036446140,zb)};e.prototype.uSi=function(){var zb=yc.a.create();if(this.scriptLink){var vc=new qd.b(this.scriptLink);this.automateCommandManager.q5e(this.id.toString(),JSON.stringify(vc),zb)}this.Rjc(-585097204,zb.toString())};e.prototype.KGi=function(){var zb=yc.a.create().toString();this.automateCommandManager.w0h(zb);
this.Rjc(-639858579,zb)};e.prototype.rsi=function(zb){var vc=[];vc.push(Object(Rb.a)(new bc.a,{name:"id",string:this.id.toString()}));vc.push(Object(Rb.a)(new bc.a,{name:"hasScriptLink",bool:!!this.scriptLink}));vc.push(Object(Rb.a)(new bc.a,{name:"runStatus",string:this.runStatus}));vc.push(Object(Rb.a)(new bc.a,{name:"clickId",string:zb}));vc.push(Object(Rb.a)(new bc.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));Sa.a(Vb.a.MDi,void 0,void 0,vc)};e.prototype.Rjc=function(zb,
vc){var ad=[];ad.push(Object(Rb.a)(new bc.a,{name:"id",string:this.id.toString()}));ad.push(Object(Rb.a)(new bc.a,{name:"hasScriptLink",bool:!!this.scriptLink}));ad.push(Object(Rb.a)(new bc.a,{name:"runStatus",string:this.runStatus}));ad.push(Object(Rb.a)(new bc.a,{name:"clickId",string:vc}));Sa.d(zb,void 0,void 0,void 0,void 0,void 0,ad)};Ck.Object.defineProperties(e.prototype,{Rk:{configurable:!0,enumerable:!0,get:function(){return this.c5a}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.VXa}},
ZFa:{configurable:!0,enumerable:!0,get:function(){return this.VVc}}});Object(y.a)(e,"OfficeScriptsRunStatusBusinessBarEntry",ta.a,[]);var sb=b(47),Yb=b(1);Wl(c,N);Object(y.a)(c,"CalloutBusinessBarEntry",N,[]);var Hb=b(19);b.d(C,"BusinessBarControl",function(){return a});var sc=I.a;Wl(a,sc);a.prototype.eg=function(zb,vc){vc||G.DOMElementExtensions.setFocus(this.domElement.firstChild);return!vc};a.prototype.ph=function(zb){return G.DOMElementExtensions.Ff(this.wc,zb)};a.prototype.Aj=function(){};a.prototype.Qj=
function(){};a.prototype.dispose=function(){this.Cm||(M.KeyInputManager.instance.Aa(ba.a.Xb,this.wc,this.nW),V.a.Dc(this.IU),this.IU=Array(67),this.xb=null,sc.prototype.dispose.call(this),this.Cm=!0)};a.prototype.bMa=function(zb){if(!this.get_visible())return!1;zb=this.IU[zb];return!!zb&&zb.isVisible};a.prototype.kC=function(zb){return!!this.IU[zb]};a.prototype.VNb=function(zb,vc){if(zb=this.IU[zb])zb.update(vc),zb.AOj()};a.prototype.cE=function(zb,vc,ad,ub){ad=void 0===ad?null:ad;ub=void 0===ub?
null:ub;var Za=!1;if(this.kC(zb))ad=this.IU[zb].get_visible();else{this.set_visible(!0);var wa=a.o3e()[zb];this.IU[zb]=this.M$(zb,vc,ad,ub);ad=!1;Za=!0;ub="";var ja=0;vc&&(ub=vc.MessageIdName,ja=vc.MessageId);var Ua=wa.f8c;P.ULS.sendTraceTag(537170258,0,50,"BusinessBarControl.AddEntry of type: {0}, time from app interactive: {1}",zb,Ja.PageLoadTrackingInfo.instance.Bja(new Date));if(Yb.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")){var bb=this.IU.filter(function(Xa){return null!=
Xa}).length;1<bb&&P.ULS.sendTraceTag(525349006,0,50,"Total BizBars: {0}",bb.toString())}Eb.a(this.$).DJd(wa.hash,ub,ja,aa.a.OAc,!0,1,vc,Ua)}ad||!Array.contains(xa.a.mcc(),zb)&&!Za||(this.IU[zb].set_visible(!0),this.$.QK())};a.prototype.removeEntry=function(zb){return this.G8i(zb)};a.prototype.HHd=function(){V.a.Dc(this.IU);this.IU=Array(67);this.set_visible(!1)};a.prototype.G8i=function(zb){if(!this.kC(zb))return!1;V.a.Ha(this.IU[zb]);this.IU[zb]=null;this.domElement.hasChildNodes()||this.set_visible(!1);
this.$.QK();return!0};a.prototype.M$=function(zb,vc,ad,ub){ad=void 0===ad?null:ad;ub=void 0===ub?null:ub;var Za=a.o3e()[zb],wa=!!(this.$.Qd&64);switch(zb){case 2:case 4:case 23:case 25:case 26:case 35:case 34:zb=new ta.a(this,Za);break;case 12:case 29:case 30:case 31:case 32:case 55:zb=wa?new N(this,Za,-8805455):new ta.a(this,Za);break;case 22:zb=new B(this,Za,-8805455);break;case 44:case 43:zb=wa?new D(this,Za,vc,0,-8805455):new A(this,Za,vc,0);break;case 11:case 41:case 7:case 0:case 1:case 3:case 33:zb=
new A(this,Za,vc,0);break;case 19:zb=new ta.a(this,Za);break;case 45:zb=new A(this,Za,vc,0);break;case 6:case 14:zb=new u(this,Za,vc.HelpTopicId);break;case 66:case 64:zb=new x(this,Za,vc.HelpTopicId);break;case 36:zb=new x(this,Za,Y.a.Kah);break;case 16:zb=new ta.a(this,Za);zb.title=E.a.vg(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);zb.message=E.a.vg(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:zb=new N(this,Za,-1762562205);zb.T4a=!0;break;case 20:zb=new f(this,
Za);break;case 21:case 54:zb=new ta.a(this,Za);break;case 28:zb=new ta.a(this,Za);break;case 24:zb=new l(this,Za);break;case 27:zb=new n(this,Za);break;case 37:zb=new nc.a(this,Za);break;case 38:zb=new ha.a(this,Za);break;case 39:zb=new Pa.a(this,Za);break;case 40:zb=new eb.a(this,Za);break;case 46:zb=new ta.a(this,Za);break;case 47:zb=new ta.a(this,Za);break;case 48:zb=new ta.a(this,Za);break;case 49:zb=new ta.a(this,Za);break;case 50:zb=new ta.a(this,Za);break;case 51:zb=new Ta.a(this,Za);break;
case 52:zb=new Da.a(this,Za);break;case 53:zb=new v(this,Za);break;case 5:zb=new w(this,Za);break;case 56:zb=new N(this,Za,-1753056834);vc?(vc=vc.Directive,Bb.a.Tn(vc)||"&nbsp;"===vc||(zb.message=vc)):ad&&(zb.message=ad);break;case 57:zb=new m(this,Za);break;case 58:zb=new ta.a(this,Za);break;case 59:case 62:zb=new x(this,Za,Y.a.VCi);break;case 60:zb=new h(this,Za,Y.a.UMg,-8805455);break;case 65:zb=new h(this,Za,Y.a.g4i,1461300262);break;case 61:zb=Yb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerBusinessBarTeachingCallout",
!1)?new c(this,Za,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout"):new N(this,Za,515196233);break;case 63:zb=new e(this,Za,this.$,ub);break;default:zb=new A(this,Za,vc,7)}zb.P2c();return zb};a.o3e=function(){var zb=zc.a.c6a()?262:261;return a.nue||(a.nue=[new z(0,277,278,279,0,0,a.Aia,1,"BB_UnableToRefreshLock"),new z(1,277,278,279,0,0,a.Aia,1,"BB_UnableToRefreshLockExpected"),new z(2,269,270,0,0,0,a.NB,5,"BB_WorkbookAlmostTooLarge"),new z(3,271,272,273,0,0,a.Aia,1,"BB_WorkbookTooLarge"),
new z(4,260,zb,0,0,0,a.NB,5,"BB_ExternalWorkbookLinksDisabled"),new z(5,264,263,265,0,0,a.Aia,1,"BB_ExternalWorkbookLinksShowError"),new z(6,266,267,268,0,0,a.aj,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new z(7,252,253,254,0,0,a.aj,0,"BB_UnsupportedFeatures"),new z(8,0,0,0,0,0,a.aj,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new z(9,0,0,0,0,0,a.aj,0,"BB_CollabDataStringsLocaleMismatch"),new z(10,0,0,0,0,0,a.aj,0,"BB_CollabDataLocaleMismatch"),new z(11,280,281,282,0,0,a.Aia,1,"BB_LastGenericStatusError"),
new z(12,283,284,285,0,0,a.NB,5,"BB_ScratchPadWarning"),new z(13,286,287,288,0,0,a.Aia,1,"BB_AuthenticationLost"),new z(14,289,290,291,0,0,a.NB,5,"BB_OdfCompatibilityIssues"),new z(15,0,577,0,0,0,a.NB,5,"BB_PivotChartInteractivityMissingWarning"),new z(16,0,0,0,0,0,a.aj,0,"BB_WorkbookIsIrmProtected"),new z(17,0,0,0,0,0,a.aj,0,"BB_BIFeatureNotAvailable"),new z(18,292,293,288,0,0,a.NB,5,"BB_AnonymousCreateMode"),new z(19,255,256,0,0,0,a.NB,5,"BB_UnsupportedInteractiveReportEditing"),new z(20,0,0,0,
0,0,a.aj,0,"BB_MobileAppCampaignBizBar"),new z(21,298,299,0,0,0,a.aj,0,"BB_TransientServerCommunicationFailures"),new z(22,1620,1631,1632,0,0,a.aj,0,"BB_EditAttemptInReadOnly"),new z(23,1620,1631,0,0,0,a.aj,0,"BB_EditAttemptInReadOnlyNoEditPermissions"),new z(24,0,tb.HelperMethods.YNj(),1609,0,0,a.aj,0,"BB_UnsupportedBrowser"),new z(25,301,302,0,0,0,a.aj,0,"BB_ReadOnlyPermissions"),new z(26,303,304,0,0,0,a.aj,0,"BB_DocumentIsIrmProtectedWarning"),new z(27,0,0,0,0,0,a.NB,5,"BB_PolicyWarningMessage"),
new z(28,1264,300,0,0,0,a.aj,0,"BB_WorkingOnIt"),new z(29,1620,1618,1619,0,0,a.aj,0,"BB_PasswordProtectedWorkbookLockedForEdit"),new z(30,1633,1634,1635,0,0,a.aj,0,"BB_WorkbookIsReadOnlyRecommended"),new z(31,1620,1636,1637,0,0,a.aj,0,"BB_WorkbookHasPasswordToModify"),new z(32,1620,1638,1641,0,0,a.aj,0,"BB_LegacySharedWorkbookEditWarning"),new z(33,1628,1639,254,0,0,a.aj,0,"BB_LegacyConnectionsWarning"),new z(34,1629,1630,0,0,0,a.aj,0,"BB_GroupedSlicers"),new z(35,314,315,0,0,0,a.NB,5,"BB_ThirdPartyAddinDisabled"),
new z(36,1761,1762,0,0,1763,a.aj,0,"BB_FinanceLinkedEntityDisclaimerBar"),new z(37,0,0,0,0,0,a.aj,0,"BB_WacGdprNotice"),new z(38,0,0,0,0,0,a.aj,0,"BB_AutomaticSensitivityLabel"),new z(39,0,0,0,0,0,a.aj,0,"BB_RecommendedSensitivityLabel"),new z(40,0,0,0,0,0,a.aj,0,"BB_MandatorySensitivityLabel"),new z(41,316,317,318,0,0,a.aj,0,"BB_LocalStorageDisabled"),new z(42,634,635,0,0,0,a.aj,0,"BB_AutoRefreshDisabled"),new z(43,1005,1003,1007,1293,0,a.aj,0,"BB_CorruptedFileRepaired"),new z(44,1006,1004,1007,
1293,0,a.aj,0,"CorruptedOdsFileRepaired"),new z(45,274,275,276,0,0,a.NB,5,"BB_MinorVersionLimitReached"),new z(46,305,306,0,0,0,a.NB,5,"BB_SensitivityApplicationGenericError"),new z(47,307,309,0,0,0,a.NB,5,"BB_SensitivityApplicationTooLargeFileError"),new z(48,308,309,0,0,0,a.NB,5,"BB_SensitivityApplicationLabelNotSupportedError"),new z(49,310,311,0,0,0,a.NB,5,"BB_SensitivityApplicationLabelDisabledError"),new z(50,312,313,0,0,0,a.NB,5,"BB_SensitivityApplicationMandatoryConflictError"),new z(51,0,
0,0,0,0,a.NB,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new z(52,0,0,0,0,0,a.NB,5,"BB_SensitivityApplicationSetLabelError"),new z(53,2084,2085,2086,2089,0,a.aj,0,"BB_ExternalWorkbookLinksPromptEnableContent"),new z(54,298,299,0,0,0,a.aj,0,"BB_NetworkDown"),new z(55,319,320,321,0,0,a.aj,0,"BB_DefaultToViewDueToCogs"),new z(56,1787,1788,1789,0,0,a.aj,0,"BB_RefreshLinkedEntityErrorBar"),new z(57,1764,1765,1766,1767,0,a.aj,0,"BB_LinkedEntitiesUntrustedImagesDisabled"),new t(58,251,0,
0,0,a.aj,0,"BB_CanvasHealth"),new z(59,322,323,0,0,324,a.aj,0,"BB_NovModeDepreciation"),new z(60,1008,1009,1293,0,1010,a.aj,0,"BB_MismatchedFileFormatConverted"),new z(61,2197,2198,2199,0,0,a.aj,0,"BB_OptimizeWorkbook"),new z(62,325,326,0,0,327,a.aj,0,"BB_NovModePostDepreciation"),new z(63,0,0,0,0,0,a.aj,0,"BB_OfficeScriptsRunning"),new z(64,2175,2176,0,0,2178,a.aj,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new z(65,328,329,0,0,330,a.aj,0,"BB_ReadOnlyPivotTable"),new z(66,2175,2177,0,0,2178,
a.aj,0,"BB_PowerQueryRefreshHostNotSupported")])};Ck.Object.defineProperties(a.prototype,{xe:{configurable:!0,enumerable:!0,get:function(){return db.a.KYc}},wc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.get_visible()}},$:{configurable:!0,enumerable:!0,get:function(){return this.xb}}});a.Aia=Hb.a.Zoh;a.NB=Hb.a.aph;a.aj=Hb.a.$oh;a.nue=null;Object(y.a)(a,"BusinessBarControl",I.a,[415])},1303:function(y,
C,b){function a(){this.cjb=!!u.AFrameworkApplication.sa&&u.AFrameworkApplication.sa.Qa.lv}function c(B,N,P){var Q=l.call(this,B,N,P)||this;B={};B=(B.errorMessage=Q.DLe,B.errorFileDownloadOffer=Q.Ysb,B);N={};B.helpLink=(N.type="AppLinkProps",N.id="helpLink",N.text=Q.Tva,N.onExecute=function(M){Q.nOa(M)},N);N=new A.a(!1,!1,!0);N.ic=1;N.Ac(1,Q.Zsb);N.Ne=Q.id;P={};B=(P.id=Q.id,P.dialogIcon=Q.icon,P.bodyControls=B,P);N.initializeAndShow(Q.Jm,Object(h.a)(Q,Q.dGd,"reactOICErrorDialogHandler"),B);return Q}
function e(B,N,P,Q){var M=m.call(this,B,N,P,Q)||this;B={};B=(B.errorMessage=M.errorMessage,B);N={};B.helpLink=(N.type="AppLinkProps",N.id="helpLink",N.text=M.Tva,N.onExecute=function(ba){M.nOa(ba)},N);M.Ywc?(B.macOfficePreLinkText=M.Unf,N={},B.macOfficeLink=(N.type="AppLinkProps",N.id="macOfficeLink",N.text=M.Rnf,N.onExecute=function(ba){M.uyd(ba)},N),B.macOfficePostText=M.Tnf):M.z3b&&(B.errorFileDownloadOffer=M.Ysb);N=new A.a(!1,!1,!0);M.z3b?(N.ic=1,N.Ac(1,M.Zsb)):N.ic=0;N.Ne=M.id;P={};B=(P.id=M.id,
P.dialogIcon=M.icon,P.bodyControls=B,P);N.initializeAndShow(M.Jm,Object(h.a)(M,M.dGd,"reactOICErrorDialogHandler"),B);return M}function f(B,N,P){B=l.call(this,B,N,P)||this;B.am=null;N=document.createElement("span");N.id="errorMessageText";N.innerText=B.DLe;N.appendChild(document.createElement("br"));N.appendChild(document.createElement("br"));B.am=document.createElement("a");B.am.href="#";B.am.innerText=B.Tva;N.appendChild(B.am);z.a.addHandler(B.am,"click",Object(h.a)(B,B.nOa,"oicErrorHelpLinkHandler"));
N.appendChild(document.createElement("br"));N.appendChild(document.createElement("br"));P=document.createElement("span");P.innerText=B.Ysb;N.appendChild(P);P=new D.StandardDialog;P.Ne=B.id;P.ic=1;P.Ac(1,B.Zsb);P.Ak(B.Jm,null,B.icon,Object(h.a)(B,B.Bsd,"legacyOICErrorDialogHandler"),N);P.jX("errorMessageText");return B}function l(B,N,P){this.eY=N;this.fY=B;this.FD=P}function n(B,N,P,Q){B=m.call(this,B,N,P,Q)||this;B.am=null;B.Hqa=null;N=document.createElement("span");N.id="errorMessageText";N.innerText=
B.errorMessage;N.appendChild(document.createElement("br"));N.appendChild(document.createElement("br"));B.am=document.createElement("a");B.am.href="#";B.am.innerText=B.Tva;N.appendChild(B.am);z.a.addHandler(B.am,"click",Object(h.a)(B,B.nOa,"oicErrorHelpLinkHandler"));P=new D.StandardDialog;P.Ne=B.id;if(B.Ywc){Q=document.createElement("span");var M=document.createElement("span");Q.innerText=B.Unf;M.innerText=B.Tnf;B.Hqa=document.createElement("a");B.Hqa.href="#";B.Hqa.innerText=B.Rnf;N.appendChild(document.createElement("br"));
N.appendChild(Q);N.appendChild(B.Hqa);N.appendChild(M);z.a.addHandler(B.Hqa,"click",Object(h.a)(B,B.uyd,"oicErrorMacOfferLinkHandler"))}else B.z3b&&(N.appendChild(document.createElement("br")),N.appendChild(document.createElement("br")),Q=document.createElement("span"),Q.innerText=B.Ysb,N.appendChild(Q));B.z3b?(P.ic=1,P.Ac(1,B.Zsb)):P.ic=0;P.Ak(B.Jm,null,B.icon,Object(h.a)(B,B.Bsd,"legacyOICErrorDialogHandler"),N);P.jX("errorMessageText");return B}function m(B,N,P,Q){this.SMc=null;this.LRb=Q;this.eY=
B;this.fY=N;this.FD=P;this.fge=this.Snf.qvj;B=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.Irg=B[0];this.Hrg=B[1]}y=b(0);var h=b(82),x=b(15),u=b(4),w=b(52),v=b(439),t=b(84);m.prototype.dGd=function(B){this.EDb(B)};m.prototype.Bsd=function(B){this.EDb(B)};m.prototype.EDb=function(B){var N=10;this.fY&&1===B&&(this.fY(this.FD),N=1);this.eY&&this.eY(this.FD);this.PF(N)};m.prototype.nOa=function(){v.Redirect.showHelp("OICFailure");this.PF(2)};m.prototype.uyd=function(){this.Snf.ojf();this.PF(4)};
m.prototype.PF=function(B){x.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.LRb,B);u.AFrameworkApplication.jtc(w.a.TDf,this.LRb,B)};m.prototype.dispose=function(){this.FD=this.eY=this.fY=null};Ck.Object.defineProperties(m.prototype,{Snf:{configurable:!0,enumerable:!0,get:function(){return this.SMc||(this.SMc=t.a.instance.resolve("Common.IMacOfficeOffer"))}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialog"}},errorMessage:{configurable:!0,
enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessage}},Tva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},Ywc:{configurable:!0,enumerable:!0,get:function(){return this.fge}},Unf:{configurable:!0,enumerable:!0,get:function(){return this.Irg}},Tnf:{configurable:!0,enumerable:!0,get:function(){return this.Hrg}},Rnf:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMacOFficeLink}},icon:{configurable:!0,enumerable:!0,
get:function(){return this.fge?3:2}},Ysb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},z3b:{configurable:!0,enumerable:!0,get:function(){return!!this.fY}},Zsb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},Jm:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(y.a)(m,"AOICErrorDialog",null,[3]);var z=b(42),D=b(135);Wl(n,m);n.prototype.dispose=
function(){this.am&&(z.a.removeHandler(this.am,"click",Object(h.a)(this,this.nOa,"oicErrorHelpLinkHandler")),this.am=null);this.Hqa&&(z.a.removeHandler(this.Hqa,"click",Object(h.a)(this,this.uyd,"oicErrorMacOfferLinkHandler")),this.Hqa=null);m.prototype.dispose.call(this)};Object(y.a)(n,"OICErrorDialog",m,[]);l.prototype.dGd=function(B){this.EDb(B)};l.prototype.Bsd=function(B){this.EDb(B)};l.prototype.EDb=function(B){var N=10;1===B&&(this.fY(this.FD),N=1);this.eY&&this.eY(this.FD);this.PF(N)};l.prototype.nOa=
function(){v.Redirect.showHelp("OICFailure");this.PF(2)};l.prototype.PF=function(B){u.AFrameworkApplication.jtc(w.a.UDf,3,B)};l.prototype.dispose=function(){this.FD=this.fY=this.eY=null};Ck.Object.defineProperties(l.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithDownload"}},DLe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDetected}},Tva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},
Ysb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},Zsb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},icon:{configurable:!0,enumerable:!0,get:function(){return 2}},Jm:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(y.a)(l,"AOICErrorDialogWithDownload",null,[3]);Wl(f,l);f.prototype.dispose=function(){this.am&&(z.a.removeHandler(this.am,"click",
Object(h.a)(this,this.nOa,"oicErrorHelpLinkHandler")),this.am=null);l.prototype.dispose.call(this)};Object(y.a)(f,"OICErrorDialogWithDownload",l,[]);var A=b(150);Wl(e,m);Object(y.a)(e,"ReactOICErrorDialog",m,[]);Wl(c,l);Object(y.a)(c,"ReactOICErrorDialogWithDownload",l,[]);b.d(C,"a",function(){return a});a.prototype.y7g=function(B,N,P){this.cjb?new e(B,N,null,P):new n(B,N,null,P)};a.prototype.z7g=function(B,N,P){this.cjb?new c(B,N,P):new f(B,N,P)};a.prototype.A7g=function(B,N,P,Q,M){var ba=b(1382).ReactOICErrorDialogWithTrial,
V=b(1383).OICErrorDialogWithTrial;this.cjb?new ba(B,N,P,null,Q,M):new V(B,N,P,null,Q,M)};Ck.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Ma||(a.Ma=new a)}}});a.Ma=null;Object(y.a)(a,"OICErrorDialogFactory",null,[360])},1322:function(y,C,b){function a(xa,oa){var qa=ta.call(this)||this;qa.Pa=new h.a;qa.nU=null;qa.MHc=[];qa.wmc=function(){qa.$.na.KLa?qa.removeEntry(13):qa.fg(13,null)};qa.tya=function(){E.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&
e.ULS.sendTraceTag(537170243,0,50,"BusinessBar.OnNetworkResumed: removing TransientServerCommunicationFailures BB");qa.removeEntry(21);qa.kC(54)&&(e.ULS.sendTraceTag(537170242,0,15,"BusinessBar.OnNetworkResumed: removing NetworkDown BB"),qa.removeEntry(54));qa.JQf("OnNetworkResumed")};qa.Uh=function(ka,za){ka=0;for(var La=a.mcc().length;ka<La;ka++){var Ia=a.mcc()[ka];qa.removeEntry(Ia)}za.context&&0<za.context.communicationErrorRetryCount&&(e.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),
qa.removeEntry(21));qa.JQf("OnWebMethodSuccess")};qa.Wn=function(ka,za){var La;ka=qa.azh(za.errors);for(var Ia=[],Ya=0,tb=ka.length;Ya<tb;++Ya){var Tb=ka[Ya];if(1===Tb.Type&&Tb.Appearance&32)Ia=qa.J2h(Tb,Ia);else if(za.gmj){e.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var va=(null===(La=za.context)||void 0===La?0:La.stopwatch)?za.context.stopwatch.Bc:-1;5E3>va?e.ULS.sendTraceTag(537170208,
0,50,"OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = {0}ms).",va):f.AFrameworkApplication.qgf()||qa.NCg(Tb,za.context.methodName)}va=[].concat(Hl(a.mcc()));for(var la=0,$a=Ia.length;la<$a;++la){var Ra=Ia[la];qa.fg(Ra,Tb);Array.remove(va,Ra)}Tb=0;for(la=va.length;Tb<la;++Tb)qa.removeEntry(va[Tb])}};qa.yEb=function(ka,za){ka=0;for(var La=za.errors.length;ka<La;++ka){var Ia=za.errors[ka];f.AFrameworkApplication.qgf()||
(E.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&e.ULS.sendTraceTag(537170207,0,15,"BusinessBar.OnNetworkDownEvent: adding NetworkDown BB"),qa.fg(54,Ia))}};qa.od=function(ka,za){qa.Zc(ka,za)};qa.Zc=function(){var ka=qa.$.ea;ka.rc||ka.xg()||(qa.HHd(),Array.clear(qa.MHc))};qa.vd=function(ka,za){qa.$.ea.xg()&&!za.YV||qa.j9e(za.YV)};qa.eFb=function(){var ka=qa.$.userOperationManager.$bc();ka&&ka.operation.flags&1&&qa.C2f()};qa.gxf=function(){qa.C2f()};qa.Hf=function(){qa.cxe();
qa.L2f()};qa.zN=function(){if(qa.$.t5&&qa.$.ea.xg()&&qa.$.ea.rc)if(qa.$.ea.isEditMode)qa.removeEntry(43),qa.removeEntry(12),qa.removeEntry(29),qa.removeEntry(30),qa.removeEntry(31),qa.removeEntry(32),qa.removeEntry(22),qa.removeEntry(55);else{var ka=qa.$.da.za(331);ka&&ka.aJa||qa.removeEntry(53);qa.removeEntry(5)}};qa.$=xa;qa.QYa=oa;qa.hLg();f.AFrameworkApplication.Jd&&f.AFrameworkApplication.Jd.mUc(qa);qa.Amb=Array(67);for(var Ea=0;67>Ea;Ea++)qa.Amb[Ea]=null;qa.qh=V.EcmaDateClock.instance;qa.iif=
qa.qh.Vb.getTime();oa&&(oa=xa.na,Ea=oa.rf,oa.Uy(qa.Wn),oa.zq(qa.Uh),oa.$mb(qa.wmc),oa.rYa(qa.wmc),E.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||(Ea.lFg(qa.yEb),Ea.knb(qa.tya)),xa.ea.hk(qa.od),xa.ea.Nt(qa.Hf),xa.dl(qa.vd),xa.cl(qa.Zc),xa.ea.E2(qa.zN),xa.userOperationManager.xq(qa.eFb),E.EwaSettings.ma(170)&&xa.ea.Yg.get(45)&&f.AFrameworkApplication.fa.ra("SupportsPolicies")||qa.a5e(),qa.j9e(R.c(xa)));xa.da.Ga(5,qa);return qa}function c(xa,oa,qa){qa=void 0===qa?null:qa;
var Ea=t.call(this)||this;Ea.wGa=xa;Ea.n6c=oa;Ea.data=qa;return Ea}y=b(0);var e=b(15),f=b(4),l=b(91),n=b(24),m=b(128),h=b(38),x=b(77),u;(function(xa){xa[xa.unableToRefreshLock=0]="unableToRefreshLock";xa[xa.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";xa[xa.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";xa[xa.workbookTooLarge=3]="workbookTooLarge";xa[xa.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";xa[xa.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";
xa[xa.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";xa[xa.unsupportedFeatures=7]="unsupportedFeatures";xa[xa.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";xa[xa.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";xa[xa.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";xa[xa.lastGenericStatusError=11]="lastGenericStatusError";xa[xa.scratchPadWarning=12]="scratchPadWarning";xa[xa.authenticationLost=13]=
"authenticationLost";xa[xa.odfCompatibilityIssues=14]="odfCompatibilityIssues";xa[xa.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";xa[xa.workbookIsIrmProtected=16]="workbookIsIrmProtected";xa[xa.biFeatureNotAvailable=17]="biFeatureNotAvailable";xa[xa.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";xa[xa.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";xa[xa.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";xa[xa.transientServerCommunicationFailures=
21]="transientServerCommunicationFailures";xa[xa.editAttemptInReadOnly=22]="editAttemptInReadOnly";xa[xa.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";xa[xa.unsupportedBrowser=24]="unsupportedBrowser";xa[xa.readOnlyPermissions=25]="readOnlyPermissions";xa[xa.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";xa[xa.policyWarningMessage=27]="policyWarningMessage";xa[xa.workingOnIt=28]="workingOnIt";xa[xa.passwordProtectedWorkbookLockedForEdit=29]=
"passwordProtectedWorkbookLockedForEdit";xa[xa.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";xa[xa.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";xa[xa.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";xa[xa.legacyConnectionsBB=33]="legacyConnectionsBB";xa[xa.groupedSlicersBB=34]="groupedSlicersBB";xa[xa.thirdPartyAddinDisabled=35]="thirdPartyAddinDisabled";xa[xa.financeLinkedEntityDisclaimerBar=36]="financeLinkedEntityDisclaimerBar";xa[xa.wacGdprNotice=
37]="wacGdprNotice";xa[xa.automaticSensitivityLabel=38]="automaticSensitivityLabel";xa[xa.recommendedSensitivityLabel=39]="recommendedSensitivityLabel";xa[xa.mandatorySensitivityLabel=40]="mandatorySensitivityLabel";xa[xa.localStorageDisabled=41]="localStorageDisabled";xa[xa.autoRefreshDisabled=42]="autoRefreshDisabled";xa[xa.corruptedFileRepaired=43]="corruptedFileRepaired";xa[xa.corruptedOdsFileRepaired=44]="corruptedOdsFileRepaired";xa[xa.minorVersionLimitReached=45]="minorVersionLimitReached";
xa[xa.sensitivityApplicationGenericError=46]="sensitivityApplicationGenericError";xa[xa.sensitivityApplicationTooLargeFileError=47]="sensitivityApplicationTooLargeFileError";xa[xa.sensitivityApplicationLabelNotSupportedError=48]="sensitivityApplicationLabelNotSupportedError";xa[xa.sensitivityApplicationLabelDisabledError=49]="sensitivityApplicationLabelDisabledError";xa[xa.sensitivityApplicationMandatoryConflictError=50]="sensitivityApplicationMandatoryConflictError";xa[xa.sensitivityApplicationMinorVersionLimitReachedError=
51]="sensitivityApplicationMinorVersionLimitReachedError";xa[xa.sensitivityApplicationSetLabelError=52]="sensitivityApplicationSetLabelError";xa[xa.promptEnableExternalLinks=53]="promptEnableExternalLinks";xa[xa.networkDown=54]="networkDown";xa[xa.defaultToViewDueToCogs=55]="defaultToViewDueToCogs";xa[xa.refreshLinkedEntityErrorBar=56]="refreshLinkedEntityErrorBar";xa[xa.promptEnableLinkedEntitiesUntrustedImages=57]="promptEnableLinkedEntitiesUntrustedImages";xa[xa.canvasHealth=58]="canvasHealth";
xa[xa.novModeDepreciation=59]="novModeDepreciation";xa[xa.mismatchedFileFormatConverted=60]="mismatchedFileFormatConverted";xa[xa.optimizeWorkbook=61]="optimizeWorkbook";xa[xa.novModePostDepreciation=62]="novModePostDepreciation";xa[xa.officeScriptsRunning=63]="officeScriptsRunning";xa[xa.powerQueryRefreshDataSourceNotSupported=64]="powerQueryRefreshDataSourceNotSupported";xa[xa.readOnlyPivotTable=65]="readOnlyPivotTable";xa[xa.powerQueryRefreshHostNotSupported=66]="powerQueryRefreshHostNotSupported";
xa[xa.count=67]="count"})(u||(u={}));Object(y.b)("EwaBusinessBarEntryType",u);var w=b(5),v=b(1243),t=Sys.EventArgs;Wl(c,t);Object(y.a)(c,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var z=b(1245),D=b(1244),A=b(1247),B=b(1246),N=b(1241),P=b(520),Q=b(51),M=b(589),ba=b(37),V=b(740),aa=b(30),E=b(1),G=b(10),I=b(22),R=b(53),Y=b(66),U=b(1047),ha=b(187);b.d(C,"a",function(){return a});var ta=x.a;Wl(a,ta);a.prototype.a5e=function(){aa.a.mr(this.$.ea.zF)&&this.Wn(this,new P.a(this.$.ea.zF,null,
!1,-1,-1,-1,-1,"",-1,"",-1))};a.prototype.rDg=function(xa){this.Pa.addHandler("bBarAttachedOrDetached",xa)};a.prototype.dispose=function(){if(this.$){var xa=this.$,oa=xa.na,qa=oa.rf;oa.Qz(this.Wn);oa.Ar(this.Uh);oa.tsc(this.wmc);oa.KHb(this.wmc);qa.YHb(this.tya);qa.raj(this.yEb);xa.ea.Dk(this.od);xa.ea.uv(this.Hf);xa.yl(this.vd);xa.tm(this.Zc);xa.ea.q0(this.zN);xa.userOperationManager.Ul(this.eFb);I.g(xa).pc.kl(this.gxf)}l.a.Ha(this.nU);this.$=this.nU=null;ta.prototype.dispose.call(this)};a.prototype.Tdi=
function(xa){switch(xa){case 4:case 5:case 11:case 53:case 7:case 36:return!0;case 57:return E.EwaSettings.ma(654);default:return!1}};a.prototype.fg=function(xa,oa,qa,Ea,ka){qa=void 0===qa?null:qa;Ea=void 0===Ea?null:Ea;ka=void 0===ka?null:ka;if(!this.$.isMobileMode||this.Tdi(xa))this.QYa&&!this.kC(xa)&&(E.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&e.ULS.sendTraceTag(537170254,0,50,"Adding entry to BB: {0}",Enum.toString(u,xa)),this.Amb[xa]=this.qh.Cea,this.nU.cE(xa,
oa,Ea,ka),this.Pa.raiseEvent("bBarAttachedOrDetached",new c(xa,!0,qa))),oa&&32===oa.Appearance&&Y.a(this.$).ud.pla(oa)};a.prototype.fyj=function(xa,oa,qa,Ea){e.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");N.a.initialize(xa,oa,qa,Ea);this.fg(37,null)};a.prototype.hxj=function(xa,oa,qa,Ea){v.a.initialize(xa,oa,qa,Ea);this.fg(38,null)};a.prototype.pzj=function(xa,oa,qa,Ea){D.a.initialize(xa,oa,qa,Ea);this.fg(39,null)};a.prototype.Eyj=function(xa,oa,qa,Ea){z.a.initialize(xa,
oa,qa,Ea);this.fg(40,null)};a.prototype.yzj=function(xa,oa,qa,Ea){B.a.initialize(xa,oa,qa,Ea);this.fg(51,null)};a.prototype.xzj=function(xa,oa,qa,Ea){A.a.initialize(xa,oa,qa,Ea);this.fg(52,null)};a.prototype.removeEntry=function(xa){this.QYa&&(E.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&e.ULS.sendTraceTag(537170251,0,50,"Removing entry from BB: {0}",Enum.toString(u,xa)),this.Amb[xa]=null,this.nU.removeEntry(xa)&&this.Pa.raiseEvent("bBarAttachedOrDetached",new c(xa,
!1)))};a.prototype.bMa=function(xa){return this.QYa?this.nU.bMa(xa):!1};a.prototype.kC=function(xa){return this.QYa?this.nU.kC(xa):!1};a.prototype.bDb=function(){e.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")};a.prototype.Glc=function(){e.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)};a.prototype.hLg=function(){var xa=b(1295).BusinessBarControl;
if(this.QYa&&!this.nU){I.g(this.$).pc.ql(this.gxf);var oa=document.getElementById(this.$.Mb+w.a.pue);this.nU=new xa(this.$,oa)}};a.prototype.HHd=function(){this.QYa&&this.nU.HHd()};a.prototype.JQf=function(xa){if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){var oa=this.qh.Cea;if(3E5<=oa-this.iif){this.iif=oa;for(var qa=0;67>qa;qa++){var Ea=this.Amb[qa];Ea&&(Ea=oa-Ea,3E5<=Ea&&e.ULS.sendTraceTag(537170241,0,50,"{0}: entry [{1}] was activated but not turned off for {2} Millis",
xa,Enum.toString(u,qa),Ea))}}}};a.prototype.azh=function(xa){for(var oa=[],qa=Gl(xa),Ea=qa.next();!Ea.done;Ea=qa.next())switch(Ea.value.MessageId){case -113742550:Ea=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941],(this.$.ea.isNamedObjectViewMode||aa.a.nh(xa,Ea))&&oa.push(-113742550)}return aa.a.JF(xa,oa)};a.prototype.J2h=function(xa,oa){switch(xa.MessageId){case 2113407564:for(var qa=aa.a.QZa([1821390342,-943219229,-502303485,1437034227]),Ea=0;Ea<qa.length;Ea++)qa[Ea].HelpTopicId=
xa.HelpTopicId,qa[Ea].HelpDescription=xa.HelpDescription,this.MHc.push(qa[Ea])}switch(xa.MessageId){case -395951567:this.fg(6,xa);break;case 1643490758:this.fg(4,xa);break;case -907264831:this.fg(5,xa);break;case 757111532:case 2113407564:this.fg(7,xa);break;case 2010656511:this.fg(15,xa);break;case 1321660996:this.$.P4c=!0;this.fg(8,xa);break;case 526339737:this.$.P4c=!0;this.fg(9,xa);break;case -407088521:this.fg(10,xa);break;case 1756116017:this.fg(14,xa);break;case -1703455218:this.fg(17,xa);
break;case 1393475740:this.fg(25,xa);break;case -949523941:this.fg(26,xa);break;case 1779381952:this.fg(42,xa);break;case 1421575100:this.fg(43,xa);break;case 613676060:this.fg(44,xa);break;case 1233668252:this.fg(60,xa);break;case 1911608588:xa=!!(this.$.Qd&64);!this.$.ea.xg()&&xa&&oa.push(29);break;case 1544494907:break;case -655555355:oa.push(this.Fqd()?1:0);break;case -1221382671:oa.push(2);break;case 1662282929:oa.push(3);break;case 104919273:this.$.ea.xg()||oa.push(30);break;case -689453604:xa=
!!(this.$.Qd&64);this.$.ea.l6e=!0;!this.$.ea.xg()&&xa&&oa.push(31);break;case 157762400:this.$.ea.Bgc=!0;!this.$.ea.xg()&&this.$.Qd&64&&!this.$.isEditMode&&oa.push(32);break;case -73730134:E.EwaSettings.isChangeGateEnabled("OfficeVSO:6079602_EnableEditingOfFilesWithLegacyConnections")&&!this.$.ea.xg()&&this.$.Qd&64&&oa.push(33);break;case -293349236:oa.push(64);break;case 1580811823:oa.push(66);break;case -37299333:break;case 136737622:oa.push(45);break;case -1780327030:this.fg(53,xa);break;case -113742550:this.fg(55,
xa);break;case -260312420:this.$.ea.xg()||oa.push(65);break;default:this.fg(11,xa)}return oa};a.prototype.S8h=function(){var xa=this;if(f.AFrameworkApplication.fa.ra("WildFireExcelBizBar")&&!U.a.Cod(U.a.ucd(1))&&(n.a.kp||n.a.Eh)){var oa=Q.GetServiceTaskFactory.create(this.$.da,155,this.$.la,1);ba.TaskExtensions.Ba(oa,function(){xa.fg(20,null)},this.la,3)}};a.prototype.P8h=function(){var xa=E.EwaSettings.ma(74),oa=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled",
!1),qa=E.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockStringIsEnabled",!1);G.HelperMethods.KQd(qa||oa,xa)&&(ha.a("NewBrowserSuggestionShown"),qa||m.a.Cv("NewBrowserSuggestionShown","true",7),this.fg(24,null))};a.prototype.l8h=function(xa){!xa&&M.b(this.$)&&this.fg(59,null)};a.prototype.m8h=function(xa){!xa&&M.c(this.$)&&this.fg(62,null)};a.prototype.j9e=function(xa){(!xa&&!this.$.printingEnabled||this.$.Yf.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&
(e.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.fg(16,null));this.S8h();this.P8h();this.cxe();this.L2f();this.l8h(xa);this.m8h(xa)};a.prototype.cxe=function(){this.$.workbookContext.Options&32768&&this.Wxj()};a.prototype.Wxj=function(){this.Amb[36]||this.fg(36,null)};a.prototype.L2f=function(){E.EwaSettings.ma(654)&&this.$.workbookContext.Options&524288&&this.fg(57,null)};a.prototype.h3f=function(xa,oa){this.fg(56,xa,null,oa)};a.prototype.lle=
function(xa,oa){var qa=null,Ea=null;qa=void 0===qa?null:qa;Ea=void 0===Ea?null:Ea;oa=void 0===oa?null:oa;this.nU.kC(xa)?this.nU.VNb(xa,oa):this.fg(xa,null,qa,Ea,oa)};a.prototype.C2f=function(){this.$.Qd&8&&this.fg(12,null)};a.prototype.Fqd=function(){var xa=this.$.da.za(38);return xa?xa.tokenExpired:!1};a.prototype.NCg=function(xa,oa){if(!this.kC(21)&&-1387426400!==xa.MessageId){e.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");var qa={};
qa.FailedMethod=oa;this.fg(21,xa,qa)}};a.mcc=function(){return a.Coe||(a.Coe=[0,1,2,3])};Ck.Object.defineProperties(a.prototype,{p7c:{configurable:!0,enumerable:!0,get:function(){return this.MHc}},domElement:{configurable:!0,enumerable:!0,get:function(){return this.nU?this.nU.domElement:null}}});a.Coe=null;Object(y.a)(a,"BusinessBarManager",x.a,[728,3,89])},1336:function(y,C,b){function a(w,v,t,z,D,A){this.cOc=null;this._id=w;this.JOc=v;this.Iog=void 0===D?null:D;this.Xib=z;this.hlb=void 0===A?null:
A;this.rpa=null;this.MXa=t;this.Glb=c.instance.aXh(v,w)}function c(){this.QEc=new m.a;this.OEc=new m.a;this.NEc=new m.a;this.cPg(this.QEc);this.bPg(this.OEc);this.aPg(this.NEc);this.RJc=new m.a;this.QJc=new m.a;this.PJc=new m.a;this.zRg(this.RJc);this.yRg(this.QJc);this.xRg(this.PJc);this.eGc=new m.a;this.vPg(this.eGc);this.vFa(this.eGc);this.vFa(this.NEc);this.vFa(this.OEc);this.vFa(this.QEc);this.vFa(this.QJc);this.vFa(this.RJc);this.vFa(this.PJc)}y=b(0);var e=b(15),f=b(82),l=b(1060),n=b(1047),
m=b(1308);c.prototype.aXh=function(w,v){switch(w){case 1:return this.p_h(v);case 2:return this.hHh(v)}return n.a.mxc?this.eGc:null};c.prototype.cPg=function(w){w.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)};c.prototype.bPg=function(w){w.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
w.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)};c.prototype.aPg=function(w){w.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)};c.prototype.zRg=function(w){w.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("InstallButton",
CommonUIStrings.l_WildFireBizBarInstallButtonText);w.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);w.add("OverlayBig","Get the Word app");w.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");w.add("OverlaySmallSplit1","Discover Word");w.add("OverlaySmallSplit2","designed for the iPad.");w.add("SkipButton","Skip for now")};c.prototype.vPg=function(w){w.add("Headline",
"Get the Office Online extension for Chrome");w.add("UseAppButton","Get the extension");w.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")};c.prototype.yRg=function(w){w.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);w.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);w.add("CallToAction",
CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);w.add("OverlayBig","Get the PowerPoint app");w.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");w.add("OverlaySmallSplit1","Discover PowerPoint");w.add("OverlaySmallSplit2","designed for the iPad.");w.add("SkipButton","Skip for now")};c.prototype.xRg=function(w){w.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("InstallButton",
CommonUIStrings.l_WildFireBizBarInstallButtonText);w.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)};c.prototype.vFa=function(w){w.add("Corporation","Microsoft Corporation")};c.prototype.p_h=function(w){switch(w){case 3:return this.RJc;case 2:return this.QJc;case 1:return this.PJc}return null};c.prototype.hHh=function(w){switch(w){case 3:return this.QEc;case 2:return this.OEc;case 1:return this.NEc}return null};
Ck.Object.defineProperties(c,{instance:{configurable:!0,enumerable:!0,get:function(){c.Ma||(c.Ma=new c);return c.Ma}}});c.Ma=null;Object(y.a)(c,"WildFireStringFactory",null,[]);var h=b(4),x=b(39),u=b(24);b.d(C,"a",function(){return a});a.prototype.P2c=function(){this.rpa=new l.a(this.title,this.message,null);this.rpa.addButton(this.xue,Object(f.a)(this,this.Htf,"onButtonOneClick"),"");this.MXa&&this.rpa.YBg(this.zue,Object(f.a)(this,this.Ktf,"onButtonTwoClick"));this.rpa.z$=Object(f.a)(this,this.IHe,
"dismissBar");this.rpa.image=3;this.rpa.id=16;this.rpa.closeable=!0};a.prototype.Htf=function(){this.MXa?this.Xai():this.qSj()};a.prototype.Ktf=function(){this.MXa&&this.bTi()};a.prototype.Xai=function(){e.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Xib&&this.hlb&&this.hlb();n.a.lMf(this._id,this.JOc)};a.prototype.bTi=function(){this.openUrl&&(e.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Xib&&this.hlb&&this.hlb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(n.a.Epe(this._id),
this.openUrl,0,!1))};a.prototype.qSj=function(){n.a.mxc?this.GRg():(e.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),n.a.SOd("BizBarClicked"),1!==this.JOc&&2!==this.JOc||n.a.hYg(this.openUrl,this.Xib,this._id,this.hlb))};a.prototype.GRg=function(){this.Xib?e.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):e.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");x.a.kV(h.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())};a.prototype.Yeh=function(){this.Xib?
e.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):e.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");n.a.SOd(n.a.Bxe)};a.prototype.IHe=function(){n.a.mxc?this.Yeh():(n.a.SOd(n.a.ucd(this._id)),e.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))};a.M4b=function(){var w=h.AFrameworkApplication.sa.Qa,v=new a(w.Sj,n.a.kcc(),8<u.a.b5a,1===w.oca,function(){return w.Gx},w.mUf());e.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return v};Ck.Object.defineProperties(a.prototype,
{title:{configurable:!0,enumerable:!0,get:function(){return this.Glb.oa("Headline")}},message:{configurable:!0,enumerable:!0,get:function(){return this.Glb.oa("CallToAction")}},zSj:{configurable:!0,enumerable:!0,get:function(){return this.MXa}},xue:{configurable:!0,enumerable:!0,get:function(){return this.MXa?this.Glb.oa("InstallButton"):this.Glb.oa("UseAppButton")}},zue:{configurable:!0,enumerable:!0,get:function(){return this.MXa?this.Glb.oa("OpenAppButton"):""}},CRg:{configurable:!0,enumerable:!0,
get:function(){return this.rpa}},openUrl:{configurable:!0,enumerable:!0,get:function(){this.cOc||(this.cOc=this.Iog());return this.cOc}}});Object(y.a)(a,"WildFireBusinessBar",null,[])},1382:function(y,C,b){function a(n,m,h,x,u,w){var v=l.call(this,n,m,h,x,u,w)||this;n={};m=(n.errorMessage=v.CLe,n.offerString=v.dsf,n);n=new f.a(!1,!1,!0);v.D2f?(n.ic=1,h={},m.helpLink=(h.type="AppLinkProps",h.id="helpLink",h.text=v.Tva,h.onExecute=function(){e.Redirect.showHelp(v.T6e)},h)):(n.ic=4,n.Ac(2,v.j8e));n.Ac(1,
v.PXb);n.Ne=v.id;h={};m=(h.id=v.id,h.dialogIcon=v.icon,h.bodyControls=m,h);n.initializeAndShow(v.Jm,Object(c.a)(v,v.C3i,"reactOICErrorDialogWithTrialHandler"),m);return v}b.r(C);b.d(C,"ReactOICErrorDialogWithTrial",function(){return a});y=b(0);var c=b(82);C=b(1248);var e=b(439),f=b(150),l=C.a;Wl(a,l);Object(y.a)(a,"ReactOICErrorDialogWithTrial",C.a,[])},1383:function(y,C,b){function a(l,n,m,h,x,u){l=f.call(this,l,n,m,h,x,u)||this;n=document.createElement("span");n.innerText=l.CLe;n.appendChild(document.createElement("br"));
n.appendChild(document.createElement("br"));m=document.createElement("span");m.innerText=l.dsf;n.appendChild(m);m=new e.StandardDialog;l.D2f?(m.ic=1,m.Xke(l.Tva,l.T6e)):(m.ic=4,m.Ac(2,l.j8e));m.Ac(1,l.PXb);m.Ne=l.id;m.Ak(l.Jm,null,l.icon,Object(c.a)(l,l.uqi,"legacyOICErrorDialogWithTrialHandler"),n);return l}b.r(C);b.d(C,"OICErrorDialogWithTrial",function(){return a});y=b(0);var c=b(82);C=b(1248);var e=b(135),f=C.a;Wl(a,f);Object(y.a)(a,"OICErrorDialogWithTrial",C.a,[])},1384:function(y,C,b){function a(){return c.call(this)||
this}b.r(C);b.d(C,"CheckRoamingRightsRequest",function(){return a});y=b(0);b=b(1250);var c=b.a;Wl(a,c);a.prototype.W3a=function(){return 2};a.prototype.Iaa=function(){return 1};Object(y.a)(a,"CheckRoamingRightsRequest",b.a,[])},1385:function(y,C,b){function a(){return c.call(this)||this}b.r(C);b.d(C,"GetRoamingLauncherRequest",function(){return a});y=b(0);b=b(1250);var c=b.a;Wl(a,c);a.prototype.W3a=function(){return 0};a.prototype.Iaa=function(){return 2};Object(y.a)(a,"GetRoamingLauncherRequest",
b.a,[])},1402:function(y,C,b){function a(h){this.cGc=!1;this.cXa=a.zec;this.NPc=this.QNc=0;this.platform=null;this.zug=h;this.oie=this.OPc=!1}function c(){this.state=this.callback=null;this.Rnd=!1}function e(){this.classId=0}y=b(0);var f=b(82),l=b(41);e.eIa=function(h){try{return l.a(h)}catch(x){}return null};Object(y.a)(e,"ARoamingAppsResponse",null,[]);Object(y.a)(c,"GetRoamingAppsLauncherContext",null,[]);var n=b(4),m=b(108);b.d(C,"a",function(){return a});a.prototype.DWg=function(){n.AFrameworkApplication.Tgc&&
this.roamingAppsAreEnabled&&!this.OPc&&!this.cGc&&(this.NPc=1,this.cGc=!0,this.Cej(),this.BQe())};a.prototype.Cej=function(){this.cXa=a.zec;this.QNc=0};a.prototype.getRoamingAppsLauncher=function(h,x,u){this.KSj?(h=new c,h.callback=x,h.state=u,h.Rnd=!0,this.GQe(h)):x(!1,"",u)};a.prototype.BQe=function(){var h=new (b(1384).CheckRoamingRightsRequest);h.RoamingApp=this.NPc;h.BaseDocQuerySignature=n.AFrameworkApplication.nj;h.execute(Object(f.a)(this,this.FWg,"checkUserRoamingRightsSucceeded"),Object(f.a)(this,
this.EWg,"checkUserRoamingRightsFailed"),null)};a.prototype.FWg=function(h){n.AFrameworkApplication.Ng||((h=e.eIa(h.data.ke))?this.UOd(h.HasRights):this.UOd(!1))};a.prototype.EWg=function(){if(!n.AFrameworkApplication.Ng)if(this.QNc>=a.Nxi)this.UOd(!1);else{var h=new m.a(2,1,this.cXa,Object(f.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);n.AFrameworkApplication.Pi.Qg(h);this.QNc++;this.cXa*=a.Vfj;this.cXa>a.Fof&&(this.cXa=a.Fof)}};a.prototype.UOd=function(h){this.oie=
h;this.OPc=!0;this.cGc=!1};a.prototype.retryCheckUserRoamingRights=function(){this.BQe()};a.prototype.GQe=function(h){var x=new (b(1385).GetRoamingLauncherRequest);x.RoamingApp=this.NPc;x.BaseDocQuerySignature=n.AFrameworkApplication.nj;x.execute(Object(f.a)(this,this.fVh,"getRoamingAppsLauncherSucceeded"),Object(f.a)(this,this.eVh,"getRoamingAppsLauncherFailed"),h)};a.prototype.fVh=function(h){if(!n.AFrameworkApplication.Ng){var x=e.eIa(h.data.ke);h=h.data.state;x?(this.platform=x.Platform,h.callback(!0,
x.Launcher,h.state)):h.callback(!1,"",h.state)}};a.prototype.eVh=function(h){if(!n.AFrameworkApplication.Ng){var x=h.data.state;5===h.data.status&&x.Rnd?(x.Rnd=!1,this.GQe(x)):x.callback(!1,"",x.state)}};Ck.Object.defineProperties(a.prototype,{roamingAppsAreEnabled:{configurable:!0,enumerable:!0,get:function(){return this.zug}},KSj:{configurable:!0,enumerable:!0,get:function(){return this.roamingAppsAreEnabled&&this.OPc?this.oie:!1}}});Ck.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,
get:function(){return a.aC||(a.aC=new a(n.AFrameworkApplication.BKg))}}});a.zec=1E3;a.Vfj=5;a.Fof=12E5;a.Nxi=5;a.aC=null;Object(y.a)(a,"RoamingAppsManager",null,[])},1437:function(y,C,b){function a(J){return Zk.call(this,J)||this}function c(J,ea,Wa){var Pb=this;this.ignorePrintArea=!1;this.dKj=function(){var Cc=wg.g(Pb.$).Ea;Pb.MQc=!0;Cc.Qxd()};this.VNi=function(){Pb.Rhd()};this.UNi=function(Cc,pd,wd){vd.ULS.sendTraceTag(537154272,0,10,"PrintCommandHandler:OnPageLayoutCommandFailure Method : {0} failed to execute",
wd);Pb.Rhd()};this.$=J;this.ea=J.ea;this.mia=ea;this.SN=new E(1,this.ignorePrintArea);this.nD=ea=new e(J,ea,Ud.AFrameworkApplication.Jd,Wa);this.$.da.Ga(418,ea);this.OHf=new A(J);this.$.da.Ga(384,this);this.MQc=!1}function e(J,ea,Wa,Pb){var Cc=this;this.activeCell=this.selectedRange=this.zg=this.graphServiceEndpoint=null;this.a0=0;this.Tm=this.qv=null;this.AH=new D;this.yk=new D;this.Sba=0;this.w7a=null;this.zMb=!1;this.U2a=this.xFb=null;this.ppd=!1;this.v6a=this.Azb=this.Ygc=!0;this.tma=this.Lya=
this.cNa=null;this.yyb=!1;this.t7a=null;this.O5a=this.iLc=!1;this.Ezd=function(pd){if(!(pd&&pd.data&&pd.data.ke&&pd.data.responseHeaders&&pd.data.ke.length)){var wd=pd?pd.data?pd.data.ke?pd.data.responseHeaders?pd.data.ke.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";Cc.zg&&(pd=Cc.Vza(Ne.a.instance.ga(1190)),Cc.Xna(pd,0));vd.ULS.sendTraceTag(593266765,
0,10,"PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",wd);Cc.JJd&&(pd=Object(Ch.a)(new Vg.a,{extendedProperties:new Map}),pd.extendedProperties.set("InvalidParameterName",wd),lh.Health.instance.recordQosError(Sj.a.QHf,[Ic.a.RHf],!1,!0,!0,!1,pd))}else if(0<Cc.Sba&&pd.data.id===Cc.Sba){if(pd.data.responseHeaders["Content-Type"]&&(zh.a.contains(pd.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||zh.a.contains(pd.data.responseHeaders["Content-Type"].toString(),
"text/plain",!0))){vd.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var ue=null;zh.a.contains(pd.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(ue=Cc.m4g(pd));wd={};Cc.WDb(wd,null,null,ue);pd.data.responseHeaders["Total-Pdf-PageCount"]?(ue=parseInt(pd.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),Cc.yyb||(Cc.IEd>=ue?Cc.tma=ue:Cc.yyb=!0),Cc.v6a&&Cc.zg&&Cc.zg.setPageRangeSettings(ue,Cc.IEd,Cc.yyb,Cc.Lya,
Cc.tma)):vd.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else wd=nj.a.ni(pd.data.ke),uh.a.a$(wd.Errors)||yd.a(Cc.$).ud.bE(wd.Errors[0].MessageId),Cc.f5i(wd.Errors),Cc.zg&&(ue=Cc.Vza(wd.Errors[0].Description),-1831476778===wd.Errors[0].MessageId?(vd.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),Cc.Xna(ue,0,Ne.a.instance.ga(1193))):Cc.Xna(ue,
0)),297284985===wd.Errors[0].MessageId?vd.ULS.sendTraceTag(570716892,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: {0}",wd.Errors[0].MessageId):vd.ULS.sendTraceTag(593266763,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",wd.Errors[0].MessageId);pd=pd.data.state;pd.Q8c(wd,pd.userContext,pd.methodName)}};this.Dzd=function(pd){if(0<Cc.Sba&&pd.data.id===Cc.Sba){var wd=rj.a.ig(pd.data);Cc.zg&&Cc.Xna(Cc.Vza(wd[0].Description),
1);vd.ULS.sendTraceTag(593266762,0,15,"PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [{0}]",uh.a.Tc(wd));wd=pd.data.state;wd.paa(pd,wd.userContext,wd.methodName);Cc.$.userOperationManager.Yka.operation.Gna(function(){return Cc.zMb})}};this.bHi=function(pd,wd,ue){pd.Errors&&0<pd.Errors.length&&Cc.zg?(uh.a.a$(pd.Errors)||yd.a(Cc.$).ud.bE(pd.Errors[0].MessageId),Cc.Xna(Cc.Vza(pd.Errors[0].Description),0),vd.ULS.sendTraceTag(537154254,0,50,"PrintPreviewManager: Failed to convert workbook. Error message Id: {0}",
pd.Errors[0].MessageId)):(vd.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),Cc.WDb(pd,wd,ue,null))};this.aHi=function(pd){pd=rj.a.ig(pd.data);Cc.zg&&Cc.Xna(Cc.Vza(pd[0].Description),1);vd.ULS.sendTraceTag(537154252,0,15,"PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [{0}]",uh.a.Tc(pd));Cc.$.userOperationManager.Yka.operation.Gna(function(){return Cc.zMb})};this.lzf=function(pd,wd){if(wd)switch(wd.c_i){case 1:if(Cc.yk&&
Cc.U2a)switch(pd=Cc.U2a.Bc,Cc.U2a.stop(),Cc.U2a=null,Cc.yk.Nv){case 1:Cc.E_c(pd,4800,"ActiveSheet");break;case 0:Cc.E_c(pd,6100,"CurrentSelection");break;case 2:Cc.E_c(pd,7500,"EntireWorkbook")}break;case 0:Cc.xFb&&(pd=Cc.xFb.Bc,Cc.xFb.stop(),2400<pd&&(wd=Object(Ch.a)(new Vg.a,{extendedProperties:new Map}),wd.extendedProperties.set("PaneLoadTime",pd.toString()),lh.Health.instance.recordQosError(Sj.a.bBj,[Ic.a.k4f],!1,!0,!0,!1,wd)),Cc.qv.jci(function(ue){Cc.fzj(ue)}))}};this.Kz=function(pd,wd){(1===
wd.Dp&&Cc.cNa===wd.Pf||2===wd.Dp)&&Cc.vKd()};this.$=J;this.mia=ea;this.j3=Wa;this.hyd=Pb;this.JJd=Zh.HelperMethods.g_;this.Pa=new Kg.a;this.IEd=this.$.ya.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.Rwj();this.b$h();this.Edi=this.YVg();this.opd=nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1);if(this.isUniversalPrintEnabled=!!Pb&&Pb.C5a()&&nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.Yf.get(116))this.graphServiceEndpoint=
this.$.ya.GraphServiceEndpoint}function f(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}function l(){this.onBackToSheet=null}function n(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}function m(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=
this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}function h(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}function x(J,ea,Wa,Pb,Cc,pd){var wd=w.call(this,Cc)||this;wd.Pd=!1;wd.c4f=!1;wd.IAd=function(ue){wd.nD.IAd(ue)};wd.UAd=function(ue){wd.nD.UAd(ue)};wd.APi=function(){vd.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};
wd.zPi=function(ue){ue=rj.a.ig(ue.data);vd.ULS.sendTraceTag(537154189,0,10,"PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: {0}.",uh.a.Tc(ue))};wd.Kz=function(ue,Je){2===Je.Dp?wd.pv.clear():1===Je.Dp&&wd.pv&&wd.pv.contains(Je.Pf)&&(vd.ULS.sendTraceTag(537154188,0,50,"PrintSettingsManager.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",Tj.a(Je.Pf.operation.operationName),Je.Pf.dequeueUtcTime.getTime()-Je.Pf.enqueueUtcTime.getTime()),
wd.pv.remove(Je.Pf))};wd.nD=J;wd.SN=Wa;wd.$=ea;wd.sheetName=Pb;wd.locale=window.navigator.browserLanguage||window.navigator.language||wd.$.ya.UICultureTag;wd.JUi=wd.n2g();wd.$.userOperationManager.xq(wd.Kz);wd.pv=new Vd.a;wd.isUniversalPrintEnabled=pd;return wd}function u(J,ea){this.sheetPrintOptions=this.sheetName=null;this.sheetName=J;this.sheetPrintOptions=ea}function w(J){this.aCi=[.75,.75,.7,.7,.3,.3];this.OAi=[.75,.75,.25,.25,.3,.3];this.rVj=[1,1,1,1,.5,.5];this.nae=this.gfe=this.Ece=this.nce=
this.Nie=this.N6=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Wm=J;this.s$h();this.z$h()}function v(){this.printSettingOptionKey=0;this.printSettingOptionText=null}function t(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}function z(){this.marginValue=this.printSettingOption=null}function D(){this.margin=this.w0=this.Cca=this.orientation=this.Nv=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.w1a=!1;this.NoColor=null}function A(J){var ea=
this;this.ribbonCommandInfo=this.kFb=null;this.kKj=function(Wa,Pb,Cc){Pb=!!Wa&&!!Wa.RequestTelemetryData;wg.g(ea.$).Ii&&wg.g(ea.$).Ii.qla(ea.DKa.oa(ea.ribbonCommandInfo.command),Wa.StateId,Pb?Wa.RequestTelemetryData.EcsOperationDuration:0,Pb?Wa.RequestTelemetryData.EcsRequestDuration:0,Pb?Wa.RequestTelemetryData.WfeRequestDuration:0);Zh.HelperMethods.g_&&ea.TVg(Cc)};this.$=J;this.DKa=new fl.a;this.Hva=new fl.a;this.Hva.add(78661008,12);this.Hva.add(275604654,13);this.Hva.add(-13332329,14);this.Hva.add(-837651977,
9);this.Hva.add(-1778266776,10);this.Hva.add(845325699,11);this.opd=nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1)}function B(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}function N(){this.Max=this.Min=this.Index=0}function P(){this.Col=this.Row=null}function Q(J){this.sheetName=null;this.sheetName=J}function M(J){this.sheetName=null;this.sheetName=J}function ba(J){this.sharedSheetCell=null;this.sharedSheetCell=J}function V(J){this.sharedSheetCell=
null;this.sharedSheetCell=J}function aa(J,ea){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=J;this.addToPrintArea=ea}function E(J,ea){this.O6=0;this.v7d=!1;this.Nv=J;this.ignorePrintArea=ea}function G(J,ea,Wa,Pb,Cc,pd,wd,ue){var Je=ta.call(this,J,ea,Wa,Pb,Cc,nf.EwaSettings.ma(398))||this;Je.Sca=null;Je.haa=null;Je.eec=null;Je.nSd=!1;Je.nxa=null;Je.G$a=null;Je.Nya=null;Je.Yza=null;Je.g5a=null;Je.fza=1;Je.Gma=1;Je.$_=0;Je.O6=1;Je.vGb=!1;Je.ps=null;Je.lJb=0;Je.kJb=0;Je.Oya=null;Je.Zza=
null;Je.selectedRange=null;Je.a0=0;Je.h9a=function(){Je.a0++;Je.O6=Je.hZc();Je.v7c(Je.haa.checked?!0:!1);Je.E7&&(Je.eec.disabled=Je.ow.checked);Je.NNd(Je.haa.checked?!0:!1);vd.ULS.sendTraceTag(595194762,0,50,"PdfPrintDialog:OnChangeWhatToPrint What to print option changed to {0}",Je.O6.toString());return!0};Je.Wtf=function(){Je.a0++;Je.vGb=Je.g5a.checked;vd.ULS.sendTraceTag(537154311,0,50,"PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to {0}",Je.vGb.toString())};Je.Emc=
function(){Je.a0++;Je.fza=Je.bve();vd.ULS.sendTraceTag(595079450,0,50,"PdfPrintDialog:OnChangeOrienation orientation option changed to {0}",Je.fza.toString());return!0};Je.Xtf=function(){Je.a0++;var tg=Je.Gma;Je.Gma=G.paperSizeOptions[Je.Nya.selectedIndex];vd.ULS.sendTraceTag(595079449,0,50,"PdfPrintDialog:OnChangePaperSize paperSize option changed from {0} to {1}",tg.toString(),Je.Gma.toString());return!0};Je.Ytf=function(){Je.a0++;var tg=Je.$_;Je.$_=G.scalingOptions[Je.Yza.selectedIndex];2===Je.$_?
(Je.lJb=1,Je.kJb=0):3===Je.$_?(Je.lJb=0,Je.kJb=1):1===Je.$_&&(Je.lJb=1,Je.kJb=1);vd.ULS.sendTraceTag(595079448,0,50,"PdfPrintDialog:OnChangeScaling scaling option changed from {0} to {1}",tg.toString(),Je.$_.toString());return!0};Je.Ezd=function(tg){if(tg&&tg.data&&tg.data.ke&&tg.data.responseHeaders&&tg.data.ke.length){if(tg.data.responseHeaders["Content-Type"]&&zh.a.contains(tg.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)){vd.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully");
var oh={};Je.WDb(oh,null,null)}else oh=nj.a.ni(tg.data.ke),vd.ULS.sendTraceTag(51676165,0,15,"PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",oh.Errors[0].MessageId);tg=tg.data.state;tg.Q8c(oh,tg.userContext,tg.methodName)}else vd.ULS.sendTraceTag(51676163,0,10,"PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",tg?tg.data?tg.data.ke?tg.data.responseHeaders?tg.data.ke.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":
"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs")};Je.Dzd=function(tg){var oh=rj.a.ig(tg.data);vd.ULS.sendTraceTag(51676166,0,15,"PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [{0}]",uh.a.Tc(oh));oh=tg.data.state;oh.paa(tg,oh.userContext,oh.methodName)};Je.WDb=function(tg){tg.Errors&&0<tg.Errors.length?vd.ULS.sendTraceTag(51499295,0,50,"PdfPrintDialog: Failed to convert workbook. Error message Id: {0}",
tg.Errors[0].MessageId):(6===Je.Sd.Ze&&Ud.AFrameworkApplication.sa.Qe.fk(wg.g(Je.$).qVf),vd.ULS.shipAssertTag(537154309,0,!!Je.$.xa.qa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),Je.$.xa.qa&&Je.mia.d3f(Je.AHa()))};Je.mia=pd;Je.activeCell=Je.$.qa.activeCell.toString();Je.Tm.SelectedRanges&&Je.Tm.SelectedRanges.Ranges&&0<Je.Tm.SelectedRanges.Ranges.length&&Je.Tm.SelectedRanges.Ranges[0]&&(Je.selectedRange=ze.B(Je.Tm.SelectedRanges.Ranges[0]).toString());
Je.sheetName=wd;Je.SN=ue;Je.rCd={};J=0;for(ea=G.paperSizeOptions.length;J<ea;++J)Je.rCd[G.paperSizeOptions[J].toString()]=J;Je.locale=window.navigator.browserLanguage||window.navigator.language||Je.$.ya.UICultureTag;Je.E7=nf.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog");return Je}function I(J,ea){this.printSettings=this.sheetName=null;this.sheetName=J;this.printSettings=ea}function R(J,ea,Wa,Pb,Cc){J=ta.call(this,J,ea,Wa,Pb,Cc)||this;J.Tsb=null;return J}
function Y(J,ea,Wa,Pb,Cc,pd,wd,ue){ue=J.Na(1,void 0===ue?null:ue);ue.sheetName=ea;ue.locale=Wa;return Pc.i(J,"GetPrintSettings",ue,Pb,Cc,pd,wd,4)}function U(J,ea,Wa,Pb,Cc,pd,wd){wd=J.Na(1,void 0===wd?null:wd);wd.ConvertInParameters=ea;return Pc.i(J,"ConvertWorkbookToPrintPdf",wd,Wa,Pb,Cc,pd,4)}function ha(J,ea,Wa,Pb,Cc,pd,wd,ue){ue=J.Na(9,void 0===ue?null:ue);ue.sheetName=ea;ue.printSettings=Wa;return Pc.i(J,"SetSheetPrintSettings",ue,Pb,Cc,pd,wd,0)}function ta(J,ea,Wa,Pb,Cc,pd){J=Ii.call(this,J,
ea,Wa,void 0===pd?!1:pd)||this;J.ow=null;J.Tm=Pb;J.cRb=Cc;return J}function xa(){this.B4d=this.tb=null}function oa(J,ea,Wa,Pb,Cc,pd,wd,ue,Je,tg){this.wXb=null;this.Mmg=J;this.akb=ea;this.ENc=Wa;this.kqg=Pb;this.Qqg=Cc;this.VOc=new Sf.a(Object(vf.a)(this,this.DTh,"getProbeResults"));this.kVa=pd;this.C$d=Je;this.ewg=wd;this.Rqg=ue;this.Yqg=tg}function qa(J,ea){this.D6f=J;this.GSa=ea}function Ea(J){this.isEnabled=Boolean.parse(J.DirectPrintIsEnabled||"false");Boolean.parse(J.DirectPrintProbeIsEnabled||
"false");this.Ihi=Boolean.parse(J.DirectPrintEnabledForInternetExplorer||"false");this.FSa=(J.DirectPrintSupportedMimeTypes||"").split(Ea.Z5c);this.GSa=(J.DirectPrintSupportedPlugins||"").split(Ea.Z5c);this.a7h=(J.DirectPrintImmersivePreviewPlugins||"").split(Ea.Z5c);this.Wbf=Boolean.parse(J.DirectPrintEnabledForEdge||"false");this.tei=Boolean.parse(J.ChromePrintLayoutFixIsEnabled||"false");this.RWg=parseInt(J.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Wvd=14;this.vpf=14394;if(J=J.DirectPrintMinimalSupportedEdgeVersion){var ea=
J.split(".");2===ea.length?(this.Wvd=parseInt(ea[0]),this.vpf=parseInt(ea[1])):vd.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",J)}else vd.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}function ka(J,ea,Wa,Pb,Cc){Wa=void 0===Wa?null:Wa;Pb=void 0===Pb?!0:Pb;Cc=void 0===Cc?!1:Cc;ea=Mg.call(this,J,!0,!(ka.ETa&&Pb),new Hg(J,ea),Wa,Cc)||this;ka.ETa=ka.ETa&&Pb;if(ka.ETa){Pb=
document.createElement("iframe");Cc=null;var pd=ea.leh;Pb.name="pdfObjectFrame";Pb.id="pdfObjectIFrame";if(Wa&&0<Wa.count){var wd=zg.a.lfd(J,Wa);J=zg.a.dId(J,Wa);Cc=document.createElement("form");Cc.id="printPreviewPostForm";Cc.method="POST";Cc.target=Pb.name;Cc.action=J;J=Gl(wd);for(Wa=J.next();!Wa.done;Wa=J.next())Wa=Wa.value,wd=document.createElement("input"),wd.type="hidden",wd.name=Wa.key,wd.value=Wa.value,Cc.appendChild(wd)}else Pb.src=J;pd.appendChild(Pb);Cc&&(pd.appendChild(Cc),Cc.submit());
Sys.UI.DomElement.addCssClass(Pb,"DirectPrintPdfObjectHidden");Fa.a.yh(Pb,Fa.a.eC,Fa.a.ik)}return ea}function za(J){this.rP=J}function La(J,ea,Wa,Pb){Pb=void 0===Pb?null:Pb;var Cc=bj.call(this)||this;Cc.dqa=null;Cc.cm=null;Cc.vP=null;Cc.cn=[];Cc.SUb=ea;Cc.rP=J;Cc.apg=Wa;Cc.dWb=Pb;Cc.Flb=new $i.a("LoadResource","LoadPrintablePdf");return Cc}function Ia(J){var ea=Ni.call(this)||this;ea.$=J;ea.Tb();return ea}function Ya(J){this.stopwatch=this.l_b=this.Azc=this.BUd=null;this.C7f=0;this.$=J;(this.BWc=
nf.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC"))||J.da.Ga(322,this)}function tb(J){this.uhe=0;this.D7f=J}function Tb(J,ea,Wa,Pb,Cc,pd,wd){this.title=J;this.body=ea;this.VZi=Wa;this.primaryButtonAction=Pb;this.secondaryButtonAction=pd;this.RVf=Cc;this.targetObject=wd}function va(J){var ea=Lh.call(this)||this;ea.$=J;ea.Tb();return ea}function la(J){this.$=J;J.da.Ga(309,this)}function $a(J){var ea=Dh.call(this,J)||this;ea.Yo=null;ea.stopwatch=null;ea.JAi=function(Wa){if(1===Wa)ea.$.Ka.Wb(new Gi.a(-2050946363,
pb.a.Sb,2,8,null)).continueWith(function(Cc){ea.Yo.setResult(!xe.a(Cc)&&Cc.result)}),Wa="Yes";else{var Pb=2===Wa;ea.Yo.setResult(Pb);Wa=2===Wa?"No":"Close";Pb&&ea.KZi()}ea.Qti(Wa);ea.hide()};return ea}function Ra(){}function eb(J){return ig.call(this,J)||this}function mb(J){this.Ci=J}function Pa(J){var ea=tf.call(this)||this;ea.$=J;ea.Tb();return ea}function Da(J){J.da.Ga(446,this)}function Ta(J){return Qe.call(this,J)||this}function Sa(J,ea){var Wa=this;this.sortOptions=this.iyc=this.selectedRange=
null;this.rbf=!1;this.activeCell=this.$f=this.Fb=this.Fc=null;this.OQi=function(Pb,Cc){Rj.b(Pb,-901005882)?(yd.a(Wa.$).ud.bE(-901005882),Wa.iFd(Cc)):Wa.j6e(Pb)?Wa.X4e(Pb.Errors[0]):!Rj.a(Pb)&&Pb.Result&&(Wa.sortOptions=Cc,Wa.iyc=ze.D(Pb.Result.ActualSortRange),Wa.Yif=Wa.ha().jia,Wa.rbf||(Wa.selectedRange=Wa.ha().ta.qd,Wa.selectedRange.equals(Wa.iyc)||Wa.Fzj()),Wa.sortOptions&&Wa.sortOptions.ActiveCell&&(Pb=Wa.sortOptions.ActiveCell,Pb=new Kj.Range(Pb.FirstRow+1,Pb.FirstColumn+1,Pb.FirstRow+1,Pb.FirstColumn+
1,!0,!1),Wa.mL(Pb),Wa.nWd(Pb)))};this.onContentReady=function(){Wa.VMf(!1);var Pb=Wa.ha();Pb.ta.Hg&&Pb.ta.qd.equals(Wa.iyc)&&Pb.updateSelection(Wa.selectedRange,Pb.ta.activeCell,0,void 0,void 0,void 0,!0)};this.rKi=function(Pb,Cc){Pb&&!uh.a.oh(Pb.Errors)&&Wa.Fc&&(Wa.Fc.To=Pb.Result,Wa.dKb(),Wa.applyPivotSort(Cc))};this.qKi=function(){};this.ORi=function(Pb,Cc){Cc&&Cc.zIj&&nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(Pb=Jk.d(Wa.$.xa.qa),
Wa.AIj(new rk.a(ze.B(Cc),Pb)))};this.$=J;this.Yif="";this.namedSheetViewPublic=ea;this.gridView=wg.g(this.$);this.$.Pb.Zg("LoadResource","LoadDialogControlsStopwatch")}function Cb(J,ea,Wa,Pb,Cc,pd,wd){wd=J.Na(41,void 0===wd?null:wd);wd.filterRange=ea;return Pc.i(J,"ReapplyAutoFilter",wd,Wa,Pb,Cc,pd,0)}function cc(J,ea,Wa,Pb,Cc,pd,wd){wd=J.Na(41,void 0===wd?null:wd);wd.options=ea;return Pc.i(J,"Sort",wd,Wa,Pb,Cc,pd,0)}function nc(J){this.filterRange=null;this.filterRange=J}function Nb(J){this.selection=
null;this.selection=J}function nb(J,ea,Wa,Pb){var Cc=Jc.call(this,J)||this;Cc.AQd=!1;Cc.Pfc=!1;Cc.H6=[];Cc.mci=function(pd,wd){var ue=Cc.a6g(pd);Cc.ALa(214,function(Je,tg,oh){return Pc.H(Cc.$.na.va,ue,Cc.u_a(Je,Cc.CEh(wd)),Cc.sU(tg),oh,null)},16,!0)};Cc.lci=function(pd,wd,ue){pd=Pc.G(Cc.$.na.va,wd,Cc.kFh(wd,ue),Cc.HKi,null,pd);Cc.H6.push(pd)};Cc.HKi=function(){vd.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");
Cc.B6b(nb.Yqb())};Cc.U5c=function(pd,wd){if(1===pd){pd=wd.sortRangeType;var ue={};ue.SortOptions=wd.sortOptions;ue.ShouldRestoreSelection=Cc.AQd;ue.SelectedRange=Cc.selectedRange;ue.OriginalActiveCell=Cc.Toc;ue.TopCellAddress=Cc.$Sa;ue.ShouldPromptNamedSheetViewTeachingDialog=nf.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?0===pd||3===pd:!1;if(!nf.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")&&Cc.zvj(pd)){var Je=
Cc.$;Cc.namedSheetViewPublic.GAa().continueWith(function(tg){tg.result&&nb.YJf(Je,ue)})}else nb.YJf(Cc.$,ue)}else Cc.AQd&&Cc.Moa(Cc.selectedRange,Cc.Toc)};Cc.A5h=function(pd,wd){Cc.AQd=!0;Cc.Moa(pd,wd)};Cc.getColorName=function(pd){return rl.a.fKa(ml.a.fH(pd))};vd.ULS.shipAssertTag(529105669,0,!!ea.ActiveCell);vd.ULS.shipAssertTag(529105668,0,!!ea.SelectedRange);vd.ULS.shipAssertTag(529105667,0,ze.D(ea.SelectedRange).contains(ze.C(ea.ActiveCell)));vd.ULS.shipAssertTag(529105666,0,zh.a.equals(ea.SelectedRange.SheetName,
ea.ActiveCell.SheetName,!0));nf.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(Cc.Rbb=new ac.a(J,gb.a.kah,function(){return Cc.Pfc},1));Cc.selectedRange=ea.SelectedRange;Cc.Toc=ea.ActiveCell;Cc.vTg=ea.ExpandSelection;Cc.namedSheetViewPublic=Wa;Cc.$Sa=Pb;Cc.initializeAndShow(Ne.a.instance.ga(182),Cc.U5c,Cc.qta(ea));return Cc}function db(J,ea){J=ua.call(this,J,ea)||this;J.BCb=J.Ubd();J.Dr();return J}function Bb(J,ea){var Wa=J.SortRange;J=J.SortTopToBottom?Wa.LastColumn-
Wa.FirstColumn:Wa.LastRow-Wa.FirstRow;return 0<=ea&&ea<=J}function zc(J,ea){if(!J.SortColumnInfoItems)return vd.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;for(var Wa=new Vd.a,Pb=Gl(J.SortColumnInfoItems),Cc=Pb.next();!Cc.done;Cc=Pb.next()){Cc=Cc.value;if(!Bb(J,Cc.ColumnOffset))return vd.ULS.sendTraceTag(537151617,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: offset [{0}] is out of bounds. sort range: {1}",Cc.ColumnOffset,
J.SortRange),!1;if(!Cc.Name)return vd.ULS.sendTraceTag(537151616,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [{0}]",Cc.ColumnOffset),!1;if(Cc.CellColors&&!Cc.CellColors.length)return vd.ULS.sendTraceTag(537151587,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [{0}]",Cc.CellColors.length),!1;if(Cc.TextColors&&!Cc.TextColors.length)return vd.ULS.sendTraceTag(537151586,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [{0}]",
Cc.TextColors.length),!1;if(Cc.Icons&&!Cc.Icons.length)return vd.ULS.sendTraceTag(537151585,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [{0}]",Cc.Icons.length),!1;Wa.add(Cc.ColumnOffset)}if(J.SortConditions)for(Pb=Gl(J.SortConditions),Cc=Pb.next();!Cc.done;Cc=Pb.next())if(Cc=Cc.value,!Wa.contains(Cc.RowColOffset))return vd.ULS.shipAssertTag(537151584,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [{0}]",Cc.RowColOffset),
!1;if(J.HeaderColumnInfoItems){if(J.HeaderColumnInfoItems.length!==J.SortColumnInfoItems.length)return vd.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(Wa=0;Wa<J.HeaderColumnInfoItems.length;++Wa){Pb=J.HeaderColumnInfoItems[Wa];if(ea&&Pb.ColumnOffset!==J.SortColumnInfoItems[Wa].ColumnOffset)return vd.ULS.shipAssertTag(537151582,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),
!1;if(Pb.CellColors&&1<Pb.CellColors.length)return vd.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(Pb.TextColors&&1<Pb.TextColors.length)return vd.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(Pb.Icons&&1<Pb.Icons.length)return vd.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),
!1}}return!0}function Eb(J){if(!J.SortConditions)return!0;for(var ea=Gl(J.SortConditions),Wa=ea.next();!Wa.done;Wa=ea.next()){Wa=Wa.value;if(!Bb(J,Wa.RowColOffset))return vd.ULS.sendTraceTag(537151620,0,10,"SharedSortInfoResultExtension.VerifySortConditions: offset [{0}] is out of bounds. sort range: {1}",Wa.RowColOffset,J.SortRange),!1;if(1===Wa.SortConditionType&&Wa.FillGradient&&!Rb.isValid(Wa.FillGradient))return vd.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),
!1}return!0}function Ja(J){return J.SortRange?4===J.SortRangeType?(vd.ULS.sendTraceTag(537151622,0,10,"SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: {0}",J.SortRangeType),!1):2===J.SortRangeType&&J.SortTopToBottom&&(null==J.HeaderRowSize||0>J.HeaderRowSize)?(vd.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(vd.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),
!1)}function Rb(){}function yc(J,ea,Wa,Pb){new Sys.UI.Point(J,ea);new Sys.UI.Point(Wa,Pb)}function qd(){}function bc(J,ea,Wa,Pb){J=J.HeaderColumnInfo;return Pb||J?2===ea&&Wa?J.CellColors&&1!==J.CellColors.length?(vd.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):J.TextColors&&1!==J.TextColors.length?(vd.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),
!1):J.Icons&&1!==J.Icons.length?(vd.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:J?(vd.ULS.sendTraceTag(537151627,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize{0} == 0.",Wa),!1):!0:!0}function Vb(J,ea){J=J.ColumnInfo;switch(ea){case 1:return J.CellColors&&
J.CellColors.length?!0:(vd.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return J.TextColors&&J.TextColors.length?!0:(vd.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return J.Icons&&J.Icons.length?
!0:(vd.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return vd.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}}function mc(J){var ea=this;this.rw=function(Wa){switch(Wa){case 0:ea.FNa("Cancel");break;case 1:ea.FNa("Expand and sort");ea.OQe(!0);break;case 2:ea.FNa("Just sort"),
ea.OQe(!1)}};this.OQe=J}function sb(J,ea,Wa,Pb,Cc,pd){var wd=J.Na(41);wd.filterRange=ea;return Pc.i(J,"ToggleAutoFilter",wd,Wa,Pb,Cc,pd,0)}function Yb(J){this.options=null;this.options=J}function Hb(J){return ql.call(this,J)||this}function sc(J,ea,Wa){var Pb=el.call(this)||this;Pb.sve=!1;Pb.rve=!1;Pb.tFi=function(){Pb.sve=!0;Pb.h2f()};Pb.$=J;Pb.Ta=ea;Pb.VJ=Wa;yd.a(Pb.$).dHd(new dl.a(Xg.a.Wag,Xg.a.idle,sc.qVg),new ik.a(Xg.a.Pye,Xg.a.J_,null,Xg.a.VO,Xg.a.idle));return Pb}function zb(J){var ea=jk.call(this,
J,Ne.a.instance.ga(1250))||this;ea.textBox=null;ea.SQa=null;ea.qTa=null;ea.cDf=function(){var Wa=ea.$;ea.Ut();var Pb=new vc(Wa,1253,1254,1255,function(Cc,pd,wd){var ue=Wa.na.va.hc(),Je=Wa.na.va;ue=Je.Na(1,ue);return Pc.i(Je,"UnshareForm",ue,Cc,pd,wd,null,0)},16);Pb.initialize();Pb.Af()};return ea}function vc(J,ea,Wa,Pb,Cc,pd){pd=void 0===pd?0:pd;J=Gk.call(this,J,Ne.a.instance.ga(ea),!1)||this;J.message=Wa;J.cEi=Pb;J.MZd=Cc;J.operationFlags=pd;return J}function ad(J,ea,Wa){var Pb=ja.call(this,J,new Sys.UI.Point(ad.ech,
ad.Hbh),Ne.a.instance.ga(ea?1248:1247))||this;Pb.C0a=null;Pb.aLc=!1;Pb.Eoc=function(Cc){function pd(tg,oh,Qh){return Pc.F(wd.na.va,fi.b(tg,Pb.aQi),oh,Qh,ue)}var wd=Pb.$,ue=new ub;ue.tH=Cc.Values[Za.tH];var Je=!1;switch(Cc.MessageId){case Za.b0f:Pb.Ut();Je=!0;ue.EDd=1334518759;break;case Za.view:Pb.iBa=Ne.a.instance.ga(1248);Pb.Tcg(!0);break;case Za.Hye:Pb.Ut(),Je=!0}nf.EwaSettings.qc()?(Cc=new Fb.a(140,0,pd),Cc.flags=Je?16:80):(Cc=Je?new Fb.a(140,0,pd):new Xj.a(140,0,pd),Cc.flags=16);wd.userOperationManager.jc(Cc,
Pb.Sd)};Pb.bIi=function(){var Cc=Pb.$;Cc.ya.SurveyRedirectUrl?(Pb.Ut(),Cc.Ud(1305810481,0,8,null)):(Pb.iBa=Ne.a.instance.ga(1247),Pb.Tcg(!1))};Pb.oQi=function(){var Cc=Pb.$;Pb.Ut();Cc.Ud(1334518759,0,8,null)};Pb.Kmc=function(Cc){var pd=Pb.$;Pb.Ut();Cc.MessageId===Za.Rye&&pd.ea.abd()};Pb.IOi=function(){Pb.aLc=!0;Pb.raiseEvent(ad.Csd)};Pb.aQi=function(Cc,pd){if(!Rj.a(Cc)){Cc=Pb.$;if(pd.tH){var wd=Cc.ea.xa;if(wd.contains(pd.tH.SheetName))Pb.snc(pd);else{var ue=null;ue=function(){wd.Yma(ue);Pb.snc(pd)};
wd.Qga(ue)}}1461300262!==pd.EDd&&Cc.Ud(pd.EDd,0,8,null)}};Pb.g9d=ea;Pb.Sd=Wa;return Pb}function ub(){this.tH=null;this.EDd=1461300262}function Za(){}function wa(J){J=ja.call(this,J,new Sys.UI.Point(960,680),Ne.a.instance.ga(1243))||this;J.name=ca.a.hKe;return J}function ja(J,ea,Wa,Pb){var Cc=Kk.call(this,J,Wa,2,void 0===Pb?null:Pb)||this;Cc.MJc=null;Cc.onResize=function(){var pd=Cc.aPh();Cc.iLa.setAttribute("width",pd.x.toString());Cc.iLa.setAttribute("height",pd.y.toString());Cc.hPj(pd);Cc.Yzd()};
Cc.nkh=function(){var pd=Cc.Hx.parentNode.style,wd=pd.top;pd.top="2px";pd.top=wd};Cc.hGe=ea;Cc.$.GA(Cc.onResize);Cc.zdc();return Cc}function Ua(J){return oj.call(this,J)||this}function bb(J){this.$=J}function Xa(J,ea,Wa,Pb,Cc,pd,wd,ue){ue=J.Na(9,void 0===ue?null:ue);ue.sheetName=ea;ue.directionRtl=Wa;return Pc.i(J,"ChangeSheetDirection",ue,Pb,Cc,pd,wd,0)}function yb(J,ea,Wa,Pb,Cc,pd,wd,ue){ue=J.Na(9,void 0===ue?null:ue);ue.sheetName=ea;ue.show=Wa;return Pc.i(J,"ShowHeadings",ue,Pb,Cc,pd,wd,0)}function Ib(J,
ea,Wa,Pb,Cc,pd,wd,ue){ue=J.Na(9,void 0===ue?null:ue);ue.sheetName=ea;ue.show=Wa;return Pc.i(J,"ShowGridlines",ue,Pb,Cc,pd,wd,0)}function Qa(J,ea){this.sheetName=null;this.value=!1;this.sheetName=J;this.value=ea}function cb(J,ea){var Wa=jl.call(this)||this;Wa.activityName=J;Wa.pM=ea;Wa.Tb();return Wa}function lb(J,ea,Wa,Pb,Cc){J=il.call(this,J,ea)||this;lb.Tud=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];lb.Sud=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,
1112506702,1220851643];lb.Mnf=[-1468309555,611268539,-1750576502,61029505];lb.Lnf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];J.Sxc=Wa;J.aAj=Pb;J.hJj=Cc;return J}function Ha(){var J=Ug.call(this)||this;J.Tb();return J}function $b(J,ea){return Wk.call(this,J,ea)||this}function Jb(J){var ea=cl.call(this)||this;ea.$=J;ea.Tb();return ea}function kc(J,ea){this.$=J;this.Ci=ea;this.$.da.Ga(393,this)}function uc(J){var ea=Pk.call(this,J)||this;ea.dCh=function(Wa,Pb,Cc,
pd,wd){return 1===Cc?32:Wa===Xf.a.LQa&&2===Cc?(Wa=ea.$.na.va.hc(),Pc.ab(ea.$.na.va,wd[0],wd[1],null,null,Wa),32):8};return ea}function hd(J,ea){this.$=J;this.Ci=ea}function ma(J){return zk.call(this,J)||this}function jb(J,ea){var Wa=this;this.$Oi=function(Pb,Cc){if(!Rj.a(Pb)&&Cc){var pd=!!Pb&&!!Pb.RequestTelemetryData;wg.g(Wa.$).Ii.qla(Cc,Pb.StateId,pd?Pb.RequestTelemetryData.EcsOperationDuration:0,pd?Pb.RequestTelemetryData.EcsRequestDuration:0,pd?Pb.RequestTelemetryData.WfeRequestDuration:0)}};
this.uGi=function(Pb,Cc){Cc&&Cc.k0b&&Cc.k0b.SheetName&&Cc.k0b.Ranges.length&&Cc.Fei&&nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(Pb=Jk.d(Wa.$.xa.qa),Wa.rZg(new rk.a(ze.B(Cc.k0b.Ranges[0]),Pb)))};this.$=J;this.Sg=ea}function Zb(J,ea){var Wa=qk.call(this,J)||this;Wa.pvb=function(Pb){Pb=Wa.wed(Pb);return Wa.Obd(Pb)};Wa.Vej=function(Pb,Cc){var pd=Wa.bAb=Cc[Zb.qfi];1===Pb?(Pb=Cc[Zb.hAj],pd=Wa.R2e(Pb,pd),vd.ULS.shipAssertTag(537153996,
0,pd!==Zb.qba,"ResizeHeadersDialogHandler - invalid size input, size = {0}",Pb),Pb=pd!==Wa.cld,vd.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",Wa.isRow,Wa.bAb,pd,Pb),Pb&&Wa.M3g(pd)):vd.ULS.sendTraceTag(537153994,0,50,"ResizeHeadersDialog Cancel button pressed, isRow = {0}.",Wa.isRow)};Wa.isRow=2040891415===ea.command;Wa.gridView=wg.g(Wa.$);Wa.Etc=new bd(Wa.$.workbookContext.DxDigitNormal);Wa.cld=Wa.USg();
J=Wa.z2g(Wa.cld);ea=Wa.B2g(Wa.cld);Wa.Jm=Ne.a.instance.ga(Wa.isRow?479:480);J=Wa.FM(J,ea);Wa.initializeAndShow(Wa.Jm,Wa.Vej,J);vd.ULS.sendTraceTag(537153997,0,50,"ResizeHeaders React Dialog opened, isRow = {0}.",Wa.isRow);return Wa}function Ub(J){this.resizeParameters=null;this.resizeParameters=J}function Qc(J,ea){this.isRow=!1;this.autoFitRange=null;this.isRow=J;this.autoFitRange=ea}function kd(){var J=bl.call(this)||this;J.Tb();return J}function xb(J,ea){var Wa=Lj.call(this,ea.domElement)||this;
Wa.rSf=!1;Wa.bY=!1;Wa.wSa=null;Wa.v7a=null;Wa.wk=null;Wa.gKd=!0;Wa.Chc=!1;Wa.offset=0;Wa.fl=0;Wa.jJb=0;Wa.S0=null;Wa.dS=null;Wa.NM=null;Wa.w4h="headerResizeTooltip";Wa.Ptd=null;Wa.iG=null;Wa.Oza=!1;Wa.Ffa=!1;Wa.uXc=!1;Wa.d$a=eg.a.zLa;Wa.AN=function(Pb){if(Wa.grid.om)return!1;Pb=fk.a(Wa.grid.$).ie(Pb);if(3===Pb.zb&&!Wa.Vgf(Pb.Ca)||!Wa.aHf(Pb,!1))return!1;vd.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");var Cc=Wa.Kxc();Wa.Wbd(Pb.clientPoint,Cc,!0);Wa.Oza||
(li.a.instance.pa(ug.a.vh,Wa.domElement.ownerDocument.body,Wa.l9a),hj.a.instance.pa(ug.a.Bg,Wa.domElement.ownerDocument.body,Wa.l9a),Wa.Oza=!0);Wa.Tcf()&&Wa.bY&&Wa.D8e(Pb);return!1};Wa.XDb=function(Pb){Pb=fk.a(Wa.grid.$).ie(Pb);Wa.Tcf()&&Wa.uXc&&Wa.D8e(Pb);if(nf.EwaSettings.isChangeGateEnabled("OfficeVSO:6093232_ResizeRowColUsingTouch")){if(!Pb.Ca.type.includes("touch")&&Pb.Ca.button!==Sys.UI.MouseButton.leftButton||!Wa.E6a)return!1}else if(Pb.Ca.button!==Sys.UI.MouseButton.leftButton||!Wa.E6a)return!1;
pk.g(Pb.Ca);Wa.IKe();Pb=Wa.grid.om?Wa.d$a:eg.a.zLa;if(Wa.grid.om&&Wa.wk)var Cc=Pb!==Wa.fl||Wa.Ffa;else Wa.wk&&(Pb=Wa.Ffa?Wa.tdd():Wa.wk.v4()),Cc=Pb!==Wa.fl;if(Wa.wSa&&Cc&&Pb!==eg.a.zLa){Pb=Wa.grid;Cc=Wa.Hfd(Pb);var pd={};pd.SheetMultiRange=ze.r(Cc,Pb.$);xb.COd(pd,Wa.isRow,Wa.fl);Wa.bkh(pd);Pb.qFj=!0}else Wa.Jg(null,null),Wa.CHb();return Wa.Ffa=!1};Wa.rca=function(Pb){if(Wa.grid.om)return!1;Pb=ok.a.create(Pb.eventName,Pb.Lb,Pb.Ca,Pb.zb);Pb=fk.a(Wa.grid.$).ie(Pb);if(!Wa.aHf(Pb,!0))return!1;Pb=Wa.grid;
var Cc=Wa.Hfd(Pb);Cc=ze.r(Cc,Pb.$);Pb.Db.Oh([Wa.isRow?13:14]);Pb.Db.XRa();Wa.CHb();var pd={};Pb.$.Ud(Wa.isRow?146338636:1391094586,pb.a.Sb,30,(pd.autoFitRanges=Cc,pd));return!1};Wa.oxf=function(Pb){Wa.bY?(Wa.Chc||Wa.V9e(),Pb=new Sys.UI.DomEvent(Pb),Pb=ok.a.create(ug.a.tha,Wa.domElement,Pb,2),Pb=fk.a(Wa.grid.$).ie(Pb),Wa.pxf(Pb.clientPoint,void 0)):vd.ULS.sendTraceTag(521480320,2,50,"HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = "+(Wa.wk?Wa.wk.ryg:-1)+
", isRow = "+Wa.isRow)};Wa.qxf=function(Pb){Pb=new Sys.UI.DomEvent(Pb);Pb=ok.a.create(ug.a.tha,Wa.domElement,Pb,2);Wa.XDb(Pb)};Wa.fLi=function(Pb){Wa.nya(Pb,Wa.wk,!1)};Wa.l9a=function(Pb){Pb=fk.a(Wa.grid.$).ie(Pb);nf.EwaSettings.isChangeGateEnabled("OfficeVSO:6195348_StopBubblingOnDocumentMouseMoveInnerEvent")&&pk.g(Pb.Ca);return Wa.pxf(Pb.clientPoint,Pb.Ca)};Wa.cI=function(Pb){if(Wa.grid.om)return!1;Pb=fk.a(Wa.grid.$).ie(Pb);var Cc;if(!Wa.wff||-1!==Wa.grid.ha.selectionType)return gj.a(Wa.grid.$).Mq()&&
(Cc=Wa.hed(Pb))&&(Cc.Qva.style.cursor=""),!1;if(Wa.bY)return Wa.V9e(),!1;Cc=Wa.hed(Pb);if(!Cc)return!1;Cc.Qva.style.cursor=!Wa.grid.isEditing&&Wa.crd(Cc)?Wa.isRow?"row-resize":"col-resize":"";pk.g(Pb.Ca);return!0};Wa.Ap=function(){Wa.CHb()};Wa.Jg=function(){if((3===pb.a.Sb||sg.a.pp)&&Wa.grid.ha.ta.Hg){var Pb=Wa.grid.ha.ta.qd;if(!(!Pb.isRow&&!Pb.hf||!Wa.domElement||Pb.isRow&&Wa.isRow&&!Array.contains(Wa.sf.Sn,Pb.top)||Pb.hf&&!Wa.isRow&&!Array.contains(Wa.sf.Sn,Pb.left))){var Cc=Wa.grid.tg(Pb,Wa.sf.yj.paneType);
if(Cc){if(Wa.grid.om){var pd=Wa.isRow?Pb.bottom:Pb.right;Wa.wk=Wa.sf.ds(Kj.Range.hd(Pb.bottom,Pb.right));if(!Wa.wk){vd.ULS.sendTraceTag(522826880,2,50,"HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index "+pd+", is row "+Wa.isRow);return}}Wa.iG||Wa.f$g();Pb.isRow&&Wa.isRow?(xg.DOMElementExtensions.setVisible(Wa.iG,!0),Wa.iG.style.top=Cc.bottomRight.y-Wa.iG.offsetHeight/2+"px"):Pb.isRow||Wa.isRow||(xg.DOMElementExtensions.setVisible(Wa.iG,
!0),Nj.c(Wa.iG.style,Wa.grid.rtl,Cc.bottomRight.x-Wa.iG.offsetWidth/2+"px"))}}}};Wa.wF=function(Pb,Cc){nf.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&vd.ULS.sendTraceTag(521787422,2,50,"HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated "+Cc.RL);Cc.RL&&Wa.xpb()};Wa.sf=ea;Wa.isRow=ea.isRow;Wa.rtl=ea.yj.rtl;Wa.grid=J;Wa.tof=Wa.isRow?eg.a.uvd:eg.a.Jkc;Wa.s4h=Ne.a.instance.ga(438);Wa.B4h=Ne.a.instance.ga(437);
Wa.v4h=Ne.a.instance.ga(439);qi.a(Wa.grid.$,function(Pb){Wa.Ptd=Pb.fQ($c.a.cfj,!1)});Wa.s6i();Wa.grid.ha.EP(Wa.Jg);Wa.grid.ha.K2(Wa.Ap);Wa.grid.Mt(Wa.Jg);gj.a(Wa.grid.$).yg.Rga(Wa.wF);return Wa}function bd(J){this.S6c=J}function Qd(J,ea,Wa,Pb,Cc,pd,wd){this.Qva=J;this.KCb=ea;this.mOa=Wa;this.Xid=Pb;this.Cbb=Cc;this.Ugf=pd;this.y3h=wd}function zd(){}function Jd(J){var ea=Dk.call(this)||this;ea.$=J;ea.Tb();return ea}function gc(J){var ea=this;this.zoa=this.AUe=this.kGb=this.e2a=this.nqc=this.Pca=this.qPa=
null;this.Wpd=this.XNb=this.cLd=!1;this.kLb=!0;this.Vfc=!1;this.CRd=!0;this.WNb=this.J0a=this.WAe=0;this.$uc={};this.epc={};this.dpc={};this.oHf=0;this.P6a=this.f9d=!1;this.s9i=function(){xg.DOMElementExtensions.toggleCssClass(ea.$.lr,"ewr-presentMode-transition",!1);$removeHandler(ea.e2a,"transitionend",ea.zoa)};this.ej=function(){parseInt(ea.$.jw.style.right,10)!==ea.WAe&&window.requestAnimationFrame(function(){ea.pBc(0);ea.$.mza(Ue.a.EZ("PresentModeManager.OnContentAreaResized"))})};this.Bya=function(){var Wa=
Object(Db.a)(Zg.a,ea.$.qa);if(Wa&&ea.zz){ea.gridView.dod=!1;Wa=Wa.headersVisible;var Pb=wg.g(ea.$).rtl;xg.DOMElementExtensions.toggleCssClass(ea.$.lr,"ewr-presentMode-on-headers-off",!Wa);xg.DOMElementExtensions.toggleCssClass(ea.$.lr,"ewr-presentMode-on-rtl",Pb);(12!==ea.J0a&&!Wa||32!==ea.J0a&&Wa&&!Pb||0!==ea.J0a&&Wa&&Pb)&&window.requestAnimationFrame(function(){ea.pBc(2)})}};this.vd=function(){ea.gaf();ea.wh("OnWorkbookOpened");vd.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};
this.Ap=function(){ea.Wpd=!0;ea.wea("OnSelectionStarted")};this.Jg=function(){ea.Wpd=!1;ea.wea("OnSelectionEnded");ea.GUf()};this.fj=function(){ea.wea("OnEditStarted")};this.Tf=function(){ea.wea("OnEditEnded")};this.Mw=function(){if(!ea.Vfc){var Wa=nf.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");ea.wea("OnVisibleAreaChanged",!0,Wa)}};this.JDb=function(){ea.Vfc=!0};this.yp=function(){ea.wea("OnCurrentSelectionModeChanged");ea.GUf();ea.wh("OnCurrentSelectionModeChanged")};
this.Sm=function(){ea.wea("OnBlockCacheItemEvicted")};this.yf=function(){ea.wea("OnBlockCacheItemChanged")};this.uF=function(){ea.Vfc||ea.wea("OnActiveItemPanesChanged")};this.Th=function(){ea.Vfc=!1;ea.Pca.wh("ActiveSheetChanged");ea.Bya()};this.OEb=function(Wa,Pb){if(Wa=Object(Db.a)(Zg.a,Pb.item))Wa.Hpb(16,!0),Wa.rnb(ea.Bya)};this.bJi=function(){Hc.Sgi||(ea.nqc&&ea.nqc.Nq&&ea.nqc.hide(),wg.g(ea.$).isEditing&&wg.g(ea.$).Gp(!0),ea.Gxc(!1),vd.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};
this.cJi=function(){vd.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=J;this.gridView=wg.g(this.$);this.Uij=J.ya.PresentModeRenderUpdateTimeout;this.initialize(J)}function Hc(){}function Tc(J,ea){var Wa=Cj.call(this,J)||this;Wa.CZi=function(){Wa.Pca.xRd(!0)};Wa.Pca=ea;Wa.domElement.classList.add("ewr-presentMode-on");J={};J=(J[Tc.Px]=Wa.Cc,J);Wa.ic=0;Wa.initializeAndShow("",Wa.CZi,J);return Wa}function Md(J){this.a_a=this.dEd=
null;this.$=J;this.gridView=wg.g(this.$)}function Xc(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}function Cd(){this.height=this.width=0}function Sb(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}function Mc(J){var ea=this;this.Hre=this.oPa=this.bEd=this.cEd=this.Oca=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.Vpc={};this.Upc={};this.lPa=null;this.dGf=0;this.onKeyDown=function(Wa){Wa=Wa.Ca;if(9===Wa.keyCode){var Pb=
ea.Oca.querySelectorAll(xg.DOMElementExtensions.$r),Cc=xg.DOMElementExtensions.mn(Pb);Pb=xg.DOMElementExtensions.JC(Pb);xg.DOMElementExtensions.Bna(Wa,Cc,Pb);return!0}return!1};this.Rl=function(){var Wa=[];ea.$.da.$a(337,function(Pb){ea.oPa.getPresentModeFloatieControlsMap().then(function(Cc){for(var pd={},wd=0;wd<Cc.length;wd++)pd[Cc[wd].controlId]=Cc[wd].modelType;Wa.push.apply(Wa,Pb.Vca.h4a(pd));0<Wa.length&&appChrome.api.dispatch(Wa);ea.lij()})})};this.$=J}function md(){}function wc(J){return Ca.call(this,
J)||this}function ed(J,ea){this.$=J;this.presentModeManager=ea}function Nd(J,ea,Wa,Pb){var Cc=K.call(this)||this;Cc.activityName=J;Cc.pM=ea;Cc.NJ=Wa;Cc.$=Pb;Cc.Tb();return Cc}function pe(J,ea,Wa){var Pb=ek.call(this,J,ea)||this;Pb.xi=null;Pb.yqi=function(Cc){var pd=Pb.Es.ud,wd=Object(Db.a)(6,pd.Ke);var ue=Cc.$rb;Pb.unsubscribe(function(oh){Cc.remove_disposing(oh)});for(var Je=0,tg=pd.errors.length;Je<tg;Je++)-573864504===pd.errors[Je].MessageId&&pd.pla(pd.errors[Je]);switch(ue){case 1:wd.ea.IAc=!0;
vd.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");Pb.zh(wd.isEditMode?Xg.a.pNb:Pb.Qbh);Pb.xp();break;case 2:Pb.zh(Xg.a.openInExcelClient);Pb.xp();break;case 0:pd.activityState[L.a.Ns]=!1,Pb.zh(Pb.NJ),Pb.xp()}};Pb.Qbh=ea;Pb.NJ=Wa;return Pb}function Ec(J,ea){J=Si.call(this,J,ea)||this;J.Rpa=0;J.Dr();return J}function rd(J,ea,Wa,Pb){var Cc=Nk.call(this)||this;Cc.activityName=J;Cc.pM=ea;Cc.NJ=
Wa;Cc.$=Pb;Cc.Tb();return Cc}function Dd(J,ea,Wa){return Ke.call(this,J,ea,Wa)||this}function wb(J,ea){J=Fe.call(this,J)||this;J.password=null;J.rhf=ea;J.Ug();return J}function lf(J,ea,Wa,Pb){var Cc=Bj.call(this)||this;Cc.activityName=J;Cc.pM=ea;Cc.NJ=Wa;Cc.$=Pb;Cc.Tb();return Cc}function qf(J,ea,Wa){return Ke.call(this,J,ea,Wa)||this}function Cf(J){var ea=Fe.call(this,J)||this;ea.VKd=5;ea.c9d=!1;ea.passwordToModify=null;ea.cFf=function(){ea.$.isEditMode&&ea.Xgc&&(Uh.b().I7c("PasswordToModifyPasswordVerifiedTillInteractive"),
ea.$.yl(ea.cFf))};ea.Ug();ea.$.dl(ea.cFf);return ea}function Fe(J){var ea=nk.call(this,J)||this;ea.Rpa=0;ea.N3i=function(Wa,Pb){ea.qab(Wa,Pb)};return ea}function Ke(J,ea,Wa){var Pb=Pi.call(this,J,ea)||this;Pb.xi=null;Pb.CCd=null;Pb.HVi=function(Cc,pd){Pb.GFb(Cc,pd)};Pb.NJ=Wa;return Pb}function $d(J){var ea=xk.call(this)||this;ea.$=J;J.da.Ga(56,new he(J));ea.Tb();return ea}function Id(J,ea){return zi.call(this,J,ea)||this}function he(J){var ea=sf.call(this)||this;ea.$=J;ea.Tb();he.w0g();return ea}
function Af(J,ea,Wa){var Pb=ne.call(this,!0)||this;Pb.Pa=new Kg.a;Pb.VTe=!1;Pb.D6c=!1;Pb.aze=null;Pb.Hm=null;Pb.h3b=null;Pb.od=function(){Nh.a.Kg(yd.a(Pb.$).ud.activityState,Oi.a.tyd)||Pb.taa.reset()};Pb.aIi=function(Cc){Pb.NQf(Cc)};Pb.$Hi=function(){Pb.Qxj()};Pb.$=J;Pb.ea=J.ea;Pb.VJ=ea;Pb.businessBar=Wa;Pb.ea.hk(Pb.od);Pb.taa=Aj.a.Qre(Pb.$);Pb.x0g();J.da.Ga(55,Pb);Pb.mga=Kb.a.instance.kc("Common.ISystemInitiatedFeedback");return Pb}function ne(J){this.Ufa=this.Q4d=this.RUa=null;this.qib=!1;this.SMc=
this.Pbe=null;this.XQb=this.JD=this.lWb="";this.application=this.WB=0;this.YEj=this.VTd=!1;this.tSj=J&&Ud.AFrameworkApplication.fa.ra("OICLaunchDialogIsEnabled");Ud.AFrameworkApplication.Ib.t4(Xf.a.wQa)||Ud.AFrameworkApplication.Ib.fc(Xf.a.wQa,Eh.a.frame,Object(vf.a)(this,this.Yfj,"retryOpenInClientAction"));this.M3f=!!Ud.AFrameworkApplication.fa&&Ud.AFrameworkApplication.fa.ra("SilentExternalHandler")}function Te(){}function Ac(){}function Kd(J){var ea=si.call(this)||this;ea.sq=J;ea.Ne="ProtocolLaunchingDialog";
Ud.AFrameworkApplication.Pi.M4a&&Ud.AFrameworkApplication.Pi.Jtc();Ud.AFrameworkApplication.sa.Qa.dhd&&ea.Qke(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(vf.a)(ea,ea.gnc,"onGiveFeedbackClick"));Kd.O5e?(ea.ic=12,ea.Ac(1,CommonUIStrings.l_CloseFile),ea.Ac(2,CommonUIStrings.l_OICDialogContinueHere),ea.Ac(3,CommonUIStrings.l_OICDialogLaunchAgain)):(ea.ic=4,ea.Ac(1,CommonUIStrings.l_OICDialogContinueHere),ea.Ac(2,CommonUIStrings.l_OICDialogLaunchAgain));ea.CCb(CommonUIStrings.l_OICDialog2ndTitle,
5===ea.sq.PDf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(vf.a)(ea,ea.lFd,"protocolLaunchingDialogResultHandler"),null);return ea}function ce(J){var ea=Kh.call(this)||this;ea.Zea=null;ea.KUa=null;ea.Tpa=!1;ea.xpa=null;ea.sq=J;ea.hg=sd.hg;ea.vse=!0;ea.ic=5;ea.Ne="ProtocolLaunchingDialog";ea.bHc="OICRetryDialog";Ud.AFrameworkApplication.Pi.M4a&&Ud.AFrameworkApplication.Pi.Jtc();Ud.AFrameworkApplication.Pi.Qg(new Vf.a(2,1,5E3,function(){ea.switchToBackupMode()},
101));ea.showDialog("",Object(vf.a)(ea,ea.lFd,"protocolLaunchingDialogResultHandler"));ea.eZf();ea.jX("Issues");ea.ITe();vd.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return ea}function sd(){}function Ge(J){var ea=ak.call(this)||this;ea.xCa=null;ea.LUa=null;ea.Tpa=!1;ea.sq=J;ea.hg=kf.hg;ea.vse=!0;ea.ic=5;ea.Ne="OICLaunchDialog";ea.showDialog("",Object(vf.a)(ea,ea.aEi,"oicLaunchDialogResultHandler"));ea.eZf();ea.jX("ProtocolLaunchingDialogTitle");
4!==Ud.AFrameworkApplication.sa.Qa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);ea.rI(ea.xCa);vd.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return ea}function kf(){}function Ze(J,ea,Wa,Pb,Cc){var pd=document.createElement("img");pd.alt=J;pd.className=kh.getImageClassWithCluster(Wa,Pb);pd.src=ea;pd.setAttribute(Fa.a.Wd,Fa.a.Ts);J=document.createElement("span");
J.className="ProtocolLaunchingDialogImg32Container";J.appendChild(pd);pd=document.createElement("span");pd.className="ProtocolLaunchingDialogIconContainer";pd.appendChild(J);Cc.appendChild(pd)}function je(J,ea,Wa,Pb,Cc,pd,wd){var ue=document.createElement("a");ue.className="ProtocolLaunchingDialogButtonAnchor";ue.className+=" OICDialog";ue.id=J;ue.setAttribute(Fa.a.Wd,Fa.a.Ss);ue.style.padding="0";ue.style.margin="0";Pb&&Ze(Cc,ea,Wa,Pb,ue);J=document.createElement("span");J.className="ProtocolLaunchingDialogButtonLabel";
J.innerText=Cc;ue.appendChild(J);ue.tabIndex=0;pd&&Bh.a.instance.pa(ug.a.click,ue,pd);wd&&yh.KeyInputManager.instance.pa(ug.a.Vd,ue,wd);return ue}function dg(J){return J.Ca.keyCode===wi.a.ei||J.Ca.keyCode===wi.a.Soa?(J.Lb.click(),!0):!1}function Zd(J){for(var ea=0;ea<J.children.length;ea++){var Wa=J.children[ea];Wa.style.position="relative";Wa.style.top=(Wa.parentNode.offsetHeight-Wa.offsetHeight)/2+"px"}}function of(){}function Wf(J,ea,Wa){var Pb=this;this.La=J;this.xqg=ea;this.YEc=null;(this.tXb=
Ud.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Kb.a.instance.kc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Cc){Pb.YEc=Cc});this.U1=Wa}function $f(J,ea,Wa){this.La=J;this.tqg=ea;this.U1=Wa}function mg(J){var ea=bg.call(this)||this;ea.$=J;ea.Tb();return ea}function Qf(J){var ea=mf.call(this)||this;ea.$=J;ea.Tb();return ea}function lc(J,ea,Wa){Wa=void 0===Wa?!1:Wa;var Pb=
Td.call(this,J,ea)||this;Pb.cCb=null;Pb.JAd=function(Cc){Pb.unsubscribe(function(pd){Cc.remove_disposing(pd)});Pb.zh(Xg.a.Jk);Pb.xp()};Pb.qkc=Wa;return Pb}function Kc(J){return pa.call(this,J)||this}function Fd(J,ea){this.Ci=ea;this.$=J}function re(J){var ea=T.call(this)||this;ea.$=J;ea.Tb();return ea}function ke(J){return Zj.call(this,J)||this}function nd(J){this.to="Excel";this.$=J;this.lV=yi.a.current}function dc(J,ea,Wa,Pb,Cc,pd,wd){wd=J.Na(9,void 0===wd?null:wd);wd.sheetName=ea;wd.confirmationChoice=
!0;return Pc.i(J,"DeleteSheet",wd,Wa,Pb,Cc,pd,0)}function Xd(){}function sa(J){var ea=ag.call(this)||this;ea.x_d=null;ea.z_d=0;ea.jj=null;ea._state=0;ea.moveNext=function(){try{for(ea._state=1;1===ea._state;)ea.Ju=ea.Ju()}catch(Wa){ea.dispose(),ea.Lda(Wa),ea._state=3}};ea.Cf=J;ea.Ju=ea.tL;ea.moveNext();return ea}function ob(){}function Wb(J){return af.call(this,J)||this}function hc(J,ea){this.$=J;this.gridView=ea}function pc(J,ea,Wa){var Pb=fe.call(this,J)||this;Pb.Cmb=0;Pb.Jyb=!1;Pb.n1a=null;Pb.tHe=
!1;Pb.Mqb=!0;Pb.yTc=null;Pb.Jm=null;Pb.dxd=0;Pb.exd=null;Pb.cxd=null;Pb.removeHyperLink=!1;Pb.cellValue=null;Pb.location=null;Pb.d6h=function(Cc,pd){1===Cc||2===Cc?(vd.ULS.sendTraceTag(555755670,0,50,"HyperLink {0} pressed",1===Cc?"OK":"Remove"),Pb.exd=pd[pc.Oqi],Pb.dxd=pd[pc.jkj],Pb.cxd=pd[pc.xfh],2===Cc&&(Pb.removeHyperLink=!0),Pb.commit()):vd.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};Pb.ATj=function(Cc,pd){return 0!==pd&&Cc.length?1===pd?Pb.jYe(ze.y(Cc,Pb.ea.xa)||Pb.BAi(Cc),
762):Pb.jYe(cg.a.ynd(Cc),764):null};Pb.selectedRange=ea;Pb.TL=Wa;Pb.ea=J.ea;Pb.sheetName=ea.SheetName;Pb.vLa();Pb.Bn();Pb.ic=Pb.Jyb?9:1;Pb.Ac(1,Ne.a.instance.ga(4));Pb.Jyb&&Pb.Ac(2,Ne.a.instance.ga(765));J={};J=(J[pc.Ieh]=Pb.tHe,J[pc.yfh]=Pb.n1a,J[pc.dzg]=Pb.Cmb,J[pc.ezg]=Pb.yTc,J[pc.V2g]=Pb.Mqb,J);ea={};J=(ea[pc.Px]=Pb.Cc,ea[pc.BTj]=Pb.ATj,ea[pc.$Ng]=J,ea);Pb.initializeAndShow(Pb.Jm,Pb.d6h,J);return Pb}function xd(J){return cf.call(this,J)||this}function Gd(J,ea,Wa,Pb){var Cc=be.call(this)||this;
Cc.$=J;Cc.businessBar=Pb;Cc.openInExcelOperation=ea;Cc.VJ=Wa;return Cc}function te(){}function Sd(J){var ea=Mi.call(this,J)||this;ea.sessionId=J.ya.UserSessionId;ea.qQg=J.ya.BuildVersion;return ea}function If(J){var ea=this;this.j6h="itms-apps://";this.k6h="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.oig=function(Wa){1==Wa&&ea.SDc()};this.$=J;this.Gx=Ud.AFrameworkApplication.sa.Qa.Gx;this.Qla="ms-excel:ofe|u|"+this.Gx;this.wm=Ud.AFrameworkApplication.fa.Va("AppUrl");
sg.a.xba||sg.a.Eh?this.wm=this.j6h+this.k6h:sg.a.kp&&(Ud.AFrameworkApplication.fa.ra("UseAppAndroidMarketURL")?(vd.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.wm=Ud.AFrameworkApplication.fa.Va("WildFireMarketUrlExcelAndroid")):sg.a.mzb?this.wm=Ud.AFrameworkApplication.fa.Va("WildFireUrlChinaStoreAndroid"):4<sg.a.aWc.l8a&&(this.wm=Ud.AFrameworkApplication.fa.Va("WildFireUrlExcelAndroid")))}function pf(J){var ea=Xi.call(this,J)||this;ea.PH=null;ea.QDb=
function(){vd.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(ea.$.ya.IsMeetingLiveSession)return ea.SDc(),!0;sg.a.kp?(vd.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),ea.Gx&&ea.Gx.length||vd.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),ea.openUrl("intent:"+ea.Gx+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+ea.wm+";end","_top")):9<=sg.a.bkd?(vd.ULS.sendTraceTag(537162594,
306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),ea.openUrl(ea.Qla,"_top"),window.setTimeout(function(){ea.openUrl(ea.wm,"_blank")},9E3)):(vd.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),ea.openUrl(ea.Qla,"_top"),window.setTimeout(function(){ea.openUrl(ea.wm,"_blank")},500));return!0};ea.BOa=function(Wa){return Wa.Ca.keyCode===wi.a.ei||Wa.Ca.keyCode===
wi.a.Soa?(vd.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),Wa.Lb.click(),!0):!1};if(1!==Ud.AFrameworkApplication.sa.Qa.Sj)return ea;ea.Gx=ea.$.workbookContext.ClientUrl;ea.Qla="ms-excel:ofe|u|"+ea.Gx;ea.wm=Ud.AFrameworkApplication.fa.Va("AppUrl");sg.a.xba?ea.wm="itms-apps://"+Ud.AFrameworkApplication.fa.Va("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":sg.a.kp&&(nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",
!1)&&ea.$.ya.IsMeetingLiveSession?(vd.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),ea.wm=Ud.AFrameworkApplication.fa.Va("WildFireMarketUrlExcelAndroid")):sg.a.mzb?ea.wm=Ud.AFrameworkApplication.fa.Va("WildFireUrlChinaStoreAndroid"):4<sg.a.aWc.l8a&&(ea.wm=Ud.AFrameworkApplication.fa.Va("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac"));return ea}function Ef(){}function pg(J){this.calculateType=0;this.calculateType=J}function Ag(J){this.calculationMode=
0;this.calculationMode=J}function Nf(J,ea){var Wa=this;this.dialog=null;this.svf=function(){Wa.dialog&&Wa.dialog.hide()};this.bEi=J;this.Ab=ea;this.Ab.enb(this.svf)}function Lg(J,ea){return Mg.call(this,J,void 0,void 0,ea)||this}function Mg(J,ea,Wa,Pb,Cc,pd){ea=void 0===ea?!0:ea;Wa=void 0===Wa?!1:Wa;Pb=void 0===Pb?null:Pb;Cc=void 0===Cc?null:Cc;pd=void 0===pd?!1:pd;var wd=xf.call(this)||this;wd.cY=null;wd.cm=null;wd.GVa=null;wd.HVa=null;var ue=wd.kVd?wd.kVd:CommonUIStrings.l_DefaultDialogTitle;Mg.exb=
pd;wd.SRb=Pb||new Hg(J,!0);wd.SRb.Nre(wd);var Je=[],tg=[];Mg.Au&&(wd.DVc&&wd.DVc.forEach(function(Jj){Array.add(Je,Jj)}),wd.Xne&&wd.Xne.forEach(function(Jj){Array.add(tg,Jj)}));ea?Wa?wd.agf?(wd.ic=12,wd.Ac(1,wd.buttonText),wd.Ac(2,CommonUIStrings.l_ShareLink),wd.Ac(3,CommonUIStrings.l_DialogClose)):(wd.ic=4,wd.Ac(1,wd.buttonText),wd.Ac(2,CommonUIStrings.l_DialogClose)):(wd.ic=6,wd.Ac(0,CommonUIStrings.l_DialogClose)):wd.ic=5;pd=document.createElement("span");wd.g4c&&(pd.className=wd.g4c);Pb=document.createElement("a");
Pb.innerText=wd.Bjc;Pb.href=J;Pb.target="_blank";Pb.id=wd.Ajc;Pb.className=gf.AFrame.Eoe;var oh=!sg.a.RC&&!!Cc&&0<Cc.count;if(oh){var Qh=zg.a.lfd(J,Cc);Cc=zg.a.dId(J,Cc);Pb.href="#";Pb.target="_self";wd.cm=document.createElement("form");wd.cm.id="printPreviewPostForm1";wd.cm.method="post";wd.cm.target="_blank";wd.cm.action=Cc;Cc=Gl(Qh);for(Qh=Cc.next();!Qh.done;Qh=Cc.next()){Qh=Qh.value;var ni=document.createElement("input");ni.type="hidden";ni.name=Qh.key;ni.value=Qh.value;wd.cm.appendChild(ni)}}else wd.cm=
null;wd.cm||Mg.exb?Mg.exb||(J={},Array.add(tg,(J.type="AppLinkProps",J.id=wd.Ajc,J.text=wd.Bjc,J.onExecute=function(){wd.IKf()},J))):(Cc={},Qh={},Array.add(tg,(Qh.type="AppLinkProps",Qh.id=wd.Ajc,Qh.text=wd.Bjc,Qh.handler=(Cc.href=oh?"#":J,Cc.target=oh?"_self":"_blank",Cc),Qh)));wd.WNa&&(Array.add(Je,wd.WNa),wd.agf&&Array.add(Je,CommonUIStrings.l_AdditionalText));Wa?(J=document.createElement("span"),J.innerText=wd.WNa.replace("{0}",""),pd.appendChild(J)):wd.kpf?(J=document.createElement("span"),J.id=
wd.oi("message"),oh=document.createElement("span"),Cc=document.createElement("span"),Qh=wd.WNa.split("{0}"),oh.innerText=Qh[0],Cc.innerText=Qh[1],J.appendChild(oh),J.appendChild(Pb),J.appendChild(Cc),pd.appendChild(J)):(J=document.createElement("span"),J.innerText=wd.WNa,pd.appendChild(J),pd.appendChild(document.createElement("br")),pd.appendChild(document.createElement("br")),pd.appendChild(Pb),Mg.exb||Array.add(Je,"{0}"));wd.cm&&pd.appendChild(wd.cm);Mg.Au&&(wd.L7a&&(wd.rBb?wd.Oke(wd.L7a,wd.rBb):
(Array.add(Je,"{0}"),J={},Array.add(tg,(J.type="AppLinkProps",J.id="LearnMoreLinkId",J.text=wd.L7a,J.onExecute=function(){wd.ujc()},J)))),wd.Pra(Je,tg));wd.CCb(ue,null,wd.q8e,null,Object(vf.a)(wd,wd.rw,"dialogHandler"),Mg.Au?null:pd);wd.jX(wd.oi("message"));!Mg.Au&&wd.rBb&&wd.L7a&&(ue=document.createElement("div"),ue.className="WACDialogLearnMoreLinkContainer",wd.cY=document.createElement("a"),wd.cY.innerText=wd.L7a,wd.cY.href=wd.rBb,wd.cY.target="_blank",wd.cY.id=wd.oi("LearnMoreLinkId"),wd.cY.className=
gf.AFrame.Eoe,ue.appendChild(wd.cY),ea?wd.Ob.insertBefore(ue,wd.Ob.lastChild):wd.Ob.appendChild(ue),wd.jX(String.format("{0} {1}",wd.oi("message"),wd.oi("LearnMoreLinkId"))));wd.Lhb=Pb;Wa?wd.rI(wd.QB):wd.rI(wd.Lhb);wd.Wkf();Ud.AFrameworkApplication.sa.vX.pa(ug.a.click,wd.Lhb,Object(vf.a)(wd,wd.LIe,"downloadLinkClicked"),null);wd.cY&&Ud.AFrameworkApplication.sa.vX.pa(ug.a.click,wd.cY,Object(vf.a)(wd,wd.ujc,"learnMoreLinkClicked"),null);wd.RRb=!1;return wd}function Hg(J,ea){this._url=J;this.Gsg=ea}
function nh(J){return O.call(this,J)||this}function Ae(J){this.Ci=J}function Dg(J){var ea=Mf.call(this)||this;ea.$=J;ea.Tb();return ea}function Jf(){}function fg(){this.tb=null}function Jg(J){this.fLa=this.aab=null;this._initialized=!1;this.Njd=J}function Og(){this.tb=null}function ef(J,ea,Wa,Pb,Cc,pd){ea=Gc.call(this,ea,Wa,Pb,Cc,pd)||this;ea.La=J;return ea}function ng(J,ea,Wa,Pb,Cc,pd,wd){ea=kg.call(this,ea,Wa,Pb,Cc,pd,wd)||this;ea.Gng=J;return ea}function Xb(J,ea,Wa,Pb){J=Le.call(this,J,ea,Wa,Pb)||
this;J.Bsg=ea;return J}function da(J){var ea=jh.call(this)||this;ea.ic=1;ea.Ac(1,CommonUIStrings.l_RetryButtonLabel);ea.Ac(0,CommonUIStrings.l_DialogClose);ea.La=J;return ea}function Aa(J,ea,Wa){this.La=J;this.MX=ea;this.bmb=Wa}function qb(J,ea,Wa,Pb){var Cc=vi.call(this)||this;Cc.O8=null;Cc.zSb=null;Cc.La=J;Cc.MX=ea;Cc.bmb=Wa;Cc.Ac(1,CommonUIStrings.l_SaveButtonLabel);Cc.hg=jc.hg;Cc.Ne="FileNameDialog-SaveACopy";Cc.Mh=Pb;return Cc}function jc(){}function id(){this.tb=null}function Gc(J,ea,Wa,Pb,
Cc){this.O8=this.Em=this.BCa=null;this.jDa=!1;this.Mh=this.zga=null;this.tSc=J;this.Kkb=ea;this.Fs=Wa;this.ff=Pb;this.Dh=Cc}function Rd(J){this.wb=J;this.fFa=J.appSettings.SkyDriveUploadWebServiceBase;this.nA=J.appSettings.FileName;this.yfa=J.Va("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}function Ce(J,ea,Wa,Pb,Cc,pd,wd){this.eFa=J;this.nA=ea;this.BVa=Wa;this.zSb=Pb;this.cPc=Cc;this.yfa=pd;this.Mh=wd}function Re(J,ea,Wa){this.La=J;this.g2=ea;this.MX=Wa}function Pf(J,ea,Wa){var Pb=pi.call(this)||
this;Pb.La=J;Pb.g2=ea;Pb.MX=Wa;Pb.Sv=!1;Pb.ic=1;Pb.s7(1);Pb.Ac(1,CommonUIStrings.l_SignIn);Pb.Ac(0,CommonUIStrings.l_SignInToSaveDialogCancelButton);return Pb}function Le(J,ea,Wa,Pb){this.KVb=null;this.Mug=J;this.wb=Wa;this.ece=ea;this.L$d=new ye.a;this.Dh=Pb}function kg(J,ea,Wa,Pb,Cc,pd){this.Mh=null;this.Jvg=J;this.g2=ea;this.bmb=Wa;this.wb=Pb;this.rQb=Cc;this.Fs=pd}function vg(){}function gg(){var J=Bi.call(this)||this;J.ic=0;J.Ac(1,CommonUIStrings.l_DialogClose);return J}function Bc(){this.ura=
this.uNc=this.pNc=this.tb=null}function od(J,ea,Wa,Pb,Cc){this.Em=this.BCa=null;this.IEc=!1;this.fQc=this.O8=null;this.tSc=ea;this.Kkb=Wa;this.Fs=Pb;this.ff=Cc;this.La=J}function td(J){this.fFa=J.appSettings.SaveAsToHostWebServiceBase;this.nA=J.appSettings.FileName;this.yfa=J.Va("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}function le(J,ea,Wa,Pb,Cc,pd,wd,ue){this.eFa=J;this.nA=ea;this.BVa=Pb;this.cPc=pd;this.O8=Wa;this.Qvg=Cc;this.yfa=wd;this.Mh=ue}function Ve(J,ea,Wa,Pb){this.Mh=this.kbe=
null;this.YEa=J;this.Fs=ea;this.aOc=Wa;this.ff=Pb}function Pe(J,ea,Wa,Pb,Cc,pd,wd){this.wb=J;this.mIc=Wa;this.La=ea;this.klb=Pb;this.hib=Cc;this.aOc=pd;this.jlg=wd}function yf(){return Qg.call(this)||this}function Cg(J,ea,Wa,Pb){var Cc=this;this.Lo=this.kkb=null;this.hib=J;this.ff=Wa;this.dtg=Pb;this.tDa=new Sf.a(function(){return new rh.a(ea.value,Object(vf.a)(Cc,Cc.xvb,"getMoreInfoEventReceived"))})}function hg(J,ea,Wa,Pb,Cc,pd,wd,ue,Je,tg){this.La=ea;this.wb=J;this.MX=Pb;this.Aga=pd;this.Fs=Cc;
this.ff=Wa;this.dfe=wd;this.mrg=void 0===ue?null:ue;this.YEa=void 0===Je?null:Je;this.sXa=void 0===tg?null:tg}function Lf(J,ea,Wa,Pb,Cc,pd,wd,ue,Je){this.tMc=null;this.nA="";this.klb=J;this.Fs=ea;this.Mh=Je;this.Aga=Wa;this.ff=Cc;this.Rv=Pb;this.YEa=wd;this.sXa=ue;pd&&(this.tMc=new Sf.a(function(){return new rh.a(pd.value,null)}))}function $e(){this.properties=this.friendlyPath=this.folderName=null}function lg(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=
null}function ae(J,ea,Wa,Pb,Cc,pd,wd,ue){J=Pd.call(this,J,ea,Wa,Pb,Cc,pd,ue)||this;J.Qy=null;J.jQc=null;J.lqa=null;J.PRg=CommonUIStrings.l_SaveToAnotherFolder;J.hg=se.hg;J.Ne="FileNameDialog-SaveToSharePoint";J.klb=wd;J.Isg=ue;return J}function se(){}function Wh(){var J=Hi.call(this)||this;J.ic=0;J.Ac(1,CommonUIStrings.l_DialogClose);return J}function zf(){this.tb=null}function fh(J,ea,Wa,Pb,Cc,pd,wd,ue){this.Em=null;this.KWa=this.jDa=!1;this.zga=this.Mh=this.nA=null;this.wb=ea;this.eFa=this.wb.appSettings.SaveAsToHostWebServiceBase;
this.g8d=Pb;this.Kkb=Cc;this.dh=Wa;this.Fs=pd;this.Dh=ue;this.ff=wd;this.La=J;this.yfa=ea.Va("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}function ya(J,ea,Wa){this.Aga=Wa;this.mIc=ea;this.wb=J}function Ob(J,ea,Wa,Pb,Cc,pd){this.La=ea;this.wb=J;this.MX=Pb;this.Aga=pd;this.Fs=Cc;this.ff=Wa}function Lc(J,ea,Wa,Pb,Cc,pd){J=Pd.call(this,J,ea,Wa,Pb,Cc,pd)||this;J.hg=Ad.hg;J.Ne="FileNameDialog-SaveAsToHost";return J}function Ad(){}function Pd(J,ea,Wa,Pb,Cc,pd,wd){wd=void 0===wd?null:wd;var ue=
Sh.call(this)||this;ue.XI=null;ue.La=ea;ue.MX=Pb;ue.Aga=pd;ue.wb=J;ue.Fs=Cc;ue.ff=Wa;ue.bib=ue.wb.ra("SaveToHostWithExtraCharsInFileName");ue.Mh=wd;ue.Ac(1,CommonUIStrings.l_SaveButtonLabel);return ue}function He(J,ea){this.wb=J;this.La=ea;this.bib=this.wb.ra("SaveToHostWithExtraCharsInFileName")}function Me(J,ea){var Wa=Rf.call(this)||this;Wa.KWa=!1;Wa.nA=null;Wa.La=J;Wa.bib=ea;Wa.YRa=!1;return Wa}function Se(){this.tb=null}function Ff(J){this.dm=null;this.dh=J;this.EPc=3}function Oe(J,ea,Wa,Pb){ea=
kb.call(this,J,ea,Wa,Pb)||this;ea.options.advanced.filter=J.Va("OneDriveApiV72Filter")||"folder,photo";ea.options.advanced.linkType="download";ea.options.multiSelect=Ud.AFrameworkApplication.Cpe;J.ra("OneDriveApiV72CommandModeEnabled")&&(ea.options.commandMode=J.Va("OneDriveApiV72CommandMode")||"none");J.ra("OneDriveApiV72QosExtraDataEnabled")&&(ea.options.qosExtradata=new Na(Ud.AFrameworkApplication.userSessionId));return ea}function Na(J){this.olsSessionId=this.value=this.key=null;this.olsSessionId=
J}function kb(J,ea,Wa,Pb){ea=dd.call(this,J,ea,Wa,Pb)||this;ea.Xjg=J;ea.options={};ea.options.advanced={};ea.options.action="query";ea.options.clientId=ea.fa.Va("OneDriveApiV72ClientId");ea.options.advanced.trapFocus=!0;return ea}function ic(J,ea,Wa,Pb,Cc){J=dd.call(this,J,ea,Wa,Pb)||this;J.dce=null;J.MSb=null;J.fng=Cc;J.options={};J.options.clientId=J.fa.Va("OneDriveApiV7ClientId");J.options.cancel=Object(vf.a)(J,J.$zc,"toggleHostDivVisibility");return J}function Rc(J,ea,Wa,Pb,Cc,pd){ea=dd.call(this,
ea,Wa,Pb,pd)||this;ea.Mh=null;ea.g2=J;ea.Dvg=Cc;return ea}function dd(J,ea,Wa,Pb){this.iEa=this.o6=null;this.BQc=this.DQc=!1;this.JWa=null;this.wb=J;this.rQb=ea;this.PDa=Wa;this.Fs=Pb}function Od(){}function me(){var J=de.call(this)||this;J.ic=0;J.Ac(1,CommonUIStrings.l_DialogClose);return J}function Ie(){}function Xe(J,ea,Wa,Pb){this.gib=J;this.Oqa=ea;this.Z1=Wa;this.wog=Pb}function wf(J,ea,Wa,Pb,Cc,pd,wd){var ue=this;this.Lo=null;this.ofe=!1;this.fqa=this.k2d=0;this.gsg=J;this.HWa=ea;this.rUb=Wa;
this.gib=Pb;this.Oqa=Cc;this.Z1=pd;this.tDa=new Sf.a(function(){return new rh.a(wd.value,Object(vf.a)(ue,ue.xvb,"getMoreInfoEventReceived"))})}function De(J,ea,Wa,Pb,Cc,pd,wd,ue){var Je=this;this.LFc=null;this.KSc=!0;this.IQb="";this.dxg=0;this.qWa=null;this.dMc=3;this.wb=ue;this.Z1=J;this.mj=ea;this.Hng=Wa;this.Lkg=Pb;this.Kkg=Cc;this.tDa=new Sf.a(function(){return new rh.a(pd.value,null)});this.xog=new Sf.a(function(){return new rh.a(wd.value,Object(vf.a)(Je,Je.iAi,"mruEventResultReceived"))});
this.wb.ra("WacInTabOpenMRUIsEnabledForUiHost");this.wb.ra("UiHostSupportsDocRebootFeatures")}function oc(){return Yh.call(this)||this}function Yc(J,ea,Wa,Pb,Cc,pd){var wd=this;this.NRc=this.Lo=this.JQb=null;this.BWb=this.ZQc=!1;this.Aae=0;this.NQc=this.jLc=!1;this.Z1=J;this.gib=ea;this.tDa=new Sf.a(function(){return new rh.a(Wa.value,Object(vf.a)(wd,wd.xvb,"getMoreInfoEventReceived"))});this.Zrg=Pb;this.Oqa=Cc;this.tvg=pd;this.vlb=this.jxc;2===this.wK.jca&&(this.NQc=!0)}function hf(){this.folderName=
this.folderUrl=this.hostName=this.hostUrl=null}function ie(){}function bf(){}b.r(C);var Wd=b(555),ee=b(0),Yg=b(257);bf.prototype.fi=function(){};bf.prototype.init=function(){};bf.prototype.dispose=function(){};bf.main=function(){Yg.a.instance.gj(new bf)};Ck.Object.defineProperties(bf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DialogWithLinkToResource"}}});Object(ee.a)(bf,"CommonAppDialogWithLinkToResourcePackage",null,[4,5]);var Sf=b(612),vd=b(15),vf=b(82),rh=
b(1016),cg=b(29),eh=b(132);ie.Fjh=function(J){return ie.jue("New",J)};ie.Gjh=function(J){return ie.jue("Open",J)};ie.Ute=function(J,ea){return ie.wha("LoadingMenuSection",ie.Pri,J,ie.Xob("lblLoading",ea))};ie.Yob=function(J,ea,Wa,Pb){return ie.wha("MessageMenuSection",ie.Wpf,ea,ie.Xob("lblMessage",J,void 0===Wa?null:Wa,void 0===Pb?null:Pb))};ie.oQg=function(J){return ie.Ute(J,CommonUIStrings.l_VoicedLoadingText)};ie.pQg=function(J,ea){return ie.Yob(CommonUIStrings.l_NewCreationLocationMessage,J.Ai,
ea.NR,ea.hoa)};ie.nQg=function(J,ea){return ie.Yob(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,ea.hoa,"\n\n"),J.Ai)};ie.Wte=function(J){return ie.Yob(CommonUIStrings.l_NewGenericErrorMessage,J.Ai)};ie.lQg=function(J,ea,Wa){return ie.wha("menuNewBlank",ie.p4h,Wa?J.Ai:null,ie.Sob(J.E6e,J.F6e,J.G6e,null,J.Zja,J.uxb,ea,"blank"))};ie.kRg=function(){return ie.Xob("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)};ie.gue=function(){return ie.Xob("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)};
ie.lRg=function(J,ea){return ie.wha("menuNewTemplates",J,null,ea)};ie.jQg=function(J,ea){return ie.wha("menuNewMoreTemplates",ie.UTe,null,ie.Sob("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,J,ea))};ie.nPg=function(J,ea,Wa){var Pb="";Wa&&ea&&(Pb=ie.wha("BrowseMoreMenuSection",ie.UTe,null,ie.Sob("btnBrowseMore",ea,ea,null,null,null,J||"1959943459",Wa)));return Pb};ie.Xob=function(J,ea,Wa,Pb){Wa=void 0===Wa?null:Wa;var Cc=Pb=void 0===
Pb?null:Pb;ea&&0<ea.length&&(Cc=ie.Qqf.Gpc(ea).trimEnd(),Cc=0<=Cc.indexOf("{0}")?String.format(Cc,Pb):String.format("{0} {1}",Cc,Pb));Wa=Wa&&Pb?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',cg.a.pf(Wa),cg.a.pf(Pb),cg.a.pf(Cc)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',cg.a.pf(J||""),ie.Qqf.Gpc(cg.a.pf(ea||"")),Wa)};ie.Sob=function(J,ea,Wa,Pb,Cc,pd,wd,ue){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
cg.a.pf(J||""),cg.a.pf(ea||""),cg.a.pf(Wa||""),Pb||"32by32",cg.a.pf(Cc||""),cg.a.pf(pd||""),wd,cg.a.pf(ue||""))};ie.jue=function(J,ea){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',J,ea)};ie.wha=function(J,ea,Wa,Pb){Wa=Wa?String.format('Title="{0}"',cg.a.pf(Wa)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
cg.a.pf(J||""),cg.a.pf(ea||""),Wa,Pb)};ie.Wpf="MenuMru";ie.Pri="MenuLoading";ie.p4h="MenuHeader";ie.UTe="MenuFooter";ie.Qqf=eh.a.Mx("\n","&#10;");Object(ee.a)(ie,"NewAndOpenXmlUtilities",null,[]);var Ud=b(4),lh=b(98),Eg=b(166);Object(ee.a)(hf,"HostInformation",null,[]);var Vf=b(108),ve=b(39),Rg=b(389),hh=b(169),ff=b(738),Ih=b(637),Eh=b(107),Xf=b(27);Yc.prototype.Og=function(){var J=this.wK.M8a;J.fc(Xf.a.newDocument,Eh.a.frame,Object(vf.a)(this,this.newDocument,"newDocument"));J.Ve(Xf.a.Zpc,Eh.a.frame,
Object(vf.a)(this,this.Zpc,"populateNewMenu"),96)};Yc.prototype.newDocument=function(J,ea,Wa,Pb,Cc){return 1===Wa?32:2===Wa&&Cc&&Cc.MenuItemId&&Cc.SourceControlId?this.v0a(Cc.MenuItemId,Cc.SourceControlId):8};Yc.prototype.v0a=function(J,ea){var Wa=this.Jlc.B3c;if(null===Wa)return 8;var Pb=Ud.AFrameworkApplication.fa.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(Ud.AFrameworkApplication.Qka&&Pb){vd.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
var Cc={};Cc[Rg.a.P7f]=J;Cc[Rg.a.GP]=this.GP;Cc[Rg.a.lcid]=Ud.AFrameworkApplication.lcid.toString();Cc[Rg.a.reason]=ff.a.createNew;Ud.AFrameworkApplication.wV().execute(function(pd){pd.Gj(hh.a.v0a,Cc)})}else Pb=(new Date).getTime(),ea=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Wa,cg.a.nf(this.Ela),cg.a.nf(J),cg.a.nf(this.GP),cg.a.nf(Ud.AFrameworkApplication.lcid.toString()),cg.a.nf(Pb.toString()),cg.a.nf(ea),cg.a.nf(Ud.AFrameworkApplication.canary),
Ud.AFrameworkApplication.nj),(Wa=Ud.AFrameworkApplication.fa.Va("ScenarioId"))&&""!==Wa&&(ea+="&wdscenarioid="+cg.a.nf(Wa)),ea+="&"+Ud.AFrameworkApplication.Pbc(),Ud.AFrameworkApplication.Lwa&&(ea+="&"+Ud.AFrameworkApplication.ibc()),(Wa=this.Lo?this.Lo.NR:null)&&(ea+="&DestinationUrl="+cg.a.nf(Wa)),ve.a.mf(ea,"_blank",void 0,"CreateNewDocument");2===this.wK.jca&&(ea={},vd.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",(ea.AppType=Ih.a[this.wK.jca],ea.Template=J,ea)));return 32};
Yc.prototype.Wui=function(J){var ea=Number.MAX_VALUE,Wa=Number.MIN_VALUE,Pb=window.performance;if(Pb&&"undefined"!==typeof Pb.getEntriesByName){for(var Cc=0;Cc<J.length;Cc++){var pd=Pb.getEntriesByName(J[Cc]);pd&&0<pd.length&&(pd=pd[0],ea=Math.min(parseInt(String(pd.fetchStart)),ea),Wa=Math.max(parseInt(String(pd.responseEnd)),Wa))}Wa>ea&&(J={},vd.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",(J.TotalElapsedMs=Wa-ea,J.MinFetchStart=ea,J.MaxResponseEnd=Wa,J)))}};
Yc.prototype.Zpc=function(J,ea,Wa,Pb,Cc){if(1===Wa)return this.NQc&&(Ud.AFrameworkApplication.gN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.NQc=!1),32;2!==Wa||this.jLc||(this.Aae=(new Date).getTime(),J={},vd.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",(J.ShouldShowTemplates=this.jxc,J.CachedNewMenuXmlExists=!!this.JQb,J.ShouldCallGetMoreInfo=this.wK.supportsGetMoreInfoForPersonalStorage,J)));return this.IXi(Cc)};Yc.prototype.IXi=function(J){J&&
(this.JQb?J.PopulationXML=this.JQb:(this.wK.supportsGetMoreInfoForPersonalStorage&&!this.Lo&&this.BBi.rz("Opened New menu",!0),J.PopulationXML=this.$Fh(this.getTemplateListJson())));return 32};Yc.prototype.lff=function(){return!this.wK.supportsGetMoreInfoForPersonalStorage||!!this.Lo&&3===this.Lo.state&&!!this.Lo.hoa&&!!this.Lo.NR};Yc.prototype.Xji=function(){return Ud.AFrameworkApplication.sa&&Ud.AFrameworkApplication.sa.Qa.j_?!0:this.lff()};Yc.prototype.getTemplateListJson=function(){var J=this;
if(!this.jxc||!this.Xji())return null;if(this.vlb&&!this.BWb){var ea="9",Wa=Ud.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in Wa&&(ea=Wa.NumberOfTemplatesInBackstage);var Pb=this.GP;"TemplateCollectionId"in Wa&&(Pb=Wa.TemplateCollectionId);ea=String.format(this.wK.jW+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",cg.a.nf(Ud.AFrameworkApplication.lcid.toString()),cg.a.nf(Pb),ea);Boolean.parse(Wa.AppendOriginQueryParam||"false")&&(ea+="&org=backstage");ea+="&"+Ud.AFrameworkApplication.Pbc();
Ud.AFrameworkApplication.Lwa&&(ea+="&"+Ud.AFrameworkApplication.ibc());this.wK.cDb.gm(ea,1,null,null,!1,2,function(Cc){J.wK.$ba("CreateNewActor.GetTemplateListJson",Cc.data);J.sGj(Cc.data.ke)},function(Cc){J.wK.$ba("CreateNewActor.GetTemplateListJson",Cc.data);J.rGj()},null,void 0,void 0,void 0,void 0,"5");this.vlb=!1}return this.NRc};Yc.prototype.sGj=function(J){this.NRc=J;this.vlb=!1;this.hHb();if(Ud.AFrameworkApplication.sa&&Ud.AFrameworkApplication.sa.Qa.j_&&Eg.c()){J=Ud.AFrameworkApplication.fa.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");
var ea=Ud.AFrameworkApplication.Qka;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.NRc,!0,J&&ea))}};Yc.prototype.rGj=function(){this.BWb=this.vlb=!0;this.hHb();Ud.AFrameworkApplication.sa&&Ud.AFrameworkApplication.sa.Qa.j_&&Eg.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));lh.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)};Yc.prototype.WXh=function(J){for(var ea=0,Wa=0;Wa<J.length;Wa++)if("ST"===
J[Wa].ImageType){ea=Wa;break}var Pb=J.length?J[ea]:null;J=Pb?Pb.Url||"":"";var Cc,pd=Wa=ea=!1;if(Pb&&(Cc=Pb.AspectRatio))Cc=parseFloat(Cc),1>Cc?ea=!0:1.5<Cc?Wa=!0:1===Cc&&(pd=!0);else switch(Cc={},vd.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",(Cc.Url=J,Cc)),this.wK.jca){case 3:ea=!0;break;case 2:Wa=!0;break;case 5:pd=!0}return{returnValue:J,V6h:ea?"95by123":Wa?"123by69":pd?"100by100":"123by95"}};Yc.prototype.$Fh=function(J){var ea=this.mQg(J,this.Jlc,this.Jlc.xGa||"1056925771");
J=ea.returnValue;if(ea.Kwc){this.JQb=J;ea=(new Date).getTime()-this.Aae;var Wa={};vd.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",(Wa.ElapsedMsSinceMenuOpened=ea,Wa))}return J};Yc.prototype.xvb=function(J,ea){vd.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Lo||3!==J.state?2===J.state&&(vd.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.ZQc=!0,this.hHb()):(this.Lo=J,ea||this.hHb(),Ud.AFrameworkApplication.sa&&
Ud.AFrameworkApplication.sa.Qa.j_&&Eg.c()&&Eg.d("setFileMenuHostInformation")&&(J=Object.assign(new hf,{hostUrl:this.Lo.NR,hostName:this.Lo.hoa,folderUrl:Ud.AFrameworkApplication.breadcrumbFolderUrl,folderName:Ud.AFrameworkApplication.breadcrumbFolderName}),vd.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(J))))};Yc.prototype.mQg=function(J,ea,Wa){var Pb=!1;var Cc=this.lff(),pd="";if(this.wK.supportsGetMoreInfoForPersonalStorage)if(this.ZQc)pd=
ie.Wte(ea),this.ZQc=!1,vd.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure");else if(this.Lo)if(Cc)pd=ie.pQg(ea,this.Lo);else if(this.Lo.hbi)Pb=!0,this.vlb=!1,pd=ie.nQg(ea,this.Lo),vd.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message");else{Pb=!0;pd=ie.Wte(ea);var wd={};vd.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",(wd.PersonalFileStorageUrlIsSet=
!!this.Lo.NR,wd.StorageServiceDisplayNameIsSet=!!this.Lo.hoa,wd))}else pd=ie.oQg(ea.Ai),vd.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner");Cc&&(Cc=pd,ea=ie.lQg(ea,Wa,!pd),J=this.jRg(J,Wa),Pb=J.Kwc,pd=Cc+(ea+J.returnValue));return{returnValue:ie.Fjh(pd),Kwc:Pb}};Yc.prototype.jRg=function(J,ea){var Wa=!1;if(!this.jxc)return Wa=!0,vd.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Kwc:Wa};var Pb="",Cc="",pd="MenuTemplate";
if(this.BWb)Pb=ie.gue(),this.BWb=!1,vd.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(J){try{var wd=Sys.Serialization.JavaScriptSerializer.deserialize(J,!0);Pb=this.iRg(wd,ea);vd.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");Ud.AFrameworkApplication.Rqf&&"OneDrive"===this.Ela&&(Cc=ie.jQg(this.CBi,Ud.AFrameworkApplication.Rqf))}catch(ue){ea={},vd.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",
(ea.JsonToConvert=J,ea)),Pb=ie.gue()}Wa=!0}else pd="MenuLoading",Pb=ie.kRg(),vd.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:ie.lRg(pd,Pb)+Cc,Kwc:Wa}};Yc.prototype.iRg=function(J,ea){for(var Wa=this,Pb="",Cc=[],pd=0;pd<J.length;pd++){var wd=J[pd],ue="";if(wd){var Je=wd.Title,tg=wd.AssetId,oh=wd.Thumbnails;tg&&Je&&oh&&(wd=void 0,ue=this.WXh(oh),wd=ue.V6h,ue=ue.returnValue,Pb+=ie.Sob("jbtnNewTemplate"+pd,Je,null,wd,null,ue,ea,tg))}Cc[pd]=ue}J=
new Vf.a(4,1,5E3,function(){Wa.Wui(Cc)},106);this.wK.Hlc.Qg(J);return Pb};Yc.prototype.hHb=function(){this.jLc=!0;this.wK.Jqf.Lv(this.Jlc.Utb);this.jLc=!1};Ck.Object.defineProperties(Yc.prototype,{GP:{configurable:!0,enumerable:!0,get:function(){switch(this.wK.jca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},wK:{configurable:!0,enumerable:!0,get:function(){return this.Z1.value}},Jlc:{configurable:!0,enumerable:!0,get:function(){return this.gib.value}},
BBi:{configurable:!0,enumerable:!0,get:function(){return this.tDa.value}},CBi:{configurable:!0,enumerable:!0,get:function(){return this.Zrg.value}},Ela:{configurable:!0,enumerable:!0,get:function(){return this.Oqa.value}},jxc:{configurable:!0,enumerable:!0,get:function(){return this.tvg.value}}});Object(ee.a)(Yc,"CreateNewActor",null,[]);var jj=b(1381),Yh=jj.a;Wl(oc,Yh);oc.prototype.Kle=function(){this.XT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.XT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.XT(2,CommonUIStrings.l_Open);this.XT(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.XT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.XT(5,CommonUIStrings.l_VoicedLoadingText)};oc.yTi=function(J){return oc.instance.ga(J)};Ck.Object.defineProperties(oc,{instance:{configurable:!0,enumerable:!0,get:function(){return oc.Ma||(oc.Ma=new oc)}}});oc.Ma=null;Object(ee.a)(oc,"MruActorIntlHelper",jj.a,[]);var sh;(function(J){J[J.success=0]="success";J[J.failure=1]="failure";J[J.spinner=2]="spinner";J[J.none=
3]="none"})(sh||(sh={}));Object(ee.b)("DisplayState",sh);var ii=b(41);De.prototype.iAi=function(J,ea){this.qWa=J;ea||this.EMf()};De.prototype.p7i=function(){this.Nw.M8a.Ve(Xf.a.Ypc,Eh.a.frame,Object(vf.a)(this,this.Ypc,"populateMruMenu"),96)};De.prototype.Ypc=function(J,ea,Wa,Pb,Cc){return 1!==Wa&&Cc?this.FXi(Cc):32};De.prototype.FXi=function(J){this.kkh();this.jkh();J.PopulationXML=ie.Gjh(this.IQb+this.LFc);return 32};De.prototype.kkh=function(){var J=3,ea=!1;if(this.IQb&&this.dxg===this.qWa.cIj)J=
{},vd.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",(J.CacheRefresh="Not Dirty",J)),J=this.dMc;else{var Wa={};vd.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",(Wa.CacheRefresh="Starting",Wa));Wa=this.Nw.xw();this.qWa=this.hAi.rz("File Open opened",!0);if(this.IQb&&2!==this.dMc&&3!==this.qWa.state)ea=!0;else{J=this.OVh(this.qWa);Ud.AFrameworkApplication.sa&&Ud.AFrameworkApplication.sa.Qa.j_&&Eg.c()&&J&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(J,
!0));var Pb=this.aGh(this.qWa);J=Pb.tBi;this.IQb=Pb.returnValue}Wa=this.Nw.xw()-Wa;Pb={};vd.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",(Pb.CacheRefresh="Complete",Pb.ElapsedMs=Wa,Pb))}2!==J&&(Wa={},Wa=(Wa.DisplayState=sh[J],Wa),1!==J&&(Wa.IsStale=ea),vd.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Wa));this.dMc=J};De.prototype.OVh=function(J){try{var ea=ii.c(J.qwd)}catch(Wa){ea=null,vd.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",
Wa)}return ea};De.prototype.jkh=function(){if(this.KSc){vd.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary.");var J=this.pwi();this.KSc=J.XUj;this.LFc=J.returnValue}else vd.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");J={};vd.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",(J.WaitingOnLinkInfo=this.KSc,J.NotDisplayingLink=!this.LFc,J))};De.prototype.aGh=function(J){if(1===J.state||0===J.state){J={};vd.ULS.sendTraceTag(5849635,
202,50,"Open menu XML built {0}",(J.Display="Spinner",J));J=2;var ea=ie.Ute(this.Hja(2),this.Hja(5))}else 3===J.state&&J.qwd?(ea=this.kQg(J.qwd),J=0):(J={},vd.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",(J.Display="Server Error",J)),ea=ie.Yob(this.Hja(1),this.Hja(2)),J=1);return{returnValue:ea,tBi:J}};De.prototype.kQg=function(J){var ea=this.yCb.xGa||"2155708348";if(J.length){var Wa=ie.Xob("lblRecentDocuments",this.Hja(3));for(var Pb=0,Cc=0;Cc<J.length;Cc++){var pd=J[Cc];"FileName"in
pd&&"DocumentUrl"in pd&&"Path"in pd&&(Wa+=ie.Sob("MruButton"+Cc,pd.FileName.toString(),pd.Path.toString(),null,this.yCb.Zja,this.yCb.uxb,ea,pd.DocumentUrl.toString()),pd.IsPinned&&Pb++)}Wa=ie.wha("RecentDocumentsMenuSection",ie.Wpf,this.Hja(2),Wa);ea={};vd.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",(ea.Display="MRU List",ea.TotalDocuments=J.length,ea.NumPinnedDocuments=Pb,ea))}else Wa=ie.Yob(this.Hja(0),this.Hja(2)),J={},vd.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",
(J.Display="Empty MRU",J));return Wa};De.prototype.pwi=function(){var J=!0;var ea=this.FOg,Wa=this.EOg;if(ea&&Wa||!this.Nw.supportsGetMoreInfoForPersonalStorage)J=!1;else{var Pb=this.qbc.rz("File Open",!1);3===Pb.state&&(ea=Pb.NR,Wa=Pb.hoa,J=!1)}Wa=Wa?String.format(this.Hja(4),Wa):null;return{returnValue:ie.nPg(this.yCb.xGa,Wa,ea),XUj:J}};De.prototype.EMf=function(){this.Nw.Jqf.Lv(this.yCb.Utb)};Ck.Object.defineProperties(De.prototype,{Nw:{configurable:!0,enumerable:!0,get:function(){return this.Z1.value}},
Hja:{configurable:!0,enumerable:!0,get:function(){return this.mj.value}},yCb:{configurable:!0,enumerable:!0,get:function(){return this.Hng.value}},FOg:{configurable:!0,enumerable:!0,get:function(){return this.Lkg.value}},EOg:{configurable:!0,enumerable:!0,get:function(){return this.Kkg.value}},qbc:{configurable:!0,enumerable:!0,get:function(){return this.tDa.value}},hAi:{configurable:!0,enumerable:!0,get:function(){return this.xog.value}}});Object(ee.a)(De,"MruRenderer",null,[]);var Bg=b(246),Ga=
b(974);wf.prototype.v0a=function(){!this.Lo&&this.axd.supportsGetMoreInfoForPersonalStorage?this.qbc.rz("NewDocumentFromStream",!0):this.createNewDocumentFromStream()};wf.prototype.xvb=function(J){if(!this.Lo&&3===J.state)this.Lo=J;else if(2===J.state){this.ofe?vd.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.qbc.rz("NewDocumentFromStream",!0),this.ofe=!0);return}this.createNewDocumentFromStream()};wf.prototype.createNewDocumentFromStream=function(){this.k2d=
(new Date).getTime();var J=this.uyh.B3c;if(null===J)this.HWa(null);else{var ea=this.rUb.menuItemId,Wa=this.rUb.YF,Pb=this.rUb.aEj,Cc=this.rUb.zyh;this.fqa="streamBase64"===Pb?Cc.length/1024:0;vd.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.GP,this.fqa);var pd=(new Date).getTime();J=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",J,cg.a.nf(this.Ela),cg.a.nf(ea),cg.a.nf(this.GP),cg.a.nf(Ud.AFrameworkApplication.lcid.toString()),
cg.a.nf(pd.toString()),cg.a.nf(Wa),cg.a.nf(Ud.AFrameworkApplication.canary),Ud.AFrameworkApplication.nj,cg.a.nf(Pb));J+="&"+Ud.AFrameworkApplication.Pbc();Ud.AFrameworkApplication.Lwa&&(J+="&"+Ud.AFrameworkApplication.ibc());(ea=this.Lo?this.Lo.NR:null)&&(J+="&DestinationUrl="+cg.a.nf(ea));this.axd.cDb.gm(J,2,Cc,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(vf.a)(this,this.wBi,"newDocumentFromStreamSuccessHandler"),Object(vf.a)(this,this.vBi,"newDocumentFromStreamFailureHandler"),
null,void 0,void 0,void 0,void 0,"31")}};wf.prototype.wBi=function(J){if(J&&J.data&&J.data.ke){var ea=ii.d(J.data.ke);var Wa=ea.Wt;ea.returnValue?Wa.StatusCode!==Bg.a.bP&&Wa.StatusCode!==Bg.a.rrb?(vd.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.GP,this.fqa,Wa.StatusCode),this.HWa(null)):Wa.NewDocumentUrl&&""!==Wa.NewDocumentUrl?(J=(new Date).getTime()-this.k2d,vd.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.GP,this.fqa,J),this.gsg(Wa.NewDocumentUrl)):(vd.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.GP,this.fqa),this.HWa(null)):(Wa={},vd.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.GP,this.fqa,(Wa.ResponseData=Ga.a.veb(J.data.ke),Wa)),this.HWa(null))}else vd.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",
this.GP,this.fqa),this.HWa(null)};wf.prototype.vBi=function(J){J&&J.data&&vd.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.GP,this.fqa,J.data.status);this.HWa(null)};Ck.Object.defineProperties(wf.prototype,{GP:{configurable:!0,enumerable:!0,get:function(){switch(this.axd.jca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},uyh:{configurable:!0,enumerable:!0,
get:function(){return this.gib.value}},Ela:{configurable:!0,enumerable:!0,get:function(){return this.Oqa.value}},axd:{configurable:!0,enumerable:!0,get:function(){return this.Z1.value}},qbc:{configurable:!0,enumerable:!0,get:function(){return this.tDa.value}}});Object(ee.a)(wf,"NewDocumentFromStreamOperation",null,[]);Xe.prototype.create=function(J,ea,Wa){return new wf(J,ea,Wa,this.gib,this.Oqa,this.Z1,this.wog)};Object(ee.a)(Xe,"NewDocumentFromStreamOperationFactory",null,[770]);var Kb=b(84),qc=
b(563),Wc=b(58);Ie.prototype.fi=function(J){J.register(Xe,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").Hc().Oc(function(){return new Xe(new Sf.a(function(){return Ud.AFrameworkApplication.sa.Qa.Fdd()}),new Sf.a(function(){return Ud.AFrameworkApplication.Ela}),new Sf.a(function(){return J.Lh("Common.INewAndOpenCommonHelpers")}),new Sf.a(function(){return J.Lh("Common.IEventEmitter<Common.IGetMoreInfoResult>")}))})};
Ie.prototype.init=function(){var J=this;Ud.AFrameworkApplication.fa.hv(function(){J.Lxb()})};Ie.prototype.Lxb=function(){var J=qc.a.ar(Kb.a.instance.kc("Common.INewAndOpenCommonHelpers")),ea=qc.a.ar(Kb.a.instance.kc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));Ud.AFrameworkApplication.Ela&&Wc.Task.WAA.call(null,J,ea).continueWith(function(){var Pb=new Yc(new Sf.a(function(){return J.result}),new Sf.a(function(){return Ud.AFrameworkApplication.sa.Qa.Fdd()}),new Sf.a(function(){return ea.result}),
new Sf.a(function(){return Ud.AFrameworkApplication.sa.Qa.Gdd().xGa||"1959943459"}),new Sf.a(function(){return Ud.AFrameworkApplication.Ela}),new Sf.a(function(){return Ud.AFrameworkApplication.Iii}));Pb.Og();Pb.hHb()});if(Ud.AFrameworkApplication.dLf){var Wa=qc.a.ar(Kb.a.instance.kc("Common.IEventEmitter<Common.IMruResult>"));Wc.Task.WAA.call(null,J,ea,Wa).continueWith(function(){var Pb=new De(new Sf.a(function(){return J.result}),new Sf.a(function(){return oc.yTi}),new Sf.a(function(){return Ud.AFrameworkApplication.sa.Qa.Gdd()}),
new Sf.a(function(){return Ud.AFrameworkApplication.xTi}),new Sf.a(function(){return Ud.AFrameworkApplication.wTi}),new Sf.a(function(){return ea.result}),new Sf.a(function(){return Wa.result}),Ud.AFrameworkApplication.fa);Pb.p7i();Pb.EMf()})}};Ie.prototype.dispose=function(){};Ck.Object.defineProperties(Ie.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.UX"}}});Object(ee.a)(Ie,"UXPackageManager",null,[4,5,3]);var Dc=b(135),de=Dc.StandardDialog;Wl(me,de);
me.prototype.displayError=function(J){this.Wz(J,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)};me.prototype.m6c=function(J){this.Wz(J,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)};Object(ee.a)(me,"ErrorDialog",Dc.StandardDialog,[759]);var ye=b(162);Od.prototype.XVe=function(){vd.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");var J=new ye.a;J.setResult("api.onedrive.com");return J.task};Object(ee.a)(Od,"OneDriveConsumerEndpointHelper",
null,[719]);var Gf=b(52),jf=b(390),Hf=b(233);dd.prototype.O3a=function(){this.JWa||(this.JWa=this.X9a?Hf.a.create(this.X9a,null,null,null,!1):null);return this.JWa};dd.prototype.setup=function(J){var ea=this;this.iEa=J;this.DQc||this.BQc?this.DQc&&this.iEa&&this.iEa(!0):(J=this.O3a())?(this.BQc=!0,J.Q7a.continueWith(function(Wa){ea.PNi(Wa)}),jf.a.yia(J)):(vd.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.iEa(!1))};dd.prototype.iAd=
function(J){vd.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",J.exception?J.exception.toString():"No error detail.")};dd.prototype.PNi=function(J){this.BQc=!1;if(J.kg)this.iAd(J),this.iEa(!1);else try{this.DQc=!0,vd.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.gld(),vd.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.iEa(!0)}catch(ea){vd.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",ea.toString()),this.iEa(!1)}};
dd.prototype.startPicker=function(J){this.o6=J;this.PDa?vd.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(vd.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(vf.a)(this,this.Fyd,"onApiReady")))};dd.prototype.Fyd=function(J){J?this.rjc():this.si()};dd.prototype.si=function(){this.Fs().displayError(Gf.a.XSi)};dd.prototype.onSuccess=function(J){vd.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");
this.o6&&this.o6(!0,J)};dd.prototype.dispose=function(){this.JWa&&this.JWa.dispose()};Ck.Object.defineProperties(dd.prototype,{upe:{configurable:!0,enumerable:!0,get:function(){return this.rQb}},fa:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});Object(ee.a)(dd,"AOneDriveFilePickerApiManager",null,[262,3]);Wl(Rc,dd);Rc.prototype.start=function(J,ea){this.Mh=J;this.startPicker(ea)};Rc.prototype.gld=function(){var J={},ea={};J=1===this.upe||2===this.upe?(J.client_id=this.fa.appSettings.UploadToSkyDriveClientId,
J):(ea.client_id=this.fa.appSettings.UploadToSkyDriveClientId,ea.env="INT",ea);WL.init(J)};Rc.prototype.startPicker=function(J){this.o6=J;!this.PDa&&this.g2.KLa?(vd.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(vf.a)(this,this.Fyd,"onApiReady"))):(vd.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.Dvg())};Rc.prototype.rjc=function(){try{vd.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Mh).then(Object(vf.a)(this,
this.onSuccess,"onSuccess"),Object(vf.a)(this,this.n6,"onFailure"))}catch(J){vd.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",J,J.stack),this.si()}};Rc.prototype.n6=function(J){if(J&&J.error){if("user_canceled"===J.error.code){vd.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}vd.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",J.error.code,J.error.message)}else vd.ULS.sendTraceTag(17909060,352,50,
"File Dialog returned with no response");this.o6&&this.o6(!1,J);this.si()};Ck.Object.defineProperties(Rc.prototype,{X9a:{configurable:!0,enumerable:!0,get:function(){return this.fa.Va("OneDriveApiUrl")}}});Object(ee.a)(Rc,"OneDriveFilePickerApiManagerV5",dd,[]);Wl(ic,dd);ic.prototype.start=function(J,ea){var Wa=this;this.MSb=ea;var Pb=this.fng.XVe();Pb.continueWith(function(){vd.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");Wa.dce=Pb.result;
Wa.startPicker(function(Cc,pd){Wa.$zc();J(Cc,pd)})},3);Pb.continueWith(function(){vd.ULS.sendTraceTag(24134242,352,15,Pb.exception.message);Wa.$zc()},5)};ic.prototype.gld=function(){var J=this;this.options.success=function(ea){var Wa={};Wa.data=ea;J.onSuccess(Wa)};this.options.error=function(ea){var Wa={};Wa.error=ea;J.n6(Wa)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.dce;this.options.advanced.iframeParentDiv=this.MSb};ic.prototype.rjc=
function(){try{vd.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.$zc(),OneDrive.open(this.options)}catch(J){vd.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",J.message),this.si()}};ic.prototype.n6=function(J){this.o6&&this.o6(!1,J);this.si()};ic.prototype.$zc=function(){this.MSb.style.visibility="hidden"===this.MSb.style.visibility?"":"hidden"};Ck.Object.defineProperties(ic.prototype,{X9a:{configurable:!0,enumerable:!0,get:function(){return this.fa.Va("OneDriveApiV72Url")}}});
Object(ee.a)(ic,"OneDriveFilePickerApiManagerV7",dd,[]);Wl(kb,dd);kb.prototype.start=function(J,ea,Wa,Pb){this.options.advanced.iframeParentDiv=Wa;this.options.advanced.endpointHint=Pb;this.options.cancel=ea;this.Xjg.ra("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(J)};kb.prototype.startPicker=
function(J){this.o6=J;this.PDa?vd.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(vd.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(vf.a)(this,this.Fyd,"onApiReady")))};kb.prototype.gld=function(){var J=this;this.options.success=function(ea){var Wa={};Wa.data=ea;J.onSuccess(Wa)};this.options.error=function(ea){var Wa={};Wa.error=ea;J.n6(Wa)}};kb.prototype.rjc=function(){try{vd.ULS.sendTraceTag(23881879,216,50,
"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(J){vd.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",J.message,J.stack),this.si()}};kb.prototype.iAd=function(J){vd.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",J.exception?J.exception.toString():"No error detail.");jf.a.l9i(this.X9a);this.JWa=null};kb.prototype.si=function(){this.Fs().m6c(Gf.a.Qhj)};kb.prototype.n6=function(J){this.o6&&
this.o6(!1,J)};Ck.Object.defineProperties(kb.prototype,{X9a:{configurable:!0,enumerable:!0,get:function(){return this.fa.Va("OneDriveApiV72Url")}}});Object(ee.a)(kb,"OneDriveFilePickerApiManagerV72",dd,[]);Object(ee.a)(Na,"IExtraData",null,[]);Wl(Oe,kb);Oe.prototype.rjc=function(){try{vd.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?
this.options.qosExtradata.olsSessionId:"",Ud.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(J){vd.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",J.message,J.stack),this.si()}};Ck.Object.defineProperties(Oe.prototype,{X9a:{configurable:!0,enumerable:!0,get:function(){return this.fa.Va("OneDriveApiV72Url")}}});Object(ee.a)(Oe,"OneDriveFilePickerApiOpenManagerV72",kb,[]);Ff.prototype.XVe=function(){this.dm=new ye.a;vd.ULS.sendTraceTag(24134235,
352,50,"Sending initial request for OneDrive for Business Endpoint");this.WMd();return this.dm.task};Ff.prototype.WMd=function(J){J=void 0===J?null:J;var ea=String.format("GetMoreInfoHandler.ashx?{0}",Ud.AFrameworkApplication.KHa);this.dh.H9(ea,1,null,J,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(vf.a)(this,this.cRh,"getMoreInfoSucceeded"),Object(vf.a)(this,this.aRh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")};Ff.prototype.aRh=function(J){if(J.data.httpStatus===Bg.a.gGb&&"X-NewKey"in
J.data.responseHeaders){vd.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var ea={};ea["X-Key"]=J.data.responseHeaders["X-NewKey"];this.WMd(ea)}else 0<this.EPc?(vd.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.EPc),this.EPc--,this.WMd()):(vd.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.dm.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};
Ff.prototype.cRh=function(J){"PersonalFileStorageUrl"in J.data.responseHeaders&&""!==J.data.responseHeaders.PersonalFileStorageUrl?(vd.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.dm.setResult(J.data.responseHeaders.PersonalFileStorageUrl)):(vd.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.dm.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};Object(ee.a)(Ff,"OneDriveForBusinessEndpointHelper",
null,[719]);var Df=b(621);Se.prototype.init=function(){};Se.prototype.dispose=function(){};Se.prototype.fi=function(J){var ea=this;this.tb=J;this.tb.register(Rc,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").Hc().Oc(function(){return new Rc(Df.a.instance,Ud.AFrameworkApplication.fa,Ud.AFrameworkApplication.V1a,Ud.AFrameworkApplication.limitedEdit,Ud.AFrameworkApplication.j3f,function(){return new me})});Ud.AFrameworkApplication.lgf?
this.tb.register(719,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").Hc().Oc(function(){return new Od}):this.tb.register(719,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").Hc().Oc(function(){return new Ff(Ud.AFrameworkApplication.Jd)});this.tb.register(ic,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").Hc().Oc(function(){return new ic(Ud.AFrameworkApplication.fa,Ud.AFrameworkApplication.V1a,Ud.AFrameworkApplication.limitedEdit,function(){return new me},
ea.tb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper"))});this.tb.register(kb,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").Hc().Oc(function(){return new kb(Ud.AFrameworkApplication.fa,Ud.AFrameworkApplication.V1a,Ud.AFrameworkApplication.limitedEdit,function(){return new me})});this.tb.register(Oe,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").Hc().Oc(function(){return new Oe(Ud.AFrameworkApplication.fa,Ud.AFrameworkApplication.V1a,
Ud.AFrameworkApplication.limitedEdit,function(){return new me})})};Se.main=function(){Yg.a.instance.gj(new Se)};Ck.Object.defineProperties(Se.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.OneDriveFilePickerApi"}}});Object(ee.a)(Se,"PackageManager",null,[4,5]);var Rf=Dc.StandardDialog;Wl(Me,Rf);Me.prototype.displayError=function(J,ea,Wa){this.nA=ea;this.KWa=Wa;vd.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",J,Wa);J=this.H_c(J);
0===J?(this.ic=6,this.Ac(0,CommonUIStrings.l_DialogClose)):(this.ic=0,this.Ac(1,CommonUIStrings.l_DialogClose));0===J&&vd.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Wz(Gf.a.Phj,this.kdd(J),this.JLh(J,ea),Object(vf.a)(this,this.$Kd,"retryDialogHandler"),!0)};Me.prototype.$Kd=function(J){1===J?(vd.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.nA?this.La.se(Xf.a.dJb,2,[this.nA,this.KWa]):this.La.processAction(Xf.a.dJb,2)):vd.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")};Me.prototype.H_c=function(J){return 0>J||6<J?(vd.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",J),0):J};Me.prototype.JLh=function(J,ea){J=this.H_c(J);return this.bib?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ea),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][J]:
[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,ea),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][J]};Me.prototype.kdd=function(J){J=this.H_c(J);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,
CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][J]};Object(ee.a)(Me,"ErrorRetryDialog",Dc.StandardDialog,[789]);He.prototype.create=function(){return new Me(this.La,this.bib)};Object(ee.a)(He,"ErrorRetryDialogFactory",null,[762]);var Of=b(150),Ig=b(42),Sh=Of.a;Wl(Pd,Sh);Pd.prototype.AHe=function(J,ea){this.aL(1,!!J&&J!==ea);this.XI=document.getElementById(Pd.TRe);Ig.a.addHandler(this.XI,"change",Object(vf.a)(this,this.anc,"onFileNameChange"));Ig.a.addHandler(this.XI,"input",
Object(vf.a)(this,this.anc,"onFileNameChange"));this.XI.focus()};Pd.prototype.o9b=function(J){return this.bib?(new RegExp("["+this.Y7b('\\/:*?"<>|')+"]")).test(J):(new RegExp("["+this.Y7b('\\/:*?"<>|#{}%~&')+"]")).test(J)};Pd.prototype.Y7b=function(J){return J.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")};Pd.prototype.Ehd=function(){var J=cg.a.Gq(Ud.AFrameworkApplication.jm.dn);this.aL(1,!!this.XI&&""!==this.XI.value&&this.XI.value!==J)};Pd.prototype.anc=function(){var J=this;this.XI&&window.setTimeout(function(){J.Ehd()},
0)};Pd.prototype.n9b=function(J,ea){if(1!==J)vd.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{J=ea[Pd.TRe];ea=Pd.qEf in ea?ea[Pd.qEf]:!1;vd.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",cg.a.wrc(J),ea);var Wa=cg.a.u4(Ud.AFrameworkApplication.fileName);(J=J?J.trim():null)&&""!==J&&""!==Wa||1===this.sa.state?this.o9b(J)?this.Fs.create().displayError(1,J,ea):this.Aga.eoa(J+Wa,ea,
this.Mh):this.Fs.create().displayError(2,J,ea)}};Pd.prototype.dispose=function(){this.XI&&(Ig.a.removeHandler(this.XI,"change",Object(vf.a)(this,this.anc,"onFileNameChange")),Ig.a.removeHandler(this.XI,"input",Object(vf.a)(this,this.anc,"onFileNameChange")),this.XI=null);Sh.prototype.dispose.call(this)};Ck.Object.defineProperties(Pd.prototype,{sa:{configurable:!0,enumerable:!0,get:function(){return this.ff}}});Pd.TRe="txtFileName";Pd.qEf="chkOverwrite";Object(ee.a)(Pd,"FileNameDialogBase",Of.a,[]);
Ck.Object.defineProperties(Ad,{hg:{configurable:!0,enumerable:!0,get:function(){return Of.a.$o(Ad.zk,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}});Ad.zk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(ee.a)(Ad,"FileNameDialogHtml",null,[]);Wl(Lc,Pd);Lc.prototype.oQ=function(J,ea){var Wa=cg.a.Gq(Ud.AFrameworkApplication.jm.dn),Pb={};ea=(Pb.txtFileName=J||Wa,Pb.lblFolderName=CommonUIStrings.l_ToCurrentFolder,Pb.chkOverwrite=ea,Pb);this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(vf.a)(this,this.n9b,"fileNameDialogHandler"),ea);this.AHe(J,Wa)};Object(ee.a)(Lc,"FileNameDialog",Pd,[788]);Ob.prototype.create=function(){return new Lc(this.wb,this.La,this.ff,this.MX,this.Fs,this.Aga)};Object(ee.a)(Ob,
"FileNameDialogFactory",null,[761]);var Fh=b(737);ya.prototype.Og=function(){2===Ud.AFrameworkApplication.sa.Qa.Sj?Ud.AFrameworkApplication.Ib.Ve(Xf.a.dJb,Eh.a.frame,Object(vf.a)(this,this.tUf,"saveAsToHostActionDispatcher"),4):Ud.AFrameworkApplication.Ib.fc(Xf.a.dJb,Eh.a.frame,Object(vf.a)(this,this.tUf,"saveAsToHostActionDispatcher"))};ya.prototype.tUf=function(J,ea,Wa,Pb,Cc){return ea.contextId!==Eh.a.frame||J!==Xf.a.dJb?2:this.wb.ra("SaveAsToHostBrsIsEnabled")?1===Wa?Fh.SessionStatusManager.instance.Dwb||
Ud.AFrameworkApplication.n5?8:32:2===Wa?(vd.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),J=this.mIc.create(),Cc&&Object.getType(Cc)===Array&&2===Cc.length?J.oQ(Cc[0],!!Cc[1]):J.oQ(null,!1),32):8:8};Object(ee.a)(ya,"SaveAsToHostActor",null,[]);var zg=b(80);fh.prototype.JLb=function(){1!==this.ff.state&&(this.Em=this.Kkb(),this.Em.message=CommonUIStrings.l_CommentProgressTooltip,this.Em.ic=5,this.Em.fv=!1,this.Em.HAa(CommonUIStrings.l_DefaultDialogTitle,
null,null))};fh.prototype.tS=function(J){J=void 0===J?0:J;1!==this.ff.state&&this.Fs.create().displayError(J,cg.a.Gq(this.nA),this.KWa)};fh.prototype.QPa=function(){var J=this.wb.appSettings.BreadcrumbFolderUrl;vd.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");ve.a.mf(J,ve.a.EX(3),void 0,"UploadToHostManager.RedirectToFolder")};fh.prototype.PPa=function(J){var ea=!1,Wa=!1;this.wb&&(ea=this.wb.ra("SaveACopyIsEnabledForUiHost"),Wa=this.wb.ra("UiHostSupportsDocRebootFeatures"));
vd.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",J,ea,Wa);if(ea&&Wa){vd.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Pb={};Pb[Rg.a.KPa]="1";Pb[Rg.a.documentUrl]=J;Pb[Rg.a.reason]=ff.a.saveAs;Ud.AFrameworkApplication.wV().execute(function(Cc){Cc.Gj(hh.a.Xta,Pb)})}else ea&&!Wa&&Ud.AFrameworkApplication.Bba?ve.a.mf(J,ve.a.EX(4),void 0,"UploadToHostManager.RedirectToEditUrl"):
ve.a.mf(J,ve.a.EX(3),void 0,"UploadToHostManager.RedirectToEditUrl")};fh.prototype.eoa=function(J,ea,Wa){Wa=void 0===Wa?null:Wa;vd.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.g8d&&!this.g8d()&&this.dh&&(this.Dh&&(this.zga=this.Dh.Gc("DialogShown","SaveAsToHostUploadTime")),this.JLb(),this.KWa=ea,this.nA=J,(this.Mh=Wa)&&"true"===this.Mh.SkipSaveToHost?this.K8b():this.xQ())};fh.prototype.xQ=function(){var J=this;32!==this.La.processAction(Xf.a.LQa,1)?(vd.ULS.sendTraceTag(18989378,
219,15,"The save file change is not supported, this operation may exist data losting."),this.K8b()):this.La.se(Xf.a.LQa,2,[function(){vd.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");J.K8b()},function(ea,Wa){vd.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");J.tS(Wa)}])};fh.prototype.kSi=function(J){this.pIa();this.jDa=!1;if(J&&J.data&&J.data.ke){var ea=ii.d(J.data.ke);var Wa=ea.Wt;if(ea.returnValue)if(Wa.StatusCode!==
Bg.a.bP&&Wa.StatusCode!==Bg.a.rrb)vd.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),J={},J.FailureReason=Wa.StatusCode.toString(),J.ExtraInfo=Wa.ExtraInfo,this.sda(J),this.tS(parseInt(Wa.ExtraInfo));else{vd.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.RJd();try{Wa.NewDocumentUrl&&""!==Wa.NewDocumentUrl?this.PPa(Wa.NewDocumentUrl):this.QPa()}catch(Pb){vd.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",Pb.toString())}this.PFb()}else Wa=
{},vd.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",(Wa.ResponseData=Ga.a.veb(J.data.ke),Wa)),J={},this.sda((J.FailureReason="Failed to deserialize response",J)),this.tS()}else vd.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),J={},this.sda((J.FailureReason="null response",J)),this.tS()};fh.prototype.jSi=function(J){if(5!==J.data.status&&12!==J.data.status||this.jDa){var ea={};vd.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",
(ea.Status=J.data.status,ea.HttpStatus=J.data.httpStatus,ea));ea={};this.sda((ea.FailureReason=J.data.httpStatus.toString(),ea));this.pIa();this.tS();this.PFb()}else vd.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.jDa=!0,this.Mh&&"true"===this.Mh.SkipSaveToHost?this.K8b():this.xQ()};fh.prototype.pIa=function(){this.Em&&(this.Em.close(),this.Em=null)};fh.prototype.PFb=function(){this.zga&&(this.zga.stop(),this.zga=null)};fh.prototype.RJd=function(){this.Mh&&
"VersionHistory"===this.Mh.SaveEntryPoint&&this.La.processAction(Xf.a.rtc,2)};fh.prototype.sda=function(J){this.Mh&&"VersionHistory"===this.Mh.SaveEntryPoint&&this.La.se(Xf.a.TJd,2,J)};fh.prototype.K8b=function(){var J=this.eFa+this.yfa;J=zg.a.El(J,"qs",cg.a.nf(Ud.AFrameworkApplication.nj));J=zg.a.El(J,"n",cg.a.nf((new Date).getTime().toString()));J=zg.a.El(J,"ov",cg.a.nf(this.KWa.toString()));J=zg.a.El(J,"fn",cg.a.nf(this.nA));this.Mh&&this.Mh.FileDownloadUrl&&(J=zg.a.El(J,"furl",cg.a.nf(this.Mh.FileDownloadUrl)));
this.dh.gm(J,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(vf.a)(this,this.kSi,"onUploadFinished"),Object(vf.a)(this,this.jSi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")};Object(ee.a)(fh,"UploadToHostManager",null,[760]);var ki=b(990);zf.prototype.init=function(){Ud.AFrameworkApplication.fa.hv(Object(vf.a)(this,this.vB,"onFullAppSettingsReady"))};zf.prototype.vB=function(){Ud.AFrameworkApplication.fa.ra("SaveAsToHostBrsIsEnabled")&&this.tb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Og()};
zf.prototype.fi=function(J){this.tb=J;this.tb.register(He,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Oc(function(){return new He(Ud.AFrameworkApplication.fa,Ud.AFrameworkApplication.Ib)}).Hc();this.tb.register(fh,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Oc(function(){return new fh(Ud.AFrameworkApplication.Ib,Ud.AFrameworkApplication.fa,Ud.AFrameworkApplication.Jd,function(){return Ud.AFrameworkApplication.Ng},
function(){return(new ki.a).create()},J.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Ud.AFrameworkApplication.sa,Ud.AFrameworkApplication.sa.yD)}).Hc();this.tb.register(Ob,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Oc(function(){return new Ob(Ud.AFrameworkApplication.fa,Ud.AFrameworkApplication.Ib,Ud.AFrameworkApplication.sa,Ud.AFrameworkApplication.sa.Qa,J.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),J.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).Hc();
this.tb.register(ya,"Common.App.SaveAsToHost.SaveAsToHostActor").Oc(function(){return new ya(Ud.AFrameworkApplication.fa,J.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),J.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).Hc()};zf.prototype.dispose=function(){};zf.main=function(){Yg.a.instance.gj(new zf)};Ck.Object.defineProperties(zf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveAsToHost"}}});Object(ee.a)(zf,"SaveAsToHostPackage",null,[4,5]);
var Hi=Dc.StandardDialog;Wl(Wh,Hi);Wh.prototype.displayError=function(J,ea){this.THe(J,ea,Gf.a.Rhj)};Wh.prototype.THe=function(J,ea,Wa){vd.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Wa);this.Wz(Wa,J,ea,null)};Wh.prototype.m6c=function(J,ea){vd.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Wz(Gf.a.Thj,J,ea,null,!0)};Object(ee.a)(Wh,"ErrorDialog",Dc.StandardDialog,[235]);Ck.Object.defineProperties(se,{hg:{configurable:!0,
enumerable:!0,get:function(){return Of.a.$o(se.zk,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}});se.zk="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(ee.a)(se,"FileNameDialogHtml",null,[]);var ug=b(13),wi=b(86),Fa=b(90);Wl(ae,Pd);ae.prototype.oQ=function(J){var ea=cg.a.Gq(Ud.AFrameworkApplication.jm.dn),Wa=Ud.AFrameworkApplication.breadcrumbFolderName,Pb=Ud.AFrameworkApplication.breadcrumbBrandName,Cc={};Cc=(Cc.txtFileName=J||ea,Cc);var pd=CommonUIStrings.L_SaveAs;2===Ud.AFrameworkApplication.sa.Qa.Sj&&(pd=CommonUIStrings.L_SaveACopy);this.initializeAndShow(pd,Object(vf.a)(this,this.n9b,"fileNameDialogHandler"),Cc);this.AHe(J,ea);this.hIa.style.width=
"450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");Ud.AFrameworkApplication.fa.ra("HideSaveToAnotherFolderButtonforUIHost")||(this.Qy=document.getElementById("anotherFolder"),J=document.getElementById("folderLocation"),this.jQc=Fa.a.Npe(J,this.Qy,"anotherFolderDescribedBy"),this.Qy.className="WACButton WACDialogButtonNormal",J=!1,Wa&&Wa.length?(this.wke(this.Qy,this.jQc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Pb,Wa)),
J=this.Nzg(Pb,Wa)):this.wke(this.Qy,this.jQc,CommonUIStrings.l_CurrentOnlineFolder),this.KAg(this.Qy),this.Pzg(this.Qy),J?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Qy,"SaveToAnotherLocationTwo"),vd.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Qy,"SaveToAnotherLocationOne"),Ig.a.addHandler(this.Qy,ug.a.click,Object(vf.a)(this,this.VAd,"onSaveToAnotherLocationClick")),
Ig.a.addHandler(this.Qy,ug.a.Xb,Object(vf.a)(this,this.aBf,"onSaveToAnotherLocationKeyDown")))};ae.prototype.Nzg=function(J,ea){var Wa=!1;var Pb=document.getElementById("currentLocation");Pb.innerText="";var Cc=this.n_e(Pb,J),pd=this.n_e(Pb,ea),wd=255,ue=255;255<Cc+pd&&(wd=Math.max(238,408-Cc),ue=Math.max(170,408-pd),Wa=!0);this.hCg(Pb,J,ue,ea,wd);return Wa};ae.prototype.n_e=function(J,ea){var Wa=document.createElement("div");Wa.innerText=ea;Wa.style.visibility="hidden";J.appendChild(Wa);ea=Wa.clientWidth;
J.removeChild(Wa);return ea};ae.prototype.hCg=function(J,ea,Wa,Pb,Cc){ea&&(this.uke(J,ea,Wa),this.$Bg(J));Pb&&this.uke(J,Pb,Cc)};ae.prototype.uke=function(J,ea,Wa){var Pb=document.createElement("div");Pb.innerText=ea;Pb.title=ea;Pb.className="SaveToAnotherFolderBreadcrumb";Pb.style.maxWidth=Wa.toString()+"px";J.appendChild(Pb)};ae.prototype.$Bg=function(J){var ea=document.createElement("span");ea.id="FolderSeparator";var Wa=document.createElementNS("http://www.w3.org/2000/svg","svg");Wa.setAttribute("class",
"SeparatorCaret");var Pb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Pb.setAttribute("points","1 4 1 11 5 7.5");Wa.appendChild(Pb);ea.appendChild(Wa);J.appendChild(ea)};ae.prototype.wke=function(J,ea,Wa){Wa=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Wa);ea&&(ea.innerText=Wa);J.tabIndex=0;J.setAttribute(Fa.a.Wd,Fa.a.Ss)};ae.prototype.Pzg=function(J){var ea=document.createElement("span");ea.id="anotherFolderText";ea.innerText=this.PRg;ea.className="AnotherFolderTextSpan";
J.appendChild(ea)};ae.prototype.KAg=function(J){var ea=document.createElement("span");ea.className="cui-img-cont-float cui-img-16by16 ";this.lqa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.lqa.setAttribute("class","FolderIconSVG");var Wa=document.createElementNS("http://www.w3.org/2000/svg","path");Wa.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.lqa.appendChild(Wa);ea.appendChild(this.lqa);
J.appendChild(ea)};ae.prototype.aBf=function(J){!J||J.keyCode!==wi.a.ei&&J.keyCode!==wi.a.j1||this.VAd(J)};ae.prototype.VAd=function(){if(this.XI){var J=cg.a.u4(Ud.AFrameworkApplication.fileName),ea=this.XI.value;this.hide();ea&&""!==ea&&""!==J||1===this.sa.state?(""!==J&&(ea+=J),this.o9b(ea)?this.Fs.create().displayError(1,ea,!1):this.klb.start(ea,this.Isg)):this.Fs.create().displayError(2,ea,!1)}};ae.prototype.xVg=function(J){this.Qy&&this.lqa&&(J?(this.Qy.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Qy,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.lqa,"DisabledFolderIconSVG")):(this.Qy.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.Qy,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.lqa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Qy,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.lqa,"DisabledFolderIconSVG"))))};ae.prototype.Ehd=function(){Pd.prototype.Ehd.call(this);this.xVg(!!this.XI&&""!==this.XI.value)};ae.prototype.dispose=function(){this.Qy&&
(Ig.a.removeHandler(this.Qy,ug.a.click,Object(vf.a)(this,this.VAd,"onSaveToAnotherLocationClick")),Ig.a.removeHandler(this.Qy,ug.a.Xb,Object(vf.a)(this,this.aBf,"onSaveToAnotherLocationKeyDown")),this.Qy=null);Pd.prototype.dispose.call(this)};Object(ee.a)(ae,"FileNameDialog",Pd,[312]);var na=b(892),Gb=b(613),Vd=b(202),ge=b(1113),We=b(136);Object(ee.a)(lg,"SaveAsDialogInput",null,[]);Object(ee.a)($e,"SaveLocation",null,[]);var Vg=b(190);Lf.prototype.RKh=function(){var J=new na.a(Gb.a.Qk());J.ia("type",
"currentHost");return Object.assign(new $e,{folderName:this.Rv.breadcrumbFolderName,friendlyPath:this.Rv.breadcrumbBrandName,properties:J})};Lf.prototype.jli=function(J){return!!J&&"ClassicMru"===J.type&&!!J.service_info&&!!J.service_info.service_id&&-1!==J.service_info.service_id.indexOf("SHAREPOINT")};Lf.prototype.fWh=function(){if(!this.tMc||!this.YEa)return null;var J=this.tMc.value.rz("SaveAsToSharePointDialog",!1);if(!J||3!==J.state||!J.Xpf)return null;J=J.Xpf;for(var ea=new Vd.a,Wa=0,Pb=0,
Cc=0;Cc<J.length;Cc++){var pd=J[Cc];if(this.jli(pd)&&(Wa++,pd.sharepoint_info)){var wd=pd.url,ue=pd.sharepoint_info.site_url,Je=pd.title;pd=ge.b(pd,Ud.AFrameworkApplication.isRtl);if(wd&&ue&&Je&&pd){Pb++;var tg=new na.a(Gb.a.Qk());tg.ia("type","SharePoint");tg.ia("siteUrl",ue);tg.ia("folderUrl",wd);Pb++;ea.add(Object.assign(new $e,{folderName:Je,friendlyPath:pd,properties:tg}))}}}Cc=new Map;Cc.set("NumPlaces",J.length.toString());Cc.set("NumSharepointPlaces",Wa.toString());Cc.set("placesWithMetadata",
Pb.toString());lh.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Cc);0<Wa&&(Pb?.5>1*Pb/Wa&&lh.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):lh.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return ea};Lf.prototype.ILh=function(){var J=new Vd.a;J.add(this.RKh());var ea=this.fWh();ea&&J.addRange(ea);return Object.assign(new lg,{enableMoreLocations:!Ud.AFrameworkApplication.fa.ra("HideSaveToAnotherFolderButtonforUIHost"),
fileName:this.nA,extension:cg.a.u4(this.Rv.dn),saveLocations:J.toArray(),scenario:"SaveToSharePoint"})};Lf.prototype.FLh=function(){return{inputPropsCallback:Object(vf.a)(this,this.ILh,"getDialogInput")}};Lf.prototype.oQ=function(J){this.nA=J;this.nA||(this.nA=String.format(CommonUIStrings.l_SaveACopy_Filename,cg.a.Gq(this.Rv.dn)));J={};J=(J.id="SaveAsDialog",J.bodyControls=this.FLh(),J);var ea=CommonUIStrings.L_SaveAs;2===this.ff.Qa.Sj&&(ea=CommonUIStrings.L_SaveACopy);var Wa=new Of.a(!1,!1,!0);
Wa.ic=1;Wa.Ne="SaveAsDialog";Wa.Ac(1,CommonUIStrings.l_SaveButtonLabel);Wa.initializeAndShow(ea,Object(vf.a)(this,this.Nhj,"saveAsDialogHandler"),J)};Lf.prototype.Hyj=function(J,ea){J&&""!==J&&""!==ea||1===this.ff.state?this.ili()?this.Fri(J,ea):(""!==ea&&(J+=ea),this.klb.start(J,this.Mh)):(vd.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.Fs.create().displayError(2,J,!1))};Lf.prototype.Fri=function(J,ea){var Wa=this;lh.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);var Pb=this.sXa.bDe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.sXa.Hdd(Pb).then(function(Cc){if(Cc&&0<Cc.length){var pd=Cc[0][Rg.a.vWi];Cc=Cc[0][Rg.a.IFf];if(""!==pd&&""!==Cc)Wa.YEa.eoa(Cc,J+ea,pd,Wa.Mh),lh.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{Wa.Fs.create().displayError(0,J,!1);var wd=We.a.Rr();wd&&(wd.set("SiteUrlAvailable",""===pd?"false":"true"),wd.set("FolderUrlAvailable",""===Cc?"false":
"true"));lh.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Vg.a,{extendedProperties:wd}))}}else Wa.Fs.create().displayError(0,J,!1),lh.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(function(Cc){"Canceled"===Cc?((Cc=We.a.Rr())&&Cc.set("IsCanceled","true"),lh.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Vg.a,{extendedProperties:Cc}))):lh.Health.instance.recordKpiFailure("SaveACopySFP",
Cc,!1,!1,null)})};Lf.prototype.ili=function(){return this.sXa?this.sXa.cqd():(vd.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)};Lf.prototype.Nhj=function(J,ea){if(ea&&1===J){J=ea.fileName;var Wa=cg.a.u4(this.Rv.dn);ea.moreLocationsSelected&&this.Hyj(J,Wa);if(ea.locationCallback){var Pb=ea.locationCallback();Pb?Pb.properties&&"currentHost"===Pb.properties.oa("type")?this.Aga.eoa(J+Wa,!1,this.Mh):Pb.properties&&"SharePoint"===Pb.properties.oa("type")?(ea=Pb.properties.oa("siteUrl"),
Pb=Pb.properties.oa("folderUrl"),this.YEa.eoa(Pb,J+Wa,ea,this.Mh)):vd.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):vd.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else vd.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}};Object(ee.a)(Lf,"ReactSaveAsDialog",null,[312]);hg.prototype.create=function(J){return this.ff&&this.ff.Qa.lv?new Lf(this.dfe,this.Fs,this.Aga,Ud.AFrameworkApplication.jm,this.ff,this.mrg,this.YEa,this.sXa,J):new ae(this.wb,
this.La,this.ff,this.MX,this.Fs,this.Aga,this.dfe,J)};Object(ee.a)(hg,"FileNameDialogFactory",null,[291]);Cg.prototype.start=function(J){var ea=this;if(!this.FDf)if(Ud.AFrameworkApplication.breadcrumbFolderUrl&&Ud.AFrameworkApplication.breadcrumbFolderUrl.length)this.kkb=Ud.AFrameworkApplication.breadcrumbFolderUrl;else return vd.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",
!this.Lo),!1;var Wa=this.dtg();Wa.azj();var Pb=Wa.JSh();if(!Pb)return vd.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.hib.start(function(Cc,pd){Wa.hide();J(Cc,pd)},function(){ea.Vyd(Wa)},Pb,this.kkb);return!0};Cg.prototype.Vyd=function(J){J.hide();vd.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")};Cg.prototype.cSh=function(J){J=J.toLowerCase();J.endsWith("/")||(J+="/");var ea=J.indexOf("/documents/");return-1!==ea?J.substring(0,
ea+1)+"_layouts/15/onedrive.aspx":""};Cg.prototype.xvb=function(J){this.Lo||3!==J.state||(this.Lo=J)};Ck.Object.defineProperties(Cg.prototype,{FDf:{configurable:!0,enumerable:!0,get:function(){this.kkb||(this.tDa.value.rz("Save As",!0),this.Lo&&this.Lo.NR&&this.Lo.NR.length&&(this.kkb=this.cSh(this.Lo.NR)));return this.kkb}}});Object(ee.a)(Cg,"OneDriveFilePickerHelper",null,[293]);var Qg=Of.a;Wl(yf,Qg);yf.prototype.azj=function(){this.bHc="FilePickerDialog";this.hg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";
this.Ne="PickerDialog-MsoSp";this.showDialog("",null)};yf.prototype.JSh=function(){return document.getElementById("FilePickerDiv")};yf.prototype.wO=function(){};yf.prototype.DPa=function(){};Object(ee.a)(yf,"PickerDialog",Of.a,[292]);var jg=b(1046),sg=b(24);Pe.prototype.Og=function(){var J=this,ea=this.hib.O3a();ea?sg.a.lB||this.wb.ra("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.Ve(Xf.a.saveToSharePoint,Eh.a.frame,Object(vf.a)(this,this.OUf,"saveToSharePointActionDispatcher"),64):(ea.Q7a.continueWith(function(Wa){Wa.kg&&
J.hib.iAd(Wa)}),this.o1b()):vd.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")};Pe.prototype.o1b=function(){jf.a.hHd(Object(vf.a)(this,this.OUf,"saveToSharePointActionDispatcher"));jf.a.L7c([new jg.a(Xf.a.saveToSharePoint,Eh.a.frame,0)],this.hib.O3a())};Pe.prototype.OUf=function(J,ea,Wa,Pb,Cc){return ea.contextId!==Eh.a.frame||J!==Xf.a.saveToSharePoint?2:this.a7a&&(this.aOc.FDf||this.Hve)?1===Wa?Fh.SessionStatusManager.instance.Dwb||Ud.AFrameworkApplication.n5?
8:this.jlg()?32:8:2===Wa?(vd.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Cc&&Cc.SaveEntryPoint&&"VersionHistory"===Cc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.Hve?(vd.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.mIc.create(Cc).oQ(null)):(vd.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.klb.start(null,Cc)),32):8:8};Ck.Object.defineProperties(Pe.prototype,
{a7a:{configurable:!0,enumerable:!0,get:function(){return this.wb.ra("SaveToAnotherFolderBrsIsEnabled")}},Hve:{configurable:!0,enumerable:!0,get:function(){return this.wb.ra("UserCanWriteRelative")}}});Object(ee.a)(Pe,"SaveToSharePointActor",null,[]);Ve.prototype.start=function(J,ea){var Wa=this;vd.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.kbe=J;this.Mh=ea;this.aOc.start(function(Pb,Cc){Wa.W_i(Pb,Cc)})||this.yRd()};Ve.prototype.W_i=function(J,ea){if(J)this.onSuccess(ea);else this.n6(ea)};
Ve.prototype.yRd=function(){1!==this.ff.state&&this.Fs().m6c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)};Ve.prototype.onSuccess=function(J){vd.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(J&&J.data&&J.data.value&&J.data.value.length&&J.data.value[0].sharePoint){var ea=J.data.value[0].sharePoint.url;J=J.data.value[0].sharePoint.listUrl;var Wa=null;if(ea&&(Wa=J?this.BWh(J):this.AWh(ea))){this.YEa.eoa(ea,
this.kbe,Wa,this.Mh);return}vd.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!ea,!Wa)}vd.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.yRd()};Ve.prototype.AWh=function(J){J.endsWith("/")||(J+="/");for(var ea=0,Wa=0;Wa<J.length;Wa++)if("/"===J.charAt(Wa)&&5===++ea)return J.substr(0,Wa);return null};Ve.prototype.BWh=function(J){J.endsWith("/")&&(J=J.substring(0,J.length-1));var ea=J.lastIndexOf("/");
return-1!==ea?J.substring(0,ea):null};Ve.prototype.n6=function(J){vd.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");J&&J.error?vd.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",J.error.errorCode,J.error.message):vd.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.yRd()};Object(ee.a)(Ve,"SaveToSharePointManager",null,[827]);le.prototype.execute=function(J,ea){if(!Ud.AFrameworkApplication.Ng&&Ud.AFrameworkApplication.Jd){var Wa=
this.eFa+this.yfa;Wa=zg.a.El(Wa,"fu",cg.a.nf(this.O8));Wa=zg.a.El(Wa,"su",cg.a.nf(this.Qvg));Wa=zg.a.El(Wa,"fn",cg.a.nf(this.nA));Wa=zg.a.El(Wa,"n",cg.a.nf((new Date).getTime().toString()));this.Mh&&this.Mh.FileDownloadUrl&&(Wa=zg.a.El(Wa,"furl",cg.a.nf(this.Mh.FileDownloadUrl)));Wa=Wa+"&"+this.cPc;this.BVa&&this.BVa.length?Wa=zg.a.El(Wa,"fnn",cg.a.nf(this.BVa)):vd.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");vd.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");
Ud.AFrameworkApplication.Jd.gm(Wa,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,J,ea,null,void 0,void 0,void 0,void 0,"9")}};Object(ee.a)(le,"SharePointSaveAsCaller",null,[790]);td.prototype.create=function(J,ea,Wa,Pb){return new le(this.fFa,this.nA,J,ea,Wa,Ud.AFrameworkApplication.nj,this.yfa,Pb)};Object(ee.a)(td,"SharePointUploadCallerFactory",null,[765]);var Th=b(895);od.prototype.eoa=function(J,ea,Wa,Pb){this.IEc=!1;vd.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");
this.JLb();this.O8=J;Pb&&Pb.SaveEntryPoint&&(this.fQc=Pb.SaveEntryPoint);this.BCa=this.tSc.create(J,ea,Wa,Pb);Pb&&"true"===Pb.SkipSaveToHost?this.xQ():this.eCh()};od.prototype.eCh=function(){function J(){vd.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");ea.xQ()}var ea=this;32!==this.La.se(Xf.a.LQa,2,[function(){vd.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");ea.xQ()},J])&&J()};od.prototype.xQ=
function(){vd.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.BCa.execute(Object(vf.a)(this,this.EPi,"onSaveToSharePointUploadFinished"),Object(vf.a)(this,this.DPi,"onSaveToSharePointUploadFailed"))};od.prototype.EPi=function(J){if(J&&J.data&&J.data.ke){var ea=ii.d(J.data.ke);var Wa=ea.Wt;if(ea.returnValue)if(Wa.StatusCode!==Bg.a.bP&&Wa.StatusCode!==Bg.a.rrb)vd.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
J.data.status,Wa.StatusCode),Wa.StatusCode!==Bg.a.DRf&&this.pIe(J.data.status)||(this.sda(Wa.StatusCode.toString()),this.Oxj(Wa.StatusCode));else{vd.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.RJd();try{Wa.NewDocumentUrl?this.PPa(Wa.NewDocumentUrl):this.QPa()}catch(Pb){vd.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",Pb.toString())}}else Wa={},vd.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",(Wa.ResponseData=Ga.a.veb(J.data.ke),
Wa)),this.T6b()||(this.sda("Failed to deserialize response"),this.HLb())}else vd.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.T6b()||(this.sda("Unknown"),this.HLb())};od.prototype.DPi=function(J){J&&J.data?this.pIe(J.data.status)||(vd.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.sda(Th.a[J.data.status]),this.HLb()):(vd.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.T6b()||(this.sda("Unknown"),this.HLb()))};od.prototype.T6b=
function(){if(!this.IEc)return vd.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.IEc=!0,this.xQ(),!0;vd.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1};od.prototype.pIe=function(J){vd.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",J);return this.T6b()};od.prototype.QPa=function(){vd.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");ve.a.mf(this.O8,ve.a.EX(3),void 0,"UploadToSharePointManager.RedirectToFolder")};
od.prototype.PPa=function(J){var ea=!1,Wa=!1;Ud.AFrameworkApplication.fa&&(ea=Ud.AFrameworkApplication.fa.ra("SaveACopyIsEnabledForUiHost"),Wa=Ud.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures"));vd.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",J,ea);if(ea&&Wa){vd.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Pb={};Pb[Rg.a.KPa]="1";Pb[Rg.a.documentUrl]=J;Pb[Rg.a.reason]=
ff.a.saveAs;Ud.AFrameworkApplication.wV().execute(function(Cc){Cc.Gj(hh.a.Xta,Pb)})}else ve.a.mf(J,ve.a.EX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")};od.prototype.JLb=function(){this.ff&&1===this.ff.state||(this.Em=this.Kkb(),this.Em.message=CommonUIStrings.l_CommentProgressTooltip,this.Em.ic=5,this.Em.fv=!1,this.Em.HAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};od.prototype.pIa=function(){this.Em&&(this.Em.close(),this.Em=null)};od.prototype.HLb=function(){this.si(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)};od.prototype.Lyj=function(){this.si(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)};od.prototype.Uxj=function(){var J=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.si(CommonUIStrings.l_SaveAsFileTooLargeTitle,J,Gf.a.Ohj)};od.prototype.si=function(J,ea,Wa){Wa=void 0===Wa?Gf.a.Shj:Wa;vd.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",J,ea);this.pIa();1!==this.ff.state&&
this.Fs().THe(J,ea,Wa)};od.prototype.Oxj=function(J){vd.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",J);switch(J){case Bg.a.$$f:this.Lyj();break;case Bg.a.DRf:this.Uxj();break;default:this.HLb()}};od.prototype.RJd=function(){"VersionHistory"===this.fQc&&this.La.processAction(Xf.a.rtc,2)};od.prototype.sda=function(J){if("VersionHistory"===this.fQc){var ea={};this.La.se(Xf.a.TJd,2,(ea.FailureReason=J,ea))}};Object(ee.a)(od,"UploadToSharePointManager",null,[764]);Bc.prototype.init=
function(){};Bc.prototype.dispose=function(){};Bc.prototype.fi=function(J){var ea=this;this.tb=J;this.pNc=qc.a.ar(J.kc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.uNc=qc.a.ar(J.kc("Common.IEventEmitter<Common.IMruResult>"));this.ura=qc.a.ar(J.kc("Common.App.SharedFilePicker.ISharedFilePicker"));Wc.Task.WAA.call(null,this.pNc,this.uNc,this.ura).continueWith(function(){ea.R5i()})};Bc.prototype.R5i=function(){var J=this;this.tb.register(td,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Oc(function(){return new td(Ud.AFrameworkApplication.fa)}).Hc();
this.tb.register(od,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Oc(function(){return new od(Ud.AFrameworkApplication.Ib,J.tb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),function(){return(new ki.a).create()},function(){return new Wh},Ud.AFrameworkApplication.sa)}).Hc();this.tb.register(Ve,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Oc(function(){return new Ve(J.tb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
function(){return new Wh},J.tb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),Ud.AFrameworkApplication.sa)}).Hc();this.tb.register(Cg,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Oc(function(){return new Cg(J.tb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new Sf.a(function(){return J.pNc.result}),Ud.AFrameworkApplication.sa,function(){return new yf})}).Hc();this.tb.register(hg,
"Common.App.SaveToSharePoint.FileNameDialogFactory").Oc(function(){return new hg(Ud.AFrameworkApplication.fa,Ud.AFrameworkApplication.Ib,Ud.AFrameworkApplication.sa,Ud.AFrameworkApplication.sa.Qa,J.tb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),J.tb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),J.tb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new Sf.a(function(){return J.uNc.result}),J.tb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
J.ura?J.ura.result:null)}).Hc();this.tb.register(Pe,"Common.App.SaveToSharePoint.SaveToSharePointActor").Oc(function(){return new Pe(Ud.AFrameworkApplication.fa,Ud.AFrameworkApplication.Ib,J.tb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),J.tb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),J.tb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),J.tb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),function(){return Ud.AFrameworkApplication.sa.QTg})}).Hc();
Ud.AFrameworkApplication.fa.ra("SaveToAnotherFolderBrsIsEnabled")&&this.tb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Og()};Bc.main=function(){Yg.a.instance.gj(new Bc)};Ck.Object.defineProperties(Bc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToSharePoint"}}});Object(ee.a)(Bc,"PackageManager",null,[4,5]);var Bi=Dc.StandardDialog;Wl(gg,Bi);gg.prototype.displayError=function(J){this.Wz(J,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)};Object(ee.a)(gg,"ErrorDialog",Dc.StandardDialog,[739]);vg.default=0;Object(ee.a)(vg,"SaveToCloudErrorCodes",null,[]);kg.prototype.start=function(J){this.Mh=J;if("SharePointOnlineConsumer"===this.wb.Va("FileSource")){var ea=Kb.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(ea){ea.start(null,J);return}}this.g2.KLa?(vd.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.mTg()):(vd.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),
this.showSignInDialog())};kg.prototype.showSignInDialog=function(){this.Jvg.create().oQ()};kg.prototype.si=function(){this.Fs().displayError(vg.default)};kg.prototype.mTg=function(){try{vd.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");var J={},ea=(J.client_id=this.wb.appSettings.UploadToSkyDriveClientId,J.env="INT",J);if(1===this.rQb||2===this.rQb)J={},ea=(J.client_id=this.wb.appSettings.UploadToSkyDriveClientId,J);J={};var Wa=(J.mode="save",J.lightbox="grey",J);WL.init(ea);vd.ULS.sendTraceTag(6590562,
216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog(Wa).then(Object(vf.a)(this,this.onSuccess,"onSuccess"),Object(vf.a)(this,this.n6,"onFailure"))}catch(Pb){vd.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Pb,Pb.stack),this.si()}};kg.prototype.onSuccess=function(J){vd.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");J&&J.data&&J.data.folders&&this.bmb.eoa(J.data.folders[0].id,J.data.folders[0].urls.viewInBrowser,
null,this.Mh)};kg.prototype.n6=function(J){if(J&&J.error){if("user_canceled"===J.error.code){vd.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}vd.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",J.error.code,J.error.message)}else vd.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.si()};Object(ee.a)(kg,"SaveToCloudManager",null,[738]);Le.prototype.a7a=function(){return this.wb.ra("SaveToCloudStorageUIIsEnabled")};
Le.prototype.AVe=function(){return Xf.a.saveToCloudStorage};Le.prototype.o1b=function(){jf.a.hHd(Object(vf.a)(this,this.MUf,"saveToCloudActionDispatcher"));jf.a.L7c([new jg.a(Xf.a.saveToCloudStorage,Eh.a.frame,0)],this.ece.O3a())};Le.prototype.Og=function(){var J=this,ea=this.ece.O3a();ea?(ea.L9(function(){J.L$d.setResult(!0)}),this.o1b()):vd.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")};Le.prototype.$Lf=function(){vd.ULS.sendTraceTag(6590597,
216,50,"User clicked on SaveToOneDrive button")};Le.prototype.MUf=function(J,ea,Wa,Pb,Cc){var pd=this;return ea.contextId!==Eh.a.frame||J!==this.AVe()?2:this.a7a()?1===Wa?Fh.SessionStatusManager.instance.Dwb||Ud.AFrameworkApplication.n5?8:32:2===Wa?(this.$Lf(),Cc&&Cc.FileDownloadUrl&&vd.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Dh&&(this.KVb=this.Dh.Gc("DialogShown","SaveToOneDriveReponseTime")),this.L$d.task.continueWith(function(){pd.KVb&&(pd.KVb.stop(),
pd.KVb=null);pd.Mug.start(Cc)}),32):8:8};Object(ee.a)(Le,"SaveToCloudStorageActor",null,[737]);var ri=b(261),pi=Dc.StandardDialog;Wl(Pf,pi);Pf.prototype.oQ=function(){this.g2.rYa(Object(vf.a)(this,this.bCf,"onSignIn"));this.Ak(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(vf.a)(this,this.uai,"inputHandler"))};Pf.prototype.uai=function(J){0===J?(vd.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.I6()};Pf.prototype.XVg=
function(){var J="2";if(this.MX)switch(this.MX.Sj){case 3:J="0";break;case 2:J="3";break;case 1:J="1"}return J};Pf.prototype.hide=function(){this.g2.KHb(Object(vf.a)(this,this.bCf,"onSignIn"));pi.prototype.hide.call(this)};Pf.prototype.I6=function(){var J=new ri.QueryStringBuilder("Signin.aspx");J.Wi("prompt","1");J.Wi("cbcxt",this.XVg());Ud.AFrameworkApplication.iYa(J);ve.a.mf(J.toString(),"LoginWindow",void 0,"SignInDialog")};Pf.prototype.bCf=function(){this.Nq&&this.hide();vd.ULS.sendTraceTag(7143885,
216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(Xf.a.saveToCloudStorage,2)};Object(ee.a)(Pf,"SignInDialog",Dc.StandardDialog,[773]);Re.prototype.create=function(){return new Pf(this.La,this.g2,this.MX)};Object(ee.a)(Re,"SignInDialogFactory",null,[736]);Ce.prototype.execute=function(J,ea){if(!Ud.AFrameworkApplication.Ng&&Ud.AFrameworkApplication.Jd){var Wa=this.eFa+this.yfa;Wa=zg.a.El(Wa,"fo",cg.a.nf(this.zSb));Wa=zg.a.El(Wa,"fn",cg.a.nf(this.nA));
Wa=zg.a.El(Wa,"qs",cg.a.nf(this.cPc));Wa=zg.a.El(Wa,"n",cg.a.nf((new Date).getTime().toString()));this.Mh&&this.Mh.FileDownloadUrl&&(Wa=zg.a.El(Wa,"furl",cg.a.nf(this.Mh.FileDownloadUrl)));this.BVa&&(Wa=zg.a.El(Wa,"fnn",cg.a.nf(this.BVa)));Ud.AFrameworkApplication.Jd.gm(Wa,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,J,ea,null)}};Object(ee.a)(Ce,"SkyDriveUploadCaller",null,[772]);Rd.prototype.create=function(J,ea,Wa){return new Ce(this.fFa,this.nA,ea,J,Ud.AFrameworkApplication.nj,
this.yfa,Wa)};Object(ee.a)(Rd,"SkydriveUploadCallerFactory",null,[735]);Gc.prototype.JLb=function(){this.ff&&1===this.ff.state||(this.Em=this.Kkb(),this.Em.message=CommonUIStrings.l_CommentProgressTooltip,this.Em.ic=5,this.Em.fv=!1,this.Em.HAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};Gc.prototype.pIa=function(){this.Em&&(this.Em.close(),this.Em=null)};Gc.prototype.tS=function(){1!==Ud.AFrameworkApplication.sa.state&&this.Fs().displayError(vg.default)};Gc.prototype.QPa=function(){vd.ULS.sendTraceTag(6590599,
216,50,"Redirecting to OneDrive Folder.");ve.a.mf(this.O8,ve.a.EX(3),void 0,"UploadToCloudManager.RedirectToFolder")};Gc.prototype.PPa=function(J){var ea=!1,Wa=!1;Ud.AFrameworkApplication.fa&&(ea=Ud.AFrameworkApplication.fa.ra("SaveACopyIsEnabledForUiHost"),Wa=Ud.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures"));vd.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",J,ea);if(ea&&Wa){vd.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
var Pb={};Pb[Rg.a.KPa]="1";Pb[Rg.a.documentUrl]=J;Ud.AFrameworkApplication.wV().execute(function(Cc){Cc.Gj(hh.a.Xta,Pb)})}else ve.a.mf(J,ve.a.EX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")};Gc.prototype.eoa=function(J,ea,Wa,Pb){Wa=void 0===Wa?null:Wa;Pb=void 0===Pb?null:Pb;vd.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Dh&&(this.zga=this.Dh.Gc("DialogShown","SaveToOneDriveUploadTime"));this.JLb();this.O8=ea;this.BCa=this.tSc.create(J,Wa,Pb);this.Mh=Pb;this.xQ()};Gc.prototype.xQ=
function(){vd.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.BCa.execute(Object(vf.a)(this,this.CPi,"onSaveToCloudUploadFinished"),Object(vf.a)(this,this.BPi,"onSaveToCloudUploadFailed"))};Gc.prototype.CPi=function(J){this.pIa();this.jDa=!1;if(J&&J.data&&J.data.ke){var ea=ii.d(J.data.ke);var Wa=ea.Wt;if(ea.returnValue)if(Wa.StatusCode!==Bg.a.bP&&Wa.StatusCode!==Bg.a.rrb)vd.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.tS();
else{vd.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{Wa.NewDocumentUrl&&""!==Wa.NewDocumentUrl?this.PPa(Wa.NewDocumentUrl):this.QPa()}catch(Pb){vd.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",Pb.toString())}this.PFb()}else Wa={},vd.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",(Wa.ResponseData=Ga.a.veb(J.data.ke),Wa)),this.tS()}else vd.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),
this.tS()};Gc.prototype.BPi=function(J){5!==J.data.status&&12!==J.data.status||this.jDa?(vd.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",J.data.status),this.pIa(),this.tS(),this.PFb()):(vd.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.jDa=!0,this.xQ())};Gc.prototype.PFb=function(){this.zga&&(this.zga.stop(),this.zga=null)};Object(ee.a)(Gc,"UploadToCloudManager",null,[733]);id.prototype.init=function(){Ud.AFrameworkApplication.fa.ra("SaveToCloudStorageUIIsEnabled")&&
this.tb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Og()};id.prototype.dispose=function(){};id.prototype.fi=function(J){this.tb=J;this.tb.register(Re,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Oc(function(){return new Re(Ud.AFrameworkApplication.Ib,Df.a.instance,Ud.AFrameworkApplication.sa.Qa)}).Hc();this.tb.register(Rd,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Oc(function(){return new Rd(Ud.AFrameworkApplication.fa)}).Hc();
this.tb.register(Le,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Oc(function(){return new Le(J.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),J.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),Ud.AFrameworkApplication.fa,Ud.AFrameworkApplication.sa.yD)}).Hc();this.tb.register(Gc,"Common.App.SaveToCloudStorage.UploadToCloudManager").Oc(function(){return new Gc(J.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new ki.a).create()},
function(){return new gg},Ud.AFrameworkApplication.sa,Ud.AFrameworkApplication.sa.yD)}).Hc();this.tb.register(kg,"Common.App.SaveToCloudStorage.SaveToCloudManager").Oc(function(){return new kg(J.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Df.a.instance,J.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),Ud.AFrameworkApplication.fa,Ud.AFrameworkApplication.V1a,function(){return new gg})}).Hc()};id.main=function(){Yg.a.instance.gj(new id)};Ck.Object.defineProperties(id.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToCloudStorage"}}});Object(ee.a)(id,"PackageManager",null,[4,5]);Ck.Object.defineProperties(jc,{hg:{configurable:!0,enumerable:!0,get:function(){return Of.a.$o(jc.zk,CommonUIStrings.l_SaveACopyFileName)}}});jc.zk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(ee.a)(jc,"FileNameDialogHtml",null,[]);var vi=Of.a;Wl(qb,vi);qb.prototype.oQ=function(J,ea,Wa){this.zSb=J;this.O8=Wa;J={};ea=(J.txtFileName=cg.a.Gq(Ud.AFrameworkApplication.jm.dn),J.lblFolderName=String.format(CommonUIStrings.l_DestinationFolder,ea),J);this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(vf.a)(this,this.n9b,"fileNameDialogHandler"),ea);vd.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()};
qb.prototype.n9b=function(J,ea){1!==J?vd.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(J=ea.txtFileName.trim(),vd.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),ea=cg.a.u4(Ud.AFrameworkApplication.fileName),J&&""!==J&&""!==ea&&(J+=ea),this.bmb.eoa(this.zSb,this.O8,J,this.Mh))};Object(ee.a)(qb,"FileNameDialog",Of.a,[784]);Aa.prototype.create=function(J){return new qb(this.La,this.MX,this.bmb,J)};Object(ee.a)(Aa,"FileNameDialogFactory",
null,[740]);var jh=Dc.StandardDialog;Wl(da,jh);da.prototype.displayError=function(J){vd.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",J);this.Wz(J,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(vf.a)(this,this.$Kd,"retryDialogHandler"))};da.prototype.$Kd=function(J){1===J?(vd.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.La.processAction(Xf.a.saveACopy,2)):vd.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};
Object(ee.a)(da,"RetryDialog",Dc.StandardDialog,[739]);Wl(Xb,Le);Xb.prototype.a7a=function(){return this.wb.ra("SaveACopyBrsIsEnabled")};Xb.prototype.AVe=function(){return Xf.a.saveACopy};Xb.prototype.o1b=function(){jf.a.hHd(Object(vf.a)(this,this.MUf,"saveToCloudActionDispatcher"));jf.a.L7c([new jg.a(Xf.a.saveACopy,Eh.a.frame,0)],this.Bsg.O3a())};Xb.prototype.$Lf=function(){vd.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")};Object(ee.a)(Xb,"SaveACopyActor",Le,
[]);Wl(ng,kg);ng.prototype.onSuccess=function(J){J&&J.data&&J.data.folders?(vd.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.Gng.create(this.Mh).oQ(J.data.folders[0].id,J.data.folders[0].name,J.data.folders[0].urls.viewInBrowser)):(vd.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.si())};ng.prototype.n6=function(J){J&&J.error&&"user_canceled"===J.error.code&&vd.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");
kg.prototype.n6.call(this,J)};ng.prototype.si=function(){vd.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");kg.prototype.si.call(this)};Object(ee.a)(ng,"SaveACopyManager",kg,[]);Wl(ef,Gc);ef.prototype.Opd=function(){return!!this.Mh&&!!this.Mh.SaveEntryPoint&&"VersionHistory"===this.Mh.SaveEntryPoint.toString()};ef.prototype.tS=function(){vd.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");if(this.Opd()){var J={};this.La.se(Xf.a.TJd,2,(J.FailureReason="Unknown",
J))}Gc.prototype.tS.call(this)};ef.prototype.QPa=function(){vd.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Opd()&&this.La.processAction(Xf.a.rtc,2);Gc.prototype.QPa.call(this)};ef.prototype.PPa=function(J){vd.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",J);this.Opd()&&this.La.processAction(Xf.a.rtc,2);Gc.prototype.PPa.call(this,J)};ef.prototype.xQ=function(){var J=this;this.Mh&&"true"===this.Mh.SkipSaveToHost?Gc.prototype.xQ.call(this):
32!==this.La.processAction(Xf.a.LQa,1)?(vd.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),Gc.prototype.xQ.call(this)):this.La.se(Xf.a.LQa,2,[function(){vd.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Gc.prototype.xQ.call(J)},function(){vd.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");J.tS()}])};Object(ee.a)(ef,"SaveACopyUploadToCloudManager",
Gc,[]);Og.prototype.init=function(){Ud.AFrameworkApplication.fa.hv(Object(vf.a)(this,this.vB,"onFullAppSettingsReady"))};Og.prototype.vB=function(){Ud.AFrameworkApplication.fa.ra("SaveACopyBrsIsEnabled")&&this.tb.resolve("Common.App.SaveACopy.SaveACopyActor").Og()};Og.prototype.dispose=function(){};Og.prototype.fi=function(J){this.tb=J;this.tb.register(ef,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Oc(function(){return new ef(Ud.AFrameworkApplication.Ib,J.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
function(){return(new ki.a).create()},function(){return new da(Ud.AFrameworkApplication.Ib)},Ud.AFrameworkApplication.sa,Ud.AFrameworkApplication.sa.yD)}).Hc();this.tb.register(Aa,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Oc(function(){return new Aa(Ud.AFrameworkApplication.Ib,Ud.AFrameworkApplication.sa.Qa,J.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))}).Hc();this.tb.register(Xb,"Common.App.SaveACopy.SaveACopyActor").Oc(function(){return new Xb(J.resolve("Common.App.SaveACopy.SaveACopyManager"),
J.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),Ud.AFrameworkApplication.fa,Ud.AFrameworkApplication.sa.yD)}).Hc();this.tb.register(ng,"Common.App.SaveACopy.SaveACopyManager").Oc(function(){return new ng(J.resolve("Common.App.SaveACopy.FileNameDialogFactory"),J.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Df.a.instance,J.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),Ud.AFrameworkApplication.fa,Ud.AFrameworkApplication.V1a,function(){return new da(Ud.AFrameworkApplication.Ib)})}).Hc()};
Og.main=function(){Yg.a.instance.gj(new Og)};Ck.Object.defineProperties(Og.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveACopy"}}});Object(ee.a)(Og,"PackageManager",null,[4,5]);var Ng;(function(J){J[J.myFiles=0]="myFiles";J[J.recent=1]="recent";J[J.currentFolder=2]="currentFolder";J[J.yourPhone=3]="yourPhone"})(Ng||(Ng={}));Object(ee.b)("SharedFilePickerLandingLocation",Ng);Jg.prototype.R1a=function(J){this._initialized||(J.jo(hh.a.ILf),J.Tl(hh.a.ILf,Object(vf.a)(this,
this.MOi,"onReceivedPickerResponse")),this._initialized=!0)};Jg.prototype.Hdd=function(J){var ea=this;return this.fLa=new Promise(function(Wa,Pb){var Cc={};Cc[Rg.a.uWi]=J;ea.aab=function(pd,wd){""===wd?(vd.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Wa(pd)):("Canceled"===wd?vd.ULS.sendTraceTag(572548164,306,50,wd):vd.ULS.sendTraceTag(556901065,306,10,wd),Pb(wd))};ea.Njd.execute(function(pd){ea.R1a(pd);pd.Gj(hh.a.CTi,Cc)})})};Jg.prototype.MOi=function(J){this.aab(J.Values[Rg.a.lkj],
void 0===J.Values[Rg.a.ZCd]||null===J.Values[Rg.a.ZCd]?"":J.Values[Rg.a.ZCd])};Jg.prototype.cqd=function(){return Ud.AFrameworkApplication.fa.ra("UiHostCommonFilePicker")};Jg.prototype.bDe=function(J,ea,Wa,Pb,Cc,pd,wd){var ue=void 0===ue?null:ue;var Je={};Je[Rg.a.Yjj]=J;Je[Rg.a.titleText]=ea;Je[Rg.a.sIg]=Wa;Je[Rg.a.tIg]=Pb;Je[Rg.a.uIg]=!1;Je[Rg.a.ofh]=!0;Je[Rg.a.Gyh]=Cc;Je[Rg.a.yWi]=pd;Je[Rg.a.xWi]=Ng[wd];Eg.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Je[Rg.a.zWi]="Dark");ue&&
(null!=ue.UVc&&(Je[Rg.a.UVc]=ue.UVc),null!=ue.Hkd&&(Je[Rg.a.Hkd]=ue.Hkd));return Je};Object(ee.a)(Jg,"SharedFilePickerManager",null,[729]);fg.prototype.fi=function(J){this.tb=J;J.register(Jg,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").Hc().Oc(function(){return new Jg(J.kc("Postmessage.IHostPostmessenger"))})};fg.prototype.init=function(){var J=this;Ud.AFrameworkApplication.fa.hv(function(){J.Lxb()})};fg.prototype.Lxb=function(){this.tb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")};
fg.prototype.dispose=function(){};fg.main=function(){Yg.a.instance.gj(new fg)};Ck.Object.defineProperties(fg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SharedFilePicker"}}});Object(ee.a)(fg,"SharedFilePickerPackage",null,[4,5]);var ji=b(1336),we=b(1047);Jf.prototype.vke=function(J){var ea=!1;J&&(J.P2c(),J.CRg&&(ea=!1));return ea};Jf.prototype.t4g=function(){var J=Ud.AFrameworkApplication.sa.Qa;J=new ji.a(J.Sj,we.a.kcc(),!1,1===J.oca);this.vke(J)&&vd.ULS.sendTraceTag(17571982,
306,50,"ChromeExtBannerDisplayed")};Jf.prototype.M4b=function(J,ea,Wa,Pb,Cc,pd){J=new ji.a(J,Wa,Pb,ea,Cc,pd);this.vke(J)&&vd.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")};Jf.prototype.y$g=function(){var J=Ud.AFrameworkApplication.sa.Qa,ea=Ud.AFrameworkApplication.fa,Wa=J.Sj,Pb=1===J.oca;if(ea.ra(we.a.EZh(Wa))){var Cc=we.a.kcc(),pd=8<sg.a.b5a;if(2!==Wa||2!==Cc||!Pb){ea=ea.ra(we.a.FZh(Wa));var wd=J.mUf(),ue=function(){return J.Gx};ea&&!we.a.Cod(we.a.ucd(Wa))&&this.M4b(Wa,Pb,Cc,pd,ue,wd)}}};
Jf.prototype.init=function(){var J=Ud.AFrameworkApplication.fa,ea=J.ra("WildFireChromeExtensionEnabled");J=J.ra("WildFireChromeExtensionBar")&&ea;we.a.mxc&&J&&!we.a.Cod(we.a.Bxe)?this.t4g():(document.body&&we.a.pwj&&this.y$g(),Ud.AFrameworkApplication.Ib.fc(Xf.a.tsd,Eh.a.frame,Object(vf.a)(this,this.tsd,"launchWildFireBusinessBar")))};Jf.prototype.tsd=function(J,ea,Wa,Pb,Cc){if(1===Wa)return 32;if(!Cc)return 8;this.M4b(Cc.app,Cc.mode,Cc.platform,Cc.useTwoButton,null,null);return 32};Jf.prototype.dispose=
function(){};Jf.prototype.fi=function(){};Jf.main=function(){Yg.a.instance.gj(new Jf)};Ck.Object.defineProperties(Jf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WildFire"}}});Object(ee.a)(Jf,"PackageManager",null,[4,5]);var vh=b(229),Ph=b(1322),Mf=vh.a;Wl(Dg,Mf);Dg.prototype.create=function(){this.Eb(this.$.da.za(5)||new Ph.a(this.$,!this.$.iba))};Dg.ka=function(J){J.da.Ga(4,new Dg(J))};Object(ee.a)(Dg,"BusinessBarManagerFactory",vh.a,[]);var rf=b(11),oi;"undefined"==
typeof oi&&(oi={});window.MSOJS=oi;oi.bgb=function(){function J(){return wd()&&(Mj()||3<=(Qh()?uk("version/"):0))}function ea(){return 0<=window.navigator.userAgent.indexOf("Windows")}function Wa(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function Pb(){Bf||(Bf=!0,Tg=Cc("Windows Phone"))}function Cc(Tf){Tf=(new RegExp(Tf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var ph=-1;return null!=Tf&&2<=Tf.length&&(ph=parseFloat(Tf[1]),isNaN(ph)&&(ph=-1)),ph}function pd(){return"function"==
typeof navigator.msLaunchUri&&!Wa()&&!Jj()&&!ue()}function wd(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function ue(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function Je(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function tg(){return Je()?8==window.document.documentMode:!1}function oh(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function Qh(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}
function ni(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Jj(){var Tf=window.navigator.userAgent.toLowerCase();return 0<=Tf.indexOf("android")&&0<=Tf.indexOf("chrome")}function Mj(){return 3<=(oh()?uk("firefox/"):0)}function uk(Tf){var ph=window.navigator.userAgent.toLowerCase(),ei=ph.indexOf(Tf),Rh,Li;return 0<=ei?(Rh=ei+Tf.length,Li=ph.length,parseInt(ph.substring(Rh,Li))):0}function H(Tf,ph,ei,Rh,Li){if(Rh&&null!=ph)ph();else if(pd())navigator.msLaunchUri(Tf,ph,
ei);else if(!(ni()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&wd())||ue())ib(Tf,ph,ei);else if(ni()&&Li)a:{try{window.open(Tf,"_self")}catch(ij){null!=ei&&ei();break a}null!=ph&&ph()}else ia(Tf,ph,ei)}function ia(Tf,ph,ei){var Rh=document.getElementById("OICLinkTag"),Li;null==Rh&&(Rh=document.createElement("a"),Rh.id="OICLinkTag",Rh.style.visibility="hidden",Rh.href="",Rh.target=0==(ud.Options&Wg.SupportsTopTargetNavigation)||
ud.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(Rh),null!=Rh.addEventListener&&Rh.addEventListener("click",function(ij){null!=ij.stopPropagation&&ij.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(Li=function(ij){var aj=document.createEvent("MouseEvent");return aj.initMouseEvent(ij,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),aj},Li.prototype=Event.prototype,window.MouseEvent=Li),Rh.href=Tf,Rh.dispatchEvent(new MouseEvent("click"))}catch(ij){null!=ei&&ei();return}null!=
ph&&ph()}function ib(Tf,ph,ei){var Rh=document.getElementById("OICFrame");null==Rh&&(Rh=document.createElement("iframe"),Rh.className="ObjectInDialog",Rh.style.visibility="hidden",Rh.src="about:blank",document.body.appendChild(Rh),Rh.id="OICFrame");try{Rh.contentWindow.location.href=Tf}catch(Li){null!=ei&&ei();return}null!=ph&&ph()}function Lb(Tf){return 0!=(Tf.Options&Wg.SkipProtocolHandler)||tg()}function Nc(Tf){return Tf===$g.ReadOnly||Tf===$g.ReadWrite}function Vc(Tf,ph,ei,Rh){var Li,ij;try{if(Li=
new ActiveXObject(ul),Li)return ij=Li.ViewDocument3(window.self,Tf,ph,Rh),ij?(tj(Ri.O14ActiveX),qh.None):qh.Failed}catch(aj){}if(Wg.O14Only===(ei&Wg.O14Only))return ud.DescriptiveUnattemptedEnums?qh.O14AttemptFailure:qh.Unattempted;try{if(Li=new ActiveXObject($k),Li)return ij=Li.ViewDocument3(window.self,Tf,ph,Rh),ij?(tj(Ri.O12ActiveX),qh.None):qh.Failed}catch(aj){}if(Wg.O12UpOnly===(ei&Wg.O12UpOnly))return ud.DescriptiveUnattemptedEnums?qh.O12UpOnlyFail:qh.Unattempted;try{if(Li=new ActiveXObject(al),
Li)return ij=Nc(ph)?Li.ViewDocument2(window.self,Tf,Rh):Li.EditDocument2(window.self,Tf,Rh),ij?(tj(Ri.O11ActiveX),qh.None):qh.Failed}catch(aj){}return ud.DescriptiveUnattemptedEnums?qh.ActiveXUnattempted:qh.Unattempted}function Hd(Tf,ph,ei,Rh,Li){var ij,aj,wk;Tf==ci.Visio&&ei==$g.ReadWrite&&(ei=$g.WriteOnly);Tf=Li;(Rh=Rh||Wa()&&!(Pb(),8<=Tg))||(ij="",ij+=Nc(ei)?Vk+xl:yl,ij+=vl,Tf+=Be(ij));Tf+=Be(ph);ud.NewTelemetryDataIsEnabled&&(aj=-1!==Tf.indexOf("?")?"&":"?",aj+=ud.SessionOrigin?"OR="+ud.SessionOrigin+
"&":"",aj+=ud.ClickTime?"CT="+ud.ClickTime+"&":"",aj+=ud.CorrelationId?"CID="+ud.CorrelationId:"",aj="?"!=aj?aj:"",aj="&"!=aj.slice(-1)?aj:aj.slice(0,-1),Tf+=Be(aj),ud.CorrelationIdForWinClient&&(Tf+=Be(ud.CorrelationIdForWinClient)));ph=window.location.href;ei=k;Rh=ph.toLowerCase().indexOf("&"+ei+"=");var Uj;ei=-1==Rh?void 0:(wk=Rh+(ei.length+2),Uj=ph.indexOf("&",wk),-1==Uj)?ph.substr(wk):ph.substring(wk,Uj);if(null!=ei&&"undefined"!=typeof ei){wk="";try{wk=decodeURIComponent(ei)}catch(ol){}0<wk.length&&
RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(wk)&&(Tf+=wl,Tf+=wk)}return Tf}function Ld(Tf,ph,ei,Rh,Li,ij){var aj=Ai(Tf),wk;return null==aj?(Yj(ud.DescriptiveUnattemptedEnums?qh.ProtocolHandlerIsNull:qh.Unattempted,ud.Application),!1):(wk=Hd(Tf,ph,ei,Rh,aj),H(wk,df,uf,Li,ij),!0)}function Be(Tf){if(wd()&&ni()){var ph="";try{ph=decodeURI(Tf)}catch(ei){}if(ph==Tf)return encodeURI(Tf)}return Tf}function df(){tj(Ri.ProtocolHandler)}function uf(){ud.Options|=Wg.SkipProtocolHandler;
pj(ud,ab,Qb)}function og(){null!=Fc&&Fc(Ri.RoamingProtocolHandler)}function dh(){null!=ld&&ld(qh.ControlNeeded)}function th(){var Tf=document.getElementById(Al),ph;if(null==Tf){if(ph=nl,wd()&&3<=(Qh()?uk("version/"):0)&&Ki(sl,!0)&&(ph=sl),!Ki(ph,!0))if(wd()&&Ki(zl,!0))ph=zl;else return null;Tf=document.createElement("object");Tf.id=Al;Tf.type=ph;Tf.style.width="0px";Tf.style.height="0px";Tf.style.setProperty("visibility","hidden","");document.body.appendChild(Tf);Tf=document.getElementById(Al)}return Tf}
function Ki(Tf,ph){var ei=window.navigator.mimeTypes,Rh;return null==ei?!1:(Rh=ei[Tf],Rh)?ph&&!Rh.enabledPlugin?!1:!0:!1}function xh(Tf){try{if(null!=new ActiveXObject(Tf))return!0}catch(ph){}return!1}function ui(Tf){switch(Tf){case ci.OneNote:return Bl;default:return""}}function Ai(Tf){if(Tf!=ci.OneNote&&Wa()&&!(Pb(),8<=Tg))return"office:";switch(Tf){case ci.Excel:return"ms-excel:";case ci.OneNote:return"onenote:";case ci.PowerPoint:return"ms-powerpoint:";case ci.Visio:return"ms-visio:";case ci.Word:return"ms-word:";
case ci.Project:return"ms-project:";case ci.Publisher:return"ms-publisher:";case ci.Infopath:return"ms-infopath:";case ci.Access:return"ms-access:";default:return""}}function Oj(Tf){switch(Tf){case ci.Excel:return"root\\office15\\excel.exe";case ci.PowerPoint:return"root\\office15\\powerpnt.exe";case ci.Visio:return"root\\office15\\visio.exe";case ci.Word:return"root\\office15\\winword.exe";case ci.Project:return"root\\office15\\winproj.exe";case ci.Publisher:return"root\\office15\\mspub.exe";case ci.Infopath:return"root\\office15\\infopath.exe";
case ci.Access:return"root\\office15\\msaccess.exe";default:return null}}function pj(Tf,ph,ei){if(ud=Tf,ab=ph,Qb=ei,Tf.DocumentUrl){var Rh=ei=ph=Tf.DocumentUrl;try{Rh=decodeURIComponent(Tf.DocumentUrl)}catch(ol){}try{ei=encodeURI(Tf.DocumentUrl)}catch(ol){}ud.NewTelemetryDataIsEnabled||(ph=ph+""+Tf.CorrelationIdForWinClient,Rh+=Tf.CorrelationIdForWinClient,ei+=Tf.CorrelationIdForWinClient);Tf.Mode===$g.ReadWrite&&Wg.CheckoutRequired===(Tf.Options&Wg.CheckoutRequired)&&(Tf.Mode=$g.ForceCheckout);Wg.HostIsEditOnly===
(Tf.Options&Wg.HostIsEditOnly)&&(Tf.Mode=$g.WriteOnly);if(Lb(Tf)?0:wd()&&(Tf.Application==ci.OneNote||Ki(Cl,!1)||Ki(Dl,!1))||pd()||Jj()||!(J()||Mj()||"ActiveXObject"in window&&!Wa()||ni())||15<=lk())Ld(Tf.Application,Tf.EncodeUrl?ei:ph,Tf.Mode,Tf.Application==ci.OneNote,Tf.SilentExternalHandler,Tf.NavigateUsingWindowOpen);else{var Li;if(Li=tg())a:{var ij=Tf.EncodeUrl?ph:Rh,aj=Tf.Mode,wk=ui(Tf.Application);try{Li=(new ActiveXObject(Hj)).ViewDocument3(window.self,ij,aj,wk);break a}catch(ol){}Li=!1}if(Li)tj(Ri.O15ActiveX);
else{if(J()||Mj()){var Uj=Tf.EncodeUrl?ph:Rh;Rh=Tf.Mode;Li=ui(Tf.Application);ij=th();if(null==ij)Uj=ud.DescriptiveUnattemptedEnums?qh.PluginIsNull:qh.Unattempted;else{aj=!1;try{aj=ij.ViewDocument3(window.self,Uj,Rh,Li)}catch(ol){}if(!aj)try{aj=Nc(Rh)?ij.ViewDocument2(window.self,Uj,Li):ij.EditDocument2(window.self,Uj,Li)}catch(ol){}Uj=aj?(tj(Ri.NpapiPlugin),qh.None):qh.Failed}}else{try{Uj=new ActiveXObject(El),null!=Uj&&Uj.SaveSSOCreds()}catch(ol){}Uj=Vc(Tf.EncodeUrl?ph:Rh,Tf.Mode,Tf.Options,ui(Tf.Application))}if(Uj!=
qh.None){if(Rh=Tf.CouldUseRoamingApps)jd||(jd=!0,Ye=Cc("Windows NT")),Rh=6.1<=Ye&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(Je()||Mj()||ni());if(Rh&&Tf.Application!=ci.OneNote){if(!oi.bgb.LWj()){Yj(qh.ControlNeeded,ud.Application);return}if(Tf.RoamingAppsLauncher){"undefined"==typeof Tf.RoamingAppsLauncher||null==Tf.RoamingAppsLauncher?Yj(ud.DescriptiveUnattemptedEnums?qh.RoamingLauncherIsNull:qh.Unattempted,ud.Application):"undefined"==typeof Tf.RoamingBitsUrl||null==Tf.RoamingBitsUrl?oi.bgb.cXj(Tf.DocumentUrl,
Tf.RoamingAppsLauncher,Tf.Application,Tf.ApplicationParameters,ab,Qb):oi.bgb.$hg(Tf.DocumentUrl,Tf.RoamingAppsLauncher,Tf.RoamingApplicationExe,Tf.ApplicationParameters,Tf.RoamingPlatform,Tf.RoamingBitsUrl,ab,Qb);return}if(!Tf.ContinueIfLauncherIsNull){Yj(qh.LauncherNeeded,ud.Application);return}}Wg.NoProtocolHandlerFallback==(Tf.Options&Wg.NoProtocolHandlerFallback)||Lb(Tf)||Je()||wd()&&!(ud.DescriptiveUnattemptedEnums?Uj>=qh.O14Unattempted&&Uj<=qh.DocumentUrlIsNull:Uj==qh.Unattempted)?Yj(Uj,ud.Application):
Ld(Tf.Application,Tf.EncodeUrl?ei:ph,Tf.Mode,Tf.Application==ci.OneNote,Tf.SilentExternalHandler,Tf.NavigateUsingWindowOpen)}}}}else Yj(ud.DescriptiveUnattemptedEnums?qh.DocumentUrlIsNull:qh.Unattempted,ud.Application)}function tj(Tf){null!=ab&&ab(Tf)}function Yj(Tf,ph){"undefined"==typeof ph&&(ph=null);null!=Qb&&Qb(Tf,ph)}function lk(){var Tf=0;if(J()||Mj()||ni()){var ph=th();try{null!=ph&&(Tf=ph.GetOfficeVersion())}catch(ei){}}else xh(Hj)?Tf=15:xh(ul)?Tf=14:xh($k)?Tf=12:xh(al)&&(Tf=11);return Tf}
function vk(){return wd()&&(Ki(nl,!0)||Ki(sl,!0))}var Hj="SharePoint.OpenDocuments.5",ul="SharePoint.OpenDocuments.4",$k="SharePoint.OpenDocuments.3",al="SharePoint.OpenDocuments.2",nl="application/x-sharepoint",sl="application/x-sharepoint-webkit",Cl="application/x-sharepoint-protocolhandler",Dl="application/x-sharepoint-webkit-protocolhandler",zl="application/officelive",Al="npSharePointPlugin",El="IDBHO.IDBHOCtrl",Bl="OneNote.Notebook",Vk="ofv|",xl="ofc|",yl="ofe|",vl="u|",wl="|f|",k="wdlor",F=
"",X="",ra="",ab,Qb,Fc,ld,ud,jd,Ye,Bf,Tg,$g={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Wg={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},qh={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,
RoamingLauncherIsNull:12,DocumentUrlIsNull:13},Ri={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},ci={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:$g,OpenDocumentOptions:Wg,OpenDocumentFailureType:qh,OpenDocumentControl:Ri,OfficeApplication:ci,EditDocumentInClient:pj,EditDocumentInClientParams:function(){this.DocumentUrl=
"";this.Options=this.Mode=0;this.Application=ci.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},
OfficeVersionInstalled:lk,IsO14MacPluginInstalled:vk,OfferOfficeInDialog:function(){return ea()&&11>=lk()},OfferOfficeNoIntrusive:function(){return ea()&&15>lk()},OfferMacOffice:function(){return wd()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!vk()},InstallRoamingControl:function(){oh()?window.InstallTrigger.install({Office:{URL:X}}):ib(ra,null,null)},CanUseRoamingControl:function(){var Tf,ph,ei;if(pd())return!0;if(ni())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),
!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(oh())return Tf=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(Tf),ph=document.createEvent("Events"),ph.initEvent("RoamingOfficeInstalled",!0,!1),Tf.dispatchEvent(ph),!!Tf.getAttribute("installed");if(Je())try{return ei=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),ei.HrExists()}catch(Rh){}return!1},InitUrls:function(Tf,ph,ei){F=Tf;X=ei;ra=ph},LaunchRoamingApps:function(Tf,ph,ei,Rh,Li,ij){oi.bgb.$hg(Tf,
ph,Oj(ei),Rh,"x86",F,Li,ij)},LaunchRoamingApps2:function(Tf,ph,ei,Rh,Li,ij,aj,wk){var Uj="",ol;if(null!=Rh&&(Uj+=" "+Rh),null!=Tf&&(Uj+=' "'+Tf+'"'),pd()||ni())Fc=aj,ld=wk,aj='office: "'+(ij+'" "')+(ei+'" "ROAMING"'),aj+=' "'+ph+'"',aj+=' "'+Li+'"',aj+=" "+Uj,H(aj,og,dh,!1,!1);else if(oh())Tf=document.createElement("RoamingExtensionElement"),Tf.setAttribute("cabUrl",ij),Tf.setAttribute("app",ei),Tf.setAttribute("licensingEntitlements",ph),Tf.setAttribute("platform",Li),Tf.setAttribute("args",Uj),
document.documentElement.appendChild(Tf),ph=document.createEvent("Events"),ph.initEvent("RoamingOfficeLaunch",!0,!1),Tf.dispatchEvent(ph),null!=aj&&aj(Ri.RoamingFFExtension);else if(Je()){if(ol=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=ol)try{ol.HrConfigureSingle(ij,ei,ph,Li,Uj),null!=aj&&aj(Ri.RoamingActiveX)}catch(Il){}}else null!=wk&&wk(qh.Failed)},ShouldShowDialog:function(){return!Wa()},NavigateToUrlUsingClickingOnATag:ia,OpenDocumentWithProtocolHandler:Ld,OpenDocumentWithProtocolHandlerNoCallBack:function(Tf,
ph,ei,Rh){var Li=Ai(Tf),ij;return null==Li?(Yj(ud.DescriptiveUnattemptedEnums?qh.ProtocolHandlerNoCallbackIsNull:qh.Unattempted,ud.Application),!1):(ij=Hd(Tf,ph,ei,Rh,Li),H(ij,null,null,!1,!1),!0)}}}();oi.ClientUtils=oi.bgb;var bh=b(903),ah=b(51),wh=b(37),xi=b(186);Ae.prototype.$c=function(){return!1};Ae.prototype.executeCommand=function(J,ea,Wa){return 2!==this.Ci.se(Xf.a.newDocument,2,Wa)?Wc.Task.Sa(!0):xi.a(ea.command)};Ae.prototype.Mc=function(J,ea){return 1056925771===ea.command};Ae.prototype.jd=
function(J,ea,Wa){J=!0;switch(ea){case "PopulateNewMenu":this.Ci&&this.Ci.se(Xf.a.Zpc,2,Wa);break;default:J=!1}return J};Object(ee.a)(Ae,"CreateNewCommandHandler",null,[428]);var O=bh.a;Wl(nh,O);nh.prototype.Od=function(){var J=this,ea=ah.GetServiceTaskFactory.create(this.$.da,155,this.la,this.vb),Wa=ah.GetServiceTaskFactory.create(this.$.da,165,this.la,this.vb);wh.TaskExtensions.Ba(wh.TaskExtensions.te([ea,Wa],this.la),function(){J.Cd([new Ae(Ud.AFrameworkApplication.Ib)])},this.la,3)};nh.ka=function(J){bh.a.ee(87,
new nh(J))};Object(ee.a)(nh,"CreateNewCommandHandlerFactory",bh.a,[]);var fa=b(1318),Va=b(960),d=b(277),r=b(207),S=b(300),ca=b(5),Ka=b(160),fc=b(102),pb=b(79),Z=b(75),Ba=b(386),Fb=b(175),xc=b(59),Pc=b(83),Sc=b(336),oe=b(647);Hg.prototype.Nre=function(){};Hg.prototype.t6c=function(){this.Gsg?ve.a.downloadFile(this._url):ve.a.mf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")};Hg.prototype.dispose=function(){};Object(ee.a)(Hg,"OpenUrlInTabDialogDownloadBehavior",null,[233,
3]);var gf=b(273),xf=Dc.StandardDialog;Wl(Mg,xf);Mg.prototype.aXc=function(){this.cm&&(this.GVa||(this.GVa=Object(vf.a)(this,this.kEi,"onActionButtonClicked"),this.My.pa(ug.a.click,this.QB,this.GVa)),this.HVa||(this.HVa=Object(vf.a)(this,this.lEi,"onActionButtonKeyUp"),this.pe.pa(ug.a.Vd,this.QB,this.HVa)));xf.prototype.aXc.call(this)};Mg.prototype.kEi=function(J){this.EQe(J);return!0};Mg.prototype.lEi=function(J){return this.aif(J,Object(vf.a)(this,this.EQe,"executeDismissActionButtonFromArgs"))};
Mg.prototype.EQe=function(J){this.cm&&this.cm.submit();this.yua(J.Lb)};Mg.prototype.ptd=function(){};Mg.prototype.LIe=function(){this.Ykf();this.cm?this.cm.submit():this.SRb.t6c();return!0};Mg.prototype.ujc=function(){return!1};Mg.prototype.dispose=function(){this.SRb.dispose();this.Lhb&&(Ud.AFrameworkApplication.sa.vX.Aa(ug.a.click,this.Lhb,Object(vf.a)(this,this.LIe,"downloadLinkClicked")),this.Lhb=null);this.cY&&(Ud.AFrameworkApplication.sa.vX.Aa(ug.a.click,this.cY,Object(vf.a)(this,this.ujc,"learnMoreLinkClicked")),
this.cY=null);this.My&&this.GVa&&(this.My.Aa(ug.a.click,this.QB,this.GVa),this.GVa=null);this.pe&&this.HVa&&(this.pe.Aa(ug.a.Vd,this.QB,this.HVa),this.HVa=null);xf.prototype.dispose.call(this)};Mg.prototype.IKf=function(){this.cm&&(document.body.appendChild(this.cm),this.cm.submit(),document.body.removeChild(this.cm))};Mg.prototype.rw=function(J){1===J&&(this.ptd(),this.cm?Mg.Au&&this.IKf():this.SRb.t6c());this.dispose()};Ck.Object.defineProperties(Mg.prototype,{q8e:{configurable:!0,enumerable:!0,
get:function(){return null}},kVd:{configurable:!0,enumerable:!0,get:function(){return null}},WNa:{configurable:!0,enumerable:!0,get:function(){return null}},rBb:{configurable:!0,enumerable:!0,get:function(){return null}},L7a:{configurable:!0,enumerable:!0,get:function(){return null}},kpf:{configurable:!0,enumerable:!0,get:function(){return!1}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_Open}},g4c:{configurable:!0,enumerable:!0,get:function(){return null}},DVc:{configurable:!0,
enumerable:!0,get:function(){return null}},Xne:{configurable:!0,enumerable:!0,get:function(){return null}},agf:{configurable:!0,enumerable:!0,get:function(){return!1}}});Ck.Object.defineProperties(Mg,{Au:{configurable:!0,enumerable:!0,get:function(){return Ud.AFrameworkApplication.sa.Qa.lv&&Ud.AFrameworkApplication.sa.Qa.gff}},exb:{configurable:!0,enumerable:!0,get:function(){return Mg.c7d},set:function(J){Mg.c7d=J}}});Mg.c7d=!1;Object(ee.a)(Mg,"ADialogWithLinkToResource",Dc.StandardDialog,[]);var Uf=
b(439),Zf=b(329),Ne=b(14);Wl(Lg,Mg);Lg.prototype.Wkf=function(){vd.ULS.sendTraceTag(537162658,0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")};Lg.prototype.Ykf=function(){vd.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")};Lg.prototype.ujc=function(){Uf.Redirect.showHelp(Zf.a.FDi);return!0};Ck.Object.defineProperties(Lg.prototype,{WNa:{configurable:!0,enumerable:!0,get:function(){return Ne.a.instance.Wa(411)}},
Bjc:{configurable:!0,enumerable:!0,get:function(){return Ne.a.instance.Wa(412)}},Ajc:{configurable:!0,enumerable:!0,get:function(){return"DownloadOdsLink"}},rBb:{configurable:!0,enumerable:!0,get:function(){return"#"}},L7a:{configurable:!0,enumerable:!0,get:function(){return Ne.a.instance.Wa(413)}},kpf:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(ee.a)(Lg,"DownloadACopyAsOdsDialog",Mg,[]);Nf.prototype.Nre=function(J){this.dialog=J};Nf.prototype.t6c=function(){this.bEi.LDf(-1059172980)};
Nf.prototype.dispose=function(){this.Ab.PHb(this.svf)};Object(ee.a)(Nf,"DownloadACopyAsOdsDialogDownloadBehavior",null,[233,3]);Object(ee.a)(Ag,"MacroRecorderWorkbookCalculationModeSetPayload",null,[450]);Object(ee.a)(pg,"MacroRecorderWorkbookRecalculatedPayload",null,[450]);var ch=b(195),yh=b(109),nf=b(1),Ci=b(323);Ck.Object.defineProperties(Ef,{lTi:{configurable:!0,enumerable:!0,get:function(){return Ef.kTi}}});Ef.kTi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(ee.a)(Ef,"OpenInAppDialogCopyHtml",null,[]);var kh=b(157),Xi=Ci.a;Wl(pf,Xi);pf.prototype.openUrl=function(J,ea){var Wa=document.getElementById("link");Wa||(Wa=document.createElement("a"),Wa.id="link",Wa.style.visibility="hidden",Wa.href="",document.body.appendChild(Wa));Wa.target=ea;Wa.href=J;Wa.click()};pf.prototype.SDc=function(){var J=this;vd.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.Xa(this.$.da,21,137,1),function(ea){var Wa=
{};Wa.OpenInAppUrl=J.Qla;Wa.StoreUrl=J.wm;ea.result.Gj("UI_OpenInMobileApp",Wa)},this.$.la)};pf.prototype.mTi=function(){vd.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")};pf.prototype.Ug=function(){this.hg=Of.a.$o(Ef.lTi,Ne.a.instance.ga(664),Ne.a.instance.ga(665),Ud.AFrameworkApplication.PC,kh.getImageClass(Ud.AFrameworkApplication.fa.Va("AppIcon")),Ne.a.instance.ga(666));this.Ne="OpenInAppDialog";this.ic=5;this.initializeAndShow("",this.mTi.bind(this),null);this.rI(this.PH)};
pf.prototype.zv=function(J){Xi.prototype.zv.call(this,J);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.PH=document.getElementById("LinkToInstall");ch.a.instance.pa(ug.a.click,this.PH,this.QDb);yh.KeyInputManager.instance.pa(ug.a.Vd,this.PH,this.BOa)};pf.prototype.dispose=function(){this.PH&&(ch.a.instance.Aa(ug.a.click,this.PH,this.QDb),yh.KeyInputManager.instance.Aa(ug.a.Vd,this.PH,this.BOa),this.PH=null);Xi.prototype.dispose.call(this)};Ck.Object.defineProperties(pf.prototype,
{Cc:{configurable:!0,enumerable:!0,get:function(){return"OpenInAppDialogCopy"}}});Object(ee.a)(pf,"OpenInAppDialogCopy",Ci.a,[]);If.prototype.SDc=function(){var J=this;vd.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.Xa(this.$.da,21,137,1),function(ea){var Wa={};Wa[Rg.a.RDf]=J.Qla;Wa[Rg.a.wm]=J.wm;ea.result.Gj("UI_OpenInMobileApp",Wa)},this.$.la)};If.prototype.Ug=function(){vd.ULS.sendTraceTag(523534412,0,
50,"initializeAndShowDialog: React Edit in app dialog opened.");var J=new Dc.StandardDialog;J.ic=0;J.Ac(1,Ne.a.instance.ga(670));J.Ak(Ne.a.instance.ga(668),Ne.a.instance.ga(669),0,this.oig)};Object(ee.a)(If,"OpenInAppDialogReact",null,[]);var hi=b(387),Mi=hi.a;Wl(Sd,Mi);Sd.prototype.FM=function(){var J={};return J[Sd.rmj]=Ne.a.instance.ga(671),J[Sd.smj]=this.sessionId,J[Sd.id]="WACSessionIdDialog",J[Sd.EYc]=Ne.a.instance.ga(672),J[Sd.buildVersion]=this.qQg,J};Sd.prototype.Ug=function(){var J=this.FM();
this.ic=5;this.initializeAndShow(Ne.a.instance.ga(1017),this.PUj.bind(this),J)};Sd.prototype.PUj=function(){vd.ULS.sendTraceTag(521434688,306,100,"Show WACSessionIdDialogHandler invoked")};Ck.Object.defineProperties(Sd.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"WACSessionIdDialog"}}});Sd.id="id";Sd.rmj="sessionIdLabel";Sd.smj="sessionIdValue";Sd.EYc="buildLabel";Sd.buildVersion="buildVersion";Object(ee.a)(Sd,"WACSessionIdDialog",hi.a,[]);var uj=b(28),uh=b(30),Ui=b(370),Zh=
b(10),fi=b(292),wg=b(22),gj=b(44),Ei=b(259),Fi=b(490),ck=b(394),Uh=b(50),Xg=b(6),Oi=b(146),Wj=b(1169),Pj=b(81),L=b(34),Ma=b(375),rb=b(262);te.prototype.NQ=function(J,ea){J=uh.a.gd(12,1,673,0,0,0,"Blank");J.Description=String.format(Ne.a.instance.ga(674),ea);return J};te.prototype.J$b=function(J){switch(J){case 1:case 2:return 0;default:return 2}};Object(ee.a)(te,"ReloadCloseConfirmation",null,[563]);var ec=b(155),fd=b(648),yd=b(66),be=r.a;Wl(Gd,be);Gd.prototype.$c=function(){return!1};Gd.prototype.executeCommand=
function(J,ea,Wa,Pb){var Cc=this,pd=this.V6b,wd=this.$,ue=ea.command,Je=this.openInExcelOperation,tg=this.$.Mb,oh=Wa.SourceControlId;wd.Vk.vle(ue);Je.owc(ea.startTime.getTime().toString());J=null;switch(ue){case 1455037301:this.$.t5?Je.fBe():Je.c2c();break;case -2044628748:case 2004484710:this.$.t5?Je.fBe():Je.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===oh?(this.SBb("CellLongPress"),vd.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):
(this.SBb("PencilIcon"),vd.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case 480922297:nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowWacSessionIdDialogOnMobile",!1)&&(new Sd(this.$)).Ug();break;case -2028960985:Je.L4f();break;case -1059172980:new Lg(Je.iue(ue),new Nf(Je,wd.Ab));break;case -1285148982:this.clientWorkflow.ud.activityState[L.a.ITc]=!0;this.wAc(!1);
break;case -75280711:this.wAc(!1);break;case -455164169:this.wAc(!0);break;case -1388494670:this.$.da.$a(400,function(ia){ia.gxi();Cc.wAc(!1)});break;case 810888577:Ud.AFrameworkApplication.vk=(new Date).getTime();vd.ULS.sendTraceTag(537162656,0,50,"FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to {0}",Ud.AFrameworkApplication.vk);break;case -1804063550:case -974518828:ea=0;ca.a.FBd in Wa&&(ea=Wa[ca.a.FBd]);Je.LDf(ue,ea);break;case -1339961039:ea=!1;Wa&&ca.a.JIb in Wa&&(ea=Wa[ca.a.JIb]);
this.reloadWorkbook(!1,ea);break;case -8805455:var Qh=this.workbookContext;wd.isEditMode||(Gd.Lye(wd),J=wh.TaskExtensions.Ba(this.VJ.value,function(ia){ia=ia.result;var ib=ia.isEnabled();ib&&oe.a(ia,hh.a.copyAndEdit,xc.a.Fg.sXe(),Cc.$.ea.Yg.get(2))?vd.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):ib&&Ud.AFrameworkApplication.rdg?(ib={},ib[fa.a.BEd]=Ud.AFrameworkApplication.userSessionId,
ib[Ud.AFrameworkApplication.szi]=uj.a.Ua.Vb.getTime().toString(),vd.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),ia.Gj(hh.a.editMode,ib)):pd.CopyAndEditUrl?Cc.O2g():(Cc.xc.supportsEditing||Qh.EditUrl)&&Cc.reloadWorkbookInEditMode()},this.la,3));break;case -723527778:wd.isEditMode&&(Gd.Lye(wd),this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:var ni=wd.na.va.hc(),
Jj=-1355155015===ue?1:0,Mj=function(){return new pg(Jj)};J=Ba.a(this.$.userOperationManager,function(ia,ib,Lb){return Pc.V(wd.na.va,Jj,null,ia,ib,Lb,null,ni)},function(ia){return new Fb.a(128,0,ia,void 0,Mj)},ea);wg.g(wd).ug.SG(!1);break;case -1158102843:J=wg.g(wd).ug.recalcSheet(ea);wg.g(wd).ug.SG(!1);break;case -988468372:if(nf.EwaSettings.ma(302))if(Pb=parseInt(Wa[pb.a.kd],10),0<=Pb&&3>Pb)this.setCalculationMode(ea,Pb);else return vd.ULS.sendTraceTag(537162652,0,10,"SetCalculationMode , unexpected menuItemId: {0}",
Wa[pb.a.kd]),xi.a(ue);break;case 257398710:Ka.a.ntw(pd.ReportAbuseUrl,wd);break;case 1800405051:this.Uhj();break;case -48469327:this.saveACopy();break;case 214430355:ea=!1;Wa&&ca.a.$6c in Wa&&(ea=Wa[ca.a.$6c]);if(!this.xvj(ea,Wa))break;Ud.AFrameworkApplication.n5?this.businessBar.fg(40,null):this.businessBar.fg(ea?22:23,null);break;case 1389557314:J=wh.TaskExtensions.Ba(this.VJ.value,function(ia){oe.a(ia.result,hh.a.Hyh,null,Cc.$.ea.Yg.get(6))||Ka.a.ntw(pd.FileVersionUrl,wd)},this.la,3);break;case 2145659238:this.closeWorkbook();
break;case 1773624819:oh===tg+ca.a.Rhf?Je.Qpi():Je.Ppi();break;case 512141517:oh===tg+ca.a.Qhf?Je.aqi():Je.$pi();break;case -1224038235:var uk=Va.a.On in Wa?!Wa[Va.a.On]:fc.j(wd.ea.workbookContext.Options);Wa[Va.a.Description]=uk?Ne.a.instance.ga(573):Ne.a.instance.ga(574);J=Ba.a(this.$.userOperationManager,function(ia,ib,Lb){var Nc=Cc.$.na.va,Vc=Nc.Na(9,null);Vc.isReadOnlyRecommended=!uk;return Pc.i(Nc,"SetReadOnlyRecommended",Vc,ia,ib,Lb,null,0)},function(ia){return new Fb.a(129,0,ia)},ea);break;
case 1118926154:if(this.$.isEditMode){var H=new ye.a;this.$.da.$a(53,function(ia){ia?(ia.Wl.Jpi(Cc.$.Mb+ca.a.prd),H.setResult(!0)):vd.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});J=H.task}break;case -1698025133:Je.openInBrowser();break;case 520859864:J=wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.Xa(this.$.da,393,394,Pb.Dja()),function(ia){ia.result||vd.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},
this.$.la,3);break;default:J=xi.a(ue)}return J||Wc.Task.Sa(!0)};Gd.prototype.SBb=function(J){if(nf.EwaSettings.isChangeGateEnabled("OfficeVSO:4859963_LogUsageKpiForOpenInAppDialog"))if(Zh.HelperMethods.g_){var ea=new Map;ea.set("EntryPoint",J);lh.Health.instance.recordKpiUsage(ck.a.jTi,0,Fi.a.czi,ea)}else vd.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")};Gd.prototype.showOpenInAppDialog=function(){Ud.AFrameworkApplication.isMobileMode&&
(this.$.ya.IsMeetingLiveSession&&nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OpenInAppExcelReactDialog",!1)?(vd.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),(new If(this.$)).Ug()):nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(vd.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new pf(this.$)).Ug()):
(vd.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),Ud.AFrameworkApplication.showOpenInAppDialog()))};Gd.prototype.xvj=function(J,ea){var Wa=this;return Ud.AFrameworkApplication.isMobileMode&&!Z.a(this.$.ya,30)?(this.showOpenInAppDialog(),vd.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.SBb("CellDoubleTap"),vd.ULS.sendTraceTag(537162646,
0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),!1):Ud.AFrameworkApplication.Pgc&&(J&&Ui.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(vd.ULS.sendTraceTag(537162645,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .{0}, HostEditUrl {1}empty. Skipped prompt to edit",Ui.d(this.workbookContext.WorkbookFileName)?
"xls":"csv",this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""),!1):d.a.any([25,26,30,31,55,32],function(Pb){return Wa.businessBar.bMa(Pb)})?(vd.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):ea&&ca.a.o0i in ea&&!J?!1:!0};Gd.prototype.Mc=function(J,ea){J=!1;switch(ea.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:J=
!0;break;case 480922297:case 520859864:J=nf.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case -1285148982:case -75280711:case -455164169:J=nf.EwaSettings.ma(109);break;case -1388494670:J=nf.EwaSettings.ma(109);break;case 810888577:J=nf.EwaSettings.ma(271);break;case -1224038235:J=this.$.ea.amIAlone;break;case -988468372:J=nf.EwaSettings.ma(302);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:J=!0,vd.ULS.shipAssertTag(537162642,
0,this.$.uka,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return J};Gd.prototype.jd=function(){return!1};Gd.prototype.Uhj=function(){var J=this;if(this.rc){var ea=this.$;gj.a(ea).tt(new Ei.a(Xg.a.oz,5,function(){ea.fI(!1,!0);var Wa=J.clientWorkflow.ud.activityState;Wa[rb.a.hr]=Xg.a.Bda;Wa[Oi.a.QT]=2;Wa[L.a.Ns]=ea.isEditMode;Wa[Oi.a.Gga]=!1}))}};Gd.prototype.saveACopy=function(){var J=this;if(this.rc){var ea=this.$;gj.a(ea).tt(new Ei.a(Xg.a.oz,5,function(){ea.fI(!1,
!1);var Wa=J.clientWorkflow.ud,Pb=Wa.activityState;Pb[rb.a.hr]=Xg.a.kUf;Pb[fd.a.wYb]=J.xc.hasUnsupportedFeaturesForEdit;Pb[Oi.a.Gga]=!1;Wa.Jt(uh.a.oaa(J.businessBar.p7c,[-502303485]))}))}};Gd.prototype.wAc=function(J){var ea=this;gj.a(this.$).tt(new Ei.a(Xg.a.xna,2,function(){ea.$.fI(!0,!0);var Wa=yd.a(ea.$).ud,Pb=ea.$.isEditMode;Pb=uh.a.gd(1,1,0,0,0,Pb?-315732528:-2087635043,Pb?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Pb.ForceVersionUpgrade=J;Wa.Jt([Pb]);Wa=yd.a(ea.$).ud.activityState;
Wa[rb.a.hr]=Xg.a.xna;Wa[L.a.Ns]=ea.$.isEditMode;Wa[Oi.a.Gga]=!1}))};Gd.prototype.closeWorkbook=function(){var J=this;if(this.rc){var ea=this.$;xc.a.Fg.Mwc("2145659238")?wh.TaskExtensions.Ba(this.VJ.value,function(Wa){Wa.result.Gj(hh.a.ORe,{})},this.la,3):gj.a(ea).tt(new Ei.a(Xg.a.oz,5,function(){ea.fI(!0,!1);var Wa=J.clientWorkflow.ud.activityState;Wa[Oi.a.uY]=!1;Wa[Oi.a.Gga]=!1;J.xc.inViewerFromWebPart?(Sc.a.pFd(ea,J.clientWorkflow.ud),ea.Vk.Ty("InViewerFromWebPart"),Wa[rb.a.hr]=Xg.a.J_):(Wa[rb.a.hr]=
Xg.a.Jk,ea.Qd&32?Wa[Oi.a.QT]=0:(Wa[Oi.a.QT]=1,Wa[Oi.a.lYb]=new Wj.a),Wa[ec.a.Uje]=!0)}))}};Gd.prototype.O2g=function(){var J=this,ea=this.xc.vbaRemovedDuringConversion;vd.ULS.sendTraceTag(537162636,0,50,"FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = {0}",ea);var Wa=this.$;ea?gj.a(Wa).tt(new Ei.a(Xg.a.oz,5,function(){var Pb=uh.a.gd(3,0,0,1244,0,1069271157,"XLSMacroFailure");J.clientWorkflow.ud.Jt([Pb]);J.clientWorkflow.ud.activityState[rb.a.hr]=Xg.a.oeb})):Ud.AFrameworkApplication.hideHeader?
Zh.HelperMethods.mf(this.V6b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):Ka.a.ntw(this.V6b.CopyAndEditUrl,Wa)};Gd.prototype.reloadWorkbookInEditMode=function(){var J=this;if(this.rc)if(nf.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&xc.a.Fg.WV&&xc.a.Fg.ZGd(),Ud.AFrameworkApplication.Pgc&&!Ud.AFrameworkApplication.Qka)Zh.HelperMethods.mf(this.$.Wob(!0),S.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var ea=
this.$,Wa=!1,Pb=this.xc.hasUnsupportedFeaturesForEdit,Cc=this.workbookContext.FileWasRepaired;Ui.d(this.workbookContext.WorkbookFileName)?(Wa=!0,vd.ULS.sendTraceTag(537162634,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = {0}",Pb)):Ui.a(this.workbookContext.WorkbookFileName)&&(Wa=!0,vd.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var pd=ea.Yf.get(59);pd=!(ea.ea.xc.supportsEditing&&
pd);if(Wa&&!Pb||pd&&(Wa||Pb)){var wd=pd?Pb?-2066104278:816071846:nf.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&Z.a(this.$.ya,25)&&!this.$.Vzb?765011943:-213064907;Wa=function(){var ue=uh.a.QZa([wd]);J.clientWorkflow.ud.Jt(ue);J.clientWorkflow.ud.activityState[rb.a.hr]=Xg.a.oeb}}else Wa=function(){ea.fI(!0,!1);var ue=J.clientWorkflow.ud,Je=ue.activityState;Je[Oi.a.QT]=1;Je[Ma.a.qYb]=ff.a.flc;Je[L.a.Ns]=!0;Je[fd.a.wYb]=J.xc.hasUnsupportedFeaturesForEdit;Je[Oi.a.Gga]=
!!J.workbookContext.EditUrl;Je[Pj.a.t2]=J.workbookContext.EditUrl;if(!J.V6b.CopyAndEditUrl){var tg=[nf.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&Z.a(J.$.ya,25)&&!J.$.Vzb?-943219229:1821390342];ue.Jt(uh.a.oaa(J.businessBar.p7c,tg))}Cc&&!Pb?(Ui.b(J.workbookContext.WorkbookFileName)&&nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConverterOdfFileRepairEnabled",!1)?(ue=uh.a.QZa([-425642652]),vd.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):
ue=uh.a.QZa([108482388]),J.clientWorkflow.ud.Jt(ue),Je[rb.a.hr]=Xg.a.yUf):J.$.ea.l6e?(vd.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),Uh.b().bTd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),Je[rb.a.hr]=Xg.a.FFb):Je[rb.a.hr]=J.$.ea.Bgc?Xg.a.vBb:Xg.a.oeb};gj.a(ea).tt(new Ei.a(Xg.a.oz,5,Wa))}};Gd.prototype.reloadWorkbookInViewMode=function(){var J=
this;if(this.rc){nf.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&xc.a.Fg.WV&&xc.a.Fg.ZGd();var ea=this.$;sg.a.Eh&&wg.g(ea).pc.textBox.blur();gj.a(ea).tt(new Ei.a(Xg.a.oz,5,function(){ea.fI(!ea.ea.isNamedObjectViewMode,!1);var Wa=J.clientWorkflow.ud.activityState;Wa[rb.a.hr]=Xg.a.Pha;Wa[Oi.a.QT]=1;Wa[Oi.a.uY]=!0;Wa[L.a.Ns]=!1;Wa[L.a.Gmb]=!0;Wa[Ma.a.qYb]=ff.a.flc}))}};Gd.prototype.reloadWorkbook=function(J,ea){var Wa=this;if(this.rc){var Pb=this.$;Pb.FQ&65536&&
gj.a(Pb).tt(new Ei.a(Xg.a.oz,5,function(){Pb.fI(J,!0);var Cc=Wa.clientWorkflow.ud.activityState;Cc[rb.a.hr]=Xg.a.Kk;Cc[L.a.LTc]=Wa.workbookContext.NovMode;ea||(Cc[Oi.a.QT]=1,Cc[Oi.a.lYb]=new te)}))}};Gd.prototype.setCalculationMode=function(J,ea){function Wa(){return new Ag(ea)}var Pb=this;vd.ULS.sendTraceTag(537162629,0,50,"SetCalculationMode ,calculation mode chosen : {0} ",ea);var Cc=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=ea;return Ba.a(this.$.userOperationManager,
function(pd,wd,ue){var Je=Pb.$.na.va;pd=fi.b(pd,Gd.cQi(Pb.$,Cc));wd=fi.a(wd,Gd.bQi(Pb.$,Cc));var tg=Je.Na(9,null);tg.calc_type=ea;return Pc.i(Je,"SetCalculationOptions",tg,pd,wd,ue,null,0)},function(pd){return new Fb.a(197,0,pd,void 0,Wa)},J)};Gd.Lye=function(J){J.Ab&&0<J.Ab.JR&&J.Ab.L9c(function(ea){ea.Ut()})};Gd.cQi=function(J,ea){return function(Wa){uh.a.oh(Wa.Errors)&&(J.ea.workbookContext.CalcMode=ea,vd.ULS.sendTraceTag(537162628,0,50,"OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to {0}.  Error id names: {1}",
ea,uh.a.Tc(Wa.Errors)))}};Gd.bQi=function(J,ea){return function(){J.ea.workbookContext.CalcMode=ea;vd.ULS.sendTraceTag(537162627,0,50,"OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to {0})",ea)}};Ck.Object.defineProperties(Gd.prototype,{rc:{configurable:!0,enumerable:!0,get:function(){return this.$.ea.rc}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},V6b:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.FullDocumentInfo}},
clientWorkflow:{configurable:!0,enumerable:!0,get:function(){return yd.a(this.$)}},xc:{configurable:!0,enumerable:!0,get:function(){return this.$.xc}}});Object(ee.a)(Gd,"FileOperationsCommandHandler",r.a,[428]);var xe=b(158),cf=bh.a;Wl(xd,cf);xd.prototype.Od=function(){var J=this,ea=this.$,Wa=[],Pb=ah.GetServiceTaskFactory.create(ea.da,56,this.la,this.vb);Wa.push(Pb);var Cc=ah.GetServiceTaskFactory.Xa(ea.da,5,4,this.vb);Wa.push(Cc);wh.TaskExtensions.Ba(Wc.Task.WAA.apply(null,Wa),function(){xe.b(Pb)&&
J.Cd([new Gd(ea,Pb.result,new Sf.a(function(){return ah.GetServiceTaskFactory.create(ea.da,137,J.la,J.vb)}),Cc.result)])},this.la,0)};xd.ka=function(J){bh.a.ee(94,new xd(J))};Object(ee.a)(xd,"FileOperationsCommandHandlerFactory",bh.a,[]);var ze=b(45),Yf;(function(J){J[J.url=0]="url";J[J.ref=1]="ref";J[J.mailto=2]="mailto"})(Yf||(Yf={}));Object(ee.b)("HyperlinkSelectionState",Yf);var Sg=b(978),eg=b(9),Pg=b(644),Vh=b(87),fe=Sg.a;Wl(pc,fe);pc.prototype.QZe=function(J,ea){switch(ea){case 2:return J.startsWith("mailto:")?
J:"mailto:"+J;case 1:return String.format("{0}{1}",eg.a.JGf,this.lQh(J));default:return J}};pc.prototype.Zy=function(){var J=this,ea=this.$;this.location=this.QZe(this.exd,this.dxd);try{this.location=Vh.a.gg(this.location)}catch(Cc){vd.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}vd.ULS.sendTraceTag(555755667,0,50,"Committing {0} link",Yf[this.dxd]);this.cellValue=this.cxd.length?this.cxd:this.exd;ea.By();var Wa=ea.na.va.hc(),Pb=ze.s(this.selectedRange);return function(Cc,pd,wd){return Pc.c(ea.na.va,
Pb,J.cellValue,J.location,J.removeHyperLink,!1,123,Cc,pd,wd,J.TL.range,Wa)}};pc.prototype.oj=function(){var J=this,ea=ze.s(this.selectedRange);return function(){return new Pg.a(ea,J.cellValue,J.location)}};pc.prototype.jxh=function(){var J=this.TL.cell.a5a;this.TL.cell.Ewb?J&&J.startsWith("mailto:")?(this.Cmb=2,J=J.substr(7)):this.Cmb=0:this.Cmb=1;return J};pc.prototype.vLa=function(){nf.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.Jyb=this.TL.bba:this.Jyb=!!this.TL.cKa(64)||
!!this.TL.cKa(128)};pc.prototype.Bn=function(){if(this.Jyb){this.n1a=this.TL.text;var J=this.jxh();J&&(this.yTc=J);this.Jm=Ne.a.instance.ga(825);this.Mqb=this.yTc===this.n1a}else this.TL.text?(this.n1a=this.TL.text,this.Mqb=!1):(this.n1a="",this.Mqb=!0),this.Cmb=0,this.Jm=Ne.a.instance.ga(824);this.TL.vH&&(this.Mqb=!1,this.tHe=!0,nf.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.n1a=this.TL.formulaBarText))};pc.prototype.BAi=function(J){return this.ea.Hb.Yj(J)};
pc.prototype.jYe=function(J,ea){return J?null:Ne.a.instance.ga(ea)};pc.prototype.lQh=function(J){var ea=ze.Z(J,this.ea.xa);var Wa=ea.sheetName;var Pb=ea.range;ea.returnValue&&Pb&&(J=ze.x(Pb,Wa||this.sheetName,!1));return J};Ck.Object.defineProperties(pc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"HyperLinkDialog"}},Mv:{configurable:!0,enumerable:!0,get:function(){return 526}}});pc.BTj="validateLinkValues";pc.$Ng="bodyProps";pc.Ieh="disableDisplayText";pc.yfh="displayTextValue";
pc.dzg="activeLinkOption";pc.ezg="activeLinkValue";pc.V2g="copyLinkValueToDisplay";pc.Oqi="linkValue";pc.jkj="selectedLink";pc.xfh="displayText";Object(ee.a)(pc,"HyperlinkDialog",Sg.a,[]);hc.prototype.$c=function(){return!1};hc.prototype.Mc=function(J,ea){return 1===J&&-1583422759===ea.command};hc.prototype.jd=function(){return!1};hc.prototype.executeCommand=function(){this.ryj();return Wc.Task.Sa(!0)};hc.prototype.ryj=function(){var J=ze.v(this.gridView.ha.ta.qd,this.$),ea=wg.e(this.gridView);(!nf.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||
this.$.Aq([this.gridView.ha.ta.qd],!0))&&ea&&new pc(this.$,J,ea)};Object(ee.a)(hc,"ShowHyperlinkCommandHandler",null,[428]);var af=bh.a;Wl(Wb,af);Wb.prototype.Od=function(){this.Cd([new hc(this.$,wg.g(this.$))])};Wb.ka=function(J){bh.a.ee(105,new Wb(J))};Object(ee.a)(Wb,"ShowHyperlinkCommandHandlerFactory",bh.a,[]);var zh=b(21),yi=b(1192);ob.create="Create";ob.activate="Activate";ob.close="Close";ob.remove="Delete";ob.duplicate="Duplicate";Object(ee.a)(ob,"Actions",null,[]);var ag=Wc.Task;Wl(sa,ag);
sa.prototype.tL=function(){this.x_d=uh.a.gd(3,2,0,1644,0,-1244327602,"MsFormDeleteConfirmation");this.jj=gj.a(this.Cf.$).si(this.x_d).G();this.jj.isCompleted||(this._state=2,this.jj.vN(this.moveNext));return this.qDc};sa.prototype.qDc=function(){this.z_d=this.jj.rz();0===this.z_d&&(this.Cf.$.workbookContext.Options=Zh.HelperMethods.rO(!1,this.Cf.$.workbookContext.Options,2048),this.Cf.deleteMsFormMetaDataSheet());this._state=3;this.hRa(!0)};sa.prototype.dispose=function(){};Object(ee.a)(sa,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",
Wc.Task,[3]);Xd.action="Action";Xd.TAh="FlexPane";Xd.j$b="formId";Xd.id="id";Xd.title="Title";Xd.dPb="XlWorkbookId";Xd.SCh="Fragment";Xd.host="Host";Xd.fJj="TopView";Xd.q2="auth_pvr";Object(ee.a)(Xd,"Parameters",null,[]);nd.prototype.$c=function(J,ea){switch(ea){case -105284469:return!fc.i(this.$.mg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1};nd.prototype.executeCommand=function(J,ea){J=wh.TaskExtensions.sk();ea=ea.command;switch(ea){case -105284469:this.insertMsForm();
break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:J=this.deleteMsForm();break;default:J=xi.a(ea)}return J};nd.prototype.Mc=function(J,ea){if(!this.$.ea.Yg.get(61))return!1;J=!1;switch(ea.command){case -105284469:J=fc.i(this.$.mg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:J=this.hasMsForm}return J};nd.prototype.jd=function(){return!1};nd.prototype.insertMsForm=
function(){var J=cg.a.Gq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),ea={},Wa={};ea[Xd.action]=ob.create;ea[Xd.q2]=this.q2;Wa[Xd.action]=ob.create;Wa[Xd.dPb]=encodeURIComponent(this.ZOb);Wa[Xd.host]=this.to;Wa[Xd.title]=encodeURIComponent(J);this.pCb(ea,Wa);this.$.workbookContext.Options=Zh.HelperMethods.rO(!1,this.$.workbookContext.Options,2048)};nd.prototype.editMsForm=function(){var J={},ea={};J[Xd.q2]=this.q2;ea[Xd.j$b]=this.tlc;ea[Xd.dPb]=encodeURIComponent(this.ZOb);ea[Xd.host]=
this.to;this.pCb(J,ea)};nd.prototype.previewMsForm=function(){var J={},ea={};J[Xd.q2]=this.q2;ea[Xd.j$b]=this.tlc;ea[Xd.dPb]=encodeURIComponent(this.ZOb);ea[Xd.host]=this.to;ea[Xd.fJj]="Preview";this.pCb(J,ea)};nd.prototype.sendMsForm=function(){var J={},ea={};J[Xd.q2]=this.q2;ea[Xd.j$b]=this.tlc;ea[Xd.TAh]="SendForm";ea[Xd.dPb]=encodeURIComponent(this.ZOb);ea[Xd.host]=this.to;this.pCb(J,ea)};nd.prototype.deleteMsForm=function(){return new sa(this)};nd.prototype.deleteMsFormMetaDataSheet=function(){var J=
this;this.$.userOperationManager.Zt(new Fb.a(158,0,function(ea,Wa,Pb){return dc(J.$.na.Kw,J.lV.aub,fi.b(ea,function(){J.Gch()}),Wa,Pb,null)}))};nd.prototype.Gch=function(){var J={},ea={};J[Xd.action]=ob.remove;J[Xd.q2]=this.q2;ea[Xd.action]=ob.remove;ea[Xd.host]=this.to;ea[Xd.j$b]=encodeURIComponent(this.tlc);ea[Xd.dPb]=encodeURIComponent(this.ZOb);this.pCb(J,ea)};nd.prototype.pCb=function(J,ea){var Wa=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx",Pb="",Cc="";if(ea){for(var pd in ea){var wd=pd,
ue=ea[pd];Cc+=Cc.length?"&":"";Cc+=wd+"="+ue}J||(J={});J[Xd.SCh]=encodeURIComponent(Cc)}if(J)for(var Je in J)ea=Je,Cc=J[Je],Pb+=Pb.length?"&":"?",Pb+=ea+"="+Cc;window.open(Wa+Pb,"_blank")};Ck.Object.defineProperties(nd.prototype,{hasMsForm:{configurable:!0,enumerable:!0,get:function(){return fc.c(this.$.mg)}},tlc:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormId}},ZOb:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormDocUrl}},q2:{configurable:!0,
enumerable:!0,get:function(){return zh.a.contains(this.$.Pu.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":"OrgId"}}});Object(ee.a)(nd,"MsFormCommandHandler",null,[428]);var Zj=bh.a;Wl(ke,Zj);ke.prototype.Od=function(){var J=this,ea=ah.GetServiceTaskFactory.create(this.$.da,203,this.la,this.vb);wh.TaskExtensions.Ba(wh.TaskExtensions.te([ea],this.la),function(){J.Cd([new nd(J.$)])},this.la,3)};ke.ka=function(J){J.ea.Yg.get(61)&&bh.a.ee(215,new ke(J))};Object(ee.a)(ke,"MsFormCommandHandlerFactory",
bh.a,[]);var T=vh.a;Wl(re,T);re.prototype.create=function(){var J=this;wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.create(this.$.da,164,this.la,this.vb),function(){J.Eb(new Ie)},this.la,3)};Object(ee.a)(re,"NewAndOpenUXFactory",vh.a,[]);Fd.prototype.executeCommand=function(J,ea,Wa){J=2;switch(ea.command){case Xf.a.openUrlInNewTab:J=this.Ci.se(Xf.a.openUrlInNewTab,2,Wa);break;case Xf.a.POa:J=this.Ci.se(Xf.a.POa,2,Wa)}return 2!==J?Wc.Task.Sa(!0):xi.a(ea.command)};Fd.prototype.Mc=function(J,ea){return ea.command===
Xf.a.openUrlInNewTab||ea.command===Xf.a.POa};Fd.prototype.jd=function(J,ea,Wa){return"PopulateMruMenu"===ea?(this.Ci.se(Xf.a.Ypc,2,Wa),!0):!1};Fd.prototype.$c=function(){return!1};Object(ee.a)(Fd,"OpenFromMruCommandHandler",null,[428]);var pa=bh.a;Wl(Kc,pa);Kc.prototype.Od=function(){var J=this,ea=ah.GetServiceTaskFactory.create(this.$.da,155,this.la,this.vb),Wa=ah.GetServiceTaskFactory.create(this.$.da,165,this.la,this.vb);wh.TaskExtensions.Ba(wh.TaskExtensions.te([ea,Wa],this.la),function(){J.Cd([new Fd(J.$,
Ud.AFrameworkApplication.Ib)])},this.la,3)};Kc.ka=function(J){bh.a.ee(88,new Kc(J))};Object(ee.a)(Kc,"OpenFromMruCommandHandlerFactory",bh.a,[]);var hb=b(91),Db=b(85),rc=b(251),vb=b(716),Uc=b(1154),Td=rc.a;Wl(lc,Td);lc.prototype.execute=function(J){var ea=Object(Db.a)(6,J.Ke);if(!ea.uka)return vd.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.$ld(J),this.zh(Xg.a.idle),1;this.cCb||(this.cCb=new Uc.DownloadACopyOperation(this.qkc,
ea));this.cCb.Vgh();vd.ULS.shipAssertTag(537154817,0,3!==yd.a(ea).wi.$t,"The current activity should not be closed.");return 1};lc.prototype.$ld=function(J){var ea=Object(Db.a)(6,J.Ke),Wa=new vb.a(ea);this.subscribe(J,this.JAd,function(Pb){Wa.add_disposing(Pb)});vd.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");Wa.initialize();Wa.Af()};lc.prototype.dispose=function(){hb.a.Ha(this.cCb);this.cCb=null;Td.prototype.dispose.call(this)};
Object(ee.a)(lc,"DownloadAForkedCopyActivity",rc.a,[]);var mf=vh.a;Wl(Qf,mf);Qf.prototype.create=function(){var J=this;wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.create(this.$.da,155,this.la,this.vb),function(){J.Eb(new lc(Xg.a.v1a,Xg.a.Jk,!0))},this.la)};Object(ee.a)(Qf,"DownloadACopyPreDatalossActivityFactory",vh.a,[]);var bg=vh.a;Wl(mg,bg);mg.prototype.create=function(){var J=this;wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.create(this.$.da,155,this.la,this.vb),function(){J.Eb(new lc(Xg.a.unmergeableDownloadCopy,
Xg.a.Eoa))},this.la)};Object(ee.a)(mg,"DownloadAForkedCopyActivityFactory",vh.a,[]);$f.prototype.Og=function(){this.La.fc(Xf.a.tryMacOffice,Eh.a.frame,Object(vf.a)(this,this.URi,"onTryMacOffice"));this.La.fc(Xf.a.u$f,Eh.a.frame,Object(vf.a)(this,this.ZCf,"onTryMacOfficeFromViewer"));this.La.fc(Xf.a.t$f,Eh.a.frame,Object(vf.a)(this,this.ZCf,"onTryMacOfficeFromViewer"))};$f.prototype.URi=function(J,ea,Wa,Pb,Cc){if(1===Wa)return 32;Cc?(J=Cc.SourceControlId,"btnjTryMacOfficeForWordEditor"===J?ve.a.mf(zg.a.DZ(12),
"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===J&&ve.a.mf(zg.a.DZ(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.ojf();return 32};$f.prototype.ZCf=function(J,ea,Wa){if(1===Wa)return 32;switch(J){case Xf.a.u$f:ve.a.mf(zg.a.DZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Xf.a.t$f:ve.a.mf(zg.a.DZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};$f.prototype.ojf=function(){var J=void 0===J?null:J;
var ea=0;J&&(ea=J);ve.a.mf(2===ea?"https://go.microsoft.com/fwlink/?LinkId=331579":$f.fwi,"_blank",void 0,"LaunchMacTrialWindow")};Ck.Object.defineProperties($f.prototype,{Ywc:{configurable:!0,enumerable:!0,get:function(){return this.tqg&&sg.a.isMac&&!sg.a.qji&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}},qvj:{configurable:!0,enumerable:!0,get:function(){return this.Ywc}}});Ck.Object.defineProperties($f,{fwi:{configurable:!0,enumerable:!0,get:function(){return zg.a.nH("522401")}}});Object(ee.a)($f,
"MacOfficeOffer",null,[255]);Wf.prototype.Og=function(){this.La.fc(Xf.a.tryOffice,Eh.a.frame,Object(vf.a)(this,this.VRi,"onTryOffice"));this.La.fc(Xf.a.tryOfficeThroughTellMe,Eh.a.frame,Object(vf.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.fc(Xf.a.x$f,Eh.a.frame,Object(vf.a)(this,this.y$f,"tryOfficeThroughViewer"));this.La.fc(Xf.a.w$f,Eh.a.frame,Object(vf.a)(this,this.y$f,"tryOfficeThroughViewer"))};Wf.prototype.VRi=function(J,ea,Wa,Pb,Cc){if(this.tXb&&1===Wa)return this.isFreemiumUpsellEnabled&&
this.dLb?32:8;2===Wa&&(Cc?(J=Cc.SourceControlId,"btnjTryOfficeForWordEditor"===J?ve.a.mf(zg.a.DZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===J?ve.a.mf(zg.a.DZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.sjc()):this.sjc());return 32};Wf.prototype.tryOfficeThroughTellMe=function(J,ea,Wa,Pb,Cc){if(this.tXb&&1===Wa)return this.isFreemiumUpsellEnabled&&this.dLb?32:8;2===Wa&&(Cc?(J=Cc.SourceControlId,ve.a.mf(zg.a.nH("862405")+this.BSh(J),"_blank",
void 0,"TryOfficeThroughTellMe.WithSourceControlId")):ve.a.mf(zg.a.nH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};Wf.prototype.y$f=function(J,ea,Wa){if(this.tXb&&1===Wa)return this.isFreemiumUpsellEnabled&&this.dLb?32:8;if(2===Wa)switch(J){case Xf.a.x$f:ve.a.mf(zg.a.DZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Xf.a.w$f:ve.a.mf(zg.a.DZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};Wf.prototype.sjc=function(J){J=void 0===J?null:J;var ea=
0;J&&(ea=J);ve.a.mf(Wf.mQh(ea),"_blank",void 0,"LaunchOfficeOffer")};Wf.prototype.BSh=function(J){var ea=0;switch(J){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":ea=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":ea=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":ea=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":ea=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":ea=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":ea=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":ea=
7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":ea=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":ea=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":ea=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":ea=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":ea=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":ea=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":ea=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":ea=
20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":ea=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":ea=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":ea=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":ea=29}return 0===ea?"":String.format("&pc={0:D}",ea)};Wf.mQh=function(J){if(sg.a.Eh)switch(J){case 1:return zg.a.nH("393806");case 2:return zg.a.nH("393810");case 3:return zg.a.nH("393809");case 5:return zg.a.nH("393805")}else if(sg.a.kp)switch(J){case 1:return zg.a.nH("521979");
case 3:return zg.a.nH("521980");case 5:return zg.a.nH("521978");case 2:return zg.a.nH("522490")}else{if(2===J)return zg.a.nH("517778");if(1===J)return zg.a.DZ(30)}return zg.a.nH("522402")};Ck.Object.defineProperties(Wf.prototype,{csf:{configurable:!0,enumerable:!0,get:function(){return this.dLb}},HDi:{configurable:!0,enumerable:!0,get:function(){return this.dLb&&MSOJS.ClientUtils.OfferOfficeInDialog()}},dLb:{configurable:!0,enumerable:!0,get:function(){return this.xqg&&!sg.a.isMac}},isFreemiumUpsellEnabled:{configurable:!0,
enumerable:!0,get:function(){var J=!1;this.YEc&&(J=this.YEc.isFreemiumUpsellEnabled());return J}}});Object(ee.a)(Wf,"OfficeTrialExperience",null,[254]);of.prototype.fi=function(J){J.register(Wf,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").Hc().Oc(function(){return new Wf(Ud.AFrameworkApplication.Ib,Ud.AFrameworkApplication.wzb,Ud.AFrameworkApplication.lcid)});J.register($f,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").Hc().Oc(function(){return new $f(Ud.AFrameworkApplication.Ib,
Ud.AFrameworkApplication.Fgc,Ud.AFrameworkApplication.lcid)})};Object(ee.a)(of,"OpenInClientConfiguration",null,[5]);var qg=b(1402),Kg=b(38),di=b(1303),Bh=b(230);Ck.Object.defineProperties(kf,{hg:{configurable:!0,enumerable:!0,get:function(){return Of.a.$o(kf.zk,CommonUIStrings.l_OICLaunchDialogTitle)}}});kf.zk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(ee.a)(kf,"OICLaunchDialogHtml",null,[]);var ak=Of.a;Wl(Ge,ak);Ge.prototype.t9a=function(){this.xCa=je("BtnRichClient",this.sq.isb,this.sq.Bxb,this.sq.vkd,CommonUIStrings.l_OICLaunchRichClient,Object(vf.a)(this,this.UAf,"onRichClientButtonClick"),dg);document.getElementById("OICLaunchRichClient").appendChild(this.xCa);Zd(this.xCa);this.LUa=je("BtnReturn",this.sq.isb,this.sq.Bxb,this.sq.K8e,CommonUIStrings.l_OICReturnToOnlineClient,Object(vf.a)(this,this.RAf,"onReturnButtonClick"),dg);document.getElementById("OICReturnToApp").appendChild(this.LUa);
Zd(this.LUa)};Ge.prototype.RAf=function(){this.hide();this.sq.Fbb();return!0};Ge.prototype.UAf=function(){vd.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();Ud.AFrameworkApplication.Ib.processAction(Xf.a.wQa,2);return!0};Ge.prototype.aEi=function(){this.sq.Fbb()};Ge.prototype.dispose=function(){this.Tpa||(this.xCa&&(Bh.a.instance.Aa(ug.a.click,this.xCa,Object(vf.a)(this,this.UAf,"onRichClientButtonClick")),yh.KeyInputManager.instance.Aa(ug.a.Vd,this.xCa,dg)),this.LUa&&
(Bh.a.instance.Aa(ug.a.click,this.LUa,Object(vf.a)(this,this.RAf,"onReturnButtonClick")),yh.KeyInputManager.instance.Aa(ug.a.Vd,this.LUa,dg)),ak.prototype.dispose.call(this),this.Tpa=!0)};Object(ee.a)(Ge,"OICLaunchDialog",Of.a,[]);Ck.Object.defineProperties(sd,{hg:{configurable:!0,enumerable:!0,get:function(){return Of.a.$o(sd.zk,CommonUIStrings.l_OICDialogTitle)}}});sd.zk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(ee.a)(sd,"ProtocolLaunchingDialogV2Html",null,[]);var Kh=Of.a;Wl(ce,Kh);ce.prototype.t9a=function(){var J=document.getElementById("Issues");if(J){Ze("",this.sq.isb,this.sq.Bxb,this.sq.vkd,J);var ea=document.createElement("span");ea.className="WACDialogSectionTitle";ea.innerText=5===this.sq.PDf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;J.appendChild(ea);Zd(J);J.style.display="none"}Ud.AFrameworkApplication.sa.Qa.dhd?(this.KUa=je("GiveFeedback",this.sq.isb,
this.sq.Bxb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(vf.a)(this,this.gnc,"onGiveFeedbackClick"),Object(vf.a)(this,this.axf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.KUa),Zd(this.KUa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===Ud.AFrameworkApplication.sa.Qa.editMode||Ud.AFrameworkApplication.Jeh?document.getElementById("ButtonEdit").style.display="none":(this.Zea=je("Edit",this.sq.isb,this.sq.Bxb,
"",2===Ud.AFrameworkApplication.sa.Qa.Sj?4===Ud.AFrameworkApplication.sa.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===Ud.AFrameworkApplication.sa.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(vf.a)(this,this.Jvf,"onEditClick"),Object(vf.a)(this,this.Nvf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.Zea),Zd(this.Zea));0===Ud.AFrameworkApplication.sa.Qa.editMode&&
!Ud.AFrameworkApplication.wzb&&J&&(J.style.display="none")};ce.prototype.KTe=function(){return this.xpa?(this.rI(this.xpa),!0):!1};ce.prototype.ITe=function(){return this.Zea?(this.rI(this.Zea),!0):!1};ce.prototype.Nvf=function(J){return this.Ryd(J,0)};ce.prototype.axf=function(J){return this.Ryd(J,2)};ce.prototype.PAf=function(J){return this.Ryd(J,1)};ce.prototype.Ryd=function(J,ea){var Wa=!1;if(J.Ca.keyCode===wi.a.ei||J.Ca.keyCode===wi.a.Soa)J.Lb.click(),Wa=!0;else if(J.Ca.keyCode===Sys.UI.Key.down||
J.Ca.keyCode===Sys.UI.Key.up)switch(ea){case 1:Wa=this.ITe();break;case 0:Wa=this.KTe()}return Wa};ce.prototype.Jvf=function(){this.hide();4===Ud.AFrameworkApplication.sa.Qa.editMode?(vd.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.sq.Fbb()):(vd.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.sq.Chd());return!0};ce.prototype.gnc=function(){vd.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.sq.O4e();return!0};ce.prototype.foc=
function(){vd.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";Ud.AFrameworkApplication.Ib.processAction(Xf.a.wQa,2);return!0};ce.prototype.lFd=function(){this.sq.Fbb()};ce.prototype.switchToBackupMode=function(){var J=document.getElementById("ProtocolLaunchingDialogTitle");if(J){J.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(J=document.getElementById("Issues"))J.style.display="block";(J=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&
!J.children.length&&(this.xpa=je("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(vf.a)(this,this.foc,"onRetryOICClick"),Object(vf.a)(this,this.PAf,"onRetryOICKeyUp")),J.appendChild(this.xpa),Zd(this.xpa),this.Zea||this.KTe())}};ce.prototype.dispose=function(){this.Tpa||(this.Zea&&(Bh.a.instance.Aa(ug.a.click,this.Zea,Object(vf.a)(this,this.Jvf,"onEditClick")),yh.KeyInputManager.instance.Aa(ug.a.Vd,this.Zea,Object(vf.a)(this,this.Nvf,"onEditKeyUp"))),this.KUa&&(Bh.a.instance.Aa(ug.a.click,
this.KUa,Object(vf.a)(this,this.gnc,"onGiveFeedbackClick")),yh.KeyInputManager.instance.Aa(ug.a.Vd,this.KUa,Object(vf.a)(this,this.axf,"onGiveFeedbackKeyUp"))),this.xpa&&(Bh.a.instance.Aa(ug.a.click,this.xpa,Object(vf.a)(this,this.foc,"onRetryOICClick")),yh.KeyInputManager.instance.Aa(ug.a.Vd,this.xpa,Object(vf.a)(this,this.PAf,"onRetryOICKeyUp"))),Kh.prototype.dispose.call(this),this.Tpa=!0)};Object(ee.a)(ce,"ProtocolLaunchingDialog",Of.a,[]);var Fg=b(455),si=Dc.StandardDialog;Wl(Kd,si);Kd.prototype.gnc=
function(J){vd.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.cwf(J)};Kd.prototype.foc=function(){vd.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");Ud.AFrameworkApplication.Ib.processAction(Xf.a.wQa,2)};Kd.prototype.lFd=function(J){Kd.O5e?3===J?this.QSf():2===J||0===J?this.continueEditing():1===J&&this.IYg():2===J?this.QSf():(1===J||0===J)&&this.continueEditing()};Kd.prototype.IYg=function(){vd.ULS.sendTraceTag(577783557,211,50,"Closing the document");Ud.AFrameworkApplication.Ib.se(Xf.a.close,
2,Fg.a)};Kd.prototype.QSf=function(){vd.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(vf.a)(this,this.foc,"onRetryOICClick"),0)};Kd.prototype.continueEditing=function(){4===Ud.AFrameworkApplication.sa.Qa.editMode||Ud.AFrameworkApplication.fa.ra("WordConsumptionViewToEditRedirectIsEnabled")&&1===Ud.AFrameworkApplication.sa.mode?(vd.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.sq.Fbb()):(vd.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),
this.sq.Chd())};Ck.Object.defineProperties(Kd,{O5e:{configurable:!0,enumerable:!0,get:function(){return Ud.AFrameworkApplication.fa.ra("OICDialogThreeActions")&&32===Ud.AFrameworkApplication.Ib.processAction(Xf.a.close,1)}}});Object(ee.a)(Kd,"StandardProtocolLaunchingDialog",Dc.StandardDialog,[]);Object(ee.a)(Ac,"EditDocumentInClientParams",null,[]);Te.e7c=function(J,ea,Wa,Pb,Cc,pd,wd,ue,Je,tg,oh,Qh,ni,Jj,Mj,uk){wd=void 0===wd?!1:wd;ue=void 0===ue?!1:ue;Je=void 0===Je?"":Je;tg=void 0===tg?!1:tg;oh=
void 0===oh?!1:oh;Qh=void 0===Qh?!1:Qh;ni=void 0===ni?"":ni;Jj=void 0===Jj?"":Jj;Mj=void 0===Mj?"":Mj;uk=void 0===uk?!1:uk;var H=new Ac;H.DocumentUrl=J;H.Mode=ea;H.Options=Wa;H.Application=Pb;H.SilentExternalHandler=wd;H.EncodeUrl=ue;H.CorrelationIdForWinClient=Je;H.NavigateUsingWindowOpen=tg;H.DescriptiveUnattemptedEnums=oh;H.NoBrowserModalDialogs=Qh;H.SessionOrigin=ni;H.CorrelationId=Jj;H.ClickTime=Mj;H.NewTelemetryDataIsEnabled=uk;MSOJS.ClientUtils.EditDocumentInClient(H,Cc,pd)};Object(ee.a)(Te,
"ClientUtils",null,[]);var xj=b(187),lj=b(517),gk=b(176),zj=b(1028),Qj=b(78);ne.prototype.owc=function(J,ea,Wa){ea=void 0===ea?"":ea;this.JD=(void 0===Wa?"":Wa)||gk.a.create().toString();this.lWb=ea||lj.a.F_e();this.XQb=J};ne.prototype.Yfj=function(J,ea,Wa){return ea.contextId!==Eh.a.frame?2:1===Wa?32:this.wQa()};ne.prototype.VEj=function(){return!(2===this.application&&Ud.AFrameworkApplication.fa.ra("IsEmbeddedScenario"))};ne.prototype.closeApplication=function(){this.VTd||this.ewh()};ne.prototype.Fbb=
function(){this.YEj||this.uwh()};ne.prototype.DLf=function(J){this.tSj&&sg.a.Eh?new Ge(this):this.g3b(J)};ne.prototype.g3b=function(J){J=this.rpi(J);var ea=J.returnValue;vd.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===ea,J.oBa);return ea};ne.prototype.pGa=function(J,ea,Wa,Pb,Cc,pd){this.RUa=J;this.Q4d=ea;this.Ufa=pd;this.application=Wa;this.WB=Pb;Ud.AFrameworkApplication.downloadCopyOnOpenInClient?this.ljf():Ud.AFrameworkApplication.limitedEdit&&!Ud.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?
Ud.AFrameworkApplication.j3f():this.dNg(Cc)};ne.prototype.wQa=function(){this.$Di&&this.psi();return this.g3b(this.qib)};ne.prototype.FWf=function(){var J=new zj.a(hh.a.openInClient);J.Values["ui-language"]=Ud.AFrameworkApplication.lcid.toString();J.Values[fa.a.r4c]=Ud.AFrameworkApplication.userSessionId;return this.Ufa.value.send(J)?32:8};ne.prototype.psi=function(){lh.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new Vg.a,{inStaging:!0}))};
ne.prototype.Alj=function(J){var ea=new zj.a(hh.a.FUj);ea.Values["ui-language"]=Ud.AFrameworkApplication.lcid.toString();ea.Values[fa.a.r4c]=Ud.AFrameworkApplication.userSessionId;ea.Values[Rg.a.EUj]=J;this.Ufa.value.send(ea)};ne.prototype.rpi=function(J){this.qib=J;this.Alj(5===this.WB?ne.pTi:ne.rTi);return 5===this.WB?this.qpi():this.vpi()};ne.prototype.qpi=function(){this.rjf();return{returnValue:32,oBa:"HostEditUrl,"}};ne.prototype.vpi=function(){var J,ea=J="";Ud.AFrameworkApplication.Gle&&(ea=
"|f|"+Ud.AFrameworkApplication.userSessionId);var Wa=Ud.AFrameworkApplication.fa.ra("IsAssignmentMode")&&Ud.AFrameworkApplication.fa.ra("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||Ud.AFrameworkApplication.isUnifiedHostMode||sg.a.dxa,Pb=Ud.AFrameworkApplication.fa.ra("UnattemptedEnumIsEnabled"),Cc=Ud.AFrameworkApplication.fa.ra("NoBrowserModalDialogs");if(Ud.AFrameworkApplication.Ib.Klc){var pd=Ud.AFrameworkApplication.Ib.JZ(3588168074);pd&&this.owc(pd.epochClickTime,pd.sessionOrigin,
pd.correlationId);this.xlf()}if(Ud.AFrameworkApplication.PGf){J+="NewOrder,";pd=8;this.Ufa&&this.Ufa.value&&this.Ufa.value.isEnabled()&&Ud.AFrameworkApplication.EYd&&(J+="Post,",pd=this.FWf());if(32===pd)return{returnValue:pd,oBa:J};vd.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return Ud.AFrameworkApplication.jm.Y9a?(vd.ULS.shipAssertTag(5566816,211,!!Ud.AFrameworkApplication.jm.Y9a),J+="HostUrl,",{returnValue:Ud.AFrameworkApplication.sa.I8a(Ud.AFrameworkApplication.jm.Y9a),
oBa:J}):this.RUa?(vd.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",Ud.AFrameworkApplication.userSessionId),J+="DocUrl,",Te.e7c(this.RUa,this.WB,this.options,this.application,Object(vf.a)(this,this.Mvf,"onEditInClientSuccess"),Object(vf.a)(this,this.Lvf,"onEditInClientFailure"),this.M3f,Ud.AFrameworkApplication.fa.ra("OICEncodeUrlIsEnabled"),ea,Wa,Pb,Cc,this.lWb,this.JD,this.XQb,Ud.AFrameworkApplication.Ib.Klc),{returnValue:32,oBa:J}):{returnValue:8,oBa:J}}J+="OldOrder,";
if(!this.RUa&&Ud.AFrameworkApplication.jm.Y9a)return this.Ufa&&this.Ufa.value&&this.Ufa.value.isEnabled()&&Ud.AFrameworkApplication.EYd?(J+="Post,",ea=this.FWf()):(vd.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),ea=8),32!==ea?(vd.ULS.shipAssertTag(22595484,211,!!Ud.AFrameworkApplication.jm.Y9a),J+="HostUrl,",{returnValue:Ud.AFrameworkApplication.sa.I8a(Ud.AFrameworkApplication.jm.Y9a),oBa:J}):{returnValue:ea,oBa:J};vd.ULS.sendTraceTag(22595485,211,
15,"Try to open doc in rich client, SessionId {0}",Ud.AFrameworkApplication.userSessionId);J+="DocUrl,";Te.e7c(this.RUa,this.WB,this.options,this.application,Object(vf.a)(this,this.Mvf,"onEditInClientSuccess"),Object(vf.a)(this,this.Lvf,"onEditInClientFailure"),this.M3f,Ud.AFrameworkApplication.fa.ra("OICEncodeUrlIsEnabled"),ea,Wa,Pb,Cc,this.lWb,this.JD,this.XQb,Ud.AFrameworkApplication.Ib.Klc);return{returnValue:32,oBa:J}};ne.prototype.NQf=function(J){Ud.AFrameworkApplication.Xm.setDw(8981,J)};ne.prototype.Mvf=
function(J){this.NQf(J);vd.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===J&&MSOJS.ClientUtils.ShouldShowDialog()?(this.M6f||this.rjf(),this.xlf()):this.VTd||this.closeApplication()};ne.prototype.Lvf=function(J,ea){ea=void 0===ea?0:ea;vd.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",J,ea);if(5===J)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{var Wa=!!this.Q4d&&!this.qib,Pb=0;1===J&&(Pb=2);6<=J&&13>=J&&
(Pb=1,1===ea&&(this.VTd=!0));this.Jzc.HDi?(vd.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",Pb),di.a.instance.A7g(this.qib?Object(vf.a)(this,this.xsf,"oicErrorDialogHandlerCloseForced"):Object(vf.a)(this,this.ysf,"oicErrorDialogHandlerNoCloseForced"),Wa?Object(vf.a)(this,this.fyf,"onLaunchDownload"):null,this.oHe(!1)?Object(vf.a)(this,this.i6h,"iHaveOfficeButtonHandler"):null,Pb,ea)):(vd.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",
Pb),di.a.instance.y7g(this.qib?Object(vf.a)(this,this.xsf,"oicErrorDialogHandlerCloseForced"):Object(vf.a)(this,this.ysf,"oicErrorDialogHandlerNoCloseForced"),Wa?Object(vf.a)(this,this.fyf,"onLaunchDownload"):null,Pb))}};ne.prototype.xlf=function(){try{var J=[Object.assign(new Qj.a,{name:"CorrelationId",string:this.JD}),Object.assign(new Qj.a,{name:"SessionOrigin",string:this.lWb}),Object.assign(new Qj.a,{name:"ClickTime",string:this.XQb}),Object.assign(new Qj.a,{name:"ProtocolHandlerFinishedTimestamp",
double:(new Date).getTime()})];xj.a("OpenInClientCompleted",!0,0,J)}catch(ea){vd.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+ea.toString())}};ne.prototype.rjf=function(){Ud.AFrameworkApplication.sa&&Ud.AFrameworkApplication.sa.Qa.lv&&Ud.AFrameworkApplication.fa.ra("StandardProtocolDialogIsEnabled")?new Kd(this):new ce(this)};ne.prototype.xsf=function(){this.closeApplication()};ne.prototype.ysf=function(){this.Fbb()};ne.prototype.fyf=function(){this.ljf()};ne.prototype.i6h=function(){return this.oHe(!0)};
ne.prototype.oHe=function(J){var ea=(sg.a.f_||sg.a.JH)&&!!Ud.AFrameworkApplication.r6b;ea&&J&&(ve.a.mf(Ud.AFrameworkApplication.r6b,"_blank",void 0,"OpenInClient"),this.closeApplication());return ea};Ck.Object.defineProperties(ne.prototype,{PDf:{configurable:!0,enumerable:!0,get:function(){return this.WB}},options:{configurable:!0,enumerable:!0,get:function(){var J=0;Ud.AFrameworkApplication.Zdj&&(J|=1);Ud.AFrameworkApplication.openInClientEditOnly&&(J|=4);this.VEj()&&(J|=64);return J}},isb:{configurable:!0,
enumerable:!0,get:function(){return Ud.AFrameworkApplication.PC}},Bxb:{configurable:!0,enumerable:!0,get:function(){return Ud.AFrameworkApplication.wxb}},K8e:{configurable:!0,enumerable:!0,get:function(){return""}},vkd:{configurable:!0,enumerable:!0,get:function(){return""}},M6f:{configurable:!0,enumerable:!0,get:function(){return Ud.AFrameworkApplication.fa.ra("OneNoteMobileViewerIsEnabled")}},Jzc:{configurable:!0,enumerable:!0,get:function(){return this.Pbe||(this.Pbe=Kb.a.instance.resolve("Common.IOfficeTrialExperience"))}},
$Di:{configurable:!0,enumerable:!0,get:function(){return!!Ud.AFrameworkApplication.fa&&Ud.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}}});ne.rTi="OpenInDesktop";ne.pTi="OpenInBrowser";Object(ee.a)(ne,"AOpenInClientOperation",null,[]);var Gg=b(209),Xh=b(213),rj=b(121),mk=b(47),dk=b(43),yj=b(197),Gi=b(95),Nh=b(35),Hh=b(521),Aj=b(1249),Kf=b(649);Wl(Af,ne);Af.prototype.Q_g=function(){this.DLf(this.VTe)};Af.prototype.Q1g=function(){var J=this,
ea=this.$;wh.TaskExtensions.Ba(this.VJ.value,function(Wa){J.pGa(ea.workbookContext.ClientUrl,Ud.AFrameworkApplication.S3,1,ea.isEditMode?2:0,!0,new Sf.a(function(){return Wa.result}))},this.la,3)};Af.prototype.Chd=function(){0!==xc.a.Fg.editMode&&(this.$.Ab.Cz=!1)};Af.prototype.O4e=function(){var J={};J[ca.a.g9b]=!1;J[ca.a.AQ]="OpenInExcel";this.$.Ud(802602464,pb.a.Sb,8,J)};Af.prototype.c2c=function(){var J=this;if(this.ea.rc){var ea=this.$;ea.isEditMode&&wh.TaskExtensions.Ba(this.VJ.value,function(Wa){J.pGa(ea.workbookContext.ClientUrl,
Ud.AFrameworkApplication.S3,1,2,!1,new Sf.a(function(){return Wa.result}))},this.la,3)}};Af.prototype.fBe=function(){var J=this;this.ea.rc&&wh.TaskExtensions.Ba(this.VJ.value,function(ea){J.pGa(J.$.workbookContext.ClientUrl,Ud.AFrameworkApplication.S3,1,J.$.isEditMode?2:0,!1,new Sf.a(function(){return ea.result}))},this.la,3)};Af.prototype.owc=function(J){ne.prototype.owc.call(this,J)};Af.prototype.openInExcelClient=function(){var J=this;this.ea.rc&&(this.$.isEditMode||wh.TaskExtensions.Ba(this.VJ.value,
function(ea){J.pGa(J.$.workbookContext.ClientUrl,Ud.AFrameworkApplication.S3,1,0,!1,new Sf.a(function(){return ea.result}))},this.la,3))};Af.prototype.openInBrowser=function(){var J=this;this.ea.rc&&wh.TaskExtensions.Ba(this.VJ.value,function(ea){J.pGa(J.$.workbookContext.ClientUrl,Ud.AFrameworkApplication.S3,1,5,!1,new Sf.a(function(){return ea.result}))},this.la,3)};Af.prototype.downloadFile=function(J){var ea=this.iue(J);this.taa.downloadFile(ea,J);this.Rsi()};Af.prototype.Rsi=function(){Ud.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",
!1)&&null!=this.mga&&this.mga.execute(function(J){return J.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})};Af.prototype.LDf=function(J,ea){ea=void 0===ea?0:ea;if(this.ea.rc){var Wa=this.$;yd.a(Wa).LLa?this.MDf(J,Wa):0<ea?this.TCj(J,Wa,ea):this.Y1f(Wa)}};Af.prototype.pGa=function(J,ea,Wa,Pb,Cc,pd){this.$.Ab.Cz=!nf.EwaSettings.isChangeGateEnabled("OfficeVSO:5209012_KeepMenuEnableAfterOIC")||!this.$.xc.inWebPart;this.VTe=Cc;this.h3b=null;this.D6c=
!1;this.iNg(J,ea,Pb,Cc,pd)};Af.prototype.g3b=function(J){var ea=this.$.xc;vd.ULS.sendTraceTag(537154775,0,50,"OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:{0}, InWebPart:{1}, DivSyndicated:{2}, Mode:{3}",ea.inEmbedView,ea.inWebPart,ea.isDivSyndicated,this.$.isEditMode?Gg.a.edit:Gg.a.view);return Af.def()?(this.E2b(),Te.e7c(this.RUa,this.WB,this.options,1,this.aIi,this.$Hi,!1,Ud.AFrameworkApplication.fa.ra("OICEncodeUrlIsEnabled")),32):ne.prototype.g3b.call(this,J)};Af.prototype.ewh=function(){this.RRf();
var J=this.$;if(!this.ea.xc.inWebPart&&this.ea.rc&&!J.isEditMode){var ea=new Gi.a(2145659238,pb.a.Sb,this.$.Xc,0,null);this.aze=mk.a.instance.create(function(){J.Ka.Wb(ea)},0,dk.a.sTi)}};Af.prototype.dispose=function(){this.ea&&this.ea.Dk(this.od);hb.a.Dc([this.Pa,this.aze,this.Hm]);this.$=this.ea=null};Af.prototype.uwh=function(){this.RRf()};Af.prototype.ljf=function(){var J=this;mk.a.instance.create(function(){J.$.Ka.Wb(new Gi.a(-2028960985,pb.a.Sb,0,30,null))},0,dk.a.tTi,!0,!0)};Af.prototype.dNg=
function(J){var ea=this.$,Wa=yd.a(this.$).ud.activityState;Wa[Hh.a.Vje]=!0;ea.isEditMode&&this.ea.rc?(this.E2b(),gj.a(ea).tt(new Ei.a(Xg.a.oz,5,function(){ea.fI(!1);Wa[rb.a.hr]=Xg.a.G2b;Wa[Hh.a.nzg]=J;Wa[Oi.a.oad]=!0;ea.isEditMode&&(Wa[Oi.a.QT]=1,Wa[Oi.a.uY]=!0,Wa[ec.a.uYb]=!0,Wa[ec.a.MTc]=!0);Wa[Hh.a.Yje]=1455037301}))):this.DLf(J)};Af.prototype.L4f=function(){var J=Ud.AFrameworkApplication.S3;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.I8a(J,!0)){var ea=this.$.ea.xc;vd.ULS.sendTraceTag(537154773,
0,50,"Url:[{0}] IsEmbedded:[{1}] InWebPart:[{2}] DivSyndicated:[{3}], Mode:[{4}]",J,ea.inEmbedView,ea.inWebPart,ea.isDivSyndicated,this.$.isEditMode?Gg.a.edit:Gg.a.view)}}else this.taa.downloadFile(J,-2028960985);this.D6c=!0;this.E2b()};Af.prototype.Ppi=function(){this.Jzc.csf&&this.Jzc.sjc(1)};Af.prototype.Qpi=function(){this.Jzc.csf&&Zh.HelperMethods.mf(zg.a.DZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")};Af.prototype.$pi=function(){Zh.HelperMethods.mf(zg.a.DZ(31),"_blank",
void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")};Af.prototype.aqi=function(){Zh.HelperMethods.mf(zg.a.DZ(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")};Af.prototype.iue=function(J){var ea=new Sys.StringBuilder,Wa=this.$.workbookContext,Pb=this.$.ya;ea.append(this.$.Jda);ea.append(Pb.FileHandlerRelativeUri);ea.append("?id=");ea.append(encodeURIComponent(Xh.a.IHb(Wa.WorkbookUri,"sc")));this.$.ea.rc&&(ea.append("&sessionId="),ea.append(encodeURIComponent(this.$.ea.sessionId)));
switch(J){case -974518828:ea.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:ea.append("&workbookType=FullWorkbook");break;case -1059172980:ea.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:ea.clear()}rj.a.YYa(ea,Pb);return ea.toString()};Af.prototype.x0g=function(){qg.a.instance.DWg();var J=this.$.ya;MSOJS.ClientUtils.InitUrls(J.RoamingAppsX86RootUrl,J.RoamingAppsControlInstallerUrl,J.RoamingAppsFirefoxExtensionUrl)};Af.prototype.RRf=function(){var J=
this.$;this.ea.rc||Sc.a.pFd(J,yd.a(J).ud);this.E2b();this.h3b&&this.h3b(this,this.D6c);J.frame.zt.im(this.$.frame.Laa());J.frame.vX.im(this.$.frame.Laa());J.Ab.Cz=!1;wg.g(J).focus()};Af.prototype.iNg=function(J,ea,Wa,Pb,Cc){var pd=this.$;Ud.AFrameworkApplication.sa&&!Af.def()&&(pd.frame.zt.pn(pd.frame.Laa()),pd.frame.vX.pn(pd.frame.Laa()));ne.prototype.pGa.call(this,J,ea,1,Wa,Pb,Cc)};Af.prototype.E2b=function(){var J=this.$;yd.a(J).wi.activityName===Xg.a.openInExcelClient&&yd.a(J).ud.yJ()};Af.prototype.Qxj=
function(){var J=uh.a.gd(1,0,683,684,0,1341525452,"OpenInExcelActiveXError");gj.a(this.$).Cr([J])};Af.prototype.TCj=function(J,ea,Wa){var Pb=this,Cc=null,pd=window.setTimeout(function(){yd.a(ea).vsc(Cc);Pb.Y1f(ea)},Wa);Cc=function(){yd.a(ea).LLa&&(yd.a(ea).vsc(Cc),window.clearTimeout(pd),Pb.MDf(J,ea))};yd.a(ea).OUc(Cc)};Af.prototype.Y1f=function(J){var ea=uh.a.gd(1,1,0,698,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");gj.a(J).Cr([ea])};Af.prototype.MDf=function(J,ea){var Wa=this;gj.a(ea).tt(new Ei.a(Xg.a.oz,
5,function(){ea.fI(!1);var Pb=yd.a(ea).ud,Cc=Pb.activityState;Cc[rb.a.hr]=Xg.a.KIe;Cc[fd.a.wYb]=ea.ea.xc.hasUnsupportedFeaturesForEdit;Cc[Kf.a.GTc]=J;Pb.Jt(uh.a.oaa(Wa.businessBar.p7c,[1437034227]))}))};Af.def=function(){return 1<xc.a.getRegisteredEwaInstances().length};Ck.Object.defineProperties(Af.prototype,{K8e:{configurable:!0,enumerable:!0,get:function(){return"EditInExcelWebApp_32x32x32"}},la:{configurable:!0,enumerable:!0,get:function(){this.Hm=this.Hm||new yj.a;return this.Hm.token}},vkd:{configurable:!0,
enumerable:!0,get:function(){return"excel32"}},M6f:{configurable:!0,enumerable:!0,get:function(){return this.ea.xc.inWebPart}}});Object(ee.a)(Af,"OpenInExcelOperation",ne,[766,3]);var sf=vh.a;Wl(he,sf);he.prototype.create=function(){var J=this;if(this.$.da.za(55))this.Eb(this.$.da.za(55));else{var ea=ah.GetServiceTaskFactory.create(this.$.da,155,this.la,this.vb),Wa=ah.GetServiceTaskFactory.Xa(this.$.da,5,4,this.vb);wh.TaskExtensions.Ba(Wc.Task.WAA(ea,Wa),function(){J.Eb(new Af(J.$,new Sf.a(function(){return ah.GetServiceTaskFactory.create(J.$.da,
137,J.la,J.vb)}),Wa.result))},this.la,3)}};he.w0g=function(){he.Asf||(he.Asf=!0,(new of).fi(Kb.a.instance),Kb.a.instance.resolve("Common.IOfficeTrialExperience").Og(),Kb.a.instance.resolve("Common.IMacOfficeOffer").Og())};he.Asf=!1;Object(ee.a)(he,"OpenInClientFactory",vh.a,[]);var $h=b(115),Di=b(411),zi=$h.a;Wl(Id,zi);Id.prototype.execute=function(J){var ea=Object(Db.a)(6,J.Ke);wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.create(ea.da,56,ea.la,0),function(Wa){ea.downloadCopyOnOpenInClient?(J.activityState[Di.a.Wje]=
!0,Wa.result.L4f()):Wa.result.Q1g()},ea.la,3);return 1};Object(ee.a)(Id,"OpenInExcelClientActivity",$h.a,[]);var xk=vh.a;Wl($d,xk);$d.prototype.create=function(){var J=this;wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.create(this.$.da,155,this.la,this.vb),function(){J.Eb(new Id(Xg.a.openInExcelClient,Xg.a.idle))},this.la)};Object(ee.a)($d,"OpenInExcelClientActivityFactory",vh.a,[]);var Pi=rc.a;Wl(Ke,Pi);Ke.prototype.initialize=function(J){Pi.prototype.initialize.call(this,J)};Ke.prototype.execute=
function(J){this.xi=J;J=Object(Db.a)(6,this.xi.Ke);this.frb(J);return 1};Ke.prototype.DI=function(J){Pi.prototype.DI.call(this,J)};Ke.prototype.frb=function(){var J=this;this.subscribe(this.xi,this.HVi,function(ea){J.CCd.add_disposing(ea)})};Ke.prototype.GFb=function(J){this.unsubscribe(function(ea){J.remove_disposing(ea)});this.xi.activityState[L.a.u2]=0};Object(ee.a)(Ke,"PasswordProtectedFileActivity",rc.a,[]);var nk=hi.a;Wl(Fe,nk);Fe.prototype.qab=function(J){this.Rpa=J};Fe.prototype.w3=function(){var J=
{};J[hi.a.description]=Ne.a.instance.ga(1948);J[hi.a.yma]=Ne.a.instance.ga(1944);J[hi.a.bFf]=Ne.a.instance.ga(1966);J[hi.a.$Ef]=Ne.a.instance.ga(1967);J[hi.a.aFf]=Ne.a.instance.ga(1945);J[hi.a.Jkd]=Ne.a.instance.ga(1951);J[hi.a.bse]=Ne.a.instance.ga(1643);J[hi.a.TTj]=Ne.a.instance.Wa(25);J[hi.a.ueg]=Object(vf.a)(this,this.NTa,"verifySubmittedPassword");return J};Fe.prototype.qta=function(){var J={};J[Ci.a.Px]=this.Cc;J[hi.a.Job]=this.w3();return J};Fe.prototype.Ug=function(){this.ic=1;this.initializeAndShow(this.Jm,
this.N3i,this.qta())};Ck.Object.defineProperties(Fe.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"PasswordDialog"}},$rb:{configurable:!0,enumerable:!0,get:function(){return this.Rpa}},Jm:{configurable:!0,enumerable:!0,get:function(){return Ne.a.instance.ga(1947)}}});Object(ee.a)(Fe,"PasswordProtectedFilePasswordInputDialog",hi.a,[]);var Rj=b(293);Wl(Cf,Fe);Cf.prototype.qab=function(J,ea){Fe.prototype.qab.call(this,J,ea);vd.ULS.sendTraceTag(537154755,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: {0}",
J)};Cf.prototype.NTa=function(J,ea){this.passwordToModify=J;var Wa={};Wa.FileModifyPassword=cg.a.nf(J);Pc.ob(this.$.na.va,Wa,this.oSi(ea),this.nSi(ea),null,null)};Cf.prototype.w3=function(){var J=Fe.prototype.w3.call(this);J[hi.a.Jkd]=Ne.a.instance.ga(1952);J[hi.a.description]=Ne.a.instance.Wa(24);return J};Cf.prototype.Ug=function(){Uh.b().I7c("PasswordToModifyDialogShown");vd.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");
Fe.prototype.Ug.call(this)};Cf.prototype.oSi=function(J){var ea=this;return function(Wa){uh.a.nh(Wa.Errors,[-2019873242])&&ea.B6b(ea.Yqb());if(!Wa||Rj.a(Wa))if(0<ea.VKd)ea.BKf(J);else{vd.ULS.sendTraceTag(537154754,0,10,"VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: {0}",uh.a.Tc(Wa.Errors));ea.$.ea.Cp(Wa.Errors);ea.hide();return}ea.c9d=Wa.Result;ea.Xgc&&(Uh.b().bTd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password",
"PasswordToModifyPasswordVerifiedTillInteractive"),vd.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));J(ea.Xgc?0:1)}};Cf.prototype.nSi=function(J){var ea=this;return function(){0<ea.VKd?ea.BKf(J):(vd.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),J(3))}};Cf.prototype.BKf=function(J){--this.VKd;
this.NTa(this.passwordToModify,J)};Cf.prototype.Yqb=function(){return uh.a.gd(1,0,1642,1643,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")};Ck.Object.defineProperties(Cf.prototype,{Xgc:{configurable:!0,enumerable:!0,get:function(){return this.c9d}},Jm:{configurable:!0,enumerable:!0,get:function(){return Ne.a.instance.ga(1949)}}});Object(ee.a)(Cf,"PasswordProtectedFileModifyPasswordInputDialog",Fe,[]);Wl(qf,Ke);qf.prototype.frb=function(J){this.CCd=new Cf(J);Ke.prototype.frb.call(this,
J)};qf.prototype.GFb=function(J,ea){var Wa=J.$rb,Pb=J.Xgc,Cc=J.passwordToModify;Ke.prototype.GFb.call(this,J,ea);this.xi.Qxa([2001366804]);switch(Wa){case 1:Pb?(ea=Object(Db.a)(6,this.xi.Ke),this.xi.activityState[L.a.lke]=cg.a.nf(Cc),this.xi.activityState[L.a.fYa]=!0,J.passwordToModify="",this.zh(ea.isEditMode?Xg.a.Uj:this.pM)):vd.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.xp();break;case 0:this.xi.activityState[L.a.Ns]=!1;this.zh(this.NJ);this.xp();break;default:vd.ULS.sendTraceTag(537154756,0,50,"PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '{0}'",Wa)}};Object(ee.a)(qf,"PasswordProtectedFileModifyActivity",Ke,[]);var Bj=vh.a;Wl(lf,Bj);lf.prototype.create=function(){this.Eb(new qf(this.activityName,this.pM,this.NJ))};lf.ka=function(J){J.da.Ga(434,new lf(Xg.a.FFb,Xg.a.oeb,Xg.a.UGa,J))};Object(ee.a)(lf,"PasswordProtectedFileModifyActivityFactory",
vh.a,[]);Wl(wb,Fe);wb.prototype.NTa=function(J,ea){this.password=J;ea(0)};wb.prototype.w3=function(){var J=Fe.prototype.w3.call(this);this.rhf&&(J[hi.a.alh]=1);return J};wb.prototype.Ug=function(){vd.ULS.sendTraceTag(537154722,0,50,"PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword={0}",this.rhf);Fe.prototype.Ug.call(this);gj.a(this.$).ooe()};Object(ee.a)(wb,"PasswordProtectedFileOpenPasswordInputDialog",Fe,[]);Wl(Dd,Ke);Dd.prototype.frb=function(J){var ea=
uh.a.nh(this.xi.errors,[1217361942]);this.CCd=new wb(J,ea);J.hfc||J.hHe();Ke.prototype.frb.call(this,J)};Dd.prototype.GFb=function(J,ea){var Wa=J.password;J.password="";var Pb=J.$rb;Ke.prototype.GFb.call(this,J,ea);this.xi.activityState[L.a.QTc]=cg.a.nf(Wa);this.xi.activityState[L.a.fYa]=!0;this.xi.Qxa([110414285,1217361942]);vd.ULS.sendTraceTag(537154752,0,50,"PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: {0}",Pb);switch(Pb){case 1:this.zh(this.pM);
this.xp();break;case 0:this.zh(this.NJ),this.xp()}};Object(ee.a)(Dd,"PasswordProtectedFileOpenActivity",Ke,[]);var Nk=vh.a;Wl(rd,Nk);rd.prototype.create=function(){this.Eb(new Dd(this.activityName,this.pM,this.NJ))};rd.ka=function(J){J.da.Ga(386,new rd(Xg.a.vpc,Xg.a.Uj,Xg.a.Jk,J))};Object(ee.a)(rd,"PasswordProtectedFileOpenActivityFactory",vh.a,[]);var Ik=b(397),Si=Ik.a;Wl(Ec,Si);Ec.prototype.yO=function(J,ea){this.Rpa=J;Si.prototype.yO.call(this,J,ea)};Ec.prototype.Dr=function(){Si.prototype.Dr.call(this);
this.ic=9;var J=this.dQh();this.Ac(1,Ne.a.instance.ga(1641));this.Ac(2,Ne.a.instance.ga(985));this.Ak(Ne.a.instance.ga(704),Vh.a.gg(J),this.icon,this.zO)};Ec.prototype.dQh=function(){return String.format(Ne.a.instance.ga(705))};Ck.Object.defineProperties(Ec.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"SharedWorkbookDialog"}},$rb:{configurable:!0,enumerable:!0,get:function(){return this.Rpa}}});Object(ee.a)(Ec,"LegacySharedWorkbookDialog",Ik.a,[]);var ek=rc.a;Wl(pe,ek);pe.prototype.initialize=
function(J){ek.prototype.initialize.call(this,J)};pe.prototype.execute=function(J){this.xi=J;this.h5g();return 1};pe.prototype.DI=function(J){ek.prototype.DI.call(this,J)};pe.prototype.h5g=function(){var J=Object(Db.a)(6,this.xi.Ke),ea=uh.a.QZa([-573864504]);ea[0].HelpDescription=Ne.a.instance.ga(707);ea[0].HelpTopicId=Zf.a.zqi;var Wa=new Ec(J,ea[0]);this.subscribe(this.xi,this.yqi,function(Pb){Wa.add_disposing(Pb)})};Object(ee.a)(pe,"LegacySharedWorkbookActivity",rc.a,[]);var K=vh.a;Wl(Nd,K);Nd.prototype.create=
function(){this.Eb(new pe(this.activityName,this.pM,this.NJ))};Nd.ka=function(J){J.da.Ga(460,new Nd(Xg.a.vBb,Xg.a.oeb,Xg.a.UGa,J))};Object(ee.a)(Nd,"LegacySharedWorkbookActivityFactory",vh.a,[]);ed.prototype.$c=function(){return!1};ed.prototype.Mc=function(J,ea){if(!nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(ea.command){case 642419866:return!0;case 588342182:return this.presentModeManager.zz;default:return!1}};ed.prototype.executeCommand=function(J,
ea){J=wh.TaskExtensions.sk();ea=ea.command;switch(ea){case 642419866:this.presentModeManager.Gxc(!this.presentModeManager.zz);this.presentModeManager.wh("TogglePresentMode");break;case 588342182:this.presentModeManager.P6a=!this.presentModeManager.P6a;this.presentModeManager.X2f(this.presentModeManager.P6a,"TogglePresentModeOverlay");this.presentModeManager.wh("TogglePresentModeOverlay");break;default:J=xi.a(ea)}return J};ed.prototype.jd=function(){return!1};Object(ee.a)(ed,"PresentModeCommandHandler",
null,[428]);var Ca=bh.a;Wl(wc,Ca);wc.prototype.Od=function(){var J=this;wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.Xa(this.$.da,423,424,this.vb),function(ea){J.Cd([new ed(J.$,ea.result)])},this.la,3)};wc.ka=function(J){bh.a.ee(420,new wc(J))};Object(ee.a)(wc,"PresentModeCommandHandlerFactory",bh.a,[]);var Mb=b(128),tc=b(113);md.Qph="ewa-presentMode-overlay";md.Rph="ewa-presentMode-panel-container";md.Sph="ewa-presentMode-rowHdrParent-container";Object(ee.a)(md,"CssClassNames",null,[]);var Zc=b(19),
Ee=b(154),Ue=b(303),$c=b(133),Yd=b(114),rg=b(465),xg=b(12),Zg=b(100),ih=b(358),qi=b(134),qj=b(441),gh=b(272),Vi=b(256),Vj=b(177);Mc.prototype.dispose=function(){this.$=this.bEd=this.cEd=this.Oca=this.oPa=null};Mc.prototype.G9h=function(){var J=this;window.requestAnimationFrame(function(){J.Oca=document.createElement("div");J.$.jw.insertBefore(J.Oca,J.$.jw.lastChild);J.Oca.id=J.$.Mb+ca.a.V9b;J.Oca.classList.add(md.Rph);J.cEd=document.getElementById(J.$.Mb+ca.a.a5c);J.bEd=[J.$.qE];J.isInitialized=!0});
this.oPa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();this.oPa.initializePresentModeFloatie()};Mc.prototype.CXh=function(){var J={};J.PollingCountPerCaller=tc.a.toJSON(this.Upc);J.PollingDurationPerCaller=tc.a.toJSON(this.Vpc);return J};Mc.prototype.xRd=function(J){this.isInitialized?J?(this.oPa.showPresentModeFloatie(this.Oca,this.cEd,this.bEd),this.wh("ShowOrHideFloatiePanel"),this.U6i()):(this.oPa.hidePresentModeFloatie(),this.tNj()):vd.ULS.sendTraceTag(537154326,
0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")};Mc.prototype.wh=function(J){this.dGf=Zh.HelperMethods.Zb();this.lPa=J;this.Hre=Vj.AsyncMethodContext.Zs(this.Rl,100,dk.a.BZi+J,this.Hre)};Mc.prototype.eg=function(J,ea){if(ea)return!1;J=xg.DOMElementExtensions.mn(this.Oca.querySelectorAll(xg.DOMElementExtensions.$r));if(!J)return vd.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),
!1;J.focus();return!0};Mc.prototype.ph=function(J){return xg.DOMElementExtensions.Ff(this.wc,J)};Mc.prototype.Aj=function(){};Mc.prototype.Qj=function(){};Mc.prototype.U6i=function(){var J=this;gh.a(this.$).ai(this);this.$.da.$a(15,function(ea){J.ewaAccessibilityManager=ea;J.ewaAccessibilityManager.mode=5});yh.KeyInputManager.instance.pa(ug.a.Xb,this.wc,this.onKeyDown)};Mc.prototype.tNj=function(){gh.a(this.$).Pz(this);wg.g(this.$).G0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=
0);yh.KeyInputManager.instance.Aa(ug.a.Xb,this.wc,this.onKeyDown)};Mc.prototype.lij=function(){var J=Zh.HelperMethods.Zb()-this.dGf,ea=this.Vpc[this.lPa]?this.Vpc[this.lPa]:0;this.Vpc[this.lPa]=ea>J?ea:J;this.Upc[this.lPa]=this.Upc[this.lPa]?this.Upc[this.lPa]+1:1};Ck.Object.defineProperties(Mc.prototype,{wc:{configurable:!0,enumerable:!0,get:function(){return this.Oca}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){this.oPa.updatePresentModeFloatieShyState(2);return!!this.Oca}},xe:{configurable:!0,
enumerable:!0,get:function(){return Vi.a.pHf}}});Object(ee.a)(Mc,"PresentModeFloatieManager",null,[824,415,3]);var Ch=b(7),sj=b(60);Object(ee.a)(Sb,"OverlayCavityInfo",null,[]);Object(ee.a)(Cd,"OverlayContainerInfo",null,[]);Object(ee.a)(Xc,"PresentModeOverlayProps",null,[]);Md.prototype.r$h=function(){var J=this;this.dEd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(function(){J.a_a=Array(5);for(var ea,Wa,Pb=1;4>=Pb;Pb++)ea=document.createElement("div"),
xg.DOMElementExtensions.setVisible(ea,!1),ea.id=String.format("{0}-{1}","PresentModeOverlay",Pb),xg.DOMElementExtensions.toggleCssClass(ea,md.Qph,!0),Wa=J.gridView.Uf(Pb).domElement,Wa.insertBefore(ea,Wa.firstChild),J.a_a[Pb]=ea})};Md.prototype.W2f=function(J){J&&this.IQj();for(var ea=1;4>=ea;ea++)this.Fef(ea)&&xg.DOMElementExtensions.setVisible(this.a_a[ea],J);xg.DOMElementExtensions.toggleCssClass(this.$.lr,"ewr-presentMode-overlay",J)};Md.prototype.IQj=function(){for(var J=this.ZSg(),ea,Wa=1;4>=
Wa;Wa++)ea=Wa,J[ea]&&this.dEd.showOverlayWithCavity(this.a_a[ea],J[ea])};Md.prototype.dispose=function(){this.dEd=this.a_a=this.gridView=this.$=null};Md.prototype.ZSg=function(){for(var J,ea,Wa=wg.g(this.$).rtl,Pb,Cc=Array(5),pd=1;4>=pd;pd++)ea=pd,this.Fef(pd)&&(J=this.gridView.Uf(pd),Pb=this.gridView.ha.Oa.i5?this.GNh(pd,J,Wa):this.xOh(pd,J,Wa),J=this.K7g(J),Cc[ea]=this.d8g(this.a_a[ea].id,J,Pb));return Cc};Md.prototype.Fef=function(J){return this.gridView.rb.WQ(J)};Md.prototype.K7g=function(J){return Object(Ch.a)(new Cd,
{width:J.wn.width,height:J.wn.height})};Md.prototype.d8g=function(J,ea,Wa){return Object(Ch.a)(new Xc,{containerId:J,overlayContainerInfo:ea,overlayCavityInfos:Wa?[Wa]:null})};Md.prototype.GNh=function(J,ea,Wa){var Pb=wg.g(this.$).ha.Oa.nc;if(!Pb)return vd.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),null;var Cc=Pb.extension.JNh(J);J=Cc.QBa;Pb=Cc.rotation;var pd=Cc.translateX;var wd=Cc.translateY;return Cc.returnValue?
(Cc=J.x-ea.wn.x,Object(Ch.a)(new Sb,{left:(Wa?ea.wn.width-(Cc+J.width):Cc)-3+1,top:J.y-ea.wn.y-3+1,width:J.width+5,height:J.height+5,angle:Pb,translateX:pd,translateY:wd})):null};Md.prototype.xOh=function(J,ea,Wa){J=this.gridView.Db.Gub(this.gridView.ha.ta.activeRange,J)||sj.a.d4;if(!J.Se(ea.wn))return null;var Pb=J.x-ea.wn.x;return Object(Ch.a)(new Sb,{left:Wa?ea.wn.width-(Pb+J.width)-2:Pb-3,top:J.y-ea.wn.y-3,width:J.width+5,height:J.height+5})};Object(ee.a)(Md,"PresentModeOverlayRenderer",null,
[825,3]);var Cj=hi.a;Wl(Tc,Cj);Tc.prototype.hide=function(){Cj.prototype.hide.call(this);Mb.a.Cv(ca.a.b3f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)};Ck.Object.defineProperties(Tc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"PresentModeWelcomeDialog"}}});Object(ee.a)(Tc,"PresentModeWelcomeDialog",hi.a,[]);Hc.requestFullscreen=function(J){J.webkitRequestFullscreen?J.webkitRequestFullscreen():J.msRequestFullscreen?J.msRequestFullscreen():J.mozRequestFullScreen?
J.mozRequestFullScreen():J.requestFullscreen?J.requestFullscreen():vd.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")};Hc.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():vd.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")};Ck.Object.defineProperties(Hc,
{tDh:{configurable:!0,enumerable:!0,get:function(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}},uDh:{configurable:!0,enumerable:!0,get:function(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?
"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}},Sgi:{configurable:!0,enumerable:!0,get:function(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}});Object(ee.a)(Hc,"FullscreenUtils",null,[]);gc.prototype.Gxc=function(J){var ea=this;this.zz!==J&&(this.f9d=J,this.P6a=this.zz,this.gaf(),this.kLb=this.L1f(),window.requestAnimationFrame(function(){xg.DOMElementExtensions.toggleCssClass(ea.$.lr,
"ewr-presentMode-transition",!0);$addHandler(ea.e2a,"transitionend",ea.zoa);ea.Ryj(!J);ea.tUi();xg.DOMElementExtensions.toggleCssClass(ea.$.lr,"ewr-presentMode-on",J);ea.Qyj(J);Ee.b(ea.$).U2f(ea.zz);Ee.c(ea.$).U2f(ea.zz);ea.$.Mza();ea.qPa.W2f(ea.kLb);if(ea.zz){ea.oZa();Mb.a.get(ca.a.b3f)?ea.Pca.xRd(ea.zz):ea.nqc=new Tc(ea.$,ea.Pca);var Wa=qj.b(ea.$);Wa&&(ea.cLd=Wa.w7c(!1));ea.oHf=Zh.HelperMethods.Zb()}else ea.Pca.xRd(J),ea.cLd&&(Wa=qj.b(ea.$))&&(Wa.w7c(!0),ea.cLd=!1),ea.f6b(),ea.gui()}))};gc.prototype.X2f=
function(J,ea){this.CRd=J;this.wea(ea)};gc.prototype.wh=function(J){this.Pca.wh(J)};gc.prototype.dispose=function(){this.f6b();this.qPa&&(this.qPa.dispose(),this.qPa=null);this.gridView=this.$=null};gc.prototype.Ryj=function(J){var ea=this.$.da.za(25);void 0===ea||null===ea?vd.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):J?ea.Axc():ea.Bdc()};gc.prototype.tUi=function(){var J=this;xg.DOMElementExtensions.toggleCssClass(document.getElementById(Ud.AFrameworkApplication.n2a),
Zc.a.$p,this.zz);xg.DOMElementExtensions.toggleCssClass(this.$.lr,"ewr-presentMode-on",this.zz);this.Uyj(this.zz);this.gridView.dod=!this.zz;this.YQj();this.$.da.$a(32,function(ea){ea.tRj(J.zz)});Yd.b(this.$,function(ea){ea.Ubg(J.zz)})};gc.prototype.Uyj=function(J){if(this.kGb)if(J){if(J=Object(Db.a)(Zg.a,this.$.qa))xg.DOMElementExtensions.toggleCssClass(this.$.lr,"ewr-presentMode-on-headers-off",!J.headersVisible),xg.DOMElementExtensions.toggleCssClass(this.$.lr,"ewr-presentMode-on-rtl",wg.g(this.$).rtl);
this.pBc(0)}else this.$.lr.classList.remove("ewr-presentMode-on-headers-off"),this.$.lr.classList.remove("ewr-presentMode-on-rtl"),this.pBc(1)};gc.prototype.pBc=function(J){var ea=Object(Db.a)(Zg.a,this.$.qa);if(ea){var Wa=parseInt(this.$.jw.style.right,10);if(1===J||2===J){if(isNaN(Wa)||Wa<this.J0a)return;Wa-=this.J0a}if(0===J||2===J)J=ea.headersVisible,ea=wg.g(this.$).rtl,J=J?ea?0:32:12,Wa=isNaN(Wa)?J:Wa+J,this.J0a=J;this.$.jw.style.right=Zh.HelperMethods.uc(Wa);this.WAe=Wa}};gc.prototype.YQj=function(){var J=
document.getElementById(this.$.Mb+ca.a.G5b).parentNode;xg.DOMElementExtensions.toggleCssClass(J,md.Sph,this.zz)};gc.prototype.initialize=function(J){this.qPa=new Md(J);this.qPa.r$h();this.Pca=new Mc(J);this.Pca.G9h();this.e2a=document.getElementById("MainApp");this.AUe=this.bJi;$addHandler(this.e2a,Hc.tDh,this.AUe);$addHandler(this.e2a,Hc.uDh,this.cJi);this.kGb||(this.kGb=document.createElement("div"),this.kGb.className="ewa-presentMode-right-frame",this.$.qE.appendChild(this.kGb));this.zoa=this.s9i};
gc.prototype.oZa=function(){this.gridView.ha.K2(this.Ap);this.gridView.ha.yY(this.Jg);this.gridView.tc.ql(this.fj);this.gridView.tc.Kn(this.Tf);this.gridView.eE(this.yp);this.gridView.view.Rs(this.Mw);this.gridView.JUc(this.JDb);this.gridView.Ea.EG(this.Sm);this.gridView.Ea.Qs(this.yf);this.$.xa.og(this.Th);this.$.xa.Vra(this.uF);this.$.xa.Qga(this.OEb);this.$.GA(this.ej);this.$.dl(this.vd);var J=Object(Db.a)(ih.a,this.$.xa);J=Gl(J.items);for(var ea=J.next();!ea.done;ea=J.next())ea.value.rnb(this.Bya)};
gc.prototype.f6b=function(){this.gridView&&(this.gridView.ha.b7(this.Ap),this.gridView.ha.QW(this.Jg),this.gridView.tc.kl(this.fj),this.gridView.tc.Um(this.Tf),this.gridView.KF(this.yp),this.gridView.view.Xq(this.Mw),this.gridView.qId(this.JDb),this.gridView.Ea.gI(this.Sm),this.gridView.Ea.Vq(this.yf));if(this.$){this.$.xa.Wg(this.Th);this.$.xa.Bza(this.uF);this.$.xa.Yma(this.OEb);this.$.rD(this.ej);this.$.yl(this.vd);var J=Object(Db.a)(ih.a,this.$.xa);J=Gl(J.items);for(var ea=J.next();!ea.done;ea=
J.next())ea.value.$Id(this.Bya)}};gc.prototype.L1f=function(){if(!this.zz||!this.P6a)return!1;if(1===this.gridView.ha.We){var J=this.$.qa.activeRange.isSingle,ea=1===this.$.qa.selectedRanges.length&&!J,Wa=this.gridView.isEditing,Pb=this.Wpd;ea||vd.ULS.sendTraceTag(537154322,0,50,"PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : {0}",J);return this.CRd&&ea&&!Wa&&!Pb}return this.CRd};gc.prototype.Qyj=function(J){J?Hc.requestFullscreen(this.e2a):
Hc.exitFullscreen()};gc.prototype.wea=function(J,ea,Wa){var Pb=this;Wa=void 0===Wa?!1:Wa;void 0!==ea&&ea||(this.kLb=this.L1f());vd.ULS.sendTraceTag(555356484,0,100,"PresentModeManager.UpdateLayout: UpdateLayout triggered by {0}, visibility: {1}, immediateUpdate: {2}",J,this.kLb,Wa);if(this.XNb&&Wa)vd.ULS.sendTraceTag(543023559,0,50,"PresentModeManager.UpdateLayout: Cancel update layout for {0}",this.WNb),window.cancelAnimationFrame(this.WNb),this.WNb=0;else if(this.XNb){vd.ULS.sendTraceTag(543023558,
0,50,"PresentModeManager.UpdateLayout: Skipping update layout for {0}",J);return}Wa?this.VXd(Zh.HelperMethods.Zb(),J):(this.WNb=window.requestAnimationFrame(function(Cc){Pb.VXd(Cc,J)}),this.XNb=!0)};gc.prototype.VXd=function(J,ea){var Wa=this,Pb=Zh.HelperMethods.Zb();if(Pb-J>this.Uij)this.WNb=window.requestAnimationFrame(function(pd){Wa.VXd(pd,ea)}),this.XNb=!1,vd.ULS.sendTraceTag(537154319,0,50,"PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = {0}ms.",Pb-
J);else{this.qPa.W2f(this.kLb);this.XNb=!1;var Cc=Zh.HelperMethods.Zb();J=Zh.HelperMethods.Zb()-J;Pb=Cc-Pb;this.Zhj(J,ea);vd.ULS.sendTraceTag(537154318,0,50,"PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = {0}ms. rafTotalDuration = {1}ms",Pb,J)}};gc.prototype.gaf=function(){var J=this;Ba.a(this.$.userOperationManager,function(ea,Wa,Pb){var Cc=J.$.na.va,pd=J.zz,wd=Cc.Na(41,null);wd.shouldEnablePresentMode=pd;return Pc.i(Cc,"SetPresentMode",wd,ea,Wa,Pb,null,0)},function(ea){return new Fb.a(252,
0,ea)},null)};gc.prototype.GUf=function(){var J=rg.a(this.gridView.We);1!==this.gridView.We||this.$.qa.activeRange.isSingle||(J="Range");this.$uc[J]=this.$uc[J]?this.$uc[J]+1:1};gc.prototype.Zhj=function(J,ea){var Wa=this.epc[ea]?this.epc[ea]:0;this.epc[ea]=Wa>J?Wa:J;this.dpc[ea]=this.dpc[ea]?this.dpc[ea]+1:1};gc.prototype.gui=function(){var J={},ea=Zh.HelperMethods.Zb()-this.oHf;J.PresentModeDuration=ea;J.SelectionCountPerObject=tc.a.toJSON(this.$uc);J.OverlayCountPerCaller=tc.a.toJSON(this.dpc);
J.OverlayDurationPerCaller=tc.a.toJSON(this.epc);ea=this.Pca.CXh();for(var Wa in ea)J[Wa]=ea[Wa];qi.b(this.$).Rd($c.a.AZi,J,void 0,!0)};Ck.Object.defineProperties(gc.prototype,{zz:{configurable:!0,enumerable:!0,get:function(){return this.f9d}}});Object(ee.a)(gc,"PresentModeManager",null,[725,3]);var Fj=b(258),Dk=vh.a;Wl(Jd,Dk);Jd.prototype.create=function(){var J=this,ea=ah.GetServiceTaskFactory.Xa(this.$.da,283,284,1);wh.TaskExtensions.Ba(ea,function(){wh.TaskExtensions.Ba(Fj.c(ea.result.Fn.loadScript("presentMode")),
function(){var Wa=J.$.da.za(423);Wa||(Wa=new gc(J.$),J.$.da.Ga(423,Wa));J.Eb(Wa)},J.$.la,3)},this.$.la,3)};Jd.ka=function(J){J.da.Ga(424,new Jd(J))};Object(ee.a)(Jd,"PresentModeManagerFactory",vh.a,[]);var li=b(244),hj=b(161),ok=b(726),vj=b(88),hk=b(31);zd.uqh="ewa-resizehdr-row-hidden";zd.tqh="ewa-resizehdr-col-hidden";Object(ee.a)(zd,"CssClassNames",null,[]);var yk=b(64),Kj=b(25),Gh=b(151),Ok=b(54),pk=b(72),Nj=b(260),mj=b(388);Object(ee.a)(Qd,"HeaderEventCachedInfo",null,[]);bd.prototype.wBe=function(J){J=
Zh.HelperMethods.eDd(J);return Math.max(0,Math.min(bd.Hof,J))};bd.prototype.nBe=function(J){return this.UWi(J)};bd.prototype.sZg=function(J){return Math.round(this.S6c*J+2*this.ZXe()+1)};bd.prototype.UWi=function(J){return Math.max(0,Math.min(bd.rof,(Math.max(0,Math.min(eg.a.Jkc,J))-2*this.ZXe()-1)/this.S6c))};bd.prototype.ZXe=function(){return Math.floor(Math.max((this.S6c+3)/4,2))};bd.prototype.obc=function(J,ea){return ea?J?bd.Hof:eg.a.uvd:J?bd.rof:eg.a.Jkc};bd.Hof=409;bd.rof=255;Object(ee.a)(bd,
"ResizeHeadersConverter",null,[]);var fk=b(33),Lj=vj.a;Wl(xb,Lj);xb.prototype.nya=function(J,ea,Wa){J=new Sys.UI.DomEvent(J);J=ok.a.create(ug.a.tha,this.domElement,J,2);J=fk.a(this.grid.$).ie(J);this.$Gf(ea,J.clientPoint.x,J.clientPoint.y,!1,Wa);ea=this.Kxc();this.Wbd(this.wSa,ea,!0);this.Oza||(ea=this.domElement.ownerDocument.body,ea.addEventListener(ug.a.tha,this.oxf),ea.addEventListener(ug.a.vGa,this.qxf),this.Oza=!0)};xb.prototype.dLi=function(J,ea){this.$Gf(ea,J.clientX,J.clientY,!0,!1);J=this.grid;
ea=this.Hfd(J);ea=ze.r(ea,J.$);J.Db.Oh([this.isRow?13:14]);J.Db.XRa();this.CHb();var Wa={};J.$.Ud(this.isRow?146338636:1391094586,pb.a.Sb,30,(Wa.autoFitRanges=ea,Wa))};xb.prototype.dispose=function(){this.i0c();this.grid.ha&&(this.grid.ha.RW(this.Jg),this.grid.ha.b7(this.Ap));this.grid.Ww(this.Jg);gj.a(this.grid.$)&&gj.a(this.grid.$).yg.Zma(this.wF);Bh.a.instance.Aa(ug.a.lk,this.domElement,this.rca);li.a.instance.Aa(ug.a.Zd,this.domElement.ownerDocument.body,this.XDb);hj.a.instance.Aa(ug.a.De,this.domElement.ownerDocument.body,
this.XDb);sg.a.pp||(li.a.instance.Aa(ug.a.pointerDown,this.domElement,this.AN),li.a.instance.Aa(ug.a.vh,this.domElement,this.cI));this.Oza&&(li.a.instance.Aa(ug.a.vh,this.domElement.ownerDocument.body,this.l9a),hj.a.instance.Aa(ug.a.Bg,this.domElement.ownerDocument.body,this.l9a),this.Oza=!1);this.iG&&(li.a.instance.Aa(ug.a.pointerDown,this.iG,this.AN),Bh.a.instance.Aa(ug.a.lk,this.iG,this.rca),this.i0c(),this.iG=null);this.rSf&&(xg.DOMElementExtensions.zf(xb.Dbb),xb.Dbb=null);this.sf=null;Lj.prototype.dispose.call(this)};
xb.prototype.s6i=function(){Bh.a.instance.pa(ug.a.lk,this.domElement,this.rca);li.a.instance.pa(ug.a.Zd,this.domElement.ownerDocument.body,this.XDb);hj.a.instance.pa(ug.a.De,this.domElement.ownerDocument.body,this.XDb);sg.a.pp||(li.a.instance.pa(ug.a.pointerDown,this.domElement,this.AN),li.a.instance.pa(ug.a.vh,this.domElement,this.cI))};xb.prototype.Kkh=function(){if(!xb.Dbb){document.getElementById(xb.qSf);this.rSf=!0;var J=xb.Dbb=document.createElement("div");this.grid.$.frame.Laa().appendChild(J);
J.id=xb.qSf;J.className=hk.a.vqh;xg.DOMElementExtensions.setVisible(J,!1)}};xb.prototype.IKe=function(){if(this.Oza){var J=this.domElement.ownerDocument.body;this.grid.om?(J.removeEventListener(ug.a.tha,this.oxf),J.removeEventListener(ug.a.vGa,this.qxf)):(li.a.instance.Aa(ug.a.vh,J,this.l9a),hj.a.instance.Aa(ug.a.Bg,J,this.l9a));this.Oza=!1}this.bY=!1;nf.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.vOf():(this.USf(),this.hId());mj.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")};
xb.prototype.USf=function(){this.grid.Db.Oh([this.isRow?13:14]);this.grid.Db.XRa()};xb.prototype.pxf=function(J,ea){if(!this.bY)return!1;this.grid.om||nf.EwaSettings.isChangeGateEnabled("OfficeVSO:6195348_StopBubblingOnDocumentMouseMoveInnerEvent")||pk.g(ea);ea=this.isRow;if(!this.grid.om&&!this.S0){this.S0=document.createElement("div");this.S0.style.cssText="position: relative; width: inherit; height: inherit;"+(ea?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var Wa=this.wk.UJ();Wa.nextSibling;)this.S0.appendChild(Wa.nextSibling);
Wa.parentNode.appendChild(this.S0)}Wa=ea?J.y-this.v7a.y:(this.rtl?-1:1)*(J.x-this.v7a.x);var Pb=ea?J.y-this.wSa.y:(this.rtl?-1:1)*(J.x-this.wSa.x),Cc=this.grid.om?this.d$a:this.wk.v4();if(Cc===eg.a.zLa)return!1;Wa&&(0<this.fl||0<Cc+Pb)&&Cc+Pb<=this.tof&&(this.fl=this.Kxc(Pb),this.Wbd(J,this.fl,!1),this.grid.om?this.fl>=xb.H6e?(this.gKd=!0,this.wk.setCellExtent(this.fl)):this.gKd&&(this.gKd=!1,this.wk.setCellExtent(xb.H6e)):(xg.DOMElementExtensions.Koa(this.wk.UJ(),!ea,Math.max(this.jJb+Pb,0)),this.S0.style[ea?
"top":this.rtl?"right":"left"]=Math.max(Pb,-this.jJb)+"px"),xg.DOMElementExtensions.Koa(this.wk.sf.domElement,!ea,(ea?this.wk.sf.rJ:this.wk.sf.tJ)+Math.max(Pb,this.grid.om?-this.d$a+xb.Dcc:-this.jJb)),this.v7a=new Sys.UI.Point(J.x,J.y),xg.DOMElementExtensions.setVisible(this.iG,!1));return!0};xb.prototype.v4=function(){return this.wk?this.Ffa?xb.I4h:this.wk.v4():eg.a.zLa};xb.prototype.Wbd=function(J,ea,Wa){this.NM&&Wa&&(vd.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),
this.hId());this.NM||Wa||vd.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.Ptd&&this.Ptd(function(){var Pb={};return Pb.Location="canvas",Pb});this.NM?this.tVe(ea):(this.NM=document.createElement("div"),this.NM.id=this.w4h,this.tVe(ea),this.NM.className=hk.a.Moh,ea=document.getElementById(this.grid.$.Mb+ca.a.fqf),ea.insertBefore(this.NM,ea.firstChild),J=fk.a(this.grid.$).Aja(J),this.NM.style.left=
(this.rtl?Math.max(J.x-this.NM.offsetWidth,0):J.x-Math.max(J.x+this.NM.offsetWidth-ea.offsetWidth,0)).toString()+"px",ea=document.getElementById(ca.a.cGa),this.NM.style.top=(J.y-(Ud.AFrameworkApplication.sa&&Ud.AFrameworkApplication.sa.Qa.Vg?0:ea.offsetHeight)-this.NM.offsetHeight).toString()+"px")};xb.prototype.hId=function(){xg.DOMElementExtensions.zf(this.NM);this.NM=null};xb.prototype.tVe=function(J){var ea=new bd(this.grid.$.workbookContext.DxDigitNormal);ea=this.isRow?ea.wBe(J).toFixed(2):ea.nBe(J).toFixed(2);
this.NM.innerText=String.format("{0} {1} ({2} {3})",this.isRow?this.s4h:this.B4h,ea,J.toString(),this.v4h)};xb.prototype.aHf=function(J,ea){var Wa;if(-1!==this.grid.ha.selectionType||2===J.zb&&J.Ca.button!==Sys.UI.MouseButton.leftButton||!this.crd(Wa=this.hed(J))||!this.wff)return!1;pk.g(J.Ca);this.wSa=this.v7a=new Sys.UI.Point(J.clientPoint.x,J.clientPoint.y);this.tSg(Wa,ea);if(!this.wk)return!1;this.bY=!0;this.mki(this.wk,Wa)&&this.z8h();this.jJb=this.tdd();return this.bHf(ea)};xb.prototype.$Gf=
function(J,ea,Wa,Pb,Cc){this.bY=!0;this.Ffa=Cc;this.wk=J;this.Chc=!1;this.wSa=this.v7a=new Sys.UI.Point(ea,Wa);!this.dS&&this.wk&&(J=this.wk.getRange(),this.dS=Cc?this.loe(J):J);this.d$a=this.v4();this.bHf(Pb)};xb.prototype.bHf=function(J){var ea={};qi.b(this.grid.$).Rd($c.a.Uej,(ea.IsResizingHiddenHeader=this.Ffa,ea.IsAutoFitting=J,ea.NumberOfSelectedRanges=this.grid.ha.ta.xK,ea.Location="canvas",ea));this.offset=this.wk.Vaa();this.fl=this.grid.om?this.d$a:this.wk.v4();if(this.fl===eg.a.zLa)return!1;
mj.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0};xb.prototype.mki=function(J,ea){var Wa=this.wk.UJ();if(!Wa)return vd.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;Wa=Wa.nextSibling;if(!Wa)return!1;J=J.getRange();Wa=this.sf.cva(Wa).getRange();if(!J||!Wa)return vd.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;var Pb=nf.EwaSettings.isChangeGateEnabled("OfficeVSO:6101474_EnableUnhideRowByMouseDrag");J=Pb&&
this.isRow?J.bottom:J.right;Wa=Pb&&this.isRow?Wa.bottom:Wa.right;return J+1!==Wa&&J!==Wa&&this.crd(ea,!0)};xb.prototype.z8h=function(){var J=this.wk.UJ(),ea=this.sf.cva(J.nextSibling);xb.nki(ea,this.isRow)?(this.wk=ea,this.dS=this.wk.getRange()):(this.HAg(J),this.wk=ea,J=this.wk.getRange(),this.dS=this.loe(J),this.Ffa=!0)};xb.prototype.loe=function(J){return this.isRow?new Kj.Range(J.top-1,J.left,J.top-1,J.right,!1,!0):new Kj.Range(J.top,J.left-1,J.bottom,J.left-1,!1,!0)};xb.prototype.HAg=function(J){var ea=
this.sf.cva(J.nextSibling),Wa=xb.j6g(ea,this.isRow,this.rtl);Wa&&J.parentNode.insertBefore(Wa,ea.UJ())};xb.prototype.Hfd=function(J){var ea=this.dS,Wa=J.ha.ta.selectedRanges;if(J.ha.ta.nsb(ea))if(this.isRow){if(d.a.all(Wa,function(Pb){return Pb.isRow}))return Wa}else if(d.a.all(Wa,function(Pb){return Pb.hf}))return Wa;return[ea]};xb.prototype.getCellExtent=function(){return this.wk.getCellExtent()};xb.prototype.tdd=function(){var J=this.wk.UJ().style;return Math.max(0,Math.min(this.tof,0|parseInt(this.isRow?
J.height:J.width,10)))};xb.prototype.Kxc=function(J){J=void 0===J?0:J;var ea=this.grid,Wa=this.sf.yj.paneType;Wa=this.isRow?3===Wa?[3,2]:[1,4]:4===Wa?[2,4]:[1,3];var Pb=ea.view.visibleArea.bottomRight,Cc=Math.max(this.grid.om?this.d$a:this.wk.v4(),0);J=this.Ffa&&!this.grid.om?Math.max(this.tdd(),0):Math.max(Cc+J,0);Pb=this.isRow?new sj.a(0,this.offset,Pb.x,J):new sj.a(this.offset,0,J,Pb.y);Cc=[this.isRow?13:14];ea.Db.vj(Kj.Range.hd(1,1),Cc,!1);ea.Db.Cn(Cc,Pb,Wa);return J};xb.prototype.i0c=function(){this.dS=
this.wSa=this.v7a=null;if(this.S0){var J=this.S0.parentNode;if(J)for(J.removeChild(this.S0);this.S0.firstChild;)J.appendChild(this.S0.firstChild);this.S0=null}this.wk=null;this.bY=!1;nf.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||this.vOf()};xb.prototype.vOf=function(){this.Chc=!1;this.hId();xg.DOMElementExtensions.setVisible(xb.Dbb,!1);xg.DOMElementExtensions.setVisible(this.iG,!1);nf.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&this.USf()};
xb.prototype.hed=function(J){if(xg.DOMElementExtensions.xz(J.Lb,"a"))return null;var ea=this.Vgf(J.Ca);if(ea&&this.grid.ha.ta.Hg){var Wa=this.grid.ha.ta.qd;Wa=this.sf.ds(Kj.Range.hd(Wa.bottom,Wa.right))}else Wa=this.sf.cva(J.Lb);if(!Wa)return null;var Pb=Wa.UJ(),Cc=new Sys.UI.Bounds(Pb.offsetLeft,Pb.offsetTop,Pb.offsetWidth,Pb.offsetHeight),pd=xg.DOMElementExtensions.getBoundingClientRect(J.Lb);pd=new Sys.UI.Point(J.clientPoint.x-pd.x,J.clientPoint.y-pd.y);this.isRow&&!ea&&(pd.y+=Zh.HelperMethods.KC(J.Lb,
Pb,this.rtl).y);return new Qd(Pb,pd,Cc,Wa.getRange(),Math.max(xb.$yi,Math.min(xb.Wxi,(this.isRow?Cc.height:Cc.width)*xb.dfj)),ea,!this.isRow&&0<Pb.getElementsByTagName("input").length)};xb.prototype.crd=function(J,ea){ea=void 0===ea?!1:ea;if(!J||this.grid.isEditing)return!1;if(J.Ugf)return!0;var Wa=J.mOa,Pb=J.Cbb,Cc=this.sf.yj.paneType,pd=this.grid.Uf(Cc).Gh,wd=!!pd&&pd.top===J.Xid.top,ue=!!pd&&pd.left===J.Xid.left;Cc=!!pd&&pd.bottom===J.Xid.bottom&&(3===Cc||2===Cc);this.isRow?(ue=J.KCb.y,J=ue<=Pb&&
!wd,Wa=ue>=Wa.height-Pb-(Cc?xb.lDh:0),ea=ea?J:Wa||J):(Cc=J.y3h,wd=this.rtl,pd=J.KCb.x,J=pd<=Pb&&(!ue||wd)&&(!Cc||!wd),Wa=pd>=Wa.width-Pb&&(!wd||!ue)&&(!Cc||wd),ea=ea?wd?Wa:J:J||Wa);return ea};xb.prototype.tSg=function(J,ea){var Wa=this.isRow;if(J.Ugf)this.wk=this.sf.cva(J.Qva);else if(Wa&&J.KCb.y<=J.Cbb&&J.mOa.height>J.Cbb||!Wa&&J.mOa.width>J.Cbb&&(!this.rtl&&J.KCb.x<=J.Cbb||this.rtl&&J.KCb.x>=J.mOa.width-J.Cbb)){if(this.wk=J.Qva.previousSibling?this.sf.cva(J.Qva.previousSibling):this.UPh(),ea&&J.Qva.classList.contains(Wa?
hk.a.lQe:hk.a.kQe)&&(J=this.sf.cva(J.Qva)))J=J.getRange(),this.dS=Wa?new Kj.Range(J.top-1,J.left,J.top-1,J.right,!1,!0):new Kj.Range(J.top,J.left-1,J.bottom,J.left-1,!1,!0)}else this.wk=this.sf.cva(J.Qva);!this.dS&&this.wk&&(this.dS=this.wk.getRange())};xb.prototype.UPh=function(){var J=this.isRow?1:0;return(J=this.sf.yj.lG(this.sf.yj.Ea.Tg(this.grid.$.qa,yk.a.nM(this.sf.position.X+J-1,this.sf.position.Y-J,this.sf.position.PaneType))))?J.TPh():null};xb.prototype.V9e=function(){this.Chc=!0;var J=this.efj;
xg.DOMElementExtensions.setVisible(J,!0);J.style.cursor=this.isRow?hk.a.uNe:hk.a.gMe;this.Kxc()};xb.prototype.bkh=function(J){var ea={};this.grid.$.Ud(this.isRow?745189930:-445963340,pb.a.Sb,30,(ea.resizeRowColumnParameters=J,ea))};xb.prototype.f$g=function(){var J=document.createElement("div");J.className=hk.a.trh;var ea=document.createElement("div");ea.className=Zc.a.YA;J.appendChild(ea);var Wa=document.createElement("img");Wa.src=Ok.a.gf(0);Wa.className=this.isRow?Zc.a.sqh:Zc.a.nqh;ea.appendChild(Wa);
this.sf.OA.domElement.parentNode.insertBefore(J,this.sf.OA.domElement);this.grid.om?J.addEventListener(ug.a.sha,this.fLi):(li.a.instance.pa(ug.a.pointerDown,J,this.AN),Bh.a.instance.pa(ug.a.lk,J,this.rca));xg.DOMElementExtensions.setVisible(J,!1);this.iG=J};xb.prototype.CHb=function(){this.i0c();this.iG&&(this.sf.OA.domElement.parentNode.removeChild(this.iG),this.iG=null)};xb.prototype.Vgf=function(J){return xg.DOMElementExtensions.Ff(this.iG,J.target)};xb.prototype.xpb=function(){this.bY&&(this.IKe(),
xg.DOMElementExtensions.Koa(this.wk.UJ(),!this.isRow,this.jJb),this.CHb(),this.Ffa=!1)};xb.prototype.Tcf=function(){return nf.EwaSettings.ma(680)};xb.prototype.D8e=function(J){(J=J.Ca.rawEvent)&&J.detail===xb.Hjj&&(J.type===ug.a.hq?(this.bY=!1,this.uXc=!0):J.type===ug.a.YH&&(this.bY=!0,this.uXc=!1))};xb.f6g=function(J,ea){return new xb(J,ea)};xb.COd=function(J,ea,Wa){if(ea)for(J.ColumnWidth=-1,J.RowHeight=Wa,J=Gl(J.SheetMultiRange.Ranges),ea=J.next();!ea.done;ea=J.next())ea=ea.value,ea.FirstColumn=
0,ea.LastColumn=0;else for(J.RowHeight=-1,J.ColumnWidth=Wa,J=Gl(J.SheetMultiRange.Ranges),ea=J.next();!ea.done;ea=J.next())ea=ea.value,ea.FirstRow=0,ea.LastRow=0};xb.nki=function(J,ea){if(!J||!J.UJ())return vd.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;var Wa=J.getRange();J=J.UJ().style;if(!Wa||!J)return vd.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;J=ea?J.height:J.width;return(ea?Wa.top:Wa.left)===(ea?eg.a.Hh:eg.a.Rh)&&J===xb.Wfg};xb.j6g=
function(J,ea,Wa){if(!J)return vd.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var Pb=J.UJ();if(!Pb||!Pb.style)return vd.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;J=document.createElement("div");var Cc=Pb.style;J.style.top=ea?Cc.top:xb.Wfg;ea||(Wa?J.style.right=Cc.right:J.style.left=Cc.left);J.classList.add(ea?zd.uqh:zd.tqh);J.classList.add(ea?hk.a.otb:hk.a.ntb);Wa=document.createElement("div");Wa.classList.add(ea?hk.a.YPe:hk.a.x9c);
Pb=ea?Number.parseInvariant(Pb.innerText):Kj.Range.S_a(Pb.innerText);Wa.innerText=ea?(Pb-1).toString():Kj.Range.YP(Pb-1);J.appendChild(Wa);return J};Ck.Object.defineProperties(xb.prototype,{E6a:{configurable:!0,enumerable:!0,get:function(){return this.bY}},wff:{configurable:!0,enumerable:!0,get:function(){var J=(new Gh.a(this.grid.$.xa)).me(this.isRow?16:8),ea=this.grid.$.Ab.Cz,Wa=this.grid.Li,Pb=gj.a(this.grid.$).Mq();return J&&!ea&&!Wa&&!Pb}},efj:{configurable:!0,enumerable:!0,get:function(){this.Kkh();
return xb.Dbb}}});xb.$yi=0;xb.Wxi=5;xb.Dcc=1;xb.H6e=1;xb.I4h=0;xb.lDh=3;xb.dfj=.1;xb.qSf="ewa-rszrbg";xb.Wfg="0px";xb.Hjj=2;xb.Dbb=null;Object(ee.a)(xb,"HeaderResizeBehavior",vj.a,[724]);var bl=vh.a;Wl(kd,bl);kd.prototype.create=function(){this.Eb(xb.f6g)};kd.ka=function(J){J.da.Ga(136,new kd)};Object(ee.a)(kd,"HeaderResizeBehaviorFactory",vh.a,[]);var pl=b(443),Xj=b(560),Ek=b(71);Object(ee.a)(Qc,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[450]);Object(ee.a)(Ub,"MacroRecorderSheetRowsColumnsResizedPayload",
null,[450]);var qk=hi.a;Wl(Zb,qk);Zb.prototype.FM=function(J,ea){var Wa={};return Wa[Zb.X4]=this.Cc,Wa[Zb.Aki]=this.isRow,Wa[Zb.X8h]=J,Wa[Zb.W8h]=ea,Wa[Zb.Bhi]=this.bAb,Wa[Zb.ved]=this.pvb,Wa};Zb.prototype.USg=function(){var J=this.tGh();try{return this.UKh(J)}finally{J&&J.dispose()}};Zb.prototype.M3g=function(J){var ea={};ea.SheetMultiRange=ze.r(this.gridView.ha.ta.selectedRanges,this.$);Zb.COd(ea,this.isRow,J);J={};this.$.Ud(this.isRow?745189930:-445963340,pb.a.Sb,8,(J.resizeRowColumnParameters=
ea,J))};Zb.prototype.R2e=function(J,ea){return zh.a.q5(J)?ea?this.y2g(J):this.A2g(J):Zb.qba};Zb.prototype.A2g=function(J){return Math.floor(parseFloat(J))};Zb.prototype.y2g=function(J){J=parseFloat(J);return 0>J?Zb.qba:J?this.isRow?Zh.HelperMethods.bXi(J):this.Etc.sZg(J):0};Zb.prototype.B2g=function(J){return J===Zb.qba?"":this.isRow?this.Etc.wBe(J).toString():this.Etc.nBe(J).toFixed(2)};Zb.prototype.z2g=function(J){return J===Zb.qba?"":J.toString()};Zb.prototype.UKh=function(J){if(!J||!J.$$mn()||
!J.Mn)return Zb.qba;var ea=Object(Db.a)(572,J.Mn);if(!ea)return Zb.qba;for(ea=this.isRow?ea.Pxb:ea.ald;J.$$mn();){var Wa=Object(Db.a)(572,J.Mn);if(Wa&&(this.isRow?Wa.Pxb:Wa.ald)!==ea)return Zb.qba}return ea};Zb.prototype.tGh=function(){for(var J=[],ea=Gl(this.gridView.ha.ta.selectedRanges),Wa=ea.next();!Wa.done;Wa=ea.next()){Wa=Wa.value.clone();var Pb=this.gridView.Uf(this.gridView.rb.qj(Wa));Pb=Wa.Se(Pb.Gh);if(!Pb)return null;this.isRow?Wa.right=Wa.left=Pb.left:Wa.top=Wa.bottom=Pb.top;J.push(Wa)}return J.length?
this.gridView.N$("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",J):null};Zb.prototype.wed=function(J){if(!zh.a.q5(J))return 1;J=this.R2e(J,this.bAb);return!J&&this.lki()?3:this.dni(J)?0:2};Zb.prototype.lki=function(){var J=this.gridView.ha.ta.selectedRanges;return this.isRow&&ze.P(J)||!this.isRow&&ze.O(J)};Zb.prototype.Obd=function(J){var ea="";switch(J){case 0:ea="";break;case 1:ea=Ne.a.instance.ga(769);break;case 2:J=this.bAb;ea=String.format(Ne.a.instance.Bb(99),0,this.obc(J));break;
case 3:ea=Ne.a.instance.ga(770)}return ea};Zb.prototype.dni=function(J){return 0<=J&&J<=this.obc(!1)};Zb.prototype.obc=function(J){return this.Etc.obc(J,this.isRow)};Zb.COd=function(J,ea,Wa){if(ea)for(J.ColumnWidth=Zb.qba,J.RowHeight=Wa,J=Gl(J.SheetMultiRange.Ranges),ea=J.next();!ea.done;ea=J.next())ea=ea.value,ea.FirstColumn=0,ea.LastColumn=0;else for(J.RowHeight=Zb.qba,J.ColumnWidth=Wa,J=Gl(J.SheetMultiRange.Ranges),ea=J.next();!ea.done;ea=J.next())ea=ea.value,ea.FirstRow=0,ea.LastRow=0};Ck.Object.defineProperties(Zb.prototype,
{Cc:{configurable:!0,enumerable:!0,get:function(){return"ResizeHeadersDialog"}},bAb:{configurable:!0,enumerable:!0,get:function(){return Zb.t9d},set:function(J){Zb.t9d=J}}});Zb.X4="id";Zb.Aki="isRow";Zb.X8h="initialSizeInPx";Zb.W8h="initialSizeInDefaultUnits";Zb.Bhi="isInitialUnitsDefaultUnits";Zb.ved="getInputErrorIfInvalid";Zb.hAj="size";Zb.qfi="isDefaultUnits";Zb.qba=-1;Zb.t9d=!0;Object(ee.a)(Zb,"ResizeHeadersDialog",hi.a,[]);var rk=b(354),Dj=b(564),Jk=b(63);jb.prototype.$c=function(J,ea){J=!0;
switch(ea){case -445963340:case 1391094586:J=this.me(8);break;case 745189930:case 146338636:J=this.me(16)}return!J};jb.prototype.executeCommand=function(J,ea,Wa){var Pb=wh.TaskExtensions.sk();var Cc=wg.g(this.$);J=gk.a.create().toString();var pd=ea.command;switch(pd){case 1391094586:case 146338636:var wd=1391094586===pd;(J=Wa.autoFitRanges)&&J.Ranges&&J.Ranges.length||(J=ze.r(Cc.ha.ta.selectedRanges,this.$));Pb=this.agh(wd?1:0,J,ea);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:wd=
-445963340===pd||-706918724===pd||369708605===pd;if(-445963340===pd||745189930===pd)wd=pl.a(ea.command),Cc.Ii.I7(16,J,wd),Wa=Wa.resizeRowColumnParameters;else{var ue=Cc.ha.ta.selectedRanges;if(-706918724===pd&&6===ea.Ze&&ze.O(ue)){vd.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===pd&&6===ea.Ze&&ze.P(ue)){vd.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");
break}Cc=369708605===pd||1542466017===pd?-2:0;Wa={};Wa.SheetMultiRange=ze.r(ue,this.$);if(wd)for(Pb=Gl(Wa.SheetMultiRange.Ranges),pd=Pb.next();!pd.done;pd=Pb.next())pd=pd.value,pd.FirstRow=0,pd.LastRow=0;else for(Pb=Gl(Wa.SheetMultiRange.Ranges),pd=Pb.next();!pd.done;pd=Pb.next())pd=pd.value,pd.FirstColumn=0,pd.LastColumn=0;Wa.RowHeight=wd?-1:Cc;Wa.ColumnWidth=wd?Cc:-1}Pb=this.ugh(Wa,ea,J);break;case 957527587:case 2040891415:new Zb(this.$,ea)}return Pb};jb.prototype.rZg=function(J){nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",
!1)&&wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.Xa(this.$.da,426,427,1),function(ea){ea.result.kWd(J,"ColumnAutoFit")},this.$.la,3)};jb.prototype.Mc=function(J,ea,Wa,Pb){if(J=!!Wa&&!!Pb&&1===Pb.Ex)switch(ea.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:J=!1}return J};jb.prototype.jd=function(){return!1};jb.prototype.zti=function(J){vd.ULS.sendTraceTag(537154004,0,
50,"ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: {0}. Reason: {1}.",J.success,Object(Dj.c)(J)?void 0:J.reason)};jb.prototype.me=function(J){return(new Gh.a(this.$.xa)).me(J)};jb.prototype.agh=function(J,ea,Wa){function Pb(){return new Qc(wd,ea)}var Cc=this,pd=this.$.na.va.hc(),wd=0===J;return Ba.a(this.$.userOperationManager,function(ue,Je,tg){var oh=Cc.$.na.va;ue=fi.b(ue,Cc.uGi);var Qh={Fei:!wd,k0b:ea},ni=oh.Na(41,pd);ni.isRow=wd;ni.autoFitRanges=ea;return Pc.i(oh,"AutoFit",
ni,ue,Je,tg,Qh,0)},function(ue){return new Fb.a(135,0,ue,void 0,Pb)},Wa)};jb.prototype.ugh=function(J,ea,Wa){function Pb(){return new Ub(J)}function Cc(oh,Qh,ni){pd.$.By();ze.i(wd,",",pd.$,!1);var Jj=pd.$.na.va;oh=fi.b(oh,pd.$Oi);var Mj=Jj.Na(41,void 0===tg?null:tg);Mj.resizeRowColumnParameters=J;return Pc.i(Jj,"ResizeRowsColumns",Mj,oh,Qh,ni,Wa,0)}var pd=this,wd=ze.g(J.SheetMultiRange.Ranges),ue=ea.command;if(745189930===ue||-445963340===ue){vd.ULS.shipAssertTag(537154002,0,this.$.activeItemName===
J.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!");var Je=wg.g(this.$);ue=745189930===ue;Je=this.Sg.wyj(Je,wd,ue?J.RowHeight:J.ColumnWidth,ue);this.zti(Je);Object(Dj.c)(Je)&&wg.g(this.$).Ii.N0(Wa,Ek.BasicTelemetryCalculator.aR)}var tg=this.$.na.va.hc({ola:!0,kka:3});return Je&&Object(Dj.c)(Je)?nf.EwaSettings.qc()?Ba.a(this.$.userOperationManager,Cc,function(oh){return new Fb.a(136,0,oh,64,Pb)},ea):Ba.a(this.$.userOperationManager,Cc,function(oh){return new Xj.a(136,
0,oh,void 0,Pb)},ea):Ba.a(this.$.userOperationManager,Cc,function(oh){return new Fb.a(136,0,oh,void 0,Pb)},ea)};Object(ee.a)(jb,"ResizeCommandHandler",null,[428]);var zk=bh.a;Wl(ma,zk);ma.prototype.Od=function(){var J=this,ea=ah.GetServiceTaskFactory.create(this.$.da,18,this.la,this.vb);wh.TaskExtensions.Ba(ea,function(){J.Cd([new jb(J.$,ea.result)])},this.la,3)};ma.ka=function(J){bh.a.ee(113,new ma(J))};Object(ee.a)(ma,"ResizeCommandHandlerFactory",bh.a,[]);hd.prototype.$c=function(){return!1};hd.prototype.executeCommand=
function(J,ea,Wa){J=2;switch(ea.command){case -309686558:J=this.Ci.se(Xf.a.saveACopy,2,Wa);break;case 617689800:J=this.Ci.se(Xf.a.saveToCloudStorage,2,Wa);break;case -1244760097:J=this.Ci.se(Xf.a.saveToSharePoint,2,Wa)}return 2===J&&ea?xi.a(ea.command):Wc.Task.Sa(!0)};hd.prototype.Mc=function(J,ea){J=!1;switch(ea.command){case -1244760097:case -309686558:case 617689800:J=!0,vd.ULS.shipAssertTag(537153984,0,this.$.uka,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return J};
hd.prototype.jd=function(){return!1};Object(ee.a)(hd,"SaveToHostCommandHandler",null,[428]);var Pk=bh.a;Wl(uc,Pk);uc.prototype.Od=function(){var J=this;wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.create(this.$.da,155,this.la,this.vb),function(){J.Cd([new hd(J.$,Ud.AFrameworkApplication.Ib)])},this.la,3);Ud.AFrameworkApplication.Ib.fc(Xf.a.LQa,Eh.a.frame,this.dCh)};uc.ka=function(J){bh.a.ee(267,new uc(J))};Object(ee.a)(uc,"SaveToHostCommandHandlerFactory",bh.a,[]);kc.prototype.$c=function(J){switch(J){case -309686558:return 8===
this.Ci.processAction(Xf.a.saveACopy,1,null);case 617689800:return 8===this.Ci.se(Xf.a.saveToCloudStorage,1,null);case -1244760097:return 8===this.Ci.se(Xf.a.saveToSharePoint,1,null)}return!1};kc.prototype.dispose=function(){this.$=null};Object(ee.a)(kc,"SaveToHostManager",null,[650,3]);var cl=vh.a;Wl(Jb,cl);Jb.prototype.create=function(){this.Eb(this.$.da.za(393)||new kc(this.$,Ud.AFrameworkApplication.Ib))};Jb.ka=function(J){J.da.Ga(394,new Jb(J))};Object(ee.a)(Jb,"SaveToHostManagerFactory",vh.a,
[]);var Wk=$h.a;Wl($b,Wk);$b.prototype.execute=function(J){var ea=Object(Db.a)(6,J.Ke);vd.ULS.shipAssertTag(537153921,0,uh.a.Rnb(J.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");ea.fI(!0,!0);J.activityState[L.a.pYb]=ea.ea.sessionId;J.activityState[L.a.Fmb]=!0;J.activityState[L.a.vYb]=!0;vd.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3};Object(ee.a)($b,"SessionReloadActivity",$h.a,
[]);var Ug=vh.a;Wl(Ha,Ug);Ha.prototype.create=function(){this.Eb(new $b(Xg.a.icb,Xg.a.Kk))};Ha.ka=function(J){J.da.Ga(142,new Ha)};Object(ee.a)(Ha,"SessionReloadActivityFactory",vh.a,[]);var nj=b(55),tl=b(279),Ti=b(110),Qk=b(46),ik=b(255),hl=b(116),il=$h.a;Wl(lb,il);lb.prototype.execute=function(J){var ea=Object(Db.a)(6,J.Ke);J.activityState[L.a.Ora]=!0;var Wa=lb.xWh(J);if(lb.juj(J,Wa))return lb.ixi(J),Wa=50,0<J.errors.length&&(Wa=15),vd.ULS.sendTraceTag(537153891,0,Wa,"SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : {0}",
uh.a.Tc(J.errors)),J.activityState[L.a.Ora]=!1,this.zh(Xg.a.idle),3;switch(Wa){case 1:case 3:this.lai(J,Wa);break;case 2:this.kai(J);break;case 0:J.activityState[L.a.gYa]=null}vd.ULS.sendTraceTag(21837003,0,50,"SessionReloadSilentActivity.Execute: silentReloadType:{0}. activityName:{1}. NextActivityName:{2}. TimeFromLastStatefulResponse:{3}.",Wa,this.activityName,this.L_,ea.ea.T7);var Pb=Nh.a.Kg(J.activityState,hl.a.reb);vd.ULS.shipAssertTag(40502925,0,!Pb||Pb&&(1===Wa||3===Wa),"triggerSilentReloadAfterTokenRefresh: {0}, silentReloadType: {1}",
Pb,Wa);ea=ea.Vk.reloadCount;return 0!==Wa&&0<ea?(Pb=tl.a.xva(ea,200),vd.ULS.sendTraceTag(537153890,0,50,"SessionReloadSilentActivity.Execute: schedule Silent-Type [{0}] retryNum [{1}] delayInMs [{2}] activityName [{3}]",Wa,ea,Pb,this.activityName),mk.a.instance.create(function(){lb.yJ(J)},Pb,dk.a.umj),1):3};lb.prototype.lai=function(J,ea){vd.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");var Wa=Object(Db.a)(6,J.Ke);J.activityState[L.a.Fmb]=
!0;Wa.hfc||Qk.PageLoadTrackingInfo.instance.Kj("ReopenOnLoad");!lb.isEditMode(J)&&uh.a.Rnb(J.errors)&&(vd.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),J.activityState[L.a.pYb]=Wa.ea.sessionId,J.activityState[L.a.vYb]=!0);J.hvd();3===ea?(Wa.ea.xg()||Wa.ea.MCi(),Wa.fI(!0,!0),this.zh(this.hJj),J.activityState[L.a.bke]=Wa.workbookContext.CalcMode):(nf.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&
1===ea&&Wa.fI(!0,!0),J.activityState[L.a.ITc]=!1,this.zh(this.Sxc))};lb.prototype.kai=function(J){vd.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");J.activityState[L.a.gYa]=null;J.hvd();this.zh(this.aAj);J=Object(Db.a)(6,J.Ke);J.hfc||(Qk.PageLoadTrackingInfo.instance.Kj("RefreshOnLoad"),J.nIb())};lb.yJ=function(J){J.yJ()};lb.xWh=function(J){var ea=Object(Db.a)(6,J.Ke),Wa=ea.ea,Pb=lb.isEditMode(J),Cc=uh.a.nh(J.errors,Pb?lb.Sud:lb.Tud),
pd=uh.a.nh(J.errors,Pb?lb.Lnf:lb.Mnf),wd=ea.cR,ue=ea.Vk.reloadCount,Je=ea.ya.MaxConsecutiveSilentReloadAllowed,tg=ea.Vk.i6e(),oh=uh.a.Tc(J.errors),Qh=uh.a.Tc(J.hza),ni=0<uh.a.vM(function(uk){return!uk.triggerSilentReopenOnly},J.errors).length,Jj=Cc,Mj=Nh.a.Kg(J.activityState,hl.a.reb);Mj&&(Jj=!0);Cc={name:"SessionReloadSilentActivity.GetSilentReloadType",editMode:Pb,isSilentReopenError:Cc,isSilentRefreshError:pd};Cc.reloadSequenceCount=ea.Vk.XPa;Cc.reloadCount=ue;Cc.maxReloads=Je;Cc.stopSilentReloads=
tg;Cc.errorNames=oh;Cc.processedErrorNames=Qh;Cc.isClientDirty=wd;Cc.errorsForSilentReopenOnly=ni;Cc.triggerSilentReloadAfterTokenRefresh=Mj;Cc.IsReopenDisabled=ea.zMa;wd=nj.a.Jc(Cc);vd.ULS.sendTraceTag(21837004,0,50,wd);if(!tg){if(Jj&&(Pb?lb.auj(J):lb.cuj(J)))return ik.a.L0f(J,ea)?3:ea.zMa?2:1;if(pd&&(Pb||!Wa.wab))return 2}return 0};lb.juj=function(J,ea){for(var Wa=Gl(J.errors),Pb=Wa.next();!Pb.done;Pb=Wa.next())if(Pb=Pb.value,-1337545025===Pb.MessageId||-238814601===Pb.MessageId)return!1;return uh.a.vM(function(Cc){return!Cc.triggerSilentReopenOnly},
J.errors).length?3!==ea:!1};lb.ixi=function(J){var ea=uh.a.vM(function(Pb){return!Pb.triggerSilentReopenOnly},J.errors);ea=Gl(ea);for(var Wa=ea.next();!Wa.done;Wa=ea.next())J.pla(Wa.value)};lb.isEditMode=function(J){var ea=Object(Db.a)(6,J.Ke);return ea.ea.rc?ea.jv&&!!(ea.Qd&64):Nh.a.Kg(J.activityState,L.a.Ns)};lb.cuj=function(J){var ea=Object(Db.a)(6,J.Ke),Wa=uh.a.oaa(J.errors,lb.Tud);if(Ti.b(Wa,function(Pb){return Pb.ForceVersionUpgrade}))return!1;J=uh.a.Rnb(J.errors);return!ea.ea.wab||J?!0:!1};
lb.auj=function(J){J=uh.a.oaa(J.errors,lb.Sud);return!Ti.b(J,function(ea){return ea.ForceVersionUpgrade})};lb.Tud=null;lb.Sud=null;lb.Mnf=null;lb.Lnf=null;Object(ee.a)(lb,"SessionReloadSilentActivity",$h.a,[]);var jl=vh.a;Wl(cb,jl);cb.prototype.create=function(){this.Eb(new lb(this.activityName,this.pM,Xg.a.Kk,Xg.a.uj,Xg.a.pNb))};cb.ka=function(J){J.da.Ga(143,new cb(Xg.a.xna,Xg.a.o0b));J.da.Ga(144,new cb(Xg.a.yvc,Xg.a.QOa));J.da.Ga(145,new cb(Xg.a.zvc,Xg.a.HBd));J.da.Ga(154,new cb(Xg.a.jcb,Xg.a.VO))};
Object(ee.a)(cb,"SessionReloadSilentActivityFactory",vh.a,[]);Qa.prototype.getSheetName=function(){return this.sheetName};Qa.prototype.getValue=function(){return this.value};Object(ee.a)(Qa,"MacroRecorderSheetOptionToggledPayload",null,[450]);bb.prototype.$c=function(){return!1};bb.prototype.executeCommand=function(J,ea){function Wa(){return new Qa(Pb.SheetName,tg)}var Pb={};this.$.Pj(Pb);J=ea.command;var Cc=Object(Db.a)(Zg.a,this.$.xa.getItemByName(Pb.SheetName));if(!Cc)return xi.a(J);switch(J){case 705559150:case -1411193626:var pd=
16;var wd=!Cc.hideGridLines;var ue=Ib;var Je=183;var tg=Cc.hideGridLines;break;case -2052321504:case 515737500:pd=4;wd=!Cc.headersVisible;ue=yb;Je=184;tg=!Cc.headersVisible;break;case -1478455630:pd=2;wd=!Cc.displayRtl;ue=Xa;Je=185;tg=!Cc.displayRtl;wg.g(this.$).Ea.vOj(wd);break;default:return xi.a(J)}Cc.Hpb(pd,wd);var oh=this.$.na.va;return Ba.a(this.$.userOperationManager,function(Qh,ni,Jj){return ue(oh,Pb.SheetName,tg,fi.b(Qh,function(Mj){bb.TEb(Mj,Cc,pd,wd)}),fi.a(ni,function(){bb.cEb(Cc,pd,wd)}),
Jj,null)},function(Qh){return new Fb.a(Je,0,Qh,void 0,Wa)},ea)};bb.prototype.Mc=function(J,ea){J=!1;switch(ea.command){case -1411193626:case 515737500:case -1478455630:J=!0;break;case 705559150:case -2052321504:J=mj.a(this.$)}return J};bb.prototype.jd=function(){return!1};bb.TEb=function(J,ea,Wa,Pb){uh.a.mr(J.Errors)&&ea.Hpb(Wa,!Pb)};bb.cEb=function(J,ea,Wa){J.Hpb(ea,!Wa)};Object(ee.a)(bb,"SheetOptionsToggleCommandHandler",null,[428]);var oj=bh.a;Wl(Ua,oj);Ua.prototype.Od=function(){this.Cd([new bb(this.$)])};
Ua.ka=function(J){bh.a.ee(100,new Ua(J))};Object(ee.a)(Ua,"SheetOptionsToggleCommandHandlerFactory",bh.a,[]);var Fk=b(215),Kk=Fk.a;Wl(ja,Kk);ja.prototype.initialize=function(){var J=this.$.Mb+"iframeDialog_frame",ea=this.$.Mb+"iframeDialog";var Wa=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',J,this.NYe(ea));this.Qb.style.margin=Zh.HelperMethods.uc(0);this.Qb.style.marginBottom=Zh.HelperMethods.uc(-2);this.Qb.innerHTML=Wa;this.MJc=document.getElementById(J);
this.domElement.id=ea;this.onResize(null,Sys.EventArgs.Empty);sg.a.ygc&&mk.a.instance.create(this.nkh,50,dk.a.g6h,!0,!0);Kk.prototype.initialize.call(this)};ja.prototype.dispose=function(){this.$&&this.$.rD(this.onResize);Kk.prototype.dispose.call(this)};ja.prototype.setFocus=function(){xg.DOMElementExtensions.setFocus(this.iLa)};ja.prototype.onHide=function(){this.iLa.contentWindow.close();xg.DOMElementExtensions.zf(this.iLa);this.MJc=null;Kk.prototype.onHide.call(this)};ja.prototype.hPj=function(J){var ea=
this.domElement.style;ea.width=Zh.HelperMethods.uc(J.x);ea.marginLeft=Zh.HelperMethods.uc(-J.x/2)};ja.prototype.aPh=function(){var J=xg.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*J.width),this.hGe.x),Math.min(Math.floor(.9*J.height),this.hGe.y))};Ck.Object.defineProperties(ja.prototype,{iLa:{configurable:!0,enumerable:!0,get:function(){return this.MJc}}});Object(ee.a)(ja,"IFrameDialog",Fk.a,[]);Wl(wa,ja);wa.prototype.NYe=function(J){var ea=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);
Xh.a.eh(ea,ca.a.vmh,J);Z.a(this.$.ya,34)&&Xh.a.eh(ea,ca.a.hMe,"1");Z.a(this.$.ya,35)&&Xh.a.eh(ea,ca.a.iMe,"1");return ea.toString()};wa.prototype.onShow=function(){vd.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");ja.prototype.onShow.call(this)};Ck.Object.defineProperties(wa.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"EmbeddingDialog"}}});Object(ee.a)(wa,"EmbeddingDialog",ja,[]);Za.b0f="FrameDialog_ShareFromEdit";Za.view="FrameDialog_View";
Za.Hye="FrameDialog_CloseAndRefresh";Za.gtj="FrameDialog_ShareFromView";Za.edit="FrameDialog_Edit";Za.H5i="FrameDialog_RefreshGrid";Za.MYg="FrameDialog_CloseMe";Za.Rye="FrameDialog_CloseMeError";Za.ready="FrameDialog_Ready";Za.aXi="FrameDialog_PleaseClose";Za.tH="GotoRange";Object(ee.a)(Za,"PostMessageConstants",null,[]);var Rk=b(105);Object(ee.a)(ub,"SessionUpdateContext",null,[]);Wl(ad,ja);ad.prototype.WEg=function(J){this.addHandler(ad.Csd,J)};ad.prototype.caj=function(J){this.removeHandler(ad.Csd,
J)};ad.prototype.dispose=function(){hb.a.Ha(this.C0a);this.C0a=null;ja.prototype.dispose.call(this)};ad.prototype.initialize=function(){ja.prototype.initialize.call(this);var J=zg.a.Saa(this.$.ya.FormLightBoxUrl),ea=this.C0a=new fa.a(this.iLa.contentWindow,J);ea.isEnabled()&&ea.tFa(J)&&(this.Qma(Za.b0f,this.Eoc),this.Qma(Za.view,this.Eoc),this.Qma(Za.Hye,this.Eoc),this.Qma(Za.gtj,this.oQi),this.Qma(Za.edit,this.bIi),this.Qma(Za.H5i,this.Eoc),this.Qma(Za.ready,this.IOi),this.Qma(Za.MYg,this.Kmc),this.Qma(Za.Rye,
this.Kmc))};ad.prototype.close=function(J){J===this.closeAction&&this.Edf&&this.C0a.send(new zj.a(Za.aXi))||ja.prototype.close.call(this,J)};ad.prototype.NYe=function(){return this.$Ce(this.nhc)};ad.prototype.$Ce=function(J){var ea=this.$.ya,Wa=new Sys.StringBuilder(ea.FormLightBoxUrl);Xh.a.eh(Wa,ca.a.ACh,this.$.ea.sessionId);Xh.a.eh(Wa,ca.a.yCh,J?ca.a.zCh:ca.a.xCh);rj.a.YYa(Wa,ea);return Wa.toString()};ad.prototype.Tcg=function(J){this.aLc=!1;this.iLa.src=this.$Ce(J);this.g9d=J};ad.prototype.Qma=
function(J,ea){this.C0a.jo(J);this.C0a.Tl(J,ea)};ad.prototype.snc=function(J){var ea=this.$.ea.xa.getItemByName(J.tH.SheetName);ea&&0===ea.Gy&&wg.g(this.$).Gg(J.tH,null,null,null,20,Rk.a.iCh)};Ck.Object.defineProperties(ad.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"FormDialog"}},Edf:{configurable:!0,enumerable:!0,get:function(){return this.aLc}},nhc:{configurable:!0,enumerable:!0,get:function(){return this.g9d}}});ad.ech=900;ad.Hbh=1200;ad.Csd="lightBoxReady";Object(ee.a)(ad,
"FormDialog",ja,[463]);var kj;(function(J){J[J.comment=10]="comment";J[J.range=12]="range";J[J.table=13]="table";J[J.chart=14]="chart"})(kj||(kj={}));Object(ee.b)("NavigationType",kj);var sk=b(1080),tk=b(118),Lk=b(619),Sk=b(1148),Xk=b(294),kl=b(936),Gk=kl.a;Wl(vc,Gk);vc.prototype.initialize=function(){var J="<div class='"+tk.a.Qn+"'>\r\n\t<div class='"+tk.a.xMe+"'>\r\n\t\t<div class='"+Zc.a.yye+"'>\r\n\t\t\t<img src='{0}' class='"+Zc.a.qPe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+
tk.a.BMe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";J=String.format(J,Ok.a.gf(13),Ne.a.instance.ga(25),Ne.a.instance.ga(this.message));this.Qb.innerHTML=J;this.addButton(0,this.cEi);this.addButton(1);Gk.prototype.initialize.call(this)};vc.prototype.Zy=function(){return this.MZd};Ck.Object.defineProperties(vc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"WebMethodConfirmationDialog"}},Mv:{configurable:!0,enumerable:!0,get:function(){return 1005}},$sa:{configurable:!0,enumerable:!0,
get:function(){return this.operationFlags}}});Object(ee.a)(vc,"WebMethodConfirmationDialog",kl.a,[]);var jk=sk.a;Wl(zb,jk);zb.prototype.dispose=function(){this.qTa&&this.qTa.lda(this.cDf);hb.a.Dc([this.textBox,this.SQa,this.qTa]);this.qTa=this.SQa=this.textBox=null;jk.prototype.dispose.call(this)};zb.prototype.initialize=function(){var J="<div class='"+tk.a.Qn+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+tk.a.c2a+"'>\r\n\t<input type='text' id='{1}' class='"+tk.a.GC+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";
J=String.format(J,Ne.a.instance.ga(1251),"sfd_input","sfd_unshare",Zc.a.$p,Ne.a.instance.ga(1252));this.Qb.innerHTML=J;this.textBox=new Xk.a(this.getElementById("sfd_input"));this.SQa=new Sk.a(this.textBox.domElement);this.qTa=Lk.a.create(this.getElementById("sfd_unshare"));this.qTa.G2(this.cDf);this.textBox.text=Ne.a.instance.ga(738);this.textBox.enabled=!1;this.textBox.readOnly=!sg.a.Eh;this.addButton(1,10);jk.prototype.initialize.call(this)};zb.prototype.uha=function(){var J=this;return function(ea,
Wa,Pb){var Cc=J.$.na.va.hc(),pd=J.$.na.va;ea=J.kja(ea);Wa=J.Gaa(Wa);Cc=pd.Na(1,Cc);return Pc.i(pd,"ShareForm",Cc,ea,Wa,Pb,null,0)}};zb.prototype.ry=function(J,ea,Wa){this.textBox.text=J.Result;this.textBox.enabled=!0;xg.DOMElementExtensions.setVisible(this.qTa.domElement,!0);jk.prototype.ry.call(this,J,ea,Wa)};zb.prototype.setFocus=function(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(J){}jk.prototype.setFocus.call(this)};Ck.Object.defineProperties(zb.prototype,{Cc:{configurable:!0,
enumerable:!0,get:function(){return"ShareFormDialog"}}});Object(ee.a)(zb,"ShareFormDialog",sk.a,[]);var Yk=b(717),dl=b(145),Tk=b(266),ll=b(16),el=r.a;Wl(sc,el);sc.prototype.$c=function(J,ea){J=this.$.workbookContext.FullDocumentInfo;switch(ea){case 353606613:case -1099009678:case 192430811:return!nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode;case 869186573:return ea=Tk.a()&&this.$.ea.Yg.get(5),!J.FileSharingUrl&&
!ea;case -1570751769:case 1986648902:return 131072!==(this.$.FQ&131072);case 330035228:return!(this.N2a(!0)&&this.eDc);case -509039657:return!(this.N2a()&&this.eDc);case 1334518759:return!(this.N2a()&&this.eDc&&this.Cve())}return!1};sc.prototype.executeCommand=function(J,ea,Wa){J=this.$.workbookContext.FullDocumentInfo;var Pb=Xf.a.workflow,Cc=wh.TaskExtensions.sk(),pd=ea.command;if(pd===Pb||-266099===pd)return this.k3h(ea,Pb,J);switch(pd){case 1986648902:this.p_f();break;case -1570751769:this.V0h(ea);
break;case 869186573:ea=Xf.a.ftj;Cc=Ud.AFrameworkApplication.fa.ra("ShareMenuIsEnabled");Pb=null;(nf.EwaSettings.ma(559)||Cc)&&Wa&&"CopyLink"===Wa.SourceControlId?(Pb={},Pb[Rg.a.LKb]="copy",ea=Xf.a.a0f):Cc&&Wa&&"ManageAccess"===Wa.SourceControlId?(Pb={},Pb[Rg.a.LKb]="manageAccess",ea=Xf.a.htj):Wa&&"LinkToComment"===Wa.SourceControlId&&(Pb={},Pb[Rg.a.LKb]="copy",Pb[Rg.a.c0f]=Wa.navId,ea=Xf.a.a0f);Cc=this.o3f(J,Pb);xj.c(ea);break;case -1099009678:Cc=this.mPd(12,J);break;case 192430811:Cc=this.mPd(13,
J);break;case 353606613:Cc=this.mPd(14,J);break;case -59906385:case 1197060601:this.z2h(ea,J);break;case 1305810481:this.K4e(!1,ea);break;case 330035228:this.K4e(!0,ea);break;case -509039657:this.deleteForm();break;case 1334518759:ea.Iyb=!0;this.shareForm();break;case 710925581:xc.a.Fg.Mwc("710925581")&&(Cc=wh.TaskExtensions.Ba(this.VJ.value,function(wd){wd.result.Gj(hh.a.conversation,{})},this.la,3));break;case 327119921:this.J0h();break;default:Cc=xi.a(pd)}return Cc};sc.prototype.Mc=function(J,
ea){J=!1;ea=ea.command;if(ea===Xf.a.workflow)return!0;switch(ea){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:J=!0;break;case 353606613:case -1099009678:case 192430811:J=nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode}return J};sc.prototype.jd=function(J,ea,Wa){if("PopulateFormMenu"===ea){ea=
this.eDc?this.Cve()?sc.Awh:sc.Bwh:sc.ABi;J=this.Ta.Pc();for(var Pb=0;Pb<ea.length;Pb++)J.buttons.push(this.Ta.Cb(ea[Pb]));ea=this.Ta.Cq("Forms.Flyout");ea.Ec.push(J);Wa.MenuItems=ea.jE();return!0}return!1};sc.prototype.k3h=function(J,ea,Wa){return this.OLd&&J.command===ea?(this.MLd(J,-266099),wh.TaskExtensions.G4()):wh.TaskExtensions.Ba(this.VJ.value,function(Pb){oe.a(Pb.result,hh.a.workflow,null,Wa.WorkflowPostMessage)||Zh.HelperMethods.mf(Wa.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},
this.la,3)};sc.prototype.Cve=function(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Yg.get(26)};sc.prototype.J0h=function(){var J=gk.a.create().toString();vd.ULS.sendTraceTag(528581128,306,50,"Calling share to teams deeplink with ID: "+J);var ea=this.$.frame,Wa=ea.I8a,Pb=this.$,Cc=new ri.QueryStringBuilder(Ud.AFrameworkApplication.fa.Va("TeamsMeetingShareEndpoint"));Cc.Wi("deeplinkId",J);Cc.Wi("lm","deeplink");J=Cc.Wi;var pd={};var wd=new ri.QueryStringBuilder(Ud.AFrameworkApplication.fa.Va("TeamsAppSharingUrl"));
wd.Wi("auth","2");wd.Wi("flight","officeunihost");wd.Wi("source","TEAMS-ELECTRON.meetingStage.deeplink");var ue={};ue.fileType=cg.a.u4(Pb.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);ue.objectUrl=Pb.workbookContext.FullDocumentInfo.WorkbookPath;ue.baseUrl=Pb.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;Pb=Pb.workbookContext.WorkbookFileVersionId;for(var Je=decodeURIComponent(Pb);Pb!=Je;)Pb=Je,Je=decodeURIComponent(Pb);0>Pb.indexOf("{")||0>Pb.indexOf("}")?(vd.ULS.sendTraceTag(528250338,
306,15,"Decoded fileId does not match expected format. Decoded id: "+Pb),Pb=""):Pb=Pb.substring(Pb.indexOf("{")+1,Pb.indexOf("}")).toLowerCase();ue.fileId=Pb;ue=ii.c(ii.c(ue));wd.Wi("subEntityId",ue.substring(1,ue.length-1));pd.appSharingUrl=wd.toString();pd.appId=Ud.AFrameworkApplication.fa.Va("TeamsAppId");pd=JSON.stringify(pd);J.call(Cc,"appContext",pd);Wa.call(ea,Cc.toString(),!0)};sc.prototype.V0h=function(J){this.OLd?this.MLd(J,1986648902):this.p_f()};sc.prototype.K4e=function(J,ea){!J&&this.$.ya.SurveyRedirectUrl?
this.p0i():(J=new ad(this.$,J,ea),J.initialize(),J.Af())};sc.prototype.z2h=function(J,ea){var Wa=this;this.OLd&&1197060601===J.command?this.MLd(J,-59906385):wh.TaskExtensions.Ba(this.VJ.value,function(Pb){Pb=Pb.result;Pb&&oe.a(Pb,hh.a.replyWithChanges,null,Wa.$.ea.Yg.get(8))||(Pb=new Sys.StringBuilder(ea.ReplyWithChangesUrl),Xh.a.eh(Pb,Fg.e,Fg.d),Ka.a.ntw(Pb.toString(),Wa.$))},this.la,3)};sc.prototype.MLd=function(J,ea){var Wa=this,Pb=yd.a(this.$).ud.activityState,Cc=new Gi.a(ea,J.method,J.mode,J.Ze,
J.tabName);gj.a(this.$).tt(new Ei.a(Xg.a.oz,5,function(){Pb[rb.a.hr]=Xg.a.nUf;Pb[Yk.a.ETc]=Cc;Wa.$.Vk.Ty("SocialSharingSaveBeforeCommand");Wa.$.Vk.vle(Cc.command)}))};sc.prototype.p_f=function(){var J=this,ea=this.$.ya.DocumentHostInfo;ea.HostEmbeddedViewUrl||this.sve?this.h2f():this.$.Yf.get(53)&&wh.TaskExtensions.Ba(this.VJ.value,function(Wa){J.ZLj(Wa.result)||Ka.a.ntw(ea.FileEmbedCommandUrl,J.$)},this.la,3)};sc.prototype.ZLj=function(J){return J.isEnabled()&&(this.rve||(this.rve=J.Tl(hh.a.qve,
this.tFi)))?J.Gj(hh.a.jyh,null):!1};sc.prototype.h2f=function(){if(sg.a.pp)Ka.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{var J=new wa(this.$);J.initialize();J.Af()}};sc.prototype.deleteForm=function(){var J=this.$,ea=new vc(J,1256,1257,1249,function(Wa,Pb,Cc){var pd=J.na.va.hc(),wd=J.na.va;pd=wd.Na(9,pd);pd.surveyId=null;return Pc.i(wd,"DeleteSurvey",pd,Wa,Pb,Cc,null,0)});ea.initialize();ea.Af()};sc.prototype.shareForm=function(){var J=this,ea=this.$.workbookContext.FullDocumentInfo;if(this.$.ea.Yg.get(26)){var Wa=
new zb(this.$);Wa.initialize();Wa.Af()}else wh.TaskExtensions.Ba(this.VJ.value,function(Pb){var Cc={};oe.a(Pb.result,hh.a.shareForm,(Cc[Rg.a.aFj]=J.$.workbookContext.SurveyTitle,Cc),J.$.ea.Yg.get(10))||Ka.a.ntw(ea.ShareFormCommandUrl,J.$)},this.la,3)};sc.prototype.p0i=function(){var J=this.$;J.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");var ea=new Sys.StringBuilder(J.ya.SurveyRedirectUrl);Xh.a.eh(ea,"startupDialog","FormEdit");var Wa=yd.a(this.$),Pb=Wa.ud.activityState;
Pb[Pj.a.t2]=ea.toString();Pb[Pj.a.UL]=Pj.a.Lwd;this.$.Vk.Ty("SocialSharingEnvironmentChange");gj.a(J).tt(new Ei.a(Xg.a.oz,5,function(){var Cc=uh.a.gd(3,2,1301,1302,1303,554412057,"FossEnvironmentUnsupported");Wa.ud.Jt([Cc]);Pb[rb.a.hr]=Xg.a.Wag}))};sc.prototype.N2a=function(J){return(this.$.ea.isEditMode||(void 0===J?!1:J))&&this.$.ea.Yg.get(25)&&Tk.a()};sc.prototype.gWh=function(J){var ea=void 0===ea?null:ea;var Wa=wg.g(this.$).ha;var Pb=this.$.xa.qa?Jk.d(this.$.xa.qa):null;if(!Pb)return vd.ULS.sendTraceTag(537151649,
0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: {0}.",kj[J]),null;14===J?ea=this.FVh(Wa):12===J?(ea=Wa.jia,ea=zh.a.contains(ea,"!",!0)?ea.split("!")[1]:ea):13===J&&(Wa=Wa.ta.selectedRanges,Wa[0]&&(Wa=wg.g(this.$).Nb.rj(Wa[0])))&&(ea=Wa.ij);if(!ea)return vd.ULS.sendTraceTag(537151648,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: {0}",kj[J]),null;Wa={};Wa[Rg.a.LKb]="copy";Wa[Rg.a.c0f]=
this.BMh(J,ea,Pb);vd.ULS.sendTraceTag(537151647,0,50,"SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: {0} and sectionNameOrId: {1} and SheetId: {2}",kj[J],ea,Pb);return Wa};sc.prototype.FVh=function(J){if(J.Oa.i5&&(J=J.Oa.nc.floatingObject)&&0===J.type){var ea=J.id.split(".");if(1<ea.length)return ea[1];vd.ULS.sendTraceTag(537151646,0,10,"SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  {0}",J.id)}return null};
sc.prototype.BMh=function(J,ea,Wa){J=btoa(J+"_"+ea+"_"+Wa);J=J.replace(RegExp("\\+","g"),"-");J=J.replace(RegExp("\\/","g"),"_");return J=J.replace(RegExp("\\=+$","g"),"")};sc.prototype.o3f=function(J,ea){var Wa=this;return wh.TaskExtensions.Ba(this.VJ.value,function(Pb){oe.a(Pb.result,hh.a.sharing,ea,Wa.$.ea.Yg.get(5))?vd.ULS.sendTraceTag(537151644,0,50,"SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: {0}",ea?ea[Rg.a.LKb]:""):Zh.HelperMethods.mf(J.FileSharingUrl,
"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.la,3)};sc.prototype.mPd=function(J,ea){if(!nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;var Wa=this.gWh(J);if(Wa)return this.o3f(ea,Wa);vd.ULS.sendTraceTag(537151643,0,10,"SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: {0}",kj[J]);return null};Ck.Object.defineProperties(sc.prototype,{eDc:{configurable:!0,enumerable:!0,
get:function(){return fc.b(this.$.mg)}},OLd:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&(this.$.ea.Vhh||this.$.cR)}}});sc.ABi=[103];sc.Awh=[107,104,105,106];sc.Bwh=[104,105];sc.qVg=[new ll.a(Xg.a.Pye,554412057,0,0,1304),new ll.a(Xg.a.idle,554412057,0,1)];Object(ee.a)(sc,"SocialSharingCommandHandler",r.a,[428]);var ql=bh.a;Wl(Hb,ql);Hb.prototype.Od=function(){var J=this,ea=new Sf.a(function(){return ah.GetServiceTaskFactory.create(J.$.da,137,J.la,J.vb)});wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.create(this.$.da,
102,this.la,this.vb),function(Wa){J.Cd([new sc(J.$,Wa.result,ea)])},this.la,3)};Hb.ka=function(J){bh.a.ee(114,new Hb(J))};Object(ee.a)(Hb,"SocialSharingCommandHandlerFactory",bh.a,[]);Object(ee.a)(Yb,"MacroRecorderRangeCustomSortedPayload",null,[450]);var Hk=b(1161),Ij=b(1162),Uk=b(1006),rl=b(958),ml=b(214);mc.prototype.show=function(){var J=new Dc.StandardDialog;J.ic=11;J.Ac(1,Ne.a.instance.ga(2091));J.Ac(2,Ne.a.instance.ga(2092));J.f3f(Ne.a.instance.ga(2090),Ne.a.instance.Wa(647),this.rw)};mc.prototype.FNa=
function(J){vd.ULS.sendTraceTag(594125219,0,50,"ExpandSortSelectionDialog: user operation: {0}",J)};Object(ee.a)(mc,"ExpandSortSelectionDialog",null,[]);qd.isValid=function(J){return Array.contains(qd.Lwh,J.Position)?!0:(vd.ULS.shipAssertTag(537159826,0,!1,"FillGradientStopExtension.IsValid: unexpected position value [{0}]",J.Position),!1)};qd.Lwh=[0,.5,1];Object(ee.a)(qd,"FillGradientStopExtension",null,[]);Object(ee.a)(yc,"GradientLine",null,[]);Rb.isValid=function(J){if(!(J.Degree.toString()in
Rb.Jwh))return vd.ULS.shipAssertTag(537159829,0,!1,"FillGradientExtension.IsValid: unexpected degree value [{0}]",J.Degree),!1;if(!J.GradientStops)return vd.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(J.GradientStops.length<Rb.Vyi||J.GradientStops.length>Rb.Dxi)return vd.ULS.shipAssertTag(537159827,0,!1,"FillGradientExtension.IsValid: unexpected number of gradient stops [{0}]",J.GradientStops.length),!1;J=Gl(J.GradientStops);for(var ea=J.next();!ea.done;ea=
J.next())if(!qd.isValid(ea.value))return!1;return!0};Rb.Vyi=2;Rb.Dxi=3;var W={};Rb.Jwh=(W["0"]=new yc(0,0,1,0),W["180"]=new yc(1,0,0,0),W["90"]=new yc(0,0,0,1),W["270"]=new yc(0,1,0,0),W["45"]=new yc(0,0,1,1),W["225"]=new yc(1,1,0,0),W["135"]=new yc(1,0,0,1),W["315"]=new yc(0,1,1,0),W);Object(ee.a)(Rb,"FillGradientExtension",null,[]);var ua=Ik.a;Wl(db,ua);db.prototype.yO=function(J,ea){if(1===J){var Wa=ze.v(this.BCb,this.$);wg.g(this.$).Gg(Wa,null,null,null,0,Rk.a.tBj)}Wa={};Wa=(Wa.DialogButton=J,
Wa.Location="dialog",Wa);qi.b(this.$).Rd($c.a.vBj,Wa,null,!0);ua.prototype.yO.call(this,J,ea)};db.prototype.Dr=function(){ua.prototype.Dr.call(this);var J=this.rBj();this.ic=1;this.Ac(1,Ne.a.instance.ga(2204));this.Ak(Ne.a.instance.ga(2205),Vh.a.gg(J),1,this.zO)};db.prototype.rBj=function(){return String.format(Ne.a.instance.Bb(166),this.BCb.toString())};db.prototype.Ubd=function(){var J=this.error.Description.split("_");return new Kj.Range(Number.parseInvariant(J[1])+1,Number.parseInvariant(J[2])+
1,Number.parseInvariant(J[3])+1,Number.parseInvariant(J[4])+1,!0,!1)};Ck.Object.defineProperties(db.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"SortMergedCellsErrorDialog"}}});Object(ee.a)(db,"SortMergedCellsErrorDialog",Ik.a,[]);var gb=b(636),ac=b(704),Jc=Uk.a;Wl(nb,Jc);nb.prototype.dispose=function(){this.Pfc||(this.Pfc=!0,this.A1b(),this.H6=null,nf.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(this.Rbb.dispose(),this.Rbb=null));Jc.prototype.dispose.call(this)};
nb.prototype.CEh=function(J){var ea=this;return function(Wa){if(Rj.b(Wa,-901005882))yd.a(ea.$).ud.bE(-901005882),ea.iFd();else if(Rj.b(Wa,-569193796))yd.a(ea.$).ud.bE(-569193796),ea.hide(),new db(ea.$,Wa.Errors[0]);else if(Rj.a(Wa))vd.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),ea.hide();else{Wa=Wa.Result;ea.$.Pj(Wa.SortRange);var Pb=nf.EwaSettings.isChangeGateEnabled("OfficeVSO:4545720_FixingSharedSortInfoResultExtension");
Wa&&Ja(Wa)&&Eb(Wa)&&zc(Wa,Pb)?J(Wa):ea.B6b(nb.Yqb())}}};nb.prototype.kFh=function(J,ea){var Wa=this;return function(Pb,Cc){if(Wa.Pfc)vd.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!Pb||Rj.a(Pb))vd.ULS.sendTraceTag(529105634,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: {0}",uh.a.Tc(Pb.Errors)),Wa.$.ea.Cp(Pb.Errors),Wa.hide();else{Pb=
Pb.Result;var pd=J.RangeType,wd=J.HeaderRowSize,ue=J.SortTopToBottom;Pb&&Vb(Pb,J.ConditionType)&&bc(Pb,pd,wd,ue)?(Pb.ColumnInfo.ColumnOffset=Cc,void 0!==Pb.HeaderColumnInfo&&null!==Pb.HeaderColumnInfo&&(Pb.HeaderColumnInfo.ColumnOffset=Cc),ea(Pb,J.ConditionType,J.SortTopToBottom)):(vd.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),Wa.B6b(nb.Yqb()))}}};nb.prototype.zvj=function(J){return!!this.namedSheetViewPublic&&
(0===J||3===J)};nb.prototype.a6g=function(J){var ea={};ea.SelectedRange=this.selectedRange;ea.ActiveCell=this.Toc;ea.SortInfoMode=J;ea.ExpandSortSelection=this.vTg;ea.ExpandSortSelectionSupported=!0;return ea};nb.prototype.qta=function(J){var ea={};ea[Ci.a.Px]=this.Cc;ea.fromAutoFilter=J.FromAutoFilter;ea.gridRTL=wg.g(this.$).rtl;ea.activeCell=J.ActiveCell;ea.selectedRange=J.SelectedRange;ea.invokeGetSortInfo=this.mci;ea.invokeGetSortConditionColorsOrIcons=this.lci;ea.highlightSortRange=this.A5h;
ea.getColorName=this.getColorName;return ea};nb.prototype.Moa=function(J,ea){J=ze.D(J);this.ha.ta.qd.equals(J)||this.ha.updateSelection(J,ze.C(ea),0,void 0,void 0,void 0,!0)};nb.prototype.iFd=function(){var J=this;(new mc(function(ea){var Wa={};Wa.ActiveCell=J.Toc;Wa.SelectedRange=J.selectedRange;Wa.ExpandSelection=ea;Wa.FromAutoFilter=!1;ea={};J.$.Ud(-207540907,pb.a.Sb,8,(ea.SortCommandData=Wa,ea))})).show()};nb.prototype.A1b=function(){if(void 0!==this.H6&&null!==this.H6)for(var J=Gl(this.H6),ea=
J.next();!ea.done;ea=J.next())this.$.na.va.xeb(ea.value.Pt)};nb.YJf=function(J,ea){var Wa={};J.Ud(1659552324,pb.a.Sb,8,(Wa.CustomSortCommandData=ea,Wa))};nb.Yqb=function(){return uh.a.gd(1,0,26,0,1,-1517197771,"CustomSortValidationError")};Ck.Object.defineProperties(nb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"CustomSortDialog"}},ha:{configurable:!0,enumerable:!0,get:function(){return wg.g(this.$).ha}}});Object(ee.a)(nb,"CustomSortDialog",Uk.a,[]);var gd=b(1251);Nb.prototype.getSelection=
function(){return this.selection};Object(ee.a)(Nb,"MacroRecorderRangeAutoFilterClearedPayload",null,[450]);Object(ee.a)(nc,"MacroRecorderRangeFilterReappliedPayload",null,[450]);var cd=b(979),Oc=b(980),Ic=b(112),Bd=b(1252),Ed=b(203),qe=b(36);Sa.prototype.$c=function(J,ea){return!this.Jpd(J,ea)};Sa.prototype.executeCommand=function(J,ea,Wa){var Pb=null;J=ea.command;switch(J){case -864298118:Pb=this.ggh(ea,Wa);break;case -1010737776:Pb=this.y6c(!0,ea,Wa);break;case 2123420468:Pb=this.y6c(!1,ea,Wa);
break;case -1089513346:Wa=this.GXe(Wa);if(!this.dAb([ze.D(Wa.SortOptions.SelectedRange)]))return wh.TaskExtensions.sk();Pb=this.lIe(ea,Wa);break;case -1032691499:case -764711886:case -2016161444:Pb=this.A0i(ea);break;case -207540907:case -1677817820:Pb=this.gridView.Nb.Ika(this.gridView.ha.ta.activeCell)?this.q0i():this.n0i(ea,Wa);break;case 1659552324:Pb=this.lIe(ea,this.GXe(Wa));break;case 368460465:Pb=this.wgh(ea,Wa);break;case 529856798:Pb=this.bgh(ea);break;case 644342024:Pb=this.rgh(ea)}return Pb||
xi.a(J)};Sa.prototype.Mc=function(J,ea){if(J=1===J)switch(ea.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:break;case -1032691499:case -764711886:case -2016161444:J=nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PutSelectedItemOnTop",!1);break;default:J=!1}return J};Sa.prototype.jd=function(){return!1};Sa.prototype.ha=function(){return this.$&&this.gridView?this.gridView.ha:
null};Sa.prototype.VMf=function(J){J?this.gridView.Mt(this.onContentReady):this.gridView.Ww(this.onContentReady);this.rbf=J};Sa.prototype.Ewj=function(J){return!!this.sortOptions&&zh.a.equals(this.Yif,J.jia,!0)};Sa.prototype.Jpd=function(J,ea){var Wa=wg.g(this.$).ha.ta.selectedRanges;return(new Gh.a(this.$.xa)).Nm(J,ea,Wa,this.gridView)};Sa.prototype.y6c=function(J,ea,Wa){var Pb={OperationType:0};Pb.IsAscending=J;Pb.HasHeader=!0;Pb.GuessHeader=!0;Pb.SortTopToBottom=!0;Pb.ExpandSortSelectionSupported=
!0;Wa&&void 0!==Wa[Sa.kSa]&&null!==Wa[Sa.kSa]?(Wa=Wa[Sa.kSa],Pb.ActiveCell=Wa.ActiveCell,Pb.SelectedRange=Wa.SelectedRange,Pb.ExpandSortSelection=Wa.ExpandSelection):(Pb.ActiveCell=ze.o(this.ha().ta.activeCell,this.$),Pb.SelectedRange=ze.v(this.ha().ta.qd,this.$),Pb.ExpandSortSelection=null);return this.dAb([ze.D(Pb.SelectedRange)])?this.gridView.Nb.Ika(ze.D(Pb.SelectedRange))?this.ogh(J):this.amd(Pb,ea):wh.TaskExtensions.sk()};Sa.prototype.ggh=function(J,ea){var Wa=null,Pb=this.ha();Pb&&(this.Ewj(Pb)?
this.dAb(Pb.ta.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,Wa=this.amd(this.sortOptions,J)):Wa=this.y6c(!0,J,ea));return Wa};Sa.prototype.dAb=function(J){return nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&(nf.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||this.$.isEditMode)?this.$.isEditMode?this.$.Aq(J,!0,1):this.$.DWc(J,!0,1):!0};Sa.prototype.ogh=function(J){this.PSh(J);return Wc.Task.Sa(!0)};
Sa.prototype.fQg=function(J){if(nf.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){var ea=this.gridView.Nb.rj(this.ha().ta.qd,!1);if(ea){var Wa=ea.name;ea=ea.usedRange;ea=this.ha().ta.activeCell.left-ea.left;return new Ij.a(Wa,ea,J.IsAscending)}}return new Hk.a(J)};Sa.prototype.amd=function(J,ea){function Wa(){return Pb.fQg(J)}var Pb=this;this.gridView.ug.SG(!1);return this.M7c(function(Cc,pd,wd){return cc(Pb.$.na.va,J,fi.b(Cc,Pb.OQi),pd,wd,J)},function(Cc){return new Fb.a(141,
0,Cc,void 0,Wa)},ea,this.yvj(J))};Sa.prototype.yvj=function(J){if(!this.namedSheetViewPublic)return!1;var ea=this.ha().ta.qd,Wa=ze.v(this.ha().ta.qd,this.$),Pb=this.gridView.Nb.Twa(ea,!0),Cc=this.ha().ta.Iba()&&this.gridView.Nb.cff(Wa),pd=this.gridView.Nb.Hji(Wa);J=(ea.y5||ea.l_)&&!ea.isSingle&&(null==J.ExpandSortSelection?!1:J.ExpandSortSelection)&&this.gridView.Nb.cff(Wa);return Pb||Cc||pd||J};Sa.prototype.q0i=function(){return this.$.Ud(-1556797033,pb.a.Sb,8,null)};Sa.prototype.n0i=function(J,
ea){J=8===J.Ze&&ea&&void 0!==ea[Sa.kSa]&&null!==ea[Sa.kSa]?ea[Sa.kSa]:19===J.Ze&&ea&&void 0!==ea[pb.a.pg]&&null!==ea[pb.a.pg]?nj.a.ni(ea[pb.a.pg]):this.d5g();if(!this.dAb([ze.D(J.SelectedRange)]))return wh.TaskExtensions.sk();wg.g(this.$).ug.SG(!1);var Wa=null;(ea=ea.TopCellAddress)&&(Wa=ze.o(ea,this.$));new nb(this.$,J,this.namedSheetViewPublic,Wa);return Wc.Task.Sa(!0)};Sa.prototype.GXe=function(J){return J[Sa.jah]};Sa.prototype.lIe=function(J,ea){function Wa(Je){return new Fb.a(187,0,Je,void 0,
Pb)}function Pb(){return new Yb(ea.SortOptions)}function Cc(Je,tg,oh){return cc(ue.$.na.va,ea.SortOptions,fi.b(Je,wd),fi.a(tg,pd),oh,ue.sortOptions)}function pd(){ea.ShouldRestoreSelection&&ue.Moa(ea.SelectedRange,ea.OriginalActiveCell);vd.ULS.sendTraceTag(537151575,0,10,"SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: {0}",J.Ze)}function wd(Je){nf.EwaSettings.isChangeGateEnabled("OfficeVSO:5899794_MergedCellsErrorFix")&&ue.j6e(Je)?ue.X4e(Je.Errors[0]):(ea.ShouldRestoreSelection&&
ue.Moa(ea.SelectedRange,ea.OriginalActiveCell),vd.ULS.sendTraceTag(537151576,0,50,"SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: {0}",J.Ze),ue.xKj(ea))}var ue=this;return nf.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?this.M7c(Cc,Wa,null,ea.ShouldPromptNamedSheetViewTeachingDialog):Ba.a(this.$.userOperationManager,Cc,Wa,null)};Sa.prototype.Moa=function(J,ea){J=ze.D(J);wg.g(this.$).ha.ta.qd.equals(J)||wg.g(this.$).ha.updateSelection(J,
ze.C(ea),0,void 0,void 0,void 0,!0)};Sa.prototype.d5g=function(){var J={};J.ActiveCell=ze.o(this.ha().ta.activeCell,this.$);J.SelectedRange=ze.v(this.ha().ta.qd,this.$);J.FromAutoFilter=!1;J.ExpandSelection=null;return J};Sa.prototype.wgh=function(J,ea){function Wa(){return new gd.a(Cc)}var Pb=this,Cc=this.Kaa();if(!Cc)return Wc.Task.Sa(!1);var pd=this.$.na.va.hc();return nf.EwaSettings.qc()?Ba.a(this.$.userOperationManager,function(wd,ue,Je){return sb(Pb.$.na.va,Cc,fi.b(cd.a.Ava(Ic.a.wZa,Oc.a.toggleAutoFilter,
wd),Pb.ORi),ue,Je,{selection:Cc,zIj:ea.On},pd)},function(wd){return new Fb.a(516,0,wd,64,Wa)},J):Ba.a(this.$.userOperationManager,function(wd,ue,Je){return sb(Pb.$.na.va,Cc,cd.a.Ava(Ic.a.wZa,Oc.a.toggleAutoFilter,wd),ue,Je,null,pd)},function(wd){return new Xj.a(516,0,wd,void 0,Wa)},J)};Sa.prototype.bgh=function(J){function ea(){return new Nb(Pb)}var Wa=this,Pb=this.Kaa();if(!Pb)return Wc.Task.Sa(!1);var Cc=this.gridView.Nb.rj(this.ha().ta.qd,!0);Cc&&vd.ULS.sendTraceTag(537151574,0,50,"DoClearAutoFilter for namedObject: Type : {0}",
Cc.type.toString());var pd=this.$.na.va.hc();Cc=nf.EwaSettings.qc()?function(wd){return new Fb.a(517,0,wd,64,ea)}:function(wd){return new Xj.a(517,0,wd,void 0,ea)};return this.M7c(function(wd,ue,Je){var tg=Wa.$.na.va;wd=cd.a.Ava(Ic.a.tsa,Oc.a.clearAutoFilter,wd);var oh=tg.Na(41,void 0===pd?null:pd);oh.selectedRange=Pb;return Pc.i(tg,"ClearAutoFilter",oh,wd,ue,Je,null,0)},Cc,J)};Sa.prototype.M7c=function(J,ea,Wa,Pb){var Cc=this;return this.namedSheetViewPublic&&(void 0===Pb||Pb)?this.namedSheetViewPublic.GAa().continueWith(function(pd){pd.result&&
Ba.a(Cc.$.userOperationManager,J,ea,Wa)}):Ba.a(this.$.userOperationManager,J,ea,Wa)};Sa.prototype.rgh=function(J){function ea(){return new nc(Pb)}var Wa=this,Pb=this.Kaa();if(!Pb)return Wc.Task.Sa(!1);var Cc=this.$.na.va.hc();return nf.EwaSettings.qc()?Ba.a(this.$.userOperationManager,function(pd,wd,ue){return Cb(Wa.$.na.va,Pb,cd.a.Ava(Ic.a.tsa,Oc.a.xKf,pd),wd,ue,null,Cc)},function(pd){return new Fb.a(518,0,pd,64,ea)},J):Ba.a(this.$.userOperationManager,function(pd,wd,ue){return Cb(Wa.$.na.va,Pb,
cd.a.Ava(Ic.a.tsa,Oc.a.xKf,pd),wd,ue,null,Cc)},function(pd){return new Xj.a(518,0,pd,void 0,ea)},J)};Sa.prototype.j6e=function(J){return Rj.b(J,-569193796)};Sa.prototype.X4e=function(J){yd.a(this.$).ud.bE(-569193796);new db(this.$,J)};Sa.prototype.iFd=function(J){var ea=this;(new mc(function(Wa){var Pb={};Pb.ActiveCell=J.ActiveCell;Pb.SelectedRange=J.SelectedRange;Pb.ExpandSelection=Wa;Wa={};ea.$.Ud(J.IsAscending?-1010737776:2123420468,pb.a.Sb,8,(Wa[Sa.kSa]=Pb,Wa))})).show()};Sa.prototype.Fzj=function(){var J=
this.ha();J.updateSelection(this.iyc,J.ta.activeCell,0,void 0,void 0,void 0,!0);this.VMf(!0)};Sa.prototype.Kaa=function(){var J=this.ha();if(!J)return vd.ULS.shipAssertTag(537151573,0,!!J,"SelectionManger is null"),null;this.gridView.ug.SG(!1);return ze.v(J.ta.qd,this.$)};Sa.prototype.dKb=function(){this.Fc&&this.Fc.To&&(this.$f=this.Fc.To,this.Fb=this.Fc.Aac())};Sa.prototype.PSh=function(J){var ea=this;if(this.$.isEditMode&&(this.Fc=this.gridView.Nb.gp(this.gridView.ha.ta.activeCell))){this.activeCell=
ze.o(this.gridView.ha.ta.activeCell,this.$);if(this.Fc&&this.Fc.To){var Wa=this.Fc.To.CurrentCol;if(this.Fc.To.CurrentRow===this.activeCell.FirstRow&&Wa===this.activeCell.FirstColumn){this.dKb();this.applyPivotSort(J);return}}this.$.na.va.hc();Wa=new Fb.a(228,0,function(Pb,Cc,pd){var wd=ea.$.na.va,ue=ea.activeCell;Pb=fi.b(Pb,ea.rKi);Cc=fi.a(Cc,ea.qKi);var Je=wd.Na(1);Je.activeCell=ue;return Pc.i(wd,"GetPivotTableCellInfo",Je,Pb,Cc,pd,J,0)},16);this.$.userOperationManager.jc(Wa,null)}};Sa.prototype.applyPivotSort=
function(J){var ea=this;if(this.Fc&&this.Fb&&this.activeCell&&this.$f){var Wa=8===this.$f.CellArea,Pb=1===this.$f.CellArea||2===this.$f.CellArea;(Wa||Pb)&&8!==this.$f.CellType&&4!==this.$f.CellType&&(Wa?Ba.a(this.$.userOperationManager,function(Cc,pd,wd){var ue=ea.$.na.va,Je=ea.activeCell,tg=J?1:2,oh=ea.Fb.Caption,Qh=ue.Na(41);Qh.activeCell=Je;Qh.sortInfo=tg;Qh.fieldCaption=oh;return Pc.i(ue,"ApplyPivotTableValueFieldSort",Qh,Cc,pd,wd,null,0)},function(Cc){return new Fb.a(1015,0,Cc,void 0,null)},
null):(Wa=1===this.$f.CellArea?1:2,this.$.ma(696)?Ka.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Fc.externalSourceIndex,this.Fb.Index.toString(),this.Fb.Caption,this.Fc.isOlap?"":this.Fb.Caption,Wa,J):Ka.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Fc.externalSourceIndex,this.Fb.Index.toString(),J)))}};Sa.prototype.xKj=function(J){J.SortOptions.SortConditions.some(function(ea){return 0===ea.SortConditionType})&&(J.TopCellAddress?
J=ze.C(J.TopCellAddress):(J=J.OriginalActiveCell,J=new Kj.Range(J.FirstRow+1,J.FirstColumn+1,J.FirstRow+1,J.FirstColumn+1,!0,!1)),this.mL(J))};Sa.prototype.mL=function(J){qe.a.Fba(this.$)&&wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.Xa(this.$.da,430,431,1),function(ea){ea.result.pea(J);vd.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)};Sa.prototype.nWd=function(J){nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",
!1)&&wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.Xa(this.$.da,476,475,0),function(ea){ea.result.nWd(J,0);vd.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},this.$.la,3)};Sa.prototype.A0i=function(J){var ea=this.gridView.ha.ta;if(!this.dAb(this.gridView.ha.ta.selectedRanges))return wh.TaskExtensions.sk();ea={OperationType:2,IsAscending:!0,HasHeader:!0,GuessHeader:!0,SortTopToBottom:!0,ExpandSortSelectionSupported:!0,ActiveCell:ze.o(ea.activeCell,
this.$),SelectedRange:ze.v(ea.qd,this.$),SortConditions:[this.q8g(J)],IsCaseSensitive:!1,SortInfoMode:0,ExpandSortSelection:null};return this.amd(ea,J)};Sa.prototype.q8g=function(J){var ea=this.gridView.lc(this.gridView.ha.ta.activeCell),Wa=new Bd.a;Wa.IsAscending=!0;switch(J.command){case -1032691499:J=Ed.a.cp(ea.backgroundColor);Wa.SortColor=J.BS();Wa.SortConditionType=1;break;case -764711886:Wa.SortColor=ea.uze;Wa.SortConditionType=2;break;case -2016161444:ea.Gwb?(Wa.SortIcon=ea.cell.Lic,Wa.SortIconSet=
ea.Mic):(Wa.SortIcon=Sa.l0d,Wa.SortIconSet=Sa.l0d);Wa.SortConditionType=3;break;default:vd.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return Wa};Sa.prototype.AIj=function(J){wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.Xa(this.$.da,426,427,1),function(ea){ea.result.kWd(J,"Filter")},this.$.la,3)};Sa.l0d=-1;Sa.jah="CustomSortCommandData";Sa.kSa="SortCommandData";Object(ee.a)(Sa,"SortCommandHandler",
null,[428]);var Qe=bh.a;Wl(Ta,Qe);Ta.prototype.Od=function(){var J=this;wh.TaskExtensions.Ba(ah.GetServiceTaskFactory.Xa(this.$.da,309,310,this.vb),function(ea){J.Cd([new Sa(J.$,ea.result)])},this.$.la,3)};Ta.ka=function(J){bh.a.ee(160,new Ta(J))};Object(ee.a)(Ta,"SortCommandHandlerFactory",bh.a,[]);Da.prototype.A9g=function(J,ea){new db(J,ea)};Object(ee.a)(Da,"SortUtil",null,[644]);var tf=vh.a;Wl(Pa,tf);Pa.prototype.create=function(){var J=this.$.da.za(446);J||(J=new Da(this.$),this.$.da.Ga(446,
J));this.Eb(J)};Pa.ka=function(J){J.da.Ga(447,new Pa(J))};Object(ee.a)(Pa,"SortUtilFactory",vh.a,[]);mb.prototype.executeCommand=function(J,ea,Wa){return 2!==this.Ci.se(Xf.a.tryOfficeThroughTellMe,2,Wa)?Wc.Task.Sa(!0):xi.a(ea.command)};mb.prototype.Mc=function(J,ea){return 215809929===ea.command};mb.prototype.jd=function(){return!1};mb.prototype.$c=function(){return!1};Object(ee.a)(mb,"TryOfficeThroughTellMeCommandHandler",null,[428]);var ig=bh.a;Wl(eb,ig);eb.prototype.Od=function(){this.Cd([new mb(Ud.AFrameworkApplication.Ib)])};
eb.ka=function(J){bh.a.ee(207,new eb(J))};Object(ee.a)(eb,"TryOfficeThroughTellMeCommandHandlerFactory",bh.a,[]);var yg=b(179);Ra.CM=function(){return Of.a.$o(Ra.zk,yg.a.Wa(434))};Ra.zk="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";
Object(ee.a)(Ra,"NamedSheetViewTeachingDialogHtml",null,[]);var Dh=Ci.a;Wl($a,Dh);$a.prototype.Ug=function(){this.ic=4;this.stopwatch=this.$.Pb.Gc("UserAction",this.Cc);var J=Ne.a.instance.ga(1883);this.hg=Ra.CM();this.Yo=new ye.a;this.initializeAndShow(J,this.JAi,{});return this.Yo.task};$a.prototype.zv=function(J){Dh.prototype.zv.call(this,J);this.Ac(1,Ne.a.instance.ga(1885));this.Ac(2,Ne.a.instance.Wa(447))};$a.prototype.KZi=function(){this.$.ea.Clc=!1};$a.prototype.Qti=function(J){var ea={};ea.a=
this.$.ya.UserSessionId;ea.b="NamedSheetViewTeachingDialogClose";ea.c=J;ea.e=!0;this.stopwatch&&(this.stopwatch.stop(),ea.d=this.stopwatch.Bc);Uh.b().Pe(53,ea,!0)};Ck.Object.defineProperties($a.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"ShowNamedSheetViewTeachingDialog"}}});Object(ee.a)($a,"NamedSheetViewTeachingDialog",Ci.a,[]);var Jh=b(163);la.prototype.GAa=function(){if(this.Zvj()){if(nf.EwaSettings.ma(583)){this.$.xa.qa.Yd.DQd=!0;var J=new ye.a;this.$.Ka.Wb(new Gi.a(-2050946363,
pb.a.Sb,2,0,null)).continueWith(function(ea){J.setResult(!xe.a(ea)&&ea.result)});return J.task}return(new $a(this.$)).Ug()}return Wc.Task.Sa(!0)};la.prototype.Zvj=function(){var J=this.$.xa.qa;return this.$.ea.U8a&&this.$.ea.Clc&&!J.Yd.jy&&this.$.ea.sM&&!Jh.e(this.$)};Object(ee.a)(la,"NamedSheetViewPublic",null,[706]);var Lh=vh.a;Wl(va,Lh);va.prototype.create=function(){this.Eb(this.$.da.za(309)||new la(this.$))};va.ka=function(J){J.da.Ga(310,new va(J))};Object(ee.a)(va,"NamedSheetViewPublicFactory",
vh.a,[]);var Yi=b(1380),Ji=b(1069),ej=b(626);Object(ee.a)(Tb,"NamedSheetViewTeachingCalloutContent",null,[]);Ck.Object.defineProperties(tb.prototype,{B7f:{configurable:!0,enumerable:!0,get:function(){return this.uhe}},y0i:{configurable:!0,enumerable:!0,get:function(){return this.B7f<this.D7f.count?this.D7f.oa(this.uhe++):null}}});Object(ee.a)(tb,"NamedSheetViewTeachingCalloutList",null,[]);var Wi=b(1253);Ya.prototype.L8h=function(J){var ea=this;this.C7f=J;var Wa=Object(Ch.a)(new Vd.a,{});Ya.sgi(J)?
(Wa.add(new Tb(Ne.a.instance.Wa(436),Ne.a.instance.Wa(437),Ne.a.instance.ga(1913),function(){ea.QH(2,"Continue");ea.HJ(!0)},Ne.a.instance.ga(1914),function(){ea.HJ();ea.QH(1,"ExitGuide")},Wi.a())),1===J&&Wa.add(new Tb(Ne.a.instance.ga(1915),Ne.a.instance.Wa(439),Ne.a.instance.ga(1913),function(){ea.QH(2,"FirstEnterTempViewContinueSecond");ea.HJ(!0)},Ne.a.instance.ga(1914),function(){ea.HJ();ea.QH(1,"FirstEnterTempViewExitGuideSecond")},Wi.a())),Wa.add(new Tb(Ne.a.instance.Wa(440),Ne.a.instance.Wa(441),
Ne.a.instance.ga(1913),function(){ea.QH(2,"FirstEnterExitCalloutContinue");ea.HJ(!0)},Ne.a.instance.ga(1914),function(){ea.HJ();ea.QH(1,"FirstEnterExitCalloutGuide")},Ya.s_e())),Wa.add(new Tb(Ne.a.instance.ga(1916),Ne.a.instance.Wa(438),Ne.a.instance.ga(1917),function(){ea.P2f();ea.HJ();ea.QH(1,"LearnMore")},Ne.a.instance.ga(1918),function(){ea.HJ();ea.QH(1,"Done")},Ya.r_e()))):2===J?Wa.add(new Tb(Ne.a.instance.ga(1915),Ne.a.instance.Wa(439),Ne.a.instance.ga(1912),function(){ea.HJ();ea.QH(1,"EnterTempViewAfterPersistedView")},
null,null,Wi.a())):3===J&&(Wa.add(new Tb(Ne.a.instance.Wa(436),Ne.a.instance.ga(1924),Ne.a.instance.ga(1913),function(){ea.QH(2,"AutoOptInExitCalloutContinue");ea.HJ(!0)},Ne.a.instance.ga(1914),function(){ea.HJ();ea.QH(1,"AutoOptInExitGuide")},Ya.s_e())),Wa.add(new Tb(Ne.a.instance.ga(1915),Ne.a.instance.Wa(439),Ne.a.instance.ga(1913),function(){ea.QH(2,"Continue");ea.HJ(!0)},Ne.a.instance.ga(1914),function(){ea.HJ();ea.QH(1,"ExitGuide")},Wi.a())),Wa.add(new Tb(Ne.a.instance.ga(1916),Ne.a.instance.Wa(438),
Ne.a.instance.ga(1917),function(){ea.P2f();ea.HJ();ea.QH(1,"LearnMore")},Ne.a.instance.ga(1918),function(){ea.HJ();ea.QH(1,"Done")},Ya.r_e())));this.BUd=new tb(Wa)};Ya.prototype.P2f=function(){var J=new Gi.a(-859308420,pb.a.Sb,this.$.Xc,9,null),ea={};ea=(ea[pb.a.pg]="HelpID=SheetViews",ea.InputMethod=pb.a.Sb,ea[pb.a.kd]=ca.a.XQ,ea.ShouldCanvasTakeFocus=!0,ea);this.$.Ka.Wb(J,ea)};Ya.prototype.show=function(J){this.L8h(J);this.hdb()};Ya.prototype.Hpj=function(J){this.l_b=J};Ya.prototype.hdb=function(){var J=
this,ea=this.BUd.y0i;if(ea){var Wa=Object(Ch.a)(new Yi.a,{label:ea.VZi,onExecute:ea.primaryButtonAction}),Pb=null;ea.RVf&&(Pb=Object(Ch.a)(new Yi.a,{label:ea.RVf,onExecute:ea.secondaryButtonAction}));ea=Object(Ch.a)(new Ji.a,{target:ea.targetObject,content:ea.body,title:ea.title,showCloseIcon:!0,primaryButtonProps:Wa,secondaryButtonProps:Pb,useTeachingStyles:!0});ea=this.l_b.callout(ea);Wa=Object(Ch.a)(new ej.a,{onShow:function(){J.QH(0)}});this.Azc=this.l_b.addNotification(ea,Wa);this.BWc||(this.$.gqd=
!0)}};Ya.prototype.dismiss=function(){this.HJ();this.QH(1,"DismissedByOthers")};Ya.prototype.HJ=function(J){J=void 0===J?!1:J;this.Azc&&(this.BWc||(this.$.gqd=!1),this.l_b.removeNotification(this.Azc),this.Azc=null);J&&this.hdb()};Ya.prototype.QH=function(J,ea){var Wa={};Wa.a=this.$.ya.UserSessionId;Wa.b=this.C7f;Wa.c=this.BUd.B7f;Wa.d=J;Wa.e=void 0===ea?null:ea;0===J?this.stopwatch=this.$.Pb.Gc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),Wa.f=this.stopwatch.Bc,
this.stopwatch=null),2===J&&(this.stopwatch=this.$.Pb.Gc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));Uh.b().Pe(52,Wa,!0)};Ya.r_e=function(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")};Ya.s_e=function(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")};Ya.sgi=function(J){return 0===J||1===J};Object(ee.a)(Ya,"NamedSheetViewTeachingCallout",null,[642]);var Ni=vh.a;Wl(Ia,Ni);Ia.prototype.create=function(){var J=this.$.da.za(322);
J||(J=new Ya(this.$),nf.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")&&this.$.da.Ga(322,J));this.Eb(J)};Ia.ka=function(J){J.da.Ga(323,new Ia(J))};Object(ee.a)(Ia,"NamedSheetViewTeachingCalloutFactory",vh.a,[]);var Ej=b(96),Zi=b(182),Ah=b(1254),mi=b(56),$i=b(1143),bj=Dc.StandardDialog;Wl(La,bj);La.prototype.oQ=function(){this.ic=5;this.width=40;var J=document.createElement("span");J.id=this.oi("DirectPrintHeaderContent");var ea=document.createElement("span");ea.innerText=CommonUIStrings.l_DirectPrintDialogHeader;
Sys.UI.DomElement.addCssClass(ea,"DirectPrintHeader");this.vP=document.createElement("iframe");this.vP.name="pdfObjectFrame";this.vP.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.vP.onload=Object(vf.a)(this,this.h_i,"printablePdfLoaded");if(this.dWb&&0<this.dWb.count){var Wa=zg.a.lfd(this.SUb,this.dWb),Pb=zg.a.dId(this.SUb,this.dWb);this.cm=document.createElement("form");this.cm.id="printPreviewPostForm";this.cm.method="POST";this.cm.target=this.vP.name;this.cm.action=Pb;Wa=Gl(Wa);for(Pb=Wa.next();!Pb.done;Pb=
Wa.next()){Pb=Pb.value;var Cc=document.createElement("input");Cc.type="hidden";Cc.name=Pb.key;Cc.value=Pb.value;this.cm.appendChild(Cc)}}else this.vP.setAttribute("src",this.SUb);Sys.UI.DomElement.addCssClass(this.vP,Zi.a.Jbe);this.apg?(Sys.UI.DomElement.addCssClass(this.vP,"DirectPrintPdfObjectHidden"),ea.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,Fa.a.yh(this.vP,Fa.a.eC,Fa.a.ik)):(Sys.UI.DomElement.addCssClass(this.vP,"DirectPrintPdfObject"),this.cn.push(this.vP));J.appendChild(ea);
J.appendChild(document.createElement("br"));J.appendChild(this.vP);this.cm&&J.appendChild(this.cm);J.appendChild(document.createElement("br"));J.appendChild(this.U0g(this.cm?"#":this.SUb));this.Flb.start();this.CCb(CommonUIStrings.l_AppTitle,null,null,null,null,J);this.jX(this.oi("DirectPrintHeaderContent"));this.cm&&this.cm.submit();this.Q5g();vd.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")};La.prototype.U0g=function(J){var ea=document.createElement("span"),Wa=document.createElement("span");
Wa.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;ea.appendChild(Wa);Ud.AFrameworkApplication.fa&&(2===Ud.AFrameworkApplication.sa.Qa.Sj&&Ud.AFrameworkApplication.fa.ra("PPTDisableDirectPrintDialogDownloadPDFLink")||1===Ud.AFrameworkApplication.sa.Qa.Sj&&Ud.AFrameworkApplication.fa.ra("XLODisableDirectPrintDialogOpenPDFLink"))?(J=document.createElement("span"),2===Ud.AFrameworkApplication.sa.Qa.Sj?J.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===Ud.AFrameworkApplication.sa.Qa.Sj&&
(J.innerText=CommonUIStrings.l_InternalError_Directive,vd.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.dqa=J,ea.appendChild(document.createElement("br")),ea.appendChild(J)):(Wa=document.createElement("a"),Wa.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,Wa.href=J,Wa.target="_blank",Wa.id="PrintPDFLink",Wa.className="AllowBrowserClick",this.dqa=Wa,ea.appendChild(document.createElement("br")),ea.appendChild(Wa),this.cm&&Ig.a.addHandler(Wa,
"click",Object(vf.a)(this,this.xoc,"onSubmit")),this.rP.pa(ug.a.click,this.dqa,Object(vf.a)(this,this.NIe,"downloadPDFLinkClicked"),null));this.cn.push(this.dqa);return ea};La.prototype.xoc=function(J){this.cm&&(this.cm.target="_blank",this.cm.submit());J.preventDefault()};La.prototype.Q5g=function(){if(0<this.cn.length){var J=new Ah.a(this.cn),ea=Ej.FocusManager.instance().MQ();ea&&(this.dqa.focus(),ea.jf=J,ea.A_=!0)}};La.prototype.NIe=function(){vd.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");
return!1};La.prototype.ptd=function(){vd.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")};La.prototype.h_i=function(){vd.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Flb&&this.Flb.stop()};La.prototype.dispose=function(){this.dqa&&(this.rP.Aa(ug.a.click,this.dqa,Object(vf.a)(this,this.NIe,"downloadPDFLinkClicked")),this.dqa=null);mi.a.p0(this.vP);this.vP=null;bj.prototype.dispose.call(this)};Object(ee.a)(La,"DirectPrintDialog",Dc.StandardDialog,
[657]);za.prototype.PLh=function(J,ea,Wa){return new La(this.rP,J,ea,void 0===Wa?null:Wa)};Object(ee.a)(za,"DirectPrintDialogFactory",null,[641]);Wl(ka,Mg);ka.prototype.Wkf=function(){vd.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")};ka.prototype.Ykf=function(){Ud.AFrameworkApplication.Xm.Hxb(9540);vd.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")};ka.prototype.ptd=function(){vd.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")};Ck.Object.defineProperties(ka.prototype,
{q8e:{configurable:!0,enumerable:!0,get:function(){return"Print_32x32x32"}},kVd:{configurable:!0,enumerable:!0,get:function(){return ka.ETa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}},WNa:{configurable:!0,enumerable:!0,get:function(){return ka.ETa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}},DVc:{configurable:!0,enumerable:!0,get:function(){var J=[];Array.add(J,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Mg.exb){var ea=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;
""!==Ud.AFrameworkApplication.sa.Qa.cFe&&(ea=Ud.AFrameworkApplication.sa.Qa.cFe);Array.add(J,ea)}return ka.ETa?J:null}},Bjc:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}},Ajc:{configurable:!0,enumerable:!0,get:function(){return"PrintPDFLink"}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_PrintDialogOpenPDF}},g4c:{configurable:!0,enumerable:!0,get:function(){return Ud.AFrameworkApplication.$Ge?"UIFontDialogTextLarge":
null}}});Ck.Object.defineProperties(ka,{ETa:{configurable:!0,enumerable:!0,get:function(){return!!Ud.AFrameworkApplication.sa&&Ud.AFrameworkApplication.sa.Qa.lv&&Ud.AFrameworkApplication.fa.ra("DirectPrintDialogAsStandardDialogIsEnabled")&&!(sg.a.RC||sg.a.Of||sg.a.Nf||sg.a.CMa)&&!Ud.AFrameworkApplication.isUnifiedHostMode&&Ud.AFrameworkApplication.fa.ra("ShouldHostDefaultToNativeBrowserPrintExperience")},set:function(){}}});Object(ee.a)(ka,"PrintDialogWithLinkToPdf",Mg,[]);Ea.Z5c=",";Object(ee.a)(Ea,
"DirectPrintBrsSettings",null,[]);Object(ee.a)(qa,"DirectPrintProbeResults",null,[]);oa.prototype.start=function(){};oa.prototype.h1i=function(){var J=Array(this.yC.FSa.length);if(void 0!==this.akb&&null!==this.akb)for(var ea=0;ea<this.yC.FSa.length;ea++)J[ea]=this.yC.FSa[ea]in this.akb&&this.kqg(this.akb[this.yC.FSa[ea]]);return J};oa.prototype.i1i=function(){for(var J=Array(this.yC.GSa.length),ea=!(void 0===this.ENc||null===this.ENc),Wa=0;Wa<this.yC.GSa.length;Wa++){var Pb=this.yC.GSa[Wa];J[Wa]=
ea&&Pb in this.ENc?!0:this.Qqg(Pb)}return J};oa.prototype.pXh=function(){for(var J=this.h1i(),ea=Array(J.length),Wa=0;Wa<J.length;Wa++)ea[Wa]=J[Wa]?this.mxh(this.akb[this.yC.FSa[Wa]]):null;return ea};oa.prototype.mxh=function(J){if(void 0===J||null===J)return null;J=J.enabledPlugin;return void 0===J||null===J?null:J.name};oa.prototype.DTh=function(){for(var J=this.pXh(),ea=this.i1i(),Wa={},Pb={},Cc=0;Cc<this.yC.FSa.length;Cc++)Wa[this.yC.FSa[Cc]]=J[Cc];for(J=0;J<this.yC.GSa.length;J++)Pb[this.yC.GSa[J]]=
ea[J];return new qa(Wa,Pb)};oa.prototype.Owj=function(){return this.Yqg||!this.yC.isEnabled||Ud.AFrameworkApplication.isUnifiedHostMode?!1:this.JEj()};oa.prototype.oxc=function(){if(null!=this.wXb)return this.wXb;var J=oa.Vbf(this.yC);return this.wXb=this.yC.Wbf&&J||this.rei()};oa.prototype.rei=function(){return sg.a.lp&&this.yC.tei&&sg.a.Dxe>=this.yC.RWg?!0:!1};oa.prototype.JEj=function(){if(!this.Rqg(this.yC))return!1;var J=tc.a.Qgd(this.VOc.value.D6f);J=Gl(J);for(var ea=J.next();!ea.done;ea=J.next())if(ea=
ea.value,void 0!==ea&&null!==ea)return!0;J=tc.a.Qgd(this.VOc.value.GSa);J=Gl(J);for(ea=J.next();!ea.done;ea=J.next())if(ea.value)return!0;return!1};oa.prototype.I3h=function(){var J=tc.a.Qgd(this.VOc.value.D6f);J=Gl(J);for(var ea=J.next();!ea.done;ea=J.next())if(d.a.contains(this.yC.a7h,ea.value))return!0;return!1};oa.prototype.d3f=function(J){var ea=void 0===ea?!1:ea;var Wa=void 0===Wa?null:Wa;Ud.AFrameworkApplication.sa&&Ud.AFrameworkApplication.fa.ra("DirectPrintDialogAsStandardDialogIsEnabled")?
this.C$d(J,Wa):this.Owj()?this.pfh(J,this.I3h()&&!ea,Wa):this.C$d(J,Wa)};oa.prototype.pfh=function(J,ea,Wa){Wa=void 0===Wa?null:Wa;var Pb=this.ewg.Gc("UserAction","OpenDirectPrintDialog");this.kVa.PLh(J,ea,Wa).oQ();Pb.stop()};oa.ugf=function(J){try{return new ActiveXObject(J),!0}catch(ea){vd.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",J)}return!1};oa.Xbf=function(J){return void 0===J||null===J?!1:!(void 0===J.enabledPlugin||null===J.enabledPlugin)};oa.create=
function(J){var ea=new Ea(Ud.AFrameworkApplication.fa.appSettings),Wa=null;try{Wa=window.navigator.mimeTypes}catch(tg){vd.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}var Pb=null;try{Pb=window.navigator.plugins}catch(tg){vd.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}var Cc=oa.Xbf,pd=oa.ugf;J=J.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");var wd=Ud.AFrameworkApplication.sa.yD,ue=oa.vgf,Je=!!Ud.AFrameworkApplication.sa&&
Ud.AFrameworkApplication.sa.Qa.lv&&!Ud.AFrameworkApplication.fa.ra("PrintDialogFallbackLinkEnabled");return new oa(ea,Wa,Pb,Cc,pd,J,wd,ue,function(tg,oh){return new ka(tg,!1,oh,!0,Je)},Ud.AFrameworkApplication.$La)};oa.vgf=function(J){return sg.a.lp||sg.a.Of&&J.Ihi||J.Wbf&&oa.Vbf(J)?!0:!1};oa.Vbf=function(J){var ea=sg.a.Csb;if(ea){var Wa=ea.split(".");if(2===Wa.length)return ea=parseInt(Wa[0]),Wa=parseInt(Wa[1]),ea>J.Wvd||ea===J.Wvd&&Wa>=J.vpf}return!1};Ck.Object.defineProperties(oa.prototype,{yC:{configurable:!0,
enumerable:!0,get:function(){return this.Mmg}}});Object(ee.a)(oa,"DirectPrintManager",null,[639]);xa.prototype.fi=function(J){var ea=this;this.tb=J;J.register(za,"Common.App.DirectPrint.DirectPrintDialogFactory").Hc().Oc(function(){return new za(Ud.AFrameworkApplication.sa.vX)});J.register(639,"Common.App.DirectPrint.IDirectPrintManager").Hc().Oc(function(){return oa.create(ea.tb)})};xa.prototype.init=function(){this.B4d=this.tb.resolve("Common.App.DirectPrint.IDirectPrintManager");this.B4d.start()};
xa.prototype.dispose=function(){};Ck.Object.defineProperties(xa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DirectPrint"}}});Object(ee.a)(xa,"PackageManager",null,[4,5]);var ai=b(635),Ii=sk.a;Wl(ta,Ii);ta.prototype.setFocus=function(){this.ow.checked?xg.DOMElementExtensions.setFocus(this.ow):xg.DOMElementExtensions.setFocus(this.getButton(0).get_element())};Ck.Object.defineProperties(ta.prototype,{Sd:{configurable:!0,enumerable:!0,get:function(){return this.cRb}}});
ta.m5b="printCurrentSelection";Object(ee.a)(ta,"BasePrintDialog",sk.a,[]);var cj=b(237);Wl(R,ta);R.prototype.initialize=function(){vd.ULS.sendTraceTag(537154316,0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.N9h();this.kYa(1197);this.addButton(1);ta.prototype.initialize.call(this)};R.prototype.uha=function(){var J=this;return function(ea,Wa,Pb){var Cc=J.$.na.va,pd=J.Tm;ea=J.kja(ea);Wa=J.Gaa(Wa);var wd=J.Sd,ue=Cc.Na(1,null);ue.printOptions=pd;return Pc.i(Cc,"ValidatePrint",
ue,ea,Wa,Pb,wd,0)}};R.prototype.commit=function(){this.s_g();return!0};R.prototype.ry=function(J,ea,Wa){var Pb,Cc=J.Result;if(Cc&&ea){var pd=0,wd=0;(null===(Pb=Cc.SelectedRanges)||void 0===Pb?0:Pb.Ranges)&&0<Cc.SelectedRanges.Ranges.length&&Cc.SelectedRanges.Ranges[0]&&(pd=Math.min(R.r0f(Cc.SelectedRanges.Ranges[0]),65535));Cc.UsedRange&&(wd=Math.min(R.r0f(ze.j(ze.D(Cc.UsedRange))),65535));cj.h(ea,pd);cj.i(ea,wd)}this.Tm=Cc;ta.prototype.ry.call(this,J,ea,Wa)};R.prototype.setFocus=function(){this.Tsb.checked?
xg.DOMElementExtensions.setFocus(this.Tsb):ta.prototype.setFocus.call(this)};R.prototype.N9h=function(){this.Qb.innerHTML=R.$Yi(this.$.ea.isNamedObjectViewMode);this.ow=xg.DOMElementExtensions.getElementById(this.Qb,ta.m5b);this.Tsb=xg.DOMElementExtensions.getElementById(this.Qb,"printEntireItem");0!==this.Tm.Type&&this.Tm.UseSelection?(this.ow.checked=!0,this.Tsb.disabled=!this.Tm.SheetName):(this.Tsb.checked=!0,this.ow.disabled=0===this.Tm.Type||!wg.g(this.$).ha.ta.Hg)};R.prototype.s_g=function(){vd.ULS.sendTraceTag(51499290,
0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");var J=new Sys.StringBuilder;this.uFh(J);var ea=String.format("location=0,scrollbars=1,resizable=1,menubar=1,toolbar={0},status=0",sg.a.Nf?0:1);Zh.HelperMethods.mf(J.toString(),"",ea,"PrintDialog.PrintViewUrl")||vd.ULS.sendTraceTag(51499291,0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")};R.prototype.uFh=function(J){var ea=this.$.ya;J.append(this.$.Jda+ea.LayoutsRelativeUri+
"/xlprintview.aspx?");Xh.a.eh(J,ca.a.E0i,this.Tm.SessionId);Xh.a.eh(J,ca.a.G0i,this.ow.checked?"1":"0");if(0===this.Tm.Type)Xh.a.eh(J,ca.a.B0i,this.Tm.ObjectId);else{if(!this.Tm.UsedRangeTooBig){var Wa=ze.D(this.Tm.UsedRange);(Wa=ze.x(Wa,this.Tm.SheetName))&&Xh.a.eh(J,ca.a.H0i,Wa)}1===this.Tm.Type?Xh.a.eh(J,ca.a.C0i,this.Tm.ObjectId):(Wa=ze.B(this.Tm.SelectedRanges.Ranges[0]),Wa=ze.x(Wa,this.Tm.SheetName),Xh.a.eh(J,ca.a.D0i,Wa))}rj.a.YYa(J,ea);Xh.a.eh(J,ca.a.F0i,this.Tm.Title)};R.$Yi=function(J){return String.format("<div class='"+
tk.a.Qn+"'>{0}</div>\r\n\t<div class='"+tk.a.f8b+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",Ne.a.instance.ga(1198),ta.m5b,Ne.a.instance.ga(1201),"printEntireItem",J?Ne.a.instance.ga(1200):Ne.a.instance.ga(1199))};R.r0f=function(J){return(J.LastColumn-J.FirstColumn+1)*(J.LastRow-J.FirstRow+1)};Ck.Object.defineProperties(R.prototype,{Cc:{configurable:!0,
enumerable:!0,get:function(){return"HtmlPrintDialog"}}});Object(ee.a)(R,"HtmlPrintDialog",ta,[]);var gi=b(615),Oh=b(65),bi=b(1256),ti=b(976),mh=b(305),bk=b(1075),Mh=b(935);I.prototype.getSheetName=function(){return this.sheetName};I.prototype.getPrintSettings=function(){return this.printSettings};Object(ee.a)(I,"MacroRecorderSheetPrintSettingsSavedPayload",null,[450]);Wl(G,ta);G.prototype.initialize=function(){this.E7&&nf.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&
G.z6g(this.Qb);this.Oe?this.CAe(1012,null):(this.Ll(),this.kYa(1012));ta.prototype.initialize.call(this)};G.prototype.dispose=function(){this.yMj();ta.prototype.dispose.call(this)};G.prototype.close=function(J){vd.ULS.sendTraceTag(591196544,0,50,"PdfPrintDialog.Close: User changed printSettings {0} times before exiting dialog {1} printing done",this.a0,0===J?"with":"without");this.mij();if(this.ps){var ea=this.SKh();!this.nSd&&!this.haa.checked&&this.$.isEditMode&&this.Lid(ea)&&this.dij(ea)}ta.prototype.close.call(this,
J)};G.prototype.uha=function(){var J=this;return function(ea,Wa,Pb){return Y(J.$.na.va,J.$.xa.qa.name,J.locale,J.kja(ea),J.Gaa(Wa),Pb,null)}};G.prototype.ry=function(J,ea,Wa){this.ps=J.Result;this.lJb=this.ps.ScalingWidth;this.kJb=this.ps.ScalingHeight;this.rad();this.u9h();ta.prototype.ry.call(this,J,ea,Wa)};G.prototype.Ll=function(){vd.ULS.sendTraceTag(537154315,0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");this.O9h();ta.prototype.Ll.call(this)};G.prototype.commit=
function(){this.r_g();return!0};G.prototype.setFocus=function(){this.Oe?Fk.a.HAc(this.Sca):this.Sca.checked?xg.DOMElementExtensions.setFocus(this.Sca):ta.prototype.setFocus.call(this)};G.prototype.eai=function(){switch(this.SN.Nv){case 1:this.Sca.checked=!0;break;case 0:this.ow.disabled?this.Sca.checked=!0:this.ow.checked=!0;break;case 2:this.haa.checked=!0;break;default:vd.ULS.sendTraceTag(537154314,0,10,"Invalid what to print state {0}. Resetting to defaults.",this.SN.Nv),this.SN.Nv=1,this.Sca.checked=
!0}};G.prototype.mij=function(){this.SN.Nv=this.hZc();this.E7&&(this.SN.ignorePrintArea=this.g5a.checked)};G.prototype.rad=function(){if(100!==this.ps.ScalingPercent||this.ps.FitToPage&&(1<this.ps.ScalingWidth||1<this.ps.ScalingHeight))this.nSd=!0,this.ps.ScalingWidth=G.x5c,this.ps.ScalingHeight=G.w5c,this.ps.ScalingPercent=G.Q5b,this.ps.FitToPage=G.q5c;this.ps.PaperSize.toString()in this.rCd||(this.nSd=!0,this.ps.PaperSize=this.ps.PaperSize===G.OMg?34:G.Rrb)};G.prototype.u9h=function(){this.fza=
this.ps.IsLandscape?2:1;this.$_=this.ps.FitToPage?1===this.ps.ScalingWidth&&1===this.ps.ScalingHeight?1:this.ps.ScalingWidth||1!==this.ps.ScalingHeight?2:3:0;this.Gma=this.ps.PaperSize;this.v7c(this.haa.checked?!0:!1);this.NNd(this.haa.checked?!0:!1)};G.prototype.a$h=function(){this.eec.disabled=this.ow.checked;this.vGb=this.g5a.checked=this.SN.ignorePrintArea};G.prototype.d9g=function(J){this.Zza=document.createElement("select");this.Zza.style.width=224+Oh.a.kf;this.Zza.style.height=32+Oh.a.kf;this.Zza.setAttribute(ca.a.iE,
"scalingElementId");this.Yza=new Mh.a(this.Zza,!0);for(var ea=0,Wa=G.scalingOptions.length;ea<Wa;++ea){var Pb=Ne.a.instance.ga(G.Kij[ea]);this.Yza.VL(Pb,G.scalingOptions[ea].toString(),!1)}J.appendChild(this.Zza)};G.prototype.QDe=function(J){this.Oya=document.createElement("select");this.Oya.style.width=224+Oh.a.kf;this.Oya.style.height=32+Oh.a.kf;this.Oya.setAttribute(ca.a.iE,"paperSizeElementId");this.Nya=new Mh.a(this.Oya,!0);for(var ea=0,Wa=G.paperSizeOptions.length;ea<Wa;++ea){var Pb=Ne.a.instance.ga(G.KUi[ea]);
this.Nya.VL(Pb,G.paperSizeOptions[ea].toString(),!1)}J.appendChild(this.Oya)};G.prototype.SKh=function(){var J={};J.IsLandscape=2===this.fza;J.PaperSize=this.Gma;J.ScalingWidth=this.lJb;J.ScalingHeight=this.kJb;J.ScalingPercent=100;J.FitToPage=0===this.$_?!1:!0;return J};G.prototype.AHa=function(){var J=new Sys.StringBuilder;J.append(bk.a(this.$,"Pdf",!0));this.mia.oxc()&&Xh.a.eh(J,eg.a.xdg,"1");Xh.a.eh(J,eg.a.vFd,""+this.O6);Xh.a.eh(J,eg.a.mJf,this.$.xa.qa.name);0===this.O6&&(Xh.a.eh(J,eg.a.lJf,
this.selectedRange),Xh.a.eh(J,eg.a.fJf,this.activeCell));Xh.a.eh(J,eg.a.gJf,""+this.fza);Xh.a.eh(J,eg.a.hJf,""+this.Gma);Xh.a.eh(J,eg.a.kJf,""+this.$_);Xh.a.eh(J,eg.a.jJf,"1");Xh.a.eh(J,eg.a.eJf,this.vGb?"1":"0");Xh.a.eh(J,eg.a.iJf,"1");vd.ULS.sendTraceTag(51499296,0,50,"PdfPrintDialog: Print Pdf Url {0}",J.toString());return J.toString()};G.prototype.fyb=function(){var J=this,ea=null;vd.ULS.sendTraceTag(537154313,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");
this.$.userOperationManager.jc(new Fb.a(223,0,function(Wa,Pb,Cc){Wa=new mh.a(Wa,null,Pb,Cc,null,!0,!1,"GetFileCopyFileHandler","");Wa.correlationID=gk.a.create().toString();ea=Wa;Ud.AFrameworkApplication.Jd.H9(J.AHa(),1,null,null,G.F$c,!1,2,J.Ezd,J.Dzd,ea,void 0,void 0,void 0,12E4);return Wc.Task.Sa(!0)},16),null)};G.prototype.O9h=function(){vd.ULS.sendTraceTag(537154312,0,50,"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.ZYi(this.Qb);this.v7c(!0);this.NNd(!0);this.ow=
xg.DOMElementExtensions.getElementById(this.Qb,ta.m5b);this.Sca=xg.DOMElementExtensions.getElementById(this.Qb,"printActiveSheet");this.haa=xg.DOMElementExtensions.getElementById(this.Qb,"printEntireWorkbook");this.E7&&(this.eec=xg.DOMElementExtensions.getElementById(this.Qb,"ignorePrintAreaCheckboxButtonId"),this.g5a=new ti.a(this.eec));this.Pwc()&&(this.ow.disabled=!0,this.Tm.SheetName=this.sheetName);this.eai();this.E7&&this.a$h();this.R6i()};G.prototype.Pwc=function(){return!!this.Tm.ObjectId||
!wg.g(this.$).ha.ta.Hg};G.prototype.R6i=function(){gi.a.instance.pa(ug.a.change,this.Sca,this.h9a);gi.a.instance.pa(ug.a.change,this.haa,this.h9a);gi.a.instance.pa(ug.a.change,this.ow,this.h9a);gi.a.instance.pa(ug.a.change,this.nxa,this.Emc);gi.a.instance.pa(ug.a.change,this.G$a,this.Emc);gi.a.instance.pa(ug.a.change,this.Oya,this.Xtf);gi.a.instance.pa(ug.a.change,this.Zza,this.Ytf);this.E7&&this.g5a.bnb(this.Wtf)};G.prototype.yMj=function(){gi.a.instance.Aa(ug.a.change,this.Sca,this.h9a);gi.a.instance.Aa(ug.a.change,
this.haa,this.h9a);gi.a.instance.Aa(ug.a.change,this.ow,this.h9a);gi.a.instance.Aa(ug.a.change,this.nxa,this.Emc);gi.a.instance.Aa(ug.a.change,this.G$a,this.Emc);gi.a.instance.Aa(ug.a.change,this.Oya,this.Xtf);gi.a.instance.Aa(ug.a.change,this.Zza,this.Ytf);this.E7&&this.g5a.kda(this.Wtf)};G.prototype.ZYi=function(J){J.classList.add(bi.a.YZi);if(!this.Oe){document.getElementById("ewaDialogTitle").classList.add(bi.a.printDialogTitle);var ea=document.getElementById("ewaDialogCloseButtonLink");ea.style.top=
32+Oh.a.kf;this.rtl?ea.style.left=32+Oh.a.kf:ea.style.right=32+Oh.a.kf}ea=G.iz(bi.a.ZZi);J.appendChild(ea);var Wa=G.iz(bi.a.X$a,1205);Wa.style.marginBottom=12+Oh.a.kf;Wa.id="whatToPrintTitleElementId";ea.appendChild(Wa);Wa=G.iz(bi.a.W$a);ea.appendChild(Wa);G.irb(Wa,this.rtl,"printActiveSheet",1209,"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");ea.appendChild(document.createElement("BR"));Wa=G.iz(bi.a.W$a);ea.appendChild(Wa);
G.irb(Wa,this.rtl,"printEntireWorkbook",1202,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");ea.appendChild(document.createElement("BR"));Wa=G.iz(bi.a.W$a);ea.appendChild(Wa);G.irb(Wa,this.rtl,ta.m5b,1201,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");this.E7?(Wa=G.iz(bi.a.X$a,1234),Wa.style.marginTop=24+Oh.a.kf,Wa.id="printAreaElementId",
ea.appendChild(Wa),nf.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?(Wa.style.marginBottom=12+Oh.a.kf,Wa=G.iz(tk.a.B8c),Wa.id="ignorePrintAreaCheckboxWarpperId",xg.DOMElementExtensions.setVisible(Wa,!0),ea.appendChild(Wa),ea=this.getElementById("ignorePrintAreaCheckboxButtonId"),xg.DOMElementExtensions.setVisible(ea,!0),Wa.appendChild(ea),ea=this.getElementById("ignorePrintAreaCheckboxLabelId"),xg.DOMElementExtensions.setVisible(ea,!0),Wa.appendChild(ea)):(Wa=
G.iz(bi.a.W$a),ea.appendChild(Wa),G.r4g(Wa,this.rtl))):(Wa=G.iz(bi.a.X$a,1207),Wa.style.marginTop=24+Oh.a.kf,Wa.id="paperSizeElementId",ea.appendChild(Wa),Wa=G.iz(bi.a.FEd),this.QDe(Wa),ea.appendChild(Wa));ea=G.iz(bi.a.$Zi);J.appendChild(ea);J=G.iz(bi.a.X$a,1206);J.style.marginBottom=12+Oh.a.kf;J.id="orientationTitleElementId";ea.appendChild(J);J=G.iz(bi.a.W$a);ea.appendChild(J);G.irb(J,this.rtl,"portraitRadioButtonId",1212,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId",
"orientationTitleElementId");ea.appendChild(document.createElement("BR"));J=G.iz(bi.a.W$a);ea.appendChild(J);G.irb(J,this.rtl,"landscapeRadioButtonId",1211,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");this.E7&&(J=G.iz(bi.a.X$a,1207),J.style.marginTop=12+Oh.a.kf,J.id="paperSizeElementId",ea.appendChild(J),J=G.iz(bi.a.FEd),this.QDe(J),ea.appendChild(J));J=G.iz(bi.a.X$a,1208);J.style.marginTop=(this.E7?10:74)+Oh.a.kf;J.id="scalingElementId";
ea.appendChild(J);J=G.iz(bi.a.FEd);this.d9g(J);ea.appendChild(J);this.Oe||document.getElementById("buttonarea").classList.add(bi.a.XZi);this.nxa=xg.DOMElementExtensions.getElementById(this.Qb,"landscapeRadioButtonId");this.G$a=xg.DOMElementExtensions.getElementById(this.Qb,"portraitRadioButtonId")};G.prototype.r_g=function(){var J=this;vd.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");this.O6=this.hZc();2!==this.O6&&(this.fza=this.bve(),this.Nya&&
(this.Gma=G.paperSizeOptions[this.Nya.selectedIndex]),this.Yza&&(this.$_=G.scalingOptions[this.Yza.selectedIndex]));if(this.$.xwa&&nf.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){var ea=this.$.na.va.hc();this.$.userOperationManager.jc(new Fb.a(133,0,function(Wa,Pb,Cc){var pd={};pd.WhatToPrint=J.O6;pd.UseNamedAction=J.mia.oxc();pd.SelectedSheetName=J.$.xa.qa.name;pd.ActiveCell=J.activeCell;pd.SelectedRanges=[J.selectedRange];pd.IsPdfDocumentRequired=
!1;pd.Orientation=J.fza;pd.PaperSize=J.Gma;pd.Scaling=J.$_;pd.RichValuesEnabled=!0;J.E7&&(pd.IgnorePrintArea=J.vGb);return U(J.$.na.va,pd,fi.b(J.WDb,Wa),Pb,Cc,ea)},16),null)}else this.fyb()};G.prototype.v7c=function(J){this.G$a.disabled=J;this.nxa.disabled=J;this.Nya.$n.disabled=J;this.Yza.$n.disabled=J};G.prototype.NNd=function(J){J?(this.nxa.checked=!1,this.G$a.checked=!1,this.Nya.selectedIndex=-1,this.Yza.selectedIndex=-1):(2===this.fza?this.nxa.checked=!0:this.G$a.checked=!0,this.Nya.selectedIndex=
this.rCd[this.Gma.toString()],this.Yza.selectedIndex=this.$_)};G.prototype.dij=function(J){var ea=this;vd.ULS.sendTraceTag(537154310,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");var Wa=this.$.xa.qa.name,Pb=this.$.na.va.hc();this.$.userOperationManager.jc(new Fb.a(226,0,function(Cc,pd,wd){return ha(ea.$.na.va,Wa,J,Cc,pd,wd,Pb)},void 0,function(){return new I(Wa,J)}),null)};G.prototype.Lid=function(J){return this.ps.IsLandscape!==
J.IsLandscape||this.ps.PaperSize!==J.PaperSize||this.ps.FitToPage!==J.FitToPage||this.ps.ScalingHeight!==J.ScalingHeight||this.ps.ScalingWidth!==J.ScalingWidth?!0:!1};G.prototype.bve=function(){return this.nxa&&this.nxa.checked?2:1};G.prototype.hZc=function(){return this.ow.checked?0:this.Sca.checked?1:this.haa.checked?2:1};G.iz=function(J,ea){J=void 0===J?null:J;ea=void 0===ea?0:ea;var Wa=document.createElement("div");J&&(Wa.className=J);0!==ea&&(Wa.innerHTML=Ne.a.instance.ga(ea));return Wa};G.z6g=
function(J){var ea=document.createElement("input");ea.setAttribute("type","checkbox");ea.className=tk.a.pMe;ea.id="ignorePrintAreaCheckboxButtonId";ea.setAttribute("name","ignorePrintAreaCbName");ea.style.height=16+Oh.a.kf;ea.style.width=16+Oh.a.kf;xg.DOMElementExtensions.setVisible(ea,!1);var Wa=Ne.a.instance.ga(1234),Pb=Ne.a.instance.ga(1235);ea.setAttribute(ca.a.Ot,Wa+Oh.a.space+Pb);J.appendChild(ea);ea=document.createElement("label");ea.setAttribute("for","ignorePrintAreaCheckboxButtonId");ea.id=
"ignorePrintAreaCheckboxLabelId";ea.innerHTML=Pb;ea.setAttribute(ca.a.IP,"true");ea.style.position="relative";ea.style.marginLeft=15+Oh.a.kf;xg.DOMElementExtensions.setVisible(ea,!1);J.appendChild(ea)};G.r4g=function(J,ea){var Wa=document.createElement("input");Wa.setAttribute("type","checkbox");Wa.id="ignorePrintAreaCheckboxButtonId";Wa.setAttribute("name","ignorePrintAreaCbName");Wa.setAttribute(ca.a.iE,"printAreaElementId"+Oh.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");Wa.style.height=
16+Oh.a.kf;Wa.style.width=16+Oh.a.kf;ea?Wa.style.marginRight=0+Oh.a.kf:Wa.style.marginLeft=0+Oh.a.kf;J.appendChild(Wa);ea=document.createElement("label");ea.setAttribute("for","ignorePrintAreaCheckboxButtonId");ea.setAttribute(ca.a.IP,"true");ea.style.position="relative";ea.style.marginLeft=15+Oh.a.kf;J.appendChild(ea);J=G.iz(bi.a.WHf,1235);J.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";ea.appendChild(J)};G.irb=function(J,ea,Wa,Pb,Cc,pd,wd,ue){var Je=document.createElement("input");Je.setAttribute("type",
"radio");Je.id=Wa;Je.setAttribute("name",Cc);Je.setAttribute(ca.a.iE,ue+Oh.a.space+wd);Je.style.height=16+Oh.a.kf;Je.style.width=16+Oh.a.kf;ea?Je.style.marginRight=0+Oh.a.kf:Je.style.marginLeft=0+Oh.a.kf;J.appendChild(Je);ea=document.createElement("label");ea.setAttribute("for",Wa);ea.style.position="relative";J.appendChild(ea);J=kh.createClusteredImage(32,32,pd,bi.a.g_i,!0,Ne.a.instance.ga(Pb));Pb=G.iz(bi.a.WHf,Pb);Pb.id=wd;Pb.setAttribute(ca.a.IP,"true");wd=G.iz(bi.a.f_i);wd.appendChild(Pb);ea.appendChild(wd);
ea.appendChild(J)};Ck.Object.defineProperties(G.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"PdfPrintDialog"}}});G.x5c=1;G.w5c=0;G.Q5b=100;G.Rrb=9;G.q5c=!0;G.OMg=13;G.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];G.KUi=[1214,1215,1222,1216,1217,1218,1219,1220,1213,1223,1224,1225,1226,1227,1228,1229];G.scalingOptions=[0,1,2,3];G.Kij=[1230,1231,1232,1233];G.F$c=["Content-Type"];Object(ee.a)(G,"PdfPrintDialog",ta,[]);Ck.Object.defineProperties(E.prototype,{Nv:{configurable:!0,
enumerable:!0,get:function(){return this.O6},set:function(J){0<=J&&2>=J?this.O6=J:(vd.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),this.O6=1)}},ignorePrintArea:{configurable:!0,enumerable:!0,get:function(){return this.v7d},set:function(J){J||!J?this.v7d=J:vd.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}});Object(ee.a)(E,"PdfPrintDialogBrowserSessionState",null,[]);var kk=b(1431);Object(ee.a)(aa,"MacroRecorderPrintAreaSetPayload",
null,[450]);Object(ee.a)(V,"MacroRecorderPageBreakInsertedPayload",null,[450]);Object(ee.a)(ba,"MacroRecorderPageBreakRemovedPayload",null,[450]);M.prototype.getSheetName=function(){return this.sheetName};Object(ee.a)(M,"MacroRecorderPageBreaksAllResetPayload",null,[450]);Q.prototype.getSheetName=function(){return this.sheetName};Object(ee.a)(Q,"MacroRecorderPrintAreaClearedPayload",null,[450]);var Sj=b(126);Object(ee.a)(P,"PageBreaksInformation",null,[]);Object(ee.a)(N,"RowColBreak",null,[]);Object(ee.a)(B,
"SharedRange",null,[]);var fl=b(170);A.prototype.executeCommand=function(J,ea,Wa,Pb,Cc,pd,wd){Cc=void 0===Cc?null:Cc;pd=void 0===pd?null:pd;wd=void 0===wd?null:wd;this.mWd();this.ribbonCommandInfo=ea;this.oCj(ea.command);J=fi.b(Cc,this.kKj);vd.ULS.sendTraceTag(543794888,0,50,"PrintCommandHandler.ExecuteCommand: {0} command execution started",ea.command);switch(ea.command){case 78661008:return this.o5e(ea,J,pd,wd,!1);case 275604654:return this.o5e(ea,J,pd,wd,!0);case -13332329:return this.o4e(ea,J,
pd,wd);case -837651977:return this.D1h(ea,J,pd,wd);case -1778266776:return this.x2h(ea,J,pd,wd);case 845325699:return this.j5e(ea,J,pd,wd)}return xi.a(ea.command)};A.prototype.Mc=function(J,ea){switch(ea.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===J;case 845325699:case -13332329:return!0}return!1};A.prototype.KZf=function(J,ea,Wa){var Pb=wg.g(this.$),Cc=Pb.Ea,pd=ze.r(Pb.ha.ta.selectedRanges,this.$);if((Cc=Cc.XE())&&Cc.length){Cc=Gl(Cc);for(var wd=Cc.next();!wd.done;wd=
Cc.next()){wd=wd.value;var ue=wd.Df;if(ue){for(var Je=ze.j(wd.uf),tg=[],oh=Gl(pd.Ranges),Qh=oh.next();!Qh.done;Qh=oh.next()){var ni=Qh.value;ni.FirstRow>Je.LastRow+1||ni.LastRow<Je.FirstRow||ni.FirstColumn>Je.LastColumn+1||ni.LastColumn<Je.FirstColumn||(Qh=this.sTh(Je,ni,ue),ni=this.rTh(Je,ni,ue),tg.push(Object(Ch.a)(new B,{FirstRow:Qh.FirstRow,FirstColumn:ni.FirstColumn,LastRow:Qh.LastRow,LastColumn:ni.LastColumn})))}0<tg.length&&!Wa?ue.setPrintArea(tg):0<tg.length&&Wa?ue.addToPrintArea(tg):!Wa&&
ue.hasPrintArea()&&ue.clearPrintArea();!ue.isDirty()&&ue.hasPageLayout()&&ue.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+wd.$d,4)}}this.vNb(Pb,J,ea)}};A.prototype.MXg=function(J,ea){var Wa=wg.g(this.$),Pb=wg.g(this.$).Ea.XE();if(Pb&&Pb.length){Pb=Gl(Pb);for(var Cc=Pb.next();!Cc.done;Cc=Pb.next()){Cc=Cc.value;var pd=Cc.Df;pd&&(pd.clearPrintArea(),!pd.isDirty()&&pd.hasPageLayout()&&pd.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+Cc.$d,4))}this.vNb(Wa,
J,ea)}};A.prototype.Mai=function(J,ea){var Wa=wg.g(this.$),Pb=Wa.Ea,Cc=ze.o(Wa.ha.ta.activeCell,this.$);if(Cc){var pd=Pb.XE();if(pd&&pd.length){Pb=null;for(var wd=Gl(pd),ue=wd.next();!ue.done;ue=wd.next()){ue=ue.value;var Je=ue.Df;if(Je){var tg=ze.j(ue.uf);if(!(Cc.FirstRow>tg.LastRow||Cc.FirstRow<tg.FirstRow||Cc.FirstColumn>tg.LastColumn||Cc.FirstColumn<tg.FirstColumn)&&(Pb=this.L7g(Je,tg,Cc),Je.insertPageBreak(Pb),!Je.isDirty()&&Je.hasPageLayout()&&Je.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+
ue.$d,4),Pb))break}}if(!Pb)for(pd=Gl(pd),ue=pd.next();!ue.done;ue=pd.next())if(Pb=ue.value,wd=Pb.Df)Pb=ze.j(Pb.uf),Pb=this.PDe(wd,Pb,Cc),wd.insertPageBreak(Pb);this.vNb(Wa,J,ea)}}};A.prototype.g9i=function(J,ea){var Wa=wg.g(this.$),Pb=Wa.Ea,Cc=ze.o(Wa.ha.ta.activeCell,this.$);if(Cc&&(Pb=Pb.XE())&&Pb.length){Pb=Gl(Pb);for(var pd=Pb.next();!pd.done;pd=Pb.next()){pd=pd.value;var wd=pd.Df;if(wd){var ue=ze.j(pd.uf);(ue=this.PDe(wd,ue,Cc))&&wd.removePageBreak(ue);!wd.isDirty()&&wd.hasPageLayout()&&wd.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+
pd.$d,4)}}this.vNb(Wa,J,ea)}};A.prototype.bej=function(J,ea){var Wa=wg.g(this.$),Pb=Wa.Ea.XE();if(Pb&&Pb.length){Pb=Gl(Pb);for(var Cc=Pb.next();!Cc.done;Cc=Pb.next()){Cc=Cc.value;var pd=Cc.Df;pd&&(pd.resetAllPageBreak(),!pd.isDirty()&&pd.hasPageLayout()&&pd.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+Cc.$d,4))}this.vNb(Wa,J,ea)}};A.prototype.o5e=function(J,ea,Wa,Pb,Cc){if(!Cc){var pd=this.$.Hb.getItemByName("PRINT_AREA");if(pd&&(vd.ULS.sendTraceTag(537154306,0,15,"PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : {0}",
pd.type),2===pd.type))return this.sci(),Wc.Task.Sa(!0)}pd=wg.g(this.$).ha.ta;var wd=ze.r(pd.selectedRanges,this.$);if(1===wd.Ranges.length&&!Cc){if(pd.Iba())return this.M2h(J,wd,ea,Wa,Pb,Cc),Wc.Task.Sa(!0);if(ze.R(wd.Ranges[0]))return this.$.xa.qa.hasPrintArea?this.o4e(J,ea,Wa,Pb):Wc.Task.Sa(!0)}this.KZf(J.command,Pb,Cc);return this.iaf(J,ea,Wa,wd,Cc)};A.prototype.o4e=function(J,ea,Wa,Pb){this.MXg(J.command,Pb);return this.eci(J,ea,Wa)};A.prototype.D1h=function(J,ea,Wa,Pb){this.Mai(J.command,Pb);
return this.pci(J,ea,Wa)};A.prototype.x2h=function(J,ea,Wa,Pb){var Cc=ze.r(wg.g(this.$).ha.ta.selectedRanges,this.$);if(ze.R(Cc.Ranges[0]))return this.j5e(J,ea,Wa,Pb);this.g9i(J.command,Pb);return this.tci(J,ea,Wa)};A.prototype.j5e=function(J,ea,Wa,Pb){this.bej(J.command,Pb);return this.wci(J,ea,Wa)};A.prototype.iaf=function(J,ea,Wa,Pb,Cc){function pd(){return new aa(Pb,Cc)}function wd(Je,tg,oh){Je=fi.b(Je,ea);tg=fi.a(tg,Wa);var Qh=ue.Na(1,null);Qh.selectedRanges=Pb;Qh.addToPrintArea=Cc;return Pc.i(ue,
"SetPrintArea",Qh,Je,tg,oh,null,0)}var ue=this.$.na.va;return nf.EwaSettings.qc()?Ba.a(this.$.userOperationManager,wd,function(Je){return new Fb.a(241,0,Je,64,pd)},J):Ba.a(this.$.userOperationManager,wd,function(Je){return new Xj.a(241,0,Je,void 0,pd)},J)};A.prototype.eci=function(J,ea,Wa){function Pb(){return new Q(pd)}function Cc(ue,Je,tg){ue=fi.b(ue,ea);Je=fi.a(Je,Wa);var oh=wd.Na(1,null);oh.sheetName=pd;return Pc.i(wd,"ClearPrintArea",oh,ue,Je,tg,null,0)}var pd=this.$.xa.qa.name,wd=this.$.na.va;
return nf.EwaSettings.qc()?Ba.a(this.$.userOperationManager,Cc,function(ue){return new Fb.a(243,0,ue,64,Pb)},J):Ba.a(this.$.userOperationManager,Cc,function(ue){return new Xj.a(243,0,ue,void 0,Pb)},J)};A.prototype.pci=function(J,ea,Wa){function Pb(){return new V(ue)}function Cc(Je,tg,oh){var Qh=pd.$.na.va;Je=fi.b(Je,ea);tg=fi.a(tg,Wa);var ni=Qh.Na(9,null);ni.sheetCell=ue;return Pc.i(Qh,"InsertPageBreak",ni,Je,tg,oh,null,0)}var pd=this,wd=wg.g(this.$),ue=ze.o(wd.ha.ta.activeCell,this.$);return nf.EwaSettings.qc()?
Ba.a(this.$.userOperationManager,Cc,function(Je){return new Fb.a(244,0,Je,64,Pb)},J):Ba.a(this.$.userOperationManager,Cc,function(Je){return new Xj.a(244,0,Je,void 0,Pb)},J)};A.prototype.tci=function(J,ea,Wa){function Pb(){return new ba(ue)}function Cc(Je,tg,oh){var Qh=pd.$.na.va;Je=fi.b(Je,ea);tg=fi.a(tg,Wa);var ni=Qh.Na(9,null);ni.sheetCell=ue;return Pc.i(Qh,"RemovePageBreak",ni,Je,tg,oh,null,0)}var pd=this,wd=wg.g(this.$),ue=ze.o(wd.ha.ta.activeCell,this.$);return nf.EwaSettings.qc()?Ba.a(this.$.userOperationManager,
Cc,function(Je){return new Fb.a(245,0,Je,64,Pb)},J):Ba.a(this.$.userOperationManager,Cc,function(Je){return new Xj.a(245,0,Je,void 0,Pb)},J)};A.prototype.wci=function(J,ea,Wa){function Pb(){return new M(wd)}function Cc(ue,Je,tg){var oh=pd.$.na.va;ue=fi.b(ue,ea);Je=fi.a(Je,Wa);var Qh=oh.Na(9,null);Qh.sheetName=wd;return Pc.i(oh,"ResetAllPageBreaks",Qh,ue,Je,tg,null,0)}var pd=this,wd=this.$.xa.qa.name;return nf.EwaSettings.qc()?Ba.a(this.$.userOperationManager,Cc,function(ue){return new Fb.a(246,0,
ue,64,Pb)},J):Ba.a(this.$.userOperationManager,Cc,function(ue){return new Xj.a(246,0,ue,void 0,Pb)},J)};A.prototype.sTh=function(J,ea,Wa){if(!J||!ea||!Wa)return null;var Pb=new B;Pb.FirstRow=ea.FirstRow===J.LastRow+1?Wa.getRowIndex(J.LastRow+1)+1:ea.FirstRow<J.FirstRow?0:Wa.getRowIndex(ea.FirstRow+1);Pb.LastRow=ea.FirstRow===J.LastRow+1||ea.LastRow>J.LastRow?Wa.getRowIndex(J.LastRow+1)+1:Wa.getRowIndex(ea.LastRow+1);return Pb};A.prototype.rTh=function(J,ea,Wa){if(!J||!ea||!Wa)return null;var Pb=new B;
Pb.FirstColumn=ea.FirstColumn===J.LastColumn+1?Wa.getColumnIndex(J.LastColumn+1)+1:ea.FirstColumn<J.FirstColumn?0:Wa.getColumnIndex(ea.FirstColumn+1);Pb.LastColumn=ea.FirstColumn===J.LastColumn+1||ea.LastColumn>J.LastColumn?Wa.getColumnIndex(J.LastColumn+1)+1:Wa.getColumnIndex(ea.LastColumn+1);return Pb};A.prototype.L7g=function(J,ea,Wa){if(!ea||!Wa||!J)return null;var Pb=J.getPrintArea();if(!Pb||!Pb.length)return null;var Cc=J.getRowIndex(Wa.FirstRow+1),pd=J.getColumnIndex(Wa.FirstColumn+1),wd=null,
ue=null;Pb=Gl(Pb);for(var Je=Pb.next();!Je.done;Je=Pb.next())if(Je=Je.value,Cc>=Je.FirstRow&&Cc<=Je.LastRow&&pd>=Je.FirstColumn&&pd<=Je.LastColumn){if(Wa.FirstRow===Je.FirstRow&&Wa.FirstColumn===Je.FirstColumn)return new P;Cc>Je.FirstRow&&(wd=Object(Ch.a)(new N,{Index:Cc-1,Min:Je.FirstColumn-1,Max:Math.min(Je.LastColumn,J.getColumnIndex(ea.LastColumn+1))}));pd>Je.FirstColumn&&(ue=Object(Ch.a)(new N,{Index:pd-1,Min:Je.FirstRow-1,Max:Math.min(Je.LastRow,J.getRowIndex(ea.LastRow+1))}));break}return wd||
ue?Object(Ch.a)(new P,{Row:wd?[wd]:null,Col:ue?[ue]:null}):null};A.prototype.$8g=function(J,ea,Wa){if(!ea||!Wa||!J)return null;var Pb=null;Wa.FirstRow>ea.FirstRow&&Wa.FirstRow<=ea.LastRow?Pb=Object(Ch.a)(new N,{Index:J.getRowIndex(Wa.FirstRow+1)-1,Min:-1,Max:-1}):Wa.FirstRow===ea.LastRow+1&&(Pb=Object(Ch.a)(new N,{Index:J.getRowIndex(ea.LastRow+1),Min:-1,Max:-1}));return Pb};A.prototype.x4g=function(J,ea,Wa){if(!ea||!Wa||!J)return null;var Pb=null;Wa.FirstColumn>ea.FirstColumn&&Wa.FirstColumn<=ea.LastColumn?
Pb=Object(Ch.a)(new N,{Index:J.getColumnIndex(Wa.FirstColumn+1)-1,Min:-1,Max:-1}):Wa.FirstColumn===ea.LastColumn+1&&(Pb=Object(Ch.a)(new N,{Index:J.getColumnIndex(ea.LastColumn+1),Min:-1,Max:-1}));return Pb};A.prototype.PDe=function(J,ea,Wa){if(!Wa||!J||!ea)return null;var Pb=this.$8g(J,ea,Wa);J=this.x4g(J,ea,Wa);return Pb||J?Object(Ch.a)(new P,{Row:Pb?[Pb]:null,Col:J?[J]:null}):null};A.prototype.sci=function(){var J=new Dc.StandardDialog;J.ic=0;J.Ac(1,Ne.a.instance.ga(4));J.Ak(Ne.a.instance.ga(571),
Ne.a.instance.ga(572),1,null)};A.prototype.oCj=function(J){if(this.Hva.yb(J)&&(Zh.HelperMethods.g_&&(this.kFb=this.$.Pb.Gc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.DKa.yb(J)&&this.DKa.remove(J),this.DKa.add(J,gk.a.create().toString()),wg.g(this.$).Ii)){var ea=Uh.b()?Uh.b().ri(J):"";wg.g(this.$).Ii.I7(this.Hva.oa(J),this.DKa.oa(J),ea)}};A.prototype.TVg=function(J){if(this.kFb&&J){var ea=this.kFb.Bc;this.kFb.stop();this.kFb=null;switch(J){case "SetPrintArea":this.Lpb(ea,1700,J);break;
case "ClearPrintArea":this.Lpb(ea,1500,J);break;case "InsertPageBreak":this.Lpb(ea,1500,J);break;case "RemovePageBreak":this.Lpb(ea,1600,J);break;case "ResetAllPageBreaks":this.Lpb(ea,1700,J)}}};A.prototype.Lpb=function(J,ea,Wa){J>ea&&(ea=Object(Ch.a)(new Vg.a,{extendedProperties:new Map}),ea.extendedProperties.set("OperationName",Wa),ea.extendedProperties.set("OperationExecutionTime",J.toString()),lh.Health.instance.recordQosError(Sj.a.cBj,[Ic.a.YAj],!1,!0,!0,!1,ea))};A.prototype.M2h=function(J,
ea,Wa,Pb,Cc,pd){var wd=this,ue=new Dc.StandardDialog,Je=new kk.a(Ne.a.instance.ga(569),Ne.a.instance.ga(570),Ne.a.instance.ga(6),Ne.a.instance.ga(5));ue.ic=1;ue.Ac(1,Je.confirmButton);ue.Ac(0,Je.cancelButton);ue.Ak(Je.title,Je.body,3,function(tg){1===tg&&(wd.KZf(J.command,Cc,pd),wd.iaf(J,Wa,Pb,ea,pd))})};A.prototype.vNb=function(J,ea,Wa){Wa();this.DKa.yb(ea)&&J.Ii.N0(this.DKa.oa(ea),Ek.BasicTelemetryCalculator.aR)};A.prototype.mWd=function(){this.opd&&this.$.Ud(-1753588160,-1,0,null)};Object(ee.a)(A,
"PrintAreaBreakManager",null,[660]);var gl=b(408);D.prototype.equals=function(J){return J?this.orientation===J.orientation&&this.Cca===J.Cca&&this.w0===J.w0&&this.margin===J.margin&&this.sheetPrintOptions===J.sheetPrintOptions&&this.w1a===J.w1a&&this.NoColor===J.NoColor:!1};D.NBe=function(J,ea){J&&ea&&(ea.Nv=J.Nv,ea.orientation=J.orientation,ea.Cca=J.Cca,ea.w0=J.w0,ea.margin=J.margin,ea.ignorePrintArea=J.ignorePrintArea,ea.sheetPrintOptions=J.sheetPrintOptions,ea.w1a=J.w1a,ea.NoColor=J.NoColor)};
Object(ee.a)(D,"PrintSettingsContainer",null,[]);var fj=b(159),Gj=b(356),dj=b(1021),Qi=b(989),wj=b(735);Object(ee.a)(z,"PrintSettingMarginOption",null,[]);Object(ee.a)(t,"PrintSettingMarginValue",null,[]);Object(ee.a)(v,"PrintSettingOption",null,[]);w.prototype.dispose=function(){};w.prototype.Mvb=function(J){if(!J)return null;var ea=new t;ea.left=J.Left;ea.right=J.Right;ea.top=J.Top;ea.bottom=J.Bottom;ea.header=J.Header;ea.footer=J.Footer;return ea};w.prototype.G3c=function(J){vd.ULS.shipAssertTag(537154186,
0,6===J.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");var ea={};ea.Top=J[0];ea.Bottom=J[1];ea.Left=J[2];ea.Right=J[3];ea.Header=J[4];ea.Footer=J[5];return ea};w.prototype.z$h=function(){this.Nie=[Object(Ch.a)(new v,{printSettingOptionKey:1,printSettingOptionText:this.Wm.ga(1209)}),Object(Ch.a)(new v,{printSettingOptionKey:2,printSettingOptionText:this.Wm.ga(1202)}),Object(Ch.a)(new v,{printSettingOptionKey:0,printSettingOptionText:this.Wm.ga(1201)})];
this.nce=[Object(Ch.a)(new v,{printSettingOptionKey:1,printSettingOptionText:this.Wm.ga(1212)}),Object(Ch.a)(new v,{printSettingOptionKey:2,printSettingOptionText:this.Wm.ga(1211)})];this.Ece=[Object(Ch.a)(new v,{printSettingOptionKey:1,printSettingOptionText:this.Wm.ga(1214)}),Object(Ch.a)(new v,{printSettingOptionKey:5,printSettingOptionText:this.Wm.ga(1215)}),Object(Ch.a)(new v,{printSettingOptionKey:6,printSettingOptionText:this.Wm.ga(1222)}),Object(Ch.a)(new v,{printSettingOptionKey:7,printSettingOptionText:this.Wm.ga(1216)}),
Object(Ch.a)(new v,{printSettingOptionKey:8,printSettingOptionText:this.Wm.ga(1217)}),Object(Ch.a)(new v,{printSettingOptionKey:9,printSettingOptionText:this.Wm.ga(1218)}),Object(Ch.a)(new v,{printSettingOptionKey:11,printSettingOptionText:this.Wm.ga(1219)}),Object(Ch.a)(new v,{printSettingOptionKey:12,printSettingOptionText:this.Wm.ga(1220)}),Object(Ch.a)(new v,{printSettingOptionKey:13,printSettingOptionText:this.Wm.ga(1221)}),Object(Ch.a)(new v,{printSettingOptionKey:3,printSettingOptionText:this.Wm.ga(1213)})];
this.gfe=[Object(Ch.a)(new v,{printSettingOptionKey:0,printSettingOptionText:this.Wm.ga(1230)}),Object(Ch.a)(new v,{printSettingOptionKey:1,printSettingOptionText:this.Wm.ga(1231)}),Object(Ch.a)(new v,{printSettingOptionKey:2,printSettingOptionText:this.Wm.ga(1232)}),Object(Ch.a)(new v,{printSettingOptionKey:3,printSettingOptionText:this.Wm.ga(1233)})];this.nae=[Object(Ch.a)(new z,{printSettingOption:Object(Ch.a)(new v,{printSettingOptionKey:0,printSettingOptionText:this.Wm.ga(1236)}),marginValue:this.Mvb(this.normal)}),
Object(Ch.a)(new z,{printSettingOption:Object(Ch.a)(new v,{printSettingOptionKey:1,printSettingOptionText:this.Wm.ga(1237)}),marginValue:this.Mvb(this.wide)}),Object(Ch.a)(new z,{printSettingOption:Object(Ch.a)(new v,{printSettingOptionKey:2,printSettingOptionText:this.Wm.ga(1238)}),marginValue:this.Mvb(this.narrow)}),Object(Ch.a)(new z,{printSettingOption:Object(Ch.a)(new v,{printSettingOptionKey:3,printSettingOptionText:this.Wm.ga(1239)}),marginValue:this.Mvb(this.N6)})]};w.prototype.s$h=function(){this.normal=
this.G3c(this.aCi);this.narrow=this.G3c(this.OAi);this.wide=this.G3c(this.rVj)};Ck.Object.defineProperties(w.prototype,{whatToPrintOptions:{configurable:!0,enumerable:!0,get:function(){return this.Nie}},orientationOptions:{configurable:!0,enumerable:!0,get:function(){return this.nce}},paperSizeOptions:{configurable:!0,enumerable:!0,get:function(){return this.Ece}},scalingOptions:{configurable:!0,enumerable:!0,get:function(){return this.gfe}},marginDetailedOptions:{configurable:!0,enumerable:!0,get:function(){return this.nae}}});
w.dch=1;w.Rbh=1;w.Rrb=9;w.Wbh=2;w.Pbh=0;w.Ibh=!1;w.Ebh=!1;w.$Ha={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(ee.a)(w,"PrintSettingsManagerBase",null,[3]);var Tj=b(127);u.prototype.getSheetName=function(){return this.sheetName};Object(ee.a)(u,"MacroRecorderSheetPrintOptionsSavedPayload",null,[450]);Wl(x,w);x.prototype.jci=function(J){var ea=this;this.kci(function(Wa){J&&(Wa=ea.xTh(Wa),J(Wa))})};x.prototype.QLd=function(J,ea){if(J){var Wa=new E(J.Nv,J.ignorePrintArea);
this.cij(Wa);!ea||this.c4f?vd.ULS.sendTraceTag(593294034,0,50,"PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because {0}",ea?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"):(ea=this.zTh(J.w0),ea.IsLandscape=2===J.orientation,ea.PaperSize=J.Cca,this.isUniversalPrintEnabled&&(ea.NoColor=J.NoColor),ea.PageMargin=this.vfd(J.margin),ea.SheetPrintOptions=w.$Ha,ea.SheetPrintOptions.PrintGrid=J.sheetPrintOptions.PrintGrid,ea.SheetPrintOptions.HorizontalCenter=
J.sheetPrintOptions.HorizontalCenter,ea.SheetPrintOptions.VerticalCenter=J.sheetPrintOptions.VerticalCenter,ea.SheetPrintOptions.PrintHeaders=J.sheetPrintOptions.PrintHeaders,this.bij(ea))}else vd.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")};x.prototype.vfd=function(J){var ea={};0===J?ea=this.normal:1===J?ea=this.wide:2===J?ea=this.narrow:3===J&&(ea=this.N6);return ea};x.prototype.Aci=function(J){var ea=this;if(J){vd.ULS.sendTraceTag(537154197,
0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var Wa=function(){return new u(ea.$.xa.qa.name,J)},Pb=this.$.na.va,Cc=this.$.na.va.hc(),pd=function(wd,ue,Je){var tg=ea.$.xa.qa.name;wd=fi.b(ea.IAd,wd);ue=fi.a(ea.UAd,ue);var oh=Pb.Na(1,null);oh.sheetName=tg;oh.printOptions=J;return Pc.i(Pb,"SetPrintOptions",oh,wd,ue,Je,Cc,0)};Wa=nf.EwaSettings.qc()?new Fb.a(598,0,pd,64,Wa):new Xj.a(598,0,pd,void 0,Wa);this.$.userOperationManager.jc(Wa,null)}else vd.ULS.sendTraceTag(537154198,
0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")};x.prototype.dispose=function(){this.Pd||(this.Pd=!0,this.$.userOperationManager.Ul(this.Kz),this.pY())};x.prototype.cij=function(J){this.SN.Nv=J.Nv;this.SN.ignorePrintArea=J.ignorePrintArea};x.prototype.kci=function(J){function ea(ue,Je,tg){return Y(Cc.$.na.va,Cc.sheetName,Cc.locale,fi.b(ue,Pb),fi.a(Je,Wa),tg,pd)}function Wa(ue){ue=rj.a.ig(ue.data);vd.ULS.sendTraceTag(537154194,0,10,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",
uh.a.Tc(ue));J(null)}function Pb(ue){Rj.a(ue)?vd.ULS.sendTraceTag(537154196,0,15,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",uh.a.Tc(ue.Errors)):(vd.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),J(ue.Result))}var Cc=this,pd=this.$.na.va.hc();var wd=nf.EwaSettings.qc()?new Fb.a(247,0,ea,80):new Xj.a(247,0,ea,16);wd=this.$.userOperationManager.jc(wd,null);this.pv.add(wd)};x.prototype.bij=
function(J){var ea=this;vd.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");var Wa=this.$.na.va.hc();this.$.userOperationManager.jc(new Fb.a(226,0,function(Pb,Cc,pd){return ha(ea.$.na.va,ea.sheetName,J,fi.b(Pb,ea.APi),fi.a(Cc,ea.zPi),pd,Wa)},void 0,function(){return new I(ea.sheetName,J)}),null)};x.prototype.yji=function(J){return this.Bbf(J)||!this.Gef(J.PaperSize)};x.prototype.rad=function(J){this.Bbf(J)&&(vd.ULS.sendTraceTag(537154192,
0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),J.ScalingWidth=x.x5c,J.ScalingHeight=x.w5c,J.ScalingPercent=x.Q5b,J.FitToPage=x.q5c);this.Gef(J.PaperSize)||(vd.ULS.sendTraceTag(537154191,0,15,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size {0} present in file which is unsupported by XLO.",J.PaperSize.toString()),J.PaperSize=x.Rrb);return J};x.prototype.vTh=function(J){if(J.FitToPage){if(1===J.ScalingWidth&&1===J.ScalingHeight)return 1;
if(!J.ScalingWidth&&1===J.ScalingHeight)return 3}else return 0;return 2};x.prototype.uTh=function(J){return this.$od(J,this.normal)?0:this.$od(J,this.wide)?1:this.$od(J,this.narrow)?2:3};x.prototype.$od=function(J,ea){return J.Left===ea.Left&&J.Right===ea.Right&&J.Top===ea.Top&&J.Bottom===ea.Bottom&&J.Header===ea.Header&&J.Footer===ea.Footer};x.prototype.zTh=function(J){var ea={};ea.ScalingPercent=x.Q5b;ea.FitToPage=0!==J;2===J?(ea.ScalingWidth=1,ea.ScalingHeight=0):3===J?(ea.ScalingWidth=0,ea.ScalingHeight=
1):1===J&&(ea.ScalingWidth=1,ea.ScalingHeight=1);return ea};x.prototype.Gef=function(J){return this.JUi.contains(J.toString())};x.prototype.Bbf=function(J){return 100!==J.ScalingPercent||J.FitToPage&&(1<J.ScalingWidth||1<J.ScalingHeight)};x.prototype.n2g=function(){for(var J=new wj.a(Gb.a.Qk()),ea=0;ea<this.paperSizeOptions.length;ea++)J.add(this.paperSizeOptions[ea].printSettingOptionKey.toString());return J};x.prototype.xTh=function(J){var ea=null;if(J){var Wa=this.SN.Nv,Pb=this.SN.ignorePrintArea;
this.yji(J)&&(this.c4f=!0,J=this.rad(J));ea=new D;ea.Nv=Wa;ea.ignorePrintArea=Pb;ea.orientation=J.IsLandscape?2:1;ea.Cca=J.PaperSize;ea.w0=this.vTh(J);ea.sheetPrintOptions=w.$Ha;ea.sheetPrintOptions.PrintGrid=J.SheetPrintOptions.PrintGrid;ea.w1a=J.Draft;this.isUniversalPrintEnabled&&(ea.NoColor=J.NoColor);ea.sheetPrintOptions.HorizontalCenter=J.SheetPrintOptions.HorizontalCenter;ea.sheetPrintOptions.VerticalCenter=J.SheetPrintOptions.VerticalCenter;ea.sheetPrintOptions.PrintHeaders=J.SheetPrintOptions.PrintHeaders;
ea.margin=this.uTh(J.PageMargin);nf.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&vd.ULS.sendTraceTag(553965398,0,50,"PageMargin received : {0}",ea.margin);3===ea.margin&&(this.N6={},this.N6.Left=J.PageMargin.Left,this.N6.Right=J.PageMargin.Right,this.N6.Top=J.PageMargin.Top,this.N6.Bottom=J.PageMargin.Bottom,this.N6.Header=J.PageMargin.Header,this.N6.Footer=J.PageMargin.Footer)}return ea};x.prototype.pY=function(){if(this.pv){for(var J=Gl(this.pv),ea=J.next();!ea.done;ea=
J.next())ea=ea.value,this.$&&this.$.userOperationManager&&(ea.operation&&vd.ULS.sendTraceTag(537154187,0,50,"PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",Tj.a(ea.operation.operationName)),this.$.userOperationManager.Ota(ea)),this.pv.remove(ea);this.pv=null}};x.x5c=1;x.w5c=0;x.Q5b=100;x.Rrb=9;x.q5c=!0;Object(ee.a)(x,"PrintSettingsManager",w,[]);Object(ee.a)(h,"PrintSettingsTaskPaneCallbacks",null,[]);Object(ee.a)(m,"SelectedPrintSettings",null,[]);Object(ee.a)(n,
"PrintOperationCallbacks",null,[]);Object(ee.a)(l,"PrintPreviewPaneCallbacks",null,[]);var Ak=b(1255);Object(ee.a)(f,"UniversalPrintAppSettings",null,[]);var Bk=b(392);e.prototype.VFg=function(J){this.Pa.addHandler("ppocek",J)};e.prototype.Qaj=function(J){this.Pa.removeHandler("ppocek",J)};e.prototype.ezj=function(J,ea){this.yej();this.$.userOperationManager.xq(this.Kz);this.Tm=J;this.Pa.raiseEvent("ppocek");this.Tm.SelectedRanges&&this.Tm.SelectedRanges.Ranges&&0<this.Tm.SelectedRanges.Ranges.length&&
this.Tm.SelectedRanges.Ranges[0]&&(this.selectedRange=ze.B(this.Tm.SelectedRanges.Ranges[0]).toString());vd.ULS.shipAssertTag(537154268,0,!this.qv,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.qv=new x(this,this.$,ea,this.$.xa.qa.name,Ne.a.instance,this.isUniversalPrintEnabled);vd.ULS.shipAssertTag(537154267,0,!this.zg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.zg=new Qi.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);
this.zg.Hfh();this.zg.gzj();this.zg.mFg(this.lzf)};e.prototype.GQh=function(){this.qv.N6&&4<=this.qv.marginDetailedOptions.length&&(this.qv.marginDetailedOptions[3].marginValue=this.qv.Mvb(this.qv.N6));return this.qv.marginDetailedOptions};e.prototype.Pwc=function(){return!!this.Tm&&!!this.Tm.ObjectId||!wg.g(this.$).ha.ta.Hg};e.prototype.ATh=function(){var J=Object(Ch.a)(new m,{selectedWhatToPrint:w.dch,selectedOrientation:w.Rbh,selectedPaperSize:w.Rrb,selectedScaling:w.Wbh,selectedMargin:w.Pbh,selectedIgnorePrintArea:w.Ibh,
selectedPrintGridlines:w.$Ha.PrintGrid,selectedDraft:w.Ebh,selectedHorizontalCenter:w.$Ha.HorizontalCenter,selectedVerticalCenter:w.$Ha.VerticalCenter,selectedRowAndColumnHeadings:w.$Ha.PrintHeaders});this.AH?(J.selectedWhatToPrint=this.AH.Nv,J.selectedOrientation=this.AH.orientation,J.selectedPaperSize=this.AH.Cca,J.selectedScaling=this.AH.w0,J.selectedMargin=this.AH.margin,J.selectedIgnorePrintArea=this.AH.ignorePrintArea,J.selectedPrintGridlines=this.AH.sheetPrintOptions.PrintGrid,J.selectedDraft=
this.AH.w1a,this.isUniversalPrintEnabled&&(J.selectedColor=this.AH.NoColor?0:1),J.selectedHorizontalCenter=this.AH.sheetPrintOptions.HorizontalCenter,J.selectedVerticalCenter=this.AH.sheetPrintOptions.VerticalCenter,J.selectedRowAndColumnHeadings=this.AH.sheetPrintOptions.PrintHeaders):vd.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return J};e.prototype.x0e=function(){var J=this;return Object(Ch.a)(new l,{onBackToSheet:function(){J.Ula()}})};
e.prototype.wTh=function(){var J=this;return Object(Ch.a)(new Ak.a,{backActionButtonText:Ne.a.instance.ga(1189),printPreviewPaneCallbacks:this.x0e(),logger:new gl.a,disableTellMeControl:!0,printOperationCallbacks:Object(Ch.a)(new n,{onClosePreviewer:function(){J.Ula()},getGraphServiceAuthorizationToken:this.S$b(),onLocalPrint:function(){J.Zzf()},onNotifyPrintJobStatus:this.onNotifyPrintJobStatus}),universalPrintAppSettings:Object(Ch.a)(new f,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.Ldi()?
"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})};e.prototype.yTh=function(){var J=this;return Object(Ch.a)(new h,{onSettingChange:function(ea){J.pOi(ea)},onPrint:function(){J.Zzf()}})};e.prototype.pOi=function(J){this.a0++;J?(this.zg&&this.zg.Wzj(),this.yk.Nv=J.selectedWhatToPrint,this.yk.w0=J.selectedScaling,this.yk.orientation=J.selectedOrientation,this.yk.Cca=J.selectedPaperSize,this.yk.margin=J.selectedMargin,this.isUniversalPrintEnabled&&
(this.yk.NoColor=!J.selectedColor),this.yk.ignorePrintArea=J.selectedIgnorePrintArea,this.Upj(J.selectedPageStart,J.selectedPageEnd),this.qv&&this.T3h(this.yk,J)?(this.yk.sheetPrintOptions=w.$Ha,this.yk.sheetPrintOptions.PrintGrid=J.selectedPrintGridlines,this.yk.sheetPrintOptions.HorizontalCenter=J.selectedHorizontalCenter,this.yk.sheetPrintOptions.VerticalCenter=J.selectedVerticalCenter,this.yk.sheetPrintOptions.PrintHeaders=J.selectedRowAndColumnHeadings,this.qv.Aci(this.yk.sheetPrintOptions)):
this.fyb()):vd.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")};e.prototype.Ula=function(){this.O5a&&(this.zMb=!0);vd.ULS.sendTraceTag(591196513,0,50,"PrintPreviewManager.OnCloseButtonClick: User changed printSettings {0} times before clicking on backToWorkbook icon",this.a0);this.Yzf();this.Lxe()};e.prototype.Zzf=function(){vd.ULS.sendTraceTag(591196512,0,50,"PrintPreviewManager.OnPrintButtonClick: User changed printSettings {0} times before clicking on print button.",
this.a0);nf.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&vd.ULS.sendTraceTag(543024129,0,50,"PrintPreviewManager.OnPrintButtonClick: Current margin value : {0}, Initial margin value : {1}",this.yk.margin,this.AH.margin);if(this.useMSPdfViewer)this.SHf();else if(this.v6a)try{this.zg.printPdf(),this.I0c()}catch(J){vd.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.SHf()}else this.mia.d3f(this.AHa(!0)),this.I0c()};
e.prototype.SHf=function(){var J=this.AHa(!0);this.I0c();Zh.HelperMethods.mf(J,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")};e.prototype.dispose=function(){hb.a.Ha(this.Pa)};e.prototype.fyb=function(){var J=this;if(this.$.xwa)this.gci();else{this.pY();this.XSf();var ea=null;this.R9h();vd.ULS.sendTraceTag(593266766,0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var Wa=function(Pb,Cc,pd){Pb=new mh.a(Pb,null,Cc,pd,null,!0,!1,"GetFileCopyFileHandler",
"");Pb.correlationID=gk.a.create().toString();ea=Pb;J.Sba=J.j3.H9(J.AHa(J.v6a?!1:!0,J.Edi?"Base64":"Pdf"),1,null,null,e.F$c,!1,2,J.Ezd,J.Dzd,ea,void 0,void 0,void 0,12E4);Pb.requestId=J.Sba;vd.ULS.sendTraceTag(537154264,0,50,"PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: {0}.",J.Sba);return Wc.Task.Sa(!0)};this.cNa=nf.EwaSettings.qc()?this.$.userOperationManager.jc(new Fb.a(223,0,Wa,80),null):this.$.userOperationManager.jc(new Xj.a(223,0,Wa,16),null)}};e.prototype.I0c=
function(){this.Yzf();this.Lxe()};e.prototype.IAd=function(J){uh.a.mr(J.Errors)?this.zg.showErrorMessageForPrintOptions(Ne.a.instance.ga(1240)):(vd.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.fyb(),this.zg&&this.zg.hideErrorMessageForPrintOptions())};e.prototype.UAd=function(J){this.zg&&this.zg.showErrorMessageForPrintOptions(Ne.a.instance.ga(1240));J=rj.a.ig(J.data);vd.ULS.sendTraceTag(537154262,0,10,"PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: {0}.",
uh.a.Tc(J))};e.prototype.gci=function(){function J(Pb,Cc,pd){var wd={};wd.WhatToPrint=ea.yk.Nv;wd.UseNamedAction=ea.mia.oxc();wd.SelectedSheetName=ea.$.xa.qa.name;wd.ActiveCell=ea.activeCell;wd.SelectedRanges=[ea.selectedRange];wd.IsPdfDocumentRequired=!1;wd.Orientation=ea.yk.orientation;wd.PaperSize=ea.yk.Cca;wd.Scaling=ea.yk.w0;wd.RichValuesEnabled=!0;wd.IgnorePrintArea=ea.yk.ignorePrintArea;wd.Preview=!0;ea.isUniversalPrintEnabled&&(wd.NoColor=ea.yk.NoColor);ea.J0f()&&(wd.PaginationStartPage=ea.Lya,
wd.PaginationEndPage=ea.tma,wd.OutputTotalPdfPageCount=!0);var ue=ea.qv.vfd(ea.yk.margin);ue&&(wd.PageMargin={},wd.PageMargin.Top=ue.Top,wd.PageMargin.Bottom=ue.Bottom,wd.PageMargin.Left=ue.Left,wd.PageMargin.Right=ue.Right,wd.PageMargin.Header=ue.Header,wd.PageMargin.Footer=ue.Footer);ea.w7a=U(ea.$.na.va,wd,fi.b(ea.bHi,Pb),fi.a(ea.aHi,Cc),pd,Wa);return ea.w7a}var ea=this;vd.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");
this.pY();var Wa=this.$.na.va.hc();nf.EwaSettings.qc()?this.cNa=this.$.userOperationManager.jc(new Fb.a(133,0,J,80),null):this.cNa=this.$.userOperationManager.jc(new Xj.a(133,0,J,16),null)};e.prototype.Lxe=function(){this.$.userOperationManager.Ul(this.Kz);this.pY();this.XSf();vd.ULS.shipAssertTag(537154261,0,!!this.zg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.zg&&(this.zg.saj(this.lzf),this.zg.Qfh(),this.zg=null);this.Tm=null;this.qv&&(this.qv.dispose(),
this.qv=null);this.U2a=this.xFb=null;this.iLc=!1;this.Pa&&this.Pa.raiseEvent("ppocek")};e.prototype.Suj=function(){return this.$.isEditMode&&!!this.AH&&!!this.yk&&2!==this.yk.Nv&&this.Lid()};e.prototype.QLd=function(){vd.ULS.shipAssertTag(537154260,0,!!this.qv,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.qv&&this.qv.QLd(this.yk,this.Suj())};e.prototype.AHa=function(J,ea){ea=void 0===ea?"Pdf":ea;var Wa=new Sys.StringBuilder;Wa.append(bk.a(this.$,ea,!0));Xh.a.eh(Wa,
eg.a.vFd,""+this.yk.Nv);J&&this.mia.oxc()&&Xh.a.eh(Wa,eg.a.xdg,"1");Xh.a.eh(Wa,eg.a.mJf,this.$.xa.qa.name);0===this.yk.Nv&&(Xh.a.eh(Wa,eg.a.lJf,this.selectedRange),Xh.a.eh(Wa,eg.a.fJf,this.activeCell));Xh.a.eh(Wa,eg.a.gJf,""+this.yk.orientation);Xh.a.eh(Wa,eg.a.hJf,""+this.yk.Cca);Xh.a.eh(Wa,eg.a.kJf,""+this.yk.w0);Xh.a.eh(Wa,eg.a.jJf,"1");Xh.a.eh(Wa,eg.a.eJf,this.yk.ignorePrintArea?"1":"0");Xh.a.eh(Wa,eg.a.iJf,"1");this.AJg(Wa);this.isUniversalPrintEnabled&&Xh.a.eh(Wa,eg.a.b1i,this.yk.NoColor?"1":
"0");this.zJg(Wa);zh.a.equals(ea,"Pdf",!0)&&(Wa.append("&#toolbar=0"),Wa.append("&zoom=100"));J=Wa.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");vd.ULS.sendTraceTag(537154259,0,50,"PrintPreviewManager: Print Pdf Url {0}",J);return J};e.prototype.Upj=function(J,ea){J||ea?(this.yyb=!0,this.Lya=J,this.tma=ea):this.iSf()};e.prototype.AJg=function(J){this.J0f()&&(Xh.a.eh(J,eg.a.d1i,""+this.Lya),Xh.a.eh(J,eg.a.c1i,""+this.tma),Xh.a.eh(J,eg.a.e1i,"1"),vd.ULS.sendTraceTag(537154258,
0,50,"PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from {0} to {1}",this.Lya,this.tma))};e.prototype.J0f=function(){return null!=this.Lya&&0<this.Lya&&null!=this.tma&&0<this.tma};e.prototype.zJg=function(J){if(this.qv&&this.yk){var ea=this.qv.vfd(this.yk.margin);ea&&Xh.a.eh(J,eg.a.a1i,""+ea.Top+" "+ea.Bottom+" "+ea.Left+" "+ea.Right+" "+ea.Header+" "+ea.Footer)}};e.prototype.WDb=function(J,ea,Wa,Pb){this.zg&&(vd.ULS.shipAssertTag(537154255,0,!!this.$.xa.qa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),
this.$.xa.qa&&(this.v6a?(Pb||(Pb=this.AHa(!1)),this.zg.vri(Pb)):this.Zyj()))};e.prototype.Lid=function(){return!this.AH.equals(this.yk)};e.prototype.Yzf=function(){!this.zMb&&0<this.a0&&(this.ppd?this.QLd():vd.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));vd.ULS.shipAssertTag(537154250,0,!!this.zg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.zg&&this.zg.d5h();this.mWd()};
e.prototype.si=function(){vd.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.zg){var J=this.Vza(Ne.a.instance.ga(1));this.Xna(J,1)}else J=uh.a.gd(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),nf.EwaSettings.Az()?new Gj.a(this.$,J):(new fj.ErrorDialog(this.$,J)).Af()};e.prototype.fzj=function(J){J?(0===J.Nv&&this.Pwc()&&(vd.ULS.sendTraceTag(537154249,0,50,"PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a ${0}.",
this.Tm.ObjectId?"floatingObject":"discontinuousRange"),J.Nv=1),D.NBe(J,this.AH),D.NBe(J,this.yk),vd.ULS.shipAssertTag(537154248,0,!!this.zg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),this.zg&&(this.ppd=!0,this.zg.hzj(),this.fyb())):(vd.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.si())};e.prototype.E_c=function(J,ea,Wa){J>ea&&(ea=Object(Ch.a)(new Vg.a,{extendedProperties:new Map}),ea.extendedProperties.set("WtpSelectedValue",
Wa),ea.extendedProperties.set("FullyRenderedPdfLoadTime",J.toString()),lh.Health.instance.recordQosError(Sj.a.aBj,[Ic.a.k4f],!1,!0,!0,!1,ea))};e.prototype.pY=function(){this.cNa&&(0<this.Sba||this.w7a)&&(vd.ULS.sendTraceTag(537154246,0,50,"PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: {0}.",this.Sba),this.$.userOperationManager.Ota(this.cNa),this.w7a?rj.a.yu(this.w7a.Pt):this.j3.yu(this.Sba),this.vKd())};e.prototype.vKd=function(){this.w7a=this.cNa=null};e.prototype.R9h=
function(){this.JJd&&this.yk&&(this.U2a=this.$.Pb.Gc("UserAction",(1===this.yk.Nv?"ActiveSheet":0===this.yk.Nv?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))};e.prototype.iSf=function(){this.yyb=!1;this.Lya=1;this.tma=this.IEd};e.prototype.Vza=function(J){if(J)return J.replace("&#39;","'");vd.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return J};e.prototype.Zyj=function(){vd.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");
if(this.Azb)if(this.Ygc)vd.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{var J=this.Vza(Ne.a.instance.ga(1194));this.Xna(J,2)}else J=this.Vza(Ne.a.instance.ga(1195)),this.Xna(J,3)};e.prototype.Xna=function(J,ea,Wa){this.zg.Wz(J,ea,void 0===Wa?null:Wa)};e.prototype.b$h=function(){this.Ygc=this.txe();this.Azb=this.rWg();this.v6a=this.sWg();vd.ULS.sendTraceTag(557061534,0,50,"PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentBrowser : {0}, isPdfPreviewSupportedInCurrentHost: {1}, isPdfPreviewSupportedInPreviewer: {2}",
this.Ygc,this.Azb,this.v6a)};e.prototype.yej=function(){this.t7a=null;this.vKd();this.iSf();this.xFb=this.$.Pb.Gc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.qa.activeCell.toString();this.a0=0;this.ppd=this.O5a=this.zMb=!1;this.iLc=!0};e.prototype.Rwj=function(){var J=this.cmi()||this.Qgf()&&nf.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!0:!1;vd.ULS.sendTraceTag(537154242,0,50,"PrintPreviewManager.ShouldUseMSPdfViewer : {0}",J);return J};e.prototype.txe=
function(){return!sg.a.lB};e.prototype.YVg=function(){var J=15;sg.a.JH&&sg.a.Csb&&(J=parseFloat(sg.a.Csb));return this.txe()&&14<J&&this.Azb};e.prototype.rWg=function(){return this.Qgf()&&!nf.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!1:!0};e.prototype.cmi=function(){return sg.a.RC||Ud.AFrameworkApplication.isUnifiedHostMode};e.prototype.sWg=function(){return this.Ygc&&this.Azb};e.prototype.Qgf=function(){return!this.$.Yf.get(111)};e.prototype.XSf=function(){this.t7a&&
(URL.revokeObjectURL(this.t7a),this.t7a=null)};e.prototype.m4g=function(J){var ea=J.data.ke;J=this.$.Pb.Gc("UserAction","PrintPreviewBlobFileCreation");var Wa=window.self.atob(ea);ea=new Uint8Array(ea.length);for(var Pb=0;Pb<Wa.length;Pb++)ea[Pb]=Wa.charCodeAt(Pb)&255;Wa=new Blob([ea],{type:"application/pdf"});this.t7a=URL.createObjectURL(Wa);vd.ULS.sendTraceTag(537154241,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : {0} ms. Blob size: {1}",J.Bc,Wa.size);
J.stop();return this.t7a+"#toolbar=0&zoom=100"};e.prototype.f5i=function(J){if(this.JJd&&uh.a.nh(J,e.WVi)){var ea=Object(Ch.a)(new Vg.a,{extendedProperties:new Map});ea.extendedProperties.set("ErrorMessageIdName",J[0].MessageIdName);lh.Health.instance.recordQosError(Sj.a.QHf,[Ic.a.RHf],!1,!0,!0,!1,ea)}};e.prototype.T3h=function(J,ea){return J.sheetPrintOptions.PrintGrid!==ea.selectedPrintGridlines||J.sheetPrintOptions.HorizontalCenter!==ea.selectedHorizontalCenter||J.sheetPrintOptions.VerticalCenter!==
ea.selectedVerticalCenter||J.sheetPrintOptions.PrintHeaders!==ea.selectedRowAndColumnHeadings};e.prototype.mWd=function(){this.opd&&this.$.Ud(-1753588160,-1,0,null)};e.prototype.Ldi=function(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier};e.prototype.getToken=function(){vd.ULS.sendTraceTag(522314589,0,50,"PrintPreviewManager:GetToken: Token requested for universal print graph service");return this.hyd.FS("Print",this.graphServiceEndpoint).then(function(J){return J?
(J.IsSuccess||vd.ULS.sendTraceTag(537154240,0,15,"PrintPreviewManager:GetToken: failed to get token. Error code: {0}, Error message : {1}",J.ErrorCode,J.ErrorMessage),vd.ULS.sendTraceTag(522314588,0,50,"PrintPreviewManager:GetToken: successfully acquired token for universal print graph service"),J):Object(Ch.a)(new dj.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})}).catch(function(J){var ea=new dj.a;Object.getType(J)===Object.getType(ea)?ea=J:(ea.ErrorMessage=J.toString(),
ea.ErrorCode="exception");return Promise.resolve(ea)})};e.prototype.S$b=function(){var J=this;return function(){var ea=Promise.resolve("");try{if(J.hyd&&J.hyd.C5a())return J.getToken().then(function(Wa){return Wa.IsSuccess?Promise.resolve(Wa.Token):ea},function(){return ea})}catch(Wa){vd.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token",Wa)}return ea}};e.prototype.onNotifyPrintJobStatus=function(J,ea){J=Bk.a.Sy.notificationBar.M$(J,
!1);"pending"==ea&&(J.displayTimeoutSeconds=3);if(nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactToast",!1))switch(ea){case "failure":J.image=1;break;case "success":J.image=3;break;default:J.image=0}else J.image=0;Bk.a.Sy.notificationBar.cE(J)};Ck.Object.defineProperties(e.prototype,{xji:{configurable:!0,enumerable:!0,get:function(){return this.iLc}}});e.WVi=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,
1348242499,2030854436,-1831476778];e.F$c=["Content-Type","Total-Pdf-PageCount"];Object(ee.a)(e,"PrintPreviewManager",null,[658,3,659]);c.prototype.$c=function(){return!1};c.prototype.executeCommand=function(J,ea,Wa,Pb){var Cc=ea.command;return 1588554917===Cc?(ea.Iyb=!0,mj.a(this.$)&&this.$.da.za(423).Gxc(!1),this.pgh(ea)?Wc.Task.Sa(!0):xi.a(Cc)):this.OHf.executeCommand(J,ea,Wa,Pb,this.VNi,this.UNi,this.dKj)};c.prototype.Mc=function(J,ea){return 1588554917===ea.command?(vd.ULS.shipAssertTag(537154305,
0,this.$.uka,"Command execute requested for Print operation when data duplication is disallowed."),!0):this.OHf.Mc(J,ea)};c.prototype.jd=function(){return!1};c.prototype.pgh=function(J){return this.$.ea.rc?this.qgh(J):!1};c.prototype.qgh=function(J){vd.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");var ea=this.$.Pb.Gc("UserAction","DoPrintHtml"),Wa=this.$,Pb=this.ea.isNamedObjectViewMode?Wa.Hb.qa.sheetName:Wa.xa.qa.name,Cc=this.ea.isNamedObjectViewMode,pd=!Cc;Wa=this.tTh(Wa,Pb,
pd);var wd=!0;!nf.EwaSettings.isChangeGateEnabled("OfficeVSO:5315453_MoveWebpartsSessionsToPreviewer")&&this.$.xwa&&(wd=!1);pd?wd?ai.a(this.$)?vd.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):(this.nD.ezj(Wa,this.SN),vd.ULS.sendTraceTag(591196515,0,50,"PrintCommandHandler:DoPrintHtml Print previewer opened")):((new G(this.$,Ne.a.instance.ga(1203),3,Wa,J,this.mia,Pb,this.SN)).Af(),vd.ULS.sendTraceTag(595194760,0,50,"PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in {0} ms.",
ea.Bc)):((new R(this.$,Ne.a.instance.ga(1203),3,Wa,J)).Af(),vd.ULS.sendTraceTag(591196514,0,15,"PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in {0} ms. isNamedObjectViewMode: {1}.",ea.Bc,Cc));ea.stop();this.Rhd();return!0};c.prototype.tTh=function(J,ea,Wa){var Pb={};Pb.SessionId=this.ea.sessionId;Pb.UsedRangeTooBig=!1;var Cc=wg.g(J),pd=Cc.ha,wd=pd.We;if(Jk.e(J.qa))Pb.Type=0,Pb.ObjectId=J.qa.name,Pb.UseSelection=!1;else if(Jk.g(J.qa))Pb.Type=1,Pb.ObjectId=J.qa.oLa,Pb.UseSelection=
!0;else if(2===wd||4===wd||64===wd)Cc=pd.Oa.nc.floatingObject,Pb.Type=1,Pb.SheetName=ea,Pb.ObjectId=Cc.id,Pb.UseSelection=!0;else if(Wa&&wd&470)Pb.ObjectId=pd.Oa.nc.floatingObject.id,Pb.SheetName=ea;else if(Jk.i(J.qa)){Pb.Type=2;Pb.SheetName=ea;if(pd.ta.Hg)if(Wa=pd.ta.qd,Pb.SelectedRanges=ze.q(Wa,J),20<Wa.eM)Pb.UseSelection=!0;else{ea=0;Cc=Cc.xk("PrintCommandHandler.DoPrintHtml",Wa);try{for(Cc.$$rst();Cc.$$mn()&&2>ea;)Cc.$$cu().text&&ea++;Pb.UseSelection=2<=ea}finally{Cc&&Cc.dispose()}}else Pb.UseSelection=
!1,Pb.SelectedRanges=ze.q(pd.ta.activeRange,J);this.ea.isNamedObjectViewMode&&(Pb.UsedRange=ze.v(J.qa.usedRange,J))}Pb.Title=J.workbookContext.WorkbookFileName;return Pb};c.prototype.Rhd=function(){wg.g(this.$);if(!this.S0f){this.MQc=!0;var J=this.$.Pb.Gc("UserAction","HandlePageLayoutRendering");this.vKj();vd.ULS.sendTraceTag(537154274,0,50,"PrintCommandHandler:HandlePageLayoutRendering rendering is done in {0} ms.",J.Bc);J.stop()}};c.prototype.vKj=function(){for(var J=wg.g(this.$).Ea,ea=J.XE(),
Wa=!1,Pb=0,Cc=0;Cc<ea.length;Cc++){var pd=ea[Cc],wd=pd.Df;wd&&wd.hasPageLayout()&&(Wa=!0,wd.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+pd.$d,4),Pb++)}Wa&&(vd.ULS.sendTraceTag(537154273,0,50,"PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is {0}, number of blocks that require re-rendering is {1}",ea.length,Pb),J.Qxd())};Ck.Object.defineProperties(c.prototype,{S0f:{configurable:!0,enumerable:!0,get:function(){return this.MQc}}});Object(ee.a)(c,"PrintCommandHandler",
null,[428,643]);var Zk=bh.a;Wl(a,Zk);a.prototype.Od=function(){var J=this,ea=Ud.AFrameworkApplication.fa.appSettings,Wa=this.$.ya.DirectPrintSetting;ea.DirectPrintIsEnabled=Wa.DirectPrintIsEnabled.toString();ea.DirectPrintProbeIsEnabled=Wa.DirectPrintProbeIsEnabled.toString();ea.DirectPrintEnabledForInternetExplorer=Wa.DirectPrintEnabledForInternetExplorer.toString();ea.DirectPrintSupportedMimeTypes=Wa.DirectPrintSupportedMimeTypes;ea.DirectPrintSupportedPlugins=Wa.DirectPrintSupportedPlugins;ea.DirectPrintImmersivePreviewPlugins=
Wa.DirectPrintImmersivePreviewPlugins;ea.DirectPrintMinimalSupportedEdgeVersion=Wa.DirectPrintMinimalSupportedEdgeVersion;ea.DirectPrintEnabledForEdge=Wa.DirectPrintEnabledForEdge.toString();ea=new Ea(ea);var Pb=null;Wa=null;try{Wa=window.navigator.mimeTypes}catch(wd){vd.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}var Cc=null;try{Cc=window.navigator.plugins}catch(wd){vd.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}Pb=new oa(ea,Wa,Cc,oa.Xbf,
oa.ugf,new za(Ud.AFrameworkApplication.sa.vX),Ud.AFrameworkApplication.sa.yD,oa.vgf,function(wd,ue){return new ka(wd,!1,ue)},!1);if(nf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.Yf.get(116)){var pd=ah.GetServiceTaskFactory.Xa(this.$.da,349,350,this.vb);wh.TaskExtensions.Ba(pd,function(){var wd=new c(J.$,Pb,pd.result);J.Cd([wd])},this.$.la)}else this.Cd([new c(this.$,Pb,null)])};a.ka=function(J){bh.a.ee(73,new a(J))};Object(ee.a)(a,"PrintCommandHandlerFactory",
bh.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Wd.a.Ji(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}");
Type.registerNamespace("CADWLTR");bf.main();Type.registerNamespace("Common.App.NewAndOpen.UX");Yg.a.instance.gj(new Ie);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Se.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SaveAsToHost");zf.main();Type.registerNamespace("Common.App.SaveToSharePoint");Bc.main();Type.registerNamespace("Common.App.SaveToCloudStorage");id.main();Type.registerNamespace("Common.App.SaveACopy");
Og.main();Type.registerNamespace("Common.App.SharedFilePicker");fg.main();Type.registerNamespace("Common.App.WildFire");Jf.main();rf.a.Fa(Dg.ka);rf.a.Fa(nh.ka);rf.a.Fa(xd.ka);Wd.a.Ji(".HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type=text]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type=radio]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type=radio]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;-webkit-transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-ms-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}");
rf.a.Fa(Wb.ka);Wd.a.Ji(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(function(){rf.a.Fa(function(J){ke.ka(J)})})();(function(){rf.a.Fa(function(J){J.da.Ga(165,new re(J))})})();rf.a.Fa(Kc.ka);(function(){rf.a.Fa(function(J){J.da.Ga(57,new $d(J));J.da.Ga(60,new mg(J));J.da.Ga(63,new Qf(J))})})();rf.a.Fa(rd.ka);rf.a.Fa(lf.ka);rf.a.Fa(Nd.ka);Wd.a.Ji(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}");
(function(){rf.a.Fa(function(J){Jd.ka(J);wc.ka(J)})})();Wd.a.Ji('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}');
Wd.a.Ji(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");(function(){rf.a.Fa(function(J){kd.ka(J);ma.ka(J)})})();rf.a.Fa(uc.ka);rf.a.Fa(Jb.ka);(function(){rf.a.Fa(function(J){Ha.ka(J);cb.ka(J)})})();rf.a.Fa(Ua.ka);rf.a.Fa(Hb.ka);(function(){rf.a.Fa(function(J){Ta.ka(J);Pa.ka(J)})})();rf.a.Fa(eb.ka);(function(){rf.a.Fa(function(J){va.ka(J);Ia.ka(J)})})();Type.registerNamespace("Common.App.DirectPrint");Yg.a.instance.gj(new xa);rf.a.Fa(a.ka)},916:function(y,
C,b){function a(V,aa){var E=ba.call(this,document.createElement("div"))||this;E.Hx=null;E.XS=null;E.r8=null;E.Uba=null;E.D2b=null;E.oje=null;E.Roe=null;E.Ljf=null;E.T4a=!1;E.ev=!1;E.LZ=!1;E.Pva=!1;E.lGi=function(G){E.ZC(G)};E.rGi=function(G){13===G.keyCode&&E.ZC(G)};E.xyd=function(G){E.Co(G.zb);return!0};E.Eyd=function(G){E.O_(G.zb);return!0};E.wnc=function(G){E.fma(G.zb?G.zb:0);return!0};E.mGi=function(G){E.ZC(G.Ca);return!0};E.sig=function(G){G=void 0===G?null:G;E.Co(G.inputMethod?G.inputMethod:
0);return!0};E.tig=function(G){G=void 0===G?null:G;E.O_(G.inputMethod?G.inputMethod:0);return!0};E.t1=V;E.FC=aa;E.wXc=aa.wGa.toString();E.title=aa.title;E.message=aa.message;E.set_visibilityMode(1);return E}b.d(C,"a",function(){return a});y=b(0);var c=b(7),e=b(15),f=b(91),l=b(230),n=b(13),m=b(109),h=b(204),x=b(86);C=b(243);var u=b(1242),w=b(19),v=b(5),t=b(334),z=b(54),D=b(12),A=b(72),B=b(14),N=b(22),P=b(87),Q=b(1107),M=b(1),ba=C.a;Wl(a,ba);a.prototype.dispose=function(){f.a.Dc([this.D2b,this.XS,this.r8]);
this.ev&&this.XS&&(l.a.instance.Aa(n.a.click,this.XS.domElement,this.xyd),m.KeyInputManager.instance.Jv(this.domElement,this.oje));this.LZ&&this.r8&&(l.a.instance.Aa(n.a.click,this.r8.domElement,this.Eyd),m.KeyInputManager.instance.Jv(this.domElement,this.Roe));this.Pva&&this.Uba&&(l.a.instance.Aa(n.a.click,this.Uba,this.wnc),m.KeyInputManager.instance.Jv(this.domElement,this.Ljf));this.Uba=this.Hx=this.t1=this.r8=this.XS=null;ba.prototype.dispose.call(this)};a.prototype.update=function(){};a.prototype.AOj=
function(){this.MDe(!0)};a.prototype.P2c=function(){this.MDe(!1)};a.prototype.x8g=function(){var V=this;this.message=P.a.gg(this.message);this.title=P.a.gg(this.title);h.UISurfaces.Med().then(function(aa){aa.initializeMessageBarInStore();var E=Object(c.a)(new Q.a,{messageTitle:V.title,message:V.message,isMultiline:!1,messageBarType:V.FC.ERg,closeable:!V.T4a,dismissButtonAriaLabel:B.a.instance.ga(10),onDismiss:V.mGi});if(V.Pva){var G={};E.linkProps=(G.type="AppLinkProps",G.text=V.linkText,G.onExecute=
V.wnc,G)}V.ev&&(G={},E.firstActionButtonProps=(G.type="AppButtonProps",G.label=V.actionButton,G.onExecute=V.sig,G));V.LZ&&(G={},E.secondActionButtonProps=(G.type="AppButtonProps",G.label=V.ZFa,G.onExecute=V.tig,G));aa.createNewMessageBar(V.domElement,E);return null},function(aa){e.ULS.sendTraceTag(524075914,0,10,"Business Bar could not be initialized",aa);return null});this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)};a.prototype.NDe=function(V){var aa="<div class='"+
u.a.Klh+"' id='{0}'><div class='"+u.a.Ilh+"'><a class='"+u.a.Qlh+"' title='{1}'><span class='"+w.a.B2b+" "+u.a.Mlh+"' id='{2}'>";this.Rk.length&&(aa+="<img class='{3}' src='{4}'/>");aa+="</span></a><span class='"+u.a.Plh+"' id='{5}'>{6}</span><span class='"+u.a.Olh+"' id='message'>{7}</span><a id='link' href='#' class='"+u.a.Nlh+"'>{8}</a><span class='"+u.a.aMe+"'><button type='button' id='action' class='"+u.a.$Le+"'>{9}</button></span><span class='"+u.a.aMe+"'><button type='button' id='altAction' class='"+
u.a.$Le+"'>{10}</button></span></div><a class='"+u.a.Llh+"' tabindex='0' role='button'><span id='close' class='"+w.a.YA+"'><img class='"+w.a.j9c+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";V||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var E=this.businessBar.$.Mb;V=E+"ewaBusinessBarEntryBody"+this.wXc;var G=E+"ewaBusinessBarEntryTitle"+this.wXc;E=E+"ewaBusinessBarEntryIcon"+this.wXc;this.domElement.className=u.a.Jlh;this.domElement.innerHTML=
String.format(aa,V,this.alt,E,this.Rk,z.a.gf(0),G,this.title,this.message,this.linkText,this.actionButton,this.ZFa,z.a.gf(13),B.a.instance.ga(791));D.DOMElementExtensions.tu(this.domElement,v.a.ksa,G,V);this.Uba=$get("link",this.domElement);D.DOMElementExtensions.setVisible(this.Uba,this.Pva);this.Pva&&(l.a.instance.pa(n.a.click,this.Uba,this.wnc),this.Ljf=m.KeyInputManager.instance.rs(this.Uba,this.wnc,x.a.ei,x.a.j1));this.XS=new t.a(D.DOMElementExtensions.getElementById(this.domElement,"action"));
this.XS.isVisible=this.ev;this.r8=new t.a(D.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.r8.isVisible=this.LZ;this.ev&&(l.a.instance.pa(n.a.click,this.XS.domElement,this.xyd),this.oje=m.KeyInputManager.instance.rs(this.XS.domElement,this.xyd,x.a.ei,x.a.j1),this.LZ&&(l.a.instance.pa(n.a.click,this.r8.domElement,this.Eyd),this.Roe=m.KeyInputManager.instance.rs(this.XS.domElement,this.Eyd,x.a.ei,x.a.j1)));this.Hx=$get("close",this.domElement);this.D2b=this.Ae.je(this.Hx);this.D2b.ka("click",
this.lGi);this.D2b.ka("keydown",this.rGi);D.DOMElementExtensions.setVisible(this.Hx,!this.T4a)};a.prototype.MDe=function(V){63==this.FC.wGa?this.NDe(V):M.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.x8g():this.NDe(V)};a.prototype.Co=function(){e.ULS.sendTraceTag(21517968,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnActionClick() for EntryName {1}",this.FC.hash,this.FC.f8c);N.g(this.businessBar.$).Gp(!0)};a.prototype.O_=function(){e.ULS.sendTraceTag(537170257,
0,50,"BusinessBar [{0}]: BusinessBarEntry.OnAltActionClick()",this.FC.hash);N.g(this.businessBar.$).Gp(!0)};a.prototype.fma=function(){e.ULS.sendTraceTag(537170256,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnLinkClick()",this.FC.hash);N.g(this.businessBar.$).Gp(!0)};a.prototype.ZC=function(V){e.ULS.sendTraceTag(21517971,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnCloseClick() for EntryName {1}",this.FC.hash,this.FC.f8c);this.set_visible(!1);this.businessBar.removeEntry(this.FRg);A.g(V)};Ck.Object.defineProperties(a.prototype,
{FRg:{configurable:!0,enumerable:!0,get:function(){return this.FC.wGa}},businessBar:{configurable:!0,enumerable:!0,get:function(){return this.t1}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.FC?this.FC.actionButton:""}},ZFa:{configurable:!0,enumerable:!0,get:function(){return this.FC?this.FC.ZFa:""}},linkText:{configurable:!0,enumerable:!0,get:function(){return this.FC?this.FC.link:""}},Rk:{configurable:!0,enumerable:!0,get:function(){return this.FC?this.FC.Rk:""}},alt:{configurable:!0,
enumerable:!0,get:function(){return this.FC?this.FC.alt:""}}});Object(y.a)(a,"BusinessBarEntry",C.a,[])},989:function(y,C,b){function a(R,Y,U,ha){var ta=I.call(this)||this;ta.CF=null;ta.oD=null;ta.wW=null;ta.Sw=null;ta.wGb=null;ta.BK=null;ta.Ijc=null;ta.GBb=null;ta.FBb=!1;ta.Fwa=!0;ta.zpc=null;ta.ewaAccessibilityManager=null;ta.HEd=null;ta.GEd=null;ta.KEd=null;ta.lnd=!1;ta.Jxf=function(){u.ULS.sendTraceTag(537154206,0,50,"PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: {0}",
ta.FBb);ta.FBb&&(ta.n5h(),ta.BK.style.visibility="visible",ta.Ijc?ta.Ijc.stop():u.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),ta.raiseEvent(a.pDb,new h(1)),ta.YNd(),ta.FBb=!1)};ta.$=R;ta.nD=Y;ta.j8g();ta.useMSPdfViewer=U;ta.isUniversalPrintEnabled=ha;return ta}function c(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}function e(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=
this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}function f(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}function l(R){this.zg=R}function n(R){this.zg=R}function m(R){this.zg=R}function h(R){var Y=Q.call(this)||this;Y.c_i=R;
return Y}b.r(C);y=b(0);var x=b(7),u=b(15),w=b(4);b(24);var v=b(408),t=b(38),z=b(51),D=b(12),A=b(130),B=b(1),N=b(14),P=b(22),Q=Sys.EventArgs;Wl(h,Q);Object(y.a)(h,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var M=b(272),ba=b(256);m.prototype.ai=function(){M.a(this.zg.$).IM(this.xe)||M.a(this.zg.$).ai(this)};m.prototype.b8=function(){M.a(this.zg.$).IM(this.xe)&&M.a(this.zg.$).Pz(this)};m.prototype.ph=function(R){return D.DOMElementExtensions.Ff(this.wc,R)};m.prototype.Aj=function(){this.zg.$.frame.Qe.fk(this.zg.$.frame.Qe.EE)};
m.prototype.Qj=function(){};m.prototype.eg=function(R,Y){return Y?!1:(this.zg.enterPrintPreviewHeaderFocusTrapZone(),!0)};Ck.Object.defineProperties(m.prototype,{xe:{configurable:!0,enumerable:!0,get:function(){return ba.a.THf}},wc:{configurable:!0,enumerable:!0,get:function(){var R=b(989).PrintPreviewPane;return document.getElementById(R.a_i)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(y.a)(m,"PrintPreviewHeaderKeyboardAccessibleSection",null,[415]);n.prototype.ai=
function(){M.a(this.zg.$).IM(this.xe)||M.a(this.zg.$).ai(this)};n.prototype.b8=function(){M.a(this.zg.$).IM(this.xe)&&M.a(this.zg.$).Pz(this)};n.prototype.ph=function(R){return D.DOMElementExtensions.Ff(this.wc,R)};n.prototype.Aj=function(){this.zg.$.frame.Qe.fk(this.zg.$.frame.Qe.EE)};n.prototype.Qj=function(){};n.prototype.eg=function(R,Y){return Y?!1:(this.zg.useMSPdfViewer?(R=document.getElementById(b(989).PrintPreviewPane.ECd))&&D.DOMElementExtensions.setFocus(R,!0):D.DOMElementExtensions.setFocus(this.zg.BK),
!0)};Ck.Object.defineProperties(n.prototype,{xe:{configurable:!0,enumerable:!0,get:function(){return ba.a.UHf}},wc:{configurable:!0,enumerable:!0,get:function(){var R=b(989).PrintPreviewPane;return this.zg.useMSPdfViewer?document.getElementById(b(989).PrintPreviewPane.ECd):document.getElementById(R.nFf)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(y.a)(n,"PrintPreviewKeyboardAccessibleSection",null,[415]);l.prototype.ai=function(){M.a(this.zg.$).IM(this.xe)||
M.a(this.zg.$).ai(this)};l.prototype.b8=function(){M.a(this.zg.$).IM(this.xe)&&M.a(this.zg.$).Pz(this)};l.prototype.ph=function(R){return D.DOMElementExtensions.Ff(this.wc,R)};l.prototype.Aj=function(){this.zg.$.frame.Qe.fk(this.zg.$.frame.Qe.EE)};l.prototype.Qj=function(){};l.prototype.eg=function(R,Y){return Y?!1:(this.zg.enterPrintSettingsTaskPaneFocusTrapZone(),!0)};Ck.Object.defineProperties(l.prototype,{xe:{configurable:!0,enumerable:!0,get:function(){return ba.a.XHf}},wc:{configurable:!0,enumerable:!0,
get:function(){var R=b(989).PrintPreviewPane;return document.getElementById(R.JEd)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(y.a)(l,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[415]);Object(y.a)(f,"MSPdfViewerFileUrl",null,[]);Object(y.a)(e,"PrintSettingsTaskPaneProps",null,[]);Object(y.a)(c,"ViewerPaneProps",null,[]);var V=b(1255),aa=b(395),E=b(5),G=b(1256);b.d(C,"PrintPreviewPane",function(){return a});var I=t.a;Wl(a,I);a.prototype.mFg=function(R){this.addHandler(a.pDb,
R)};a.prototype.saj=function(R){this.removeHandler(a.pDb,R)};a.prototype.gzj=function(){this.e8g()};a.prototype.hzj=function(){var R=this.$.Pb.Gc("UserAction","createSettingsPaneStopwatch"),Y=document.getElementById(a.JEd);this.k8g();var U=this.l8g();this.oD.createPrintSettingsTaskPane(Y,U);R.stop();this.FBb=!1;if(this.isUniversalPrintEnabled&&this.Sw){R="A4";switch(U.selectedPrintSettingsValues.selectedPaperSize){case 8:R="A3";break;case 9:R="A4";break;case 11:R="A5";break;case 12:R="JIS B4";break;
case 13:R="JIS B5";break;case 5:R="North America Legal";break;case 1:R="North America Letter";break;case 6:R="North America Invoice";break;case 7:R="North America Executive";break;case 3:R="North America Ledger"}this.CF.setDocumentSettings({mediaSize:R,orientation:2===U.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===U.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.pHd()};a.prototype.setPageRangeSettings=function(R,Y,U,ha,ta){this.oD&&
(this.oD.setPageRangeSettings(R,Y,U,ha,ta),this.yZf(String.format(N.a.instance.Bb(196),ha,ta,R)))};a.prototype.d5h=function(){this.Sw&&(this.Sw.style.display="none")};a.prototype.Qfh=function(){this.dispose();this.jXd();this.uMj();this.CF&&this.CF.closePrintPreviewPane();this.wW=this.oD=this.CF=this.Sw=null};a.prototype.vri=function(R){u.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.GBb=this.$.Pb.Gc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||
u.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.wW.renderPdf(R)):this.BK&&((this.Ijc=this.$.Pb.Gc("UserAction","loadPdfStopwatch"))||u.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.FBb=!0,this.BK.src&&this.BK.src===R?this.Jxf(null):this.BK.src=R);if(this.isUniversalPrintEnabled&&this.Sw){var Y=aa.b(this.$.workbookContext);this.CF.setFileUrl(R,Y)}};a.prototype.onPdfLoad=function(){this.GBb?
(u.ULS.sendTraceTag(537154208,0,50,"PrintPreviewPane:onPdfLoad - Rendering time : {0} ms, isFirstTimeLoad: {1}",this.GBb.Bc,this.Fwa),this.GBb.stop()):u.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(a.pDb,new h(1));this.hideWaitCursor();this.YNd()};a.prototype.printPdf=function(){D.DOMElementExtensions.setFocus(this.BK);this.BK.contentWindow.print()};a.prototype.Wzj=function(){this.showSpinner();this.showWaitCursor();this.yZf("")};
a.prototype.n5h=function(){this.hideSpinner();this.hideWaitCursor()};a.prototype.Wz=function(R,Y,U){this.Sw&&this.wW&&(this.lnd=!1,this.wW.showErrorDetails(Y,R,void 0===U?null:U),this.nD.O5a=!0,this.BK&&(this.BK.src=""),this.disablePrintButton(),this.hideWaitCursor(),a.hji(Y)&&(this.lnd=!0,this.YNi()))};a.prototype.hidePreviewError=function(){this.nD.O5a=!1;this.wW.hidePreviewError();this.enablePrintButton()};a.prototype.Hfh=function(){(this.wGb=document.getElementById(a.VHf))&&this.wGb.parentNode&&
this.wGb.parentNode.removeChild(this.wGb)};a.prototype.hideErrorMessageForPrintOptions=function(){this.oD&&this.oD.hideErrorMessageForPrintOptions()};a.prototype.showErrorMessageForPrintOptions=function(R){this.oD&&this.oD.showErrorMessageForPrintOptions(R)};a.prototype.showSpinner=function(){this.nD.O5a||B.EwaSettings.isChangeGateEnabled("OfficeVSO:5547045_ShowLoadingIconOnSettingsChange")&&this.lnd?this.hidePreviewError():this.BK&&(this.BK.style.visibility="hidden");this.wW&&this.wW.showSpinner()};
a.prototype.hideSpinner=function(){this.wW&&this.wW.hideSpinner()};a.prototype.enablePrintButton=function(){this.oD&&this.oD.enablePrintButton();this.isUniversalPrintEnabled&&this.Sw&&this.CF.updatePrintButtonEnableDisableState(!0)};a.prototype.disablePrintButton=function(){this.oD&&this.oD.disablePrintButton();this.isUniversalPrintEnabled&&this.Sw&&this.CF.updatePrintButtonEnableDisableState(!1)};a.prototype.showWaitCursor=function(){this.oD&&this.oD.showWaitCursor();this.isUniversalPrintEnabled&&
this.Sw&&this.CF.updatePrintButtonEnableDisableState(!1)};a.prototype.hideWaitCursor=function(){this.oD&&this.oD.hideWaitCursor();this.isUniversalPrintEnabled&&this.Sw&&this.CF.updatePrintButtonEnableDisableState(!0)};a.prototype.h8g=function(){if(this.Sw)u.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.Sw=document.createElement("div"),this.Sw.id=a.VHf,this.Sw.classList.add(a.d_i),this.$.lr.insertBefore(this.Sw,
this.$.lr.firstChild),w.AFrameworkApplication.sa&&w.AFrameworkApplication.sa.Qa.Vg){var R=document.getElementById(E.a.cGa);R&&(this.Sw.style.top=R.clientHeight+"px",this.Sw.style.height="calc(100% - "+R.clientHeight+"px)")}};a.prototype.enterPrintPreviewHeaderFocusTrapZone=function(){this.CF.enterPrintPreviewHeaderFocusTrapZone()};a.prototype.enterPrintSettingsTaskPaneFocusTrapZone=function(){this.CF.enterPrintSettingsTaskPaneFocusTrapZone()};a.prototype.NXi=function(){var R=this;this.$.da.$a(15,
function(Y){R.ewaAccessibilityManager=Y;R.ewaAccessibilityManager.mode=3})};a.prototype.j8g=function(){this.KEd=new l(this);this.HEd=new n(this);this.GEd=new m(this)};a.prototype.pHd=function(){this.KEd.ai();this.HEd.ai();this.GEd.ai();this.NXi()};a.prototype.jXd=function(){this.KEd.b8();this.HEd.b8();this.GEd.b8();P.g(this.$).G0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)};a.prototype.$N=function(){this.zpc=A.a.instance.je(this.BK);this.zpc.ka("load",this.Jxf)};a.prototype.uMj=
function(){this.zpc&&this.BK&&this.zpc.detach("load")};a.prototype.YNd=function(){this.isUniversalPrintEnabled?this.BYf(a.b_i,a.FBi):this.BYf(a.JEd,a.PHf)};a.prototype.BYf=function(R,Y){this.Fwa&&(R=document.getElementById(R))&&(Y=D.DOMElementExtensions.getElementById(R,Y))&&(this.Fwa=!1,Y.focus())};a.prototype.YNi=function(){this.nD.O5a=!1;this.enablePrintButton();this.YNd()};a.prototype.e8g=function(){var R=this;if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:6068952_FixJSCrahInPrintPreview")){var Y=
z.GetServiceTaskFactory.Xa(this.$.da,283,284,0).result.Fn;Y.loadScript("excel-print-preview-sprite").then(function(){Y.loadScript("printPreviewer").then(function(){Y.loadScript("excelPrintPreviewer").then(function(){R.VDe()})},function(){u.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},function(){u.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}else z.GetServiceTaskFactory.Xa(this.$.da,
283,284,0).result.Fn.loadScript("excelPrintPreviewer").then(function(){R.VDe()})};a.prototype.VDe=function(){var R=this,Y=this.$.Pb.Gc("UserAction","createEmptyPreviewerStopwatch");this.h8g();this.i8g();this.isUniversalPrintEnabled?this.CF.createEmptyPrintPreviewPaneAsync(this.Sw,this.UDe()).then(function(){Y.stop();R.BAe();R.CF.updatePrintButtonEnableDisableState(!1)}):(this.CF.createEmptyPrintPreviewPane(this.Sw,this.UDe()),Y.stop(),this.BAe())};a.prototype.BAe=function(){var R=this.$.Pb.Gc("UserAction",
"createPdfPreviewPaneStopwatch"),Y=document.getElementById(a.ECd);this.useMSPdfViewer&&(Y.tabIndex=0);this.S7g();this.R7g(Y);R.stop();this.raiseEvent(a.pDb,new h(0))};a.prototype.i8g=function(){this.CF||(this.CF=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.CF||u.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")};a.prototype.k8g=function(){this.oD||(this.oD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());
this.oD||u.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")};a.prototype.S7g=function(){this.wW||(this.wW=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.wW||u.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")};a.prototype.R7g=function(R){this.wW.createPrintPreviewPane(R,this.v$g());this.useMSPdfViewer||
(this.BK=D.DOMElementExtensions.getElementById(this.Sw,a.nFf),this.BK.title=N.a.instance.ga(1191),this.$N())};a.prototype.l8g=function(){var R="en-US";var Y=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?R=this.$.ya.DataCultureTag:u.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object(x.a)(new e,{whatToPrintOptions:this.nD.qv.whatToPrintOptions,orientationOptions:this.nD.qv.orientationOptions,
paperSizeOptions:this.nD.qv.paperSizeOptions,scalingOptions:this.nD.qv.scalingOptions,marginDetailedOptions:this.nD.GQh(),selectedPrintSettingsValues:this.nD.ATh(),printSettingsTaskPaneCallbacks:this.nD.yTh(),logger:new v.a,shouldDisableCurrentSelection:this.nD.Pwc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:Y,dataCultureTag:R,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})};a.prototype.UDe=function(){return this.isUniversalPrintEnabled?this.nD.wTh():Object(x.a)(new V.a,{backActionButtonText:N.a.instance.ga(1189),
printPreviewPaneCallbacks:this.nD.x0e(),logger:new v.a,disableTellMeControl:!0})};a.prototype.v$g=function(){var R=this;return this.useMSPdfViewer?Object(x.a)(new c,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.f7g(),onPdfLoad:function(){R.onPdfLoad()}}):Object(x.a)(new c,{useMSPdfViewer:!1})};a.prototype.f7g=function(){return Object(x.a)(new f,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})};
a.prototype.yZf=function(R){this.Sw&&this.CF.setAdditionalHeaderText(R)};a.hji=function(R){return 3===R||2===R};a.VHf="PrintPreviewerContainer";a.JEd="printSettingsTaskPaneId";a.ECd="previewId";a.nFf="printpreviewiframe";a.a_i="printPreviewHeaderId";a.PHf="printButton";a.b_i="printPreviewPaneId";a.FBi="printButtonId";a.d_i=G.a.Sw;a.pDb="pppnosu";Object(y.a)(a,"PrintPreviewPane",t.a,[684])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kmhv.js.map/3f51b8398dce51bc3faeb3cd3881315f/EwaDS.kmhv.js.map