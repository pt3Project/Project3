(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1315:function(y,C,b){function a(za,La,Ia,Ya){var tb=ka.call(this)||this;tb.isMac=m.a.isMac;tb.bYa=-1;tb.X4b=null;tb.wta=-1;tb.mse=!1;tb.r_=!1;tb.NRd=!1;tb.Hic=!1;tb.eN=!1;tb.gU=null;tb.Jg=function(){tb.pwa&&tb.gridView&&tb.nX()};tb.Zc=function(){tb.ay()};tb.xd=function(){tb.tHa();G.g(tb.$).eg(!0,!1)};tb.p6=function(va,la){la?(tb.gbg(tb.X4b),tb.ldb()):(va=[29],tb.gridView.Db.Oh(va),tb.gridView.Db.vj(null,va),tb.gU&&tb.gU.Z6e())};
tb.ej=function(){tb.p6a()&&tb.Zh.hide();1===tb.gridView.ha.We&&tb.nX()};tb.CR=function(){var va=tb.gridView.ha.We;tb.gridView.ha.ta.activeCell&&1===va&&tb.nX()};tb.onKeyUp=function(va){return tb.pBb?tb.r_?!1:17===va.Ca.keyCode&&tb.NRd?(tb.eN?(tb.ldb(),tb.vda()):tb.pKb(),!0):!1:tb.r_=!1};tb.onKeyDown=function(va){if(!tb.pBb)return tb.r_=!1;tb.NRd=!1;tb.r_=va.ctrlKey;switch(va.Ca.keyCode){case 27:return tb.eN?(tb.p6(null,!1),tb.vda()):tb.gU&&(tb.gU.Z6e(),tb.pKb()),!0;case 13:if(tb.eN)return tb.eN=!1,
tb.tHa(),!0;break;case 17:return tb.NRd=!0}return!1};var Tb=b(1389).AutoDetectActionButton;tb.$=za;tb.rob=V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);La||n.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");tb.convertToLinkedEntityManager=Ya;Ya.F$a();tb.Zh=new Tb(za,La,tb.xd,Ia,"");tb.gMg=new c(tb.$,Ya);tb.gridView=G.g(tb.$);tb.gridView.ha.EP(tb.Jg);tb.gridView.pc.tYa(tb.Jg);tb.gridView.Mt(tb.CR);
za.cl(tb.Zc);za.GA(tb.ej);tb.gridBlockManager=Object(u.a)(387,tb.gridView.Ea);tb.vr=za.frame.zt;tb.nX();return tb}function c(za,La){var Ia=R.call(this)||this;Ia.$=za;Ia.gridView=G.g(za);Ia.convertToLinkedEntityManager=La;Ia.c1c=new I.a;return Ia}function e(za,La){var Ia=ba.call(this)||this;Ia.xd=function(Ya){if(Ya.Lb.id===Ia.tIa.firstChild.id){Ya=Ia.lse;var tb={};tb.Id=Ya.qob;Ia.convertToLinkedEntityManager.m2c(tb,!0,Ya);Ia.tIa.removeChild(Ia.tIa.firstChild);return!0}return!1};Ia.lse=za;Ia.convertToLinkedEntityManager=
La;Ia.tIa=document.createElement("div");Ia.tIa.className="clip16x16";Ia.hwa=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',N.a.vg("autodetectid"+Ia.lse.left),Q.a.i9c,M.a.gf(11));Ia.tIa.innerHTML=Ia.hwa;za=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");P.a.instance.pa(x.a.click,za,Ia.xd);return Ia}function f(za,La){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=
this.cardViewManager=null;this.$=La;this.parentElement=za}y=b(0);var l=b(7),n=b(15),m=b(24),h=b(91),x=b(13),u=b(85),w=b(437),v=b(77),t=b(9),z=b(65),D=b(489);f.prototype.g4g=function(){var za=this,La=this.h4g();D.a(this.$,243,242,0,function(Ia){za.cardViewManager=Ia;Ia.m2f(za.parentElement,2,La)})};f.prototype.Z6e=function(){this.cardViewManager&&this.cardViewManager.YKa(-1,-1,this.parentElement)};f.prototype.h4g=function(){var za={layoutId:"AutoDetectTooltip"};za.description=this.longDescription;
za.convertToDomainName=this.convertToDomainName;za.longDescription=this.longDescription;za.urlValue=this.urlValue;za.imageAltText=this.imageAltText;za.helpText=this.helpText;za.helpId=this.helpId;return za};Object(y.a)(f,"AutoDetectCardManager",null,[]);var A=b(31),B=b(216),N=b(29),P=b(230),Q=b(19),M=b(54),ba=v.a;Wl(e,ba);e.prototype.dispose=function(){if(this.tIa){var za=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");P.a.instance.Aa(x.a.click,za,this.xd)}ba.prototype.dispose.call(this)};
Ck.Object.defineProperties(e.prototype,{domElement:{configurable:!0,enumerable:!0,get:function(){return this.tIa}}});Ck.Object.defineProperties(e,{IRg:{configurable:!0,enumerable:!0,get:function(){return"clip16x16"}}});Object(y.a)(e,"AutoDetectColumnHeaderButton",v.a,[]);var V=b(1),aa=b(1258),E=b(10),G=b(22),I=b(170),R=v.a;Wl(c,R);c.prototype.dispose=function(){R.prototype.dispose.call(this)};c.prototype.nfh=function(za){for(var La=Gl(this.gridView.l3),Ia=La.next();!Ia.done;Ia=La.next()){Ia=Gl(Ia.value);
for(var Ya=Ia.next();!Ya.done;Ya=Ia.next()){Ya=Ya.value;var tb=Ya.Sn,Tb=aa.a(Ya.P4);this.aAg(za,Tb,tb);Ya.fOd(Tb)}}};c.prototype.aAg=function(za,La,Ia){if(La.length){var Ya=Ia.length;Ia[Ya-1]<za.left||(Ia=E.HelperMethods.Ax(new B.a(Ia),0,Ya,za.left,E.HelperMethods.XC),0>Ia||!(La=La[Ia]))||(this.gridView.rtl?La.classList.add(A.a.qth):La.classList.add(A.a.pth),this.c1c.yb(za.left)||this.c1c.add(za.left,new e(za,this.convertToLinkedEntityManager)),za=this.c1c.oa(za.left).domElement,!La.getElementsByClassName(e.IRg).length&&
this.HBj(La)&&La.appendChild(za))}};c.prototype.HBj=function(za){var La=parseInt(za.style.width,10),Ia=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";Ia=c.R5g(Ia);za=gridRenderer.CanvasRendererGlobals.measureTextWidth(za.firstChild.innerHTML,Ia,!0,V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<La-(La/2+za/2)?!0:!1};c.R5g=function(za){return String.format("{0} {1} {2} {3}/{4} {5}","normal","normal",za,"10pt","normal",'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif')};
Object(y.a)(c,"AutoDetectColumnHeaderManager",v.a,[]);var Y=b(456),U=b(25),ha=b(63),ta=b(151),xa=b(12),oa=b(14),qa=b(187),Ea=b(78);b.d(C,"a",function(){return a});var ka=v.a;Wl(a,ka);a.prototype.dispose=function(){this.gridView&&this.gridView.ha.RW(this.Jg);if(this.$){var za=this.$;za.tm(this.Zc);za.rD(this.ej);G.g(za).Ww(this.CR)}h.a.Ha(this.Zh);this.vr=this.$=this.gridView=this.Zh=null;ka.prototype.dispose.call(this)};a.prototype.ay=function(){this.p6(null,!1);this.bYa=-1;this.Zh.hide();this.LMj();
this.eN=!1};a.prototype.vda=function(){this.Zh.getButton(a.yea).vbb();this.eN=!1};a.prototype.pKb=function(){this.Zh.getButton(a.yea).VFb();this.gbg(this.X4b);this.eN=!0;this.$.da.$a(211,function(za){za.GPa(oa.a.instance.ga(1723))})};a.prototype.onAutoDetectUIShown=function(){if(this.pwa&&-1!==this.bYa)this.convertToLinkedEntityManager.onAutoDetectUIShown()};a.prototype.hMg=function(za){var La=new U.Range(1===za.top?1:za.top-1,za.left,za.bottom,za.right,!0,!1);La=this.gridView.getRangeInformation(La);
La=Gl(La);for(var Ia=La.next();!Ia.done;Ia=La.next())if(Ia=Ia.value,Object(w.a)(Y.AutoDetectRange,Ia)&&this.ufc(za,!1,Ia))return!0;return!1};a.prototype.tHa=function(){if(this.pwa&&-1!==this.bYa){this.Zh.getButton(a.yea).VFb();var za={};za.Id=this.wta;za.StringId=null;this.convertToLinkedEntityManager.m2c(za,!0,this.X4b);n.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");za=[Object(l.a)(new Ea.a,{name:"Domain",int64:this.wta})];qa.a("AssistedAutoConvertMenuConvertClicked",
void 0,void 0,za);this.wta=-1}};a.prototype.vIh=function(){var za=oa.a.instance.ga(1719);if(-1!==this.wta){za+=" ";try{za+=this.convertToLinkedEntityManager.HAb(this.wta.toString())}catch(La){n.ULS.sendTraceTag(537166982,0,10,"AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain {0}",this.wta)}}za+=" ";return za=this.rob?za+oa.a.instance.ga(1722):za+oa.a.instance.ga(this.isMac?1721:1720)};a.prototype.ldb=function(){this.rob&&(this.gU||(this.gU=new f(this.wc,this.$),this.gU.convertToDomainName=
oa.a.instance.ga(1724),this.gU.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.gU.imageAltText=oa.a.instance.ga(1726),this.gU.helpId="HID_DataTypes_Wolfram",this.gU.helpText=oa.a.instance.ga(1725)),this.gU.longDescription=this.convertToLinkedEntityManager.FVd(this.bYa.toString()),this.gU.g4g())};a.prototype.ufc=function(za,La,Ia){if((new U.Range(Ia.top,Ia.left,Ia.bottom===t.a.Hh?Ia.bottom:Ia.bottom+1,Ia.right,!0,!1)).Ed(za)){if(La){if(Ia&&Ia.qob!==
this.bYa){this.bYa=Ia.qob;za=Ia.qob.toString();La=this.rob?"":this.convertToLinkedEntityManager.FVd(za);var Ya=this.convertToLinkedEntityManager.n6h(za);this.Zh.afb(this.convertToLinkedEntityManager.HAb(za),La,Ya,a.yea)}this.wta=Ia.qob;this.X4b=Ia}return!0}return!1};a.prototype.nX=function(){if(this.convertToLinkedEntityManager){var za=this.gridView.ha.We;if(this.gridBlockManager&&this.gridBlockManager.nid){var La=this.gridView.ha.ta.activeCell,Ia=!this.gridBlockManager.cs(La),Ya=this.gridView.getRangeInformation(this.gridView.Gh);
Ya=Gl(Ya);for(var tb=Ya.next();!tb.done;tb=Ya.next())if(tb=tb.value,Object(w.a)(Y.AutoDetectRange,tb))switch(tb.WWg){case 3:if(this.ufc(La,!0,tb)){if(1!==za||Ia){this.ay();return}n.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.oHd();this.Zh.CAa(La,this.p6);this.mse||(this.mse=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(V.EwaSettings.ma(474)||V.EwaSettings.ma(475))&&this.gMg.nfh(tb);break;default:n.ULS.sendTraceTag(537166980,
0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.ay()}};a.prototype.gbg=function(za){var La=[29];this.gridView.Db.vj(za,La);this.gridView.Db.Cn(La)};a.prototype.p6a=function(){return this.$.ea.isNamedObjectViewMode&&ha.f(this.$.qa)};a.prototype.oHd=function(){this.rob&&!this.Hic&&this.vr&&(this.vr.xt(x.a.Xb,this.$.domElement,this.onKeyDown,!0),this.vr.xt(x.a.Vd,this.$.domElement,this.onKeyUp,!0),this.Hic=!0)};a.prototype.LMj=function(){this.rob&&
this.Hic&&this.vr&&(this.vr.Dt(x.a.Xb,this.$.domElement,this.onKeyDown,!0),this.vr.Dt(x.a.Vd,this.$.domElement,this.onKeyUp,!0),this.Hic=!1)};a.AKh=function(za){return oa.a.instance.ga(1780)+z.a.space+za};Ck.Object.defineProperties(a.prototype,{wc:{configurable:!0,enumerable:!0,get:function(){return this.Zh.domElement(1)}},pBb:{configurable:!0,enumerable:!0,get:function(){var za=this.Zh.domElement(a.yea);return za?xa.DOMElementExtensions.isVisible(za):!1}},pwa:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&
V.EwaSettings.ma(136)&&V.EwaSettings.ma(139)&&(new ta.a(this.$.xa)).tj?!1:-1!==this.wta}}});Ck.Object.defineProperties(a,{yea:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(y.a)(a,"AutoDetectManager",v.a,[])},1389:function(y,C,b){function a(m,h,x,u,w){var v=n.call(this)||this;v.$=m;v.Tp=u.C4b(m,h,x,"",e.a.gf(11),w,"AutoDetectPointerDown",f.a.instance.ga(1780)+"...");return v}b.r(C);b.d(C,"AutoDetectActionButton",function(){return a});y=b(0);C=b(77);var c=b(1315),e=b(54),f=b(14),
l=b(22),n=C.a;Wl(a,n);a.prototype.dispose=function(){this.Tp.dispose();this.$=null;n.prototype.dispose.call(this)};a.prototype.domElement=function(m){return this.Tp.domElement(m)};a.prototype.getButton=function(m){return this.Tp.getButton(m,!1)};a.prototype.afb=function(m,h,x,u){this.Tp.ATa(c.a.AKh(m),h,u);this.Tp.acg(x,h,u)};a.prototype.CAa=function(m,h){var x=l.g(this.$),u=x.rb.qj(m);m=x.tg(m,u);var w=x.Uf(u).wn;if(m&&0<=m.x&&0<=m.y&&w.width>m.width+160){var v=m.bottomRight.x+this.sz,t=m.topLeft.y+
this.sz,z=!1;v+160>w.bottomRight.x&&(v=m.topLeft.x-this.sz,z=!0);if(t<w.topLeft.y+this.sz){if(x.rb.aTa){this.hide();return}t=w.topLeft.y+this.sz}this.Tp.A7b(h,u);this.Fp(v,t,x.rtl,u,z)}else this.hide()};a.prototype.Fp=function(m,h,x,u,w){this.Tp.Fp(m,h,x,u,!1,w)};a.prototype.hide=function(){this.Tp.hide()};Ck.Object.defineProperties(a.prototype,{sz:{configurable:!0,enumerable:!0,get:function(){return this.Tp.sz}}});Object(y.a)(a,"AutoDetectActionButton",C.a,[])},1467:function(y,C,b){function a(xa){var oa=
ha.call(this)||this;oa.vi=null;oa.jh=null;oa.$=xa;oa.Tb();return oa}function c(xa,oa,qa){var Ea=U.call(this,xa)||this;Ea.xu=0;Ea.Kp=!1;Ea.Zc=function(){Ea.lg(!1)};Ea.$=oa;Ea.taskPaneManager=qa;ba.a(oa).ai(Ea);Ea.$.cl(Ea.Zc);V.a.Ld(Ea.$)&&(Ea.isVisible=!1);return Ea}function e(xa){var oa=Q.call(this)||this;oa.$=xa;oa.Tb();return oa}function f(xa){return A.call(this,xa)||this}function l(xa,oa){this.$=oa;this.convertToLinkedEntityManager=xa}b.r(C);y=b(0);var n=b(903),m=b(15),h=b(5),x=b(79),u=b(37),w=
b(1),v=b(186),t=b(22),z=b(187);l.prototype.$c=function(xa,oa){switch(oa){case -1203788282:case 48568533:case -1662108744:return xa=t.g(this.$),oa=this.convertToLinkedEntityManager.myi||7E3,(null===xa||void 0===xa?0:xa.ha)&&xa.ha.ta.qd.eM>oa?!0:!1;default:return!1}};l.prototype.executeCommand=function(xa,oa,qa){xa=u.TaskExtensions.sk();oa=oa.command;switch(oa){case -1203788282:this.convertToLinkedEntityManager.F2g(qa[x.a.kd].toString());break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();
break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(qa[x.a.kd].toString());break;case 1266950951:this.convertToLinkedEntityManager.xpi();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();break;case -1081442996:w.EwaSettings.ma(654)&&this.convertToLinkedEntityManager.wKe();
break;case 1702917262:w.EwaSettings.ma(654)&&this.convertToLinkedEntityManager.showHelpArticle(h.a.cOj);break;case -90814711:w.EwaSettings.ma(654)&&this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===oa||qa[x.a.sjf]&&"ConvertToLinkedEntityGallery"===qa[x.a.sjf].toString())m.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),z.a("ExpandDataTypeGallery");
break;default:xa=v.a(oa)}return xa};l.prototype.Mc=function(xa,oa){switch(oa.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return w.EwaSettings.ma(131);case -1081442996:case 1702917262:case -90814711:return w.EwaSettings.ma(654);case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;default:return!1}};l.prototype.jd=function(xa,oa,qa){return"PopulateConvertToLinkedEntityMenu"===oa&&w.EwaSettings.ma(131)?this.convertToLinkedEntityManager.jd(xa,
oa,qa):!1};Object(y.a)(l,"ConvertToLinkedEntityCommandHandler",null,[428]);var D=b(489),A=n.a;Wl(f,A);f.prototype.Od=function(){var xa=this;D.a(this.$,271,272,this.vb,function(oa){xa.Cd([new l(oa,xa.$)])})};f.ka=function(xa){n.a.ee(273,new f(xa))};Object(y.a)(f,"ConvertToLinkedEntityCommandHandlerFactory",n.a,[]);C=b(229);var B=b(967),N=b(51),P=b(438),Q=C.a;Wl(e,Q);e.prototype.create=function(){var xa=this,oa=N.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.vb),qa=N.GetServiceTaskFactory.Xa(this.$.da,
5,4,this.vb),Ea=N.GetServiceTaskFactory.Xa(this.$.da,388,387,this.vb);if(this.$.Ml)u.TaskExtensions.Ba(u.TaskExtensions.te([oa,qa,Ea],this.la),function(){xa.Eb(xa.$.da.za(271)||new B.ConvertToLinkedEntityManager(xa.$,oa.result,Ea.result,null,null,qa.result))},this.$.la,3);else{var ka=N.GetServiceTaskFactory.Xa(this.$.da,257,258,this.vb),za=P.a(this.$);u.TaskExtensions.Ba(u.TaskExtensions.te([oa,ka,za,qa,Ea],this.la),function(){xa.Eb(xa.$.da.za(271)||new B.ConvertToLinkedEntityManager(xa.$,oa.result,
Ea.result,ka.result,za.result,qa.result))},this.$.la,3)}};e.ka=function(xa){xa.da.Ga(272,new e(xa))};Object(y.a)(e,"ConvertToLinkedEntityManagerFactory",C.a,[]);var M=b(243),ba=b(272),V=b(36),aa=b(256),E=b(12),G=b(911),I=b(19),R=b(67),Y=I.a.Ysh,U=M.a;Wl(c,U);c.prototype.BP=function(xa){this.get_events().addHandler("EnrichmentTaskPaneRemoved",xa)};c.prototype.aS=function(xa){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",xa)};c.prototype.gE=function(xa){this.addHandler("EnrichmentTaskPaneVilibilityChanged",
xa)};c.prototype.NF=function(xa){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",xa)};c.prototype.sFg=function(xa){this.addHandler("EnrichmentTaskPaneOnFocus",xa)};c.prototype.vaj=function(xa){this.removeHandler("EnrichmentTaskPaneOnFocus",xa)};c.prototype.BH=function(){};c.prototype.np=function(){return this.Kp};c.prototype.gs=function(){return this.Kp};c.prototype.IR=function(){};c.prototype.dispose=function(){this.$&&this.$.tm(this.Zc);this.taskPaneManager=this.$=null;U.prototype.dispose.call(this)};
c.prototype.eg=function(xa,oa){oa||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!oa};c.prototype.ph=function(xa){return E.DOMElementExtensions.Ff(this.wc,xa)};c.prototype.Aj=function(){};c.prototype.Qj=function(){};c.prototype.lg=function(xa){this.Kp=xa;var oa=this.taskPaneManager;this.isVisible=xa;V.a.Ld(this.$)?xa?this.taskPaneManager.E6("EnrichmentTaskPane",this.bG):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(xa&&0<oa.Zz.length&&(!oa.Lg||10!==oa.Lg.taskPane.ah||oa.isCollapsed)&&
oa.SF(this,!0),oa.gx());xa||(t.g(this.$).eg(!0,!1),this.$.Bf())};c.prototype.VQ=function(){return!1};c.ka=function(xa,oa){var qa=xa.Mb,Ea=document.getElementById(qa+h.a.SKe);Ea||(Ea=G.a("div",xa.Mb+h.a.SKe,"cui-taskpane"),V.a.Ld(xa)||(qa=document.getElementById(qa+h.a.BR),void 0!==qa&&null!==qa?qa.appendChild(Ea):m.ULS.sendTraceTag(537166720,0,10,"EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: {0}",xa.gF)));qa=xa.da;return qa.za(257)||qa.Ga(257,new c(Ea,xa,oa))};Ck.Object.defineProperties(c.prototype,
{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(R.a)(c.prototype,this,"isVisible")},set:function(xa){Object(R.b)(c.prototype,this,"isVisible",xa);this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},xe:{configurable:!0,enumerable:!0,get:function(){return aa.a.dkh}},ah:{configurable:!0,enumerable:!0,get:function(){return 10}},Rk:{configurable:!0,enumerable:!0,get:function(){return Y}},RM:{configurable:!0,
enumerable:!0,get:function(){return this.titleText}},titleText:{configurable:!0,enumerable:!0,get:function(){return"Enrichment"}},Bo:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},wc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.GO.offsetHeight}},bG:{configurable:!0,enumerable:!0,get:function(){var xa=this;return this.taskPaneManager.Tua(this.wc,
this.titleText,this.Bo,this.isResizable,function(){xa.isVisible=!0},function(){xa.isVisible=!1},function(){xa.isVisible=!0},function(){xa.isVisible=!1},this.Bo)}}});Object(y.a)(c,"EnrichmentTaskPane",M.a,[776,3,478,415]);var ha=C.a;Wl(a,ha);a.prototype.create=function(){var xa=this,oa=N.GetServiceTaskFactory.create(this.$.da,203,this.la,this.vb),qa=N.GetServiceTaskFactory.create(this.$.da,155,this.la,this.vb);u.TaskExtensions.Ba(u.TaskExtensions.ts(u.TaskExtensions.te([oa,qa],this.la),function(){return xa.fD},
this.la),function(){xa.Eb(xa.jh)},this.la,3)};a.prototype.dispose=function(){this.jh=this.vi=this.$=null;ha.prototype.dispose.call(this)};a.ka=function(xa){xa.da.Ga(258,new a(xa))};Ck.Object.defineProperties(a.prototype,{fD:{configurable:!0,enumerable:!0,get:function(){var xa=this;this.vi||(this.vi=u.TaskExtensions.Ba(P.a(this.$),function(oa){xa.jh=c.ka(xa.$,oa.result)},this.la,3));return this.vi}}});Object(y.a)(a,"EnrichmentTaskPaneFactory",C.a,[]);var ta=b(11);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");
(function(){ta.a.Fa(function(xa){a.ka(xa);e.ka(xa);f.ka(xa)})})()},967:function(y,C,b){function a(Xa,yb,Ib,Qa,cb,lb){var Ha=bb.call(this)||this;Ha.omd=null;Ha.uMa=null;Ha.kpd=null;Ha.lpd=null;Ha.tic=null;Ha.Whc=null;Ha.qqd=null;Ha.B4a=0;Ha.oDb=0;Ha.xwb=0;Ha.Vba=null;Ha.Amd=!1;Ha.nLd=null;Ha.hn=null;Ha.xbd=null;Ha.ks=0;Ha.LY=null;Ha.kYj=null;Ha.KKa=8;Ha.WOa=!1;Ha.ucf=!1;Ha.Njf=!1;Ha.wZc=!1;Ha.mSe=null;Ha.xVe=null;Ha.Tya=null;Ha.tXc=0;Ha.vMg=5;Ha.m0b=3E4;Ha.y9f=!1;Ha.f$=null;Ha.sia=Array(5);Ha.uXd=
!1;Ha.Xag=!1;Ha.Nsd=0;Ha.jTf=0;Ha.uae=null;Ha.od=function($b,Jb){Jb.rc&&!Jb.Phc&&Ha.showUntrustedImageBusinessBarIfNecessary()};Ha.wKi=function($b){if($b.Result){var Jb=$b.Result;if(Jb&&Jb.length){A.ULS.sendTraceTag(537166922,0,50,"OnGetRichDataClassificationLabelsSuccess: Received {0} labels",Jb.length);var kc=zb.GetServiceTaskFactory.Xa(Ha.$.da,274,275,0);ad.TaskExtensions.Ba(kc,function(){kc.result.kXc(Jb,2)||A.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},
Ha.$.la,3)}}else A.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};Ha.Hf=function(){Ha.lzb&&(Ha.gLj(),Ha.I1h(Ha.$.ea.Qm.LinkedEntityAsyncRefreshStateId));Ha.G6a?Ha.H2h(Ha.$.ea.Qm.RichDataClassificationLabelStateId):Ha.S5a&&Ha.GWd(!0)};Ha.eIi=function(){Ha.uXd=!0;Ha.hn&&Ha.hn.D5i()};Ha.SJi=function($b){if($b&&!wa.a($b))try{$b.Result.HasUntrustedImageUrl&&(Ha.businessBar.fg(57,null),Ha.Xag=!0)}catch(Jb){A.ULS.sendTraceTag(574718945,0,10,"ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception {0}.",
Jb)}};Ha.njf=function(){if(!Ha.Njf&&Ha.zyb()&&!Ha.nnd())if(sb.a("DataTabActive"),sc.a.Fg.lR)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var $b=Ha.l4b();if($b){var Jb={};Jb.InputMethod=Ta.a.Sb;Jb.CalloutName=8;Jb.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";Ha.$.Ka.Wb($b,Jb);Ha.Njf=!0}else A.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else A.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else A.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};Ha.$Gi=function($b){db.a.oh($b.Errors)||(Ha.G6a||Ha.GWd(!1),Ha.raiseEvent("LinkedEntityConverted"))};Ha.YQi=function(){Ha.$.da.$a(211,function($b){$b.readText(Pa.a.instance.ga(1785))})};Ha.vd=function($b,Jb){A.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");Jb.YV?A.ULS.sendTraceTag(537166865,
0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(Ha.$.isEditMode?Ha.lxe():Ha.sej(),Bb.EwaSettings.ma(654)&&Ha.uXd&&Ha.wKe())};Ha.$Ji=function($b){Ha.m2b();if($b.Result){$b=$b.Result;var Jb=$b.DomainDataArray;Ha.Vba=$b.Ribbon;if(Ha.bxa&&Ha.Vba){var kc={};kc.Name=Pa.a.instance.ga(1775);kc.DomainIds=Ha.lK;Array.insert(Ha.Vba.Categories,a.O7a,kc)}0<$b.MaximumCellsToConvert&&(Ha.uae=$b.MaximumCellsToConvert);Ha.ks=2;$b=!1;if(Jb){A.ULS.sendTraceTag(39949271,0,
50,"OnGetLinkedEntityServiceDomainsSuccess: Received {0} domains",Jb.length);Ha.rNa||(Ha.rNa=[]);kc=Pa.a.instance.ga(1772);var uc=Pa.a.instance.ga(1774);Jb=Gl(Jb);for(var hd=Jb.next();!hd.done;hd=Jb.next())if(hd=hd.value,hd.DomainId)if(Ha.rNa.push(hd),hd.DomainBlocked){var ma=!!hd.DomainId.StringId;A.ULS.sendTraceTag(537166861,0,50,"Domain: {0} is telemetry only, do not show in menu (Has String ID: {1})",ma?hd.DomainId.Id.toString():hd.Name,ma)}else Ha.UU.ia(a.u1a(hd.DomainId),hd),hd.Name===kc||268435456===
hd.DomainId.Id?Ha.mSe=hd.DomainId.Id.toString():hd.Name===uc||536870912===hd.DomainId.Id?Ha.xVe=hd.DomainId.Id.toString():268435712===hd.DomainId.Id&&hd.ShowInRibbon&&(Ha.wZc=!0),$b=!0;else A.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}$b||(Ha.rNa=null);Ha.Ibg();Ha.ypd&&Ha.nLd.lUh();Ha.y9f||(Ha.cLj(),Ha.y9f=!0)}else Ha.rNa=null,Ha.ks=3,-1<Ha.KKa&&window.setTimeout(function(){Ha.F$a()},100*(8-Ha.KKa)),A.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");
Ha.Frc();Ha.nDe();Ha.wZc&&Ha.Hdf&&vc.b(Ha.njf,Ha.$.la,500);Ha.S5a&&!Ha.G6a&&Ha.GWd(!0)};Ha.ZJi=function($b){$b=mc.a.ig($b.data);A.ULS.sendTraceTag(34415007,0,15,"OnGetLinkedEntityServiceDomainsFailure [Errors: {0}].",db.a.Tc($b));Ha.rNa=null;Ha.ks=3;Ha.WOa=!0;Ha.Frc()};Ha.onContentReady=function(){Ha.H$f()&&Ha.gridView.Ww(Ha.onContentReady)};Ha.ej=function(){Ha.m2b()};Ha.zMi=function($b){if(wa.a($b)){var Jb=zb.GetServiceTaskFactory.Xa(Ha.$.da,5,4,0);ad.TaskExtensions.Ba(Jb,function(){var uc=null;
if(null===$b||void 0===$b?0:$b.Errors)uc=$b.Errors[0];Jb.result.h3f(uc,null)},Ha.$.la,3);A.ULS.sendTraceTag(537166800,0,15,"ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",db.a.Tc($b.Errors));var kc=db.a.JF($b.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");Ha.$.ea.Cp(kc)}};Ha.nZc=function(){A.ULS.sendTraceTag(537166796,0,50,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a {0} millisecond interval",
Ha.m0b);Ha.baf("Periodic auto-refresh check",Ha.rFi,Ha.qFi)};Ha.rFi=function($b){wa.a($b)?(A.ULS.sendTraceTag(537166795,0,15,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",db.a.Tc($b.Errors)),++Ha.tXc):Ha.tXc=0;B.a.Ha(Ha.Tya);Ha.tXc>=Ha.vMg?(A.ULS.sendTraceTag(537166794,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),
Ha.Tya=null):(A.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),Ha.Tya=ub.a.instance.create(Ha.nZc,Ha.m0b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};Ha.qFi=function($b){$b=mc.a.ig($b.data);N.a.Fh($b)?A.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):A.ULS.sendTraceTag(537166792,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: {0}].",
db.a.Tc($b));B.a.Ha(Ha.Tya);Ha.Tya=ub.a.instance.create(Ha.nZc,Ha.m0b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};Ha.ENi=function($b){$b=!!$b.Result&&$b.Result;A.ULS.sendTraceTag(537166790,0,50,"OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = {0}",$b.toString());$b?(A.ULS.sendTraceTag(537166789,0,50,"OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = {0} ms, retry count = {1}",Za.a.Ua.oe.m-Ha.B4a,Ha.oDb),Ha.F$a()):Ha.dMb()};Ha.DNi=function(){A.ULS.sendTraceTag(537166788,
0,15,"OnNotifyFeatureLicensingStatusFailed");Ha.dMb()};Ha.POi=function($b){$b=!!$b.Result&&$b.Result;A.ULS.sendTraceTag(537166731,0,50,"OnRefreshHandshakeSuccess- operationSucceeded? = {0}",$b.toString());$b?(A.ULS.sendTraceTag(537166730,0,50,"OnRefreshHandshakeSuccess- successful handshake duration = {0} ms, retry count = {1}",Za.a.Ua.oe.m-Ha.B4a,Ha.xwb),Ha.F$a()):Ha.zMf()};Ha.OOi=function(){A.ULS.sendTraceTag(570769947,0,15,"OnRefreshHandshakeFailed");Ha.zMf()};Ha.CJi=function($b){$b.Result?($b=
$b.Result)?(Ha.gId(),Ha.businessBar.h3f(null,$b)):A.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):A.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};Ha.$=Xa;Ha.businessBar=lb;Ha.svgIconProvider=Ib;Ha.rNa=[];Ha.lK=[];Ha.gridView=Eb.g(Ha.$);Ha.adc=-1;Ha.hii=Bb.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");Ha.S5a=Ha.$.ma(443)&&Ha.$.ma(292);
Ha.G6a=Ha.$.ma(677);Ha.lzb=Bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityAutoRefresh",!1);Ha.bxa=Ha.$.ma(676);Ha.ypd=Ha.bxa&&Bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadAndWriteRecentlyUsedListToTheRoamingService",!1);Ha.Hdf=Bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);Ha.aMa=Bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CheckExtraPowerBILicenses",!0);Ha.UU=new Ua.a;Ha.w8a=new e(Xa,
yb,Ha);Qa&&(Ha.hn=new f(Xa,Qa,cb,Ha,Ha));Ha.$.dl(Ha.vd);Y.a(Ha.$)&&Y.a(Ha.$).wnj(Ha);Ha.lxe();(Ha.lzb||Ha.S5a||Ha.G6a)&&Ha.$.ea.Nt(Ha.Hf);Bb.EwaSettings.ma(131)&&Bb.EwaSettings.ma(139)&&(Ha.H$f()||Ha.gridView.Mt(Ha.onContentReady));Ha.$.GA(Ha.ej);Bb.EwaSettings.ma(654)&&(Ha.$.ea.hk(Ha.od),Ha.showUntrustedImageBusinessBarIfNecessary());Ha.ypd&&(Ha.nLd=new c(Ha.$,Ha));return Ha}function c(Xa,yb){var Ib=this;this.Kid=this.Nid=!1;this.GOi=function(Qa){A.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");
Ib.Nid=!0;if(db.a.oh(Qa.Errors))A.ULS.sendTraceTag(537166679,0,10,"OnReadRoamingStringSuccess encountered an error. Errors: {0}",db.a.Tc(Qa.Errors));else{var cb=0,lb=[],Ha=!1;try{if(!Qa.Result)return;var $b=Qa.Result;if(!$b){A.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}lb=Ib.pVi($b);if(!lb||!lb.length)return;cb=lb.length;Ib.Fyi(lb);Ib.Sza.XRf();A.ULS.sendTraceTag(537166677,0,50,"OnReadRoamingStringSuccess MruCount:{0}",Ib.Sza.aHb.length);if(Bb.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(var Jb=
Gl(Ib.Sza.aHb),kc=Jb.next();!kc.done;kc=Jb.next())if(1===(kc.value.Id&1048320)>>8){Ha=!0;break}A.ULS.sendTraceTag(537166676,0,50,"OnReadRoamingStringSuccess MruWolframAvailable:{0}",Ha)}}finally{A.ULS.sendTraceTag(537166675,0,50,"ParseRecentlyUsedLinkedDataTypes returned {0} data types.",cb),Qa=[],Qa.push(Object(Ja.a)(new Yb.a,{name:"MruCount",int64:cb})),Qa.push(Object(Ja.a)(new Yb.a,{name:"MruWolframAvailable",bool:Ha})),sb.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Qa)}Ib.Kid&&(Ib.Sfg(Ib.Sza.aHb),
Ib.Kid=!1)}};this.USi=function(Qa){A.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");db.a.oh(Qa.Errors)?A.ULS.sendTraceTag(537166673,0,10,"OnWriteRoamingStringSuccess encountered an error. Errors: {0}",db.a.Tc(Qa.Errors)):Qa.Result&&(Qa.Result||A.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.XAf=function(Qa,cb,lb){Qa=mc.a.ig(Qa.data);A.ULS.sendTraceTag(537166671,0,10,"OnRoamingOperationFailure: Encountered errors for {0}. Errors: {1}.",
lb,db.a.Tc(Qa))};this.$=Xa;this.Sza=yb}function e(Xa,yb,Ib){this.Pjf=2;this.Ojf="Size64by48";this.$=Xa;this.Ta=yb;this.convertToLinkedEntityManager=Ib;this.bxa=Bb.EwaSettings.ma(676)}function f(Xa,yb,Ib,Qa,cb){var lb=this;this.Sta=this.EHe=!1;this.bcb=this.Gwa=!0;this.iFb=this.eLb=!1;this.qdb=null;this.lpc=0;this.CR=function(){(lb.bcb||lb.Sta)&&2!==lb.lpc&&(lb.iFb||lb.psd(!1))};this.od=function(){A.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};
this.Jg=function(){(lb.bcb||lb.Sta)&&lb.psd(!1)};this.fnc=function(Ha,$b){db.a.oh(Ha.Errors)?A.ULS.sendTraceTag(36975688,0,10,"Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: {0}",db.a.Tc(Ha.Errors)):Ha.Result&&(Ha=Ha.Result,Ha.DisambiguationJson?(lb.eLb=!1,lb.zZf($b),lb.qdb=Ha.SkydanceFeatureBitmask,$b=Ha.DisambiguationJson,A.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),
lb.iFb=!1,lb.qjf($b)):A.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.yJi=function(Ha,$b){db.a.oh(Ha.Errors)?A.ULS.sendTraceTag(36975689,0,10,"Failed to retrieve disambiguation data for search. errors: {0}",db.a.Tc(Ha.Errors)):Ha.Result&&(Ha=Ha.Result,Ha.DisambiguationJson?(lb.zZf($b),lb.qdb=Ha.SkydanceFeatureBitmask,$b=Ha.DisambiguationJson,A.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),
lb.iFb=!0,lb.qjf($b)):A.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.dNi=function(Ha){db.a.oh(Ha.Errors)?(A.ULS.sendTraceTag(36975690,0,10,"Failed to move to the next ambiguous Linked Entity. errors: {0}",db.a.Tc(Ha.Errors)),lb.bcb=!0):Ha.Result&&(Ha=Ha.Result,lb.qdb=Ha.SkydanceFeatureBitmask,lb.nwd(Ha),lb.eLb=!0)};this.VPi=function(Ha){db.a.oh(Ha.Errors)&&A.ULS.sendTraceTag(36975691,0,10,"Failed to select Linked Entity for Disambiguation.. errors: {0}",
db.a.Tc(Ha.Errors));Ha.Result?(lb.nwd(Ha.Result),lb.eLb=!0):lb.Wsa()};this.pBf=function(Ha){db.a.oh(Ha.Errors)?A.ULS.sendTraceTag(36975692,0,15,"Failed to retrieve data for searching in Disambiguation Pane.  Error id names: {0}",db.a.Tc(Ha.Errors)):Ha.Result?lb.L7b.xBc(Ha.Result,null):(A.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),lb.Wsa())};this.JLi=function(Ha){db.a.oh(Ha.Errors)?A.ULS.sendTraceTag(537166926,
0,15,"Failed to insert starter data table. Error id names: {0}",db.a.Tc(Ha.Errors)):lb.Wsa()};this.$=Xa;this.gridView=Eb.g(this.$);this.gridView.ha.EP(this.Jg);this.gridView.Mt(this.CR);this.tLe=Qa;this.convertToLinkedEntityManager=cb;Nb.a.Ld(this.$)||Ib.$Q(yb);Xa=new x(yb);this.L7b=new m(Xa);V.a.instance.kc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ha){Ha.isFeatureEnabled("mso_sendASmile",!0).then(function($b){lb.Gwa=$b;return null})})}function l(){this.market=
this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}function n(Xa){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=null;this.campaignId=Xa;this.commentQuestion=Pa.a.instance.Bb(190);this.isZeroBased=!1;this.aditionalDataRequested=
["EmailAddress"];this.ratingQuestion=Pa.a.instance.Bb(186);this.ratingValuesAscending=[Pa.a.instance.Bb(187),Pa.a.instance.Bb(188),Pa.a.instance.Bb(189)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=Pa.a.instance.Bb(185)}function m(Xa){return h.call(this,Xa)||this}function h(Xa){this.Py=null;this.ofa=Xa}function x(Xa){var yb=u.call(this,P.AFrameworkApplication.sa.Hy,P.AFrameworkApplication.sa.zt,P.AFrameworkApplication.sa.kea,P.AFrameworkApplication.sa.Qe,P.AFrameworkApplication.Ib)||
this;yb.taskPane=Xa;yb.taskPane.sFg(Object(aa.a)(yb,yb.yYf,"setFocusOnIFrame"));return yb}function u(Xa,yb,Ib,Qa,cb){this.dr=this.gk=this.G7d=this.F7d=this.Tv=this.Gu=null;this.mx=!1;this.Bi=Xa;this.pe=yb;this.mP=Ib;this.oc=Qa;this.La=cb;this.Ypa=Tb.KeyInputManager.mm(tb.a.KBa,0)}function w(Xa,yb,Ib){Xa=v.call(this,Xa,yb)||this;Xa.telemetryJson=null;Xa.telemetryJson=Ib;return Xa}function v(Xa,yb){Xa=t.call(this,Xa)||this;Xa.messageContent=null;Xa.messageContent=yb;return Xa}function t(Xa){this.messageType=
0;this.messageType=Xa}function z(){}function D(Xa,yb,Ib,Qa,cb,lb,Ha,$b,Jb,kc,uc){uc=Xa.Na(1,void 0===uc?null:uc);uc.selectedRanges=yb;uc.isChangeObject=Ib;uc.isFloodgateEnabled=Qa;uc.isStarterData=cb;uc.starterDataDomainId=lb;return qa.i(Xa,"GetDataSelectorPaneData",uc,Ha,$b,Jb,kc,4)}b.r(C);y=b(0);var A=b(15),B=b(91),N=b(277),P=b(4),Q=b(29),M=b(1022),ba=b(142),V=b(84),aa=b(82),E=b(85),G=b(38),I=b(19),R=b(5),Y=b(167),U=b(1315),ha=b(1317),ta=b(176),xa=b(617),oa=b(357),qa=b(83),Ea=b(911),ka=b(997);z.h6h=
"EnrichmentContentFrame";z.width=320;Object(y.a)(z,"EnrichmentConstants",null,[]);Object(y.a)(t,"EnrichmentResponseMessage",null,[]);Wl(v,t);Object(y.a)(v,"EnrichmentResponseMessageWithContent",t,[]);Wl(w,v);Object(y.a)(w,"EnrichmentResponseMessageWithContentAndTelemetryData",v,[]);var za=b(273),La=b(13),Ia=b(96),Ya=b(42),tb=b(86),Tb=b(109),va=b(41),la=b(80),$a=b(24),Ra=b(107),eb=b(904),mb=b(27);u.prototype.dispose=function(){this.XKb&&this.dr&&(this.Bi.Aa(La.a.click,this.dr,Object(aa.a)(this,this.dk,
"onClosePaneClick")),this.pe.Aa(La.a.Vd,this.dr,Object(aa.a)(this,this.Xxf,"onKeyHide")));this.dr=null;this.Tv&&(this.sNj(),this.Tv.parentNode.removeChild(this.Tv),this.Tv=null);this.oc.yi("EnrichmentPaneId").$k(this.Ypa)};u.prototype.show=function(Xa,yb,Ib){this.Gu=Xa;this.mx||(this.gk=this.s0a(),this.CQa.appendChild(this.gk),this.P6i(),this.La.fc(mb.a.Mye,Ra.a.frame,Object(aa.a)(this,this.Z0h,"handleEscapeKeyAction")),this.ARa(),this.mx=!0);this.Tv.src=this.Osb&&this.Osb.length?this.Osb+"?culture="+
yb.market+"&appName="+yb.applicationName+"&themeId="+yb.themeId+"&featuresBitMask="+yb.featuresBitMask:u.Jrf;this.F7d=yb;this.G7d=Ib;this.hdb()};u.prototype.xBc=function(Xa,yb){Xa=new w(2,Xa,yb);this.$pc(Xa)};u.prototype.ARa=function(){var Xa=this.oc.yi("EnrichmentPaneId");Xa.parent=za.AFrame.PNa;this.Bi.Tmb("EnrichmentPaneId",this.gk);Xa.bindAction(this.Ypa,mb.a.Mye)};u.prototype.yYf=function(){if(this.Tv){Ia.FocusManager.Aoa(this.Tv.contentWindow);var Xa=new w(4,null,null);this.$pc(Xa)}};u.prototype.dk=
function(){this.F2b();return!0};u.prototype.Xxf=function(Xa){Xa=Xa.Ca.keyCode;return Xa===Sys.UI.Key.enter||Xa===Sys.UI.Key.space?(this.F2b(),!0):!1};u.prototype.F2b=function(){this.hide();if(this.Gu)this.Gu.onPaneClosed()};u.prototype.s0a=function(){var Xa=Ea.a("div","EnrichmentPaneId","EnrichmentPane");this.XKb&&Xa.appendChild(this.k3c());this.Y9h(Xa);return Xa};u.prototype.k3c=function(){var Xa=Ea.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),yb=Ea.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");
yb.innerText=CommonUIStrings.l_EnrichmentPaneTitle;yb.title=CommonUIStrings.l_EnrichmentPaneTitle;var Ib=ka.a.Cb("CloseEnrichmentPane","EnrichmentPaneCloseButton",CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);this.Bi.pa(La.a.click,Ib,Object(aa.a)(this,this.dk,"onClosePaneClick"));this.pe.pa(La.a.Vd,Ib,Object(aa.a)(this,this.Xxf,"onKeyHide"));Xa.appendChild(yb);Xa.appendChild(Ib);this.dr=Ib;return Xa};u.prototype.Y9h=function(Xa){this.Tv=Ea.b("iframe","","EnrichmentFrame");Xa.appendChild(this.Tv);
this.Tv.id=z.h6h;this.Tv.setAttribute("role","presentation")};u.prototype.P6i=function(){Ya.a.addHandler(this.Tv,"load",Object(aa.a)(this,this.zxf,"onIFrameLoad"));Ya.a.addHandler(this.Tv,"error",Object(aa.a)(this,this.lnc,"onIFrameError"));$addHandler(window,"message",Object(aa.a)(this,this.Axf,"onIFrameMessage"))};u.prototype.sNj=function(){Ya.a.removeHandler(this.Tv,"load",Object(aa.a)(this,this.zxf,"onIFrameLoad"));Ya.a.removeHandler(this.Tv,"error",Object(aa.a)(this,this.lnc,"onIFrameError"));
$removeHandler(window,"message",Object(aa.a)(this,this.Axf,"onIFrameMessage"))};u.prototype.lbh=function(){this.Tv.src=u.Jrf};u.prototype.hide=function(){this.Edc();this.lbh()};u.prototype.Z0h=function(Xa,yb,Ib){if(1!==Ib&&(this.hide(),this.Gu))this.Gu.onPaneClosed();return 32};u.prototype.zxf=function(){};u.prototype.lnc=function(){};u.prototype.Axf=function(Xa){Xa=Xa.rawEvent;if(!this.Tv||-1!==this.Tv.src.indexOf(Xa.origin)){try{var yb=va.a(Xa.data)}catch(Ib){return}if(!eb.c(yb.messageType)){Xa=
window.g_badCastCallback;window.g_badCastCallback=null;switch(yb.messageType){case 2:this.$pc(new w(1,va.c(this.F7d),this.G7d));break;case 1:this.$pc(new v(0,this.$Gh()));break;case 3:this.Gu&&this.Gu.selectEntity(yb.messageContent);break;case 5:this.Gu&&this.Gu.NCb(yb.messageContent);break;case 8:this.Gu&&(yb=va.a(yb.messageContent),0<yb.DomainId?this.Gu.oMd(yb.Query,yb.TelemetryJson,yb.DomainId,yb.DomainIdString):this.Gu.searchEntity(yb.Query,yb.TelemetryJson));break;case 6:this.Gu&&this.Gu.cancelSearch();
break;case 11:yb=va.a(yb.messageContent);yb=u.x4b("keydown","f6",tb.a.XDc,!0,!1,yb,!0,!1);this.Tv&&this.Tv.dispatchEvent(yb);break;case 12:if(va.a(yb.messageContent).keyCode===tb.a.pL&&(yb=u.x4b("keydown","esc",tb.a.pL,!0,!1,!1,!1,!1),this.Tv&&(this.Tv.dispatchEvent(yb),this.hide(),this.Gu)))this.Gu.onPaneClosed();break;case 13:this.Gu&&this.Gu.selectDataType(yb.messageContent);break;case 14:this.Gu&&this.Gu.showHelpArticle(yb.messageContent);break;case 15:this.Gu&&this.Gu.showSurveyDialog(yb.messageContent);
break;case 16:this.Gu&&(yb=va.a(yb.messageContent),this.Gu.insertTable(yb.DomainId,yb.DomainIdString))}window.g_badCastCallback=Xa}}};u.prototype.$Gh=function(){return va.c([2,1,3,5,8,6])};u.prototype.$pc=function(Xa){Xa=va.c(Xa);this.Tv.contentWindow.postMessage(Xa,la.a.Saa(this.Osb))};u.x4b=function(Xa,yb,Ib,Qa,cb,lb,Ha,$b){$a.a.kv?(lb=String.format("{0} {1} {2}",lb?"Shift":"",Ha?"Control":"",$b?"Alt":""),lb.trim(),Ib=document.createEvent("KeyboardEvent"),Ib.initKeyboardEvent(Xa,Qa,cb,window.self,
yb,0,lb,!1,"en-US")):(yb={},yb.keyCode=Ib,yb.ctrlKey=Ha,yb.shiftKey=lb,yb.altKey=$b,yb.bubbles=Qa,yb.cancelable=cb,Ib=new KeyboardEvent(Xa,yb));return Ib};Ck.Object.defineProperties(u.prototype,{XKb:{configurable:!0,enumerable:!0,get:function(){return!0}},Osb:{configurable:!0,enumerable:!0,get:function(){return P.AFrameworkApplication.fa.Va("EnrichmentPaneUrl")}}});u.Jrf="about:blank";Object(y.a)(u,"EnrichmentPane",null,[830,3]);Wl(x,u);x.prototype.hdb=function(){this.taskPane.isVisible||this.taskPane.lg(!0)};
x.prototype.Edc=function(){this.taskPane.lg(!1)};x.prototype.dispose=function(){this.taskPane&&(this.taskPane.vaj(Object(aa.a)(this,this.yYf,"setFocusOnIFrame")),this.taskPane=null);u.prototype.dispose.call(this)};Ck.Object.defineProperties(x.prototype,{CQa:{configurable:!0,enumerable:!0,get:function(){return this.taskPane.wc},set:function(Xa){this.taskPane.wc.innerHTML=Xa.innerHTML}}});Object(y.a)(x,"EnrichmentTaskPaneWrapper",u,[]);h.prototype.Api=function(Xa,yb){this.Py=Xa;this.ofa&&this.ofa.show(this,
yb,null)};h.prototype.xBc=function(Xa,yb){this.ofa&&this.ofa.xBc(Xa,yb)};h.prototype.fxb=function(){this.ofa&&this.ofa.hide()};h.prototype.dispose=function(){this.ofa&&(this.ofa.dispose(),this.ofa=null)};h.prototype.selectEntity=function(Xa){return this.Py?this.Py.selectEntity(Xa):!1};h.prototype.searchEntity=function(Xa,yb){this.Py&&this.Py.searchEntity(Xa,yb)};h.prototype.oMd=function(Xa,yb,Ib,Qa){this.Py&&this.Py.oMd(Xa,yb,Ib,Qa)};h.prototype.NCb=function(Xa){return this.Py?this.Py.NCb(Xa):!1};
h.prototype.onPaneClosed=function(){if(this.Py)this.Py.onPaneClosed()};h.prototype.cancelSearch=function(){this.Py&&this.Py.cancelSearch()};h.prototype.selectDataType=function(Xa){this.Py&&this.Py.selectDataType(Xa)};h.prototype.showHelpArticle=function(Xa){this.Py&&this.Py.showHelpArticle(Xa)};h.prototype.showSurveyDialog=function(Xa){this.Py&&this.Py.showSurveyDialog(Xa)};h.prototype.insertTable=function(Xa,yb){this.Py&&this.Py.insertTable(Xa,yb)};Object(y.a)(h,"EnrichmentManager",null,[828,3]);
Wl(m,h);m.prototype.dispose=function(){h.prototype.dispose.call(this)};Object(y.a)(m,"ExcelEnrichmentManager",h,[]);var Pa=b(14);Object(y.a)(n,"FloodgateSurvey",null,[]);var Da=b(25),Ta=b(79),Sa=b(440),Cb=b(45),cc=b(386),nc=b(175),Nb=b(36),nb=b(95),db=b(30),Bb=b(1),zc=b(292),Eb=b(22);Object(y.a)(l,"EnrichmentMessageContentAppProperties",null,[]);f.prototype.dispose=function(){this.$&&(this.gridView.ha.RW(this.Jg),this.gridView.Ww(this.CR))};f.prototype.selectEntity=function(Xa){function yb(){return new Sa.a}
var Ib=this,Qa=Cb.o(this.gridView.ha.ta.activeCell,this.$);cc.a(this.$.userOperationManager,function(cb,lb,Ha){var $b=Ib.$.na.va;cb=zc.b(cb,Ib.VPi);var Jb=$b.Na(9,null);Jb.activeCell=Qa;Jb.selectionIndex=Xa;return qa.i($b,"SelectLinkedEntityForDisambiguation",Jb,cb,lb,Ha,null,4)},function(cb){return new nc.a(109,0,cb,void 0,yb)},null);return!0};f.prototype.searchEntity=function(Xa,yb,Ib,Qa,cb){var lb=this;Ib=void 0===Ib?!1:Ib;Qa=void 0===Qa?0:Qa;cb=void 0===cb?null:cb;A.ULS.sendTraceTag(38846755,
0,50,"ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: {0}",yb);var Ha=Cb.o(this.gridView.ha.ta.activeCell,this.$);cc.a(this.$.userOperationManager,function($b,Jb,kc){var uc=lb.$.na.va,hd=lb.Gwa,ma=Ib,jb=Qa,Zb=cb;$b=zc.b($b,lb.pBf);var Ub=uc.Na(1,null);Ub.searchCell=Ha;Ub.searchQuery=Xa;Ub.isFloodgateEnabled=hd;Ub.isStarterData=ma;Ub.starterDataDomainId=jb;Ub.starterDataDomainIdString=Zb;return qa.i(uc,"LinkedEntitySearch",Ub,$b,Jb,kc,null,4)},function($b){return new nc.a(110,
0,$b,16)},null)};f.prototype.NCb=function(Xa){var yb=this,Ib=Cb.o(this.gridView.ha.ta.activeCell,this.$);this.bcb=!1;cc.a(this.$.userOperationManager,function(Qa,cb,lb){var Ha=yb.$.na.va;Qa=zc.b(Qa,yb.dNi);var $b=Ha.Na(1,null);$b.activeCell=Ib;$b.isBackward=Xa;return qa.i(Ha,"MoveToNextAmbiguousLinkedEntity",$b,Qa,cb,lb,null,4)},function(Qa){return new nc.a(111,0,Qa,16)},null);return!0};f.prototype.onPaneClosed=function(){this.Sta=!1;this.EHe=!0;this.lpc=0;this.iFb=!1};f.prototype.cancelSearch=function(){var Xa=
this,yb=this.HMd();yb&&cc.a(this.$.userOperationManager,function(Ib,Qa,cb){var lb=Xa.$.na.va;Ib=zc.b(Ib,Xa.pBf);var Ha=lb.Na(9,null);Ha.activeCell=yb;return qa.i(lb,"CancelSearchLinkedEntity",Ha,Ib,Qa,cb,null,4)},function(Ib){return new nc.a(112,0,Ib,16)},null)};f.prototype.selectDataType=function(Xa){A.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.Wsa();if(Xa&&Xa.length)if(Xa=JSON.parse(Xa))if(null==Xa.domainId)A.ULS.sendTraceTag(537166946,
0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var yb={};yb.Id=Xa.domainId;yb.StringId=Xa.stringId;this.convertToLinkedEntityManager.convertToLinkedEntity(yb)}else A.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else A.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")};f.prototype.showHelpArticle=function(Xa){var yb=new nb.a(-859308420,Ta.a.Sb,this.$.Xc,
9,null),Ib={};Xa=(Ib[Ta.a.pg]="HelpID="+Xa,Ib.InputMethod=Ta.a.Sb,Ib.ShouldCanvasTakeFocus=!0,Ib[Ta.a.kd]=R.a.XQ,Ib);this.$.Ka.Wb(yb,Xa)};f.prototype.showSurveyDialog=function(Xa){ha.a.ILb(new n(Xa))};f.prototype.insertTable=function(Xa,yb){var Ib=this,Qa=this.HMd();Qa&&cc.a(this.$.userOperationManager,function(cb,lb,Ha){var $b=Ib.$.na.va;cb=zc.b(cb,Ib.JLi);var Jb=$b.Na(1,null);Jb.cell=Qa;Jb.starterDataDomainId=Xa;Jb.starterDataDomainIdString=yb;return qa.i($b,"InsertStarterDataTable",Jb,cb,lb,Ha,
null,4)},function(cb){return new nc.a(259,0,cb,1)},null)};f.prototype.psd=function(Xa){this.launchOrCloseDisambiguationPane(Xa)};f.prototype.launchDisambiguationPaneForSearch=function(){var Xa=this;A.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");var yb=this.mkj();yb&&cc.a(this.$.userOperationManager,function(Ib,Qa,cb){return D(Xa.$.na.va,yb,!0,Xa.Gwa,!1,null,zc.b(Ib,Xa.yJi),Qa,cb,1)},function(Ib){return new nc.a(114,
0,Ib,16)},null)};f.prototype.launchLinkedEntityDataTypeSelectorPane=function(Xa,yb){var Ib=this;cc.a(this.$.userOperationManager,function(Qa,cb,lb){var Ha=Ib.$.na.va;Qa=zc.b(Qa,Ib.fnc);var $b=Ha.Na(1,null);$b.selectedRanges=Xa;$b.letyDomainId=yb;return qa.i(Ha,"GetDataTypeSelectorData",$b,Qa,cb,lb,2,4)},function(Qa){return new nc.a(233,0,Qa,16)},null)};f.prototype.upi=function(Xa,yb){var Ib=this;Xa&&cc.a(this.$.userOperationManager,function(Qa,cb,lb){return D(Ib.$.na.va,Xa,!1,!1,!0,yb,zc.b(Qa,Ib.fnc),
cb,lb,2)},function(Qa){return new nc.a(257,0,Qa,16)},null)};f.prototype.ZGi=function(Xa){db.a.oh(Xa.Errors)?(Xa=db.a.Tc(Xa.Errors),Xa.includes("OperationSucceededWithAlert")?A.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):A.ULS.sendTraceTag(36975687,0,10,"Failed to Convert to Linked Entity. errors: {0}",Xa)):Xa.Result&&(this.$.ea.Dk(this.od),this.$.ea.hk(this.od),Xa=Xa.Result,this.qdb=Xa.SkydanceFeatureBitmask,this.nwd(Xa),this.eLb=!0)};f.prototype.zZf=function(Xa){Xa&&
(this.lpc=Xa)};f.prototype.qjf=function(Xa){if(Bb.EwaSettings.ma(654)){var yb=new nb.a(-90814711,Ta.a.Sb,0,10,null);this.$.Ka.Wb(yb,null)}this.Sta?this.L7b.xBc(Xa,null):(yb=3,null!=this.qdb?yb=this.qdb:A.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(Xa=this.EMh(Xa,yb))||A.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.tLe||A.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.L7b.Api(this.tLe,
Xa),this.Sta=!0)};f.prototype.Wsa=function(){this.Sta&&(A.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),this.L7b.fxb(),this.Sta=!1,this.lpc=0,this.iFb=!1)};f.prototype.nwd=function(Xa){var yb=Xa.Row+1;Xa=Xa.Column+1;0>yb||0>Xa?(A.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.Wsa(),this.$.ea.Dk(this.od)):(yb=new Da.Range(yb,Xa,yb,Xa,!0,!1),this.gridView.ha.updateSelection(yb,
yb,60),this.bcb=!0)};f.prototype.EMh=function(Xa,yb){var Ib=new l;Ib.applicationVersion=P.AFrameworkApplication.buildVersion;Ib.applicationName="ExcelWac";Ib.anid="00000000-0000-0000-0000-000000000000";Ib.sessionId=P.AFrameworkApplication.userSessionId;Ib.appCorrelationId=ta.a.create().toString();var Qa=xa.a.kH(P.AFrameworkApplication.lcid);Qa=Qa?Qa.name:null;Ib.uiLanguage=Qa;Ib.market=this.zac(Qa);Ib.themeId=0;Ib.disambiguationJson=Xa;yb<=oa.a.WS?Ib.featuresBitMask=yb:A.ULS.sendTraceTag(537166932,
0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Ib};f.prototype.zac=function(Xa){Xa=Xa.split("-");return Xa[Xa.length-1]};f.prototype.launchOrCloseDisambiguationPane=function(Xa){var yb=this,Ib=this.gridView.ha.ta.activeCell;if(this.HMd()&&Ib)if(this.gridView.Nb.ffc(Ib)){if((!this.EHe||Xa||this.eLb)&&!this.gridView.isEditing){Xa&&(this.bcb=!0);var Qa=Cb.q(Ib,this.$);cc.a(this.$.userOperationManager,function(cb,lb,Ha){return D(yb.$.na.va,Qa,!1,yb.Gwa,!1,
null,zc.b(cb,yb.fnc),lb,Ha,1)},function(cb){return new nc.a(114,0,cb,16)},null)}}else this.Wsa();else this.Wsa()};f.prototype.D5i=function(){var Xa=this;if(this.Sta){var yb=this.gridView.ha.ta.activeCell;if(yb){var Ib=Cb.q(yb,this.$);cc.a(this.$.userOperationManager,function(Qa,cb,lb){return D(Xa.$.na.va,Ib,!1,Xa.Gwa,!1,null,zc.b(Qa,Xa.fnc),cb,lb,1)},function(Qa){return new nc.a(114,0,Qa,16)},null)}else this.Wsa()}};f.prototype.HMd=function(){var Xa=this.gridView.ha.ta;return Xa.Iba()?Cb.o(Xa.activeCell,
this.$):null};f.prototype.mkj=function(){var Xa=this.gridView.ha.ta;return Xa.Iba()?Cb.q(Xa.activeCell,this.$):null};Object(y.a)(f,"ConvertToLinkedEntityDisambiguationPane",null,[3]);var Ja=b(7),Rb=b(391),yc=b(1429),qd=b(54),bc=b(918);e.prototype.WEh=function(Xa,yb){var Ib=b(967).ConvertToLinkedEntityManager;this.OPj();yb=this.Ta.Cq(yb).jE();for(var Qa=0,cb=0,lb=!1,Ha=Gl(Xa.Categories),$b=Ha.next();!$b.done;$b=Ha.next()){if($b=this.zFh($b.value,Qa))this.bxa&&cb===Ib.O7a&&(lb=!0),yb.MenuSectionList.push($b),
++Qa;++cb}this.bxa&&lb&&Qa<=Ib.Qjf&&Array.removeAt(yb.MenuSectionList,Ib.O7a);Ib=this.Ta.Pc().S0b();Qa=qd.a.gf(11);Xa=Gl(Xa.LongButtons);for(cb=Xa.next();!cb.done;cb=Xa.next())cb=cb.value,this.convertToLinkedEntityManager.kwj(cb)&&this.VBg(Ib,cb,Qa);0<Ib.ControlList.length&&yb.MenuSectionList.push(Ib);return yb};e.prototype.VBg=function(Xa,yb,Ib){if(yb){var Qa="Data.ConvertToLinkedEntityMenuItem_"+yb.Name,cb=this.convertToLinkedEntityManager.qQ(yb.DomainId);cb&&(yb=Object(Ja.a)(new Rb.a,{Id:Qa,ExternalId:Qa,
Command:"-1662108744",LabelText:yb.Name,Alt:yb.SuperTip,Visible:!0,MenuItemId:b(967).ConvertToLinkedEntityManager.u1a(yb.DomainId),Image16by16:Ib,Image16by16Class:this.T6h(cb.FontLocator)}),Xa.ControlList.push(yb))}};e.prototype.tFh=function(Xa,yb){var Ib={};Ib=(Ib.width=24,Ib["min-width"]=24,Ib.height=24,Ib);var Qa={};return Object(Ja.a)(new yc.a,{Id:b(967).ConvertToLinkedEntityManager.oJe+Xa.toString(),ExternalId:b(967).ConvertToLinkedEntityManager.oJe+Xa.toString(),MenuItemId:b(967).ConvertToLinkedEntityManager.V6c+
Xa.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.o8e(yb.FontLocator),LabelText:yb.Name,PreviewIconStyle:(Qa.root=Ib,Qa),Alt:this.jdd(yb)})};e.prototype.iMg=function(Xa){switch(Xa){case "Animal":return bc.a.HIg;case "Apple":return bc.a.IJg;case "Atom":return bc.a.eLg;case "Beaker":return bc.a.cNg;case "Bridge":return bc.a.COg;case "Cat":return bc.a.EUg;case "City":return bc.a.TWg;case "Constellation":return bc.a.S0g;case "Dog":return bc.a.Mgh;case "Finance":return bc.a.VMg;
case "GradCap":return bc.a.G_h;case "HumanAnatomy":return bc.a.c6h;case "LocationPointer":return bc.a.asi;case "Map":return bc.a.vTi;case "MedicineNeedle":return bc.a.qyi;case "Mountain":return bc.a.Lzi;case "Movie":return bc.a.eAi;case "Music":return bc.a.rAi;case "OuterSpace":return bc.a.$Ti;case "Planet":return bc.a.XWi;case "Satellite":return bc.a.Mhj;case "WolframGeneric":return bc.a.Fgj;default:return bc.a.E2g}};e.prototype.T6h=function(Xa){if("PowerBIRibbon"!==Xa)return I.a.i9c;switch(Xa){case "AnimalRibbon":return I.a.msh;
case "AppleRibbon":return I.a.nsh;case "AtomRibbon":return I.a.osh;case "BeakerRibbon":return I.a.psh;case "BridgeRibbon":return I.a.qsh;case "CenterMapRibbon":return I.a.rsh;case "CityRibbon":return I.a.ssh;case "CurrencyRibbon":return I.a.tsh;case "ExerciseRibbon":return I.a.ush;case "FinanceRibbon":return I.a.oPe;case "FirstAidRibbon":return I.a.vsh;case "GlobeLightningRibbon":return I.a.wsh;case "GradCapRibbon":return I.a.xsh;case "HumanAnatomyRibbon":return I.a.ysh;case "LeafRibbon":return I.a.zsh;
case "LocationPointerRibbon":return I.a.Bsh;case "MapRibbon":return I.a.mPe;case "MountainRibbon":return I.a.Csh;case "MovieRibbon":return I.a.Dsh;case "MusicRibbon":return I.a.Esh;case "NotablePeopleRibbon":return I.a.Fsh;case "OuterSpaceRibbon":return I.a.Gsh;case "PartlySunnyWeatherRibbon":return I.a.Hsh;case "PowerBIRibbon":return I.a.nPe;case "SatelliteRibbon":return I.a.Ish;case "WolframGenericRibbon":return I.a.Ash;case "YogaRibbon":return I.a.Ksh;default:return I.a.lPe}};e.prototype.o8e=function(Xa){switch(Xa){case "AnimalRibbon":return"AnimalExcelDataTypes_24";
case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";
case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";
case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}};e.prototype.zFh=function(Xa,yb){yb=this.Ta.uC("ConvertToLinkedEntitySection_"+yb,this.Pjf,this.Ojf);for(var Ib=!1,
Qa=Gl(Xa.DomainIds),cb=Qa.next();!cb.done;cb=Qa.next()){var lb=cb.value;(cb=this.convertToLinkedEntityManager.qQ(lb))&&!cb.DomainBlocked&&cb.ShowInRibbon&&(Ib=cb.Name,lb=b(967).ConvertToLinkedEntityManager.u1a(lb),yb.Kt("Data.ConvertToLinkedEntityMenuItem_"+lb,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,lb,this.o8e(cb.FontLocator),void 0,void 0,this.jdd(cb),Ib),Ib=!0)}if(!Ib)return null;yb=yb.P0b(!0);Qa=this.Ta.Pc();Qa.title=Xa.Name;Xa=Qa.S0b();Xa.ControlList.push(yb);return Xa};e.prototype.OPj=
function(){this.Pjf=5;this.Ojf="Size112by64"};e.prototype.jdd=function(Xa){return Xa.RibbonTooltipHeader?Xa.RibbonTooltipHeader+"\n\n"+Xa.RibbonTooltip:Xa.RibbonTooltip};Object(y.a)(e,"ConvertToLinkedEntityMenuRenderer",null,[795]);var Vb=b(55),mc=b(121),sb=b(187),Yb=b(78);c.prototype.lUh=function(){this.Nid||Bb.EwaSettings.isChangeGateEnabled("OfficeVSO:6422438_RoamingHandlerNoSessionIdPresent")&&!this.$.ea.rc||(A.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),
qa.T(this.$.na.va,0,this.GOi,this.XAf,null,null))};c.prototype.Sfg=function(Xa){Xa&&Xa.length?this.Nid?(Xa=this.Zlj(Xa))?(A.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),qa.pb(this.$.na.va,0,Xa,this.USi,this.XAf,null,null)):A.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.Kid=!0:A.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")};
c.prototype.Zlj=function(Xa){if(!Xa||!Xa.length)return A.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var yb=[];Xa=Gl(Xa);for(var Ib=Xa.next();!Ib.done;Ib=Xa.next()){Ib=Ib.value;var Qa={};Qa.Id=Ib.Id;Ib.StringId&&(Qa.StringId=Ib.StringId);yb.push(Qa)}yb="<DataTypes>"+Vb.a.Jc(yb)+"</DataTypes>";return 1906<yb.length?(A.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),
null):yb};c.prototype.pVi=function(Xa){if(!Xa)return A.ULS.sendTraceTag(537166685,0,15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!Xa.startsWith("<DataTypes>")||!Xa.endsWith("</DataTypes>"))return A.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;Xa=Xa.substring(11,Xa.length-12);if(!Xa)return A.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;
var yb=[];try{yb=Vb.a.ni(Xa)}catch(Ib){return A.ULS.sendTraceTag(537166682,0,10,"ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: {0}",Ib.message),null}A.ULS.sendTraceTag(537166681,0,50,"ParseRecentlyUsedLinkedDataTypes returned {0} data types.",yb.length);return yb};c.prototype.Fyi=function(Xa){var yb=this.Sza.aHb,Ib=this.Sza.G4i;if(yb.length!==Ib){for(var Qa=0;Qa<Xa.length&&yb.length<Ib;++Qa){var cb=Xa[Qa];this.Sza.qQ(cb)&&!Array.contains(yb,cb)&&yb.push(cb)}this.Sza.aHb=yb}};
Object(y.a)(c,"LinkedDataTypeRoamingHandler",null,[]);var Hb=b(560),sc=b(59),zb=b(51),vc=b(263),ad=b(37),ub=b(47),Za=b(28),wa=b(293),ja=b(21),Ua=b(99);b.d(C,"ConvertToLinkedEntityManager",function(){return a});var bb=G.a;Wl(a,bb);a.prototype.dispose=function(){(this.lzb||this.S5a||this.G6a)&&this.$.ea.uv(this.Hf);Bb.EwaSettings.ma(654)&&this.$.ea.Dk(this.od);!this.f$&&Bb.EwaSettings.ma(131)&&Bb.EwaSettings.ma(139)&&this.gridView.Ww(this.onContentReady);this.hn&&this.hn.dispose();this.$.rD(this.ej);
this.$.yl(this.vd);this.S5a&&(this.omd=null);B.a.Ha(this.Tya)};a.prototype.XEg=function(Xa){this.addHandler("LinkedEntityConverted",Xa)};a.prototype.daj=function(Xa){this.removeHandler("LinkedEntityConverted",Xa)};a.prototype.selectEntity=function(Xa){return this.hn?this.hn.selectEntity(Xa):!1};a.prototype.searchEntity=function(Xa,yb){this.hn&&this.hn.searchEntity(Xa,yb)};a.prototype.oMd=function(Xa,yb,Ib,Qa){this.hn&&this.hn.searchEntity(Xa,yb,!0,Ib,Qa)};a.prototype.NCb=function(Xa){return this.hn?
this.hn.NCb(Xa):!1};a.prototype.onPaneClosed=function(){if(this.hn)this.hn.onPaneClosed()};a.prototype.cancelSearch=function(){this.hn&&this.hn.cancelSearch()};a.prototype.selectDataType=function(Xa){this.hn&&this.hn.selectDataType(Xa)};a.prototype.showHelpArticle=function(Xa){this.hn&&this.hn.showHelpArticle(Xa)};a.prototype.showSurveyDialog=function(Xa){this.hn&&this.hn.showSurveyDialog(Xa)};a.prototype.insertTable=function(Xa,yb){this.hn&&this.hn.insertTable(Xa,yb)};a.prototype.H2h=function(Xa){if(this.$.isEditMode&&
this.jTf!==Xa&&P.AFrameworkApplication.fa.ra("SupportsPolicies")){this.jTf=Xa;A.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels");Xa=this.$.na.va;var yb=this.wKi,Ib=Xa.Na(1,null);qa.i(Xa,"GetRichDataClassificationLabels",Ib,yb,null,null,null,4)}};a.prototype.wKe=function(){function Xa(Ib,Qa,cb){var lb=yb.$.na.va;Ib=zc.b(Ib,yb.eIi);var Ha=lb.Na(1,null);return qa.i(lb,"LinkedEntitiesEnableUntrustedImages",Ha,Ib,Qa,cb,null,0)}
var yb=this;Bb.EwaSettings.qc()?this.$.userOperationManager.jc(new nc.a(589,0,Xa,80),null):this.$.userOperationManager.jc(new Hb.a(589,0,Xa,16),null)};a.prototype.showUntrustedImageBusinessBarIfNecessary=function(){this.uXd||this.Xag||!this.$.ea.rc||this.elj()};a.prototype.elj=function(){function Xa(Ib,Qa,cb){var lb=yb.$.na.va;Ib=zc.b(Ib,yb.SJi);var Ha=lb.Na(1,null);return qa.i(lb,"GetHasUntrustedImageUrls",Ha,Ib,Qa,cb,null,4)}var yb=this;Bb.EwaSettings.qc()?this.$.userOperationManager.jc(new nc.a(588,
0,Xa,80),null):this.$.userOperationManager.jc(new Hb.a(588,0,Xa,16),null)};a.prototype.GWd=function(Xa){var yb=this;if(this.S5a&&null==this.omd&&!this.G6a&&P.AFrameworkApplication.fa.ra("SupportsPolicies")&&null!=this.uMa&&this.uMa&&(!Xa||this.$.workbookContext.Options&262144)){var Ib=zb.GetServiceTaskFactory.Xa(this.$.da,274,275,0);ad.TaskExtensions.Ba(Ib,function(){yb.omd=Ib.result.TMf(2)},this.$.la,3)}};a.prototype.F2g=function(Xa){(Xa=this.Qgh(Xa))?this.convertToLinkedEntity(Xa):A.ULS.sendTraceTag(537166920,
0,10,"Could not convert key into domain ID")};a.prototype.convertToLinkedEntity=function(Xa){A.ULS.sendTraceTag(34415004,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: {0}].",Xa.Id);if(this.gridView){var yb=this.gridView.ha.ta.qd,Ib=yb.Se(this.gridView.hH);this.bxa&&this.Amd&&this.GCg(Xa);if(Ib){Ib=this.gridView.Nb.Uwa(Ib);if(!this.S5e(Xa)&&this.Oef(Xa.Id)){A.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");
if(sc.a.Fg.lR){yb=this.Acd();if(!yb){A.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Ib=this.l4b();if(!Ib){A.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var Qa={};Qa=(Qa.InputMethod=Ta.a.Sb,Qa);Qa.CalloutName=3;Qa.Target=yb;Qa.RibbonButtonLabel=Bb.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.ZSf(Xa):this.HAb(Xa.Id.toString());Qa.ExampleEntities=this.oQe(Xa);this.$.Ka.Wb(Ib,
Qa);return}A.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.Oef(Xa.Id)&&!Xa.StringId)this.launchLinkedEntityDataTypeSelectorPane(a.u1a(Xa));else{if(Ib){A.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(Bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",
!1)&&this.SEj(Xa)){yb=Cb.r(this.gridView.ha.ta.selectedRanges,this.$);this.hn.upi(yb,Xa);return}if(sc.a.Fg.lR){yb=this.Acd();if(!yb){A.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Ib=this.l4b();if(!Ib){A.ULS.sendTraceTag(537166912,0,50,"RibbonCommandInfo is null for blankCellConvert");return}Qa={};Qa=(Qa.InputMethod=Ta.a.Sb,Qa);Qa.CalloutName=2;Qa.Target=yb;Qa.RibbonButtonLabel=this.ZSf(Xa);Qa.ExampleEntities=this.oQe(Xa);Qa.BlankCellResourceId=this.DNg(Xa);
Qa.HasBlankCellWalkthrough=this.s3h(Xa);Qa.ServiceDomain=Xa.Id;this.$.Ka.Wb(Ib,Qa);return}A.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.m2c(Xa,!1,yb)}}}else A.ULS.shipAssertTag(537166919,0,!1,"grid view should not be null")};a.prototype.convertToLinkedEntityFromAutoDetect=function(){this.f$&&this.f$.tHa()};a.prototype.onAutoDetectUIShown=function(){function Xa(Ib,Qa,cb){var lb=yb.$.na.va,
Ha=lb.Na(1,null);return qa.i(lb,"OnAutoDetectUIShown",Ha,Ib,Qa,cb,null,4)}var yb=this;Bb.EwaSettings.qc()?cc.a(this.$.userOperationManager,Xa,function(Ib){return new nc.a(230,0,Ib,80)},null):cc.a(this.$.userOperationManager,Xa,function(Ib){return new Hb.a(230,0,Ib,16)},null)};a.prototype.m2c=function(Xa,yb,Ib){function Qa(){return new Sa.a}var cb=this,lb=Cb.q(Ib,this.$);cc.a(this.$.userOperationManager,function(Ha,$b,Jb){var kc=cb.$.na.va;Ha=zc.b(Ha,cb.$Gi,cb.YQi,Object(aa.a)(cb.hn,cb.hn.ZGi,"onConvertToLinkedEntitySucceeded"));
var uc=kc.Na(1,null);uc.selectedRanges=lb;uc.domainId=Xa;uc.autodetect=yb;return qa.i(kc,"ConvertToLinkedEntity",uc,Ha,$b,Jb,null,4)},function(Ha){return new nc.a(115,0,Ha,void 0,Qa)},null)};a.prototype.GCg=function(Xa){if(this.bxa&&this.Amd){var yb={};yb.Id=Xa.Id;Xa.StringId&&(yb.StringId=Xa.StringId);if(!(0<this.lK.length&&this.lK[0].Id===yb.Id&&this.lK[0].StringId===yb.StringId)){Xa=!1;Array.insert(this.lK,0,yb);for(var Ib=1;Ib<this.lK.length;++Ib)if(this.lK[Ib].Id===yb.Id&&this.lK[Ib].StringId===
yb.StringId){Array.removeAt(this.lK,Ib);Xa=!0;break}for(;5<this.lK.length;)Array.removeAt(this.lK,this.lK.length-1);this.Vba.Categories[a.O7a].DomainIds=this.lK;this.XRf();this.ypd&&!Xa&&this.nLd.Sfg(this.lK)}}};a.prototype.convertLinkedEntityToText=function(){var Xa=this;A.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var yb=Cb.q(this.gridView.ha.ta.qd,this.$);cc.a(this.$.userOperationManager,function(Ib,Qa,cb){var lb=
Xa.$.na.va,Ha=lb.Na(1,null);Ha.selectedRanges=yb;return qa.i(lb,"ConvertLinkedEntityToText",Ha,Ib,Qa,cb,null,4)},function(Ib){return new nc.a(116,0,Ib)},null)}else A.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")};a.prototype.refreshLinkedEntitiesInRange=function(){var Xa=this;A.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");if(Eb.g(this.$)){this.$.isEditMode||A.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");
this.gId();var yb=Cb.r(this.gridView.ha.ta.selectedRanges,this.$);cc.a(this.$.userOperationManager,function(Ib,Qa,cb){var lb=Xa.$.na.va,Ha=lb.Na(1,null);Ha.selectedRanges=yb;return qa.i(lb,"RefreshLinkedEntitiesInRange",Ha,Ib,Qa,cb,null,4)},function(Ib){return new nc.a(248,0,Ib)},null)}else A.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")};a.prototype.kwj=function(Xa){Xa=this.qQ(Xa.DomainId);if(!Xa||Xa.DomainBlocked||Bb.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&
!Xa.HasCuratedData)return!1;if(this.hii){for(var yb=Gl(this.UU),Ib=yb.next();!Ib.done;Ib=yb.next())if(Ib=Ib.value,Ib.value.DomainId.Id===Xa.DomainId.Id&&Ib.value.ShowInRibbon)return!0;return!1}return Xa.ShowInRibbon};a.prototype.$uj=function(Xa){return 2!==this.ks||!this.sia[Xa]};a.prototype.launchDisambiguationPaneForSearch=function(){this.hn&&this.hn.launchDisambiguationPaneForSearch()};a.prototype.jd=function(Xa,yb,Ib){if("PopulateConvertToLinkedEntityMenu"!==yb)return!1;this.xbd=Ib.MenuId;if(0===
this.ks||3===this.ks)return this.xXi(),!0;if(!this.Vba)return A.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),!1;if(!this.UU)return A.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.LY=this.LY||this.w8a.WEh(this.Vba,Ib.MenuId);Ib.MenuItems=this.LY;return this.Amd=!0};a.prototype.xXi=function(){var Xa=this;-1===this.adc&&(this.F$a(),this.adc=window.setInterval(function(){Xa.F$a()},2E3))};a.prototype.F$a=function(){if(this.$.ea.rc&&
2!==this.ks){this.KKa--;A.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");this.ks=1;var Xa=this.$.na.va,yb=this.$Ji,Ib=this.ZJi,Qa=Xa.Na(1,null);qa.i(Xa,"GetLinkedEntityMetadata",Qa,yb,Ib,null,null,4)}};a.prototype.nnd=function(){return this.$.isEditMode&&2!==this.ks&&(0<=this.KKa||!this.WOa)};a.prototype.eYd=function(Xa){P.AFrameworkApplication.Ng?A.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):
Y.a(this.$)?(this.kQj(),Xa&&this.$.Bf()):A.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")};a.prototype.sej=function(){this.xwb=this.oDb=0;this.KKa=8;this.WOa=!1;this.ks=this.adc=0;this.rNa=this.Vba=null;this.m2b();for(var Xa=0;Xa<this.SNa;++Xa)this.sia[Xa]=null;this.zyb()&&this.eYd(!0)};a.prototype.m2b=function(){this.LY=null};a.prototype.zyb=function(){var Xa=R.a.VGb,yb=Y.a(this.$);return!!yb&&yb.Wl.FB===Xa};a.prototype.Ibg=function(){if(this.Vba){var Xa=
0;if(this.bxa){var yb=-1,Ib=-1,Qa=0,cb=0,lb=0,Ha=0,$b=[null,null,null,null,null],Jb=Gl(this.Vba.Categories);for(hd=Jb.next();!hd.done;hd=Jb.next()){var kc=!1;hd=Gl(hd.value.DomainIds);for(ma=hd.next();!ma.done;ma=hd.next()){ma=ma.value;var uc=this.qQ(ma);uc&&!uc.DomainBlocked&&uc.ShowInRibbon&&(Xa<this.SNa?(this.sia[Xa]=ma,cb===a.O7a&&(-1===yb&&(yb=Xa),Ib=Xa,Ha=Ib-yb+1),++Xa):Xa===this.SNa&&Qa<Ha&&cb!==a.O7a&&($b[Qa]=ma,++Qa),kc=!0)}kc&&++lb;++cb}if(-1<yb&&lb<=a.Qjf){for(;Ib>=yb;--Ib)Array.removeAt(this.sia,
Ib);for(yb=0;yb<Ha;++yb)Array.insert(this.sia,Xa+yb,$b[yb])}}else{Ha=Gl(this.Vba.Categories);for(var hd=Ha.next();!hd.done;hd=Ha.next()){$b=Gl(hd.value.DomainIds);for(var ma=$b.next();!ma.done&&!(yb=ma.value,(Ib=this.qQ(yb))&&!Ib.DomainBlocked&&Ib.ShowInRibbon&&(this.sia[Xa]=yb,++Xa,Xa>=this.SNa));ma=$b.next());if(Xa>=this.SNa)break}}for(;Xa<this.SNa;)this.sia[Xa]=null,++Xa}};a.prototype.H$f=function(){var Xa=Object(E.a)(387,Eb.g(this.$).Ea),yb=this.gridView.ha.We;return Xa&&Xa.nid&&1===yb&&this.gridView.ha.ta.activeCell?
(Xa=zb.GetServiceTaskFactory.Xa(this.$.da,12,477,1),this.f$=new U.a(this.$,this.svgIconProvider,Xa.result,this),!0):!1};a.prototype.xpi=function(){this.hn&&this.hn.psd(!0)};a.prototype.launchLinkedEntityDataTypeSelectorPane=function(Xa){if(this.hn)if(Xa=this.B6c(Xa))if(Xa.DomainId.StringId)A.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var yb=Cb.r(this.gridView.ha.ta.selectedRanges,this.$);this.hn.launchLinkedEntityDataTypeSelectorPane(yb,
Xa.DomainId.Id)}else A.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")};a.prototype.W0g=function(Xa){var yb=this.S6h(Xa),Ib=Q.a.vg(this.HAb(Xa));Xa=Q.a.vg(this.FVd(Xa));return a.AEh(yb,qd.a.gf(11),Ib,Xa)};a.prototype.FVd=function(Xa){try{return this.AIe(parseInt(Xa,10)).Description}catch(yb){}return Pa.a.instance.ga(1769)};a.prototype.HAb=function(Xa){try{return this.AIe(parseInt(Xa,10)).Name}catch(yb){}return Pa.a.instance.ga(1755)};a.prototype.ZSf=function(Xa){try{return this.qQ(Xa).Name}catch(yb){}return this.HAb(Xa.Id.toString())};
a.prototype.DNg=function(Xa){try{return this.qQ(Xa).BlankCellResourceId}catch(yb){}return null};a.prototype.s3h=function(Xa){try{return this.qQ(Xa).HasBlankCellWalkthrough}catch(yb){}return!1};a.prototype.S5e=function(Xa){try{var yb=a.u1a(Xa);if(this.UU.yb(yb))return this.UU.oa(yb).HasCuratedData}catch(Ib){}return!1};a.prototype.SEj=function(Xa){try{return this.qQ(Xa).SupportsStarterData}catch(yb){}return!1};a.prototype.Oef=function(Xa){return 268435968===Xa};a.prototype.Acd=function(){return 2===
Y.a(this.$).bX?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"};a.prototype.l4b=function(){return new nb.a(-847286761,Ta.a.Sb,this.$.Xc,0,R.a.IW)};a.prototype.nDe=function(){if(this.zyb()&&!this.nnd()&&!this.ucf&&Bb.EwaSettings.ma(443)&&this.S5e({Id:268435968,StringId:null}))if(A.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),sc.a.Fg.lR){var Xa=this.Acd();if(Xa){var yb=
this.l4b();if(yb){var Ib={};Ib=(Ib.InputMethod=Ta.a.Sb,Ib);Ib.CalloutName=6;Ib.Target=Xa;Ib.ShouldCanvasTakeFocus=!0;this.$.Ka.Wb(yb,Ib);this.ucf=!0}else A.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else A.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else A.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")};
a.prototype.n6h=function(Xa){Xa=this.B6c(Xa);return Xa?this.w8a.iMg(Xa.SubdomainFontLocator):(A.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)};a.prototype.ufc=function(Xa){return this.f$?this.f$.hMg(Xa):!1};a.prototype.DHh=function(){return this.f$?this.f$.vIh():""};a.prototype.xdi=function(){return this.f$?this.f$.pBb:!1};a.prototype.nMh=function(Xa,yb){var Ib=this.b9e(Xa);if(0>Ib)A.ULS.sendTraceTag(537166813,
0,10,"Unexpected menuItemKey for dynamic preview gallery button: {0}",Xa);else if(Xa=(Xa=this.BIe(Xa))?this.qQ(Xa):null)yb[M.a.GalleryButtonProps]=this.w8a.tFh(Ib,Xa),yb[M.a.Alt]=this.w8a.jdd(Xa)};a.prototype.XRf=function(){this.Ibg();this.zyb()&&this.eYd(!0);this.m2b()};a.prototype.S6h=function(Xa){return Xa===this.mSe?I.a.oPe:Xa===this.xVe?I.a.mPe:I.a.lPe};a.prototype.oQe=function(Xa){try{return this.qQ(Xa).ExampleEntities}catch(yb){}return Pa.a.instance.ga(1777)};a.prototype.Frc=function(){(0>
this.KKa||this.WOa)&&A.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.ks||0>this.KKa||this.WOa)&&window.clearInterval(this.adc);this.nnd()?this.xbd&&this.$.frame.Lv(this.xbd):this.eYd(this.zyb())};a.prototype.$b=function(Xa){return this.$.Mb+Xa};a.prototype.kQj=function(){var Xa=!0,yb=Array(this.SNa),Ib=Y.a(this.$)?Y.a(this.$).Wl:null;if(Ib){for(var Qa=0;Qa<yb.length;++Qa)this.$uj(Qa)?yb[Qa]=!0:Xa=yb[Qa]=!1;Ib.EOd(["ConvertToLinkedEntityGallery"],
Xa);if(!Xa)for(Xa=0;Xa<yb.length;++Xa)yb[Xa]&&Ib.EOd([this.mMh(Xa)],!0)}else A.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")};a.prototype.qQ=function(Xa){var yb=a.u1a(Xa);if(this.UU.yb(yb))return this.UU.oa(yb);A.ULS.sendTraceTag(592729218,0,15,"No domain data for domain ID {0} (Has String ID: {1})",Xa.Id,!!Xa.StringId);return null};a.prototype.mMh=function(Xa){return"ConvertToLinkedEntityPreview"+Xa.toString()};a.prototype.XXd=function(){var Xa=
this;ba.a.get_instance().Nk(10,function(){Xa.nDe();Xa.wZc&&Xa.Hdf&&vc.b(Xa.njf,Xa.$.la,500)})};a.prototype.Pcc=function(Xa,yb){switch(Xa){case "QueryLinkedEntityGalleryButtons":if(!yb[M.a.InnerHTML]){Xa=yb[Ta.a.kd].toString();var Ib=ja.a.equals(Xa,Pa.a.instance.ga(1772),!0)||ja.a.equals(Xa,Pa.a.instance.ga(1773),!0),Qa=ja.a.equals(Xa,Pa.a.instance.ga(1774),!0);Ib||Qa||this.nMh(Xa,yb)}break;case "QueryLinkedEntityMenuGalleryButtons":yb[M.a.InnerHTML]||(yb[M.a.InnerHTML]=this.W0g(yb[Ta.a.kd]))}return yb};
a.prototype.Qgh=function(Xa){var yb=this.BIe(Xa);if(yb)return yb;if(yb=this.B6c(Xa))return yb.DomainId;A.ULS.sendTraceTag(537166805,0,10,"Could not convert key into domain: {0}",Xa);return null};a.prototype.AIe=function(Xa){var yb={};yb.Id=Xa;return this.qQ(yb)};a.prototype.B6c=function(Xa){return this.UU.yb(Xa)?this.UU.oa(Xa):null};a.prototype.b9e=function(Xa){if(!Xa.startsWith(a.V6c))return-1;var yb=parseInt(Xa.substr(a.V6c.length),10);return isNaN(yb)?(A.ULS.sendTraceTag(537166802,0,10,"Unexpected index in preview gallery button key: {0}",
Xa),-1):yb};a.prototype.BIe=function(Xa){Xa=this.b9e(Xa);return 0>Xa?null:this.sia[Xa]};a.prototype.baf=function(Xa,yb,Ib){if(this.lzb&&this.UU&&this.UU.count){A.ULS.sendTraceTag(537166801,0,50,"ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. ({0})",Xa);var Qa=this.$.na.va.hc();this.$.ea.rc&&(Xa=this.$.na.va,yb=zc.b(this.zMi,yb),Qa=Xa.Na(1,void 0===Qa?null:Qa),qa.i(Xa,"LinkedEntityTryAutoRefresh",Qa,yb,Ib,null,null,0))}};a.prototype.cLj=function(){this.baf("Auto-refresh on load",null,
null)};a.prototype.gLj=function(){this.lzb&&this.UU&&this.UU.count&&(this.Tya?A.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.Qm.HasAutoRefreshableLinkedEntityDomainsEver?(A.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),
this.Tya=ub.a.instance.create(this.nZc,this.m0b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):A.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))};a.prototype.dMb=function(){if((!this.aMa||null!=this.kpd&&null!=this.lpd)&&this.$.ea.rc&&null!=this.uMa&&null!=this.tic&&null!=this.Whc)if(++this.oDb,12>=this.oDb){1===this.oDb&&
(this.B4a=Za.a.Ua.oe.m,A.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));var Xa=this.$.na.va.hc();qa.O(this.$.na.va,this.Bjf,this.Cjf(),this.ENi,this.DNi,null,Xa)}else A.ULS.sendTraceTag(537166751,0,15,"StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration {0} ms",Za.a.Ua.oe.m-this.B4a),this.WOa=!0,this.Frc()};a.prototype.lxe=function(){var Xa=this;if(this.$.isEditMode)if(null!=this.uMa)this.dMb();else{var yb=Za.a.Ua.oe.m,Ib=
[];V.a.instance.kc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Qa){Qa.isFeatureEnabled("ExcelPowerBiPro",!1).then(function(cb){A.ULS.sendTraceTag(537166747,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPro",Za.a.Ua.oe.m-yb);A.ULS.sendTraceTag(537166746,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiPro",cb);return Xa.uMa=cb}).then(function(){Ib.push(Qa.isFeatureEnabled("ExcelWolframAlpha",
!1).then(function(cb){A.ULS.sendTraceTag(590960588,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelWolframAlpha",Za.a.Ua.oe.m-yb);A.ULS.sendTraceTag(537166743,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelWolframAlpha",cb);return Xa.tic=cb}))}).then(function(){Ib.push(Qa.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(function(cb){A.ULS.sendTraceTag(537166741,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.",
"ExcelDisableStockGeographyDataTypes",Za.a.Ua.oe.m-yb);A.ULS.sendTraceTag(537166740,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelDisableStockGeographyDataTypes",cb);var lb,Ha=[(lb=new Yb.a,lb.name="IsRestrictedByLicense",lb.bool=cb,lb)];sb.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,Ha);Xa.qqd=cb&&Bb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return cb}))}).then(function(){Ib.push(Qa.isFeatureEnabled("StockHistory",
!1).then(function(cb){A.ULS.sendTraceTag(537166739,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","StockHistory",Za.a.Ua.oe.m-yb);A.ULS.sendTraceTag(537166738,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","StockHistory",cb);Xa.Whc=cb;Xa.aMa||Xa.dMb();return cb}))}).then(function(){Xa.aMa&&Ib.push(Qa.isFeatureEnabled("ExcelPowerBiFree",!1).then(function(cb){A.ULS.sendTraceTag(537166736,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.",
"ExcelPowerBiFree",Za.a.Ua.oe.m-yb);A.ULS.sendTraceTag(537166735,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]","ExcelPowerBiFree",cb);return Xa.kpd=cb}))}).then(function(){Xa.aMa&&Ib.push(Qa.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(function(cb){A.ULS.sendTraceTag(537166734,0,50,"CheckE5LicensingAndStartDelayedHandshake for {0} takes {1} Millisecond.","ExcelPowerBiPremiumPerUser",Za.a.Ua.oe.m-yb);A.ULS.sendTraceTag(537166733,0,50,"CheckE5LicensingAndStartDelayedHandshake: featureName=[{0}] isEnabled=[{1}]",
"ExcelPowerBiPremiumPerUser",cb);return Xa.lpd=cb}))}).then(function(){Xa.aMa&&Promise.all(Ib).then(function(){Xa.dMb()})})})}};a.prototype.zMf=function(){++this.xwb;if(12>=this.xwb){1===this.xwb&&(this.B4a=Za.a.Ua.oe.m,A.ULS.sendTraceTag(570769946,0,50,"ConvertToLinkedEntityManager.RefreshHandshake - starting handshake refresh."));var Xa=this.$.na.va,yb=this.Bjf,Ib=this.Cjf(),Qa=this.POi,cb=this.OOi,lb=Xa.Na(1,null);lb.featureNames=yb;lb.isEnabledValues=Ib;qa.i(Xa,"RefreshLinkedEntityWebServiceHandshake",
lb,Qa,cb,null,null,4)}else A.ULS.sendTraceTag(570769945,0,15,"ConvertToLinkedEntityManager.RefreshHandshake - Retry count expired - failed handshake duration {0} ms",Za.a.Ua.oe.m-this.B4a),this.WOa=!0,this.Frc()};a.prototype.Cjf=function(){return this.aMa?[this.uMa,this.tic,this.Whc,this.kpd,this.lpd,this.qqd]:[this.uMa,this.tic,this.Whc,this.qqd]};a.prototype.gId=function(){this.businessBar&&this.businessBar.bMa(56)&&this.businessBar.removeEntry(56)};a.prototype.I1h=function(Xa){if(this.Nsd!==Xa&&
this.businessBar)if(this.Nsd=Xa){Xa=this.$.na.va;var yb=this.CJi,Ib=Xa.Na(1,null);qa.i(Xa,"GetErrorMessageForLinkedDataTypeRefresh",Ib,yb,null,null,null,4)}else this.gId()};a.AEh=function(Xa,yb,Ib,Qa){Xa=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',Xa,yb,Qa);Ib=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',Ib);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',
Xa,Ib)};a.u1a=function(Xa){return Xa.StringId?Xa.Id.toString()+"."+Xa.StringId:Xa.Id.toString()};Ck.Object.defineProperties(a.prototype,{G4i:{configurable:!0,enumerable:!0,get:function(){return 5}},aHb:{configurable:!0,enumerable:!0,get:function(){return this.lK},set:function(Xa){this.lK=Xa}},SNa:{configurable:!0,enumerable:!0,get:function(){return this.sia.length}},myi:{configurable:!0,enumerable:!0,get:function(){return this.uae}},Bjf:{configurable:!0,enumerable:!0,get:function(){return this.aMa?
"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" "):["ExcelPowerBiPro","ExcelWolframAlpha","StockHistory","ExcelDisableStockGeographyDataTypes"]}}});a.oJe="ConvertToLinkedEntityPreview";a.V6c="PreviewGalleryButtonIndex.";a.O7a=0;a.Qjf=2;Object(y.a)(a,"ConvertToLinkedEntityManager",G.a,[777,778,3,779])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.le.js.map/ff596f9915cab6cba247b74925089524/EwaDS.le.js.map