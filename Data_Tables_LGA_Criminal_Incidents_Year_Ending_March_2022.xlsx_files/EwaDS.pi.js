(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[18],{1061:function(y,C,b){function a(v){var t=this;this.businessBar=this.y7a=null;this.hFi=function(z,D){D.n6c?t.jFi(D):t.iFi(D)};this.Uh=function(z,D){z=D.context.methodName;t.y7a&&z===t.y7a&&(l.ULS.sendTraceTag(537155230,0,50,'NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "{0}" has now succeeded. Querying local storage for BB showings.',t.y7a),t.U7a(a.TJb,!0),t.y7a=null);t.Alf(!1);t.s3b=!1};this.Wn=function(z,
D){m.a.nh(D.errors,[-1387426400])&&!t.s3b&&(t.s3b=!0,t.h1f()&&window.performance.mark(a.vsf),(new c(t)).spi())};this.Ig=function(){t.Alf(!0);t.U7a(a.aDb,!1);t.U7a(a.TJb,!1)};this.tya=function(){l.ULS.sendTraceTag(537155225,0,50,"NetworkConnectionHealthChecker.OnNetworkResumed: Network resumed for session. Querying local storage for BB showings.");t.U7a(a.aDb,!0)};this.$=v;this.na=this.$.na;this.localStorage=new x.a;this.s3b=!1;this.$.ea.Fl(this.Ig);this.na.rf.knb(this.tya);this.na.zq(this.Uh);this.$.da.$a(5,
function(z){t.businessBar=z;z.rDg(t.hFi)});this.na.Uy(this.Wn)}function c(v){var t=this;this.Rjd=[u.a.Kgg,u.a.LDc];this.Jn=function(z,D){t.eO[D]=z;t.X3h()&&t.qdj("OnNetworkDownImmediatePing"===z.caller)};this.Cla=v;this.$=v.$;this.eO={}}function e(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}b.r(C);y=b(0);var f=b(7),l=b(15),n=b(332),m=b(30),h=b(10),x=b(322);Object(y.a)(e,"ConnectionErrorLogInfo",null,[]);var u=b(1280),w=b(1325);c.prototype.spi=function(){var v=w.a.Tbd(this.Jn,
"OnNetworkDownImmediatePing",this.$,this.Rjd);v=Gl(v);for(var t=v.next();!t.done;t=v.next())t.value.runTest()};c.prototype.X3h=function(){for(var v=Gl(this.Rjd),t=v.next();!t.done;t=v.next())if(t=t.value,void 0===this.eO[t]||null===this.eO[t])return!1;return!0};c.prototype.qdj=function(v){var t=this.$.rf.TV;v&&this.XDj(t);v=Gl(this.Rjd);for(var z=v.next();!z.done;z=v.next())z=z.value,this.eO[z]=Sys.Serialization.JavaScriptSerializer.serialize(this.eO[z]);v=Date.now();z=this.Cla.Agd(b(1061).NetworkConnectionHealthChecker.aDb).returnValue;
var D=this.Cla.Agd(b(1061).NetworkConnectionHealthChecker.TJb).returnValue;this.eO.isOfflineMode=t;this.eO.networkDownBBAge=-1===z?z:v-z;this.eO.transientServerCommunicationFailuresBBAge=-1===D?D:v-D;this.Cla.businessBar?(this.eO.isNetworkDownBBShown=this.Cla.businessBar.kC(54).toString(),this.eO.isServerErrorBBShown=this.Cla.businessBar.kC(21).toString()):(this.eO.isNetworkDownBBShown="unknown",this.eO.isServerErrorBBShown="unknown");l.ULS.sendTraceTag(537155224,0,50,"ConnectionHealthTestsRunner.ReportPingResults: {0}",
Sys.Serialization.JavaScriptSerializer.serialize(this.eO))};c.prototype.XDj=function(v){for(var t=b(1061).NetworkConnectionHealthChecker,z={},D=Gl(Object.keys(this.eO)),A=D.next();!A.done;A=D.next())A=this.eO[A.value],z[A.testName]=A.isSuccess;z.isOfflineMode=v;this.Cla.vTd(t.K1c,Sys.Serialization.JavaScriptSerializer.serialize(z))};Object(y.a)(c,"ConnectionHealthTestsRunner",null,[]);b.d(C,"NetworkConnectionHealthChecker",function(){return a});a.prototype.dispose=function(){this.$&&(this.$.ea&&this.$.ea.Yn(this.Ig),
this.na&&(this.na.rf.YHb(this.tya),this.na.Qz(this.Wn),this.na.Ar(this.Uh)))};a.prototype.jFi=function(v){var t={};t.Timestamp=Date.now().toString();switch(v.wGa){case 21:this.y7a=v.data.FailedMethod;t.FailedMethod=this.y7a;this.vTd(a.TJb,JSON.stringify(t));break;case 54:this.vTd(a.aDb,JSON.stringify(t))}};a.prototype.iFi=function(v){switch(v.wGa){case 21:this.U7a(a.TJb,!0);break;case 54:this.U7a(a.aDb,!0)}};a.prototype.vTd=function(v,t){try{this.localStorage.Sf()&&this.localStorage.setItem(v,t)}catch(z){l.ULS.sendTraceTag(537155231,
0,15,"NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: {0}",z.message||"Unknown")}};a.prototype.Agd=function(v){if(this.localStorage.Sf()&&(v=this.localStorage.qvb(v))&&"null"!==v){var t=JSON.parse(v);v=parseInt(t.Timestamp,10);t=Sys.Serialization.JavaScriptSerializer.serialize(t);return{returnValue:v,rawData:t}}return{returnValue:-1,rawData:null}};a.prototype.Alf=function(v){if(this.localStorage.Sf()){var t=this.localStorage.qvb(a.K1c);if(t&&"null"!==
t){var z=-1;this.s3b&&(z=this.kMh(a.vsf,a.XDi));l.ULS.sendTraceTag(537155229,0,50,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: {0}, Period offline: {1}, New session: {2}",Sys.Serialization.JavaScriptSerializer.serialize(t),z,v);this.localStorage.removeItem(a.K1c)}}};a.prototype.kMh=function(v,t){if(!this.h1f())return-1;window.performance.measure(t,v);v=window.performance.getEntriesByName(t);return v.length&&v[v.length-1]?v[v.length-1].duration:(l.ULS.sendTraceTag(537155228,
0,10,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name {0} returned no measures.",t),-1)};a.prototype.U7a=function(v,t){try{var z=this.Agd(v);var D=z.rawData;var A=z.returnValue;if(-1!==A){var B=Object(f.a)(new e,{timeElapsed:Date.now()-A,scenario:v,isNewSession:!t,rawData:D});l.ULS.sendTraceTag(537155227,0,50,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: {0}",JSON.stringify(B))}this.localStorage.removeItem(v)}catch(N){l.ULS.sendTraceTag(537155226,0,15,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: {0}",
N.message||"Unknown")}};a.prototype.h1f=function(){return h.HelperMethods.sYc&&n.a.Oob};a.aDb="NetworkDownBBShown";a.TJb="ServerCommunicationFailureBBShown";a.K1c="ConnectionHealthPingRsults";a.vsf="offMoStMa";a.XDi="offMoDuMea";Object(y.a)(a,"NetworkConnectionHealthChecker",null,[3])},1280:function(y,C,b){function a(){}b.d(C,"a",function(){return a});y=b(0);a.LDc="b-ring_Apc_Trans";a.Kgg="cdn_static_resource_ewa_image";Object(y.a)(a,"ResourceHosts",null,[])},1325:function(y,C,b){function a(){}function c(h,
x,u,w,v){this.url="";this.m5a=!1;this.U7=-1;this.testIteration=0;this.baseUrl=u;this.Fuf=w;this.Jjd=x;this.result=new e(x,v)}function e(h,x){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=h;this.caller=x;this.reset()}y=b(0);var f=b(55),l=b(15),n=b(261);e.prototype.reset=function(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage=
"";this.reqTotalDurationMs=-1;this.browserResourceTiming=null};Object(y.a)(e,"NetworkTestResult",null,[]);var m=b(639);c.prototype.runTest=function(){try{if(this.m5a)return l.ULS.sendTraceTag(537155206,0,50,"NetworkTestReq.RunTest: a test for the host {0} is already mid way, not starting a new one.",this.Jjd),!1;this.reset();this.m5a=!0;this.result.startTimeMs=Date.now();var h=new n.QueryStringBuilder(this.baseUrl);h.G9("tid",this.result.startTimeMs.toString());this.url=h.toString();this.Mkj();this.testIteration++;
this.result.testIteration=this.testIteration;return!0}catch(x){return this.Ftb("Exeption: "+x.message),!1}};c.prototype.reset=function(){this.url="";this.result.reset();this.m5a=!1;this.U7=-1};c.prototype.clearTimeout=function(){-1!==this.U7&&(window.clearTimeout(this.U7),this.U7=-1)};c.prototype.Mkj=function(){var h=this;try{var x=new XMLHttpRequest;x.onreadystatechange=function(){4===x.readyState&&(200===x.status?h.nAh():h.Ftb(String.format("Error when downloading resource. status code: {0}, status text: {1}",
x.status,x.statusText),x.status.toString()))};x.onerror=function(){h.Ftb(String.format("Client error when attempting to download resource. status code: {0}, response: {1}",x.status,x.statusText))};this.U7=window.setTimeout(function(){h.U7=-1;h.Ftb("Request timeout")},1E4);x.open("GET",this.url,!0);x.send(null)}catch(u){this.Ftb("Exeption: "+u.message)}};c.prototype.nAh=function(){this.m5a&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=
m.a(this.url),this.result.isSuccess=!0,this.f3b())};c.prototype.Ftb=function(h,x){x=void 0===x?null:x;this.m5a&&(this.clearTimeout(),this.result.errorMessage=h,this.result.isSuccess=!1,this.result.errorStatusCode=x,this.f3b())};c.prototype.f3b=function(){this.m5a=!1;this.Fuf&&this.Fuf(this.result,this.Jjd)};Object(y.a)(c,"NetworkTestReq",null,[]);b.d(C,"a",function(){return a});a.Tbd=function(h,x,u,w){w=void 0===w?null:w;a.Flc||(a.Flc=Array.isArray(f.a.ni(u.ya.NetworkMeasurementUrlList))?f.a.ni(u.ya.NetworkMeasurementUrlList):
null);for(var v=[],t=0;t<a.Flc.length;t++){var z=a.Flc[t],D=z.key;D||(D=z.Key);if(!w||Array.contains(w,D)){var A=z.value;A||(A=z.Value);D&&A&&v.push(new c(u,D,A,h,x))}}return v};a.Flc=null;Object(y.a)(a,"NetworkConnectionHelpers",null,[])},1439:function(y,C,b){function a(L){var Ma=Pj.call(this)||this;Ma.$=L;Ma.Tb();return Ma}function c(){}function e(L,Ma,rb,ec,fd,yd,be){L=l.call(this,L,Ma,rb,ec,fd,!1)||this;L.CYd=!1;L.T0=be;L.gec=e.wEh(yd);yd=L.aZd(L.gec.name,L.gec.size);if(0!==yd)return L.qRd(yd),
L.T0.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),L.dispose(),L;L.Ij=new u(L.$.domElement,Object(ob.a)(L,L.bFb,"onUploadFrameInitialized"),Object(ob.a)(L,L.Ooa,"uploadResponseReceived"),ec,!1,L.$);return L}function f(L,Ma){this.filename=L;this.blob=Ma}function l(L,Ma,rb,ec,fd,yd){yd=void 0===yd?!0:yd;L=h.call(this,L,rb,ec,fd,!1)||this;L.Sd=Ma;yd&&L.showDialog();return L}function n(L,Ma){this.dataUri=this.sheetName=null;this.sheetName=L;this.dataUri=Ma}function m(L,Ma,rb,ec,
fd,yd){yd=void 0===yd?!0:yd;Ma=h.call(this,L,Ma,rb,ec,!1)||this;Ma.wyh=fd;Ma.q9b=L.Pb.Zg("LoadResource","FileReaderUploaderLoadResource");yd&&Ma.showDialog();return Ma}function h(L,Ma,rb,ec,fd){fd=void 0===fd?!0:fd;var yd=Eb.call(this,null,Ma,rb)||this;yd.yt=null;yd.paa=null;yd.Y6a=!1;yd.$Cd=null;yd.Ooa=function(be){yd.RZd.stop();yd.Y_b.cancel();if(u.hgi(be))yd.Wzc?yd.x4e(4):(be=new gj.a(0,2,null,null,!1,null,null,null),be.status=8,yd.iWd(new Ei.a(be),null,"InsertPictureWebMethod")),dc.ULS.sendTraceTag(526399121,
0,50,"Http Error occurred, isTimeoutError: {0}",yd.Wzc);else{var xe=h.DTj(be);0!==xe?(dc.ULS.sendTraceTag(526399122,0,50,"Server returned error, response: {0}",be),yd.x4e(xe)):yd.U2h(be)}yd.Foc();yd.dispose()};yd.zIi=function(be){yd.LBa(be,yd.Ij)&&yd.finalizeUpload(yd.Ij,null)};yd.bFb=function(be){dc.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");yd.Ij=be;if(!yd.i1a){if(yd.CYd){if(yd.wve()||yd.G8a&&Ag.a.mF){be.P6b(yd.zIi);return}var xe=be.P6b(null);if(!yd.LBa(xe,be))return}yd.finalizeUpload(be,
null)}};yd.FRi=function(){yd.Wzc=!0};yd.xb=L;yd.RZd=L.Pb.Zg("WebServiceCall","InsertPictureOperation");yd.Y_b=Kb.a.instance.create(yd.FRi,1E5,qc.a.YMg,!1);yd.Wzc=!1;yd.Ikc=yd.$.ya.InsertPictureMaxFileSizeBytes;ec&&(yd.Y6a="TestOnly"in ec);fd&&yd.showDialog();return yd}function x(L,Ma,rb){var ec=t.call(this,L,!1)||this;ec.dV=null;ec.SAa=!1;ec.Rmc=function(){ec.HXd("");ec.XAc();return!1};ec.$=Ma;ec.eCc=L;ec.ZQ=Xg.a.instance;ec.fa=rb;ec.r_f();ec.kld();ec.$.Ab.Cz=!0;return ec}function u(L,Ma,rb,ec,fd,
yd,be){L=w.call(this,L,Ma,rb,ec,fd,"UploadFrame",yd.ea.sessionId,"image/*",!1,null,void 0===be?!1:be)||this;L.$=yd;L.vdg=!0;td.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")?L.Z9e():L.Rpe();return L}function w(L,Ma,rb,ec,fd,yd,be,xe,cf,ze,Yf){cf=void 0===cf?!0:cf;Yf=void 0===Yf?!1:Yf;this.WRe="FileUpload.ashx";this.eo=null;this._initialized=!1;this.Pg=this.fib=this.kIc=this.yga=this.oSb=this.er=this.Gs=null;this.Cm=!1;this.JD=this.pSb=this.vSc=null;this._parent=
L;this.Gpg=Ma;this.oug=rb;this.t6d=fd;this.zQc=be;this.C0d=xe;this.y2d=void 0===ze?null:ze;this.uSc=!1;this.eqg=ec.ra("CanaryRenewalForFileUploadIsEnabled");this.vdg=!1;(this.Qqa=Yf)||this.J3g(yd);cf&&this.Z9e()}function v(L,Ma,rb){if(L){var ec=0;do{try{L();break}catch(fd){if(dc.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",ec,rb,fd.message,fd.stack),ec>=Ma)break}ec++}while(1)}}function t(L,Ma){return D.call(this,L,void 0===Ma?
!0:Ma)||this}function z(){}function D(L,Ma){Ma=void 0===Ma?!0:Ma;var rb=Uh.call(this,!1,!1,D.Au)||this;rb.UWa=null;rb.P5d=!1;rb.cn=[];rb.Ij=null;rb.sXb=L;rb.cvg=Ma;rb.ghe=!1;rb.Sv=!1;rb.yga=null;rb.lIc=!1;rb.hg=rb.geh;rb.Ne="InsertFileDialog";rb.Ac(1,rb.PXb);if(D.Au){L={};Ma={};var ec={};rb.UWa=(ec.id=rb.Ne,ec.bodyControls=(Ma.uploadButtonProps=(L.label=CommonUIStrings.l_DialogChooseFile,L.onExecute=Object(ob.a)(rb,rb.hSi,"onUploadButtonClick"),L),Ma),ec.uploadStatusLabel=CommonUIStrings.l_DialogNoFileChosen,
ec.onFrameReady=Object(ob.a)(rb,rb.aJi,"onFrameReady"),ec);rb.initializeAndShow(rb.titleText,Object(ob.a)(rb,rb.Lec,"insertDialogHandler"),rb.UWa);rb.RRb=!0}else rb.showDialog(rb.titleText,Object(ob.a)(rb,rb.Lec,"insertDialogHandler")),Ma&&rb.r_f(),(L=rb.pV(1))&&rb.cn.push(L),(L=rb.pV(0))&&rb.cn.push(L),rb.hcg(),rb.RRb=!1;return rb}function A(L){var Ma=wg.call(this)||this;Ma.$=L;Ma.Tb();return Ma}function B(L,Ma,rb,ec){var fd=this;this.IK=null;this.ycg=function(){fd.IK&&(fd.EZd=Sc.a.Ua.oe.m,fd.hide(),
Kb.a.instance.create(function(){fd.UQj()},250,"RecoveryUI.UpdatePositionOnVisibleAreaChanged",void 0,!0))};this.NHe=function(yd){10===yd&&fd.oIa()};this.cfh=function(){if(fd.IK){var yd=document.getElementById("PasteRecoveryUI");yd&&De.a.ik===yd.getAttribute(De.a.BY)&&yd.click();fd.documentHidden=!0;fd.oIa()}};this.OHe=function(){fd.oIa()};this.PHe=function(){fd.oIa()};this.onKeyUp=function(yd){if(fd.IK){if(fd.r_)return!1;if(17===yd.Ca.keyCode&&fd.S8b){yd=document.getElementById("PasteRecoveryUI");
if(!yd)return dc.ULS.shipAssertTag(537154070,0,!1,"RecoveryUIController.OnKeyUp: recoveryUIElement is null."),!1;var be=yd.getAttribute(De.a.BY)||"";if(De.a.nr===be)return yd.click(),!0}}return!1};this.onKeyDown=function(yd){if(fd.IK){fd.S8b=!1;fd.r_=yd.ctrlKey;yd=yd.Ca.keyCode;if(27===yd)return fd.oIa(),!0;if(17===yd)return fd.S8b=!0}return!1};this.uN=function(yd,be){yd=be.Sd;fd.MAb=yd;-1027730316!==yd.command&&-1059615499!==yd.command?fd.oIa():(be=be.properties)&&be.launcherId!==fd.aQh()&&fd.oIa()};
this.$=L;this.crc=Ma;this.vr=rb;this.ym=ec;this.Urd=this.MAb=this.Jrd=null;this.r_=this.S8b=this.y6b=this.Adc=!1;this.EZd=0;this.documentHidden=!1;td.EwaSettings.Gl()||this.$.da.Ga(406,this)}function N(L){var Ma=Ui.call(this)||this;Ma.$=L;Ma.Tb();return Ma}function P(L,Ma,rb){rb=void 0===rb?!0:rb;var ec=uh.call(this)||this;ec.bSa=null;ec.Yna=null;ec.lOa=null;ec.t3b=null;ec.L0=null;ec.Hqf=0;ec.Kab=!1;ec.Jab=!1;ec.Qrc=!1;ec.documentVisibilityObserver=null;ec.Iqf=null;ec.cAj=null;ec.Dfa=!1;ec.S7=0;ec.Fkd=
0;ec.Lzb=!1;ec.N3f=0;ec.mQd=!1;ec.Y0=null;ec.yEb=function(){dc.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");ec.glc(1,!1)};ec.lya=function(){ec.vka||ec.WBb?window.setTimeout(function(){ec.tVd()},ec.Hqf):ec.tVd();ec.documentVisibilityObserver.QHb(ec.lya);ec.Lzb=!1};ec.Tf=function(){dc.ULS.sendTraceTag(537155218,0,50,"NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:{0}, IsInDuringWorkSilentReopenMode:{1}",ec.WBb&&ec.Twc,ec.hkc&&
!ec.Dfa&&ec.$Kb);ec.WBb&&ec.Twc&&ec.wje();ec.hkc&&!ec.Dfa&&ec.$Kb&&ec.tje();ae.g(ec.$).tc.Um(ec.Tf);ec.Jab=!1;ec.Kab=!1};ec.hzf=function(){dc.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");ec.glc(1,!0);ec.Jab&&!ec.Kab&&ae.g(ec.$).tc.Um(ec.Tf);ec.Jab=!1};ec.yca=function(fd,yd){ec.Fkd=ec.S7;ec.S7=yd.Rzc};ec.gCf=function(){ec.$&&(ec.Qrc||(ah.a(ec.$).KQ(bh.a.QOa).gEg(ec.rzf),ec.$.dl(ec.vd),ec.Qrc=!0),ec.Dfa=ec.Adi(),ec.glc(2,!1))};ec.rzf=function(){var fd=
ah.a(ec.$).wi,yd=fd.mKg();fd=Yh.f(fd.Es.ud.errors,function(be){return be.MessageIdName});dc.ULS.sendTraceTag(545842889,0,50,"NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:{0}, IsB2W:{1}, Errors: {2}",yd,ec.Dfa,Xf.a.Jc(fd));yd&&(ec.bSa?(ec.Dfa=!1,ec.EFe(),ec.UAc()):ec.Yna&&(ec.FFe(),ec.UAc()))};ec.vd=function(){ec.$?(dc.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),ec.Dfa=!1,td.EwaSettings.isChangeGateEnabled("OfficeVSO:5543662_StopSilentReopenDuringWorkTimerMethodContextOnWorkbookOpened")&&
ec.L0&&ec.L0.yo&&(Ga.a.Ha(ec.L0),ec.L0=null),td.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&ec.Y0&&ec.Y0.yo&&(Ga.a.Ha(ec.Y0),ec.Y0=null),ec.glc(2,!0),ec.UAc()):dc.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};ec.Nuf=function(){ec.Epf(!0)};ec.Ouf=function(){ec.Epf(!1)};ec.gWb=ha.Xqi;ec.L1c=ha.connected;ec.$=L;ec.rf=L.na.rf;ec.W0f=td.EwaSettings.isChangeGateEnabled("OfficeVSO:5618694_BackToWorkLoadingUIEnabled");
ec.$Kb=td.EwaSettings.isChangeGateEnabled("OfficeVSO:5798300_SilentReopenDuringWorkUIEnabled");ec.Twc=td.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");rb&&(ec.Iqf=new ba(L,Ma));td.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")&&ec.$.da.$a(291,function(fd){ec.documentVisibilityObserver=fd});ec.Twc&&(td.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")||ec.$.da.$a(291,function(fd){ec.documentVisibilityObserver=
fd}),ec.Hqf=ec.$.ya.ExcelNetworkCheckAfterTabActivationDelayMs,ec.rf.kFg(ec.yEb),ec.rf.knb(ec.hzf),ec.rf.ome(ec.Nuf),ec.rf.NDg(ec.Ouf));if(ec.W0f||ec.$Kb)ec.cAj=new Q(ec.$,ec);ec.omf=ec.$.ya.LongInactivityTimePeriodSeconds;ec.$.ea.sVc(ec.gCf);ec.$.ea.Ue.Sga(ec.yca);ec.$Kb&&(ec.N3f=ec.$.ya.SilentReopenDuringWorkDelayMs);return ec}function Q(L){var Ma=this;this.H7=null;this.hCf=function(rb,ec){Ma.eCf(ec,3)};this.yyf=function(rb,ec){Ma.eCf(ec,2)};this.$=L;this.yg=nf.a(this.$).yg;this.yg.Wme(this.yyf);
this.yg.yGg(this.hCf)}function M(L,Ma,rb,ec){L=U.call(this,L,Ma,rb)||this;L.wasInteruptedByOfflineMode=!1;L.type=ec;L.wasInteruptedByOfflineMode=!1;return L}function ba(L,Ma){this.Cla=this.Zwd=this.wsf=null;this.$=L;!td.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||td.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Ag.a.Nf||(this.wsf=new V(L,Ma));td.EwaSettings.ma(213)&&(this.Zwd=new G(this.$),this.Zwd.g8h());!td.EwaSettings.ma(564)||
td.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Ag.a.Nf||(this.Cla=new Xi.NetworkConnectionHealthChecker(this.$));this.P0g=new I(this.$)}function V(L,Ma){var rb=this;this.kOa=this.JU=null;this.xEd=-1;this.Stb=null;this.Tif=qb.Task.delay(0);this.H9a=function(ec,fd){fd.RL?rb.LNi(fd.loa):rb.MNi()};this.zca=function(ec,fd){5===fd.YEf&&rb.D2a()};this.wUf=function(ec,fd){rb.JU.hoj(fd.cV)};this.D2a=function(){rb.kOa.cPj();rb.pij(V.ACd,Sys.Serialization.JavaScriptSerializer.serialize(rb.kOa))};
this.ldj=function(ec){if(ec=ec.result)rb.dfg=!0,dc.ULS.sendTraceTag(576811915,0,50,"OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: {0}",ec)};this.A8i=function(){rb.dfg&&(rb.$?Pd.TaskExtensions.Ba(rb.indexedDB.F5c(V.ACd),function(){dc.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},rb.$.la):dc.ULS.sendTraceTag(537155203,
0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.pOa=function(){if(rb.kOa&&0<rb.kOa.count){var ec=Sys.Serialization.JavaScriptSerializer.serialize(rb.kOa);dc.ULS.sendTraceTag(560791644,0,50,"OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: {0}",ec)}};this.$=L;this.indexedDB=Ma;this.dfg=!1;this.indexedDB.Sf()&&(this.indexedDB.initialize(V.Mkd,V.Nkd),this.Gcj(),this.kOa=
new E(this.$.ya.UserSessionId),nf.a(this.$).yg.$Uc(this.H9a));this.ym=Df.a.instance.VG();this.ym.ka("beforeunload",this.pOa)}function aa(L,Ma,rb){L=U.call(this,L,Ma,rb)||this;L.timeFromLastOffline=0;L._errorDataDuringOfflineMode=null;L.timeFromLastOffline=-1;L.type=5;return L}function E(L){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=L}function G(L){var Ma=this;this.yTf=null;this.Qrd=this.Zvd=
this.wDb=this.xDb=0;this.tQd=!1;this.C1c=this.fSa=this.dyc=this.L8a=null;this.Q1c=0;this.Pkj=function(){if(12E4>Ma.$.ea.Ue.$db)for(var rb=Gl(Ma.dyc),ec=rb.next();!ec.done;ec=rb.next())ec.value.runTest();else Ma.nTd("UserInactive")};this.vdj=function(rb){rb=Sys.Serialization.JavaScriptSerializer.serialize(rb);dc.ULS.sendTraceTag(388821830,0,50,rb)};this.Lcj=function(rb){if(rb){var ec=Ma.C1c[rb.testIteration.toString()];ec?ec.push(rb):(ec=[rb],Ma.C1c[rb.testIteration.toString()]=ec);if(ec.length===
Ma.yTf.length){ec=Sys.Serialization.JavaScriptSerializer.serialize(ec);if(Ma.$&&Ma.$.rf){if(rb.EstimatedLatency=Ma.$.rf.zse,Ma.$.rf.zse>Ma.$.Pu.ExcelRountripThresholdMs){dc.ULS.sendTraceTag(570712144,0,50,"Periodic ping tests results when network is slow: {0}, consequtive slow ping iteration #: {1}",ec,Ma.Q1c++);return}}else dc.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");dc.ULS.sendTraceTag(570712142,0,50,"Periodic ping tests results: {0}",
ec);Ma.Q1c=1}}};this.Uh=function(rb,ec){rb=ec.context.methodName;if(rb===Ve.a.Ovb||rb===Ve.a.jKa)Ma.wDb++,rb=Date.now(),Ma.lvj(rb)&&(Ma.wDb=0,Ma.Qrd=rb,Ma.bDj())};this.yca=function(){Ma.TSd("OnThrottledUserActivity")};this.mW=function(){Ma.nTd("OnDocumentHidden")};this.lya=function(){Ma.TSd("OnDocumentUnhidden")};this.$=L;if(this.uQd=td.EwaSettings.isChangeGateEnabled("OfficeVSO:5186511_SendSlowNetworkPingTests")&&this.mWg())this.yTf=[Mi.a.LDc],this.Q1c=1,this.C1c={},this.$.ea.Ue.Sga(this.yca),this.$.da.$a(291,
function(rb){rb.AFa(Ma.mW);rb.fnb(Ma.lya)})}function I(L){var Ma=this;this.Uic=this.data=null;this.l$c=0;this.MAe=null;this.Puf=function(rb,ec){ec.RL?(Ma.data=new Y(Sc.a.Ua.Vb,Ma.$,5===ec.loa,0!==ec.loa,Ma.$.rf.disconnectionSource,Ma.MAe),Ma.Uic=Ma.$.rf.Zif,Ma.l$c=1,Ma.$.na.rf.VGg(Ma.Wn),kh.a(Ma.$).PUc(Ma.vUf)):(Ma.data.GGi(Ma.$,5===ec.loa),Ma.$.na.rf.WPf(Ma.Wn),Ma.data.lastFailedRequestToOnlineTimeGapSec=ch.getElapsedSeconds(Ma.Uic,Sc.a.Ua.Vb),td.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?
hg.b().PJb(557682689,0,50,R.connectivityIssues,Ma.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",Xf.a.Jc(Ma.data)):dc.ULS.sendTraceTag(557682689,0,50,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",Xf.a.Jc(Ma.data)),td.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&Ma.data&&Ma.data.isToastShown&&pc.Health.instance.recordQosError(ic.a.bYg,[Rc.a.yjc],
!0,!1,!1,!1,null),kh.a(Ma.$).yId(Ma.vUf),Ma.data=null)};this.vUf=function(rb,ec){Ma.data.goj(ec.cV)};this.Wn=function(rb,ec){Ma.data.W4i(ec.context.methodName);rb=Sc.a.Ua.Vb;ec=ch.getElapsedSeconds(Ma.Uic,rb);Ma.Uic=rb;ec>Ma.data.longestDurationBetweenFailedRequestsSec&&(Ma.data.longestDurationBetweenFailedRequestsSec=ec);Ma.l$c++;Ma.data.averageDurationBetweenFailedRequestsSec=Ma.GSg(ec)};this.Muf=function(rb,ec){Ma.MAe=ec.KKj};this.$=L;nf.a(this.$).yg.pme(this.Puf);this.$.rf.ome(this.Muf)}function R(){}
function Y(L,Ma,rb,ec,fd,yd){L=U.call(this,L,Ma,ec)||this;L.swappedByOffline=!1;L.swappedOffline=!1;L.averageDurationBetweenFailedRequestsSec=0;L.longestDurationBetweenFailedRequestsSec=0;L.lastFailedRequestToOnlineTimeGapSec=0;L.disconnectionSource=null;L.errorDataDuringConnectivityIssuesMode=null;L.failedRequests=[];L.triggeringRequest=null;L.type=4;L.swappedOffline=rb;L.disconnectionSource=Enum.toString(Ci.a,fd);L.triggeringRequest=yd;return L}function U(L,Ma,rb){var ec=this,fd;this.type=0;this.startTime=
null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.Ctf=function(yd,be){ec.blockedOperationsCount++;yd=String.format("{0}_{1}_{2})",be.componentName,be.actionName,be.details);ec.blockedActions[yd]=
ec.blockedActions[yd]?ec.blockedActions[yd]+1:1;ec.isToastShown&&ec.blockedUserOperationsWhileToastShown++};this.xBd=function(yd){ec.durationUntilUserInactive=ch.getElapsedSeconds(ec.startTime,Sc.a.Ua.Vb);yd.fJd(ec.xBd)};this.mW=function(){ec.hasTabbedOut=!0};this.zca=function(yd,be){be.YEf!==ec.type||ec.isToastShown||(ec.durationUntilToastShownMs=yh.a(Sc.a.Ua,ec.startTime),ec.toastRaiser=be.toastRaiser,ec.isToastShown=!0)};this.startTime=L;this.durationUntilToastShownMs=0;this.blockedActions={};
this.isToastShown=rb;if(null===(fd=Ma.ea)||void 0===fd?0:fd.Ue)this.wasUserActiveOnPIStart=Ma.ea.Ue.ur;this.Ej(Ma);td.EwaSettings.isChangeGateEnabled("OfficeVSO:5340853_ImprovePIData")?(this.isDialogShown=0<Ma.Ab.JR,L=Ma.da.za(183),this.isTaskPaneShown=!!L&&L.isVisible&&!L.isCollapsed,this.isTaskPaneCollapsed=!!L&&L.isVisible&&L.isCollapsed):this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1}function ha(){}function ta(L){var Ma=Ne.call(this)||this;Ma.Rc=L;Ma.Tb();return Ma}function xa(L,
Ma,rb){rb=void 0===rb?null:rb;var ec=Zf.call(this)||this;ec.r_a=null;ec.e5a=null;ec.qec=null;ec.FCa=null;dc.ULS.sendTraceTag(537155417,0,50,"MergeSuspensionManager.ctor started");ec.$=L;ec.MWa=new Ya(L);td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjust",!1)&&(ec.eAa=new oa(ec.$));ec.o1a=new ka(ec.$.na.va,ec.$,void 0,void 0,ec.eAa);ec.C8h(L,rb);ec.Nfa=new tb(ec.FCa,ec.MWa);ec.XJd=new za(L,ec.Nfa,Ma,ec.o1a);td.EwaSettings.ma(255)&&(ec.qec=new Ra(L,ec));dc.ULS.sendTraceTag(588276810,
0,50,"MergeSuspensionManager created");return ec}function oa(L){var Ma=this;this.iMb=0;this.Vy=this.ey=null;this.a1d=new Ea;this.b1d=new Ea(!0);this.UC=0;this.xGj=!1;this.ypf=1E4;this.vd=function(){Ma.eEe()};this.Oi=function(){Ma.iXc(!0,!1)};this.g9a=function(){Ma.iXc(!1,!1)};this.$=L;this.gridView=ae.g(this.$);this.gridView.Ea.yx(this.Oi);this.gridView.Ea.Qs(this.g9a);this.gridView.Ea.hme(this.g9a);this.gridView.Ea.Oga(this.g9a);td.EwaSettings.isChangeGateEnabled("OfficeVSO:6385622_SelectionAdjustImplementsCustomReportManager")&&
this.$.dl(this.vd);this.wdj=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportSelections",!1);this.eEe();this.QCb=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjustMultiRangeSupport",!1);this.Qcj=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6354017_reportEditRaceCondition");this.PQf=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6367531_reportDivergenceOnResponse");this.Voe=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6409189_alwaysVerifyMaxBlockRevisionBeforeAdjust")}
function qa(L,Ma,rb,ec,fd,yd){var be=this;this.HL=void 0;this.xb=L;this.nG=Ma;this.t9=rb;this.pWb=ec;this.oEc=fd;td.EwaSettings.isChangeGateEnabled("OfficeVSO:6413844_GetIndexOfActiveRangeFromInitialSelection")&&(this.HL=yd);this.pUb=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjustMultiRangeSupport",!1);this.y6d=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6399793_GetBlocksOnAdjustCheck");this.Ejg=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6399805_adjustIfNoCachedBlocks");
this.y6d||(this.pUb?this.AQb=this.selectedRanges.map(function(xe){return be.CAc(xe,fd)}):this.iCa&&(this.AQb=[this.CAc(this.selectedRanges[0],fd)]))}function Ea(L){this.divergenceOnResponse=this.adjustedDidntChangeWithDivergence=this.editBoxDivergence=this.differentSheetAdjust=this.parallel=this.errors=this.nonContinuous=this.divergenceOnViewportReady=this.adjusted=this.adjustedDidntChange=0;this.d7h=void 0===L?!1:L}function ka(L,Ma,rb,ec,fd){rb=void 0===rb?null:rb;ec=void 0===ec?null:ec;fd=void 0===
fd?null:fd;var yd=oe.call(this)||this;yd.$Ab=null;yd.CBd=0;yd.documentVisibilityObserver=null;yd.jif=!1;yd.va=L;yd.ytc=Ma.ya.MergeSuspensionRequestThrottlingTimeInMs;var be=Ma.ya.GetRangeContentPrefetchDelayForMergeInMs;yd.By=function(){Ma.iVf(be)};yd.qh=rb||Sc.a.Ua;yd.RYd=0;yd.HO=ec;yd.eAa=fd;yd.qdg=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6248201_useDoPendingMergeSuccessCallback");yd.kTg=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6237816_CallDoPendingMergeRequest");Ma.da.$a(291,function(xe){yd.documentVisibilityObserver=
xe});return yd}function za(L,Ma,rb,ec){var fd=xc.call(this)||this;fd.o1a=null;fd.AAb=0;fd.o7a=null;fd.BAb=null;fd.qAf=function(yd,be){fd.o1a.ULg(be.hca,be.wIg)};fd.YEb=function(yd,be){be.Rwa?fd.KCj():fd.Eyc()};fd.Eyf=function(){fd.AAb=0};fd.AWf=function(){var yd=fd.X5.Led();La(fd.va,null!=yd.SuspensionStartTimestamp?yd.SuspensionStartTimestamp:0,null,function(){fd.cMi(yd)},null,null,fd.va.hc())};fd.k8=function(yd,be){if(be){be.VFa.MergeCount=fd.X5.Led();var xe=ae.g(fd.$).Yyi();yd=xe.min;xe=xe.max;
td.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?be.VFa.ClientRevisions=Object(kg.a)(new Ia,{Min:yd,Max:xe,MaxFromBlockCache:ae.g(fd.$).Ea.tvd}):be.VFa.ClientRevisions=Object(kg.a)(new Ia,{Min:yd,Max:xe})}};fd.$=L;fd.mZa=rb;fd.X5=Ma;fd.X5.WFg(fd.qAf);fd.X5.CZb(fd.YEb);fd.X5.dFg(fd.Eyf);fd.$.na.N9(fd.k8);fd.va=fd.$.na.va;fd.ytc=fd.$.ya.MergeSuspensionRequestThrottlingTimeInMs;fd.voi=fd.$.ya.KeepBlockingPendingMergesRequestIntervalMs;fd.o1a=ec;dc.ULS.sendTraceTag(588276807,
0,50,"RequestController initialized");return fd}function La(L,Ma,rb,ec,fd,yd,be){be=L.Na(1,void 0===be?null:be);be.suspensionStartTimestamp=Ma;return oc.i(L,"KeepBlockingPendingMerges",be,rb,ec,fd,yd,0)}function Ia(){}function Ya(L){var Ma=Fb.call(this)||this;Ma.W1=null;Ma.Zic=0;Ma.j8=function(rb,ec){var fd;if(null===(fd=null===ec||void 0===ec?void 0:ec.rd)||void 0===fd?0:fd.MergeCount)Na.a.equals(ec.rd.SessionId,Ma.$.ea.sessionId,!1)?Ma.qya(ec.rd.MergeCount,Ya.ysb):dc.ULS.sendTraceTag(579737049,
0,50,"Stale merge counter ({0}/{1})",ec.rd.MergeCount.Current,ec.rd.MergeCount.Pending)};Ma.ACb=function(rb,ec){(null===ec||void 0===ec?0:ec.hca)&&Ma.qya(ec.hca,Ya.TZd)};Ma.xvc=function(){Ma.gSf();Ma.SJf(Ma.W1,Ya.uej)};Ma.o9a=function(rb,ec){ec.rqb&&Ma.W1.SuspensionStartTimestamp&&dc.ULS.sendTraceTag(17318084,0,50,"PendingMergeMonitor.OnEditCellEnded: committed with counter {0}",Sa(Ma.W1))};Ma.gSf();Ma.$=L;Ma.$.ea.hk(Ma.xvc);Ma.$.ea.XL(Ma.xvc);ae.g(Ma.$).pc.Kn(Ma.o9a);td.EwaSettings.isChangeGateEnabled("OfficeVSO:6329027_UpdateMergeCountWhenWebMethodReturnsWithErrors")||
Ma.$.na.zq(Ma.j8);Ma.$.da.$a(292,function(rb){rb.AYa(Ma.ACb);dc.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")});return Ma}function tb(L,Ma){var rb=Ba.call(this)||this;rb.rya=function(ec,fd){ec=rb.getState();var yd=rb.vla;rb.vla=fd.hca;fd=rb.getState();rb.$ti(ec,fd,yd);rb.raiseEvent(tb.Lvd);rb.SSe(ec,fd)};rb.GOa=function(ec,fd){ec=rb.getState();rb.XH=fd.XH;fd=rb.getState();rb.SSe(ec,fd)};rb.Dyb=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",
!1);rb.Mha=L;rb.Mha.xZb(rb.GOa);rb.vma=Ma;rb.vma.AYa(rb.rya);rb.vla=Object(kg.a)(new d.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});rb.XH=rb.h8h();return rb}function Tb(L,Ma){L=Z.call(this,L)||this;L.wIg=Ma;return L}function va(L){this.Koe=!1;this.Koe=L;return this}function la(){}function $a(L){var Ma=r.call(this)||this;Ma.Rwa=L;return Ma}function Ra(L,Ma){var rb=Va.call(this)||this;rb.statusBarManager=null;rb.lxd=!1;rb.rya=function(ec,fd){ec=String.format("{0}{1}",fd.hca.Current===fd.hca.Pending?
"\u26ad":"\u26ae",fd.hca.Current);Na.a.equals(rb.Ilc,ec,!1)||(rb.Ilc=ec,rb.Gz())};rb.GOa=function(ec,fd){ec=0==fd.XH;rb.lxd!==ec&&(rb.lxd=ec,rb.Gz())};rb.mergeSuspensionManager=Ma;rb.mergeSuspensionManager.vma.AYa(rb.rya);rb.Ilc="";xi.a.w2(1905775613,O.a.Lc,0,1);rb.Ka=L.Ka;rb.gNb=new eb;L.da.$a(29,function(ec){rb.mergeSuspensionManager&&(rb.statusBarManager=ec,ec.nJ(rb),rb.mergeSuspensionManager.Mha.xZb(rb.GOa))});rb.Ka.x2(rb.gNb);return rb}function eb(){return fa.call(this)||this}function mb(L,Ma){Ma=
void 0===Ma?null:Ma;var rb=wh.call(this,1)||this;rb.Gfa=!1;rb.yN=function(){rb.refresh()};rb.Zuf=function(){rb.refresh()};rb.$=L;rb.r7d=Ma||ah.a(L).KQ(bh.a.idle);ah.a(L).OUc(rb.Zuf);rb.d5a.yq(rb.yN);rb.refresh();return rb}function Pa(L,Ma){var rb=oi.call(this)||this;rb.Rif=null;rb.$ic=!1;rb.HQa=new Dg.a;rb.fje=L;rb.vma=Ma;rb.Dyb=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DoPendingMergeWhenUnsafe",!1);rb.Dyb&&(rb.fje.eFg(rb.Fyf.bind(rb)),rb.vma.AYa(rb.rya.bind(rb)));return rb}function Da(L){return(null===
L||void 0===L?void 0:L.SuspensionStartTimestamp)&&L.Pending>L.Current}function Ta(L,Ma){return L||Ma?L&&Ma?L.Current===Ma.Current&&L.Pending===Ma.Pending&&L.SuspensionStartTimestamp===Ma.SuspensionStartTimestamp:!1:!0}function Sa(L){return L?String.format("{0} / {1} @{2}",L.Current,L.Pending,L.SuspensionStartTimestamp):null}function Cb(L,Ma){this.handler=null;this.publisher=L;this.XH=Ma}function cc(L){var Ma=Mf.call(this,1)||this;Ma.Gfa=!1;Ma.Utf=function(){Ma.refresh()};Ma.Vtf=function(){Ma.refresh()};
Ma.gridView=ae.g(L);Ma.gridView.pc.ql(Ma.Vtf);Ma.gridView.pc.Kn(Ma.Utf);Ma.refresh();return Ma}function nc(L){return jh.call(this,L)||this}function Nb(L,Ma){this.$=L;this.uploaderCreator=Ma}function nb(L,Ma,rb,ec,fd,yd){var be=Eb.call(this,null,rb,ec)||this;be.wmf=0;be.eOi=function(xe){Gb.a(xe)?dc.ULS.sendTraceTag(537155799,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: {0}",Se.a.Tc(xe.Errors)):(dc.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded."),
xe.Result?Eh.a(be.$).rna(1,xe.Result):dc.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))};be.dOi=function(){dc.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};be.$=L;be.Sd=Ma;be.T0=yd;be.vpe=Hg.a.instance.kc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");be.showDialog();return be}function db(L,Ma,rb,ec,fd,yd){var be=ri.call(this)||this;be.ugc=!1;be.jwa=null;be.QR=
null;be.oNa=null;be.vFi=function(){be.yua(be.Pob)};be.Brd=function(xe){xe.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==xe.target.id||xe.shiftKey?"KeepFocusStartDiv"===xe.target.id&&xe.shiftKey&&(xe.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(xe.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};be.rMi=function(){be.Hnb&&(be.Hnb.launchUpsellExperience("stockimages"),dc.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};be.Jm=
yd;be.$=L;be.l$e=Ma;be.Hnb=rb;be.dAa=[];be.Vof=ec;be.heh=fd;be.Moe=be.$.ya.InsertOnlinePictureMaxCountOfImagesToInsert;be.hg=be.A6g();return be}function Bb(){}function zc(L,Ma){return Th.call(this,L,sg.a.Saa(Ma))||this}function Eb(L,Ma,rb){L=Ja.call(this,L,Ma,rb)||this;L.Era=null;L.$Ub=null;return L}function Ja(L,Ma,rb){this.Ij=this.uBd=null;this.DEa=this.ira=0;this.qSb=null;this.dT=L;this.ue=Ma;this.wb=rb;this.i1a=!1;this.CYd=!0;this.Bej();this.G8a=this.fa.ra("NativeFileOpenDialogIsEnabled")}function Rb(L){var Ma=
Sh.call(this)||this;Ma.Dkd=null;Ma.$=L;Ma.Tb();return Ma}function yc(L){var Ma=Of.call(this)||this;Ma.$=L;Ma.Tb();return Ma}function qd(L,Ma){this.gTe=L;this.IAh=Ma}function bc(L){this.$=L}function Vb(L){var Ma=Rf.call(this)||this;Ma.$=L;Ma.Tb();return Ma}function mc(L,Ma,rb){var ec=Hf.call(this)||this;ec.statusBarManager=null;ec.yHe=function(){ec.u6b()};ec.Leh=function(){ec.u6b()};ec.xHe=function(fd){10===fd&&ec.u6b()};ec.onKeyDown=function(fd){if(13===fd.Ca.keyCode){fd=new Ud.a(237279923,1,2,6,
null);var yd={};ec.$.Ka.Wb(fd,(yd[De.a.skipClipboardAccess]=!0,yd[De.a.sLe]=!0,yd));return!0}return!1};ec.$=L;ec.vr=Ma;ec.ym=rb;ec.c8c=!1;ec.J1f=td.EwaSettings.getBooleanFeatureGate(zf.a.tPa,!1);ec.tgf=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6082903_PasteToEnterKeyDownEventForGrid");ec.J1f&&ec.$.da.$a(29,function(fd){ec.statusBarManager=fd;fd.nJ(ec)});return ec}function sb(L){var Ma=de.call(this)||this;Ma.$=L;Ma.Wm=yf.a.instance;Ma.Tb();return Ma}function Yb(L){var Ma=this;this.i5b="";this.s2=
this.Us=null;this.jqc=!1;this.Y6e=function(rb,ec){Ma.hide(void 0===rb?null:rb,void 0===ec?null:ec)};this.gridView=ae.g(L);this.gridView.ha.GG(this.Y6e)}function Hb(){}function sc(L,Ma){var rb=ii.call(this,L)||this;rb.Yo=null;rb.Cai=function(ec,fd){1===ec?(ec=sc.Deh[fd[sc.Ceh]],dc.ULS.sendTraceTag(537167683,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = {0}",0===ec?"Horizontal":"Vertical"),rb.Yo.setResult(ec)):(dc.ULS.sendTraceTag(537167682,
0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),rb.Yo.uu())};rb.Ug(Ma);return rb}function zb(L){this.aFc=this.fPc=null;this.$=L}function vc(){}function ad(){}function ub(){}function Za(){}function wa(L){this.t2c=this.lta=null;this.r$a=15;this.$=L}function ja(L,Ma){this.$=L;this.aob=Ma}function Ua(L,Ma,rb,ec){L=Qc.call(this,L)||this;L.isFromCurrentSession=!1;L.top=0;L.left=0;L.isFromCurrentSession=Ma;L.top=rb;L.left=ec;return L}function bb(L,Ma,rb,ec,fd){fd=
void 0===fd?null:fd;var yd=Jb.call(this,L,"ArtCopyPasteHandler")||this;yd.wYg="XLO";yd.xYg="3";yd.PU=new lb(L);yd.y$=Ma;yd.jZa=rb;yd.ha=ae.g(L).ha;yd.v2c=fd||new $b(yd.y$);yd.JVi=new Xa(rb,L);yd.aob=ec;return yd}function Xa(L,Ma){this.tIb=new Od.a;this.jZa=L;this.$=Ma;this.s0i=function(rb){return Promise.resolve(rb)};this.EEb=function(rb){return Promise.reject(rb)}}function yb(L,Ma,rb,ec,fd,yd,be,xe,cf){this.promise=null;this.ribbonCommandInfo=L;this.destination=Ma;this.LGe=rb;this.sOb=fd;this.I0=
yd;this.item=be;this.pasteContext=xe;this.INa=rb||Ma.FirstRow+"_"+Ma.FirstColumn;this.vdf=!0;this.vye=cf}function Ib(L,Ma,rb,ec,fd,yd,be){this.floatingObjectId=L;this.commandParameters=Ma;this.yt=rb;this.mah=ec;this.qaa=void 0===yd?null:yd;this.sOb=void 0===be?null:be;this.N2g=fd}function Qa(L,Ma,rb,ec){Ma=Ha.call(this,L,Ma,rb,"AcrossSessionRangeCopyPasteHandler",void 0===ec?null:ec)||this;Ma.PU=new lb(L);return Ma}function cb(L,Ma){Ma=void 0===Ma?null:Ma;var rb=hh.call(this,Vf[L])||this;rb.copyErrorName=
0;rb.ewaErrors=null;rb.copyErrorName=L;rb.ewaErrors=Ma;if(null===Ma||void 0===Ma?0:Ma.length)rb.innerError=new Rg.a(Ma,null);return rb}function lb(L){this.PU=new Eg.a(!0);this.$=L}function Ha(L,Ma,rb,ec,fd){fd=void 0===fd?null:fd;ec=Jb.call(this,L,ec)||this;ec.X2g=Ma;ec.y$=rb;ec.w2c=fd||new $b(ec.y$);ec.gridView=ae.g(L);ec.ha=ec.gridView.ha;ec.clipboardRangeFactory=L.da.za(169);return ec}function $b(L){this.clipboardItems=this.key=null;this.y$=L}function Jb(L,Ma){this._name=Ma;this.$=L;this.Wm=yf.a.instance;
this.Vp=new jb(L,ae.g(L))}function kc(L){return L.shadowWorkbookSizeExceedsLimit?!0:uc(L)>Ve.a.Lkc}function uc(L){return L?L.shadowWorkbookSizeExceedsLimit&&void 0!==L.shadowWorkbookBlockedSize&&null!==L.shadowWorkbookBlockedSize?L.shadowWorkbookBlockedSize:L.shadowWorkbookBase64?L.shadowWorkbookBase64.length:0:0}function hd(){}function ma(L){var Ma={};this.X5f=(Ma["SourceItemType.Range"]=0,Ma["SourceItemType.Art"]=1,Ma);this.$Lb={};Ma={};this.T5f=(Ma["FloatingObjectType.Unknown"]=99,Ma["FloatingObjectType.CardView"]=
6,Ma["FloatingObjectType.Chart"]=0,Ma["FloatingObjectType.Group"]=7,Ma["FloatingObjectType.Image"]=1,Ma["FloatingObjectType.Ink"]=8,Ma["FloatingObjectType.InteractiveReport"]=4,Ma["FloatingObjectType.ModernOfficeExtension"]=3,Ma["FloatingObjectType.Shape"]=5,Ma["FloatingObjectType.Slicer"]=2,Ma["FloatingObjectType.Unsupported"]=100,Ma);Ma={};this.RWc=(Ma["99"]="FloatingObjectType.Unknown",Ma["6"]="FloatingObjectType.CardView",Ma["0"]="FloatingObjectType.Chart",Ma["7"]="FloatingObjectType.Group",Ma["1"]=
"FloatingObjectType.Image",Ma["8"]="FloatingObjectType.Ink",Ma["4"]="FloatingObjectType.InteractiveReport",Ma["3"]="FloatingObjectType.ModernOfficeExtension",Ma["5"]="FloatingObjectType.Shape",Ma["2"]="FloatingObjectType.Slicer",Ma["100"]="FloatingObjectType.Unsupported",Ma);Ma={};this.W5f=(Ma["RibbonCommand.Copy"]=-911352779,Ma["RibbonCommand.Cut"]=-1985798686,Ma);Ma={};this.eLd=(Ma["-911352779"]="RibbonCommand.Copy",Ma["-1985798686"]="RibbonCommand.Cut",Ma);Ma={};this.V5f=(Ma["InputManager.InputMethod.NotDefined"]=
-1,Ma["InputManager.InputMethod.Unknown"]=0,Ma["InputManager.InputMethod.Keyboard"]=1,Ma["InputManager.InputMethod.Mouse"]=2,Ma["InputManager.InputMethod.Touch"]=3,Ma["InputManager.InputMethod.CrossSlide"]=9,Ma);this.hka={};Ma={};this.U5f=(Ma["FrameMode.None"]=0,Ma["FrameMode.Reading"]=1,Ma["FrameMode.Edit"]=2,Ma);this.R2a={};Ma={};this.Y5f=(Ma["UILocation.Unknown"]=0,Ma["UILocation.UpperRibbon"]=1,Ma["UILocation.Ribbon"]=2,Ma["UILocation.QAT"]=3,Ma["UILocation.Jewel"]=4,Ma["UILocation.NavigationPane"]=
5,Ma["UILocation.KeyboardShortcut"]=6,Ma["UILocation.StatusBar"]=7,Ma["UILocation.Dialog"]=8,Ma["UILocation.Floatie"]=9,Ma["UILocation.NotificationBar"]=10,Ma["UILocation.StandaloneCuiRoot"]=11,Ma["UILocation.TaskPane"]=12,Ma["UILocation.HeroDock"]=13,Ma["UILocation.SingleLineRibbon"]=14,Ma["UILocation.MultilineRibbon"]=15,Ma["UILocation.Overflow"]=16,Ma["UILocation.TellMe"]=17,Ma["UILocation.FarPeripheralControls"]=18,Ma["UILocation.ContextMenu"]=19,Ma["UILocation.DialogMenu"]=20,Ma["UILocation.Header"]=
21,Ma["UILocation.FileMenu"]=22,Ma["UILocation.Toolbar"]=26,Ma["UILocation.Canvas"]=30,Ma);this.Gr={};this.$=L;this.hka.notDefined="InputManager.InputMethod.NotDefined";this.hka.unknown="InputManager.InputMethod.Unknown";this.hka.keyboard="InputManager.InputMethod.Keyboard";this.hka.mouse="InputManager.InputMethod.Mouse";this.hka.touch="InputManager.InputMethod.Touch";this.hka.crossSlide="InputManager.InputMethod.CrossSlide";this.R2a.none="FrameMode.None";this.R2a.reading="FrameMode.Reading";this.R2a.edit=
"FrameMode.Edit";this.Gr.unknown="UILocation.Unknown";this.Gr.upperRibbon="UILocation.UpperRibbon";this.Gr.ribbon="UILocation.Ribbon";this.Gr.QAT="UILocation.QAT";this.Gr.jewel="UILocation.Jewel";this.Gr.navigationPane="UILocation.NavigationPane";this.Gr.keyboardShortcut="UILocation.KeyboardShortcut";this.Gr.statusBar="UILocation.StatusBar";this.Gr.dialog="UILocation.Dialog";this.Gr.floatie="UILocation.Floatie";this.Gr.notificationBar="UILocation.NotificationBar";this.Gr.standaloneCuiRoot="UILocation.StandaloneCuiRoot";
this.Gr.taskPane="UILocation.TaskPane";this.Gr.heroDock="UILocation.HeroDock";this.Gr.singleLineRibbon="UILocation.SingleLineRibbon";this.Gr.multilineRibbon="UILocation.MultilineRibbon";this.Gr.overflow="UILocation.Overflow";this.Gr.tellMe="UILocation.TellMe";this.Gr.farPeripheralControls="UILocation.FarPeripheralControls";this.Gr.header="UILocation.Header";this.Gr.fileMenu="UILocation.FileMenu";this.Gr.contextMenu="UILocation.ContextMenu";this.Gr.dialogMenu="UILocation.DialogMenu";this.Gr.toolbar=
"UILocation.Toolbar";this.Gr.canvas="UILocation.Canvas";this.$Lb.range="SourceItemType.Range";this.$Lb.art="SourceItemType.Art"}function jb(L,Ma){this.Ric=this.YMa=null;this.q$a=zf.a.q$a;this.Hfc=td.EwaSettings.getBooleanFeatureGate(zf.a.R4b,!1);this.dmd=!1;this.Hwa=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);this.$=L;this.gridView=Ma;this.dmd&&(this.$.userOperationManager.xq(Object(ob.a)(this,this.Kz,"onQueueChanged")),this.pv=new Dg.a)}function Zb(L,
Ma,rb,ec,fd,yd,be,xe,cf){this.destinationRange=L;this.Lqb=rb;this.iFf=ec;this.Sd=fd;this.sOb=yd;this.pasteContext=be;this.Opb=xe;this.NVd=cf}function Ub(L){this.parameters=null;this.parameters=L}function Qc(L){this.pasteParameters=null;this.pasteParameters=L}function kd(L,Ma){this.content=this.destinationRange=null;this.destinationRange=L;this.content=Ma}function xb(L,Ma,rb){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=L;this.destinationRange=Ma;this.pasteFlags=rb}
function bd(L,Ma,rb,ec,fd,yd,be,xe){xe=void 0===xe?null:xe;be=L.Na(1,void 0===be?null:be);be.pasteParameters=Ma;return oc.i(L,"Paste",be,rb,ec,fd,yd,64,xe)}function Qd(L,Ma,rb,ec,fd,yd,be,xe){xe=void 0===xe?null:xe;be=L.Na(1,void 0===be?null:be);be.copyParameters=Ma;return oc.i(L,"Copy",be,rb,ec,fd,yd,0,xe)}function zd(L,Ma,rb,ec,fd,yd,be,xe,cf){cf=void 0===cf?null:cf;xe=L.Na(9,xe);xe.destinationRange=Ma;xe.source=rb;return oc.i(L,"PasteString",xe,ec,fd,yd,be,64,cf)}function Jd(L,Ma,rb,ec,fd,yd,be,
xe){xe=void 0===xe?null:xe;be=L.Na(1,be);be.pasteHtmlParameters=Ma;return oc.i(L,"PasteHtmlContent",be,rb,ec,fd,yd,64,xe)}function gc(){this.I_a=this.zye=null}function Hc(L,Ma,rb,ec,fd,yd,be,xe,cf){cf=void 0===cf?null:cf;var ze=Ie.call(this)||this;ze.pasteShortcutManager=null;ze.fbf=td.EwaSettings.Gb();ze.Hwa=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);ze.f8f=null;ze.N6a=!1;ze.Rdf=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6004791_MergedCellOverlapTelemetry");
ze.zqd=td.EwaSettings.isChangeGateEnabled("OfficeVSO:6413860_Tag_aoi75RetryLoggingFix");ze.oAd=function(Yf){ze.muj(Yf)&&(ze.Vp.cxb(),dc.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};ze.Hui=function(Yf,Sg){dc.ULS.sendTraceTag(537167768,0,50,"CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [{0}]. userPressedExtensionLink={1}",
Yf,Sg);ze.gridView.focus()};ze.vd=function(Yf,Sg){Sg.aN||Sg.xg||ze.Qr("OnWorkbookOpened",!1).catch(function(){})};ze.Th=function(Yf,Sg){Yf=wc(ze.rK);var eg=ze.Vp.Svb(Yf);eg&&(Sg.qa&&Sg.qa.sheetName===eg.sheetName&&eg.isFromCurrentSession(ze.$)?ze.Vp.u7e(eg.ranges,Yf.commandParameters.commandType):ze.Vp.cxb())};ze.rnc=function(Yf,Sg){Yf=wc(ze.rK);(Yf=ze.Vp.Svb(Yf))&&Sg.item&&Sg.item.sheetName===Yf.sheetName&&Yf.isFromCurrentSession(ze.$)&&ze.Qr("OnItemDeleting",!1).catch(function(){})};ze.SEb=function(Yf,
Sg){ze.fbf?ze.f8f(Yf,Sg):ze.rCf()};ze.ER=function(Yf,Sg){1===Sg.Dp&&Sg.Pf.operation.flags&2&&ze.Qr("OnQueueItemChanged/ItemRemoved",!1).catch(function(){})};ze.$=L;ze.Sg=rb;ze.gridView=ae.g(L);ze.Vp=fd;ze.Bai=yd;ze.rK=Ma;ze.T3b=ec;ze.getStringifiedError=cf||copyPasteInfra.getStringifiedError;ze.I1f=1===xe;ze.Ej();ze.copyPasteShortcutDialogFactory=ze.$.da.za(85);dc.ULS.shipAssertTag(537167825,0,!!ze.copyPasteShortcutDialogFactory,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");
be||(dc.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),be=Hc.cch);ze.userHash=Aa.a.ew(be);ze.Jyi="CultureTag: "+yf.a.instance.Trb+" HASH: ";ze.rK.addMetadataChangeListener(Hc.mpf,ze.oAd);ze.ovd=ze.$.ya.MaxCopyPasteLength;ze.TNa=ze.Hwa?td.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",ze.$.ya.CopyPasteMaxPayloadLength):Ve.a.TNa;ze.xo=td.EwaSettings.getBooleanFeatureGate(zf.a.tPa,!1);ze.xo&&L.da.$a(478,function(Yf){ze.pasteShortcutManager=
Yf});ze.fbf&&(ze.f8f=Ff.a(function(){ze.rCf()},1,ze.$.la,"CopyPasteInfrastructure.OnStartEditInternal",!0));return ze}function Tc(L){if(!L)return"null";var Ma=[];L=Gl(L.get());for(var rb=L.next();!rb.done;rb=L.next())rb=rb.value,rb=String.format("{0}({1})",rb.clipboardDataFormat,rb.data.length),Ma.push(rb);Ma.sort();return Ma.join(",")}function Md(L){switch(L){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}}function Xc(L,Ma){return L?Ma&&Ma.ya?L.sessionId!==Ma.ya.UserSessionId:
(dc.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(dc.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1)}function Cd(){}function Sb(){}function Mc(){}function md(L,Ma,rb,ec){this.$=L;this.originalDestinations=Ma;this.R8b=rb;this.Cjg=ec;this.Ttg=this.originalDestinations;this.tng=this.R8b;this.jrg="PasteRecoveryUI"}function wc(L){return L&&(L=L.getCachedMetadata(),null===L||void 0===L?0:L.lastCopy)?L.lastCopy:null}function ed(L){return L.clipboardItems&&(L=
L.clipboardItems.getItem(Ec.xei))&&"1"===L?!0:!1}function Nd(L){return pe(L)&&!(void 0===L.clipboardItems||null===L.clipboardItems)&&!!L.clipboardItems.getItem(Ec.png)&&!L.clipboardItems.getItem(Ec.yW)}function pe(L){return L.clipboardItems&&(L=L.clipboardItems.getItem(Ec.Yhi))&&"1"===L?!0:!1}function Ec(){}function rd(){}function Dd(L){return!!L&&Object.getType(L)===wb}function wb(L,Ma,rb,ec,fd){ec=qf.call(this,ec,fd)||this;dc.ULS.shipAssertTag(537167645,0,!!Ma&&0<Ma.length,"RangeSourceItem.ctor: ranges should not be null or empty");
ec.$=L;ec.ranges=Ma;ec.sheetName=rb;return ec}function lf(L,Ma,rb,ec,fd){rb=qf.call(this,rb,ec)||this;rb.activeFloatingObjectControlId=L;rb.sheetName=Ma;rb.type=fd;return rb}function qf(L,Ma){var rb=this;this.kEh=function(){var ec={};ec.SourceItem=rb.toString();return ec};this.sessionStateId=L;this.sessionId=Ma;this.toJSON=this.kEh}function Cf(L,Ma,rb,ec,fd){var yd=L.Stopwatch,be={};be.a=fd;be.e=yd.id;be.c="RearrangeRowColumn";be.b="mouse";be.d=L.OperationId.toString();be.f=rb.toString();be.g=ec.toString();
be.h=Ma.toString();be.i=L.DragDropIsShiftKeyDown;be.j=!0;be.o=yd.Bc;be.q=!1;be.r=L.CopyPasteTargetType.toString();be.s=L.EncounteredDeploymentErrors;return be}function Fe(L){L=Cg.call(this,L)||this;L.vYg=function(){dc.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};dc.ULS.sendTraceTag(537167828,0,50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");L.ic=0;L.Ac(1,yf.a.instance.ga(2219));var Ma=yf.a.instance.ga(2217),rb=L.FM();L.initializeAndShow(Ma,
L.vYg,rb);return L}function Ke(){this.tb=null}function $d(){this.mib=this.wSb=this.Vv=null}function Id(L,Ma,rb,ec,fd){this.Vv=L;this.zib=Ma;this.vib=rb;this.jde=void 0===ec?null:ec;this.Fkb=void 0===fd?null:fd}function he(){this.tb=null}function Af(L){this.oc=L}function ne(){this.Nhe=0;this.tWa=Array(5);this.tWa[0]=10;this.tWa[1]=15;this.tWa[2]=50;this.tWa[3]=100;this.tWa[4]=200}function Te(L,Ma,rb,ec,fd){this.q$b=!1;this.bsb=null;this.La=L;this.KXa=Ma;this.GVb=rb;this.r1=ec;this.TEc=fd}function Ac(){this.zNf=
this.sSf=this.s7f=this.qjc=this.instance=null}function Kd(L,Ma,rb){this.La=L;this.ff=Ma;this.YSb=rb}function ce(){this.completed=this.c8i=!1}function sd(){this.nge=this.Qae=this.A1d=!0;this.Acj=this.ZWi=null;this.sAi=!1;this.locale=null;this.U$f={}}function Ge(){}function kf(){this.fVb=this.vSb=null}function Ze(L){return da.call(this,L)||this}function je(){this.tb=null}function dg(L,Ma){if(void 0===L||null===L||void 0===Ma||null===Ma)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.wb=L;this.dh=Ma;this.CQc=this.ze=null}function Zd(){this.IIe=this.Gdg=this.Vt=0;this.JIe=this.Hdg=this.sHa="";this.kRc=this.Bea=2}function of(L,Ma){this.bGc=0;this.H2b=null;this.Lib=new re(L,Ma);this.wb=L;Ma=L.Va("HostAuthType");this.hEa=L.ra("OcpsIsEnabled")&&L.ra("IsO365CommercialHost")&&!(void 0===Ma||null===Ma)&&"aad"===Ma.toLowerCase();this.Lbe=If.b(L.Va("OcpsDefaultSettings")||"{}");this.Ajb=this.gbc();Ma=this.wb.ro("ServicesControlsMicrosoftControllerServicesList")?this.wb.zw("ServicesControlsMicrosoftControllerServicesList")||
[]:[];this.qRb=new pf.a;for(var rb=0;rb<Ma.length;rb++)this.qRb.add(Ma[rb]);this.hEa&&!L.ra("IsAnonymousUser")&&L.ra("SideCarIsEnabled")?this.H2b=this.BLj():this.H2b=this.Boa(this.hEa,this.jva("/afhs/CloudPolicySettings.ashx"),Object(ob.a)(this,this.cVi,"parseCloudPolicySettingsResponse"));this.H2b.then(function(){return null}).catch(function(ec){dc.ULS.sendTraceTag(50622685,3004,10,JSON.stringify(ec))})}function Wf(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}function $f(){}
function mg(L,Ma){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=L.PolicySettings;L=new Date;L.setMinutes(L.getMinutes()+Ma);this.ExpirationTime=L.getTime()}function Qf(L,Ma,rb,ec,fd){var yd=this;rb=void 0===rb?null:rb;ec=void 0===ec?null:ec;fd=void 0===fd?null:fd;this.Aua=this.JVb=this.mee=this.Bqa=this.MWb=null;this.Lib=new re(L,Ma);this.wb=L;this.org=L.Dd("LicensingMaxRetryAttempts",0);this.fLc=L.ra("IsO365ConsumerHost");this.eLc=L.ra("IsO365CommercialHost");this.qTb=L.ra("PremiumUpsellIsEnabled");
this.V2d=rb;this.tie=ec;this.La=fd;this.Aqa=L.ra("LicensingIsEnabled");this.hEa=L.ra("OcpsIsEnabled")&&this.eLc;this.zSc=L.ra("ShowPrivacyDialog")&&!!ec;this.b8d=L.ra("IsAnonymousUser");this.o$c=new Promise(function(be){be(!1)});this.qBa=new Promise(function(be){be(!0)});this.zua=new Xd.a(sa.a.Qk());this.zXb=this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1);this.E$d=this.kQh();this.Tod()&&!this.b8d?(void 0!==Gd.AFrameworkApplication.sa&&null!==
Gd.AFrameworkApplication.sa&&(this.MWb=Gd.AFrameworkApplication.sa.yD,void 0!==this.MWb&&null!==this.MWb&&(this.Bqa=this.MWb.Zg("WebServiceCall","ApplicationFeatureHelperService"))),this.Aua=this.FWd()):this.Aua=new Promise(function(be){be({})});this.Aua.catch(function(be){dc.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(be))});this.zXb&&(this.qTb=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(function(be){yd.qTb=yd.wb.ra("PremiumUpsellIsEnabled")&&be;return null}))}function lc(L,Ma,rb){this.featureName=
null;this.isEnabled=!1;this.tierName=0;this.featureName=L;this.isEnabled=Ma;this.tierName=rb}function Kc(L,Ma){this.MIj=3E5;if(void 0===L||null===L||void 0===Ma||null===Ma)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.wb=L;this.nQb=new Xd.a(sa.a.Qk());this.Lib=new re(L,Ma);void 0!==Sd.a.gud&&null!==Sd.a.gud&&void 0!==Sd.a.gkc&&null!==Sd.a.gkc&&0<Sd.a.gkc&&(L=new Fd,L.Token=Sd.a.gud,L.ExpirationTime=Sd.a.gkc,this.nQb.ia("loki",L))}function Fd(){this.Token=null;this.ExpirationTime=
0}function re(L,Ma){this.wb=L;this.dh=Ma}function ke(){this.message=null;this.Ydc=0}b.r(C);var nd=b(0),dc=b(15),Xd=b(892),sa=b(613),ob=b(82),Wb=b(85),hc;(function(L){L[L.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";L[L.cloudPolicySettings=1]="cloudPolicySettings";L[L.alternateAuthToken=2]="alternateAuthToken"})(hc||(hc={}));Object(nd.b)("ApplicationFeatureHelperRequestType",hc);Object(nd.a)(ke,"HttpRequstToPromiseRejectData",null,[]);var pc=b(98),xd=b(246);re.prototype.o3c=
function(L,Ma,rb,ec,fd,yd,be,xe){var cf=this;ec=void 0===ec?null:ec;fd=void 0===fd?null:fd;yd=void 0===yd?null:yd;be=void 0===be?null:be;xe=void 0===xe?null:xe;var ze=hc[rb],Yf=ze+"RequestFailure";pc.Health.instance.recordKpiUsage(Yf,0,"jpittsdirects",null);return new Promise(function(Sg,eg){dc.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",ze);var Pg=null!=be?be:cf.wb.Dd("ApplicationFeatureHelperRequestQueueTimeout",15E3),
Vh=null!=xe?xe:cf.wb.Dd("ApplicationFeatureHelperRequestSentTimeout",3E4);cf.dh.H9(L,1,null,cf.QOh(rb,ec),yd,!1,1,function(fe){dc.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",ze);try{if(void 0===fe||null===fe||void 0===fe.data||null===fe.data||void 0===fe.data.ke||null===fe.data.ke){pc.Health.instance.recordKpiFailure(Yf,"Invalid RequestSucceededEventArgs",!1,!0,null);var af=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
ze);eg(cf.Tvb(af,fe))}else if(fe.data.httpStatus!==xd.a.bP){pc.Health.instance.recordKpiFailure(Yf,"HttpStatusCode_"+fe.data.httpStatus.toString(),!1,!0,null);var zh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",fe.data.httpStatus,ze);eg(cf.Tvb(zh,fe))}else{void 0!==fd&&null!==fd&&void 0!==fe.data.responseHeaders&&null!==fe.data.responseHeaders&&fd(fe.data.responseHeaders);
var yi=Ma(fe.data.ke);if(yi)dc.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",ze),Sg(yi);else{pc.Health.instance.recordKpiFailure(Yf,"Parse Failure",!1,!0,null);var ag=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",ze);eg(cf.Tvb(ag,fe))}}}catch(Zj){pc.Health.instance.recordKpiFailure(Yf,"Unexpected Failure",!1,!0,null),af=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
Zj,ze),eg(cf.Tvb(af,fe))}},function(fe){dc.ULS.sendTraceTag(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",ze);if(fe.data){pc.Health.instance.recordKpiFailure(Yf,"HttpStatusCode_"+fe.data.httpStatus.toString(),!1,!0,null);var af=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",fe.data.httpStatus,fe.data.ke||"No Data",ze)}else pc.Health.instance.recordKpiFailure(Yf,
"Invalid RequestFailedEventArgs",!1,!0,null),af=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",ze);eg(cf.Tvb(af,fe))},null,void 0,void 0,Pg,Vh)})};re.prototype.Tvb=function(L,Ma){var rb=new ke;rb.message=L;rb.Ydc=Ma&&Ma.data?Ma.data.httpStatus:-1;return rb};re.prototype.QOh=function(L,Ma){var rb={};rb["x-UserDataSignature"]=this.wb.Va("UserDataSignature");rb["x-LicensingIsEnabled"]=this.wb.ra("LicensingIsEnabled").toString();
rb["x-CacheIsEnabled"]=this.wb.ra("LicensingRedisIsEnabled").toString();rb["x-OcpsIsEnabled"]=this.wb.ra("OcpsIsEnabled").toString();rb["x-LicensingAADIdIsEnabled"]=this.wb.ra("LicensingAadIdIsEnabled").toString();0===L&&(rb["x-LicenseCheckOnTenantEnabled"]=this.wb.ra("LicensingForSafeLinksIsEnabled").toString(),rb["x-SupportUserConsentDependentFeatures"]=this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1).toString(),rb["x-AFHUserConsentGroupValue"]=
this.wb.getIntFeatureGate("Microsoft.Office.SharedOnline.AFHUserConsentGroupValue",0).toString(),rb["x-UseShellServiceForUserConsentGroup"]=this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseShellServiceForUserConsentGroup",!1).toString(),rb["x-UseSALForLicensing"]=this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSALForLicensingAFHS",!1).toString(),rb["x-SMBUserLicensingEnabled"]=this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SMBUserLicensingEnabled",!1).toString());
if(Ma){L=Gl(Ma.keys);for(var ec=L.next();!ec.done;ec=L.next())ec=ec.value,rb[ec]=Ma.oa(ec)}return rb};Object(nd.a)(re,"HttpRequestToPromiseUtility",null,[]);var Gd=b(4),te;(function(L){L[L.loki=0]="loki";L[L.augloopACLP=1]="augloopACLP"})(te||(te={}));Object(nd.b)("AlternateAuthSupportApp",te);var Sd=b(940),If=b(41);Object(nd.a)(Fd,"WacAlternateAuthToken",null,[]);Kc.prototype.fHh=function(){var L=null;this.nQb.yb(te[0])&&(L=this.nQb.oa(te[0]));return void 0===L||null===L||this.Fqd(L)?this.Vxh():
Promise.resolve(L.Token)};Kc.prototype.Fqd=function(L){return L.ExpirationTime-Date.now()<this.MIj};Kc.prototype.Vxh=function(){var L=this,Ma=new Xd.a(sa.a.Qk());Ma.ia("X-AlternateAuthApp",te[0]);return this.Lib.o3c(this.jva("/afhs/AlternateAuthHelperHandler.ashx"),Object(ob.a)(this,this.ZUi,"parseAlternateAuthTokenResponse"),2,Ma).then(function(rb){dc.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",te[0]);L.nQb.ia(te[0],
rb);return rb.Token},function(rb){rb=Object(Wb.a)(ke,rb);dc.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",rb.message,rb.Ydc);return null})};Kc.prototype.ZUi=function(L){var Ma=If.d(L).Wt;dc.ULS.sendTraceTag(545821457,3004,Ma?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",L);return Ma};Kc.prototype.jva=function(L){return String.format("{0}{1}?{2}",this.wb.Va("WebServiceBase"),L,Gd.AFrameworkApplication.nj)};
Object(nd.a)(Kc,"AlternateAuthHelper",null,[469]);var pf=b(488);Object(nd.a)(lc,"FeatureStateChangeArgs",null,[]);var Ef=b(136),pg=b(261),Ag=b(24),Nf=b(113),Lg=b(176),Mg;(function(L){L[L.Enabled=0]="Enabled";L[L.Disabled=1]="Disabled"})(Mg||(Mg={}));Object(nd.b)("FeatureState",Mg);var Hg=b(84),nh=b(27),Ae=b(190);Qf.prototype.kQh=function(){for(var L=this.wb.ro("AllLicensedFeatures")?this.wb.zw("AllLicensedFeatures"):[],Ma=new pf.a,rb=0;rb<L.length;rb++)Ma.add(L[rb]);return Ma};Qf.prototype.Tod=function(){return this.eLc||
this.fLc};Qf.prototype.FWd=function(L,Ma){var rb=this;L=void 0===L?0:L;Ma=void 0===Ma?!1:Ma;dc.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",Ma);var ec=Ef.a.Rr();ec&&(ec.set("retryAttempt",L.toString()),ec.set("forceRefresh",Ma.toString()),ec.set("isO365ConsumerHost",this.fLc.toString()),ec.set("isO365CommercialHost",this.eLc.toString()),ec.set("isFreemiumUpsellEnabled",this.qTb.toString()));pc.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",ec);pc.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",ec);void 0!==this.Bqa&&null!==this.Bqa&&this.Bqa.start();var fd=null;Ma&&(fd=new Xd.a(sa.a.Qk()),fd.ia("x-LicensingForceRefresh","true"));this.mee=new Date;return(this.Aqa?this.Lib.o3c(this.jva("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(ob.a)(this,this.bVi,"parseApplicationFeatureHelperResponse"),0,fd,Object(ob.a)(this,this.u_i,"processApplicationFeatureHelperResponseHeaders"),["Date"]):
Promise.resolve({})).then(function(yd){var be=Object.assign(new Ae.a,{durationMs:rb.r5f()});be.extendedProperties=ec;be.extendedProperties&&yd&&(be.extendedProperties.set("featureCount",Nf.a.count(yd).toString()),be.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in yd).toString()),be.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in yd).toString()),rb.JVb&&be.extendedProperties.set("fromCache",(rb.JVb<rb.mee).toString()));pc.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",
be);return yd},function(yd){var be=Object.assign(new Ae.a,{durationMs:rb.r5f()}),xe=Object(Wb.a)(ke,yd);if(!xe)return dc.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),pc.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,be),new Promise(function(cf,ze){ze(yd)});be.extendedProperties=ec;be.extendedProperties&&be.extendedProperties.set("status",xe.Ydc.toString());
pc.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,be);return 408===xe.Ydc&&++L<=rb.org?rb.FWd(L):new Promise(function(cf,ze){ze(xe)})})};Qf.prototype.bVi=function(L){(L=If.b(L))?(dc.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),dc.ULS.sendTraceTag(50938594,3004,50,"{0}",L)):dc.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return L.Features};Qf.prototype.jva=function(L){var Ma=String.format("{0}{1}",this.wb.Va("WebServiceBase"),L);this.wb.ro("ApplicationFeatureHelperHttpCachingEnabled")&&this.wb.ra("ApplicationFeatureHelperHttpCachingEnabled")&&(L=Qf.gbc(this.wb))&&0<L.length&&(this.zXb&&(L+="ucbf"),Ma=new pg.QueryStringBuilder(Ma),Ma.Wi("afhskey",L),Ma=Ma.toString());return Ma};Qf.prototype.isFeatureEnabled=function(L,Ma){var rb=this;if(!this.hEa&&!this.zSc&&!this.Aqa)return this.qBa;dc.ULS.sendTraceTag(42513091,3004,
50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",L);if("ConnectedServices"===L){var ec=this.hEa?this.V2d.RJ("ControllerConnectedServicesEnabled"):this.qBa,fd=this.zSc?this.tie.getSettings().then(function(xe){return 2!==xe.Vt},function(){return Ma}):this.qBa;return ec.then(function(xe){return xe?fd:rb.o$c})}ec=null;ec=this.hEa?this.V2d.isFeatureEnabled(L):this.qBa;var yd=null;yd=this.Aqa?this.jgi(L,Ma):this.qBa;var be=null;be=this.zSc?this.tie.isFeatureEnabled(L):
this.qBa;return ec.then(function(xe){return xe?be.then(function(cf){return cf?yd:rb.o$c}):rb.o$c}).then(function(xe){rb.dlf(L,xe,!0);return xe},function(){rb.dlf(L,Ma,!1);return Ma})};Qf.prototype.dlf=function(L,Ma,rb){dc.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",L,Ma,rb)};Qf.prototype.getFeatureTier=function(L,Ma){var rb=this;if(!this.Aqa)return new Promise(function(ec){ec(2)});dc.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",
L);return this.Aua.then(function(ec){return rb.ccc(L,ec,Ma)},function(){return Ma})};Qf.prototype.isFreemiumUpsellEnabled=function(){return this.qTb&&this.fLc&&!this.b8d};Qf.prototype.launchUpsellExperience=function(L,Ma){Ma=void 0===Ma?null:Ma;dc.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",L));var rb=Ef.a.Rr();rb&&(rb.set("experienceId",L),Ma&&rb.set("campaignId",Ma));pc.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",
1,"waclicensing",rb);if(rb=Hg.a.instance.Lh("Common.IInProductMessagingUIManager")){var ec=Object(ob.a)(this,this.P0h,"handleDimeTaskComplete");rb.kjf(L,ec,Ma)}else dc.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),pc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),Ma={},this.La.se(nh.a.r$b,2,(Ma.experience=L,Ma))};Qf.prototype.Pma=function(L,Ma){if(!this.Aqa)return null;if(!L||!Ma)return dc.ULS.sendTraceTag(594564813,
3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;var rb=Lg.a.create().toString();this.zua.yb(L)||this.zua.ia(L,new Xd.a(sa.a.Qk()));this.zua.oa(L).add(rb,Ma);dc.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",rb,L));return rb};Qf.prototype.PHd=function(L,Ma){this.Aqa&&(L&&this.zua.yb(L)?Ma&&Lg.a.isValid(Ma)?this.zua.oa(L).yb(Ma)?(dc.ULS.sendTraceTag(594564808,
3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",Ma,L)),this.zua.oa(L).remove(Ma)):dc.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",Ma,L)):dc.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",Ma,L)):dc.ULS.sendTraceTag(594564811,
3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",L)))};Qf.prototype.ccc=function(L,Ma,rb){return this.zXb?L in Ma?Ma[L].LicenseTier:rb:L in Ma?this.zVi(Ma[L],rb):rb};Qf.prototype.zVi=function(L,Ma){switch(L.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return Ma}};Qf.prototype.P0h=function(){var L=this;dc.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");
this.Aua.then(function(Ma){L.CMf(Ma)}).catch(function(){L.CMf({})})};Qf.prototype.CMf=function(L){var Ma=this;dc.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");var rb=this.FWd(0,!0);rb.then(function(ec){Ma.Aua=rb;Nf.a.count(ec)>Nf.a.count(L)?pc.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):pc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(var fd=Gl(Ma.zua.keys),yd=fd.next();!yd.done;yd=
fd.next())if(yd=yd.value,yd in ec){var be=Ma.ccc(yd,ec,0);yd in L?Ma.ccc(yd,L,0)!==be&&Ma.Mxd(yd,!0,be):Ma.Mxd(yd,!0,be)}else yd in L&&Ma.Mxd(yd,!1,Ma.ccc(yd,L,0))}).catch(function(ec){pc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);dc.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(ec))})};Qf.prototype.Mxd=function(L,Ma,rb){dc.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
L,Ma,rb);Ma=new lc(L,Ma,rb);rb=this.zua.oa(L);rb=Gl(rb);for(var ec=rb.next();!ec.done;ec=rb.next()){ec=ec.value;try{ec.value(Ma)}catch(fd){dc.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",L,ec.key,fd.message))}}};Qf.prototype.me=function(L,Ma){var rb=this;if(this.Aqa){var ec=this.E$d.contains(L),fd=!0,yd="",be=!1;return this.Aua.then(function(xe){L in xe?
(xe=xe[L],yd=Mg[xe.FeatureState],fd=1!==xe.FeatureState):fd=!ec;rb.nlf(L,ec,yd,be,Ma,fd);return fd},function(){be=!0;ec&&(fd=Ma);rb.nlf(L,ec,yd,be,Ma,fd);return fd})}return this.qBa};Qf.prototype.nlf=function(L,Ma,rb,ec,fd,yd){dc.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",L,Ma,ec,rb,fd,yd)};Qf.prototype.jgi=function(L,Ma){if(this.zXb)return this.me(L,Ma);if(this.Aqa){if(this.E$d.contains(L))return this.Aua.then(function(rb){return L in
rb},function(){return Ma});dc.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",L)}return this.qBa};Qf.prototype.u_i=function(L){try{L&&"Date"in L&&(this.JVb=new Date(L.Date),dc.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.JVb.toString()))}catch(Ma){dc.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",
Ma)}};Qf.prototype.r5f=function(){if(void 0!==this.Bqa&&null!==this.Bqa){var L=this.Bqa.Bc;this.Bqa.stop();return L}return null};Qf.gbc=function(L){try{if(Ag.a.WEj){var Ma=L.Va("UserDataSignature").split(".");if(1<Ma.length){var rb=window.self.atob(Ma[1]),ec=JSON.parse(rb).LocalStorageKey;if(void 0!==ec&&null!==ec&&0<ec.length)return ec}}}catch(fd){dc.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",fd.toString())}return null};Object(nd.a)(Qf,"ApplicationFeatureHelper",null,
[470]);var Dg=b(202);Object(nd.a)(mg,"CloudPolicySettingsCacheData",null,[]);var Jf=b(1024),fg=b(390),Jg=b(233);$f.E3f=function(){return Gd.AFrameworkApplication.fa.ra("SideCarIsEnabled")?$f.Huc&&$f.ond?new Promise(function(L){L(!0)}):new Promise(function(L,Ma){$f.Huc=Jg.a.create(Gd.AFrameworkApplication.fa.Va("SideCarUrl"));fg.a.yia($f.Huc);$f.Huc.L9(function(rb,ec){($f.ond=ec.succeeded)?L(ec.succeeded):Ma(ec.succeeded)})}):new Promise(function(L){L(!1)})};$f.ond=!1;$f.Huc=null;Object(nd.a)($f,"SideCarLoader",
null,[]);Object(nd.a)(Wf,"CloudPolicySettingsData",null,[]);of.prototype.RJ=function(L,Ma){Ma=void 0===Ma?!0:Ma;if(!this.hEa){var rb=this;return new Promise(function(be){be(rb.Cvb(L))})}var ec=this,fd=this,yd=this.H2b.then(function(be){try{var xe=null;be.PolicySettings&&"unknown"in be.PolicySettings&&(xe=be.PolicySettings.unknown);if(xe){if(L in xe&&void 0!==xe[L]&&null!==xe[L])return new Promise(function(ze){ze("0"!==xe[L])});var cf=L.toLowerCase();if(cf in xe&&void 0!==xe[cf]&&null!==xe[cf])return new Promise(function(ze){ze("0"!==
xe[cf])});dc.ULS.sendTraceTag(51512667,3004,50,"Policy"+L+" not found, using default");return new Promise(function(ze){ze(ec.Cvb(L))})}return new Promise(function(ze){ze(ec.Cvb(L))})}catch(ze){return dc.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+L+" policy value. Error Message: {0}",ze.message),ec.handleError(ze.toString(),Ma,ec.Cvb(L))}},function(be){return fd.handleError(be,Ma,fd.Cvb(L))});yd.then(function(be){dc.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",
L,be);return null});return yd};of.prototype.isFeatureEnabled=function(L,Ma){Ma=void 0===Ma?!0:Ma;if(this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.lgi(L,Ma);var rb=new Promise(function(fd){fd(!0)}),ec="";this.qRb.contains(L)&&(ec="ControllerConnectedServicesEnabled",rb=this.RJ(ec,Ma));rb.then(function(fd){dc.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
L,fd,ec);return null});return rb};of.prototype.lgi=function(L,Ma){Ma=void 0===Ma?!0:Ma;var rb=new Promise(function(fd){fd(!0)}),ec="";"mso_sendASmile"===L?ec="Enabled":"Survey"===L||"FloodgateSurvey"===L?ec="SurveyEnabled":this.qRb.contains(L)&&(ec="ControllerConnectedServicesEnabled");""!==ec&&(rb=this.RJ(ec,Ma));rb.then(function(fd){dc.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",L,fd,ec);return null});return rb};
of.prototype.handleError=function(L,Ma,rb){return Ma?new Promise(function(ec){ec(rb)}):new Promise(function(ec,fd){fd(L)})};of.prototype.Boa=function(L,Ma,rb){var ec=this;if(!L)return Promise.resolve(new Wf);var fd=!1,yd=null;pc.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);var be=this.M2c("GetCloudPolicySettings");return(new Promise(function(xe,cf){if(void 0!==ec.Ajb&&null!==ec.Ajb&&0<ec.Ajb.length){var ze=ec.lLj();if(void 0!==ze&&null!==ze){fd=!0;xe(ze);return}}ec.Lib.o3c(Ma,
rb,1,null,Object(ob.a)(ec,ec.y_i,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],ec.wb.Dd("CloudPolicySettingsRequestQueueTimeout",15E3),ec.wb.Dd("CloudPolicySettingsRequestSentTimeout",3E4)).then(function(Yf){dc.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");ec.aMj(Yf);xe(Yf);return Yf},function(Yf){cf(Yf);return null})})).then(function(xe){var cf=ec.Byc(be);be=cf.stopwatch;yd=cf.returnValue;(cf=Ef.a.Rr())&&cf.set("FromCache",fd.toString());cf=
Object.assign(new Ae.a,{durationMs:yd,extendedProperties:cf});pc.Health.instance.recordKpiSuccess("GetCloudPolicySettings",cf);return xe})};of.prototype.BLj=function(){return $f.E3f().then(function(){dc.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})};of.prototype.jva=function(L){return String.format("{0}{1}",this.wb.Va("WebServiceBase"),L)};of.prototype.cVi=function(L){var Ma=
If.d(L).Wt;dc.ULS.sendTraceTag(50622687,3004,Ma?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",L);return Ma};of.prototype.y_i=function(L){try{if(void 0!==L&&null!==L&&"CheckIn-Interval"in L){var Ma=parseInt(L["CheckIn-Interval"]);void 0!==Ma&&null!==Ma&&0<Ma&&(this.bGc=Ma)}}catch(rb){dc.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",rb)}};of.prototype.Cvb=function(L){return L in this.Lbe?"0"!==this.Lbe[L]:!0};of.prototype.lLj=
function(){try{var L=Jf.a.instance.getItem(this.Ajb);if(void 0===L||null===L)return dc.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;dc.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",L);var Ma=JSON.parse(L);if(void 0===Ma||null===Ma)return dc.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===
Ma.ExpirationTime||null===Ma.ExpirationTime)return dc.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(Ma.ExpirationTime)).getTime()<Date.now())return dc.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;var rb=new Wf;rb.PolicySettings=Ma.PolicySettings;rb.ControllerConnectedServicesFeatureNames=new Dg.a;this.wb.ro("ServicesControlsMicrosoftControllerServicesList")&&
this.wb.zw("ServicesControlsMicrosoftControllerServicesList");for(var ec=Gl(this.qRb),fd=ec.next();!fd.done;fd=ec.next())rb.ControllerConnectedServicesFeatureNames.add(fd.value);dc.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return rb}catch(yd){return dc.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",yd.toString()),null}};of.prototype.aMj=function(L){try{if(void 0===L||null===L||void 0===L.PolicySettings||
null===L.PolicySettings)dc.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.bGc)dc.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{var Ma=new mg(L,this.bGc),rb=JSON.stringify(Ma);dc.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",rb);Jf.a.instance.setItem(this.Ajb,rb);dc.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(ec){dc.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",ec.toString())}};of.prototype.gbc=function(){var L=Qf.gbc(this.wb);return L&&0<L.length?"OCPS"+L:null};of.prototype.M2c=function(L){var Ma=Hg.a.instance.Lh("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==Ma&&null!==Ma?Ma.Gc("WebServiceCall",L):null};of.prototype.Byc=function(L){if(void 0!==L&&null!==L){var Ma=L.Bc;L.stop();return{returnValue:Ma,stopwatch:null}}return{returnValue:null,stopwatch:L}};Object(nd.a)(of,
"CloudPolicySettingsHelper",null,[467]);Zd.prototype.clone=function(){var L=new Zd;L.Vt=this.Vt;L.Gdg=this.Gdg;L.IIe=this.IIe;L.sHa=this.sHa;L.Hdg=this.Hdg;L.JIe=this.JIe;L.Bea=this.Bea;L.kRc=this.src;return L};Zd.prototype.serialize=function(L){L=void 0===L?null:L;var Ma={};if(!L||L.contains(Zd.jOa))Ma[Zd.jOa]=this.Vt;if(!L||L.contains(Zd.BDb))Ma[Zd.BDb]=this.sHa;if(!L||L.contains(Zd.CDb))Ma[Zd.CDb]=this.Bea;return JSON.stringify(Ma)};Zd.create=function(L,Ma){Ma=void 0===Ma?null:Ma;var rb=new Zd;
rb.kRc=L;void 0!==Ma&&null!==Ma&&(Zd.jOa in Ma&&(rb.Vt=Ma[Zd.jOa]),Zd.BDb in Ma&&(rb.sHa=Ma[Zd.BDb]),Zd.CDb in Ma&&(rb.Bea=Ma[Zd.CDb]));return rb};Zd.deserialize=function(L,Ma){try{var rb=JSON.parse(L);if(void 0!==rb&&null!==rb)return Zd.create(Ma,rb);dc.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",L);throw Error.argument("settingsData");}catch(ec){throw dc.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",ec.toString()),
ec;}};Ck.Object.defineProperties(Zd.prototype,{src:{configurable:!0,enumerable:!0,get:function(){return this.kRc}}});Zd.jOa="CCS";Zd.BDb="CCSTime";Zd.CDb="OfficePrivacyRoamedNoticeShown";Object(nd.a)(Zd,"UserPrivacySettings",null,[]);var Og=b(128);dg.prototype.jva=function(L){var Ma=String.format("{0}RoamingServiceHandler.ashx?action=",this.wb.appSettings.RoamingServiceHandlerWebServiceBase||"");Ma=new Sys.StringBuilder(Ma);Ma.append(L);Ma.append("&");Ma.append(Gd.AFrameworkApplication.nj);return Ma.toString()};
dg.prototype.executeRequest=function(L,Ma,rb,ec){return this.dh.RYb(L,Ma,void 0===ec?null:ec,null,rb,"33",!1,null,6E4)};dg.prototype.saveSettings=function(L){var Ma=this;return new Promise(function(rb,ec){try{if(void 0===Ma.ze||null===Ma.ze||void 0===L||null===L)dc.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),ec("Can't determine setting changes to save");else{var fd=Ma.ze.Vt!==L.Vt;if(2===Ma.ze.src&&fd)Ma.jij(L),rb(!0);else{var yd=Ma.amj(L);
if(void 0===yd||null===yd||!yd.length)dc.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),ec("No changes to save");else if(1===Ma.ze.src)rb(Ma.D$f(yd));else if(0===Ma.ze.src){dc.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",yd);var be=Ma.executeRequest(Ma.jva("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",yd);be.continueWith(function(){if(be.Ph||be.kg)dc.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),
rb(!1);else{var xe=be.result;void 0!==xe.fh&&null!==xe.fh&&void 0!==xe.fh.data&&null!==xe.fh.data&&xe.fh.data.httpStatus===xd.a.bP?(dc.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),rb(!0)):(dc.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),rb(!1))}})}}}}catch(xe){dc.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",xe.toString()),rb(!1)}})};dg.prototype.amj=function(L){if(void 0===this.ze||null===
this.ze||void 0===L||null===L)throw Error.invalidOperation("User Privacy settings have not been initialized");var Ma=new Dg.a;0===L.src?(this.ze.Vt!==L.Vt&&(Ma.add(Zd.jOa),Ma.add(Zd.BDb)),this.ze.Bea!==L.Bea&&Ma.add(Zd.CDb)):1===L.src&&this.ze.Vt!==L.Vt&&Ma.add(Zd.jOa);return Ma.count?L.serialize(Ma):(dc.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)};dg.prototype.getSettings=function(){if(!this.CQc){var L=this;this.CQc=new Promise(function(Ma){try{L.ze?
Ma(L.ze.clone()):L.tLj().then(function(rb){L.ze=rb;Ma(L.ze.clone());return null},function(){L.rLj().then(function(rb){L.ze=rb;Ma(L.ze.clone());return null},function(){L.sLj().then(function(rb){L.ze=rb;Ma(L.ze.clone());return null},function(){dc.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");L.ze=new Zd;Ma(L.ze.clone());return null});return null});return null})}catch(rb){dc.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
rb.toString()),L.ze=new Zd,Ma(L.ze.clone())}})}return this.CQc};dg.prototype.tLj=function(){var L=this;return new Promise(function(Ma,rb){try{var ec=-1!==window.location.href.indexOf("&wd_pn=2");if(L.wb.ra("PrivacyDialogShouldCheckRoaming")||ec){var fd=L.executeRequest(L.jva("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");fd.continueWith(function(){try{if(fd.Ph||fd.kg)dc.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{var yd=fd.result;
if(yd&&yd.fh&&yd.fh.data)if(yd.fh.data.httpStatus!==xd.a.bP)dc.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",yd.fh.data.httpStatus);else{if(yd.fh.data.ke){Ma(dg.parse(yd.fh.data.ke,0));dc.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",yd.fh.data.ke);return}dc.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else dc.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");rb("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(be){dc.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",be.toString()),rb("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else dc.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),rb("Roaming should not be used")}catch(yd){dc.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",yd.toString()),rb("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})};dg.prototype.rLj=function(){var L=this;return new Promise(function(Ma,rb){try{var ec=Og.a.get("WacUPToggleState"),fd=null;void 0!==ec&&null!==ec&&0<ec.length&&(fd=decodeURIComponent(ec));if(void 0!==fd&&null!==fd&&0<fd.length){var yd=dg.parse(fd,1);dc.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",yd.toString());
Ma(yd)}else{var be=Zd.create(1),xe=new Dg.a;xe.add(Zd.jOa);var cf=be.serialize(xe);L.D$f(cf)?(dc.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",cf),Ma(be)):(dc.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",cf),rb("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(ze){dc.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
ze.toString()),rb("UserPrivacySettings TryGetSettingsFromCookie Eception")}})};dg.prototype.sLj=function(){return new Promise(function(L){try{var Ma=-1!==window.location.href.indexOf("&wdccsoff=1"),rb=Zd.create(2);Ma?(rb.Vt=2,Gd.AFrameworkApplication.rHe(),dc.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",rb.toString())):(rb.Vt=1,dc.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",
rb.toString()));L(rb)}catch(ec){dc.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",ec.toString()),Ma=Zd.create(2),Ma.Vt=1,L(Ma)}})};dg.prototype.jij=function(L){dc.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===L.Vt?Gd.AFrameworkApplication.rHe():Gd.AFrameworkApplication.xjh();dc.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",L)};dg.prototype.D$f=function(L){try{dc.ULS.sendTraceTag(51258455,
3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",L);var Ma=this.wb.Va("PrivacyCookieDomain")||"";if(!Ma||!Ma.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");dc.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",L);return Og.a.XOd("WacUPToggleState",L,Og.a.iW,"/",Ma)}catch(rb){return dc.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",rb.toString()),!1}};dg.prototype.isFeatureEnabled=
function(L){var Ma=this;return this.getSettings().then(function(rb){for(var ec=Ma.wb.ro("ServicesControlsMicrosoftControllerServicesList")?Ma.wb.zw("ServicesControlsMicrosoftControllerServicesList"):[],fd=new pf.a,yd=0;yd<ec.length;yd++)fd.add(ec[yd]);return fd.contains(L)?2!==rb.Vt:!0},function(){dc.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",L);return!0})};dg.parse=function(L,Ma){try{return dc.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",
L,Ma),Zd.deserialize(L,Ma)}catch(rb){throw dc.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",rb.toString()),rb;}};Object(nd.a)(dg,"UserPrivacySettingsHelper",null,[468]);var ef=b(257);je.prototype.fi=function(L){var Ma=this;this.tb=L;this.tb.register(467,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").Hc().Oc(function(){return new of(Gd.AFrameworkApplication.fa,Gd.AFrameworkApplication.Jd)});this.tb.register(468,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").Hc().Oc(function(){return new dg(Gd.AFrameworkApplication.fa,
Gd.AFrameworkApplication.Jd)});this.tb.register(469,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").Hc().Oc(function(){return new Kc(Gd.AFrameworkApplication.fa,Gd.AFrameworkApplication.Jd)});this.tb.register(470,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").Hc().Oc(function(){return new Qf(Gd.AFrameworkApplication.fa,Gd.AFrameworkApplication.Jd,Ma.tb.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),Ma.tb.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
Gd.AFrameworkApplication.Ib)})};je.prototype.init=function(){var L=this;Gd.AFrameworkApplication.fa.hv(function(){var Ma=L.tb.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");Gd.AFrameworkApplication.fa.ra("LicensingIsEnabled")&&(Ma.isFeatureEnabled("LicensingTestFeature",!1).then(function(rb){dc.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",rb,Gd.AFrameworkApplication.fa.Va("IsAnonymousUser"));
return null}),Ma.getFeatureTier("LicensingTestFeature",0).then(function(rb){dc.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",rb,Gd.AFrameworkApplication.fa.Va("IsAnonymousUser"));return null}));L.tb.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");L.tGj()})};je.prototype.dispose=function(){};je.prototype.tGj=function(){try{Gd.AFrameworkApplication.fa.ra("SideCarIsEnabled")&&$f.E3f().then(function(L){dc.ULS.sendTraceTag(594057429,
3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",L);return L})}catch(L){}};je.main=function(){ef.a.instance.gj(new je)};Ck.Object.defineProperties(je.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}}});Object(nd.a)(je,"ApplicationFeatureHelperPackage",null,[4,5]);var ng=b(120),Xb=b(419),da=Xb.a;Wl(Ze,da);Ze.prototype.createElement=function(){var L=document.createElement("link");L.setAttribute("rel",
"stylesheet");L.setAttribute("type","text/css");L.setAttribute("href",this.qu);return L};Ze.prototype.m3c=function(){return null};Ze.prototype.Wrc=function(){this.element.setAttribute("href","");this.element.setAttribute("href",this.iI.qu)};Ck.Object.defineProperties(Ze.prototype,{Y3b:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(nd.a)(Ze,"CssResource",Xb.a,[]);var Aa=b(29),qb=b(58);kf.prototype.iri=function(){this.vSb||(dc.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),
this.vSb=qb.Task.WAA(kf.nri(),kf.fri()),this.vSb.continueWith(function(L){dc.ULS.sendTraceTag(21030599,324,10,"{0}",Aa.a.xdd(L.exception))},5));return this.vSb};kf.prototype.kri=function(){if(!this.fVb)try{dc.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.fVb=qb.Task.WAA(kf.K7c(Jg.a.create(Gd.AFrameworkApplication.fa.Va("DimeUrl"),null,null))),this.fVb.continueWith(function(L){dc.ULS.sendTraceTag(39978391,324,10,"{0}",Aa.a.xdd(L.exception))},5)}catch(L){dc.ULS.sendTraceTag(594874951,
324,10,"{0}",Aa.a.xdd(L))}return this.fVb};kf.nri=function(){var L=kf.ecc("inproductmessaging.js");L=Jg.a.create(L,null,null);return kf.K7c(L)};kf.fri=function(){var L=kf.ecc("inproductmessaging.css");L=new Ze(L);return kf.K7c(L)};kf.ecc=function(L){return ng.a.b3b(String.format("ipm/{0}",L))};kf.K7c=function(L){fg.a.yia(L);return L.Q7a};Object(nd.a)(kf,"DependencyDownloader",null,[944]);Ge.mUi="inProductMessagingOverlayDiv";Ge.YWi="PlayButtonImage";Ge.zcj="ReplayButtonImage";Object(nd.a)(Ge,"Constants",
null,[]);sd.prototype.eqj=function(){this.Xle(Ge.YWi,this.ZWi);this.Xle(Ge.zcj,this.Acj)};sd.prototype.Xle=function(L,Ma){Ma&&(this.U$f[L]=Ma)};Ck.Object.defineProperties(sd.prototype,{uMg:{configurable:!0,enumerable:!0,get:function(){return this.A1d},set:function(L){this.A1d=L}},wzi:{configurable:!0,enumerable:!0,get:function(){return this.Qae},set:function(L){this.Qae=L}},xyj:{configurable:!0,enumerable:!0,get:function(){return this.nge},set:function(L){(this.nge=L)&&this.eqj()}}});Object(nd.a)(sd,
"FirstRunExperienceUISettings",null,[943]);Object(nd.a)(ce,"FirstRunExperienceViewData",null,[942]);var jc=b(180),id=b(107);Kd.prototype.Og=function(){this.La.Ve(nh.a.JAh,id.a.frame,Object(ob.a)(this,this.HAh,"firstRunExperienceHandler"),64);this.La.fc(nh.a.fTe,id.a.frame,Object(ob.a)(this,this.g7h,"inProductMessagingTabHandler"));this.La.fc(nh.a.eTe,id.a.frame,Object(ob.a)(this,this.f7h,"inProductMessagingShiftTabHandler"));this.La.fc(nh.a.yeh,id.a.frame,Object(ob.a)(this,this.zeh,"dimeLaunchHandler"));
this.La.fc(nh.a.UQf,id.a.frame,jc.ActionManager.sg);this.La.fc(nh.a.Ycj,id.a.frame,jc.ActionManager.sg);this.La.fc(nh.a.Zcj,id.a.frame,jc.ActionManager.sg);this.ff&&this.ff.updateCommandUI()};Kd.prototype.HAh=function(L,Ma,rb,ec,fd){2===rb&&this.YSb.Ipi(fd);return 32};Kd.prototype.zeh=function(L,Ma,rb,ec,fd){2===rb&&this.YSb.Fpi(fd);return 32};Kd.prototype.g7h=function(L,Ma,rb){return 2===rb?this.YSb.kwd():32};Kd.prototype.f7h=function(L,Ma,rb){return 2===rb?this.YSb.iwd():32};Object(nd.a)(Kd,"InProductMessagingActor",
null,[]);Object(nd.a)(Ac,"DimeExperienceUISettings",null,[]);var Gc=b(166),Rd=b(496);Te.prototype.U9h=function(L){Gc.b("getHeaderApi")?L.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Ma){var rb=L.isFreemiumUpsellEnabled();rb&&(appChrome.getHeaderApi().then(function(ec){ec.updatePremiumStatus(Ma,rb);return null}),L.Pma("MsoPremiumBadge",function(ec){appChrome.getHeaderApi().then(function(fd){fd.updatePremiumStatus(ec.isEnabled,rb);return null})}));return null}):dc.ULS.sendTraceTag(593859840,
324,10,"getHeaderApi not available")};Te.prototype.Ipi=function(L){var Ma=this;this.GVb.iri().continueWith(function(){Ma.KXa.Rzj(L)})};Te.prototype.Fpi=function(L){function Ma(){}var rb="gopremium",ec=null;L?(L.experience&&""!==Object(Wb.a)(String,L.experience)&&(rb=Object(Wb.a)(String,L.experience)),L.onTaskComplete&&(Ma=L.onTaskComplete),L.campaignId&&""!==Object(Wb.a)(String,L.campaignId)&&(ec=Object(Wb.a)(String,L.campaignId))):dc.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");
this.kjf(rb,Ma,ec)};Te.prototype.kjf=function(L,Ma,rb){var ec=this;rb=void 0===rb?null:rb;if(this.q$b&&this.bsb){var fd={};fd.experience=L||"gopremium";fd.campaignId=rb||Rd.b(this.r1,this.TEc,Object(Wb.a)(String,fd.experience),!0);this.La.processAction(nh.a.UQf,2);dc.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+fd.experience);try{var yd=Object.assign(new Ac,{instance:this.bsb,qjc:fd,s7f:Ma||function(){},sSf:function(be){dc.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+
be.status)},zNf:function(){dc.ULS.sendTraceTag(51675406,324,10,"Dime launch error");ec.q$b=!1;ec.bsb=null}});this.KXa.eyj(yd)}catch(be){dc.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+be.message),this.q$b=!1,this.bsb=null,L={},this.La.se(nh.a.r$b,2,(L.experience=fd.experience,L))}}else dc.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),fd={},this.La.se(nh.a.r$b,2,(fd.experience=L,fd))};Te.prototype.ckf=function(){var L=this;this.GVb.kri().continueWith(function(){try{var Ma=
Aa.a.Al(Gd.AFrameworkApplication.uiCulture),rb=Rd.c(L.r1);if(rb){Ma={partnerId:rb,language:Ma};Ma.sessionId=Gd.AFrameworkApplication.userSessionId;Ma.authHint=Gd.AFrameworkApplication.fa.Va("UserPrincipalName");var ec=Gd.AFrameworkApplication.fa.Va("Puid")||"";""!==ec&&(Ma.userInfo={puid:ec});L.bsb=new Dime(Ma);L.q$b=!0;dc.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else dc.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(fd){dc.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+
fd.message)}},3)};Te.prototype.kwd=function(){return this.KXa.kwd()};Te.prototype.iwd=function(){return this.KXa.iwd()};Object(nd.a)(Te,"InProductMessagingUIManager",null,[941]);ne.prototype.Init=function(L){this.Nhe=L};ne.prototype.SendTrace=function(L,Ma){dc.ULS.sendTraceTag(34182235,this.Nhe,this.tWa[L],"{0}",Ma)};Object(nd.a)(ne,"DefaultNetworkingManager",null,[958]);var Ce=b(273),Re=b(325),Pf=b(96);Af.prototype.Rzj=function(L){L&&(InProductMessaging.Networking.NetworkingMgr=new ne,InProductMessaging.Networking.NetworkingMgr.Init(387),
InProductMessaging.Init(L.xyj,L.wzi,L.uMg,L.sAi,L.locale,Object(ob.a)(this,this.GHi,"onDismissFirstRunExperience"),L.U$f),this.pRa(Ge.mUi,!0))};Af.prototype.eyj=function(L){var Ma=this;if(L&&L.instance&&L.qjc){var rb=document.getElementById("wacDimeContainer");rb||(rb=document.createElement("div"),rb.id="wacDimeContainer",document.body.appendChild(rb));Gd.AFrameworkApplication.fa.ra("DimeFocusManagerIsEnabled")&&this.pRa("wacDimeContainer",!1);L.qjc.parentElementId="wacDimeContainer";L.instance.launch(L.qjc,
L.s7f).then(function(ec){Ma.zHb();document.body.removeChild(rb);L.sSf(ec)}).catch(function(ec){Ma.zHb();document.body.removeChild(rb);L.zNf(ec)})}else throw Error.argument("DimeExperienceUISettings");};Af.prototype.pRa=function(L,Ma){if(this.oc&&L&&(L=document.getElementById(L),this.L9h(L),L=this.oc.GM("InProductMessagingFocusId"))){var rb=this.oc.Gi;rb&&"InProductMessagingFocusId"===rb.name||this.oc.VR("InProductMessagingFocusId",!1);Ma&&this.ELf(L.scope)}};Af.prototype.L9h=function(L){var Ma=!1;
Ma=void 0===Ma?!0:Ma;var rb=this.oc.yi("InProductMessagingFocusId");rb.parent=Ce.AFrame.dU;var ec=new Re.DOMFocusListing(function(){return L});ec.Nab=Ma;ec.ko(3);ec.ko(2);ec.ko(4);Ma=this.oc.Bsa(function(){return L},rb,ec);Ma.sHb();Ma.A_=!0;Ma.kHa=!0};Af.prototype.ELf=function(L){L.$k(Pf.FocusManager.instance().j2);L.$k(Pf.FocusManager.instance().k2);L.bindAction(Pf.FocusManager.instance().j2,nh.a.fTe);L.bindAction(Pf.FocusManager.instance().k2,nh.a.eTe)};Af.prototype.zHb=function(){this.oc&&(this.oc.Mca("InProductMessagingFocusId"),
this.oc.bQa("InProductMessagingFocusId"))};Af.prototype.GHi=function(L,Ma){this.zHb();L=Object.assign(new ce,{completed:L,c8i:Ma});Gd.AFrameworkApplication.Ib.se(nh.a.GAh,2,L)};Af.prototype.kwd=function(){var L=document.activeElement,Ma=this.oc.MQ();return L&&Ma&&Ma.jf&&L===Ma.jf.Gw?(Ma.jf.Bl(L),Ma.Vxa()?32:8):4};Af.prototype.iwd=function(){var L=document.activeElement,Ma=this.oc.MQ();return L&&Ma&&Ma.jf&&L===Ma.jf.firstElement?(Ma.jf.Bl(L),Ma.bOa()?32:8):4};Object(nd.a)(Af,"InProductMessagingUIWrapper",
null,[940]);var Le=b(142);he.prototype.fi=function(L){L.register(kf,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").Hc().Oc(function(){return new kf});L.register(Af,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").Hc().Oc(function(){return new Af(Pf.FocusManager.instance())});L.register(Te,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").Hc().Oc(function(){return new Te(Gd.AFrameworkApplication.Ib,
L.resolve("Common.IInProductMessagingUIWrapper"),L.resolve("Common.App.InProductMessaging.IDependencyDownloader"),Gd.AFrameworkApplication.sa.Qa.Sj,Gd.AFrameworkApplication.sa.Qa.oca)});L.register(Kd,"Common.App.InProductMessaging.InProductMessagingActor").Hc().Oc(function(){return new Kd(Gd.AFrameworkApplication.Ib,Gd.AFrameworkApplication.sa,L.resolve("Common.IInProductMessagingUIManager"))});L.register(sd,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").Hc().Oc(function(){return new sd});
L.register(ce,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").Hc().Oc(function(){return new ce});this.tb=L};he.prototype.init=function(){var L=this;this.tb.resolve("Common.App.InProductMessaging.InProductMessagingActor").Og();Gd.AFrameworkApplication.fa.hv(function(){Gd.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled&&Le.a.get_instance().Nk(15,function(){L.tb.kc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ma){L.tb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").U9h(Ma)})});
Gd.AFrameworkApplication.fa.ra("FreemiumUpsellShowDialogIsEnabled")&&Rd.a()&&!Ag.a.lB&&1!==Gd.AFrameworkApplication.sa.Qa.Sj&&L.tb.kc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ma){Ma.isFeatureEnabled("MsoPremiumBadge",!0).then(function(rb){!rb&&Ma.isFreemiumUpsellEnabled()&&L.tb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").ckf();return null})})})};he.prototype.dispose=function(){};he.main=function(){ef.a.instance.gj(new he)};Ck.Object.defineProperties(he.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.InProductMessaging"}}});Object(nd.a)(he,"InProductMessagingPackage",null,[4,5]);Id.prototype.M9c=function(L){var Ma=new Sys.StringBuilder(this.Vv.OIb);Ma.append("RoamingServiceHandler.ashx?action=");Ma.append("getFirstRunExperienceSettings");Ma.append("&");Ma.append(this.xfd(L));Ma.append("&");Ma.append(Gd.AFrameworkApplication.nj);Gd.AFrameworkApplication.Jd.gm(Ma.toString(),1,null,null,!0,2,Object(ob.a)(this,this.nKa,"getRequestSuccessCallback"),
Object(ob.a)(this,this.Cja,"getRequestFailureCallback"),null)};Id.prototype.qtb=function(L){var Ma=new Sys.StringBuilder(this.Vv.OIb);Ma.append("RoamingServiceHandler.ashx?action=");Ma.append("saveFirstRunExperienceSettings");Ma.append("&");Ma.append(Gd.AFrameworkApplication.nj);Ma=Ma.toString();L=If.c(L);Gd.AFrameworkApplication.Jd.gm(Ma,2,L,null,!0,4,Object(ob.a)(this,this.vYi,"postRequestSuccessCallback"),Object(ob.a)(this,this.K6,"postRequestFailureCallback"),null)};Id.prototype.nKa=function(L){var Ma=
!1,rb=null;try{if(0<L.data.ke.length){var ec=Object(Wb.a)(Object,If.a(L.data.ke)),fd=ec?ec[this.Vv.gWc]:null;fd&&(rb=Object(Wb.a)(Object,If.a(fd.toString())))}Ma=!0}catch(yd){this.Cja(null)}Ma&&this.zib&&this.zib(L.data,rb)};Id.prototype.Cja=function(L){this.vib&&this.vib(L?L.data:null)};Id.prototype.vYi=function(L){this.jde&&this.jde(L?L.data:null)};Id.prototype.K6=function(L){this.Fkb&&this.Fkb(L?L.data:null)};Id.prototype.xfd=function(L){for(var Ma=new Sys.StringBuilder("requestedsettings="),rb=
0;rb<L.count;rb++)Ma.append(L.oa(rb)),rb<L.count-1&&Ma.append(";");return Ma.toString()};Object(nd.a)(Id,"FirstRunExperienceRequestHandler",null,[]);$d.prototype.lRd=function(L){L?(this.Vv=L,this.qii()&&(dc.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),L=new Dg.a,L.add(this.Vv.gWc),this.wSb=new Id(this.Vv,Object(ob.a)(this,this.nKa,"getRequestSuccessCallback"),Object(ob.a)(this,this.Cja,"getRequestFailureCallback"),null,Object(ob.a)(this,
this.K6,"postRequestFailureCallback")),this.wSb.M9c(L)),(this.Vv.Y6a||Gd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.mRd()):dc.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")};$d.prototype.qii=function(){try{if(this.Vv.Y6a)return!0;if(!Gd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||Gd.AFrameworkApplication.fa.ra("IsAnonymousUser"))return!1;if(this.Vv.lfi||
this.Vv.a7a||Gd.AFrameworkApplication.fa.ra("IsO365ConsumerHost"))return!0;var L=Gd.AFrameworkApplication.fa.Va("FlightId");return-1!==(L?L.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Ma){dc.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Ma?Ma.toString():null)}return!1};$d.prototype.xUf=function(L){var Ma={},rb={};rb.FREDisplayedDate=(new Date).toUTCString();rb.VersionDisplayed=L;rb.RemindMeLater=!1;Ma[this.Vv.gWc]=If.c(rb);dc.ULS.sendTraceTag(51675533,306,50,
"Initiating call to save FRE data for current user from Roaming Settings Service");this.wSb&&this.wSb.qtb(Ma)};$d.prototype.nKa=function(L,Ma){L=L?+L.q3-+L.fF:-1;L>this.Vv.nTf?dc.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",L,this.Vv.nTf):Ma?this.Uwj(Ma)?(dc.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.Vv.wpf),this.mRd()):dc.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required."):(dc.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.mRd())};$d.prototype.Cja=function(L){dc.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",L?L.httpStatus:-1)};$d.prototype.K6=function(L){dc.ULS.sendTraceTag(51675542,306,10,
"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",L?L.httpStatus:-1)};$d.prototype.mRd=function(){var L=this,Ma=Hg.a.instance.Lh("Common.ISystemInitiatedFeedback");Ma?this.v2f(Ma):(dc.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),Gd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Ma=Hg.a.instance.kc("Common.ISystemInitiatedFeedback"))?Ma.execute(function(rb){L.v2f(rb)}):
dc.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))};$d.prototype.v2f=function(L){if(L){var Ma=this.Vv.VAh;Ma&&(Gd.AFrameworkApplication.ela(Ma),Gd.AFrameworkApplication.z_(Ma));dc.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Ma);L.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.mib=Object(ob.a)(this,this.EIi,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",
this.mib,!0),window.addEventListener("FRELaunchedEvent",this.mib,!0)):(dc.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.xUf(this.Vv.currentVersion))}else dc.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")};$d.prototype.EIi=function(L){if(L){var Ma=L.detail;L=L.type;var rb=this.Vv&&this.Vv.campaignId?this.Vv.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===L||rb&&Ma&&Ma.id&&-1!==Ma.id.indexOf(rb))Ma.success&&(dc.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.xUf(this.Vv.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.mib,!0),window.removeEventListener("FRELaunchedEvent",this.mib,!0))}};$d.prototype.Uwj=function(L){if("RemindMeLater"in L&&"FREDisplayedDate"in L){if("true"===L.RemindMeLater.toString()&&(+new Date-+new Date(L.FREDisplayedDate.toString()))/36E5>this.Vv.wpf)return!0}else if(Gd.AFrameworkApplication.fa.ra("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in L&&L.VersionDisplayed<this.Vv.currentVersion)return dc.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1};Object(nd.a)($d,"FirstRunExperienceLauncher",null,[835]);Ke.prototype.fi=function(L){this.tb=L;this.tb.register(835,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").Hc().Oc(function(){return new $d})};Ke.prototype.init=function(){};Ke.prototype.dispose=function(){};Ke.main=function(){ef.a.instance.gj(new Ke)};
Ck.Object.defineProperties(Ke.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.FirstRunExperienceLauncher"}}});Object(nd.a)(Ke,"FirstRunExperienceLauncherPackage",null,[4,5]);var kg=b(7),vg=b(229),gg=b(365),Bc=b(277),od=b(368),td=b(1),le=b(38),Ve=b(9),Pe=b(387),yf=b(14),Cg=Pe.a;Wl(Fe,Cg);Fe.prototype.FM=function(){var L={};L.id=this.Cc;var Ma=yf.a.instance.ga(2218);L.DialogMessage=Ma;return L};Ck.Object.defineProperties(Fe.prototype,{Cc:{configurable:!0,enumerable:!0,
get:function(){return"ClipboardReadPermissionAskDialog"}}});Object(nd.a)(Fe,"ClipboardReadPermissionAskDialog",Pe.a,[]);var hg=b(50);qf.prototype.acf=function(L){return L?this.sessionStateId===L.sessionStateId&&this.sessionId===L.sessionId:!1};qf.prototype.isFromCurrentSession=function(L){return this.sessionId===L.ya.UserSessionId};Object(nd.a)(qf,"SourceItem",null,[]);Wl(lf,qf);lf.prototype.isEqual=function(L){return L&&Object.getType(L)===lf?this.acf(L)&&this.activeFloatingObjectControlId===L.activeFloatingObjectControlId&&
this.sheetName===L.sheetName:!1};lf.prototype.toString=function(){return this.type.toString()};Object(nd.a)(lf,"ArtSourceItem",qf,[]);var Lf;(function(L){L[L.valid=0]="valid";L[L.notPairwiseDisjoint=1]="notPairwiseDisjoint";L[L.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";L[L.notValidForm=3]="notValidForm";L[L.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(Lf||(Lf={}));Object(nd.b)("CopySourceValidationOptions",Lf);var $e=b(45);Wl(wb,qf);wb.prototype.isEqual=
function(L){return L&&Object.getType(L)===wb?this.acf(L)&&$e.Q(this.ranges,L.ranges)&&this.sheetName===L.sheetName:!1};wb.prototype.toString=function(){return $e.i(this.ranges,",",this.$,!1)};Object(nd.a)(wb,"RangeSourceItem",qf,[]);rd.LSj="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(nd.a)(rd,"ExpectedErrorNames",null,[]);Ec.yW="text/plain";Ec.html="text/html";Ec.png="image/png";Ec.tO="data/shadow-workbook";Ec.Yhi="metadata/is-last-copy-was-external";Ec.xei="metadata/is-last-copy-was-external-XLO-source";
Ec.QWg="metadata/chrome-extension-id";Ec.Lqb="copyId";Ec.oHg="metadata/additional-signature-data-attributes";Object(nd.a)(Ec,"ClipboardDataFormat",null,[]);var lg=b(48),ae=b(22),se=b(33);md.prototype.QJa=function(){return md.RVi};md.prototype.VLh=function(){return this.R8b&&1===this.R8b.length?this.WLh(this.R8b[0]):null};md.prototype.WLh=function(L){var Ma=ae.g(this.$),rb=Ma.rb.qj(L),ec=Ma.tg(L,rb);Ma=Ma.rtl;if(!ec)return null;L=ae.g(this.$).Uf(rb);var fd=L.wn;if(!fd.Ed(ec))return null;ec=fd.Se(ec);
var yd=ec.topLeft.y,be=ec.bottomRight.y,xe=Ma?ec.bottomRight.x:ec.topLeft.x;ec=Ma?ec.topLeft.x:ec.bottomRight.x;var cf=new lg.a(ec+(Ma?-81:81),be+38+6);if(fd.nHa(cf))return this.T3a(L,fd,rb,ec,be,Ma?12:-3,66);cf=new lg.a(ec+(Ma?-81:81),be);if(fd.nHa(cf))return this.T3a(L,fd,rb,ec,be,Ma?20:3,22);cf=new lg.a(ec,be+38+6);if(fd.nHa(cf))return this.T3a(L,fd,rb,ec,be,-81+(Ma?18:0),66);ec=new lg.a(xe+(Ma?81:-81),be);if(fd.nHa(ec))return this.T3a(L,fd,rb,xe,be,-81+(Ma?12:-6),22);be=new lg.a(xe,yd-38-6);return fd.nHa(be)?
this.T3a(L,fd,rb,xe,yd,Ma?15:0,16):this.T3a(L,fd,rb,Ma?fd.topLeft.x:fd.bottomRight.x,fd.bottomRight.y,-81+(Ma?15:-6),22)};md.prototype.T3a=function(L,Ma,rb,ec,fd,yd,be){var xe=ae.g(this.$),cf=xe.rtl;L=Sys.UI.DomElement.getLocation(L.domElement);ec=new Sys.UI.Point(ec+(cf?0:L.x)-Ma.topLeft.x,fd+L.y-Ma.topLeft.y);cf&&(xe=xe.view.visibleArea,ec.x=xe.bottomRight.x-xe.topLeft.x-ec.x,2===rb||4===rb)&&(ec.x+=Ma.bottomRight.x);ec=se.a(this.$).Aja(ec);return new Sys.UI.Point(ec.x+yd,ec.y+be)};Ck.Object.defineProperties(md.prototype,
{nHg:{configurable:!0,enumerable:!0,get:function(){return this.Cjg}},cqi:{configurable:!0,enumerable:!0,get:function(){return this.jrg}},p5i:{configurable:!0,enumerable:!0,get:function(){return this.Ttg}},Iwh:{configurable:!0,enumerable:!0,get:function(){return this.tng}}});md.RVi=["PasteRecoveryUI"];Object(nd.a)(md,"PasteRecoveryUI",null,[922]);var Wh=b(79),zf=b(326);Mc.gzg="ActiveSelection";Mc.tO="ShadowWorkbook";Mc.Nhg="GVML";Mc.yW="PlainText";Mc.html="Html";Mc.zNg="Bitmap";Object(nd.a)(Mc,"PayloadType",
null,[]);Sb.yAj="Slice4";Sb.zAj="Slice5";Sb.AAj="Slice6";Object(nd.a)(Sb,"SliceName",null,[]);Cd.fCi="NotCalled";Cd.success="Success";Cd.failed="Failed";Object(nd.a)(Cd,"SucceededPopulatingSystemClipboardOptions",null,[]);var fh=b(373),ya;(function(L){L[L.valid=0]="valid";L[L.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";L[L.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";L[L.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";
L[L.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";L[L.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";L[L.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";L[L.copySourceNotValid=7]="copySourceNotValid";L[L.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";L[L.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";
L[L.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";L[L.unknown=100]="unknown"})(ya||(ya={}));Object(nd.b)("PasteValidationOptions",ya);var Ob=b(51),Lc=b(36),Ad=b(151),Pd=b(37),He=b(159),Me=b(356),Se=b(30),Ff=b(328),Oe=b(10),Na=b(21),kb=b(105),ic=b(126),Rc=b(112),dd=b(625),Od=b(99),me=b(258),Ie=le.a;Wl(Hc,Ie);Hc.prototype.EFg=function(L){this.addHandler(Hc.mBd,L)};Hc.prototype.Caj=function(L){this.removeHandler(Hc.mBd,L)};Hc.prototype.copy=function(L){var Ma=this;L.stopwatch=this.$.Pb.Gc("UserAction",
hg.b().ri(L.ribbonCommandInfo.command)+"ClientSide");if(this.xo){var rb=Ob.GetServiceTaskFactory.Xa(this.$.da,478,479,0);Pd.TaskExtensions.Ba(rb,function(){Ma.pasteShortcutManager=rb.result},this.la,3)}var ec=!!wc(this.rK);td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Ag.a.RC&&(this.N6a=!1);this.Qr("Copy/before/"+gg.a[L.ribbonCommandInfo.method],!1,void 0,!0,L.copyPasteTargetType).catch(function(){});var fd=-1985798686===L.ribbonCommandInfo.command;
if(1===this.gridView.We&&(fd=this.Vp.sbf(this.gridView.ha.ta.selectedRanges,fd),0!==fd)){var yd=Hc.c2g(fd);this.Yya(yd,Lf[fd],!1);return Promise.reject(!1)}L.userHash=this.userHash;L.id=Lg.a.create().toString();var be=this,xe=this;return this.T3b.onCopy(L).then(function(cf){cf.isAsyncCopy||L.stopwatch.stop();be.pasteIndicationManager.OIe();dc.ULS.sendTraceTag(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. {0}",fh.d(L));be.Lsi(cf,ec);!L.isFormatPainter&&be.xo&&
(be.pasteShortcutManager?be.pasteShortcutManager.Cjh():dc.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},function(cf){var ze=!1,Yf="none",Sg=Hc.Qrb,eg=!0,Pg=-1,Vh=Hc.copyErrorName+Hc.IIa,fe=!1,af=null;if(cf){af=cf.copyContext;Pg=cf.reason;Vh+=Hc.ZJa(cf);cf.message&&(Sg=cf.message);var zh=Hc.b2g(cf);if(zh)if(3===zh.copyErrorName)ze=!0,Sg=Yf="Async Copy canceled by the user.",eg=!1;else if(Se.a.mr(zh.ewaErrors))if(Sg=xe.Oac(zh.ewaErrors),Se.a.nh(zh.ewaErrors,
Hc.operationSucceededWithAlert))fe=ze=!0;else if(Se.a.nh(zh.ewaErrors,Hc.pasteDataLimitHit)||Se.a.nh(zh.ewaErrors,Hc.copyThrottlingError))ze=!0;13===cf.reason?(ze=!0,eg=!1):11===cf.reason&&(eg=!1)}ze?dc.ULS.sendTraceTag(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: {0}, Friendly message: {1}, Error Message: {2}, CommandParameters: {3}",eg,Yf,cf?xe.getStringifiedError(cf):"null",fh.d(L)):dc.ULS.sendTraceTag(24150912,0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: {0}, Error Message: {1}, CommandParameters: {2}",
eg,cf?xe.getStringifiedError(cf):"null",fh.d(L));eg&&xe.Qr("Copy/fail/"+gg.a[L.ribbonCommandInfo.method],!0,void 0,void 0,L.copyPasteTargetType).catch(function(){});xe.Ksi(L,ze,Sg,Vh,Pg,fe,af);return Promise.reject(cf)})};Hc.prototype.paste=function(L){var Ma=this;L.stopwatch=this.$.Pb.Gc("UserAction",hg.b().ri(L.ribbonCommandInfo.command)+"ClientSide");td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Ag.a.RC&&(dc.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),
this.N6a=!1,L.clipboardPicklingApiDataFormatsToRead=[Ec.tO]);ae.g(this.$).Ii&&ae.g(this.$).Ii.I7(this.cfd(L.ribbonCommandInfo.command),L.stopwatch.id);if(L.isPasteCommandFromRecoveryUI){var rb=this.$.da.za(406);var ec=Bc.a.clone(rb.Urd);rb=rb.Jrd;L.pasteRecoveryCachedClipboardItems=rb?rb[Hc.kFf]:null}else ec=Bc.a.clone(this.gridView.ha.ta.selectedRanges);L.originalDestinations=ec;L.expandDestinations=this.iZc(L.originalDestinations,L.commandType);if(this.uZc(L.commandType,L.expandDestinations)||this.NTg())return L.userHash=
this.userHash,L.id=Lg.a.create().toString(),td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!Ag.a.RC&&(L.clipboardReadPermissionPromptShown=!1,L.clipboardAsyncApiDataFormatsToRead=[Ec.yW+"Async"],this.T3b.shouldShowClipboardReadPermissionDialog().then(function(fd){fd&&(L.clipboardReadPermissionPromptShown=!0,new Fe(Ma.$));return Promise.resolve(!0)},function(){return Promise.resolve(!0)})),this.T3b.onPaste(L).then(function(fd){return Ma.Rnc(fd,L)},
function(fd){return Ma.EEb(L,fd)});this.$.Ud(927125067,Wh.a.Sb,30,null);dc.ULS.sendTraceTag(24150913,0,15,'CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: {0}, CommandType: {1}, copyPasteTargetType="{2}"',$e.i(L.expandDestinations,",",this.$,!1),L.commandType,L.copyPasteTargetType);return Promise.resolve(!0)};Hc.prototype.cfd=function(L){if(td.EwaSettings.isChangeGateEnabled("OfficeVSO:4313497_PasteOptionPerfTelemetry"))switch(L){case 1804571062:return 6;
case -185374993:return 7;case 1766348718:return 8}return 3};Hc.prototype.NTg=function(){return!!ae.g(this.$).ha.Oa.activeFloatingObjectControlId&&this.$.Aq(null,!1,470)};Hc.prototype.bBb=function(){var L=wc(this.rK);return L&&L.commandParameters?L.commandParameters.copyPasteTargetType:0};Hc.prototype.Xhi=function(){return!!wc(this.rK)&&Xc(wc(this.rK),this.$)};Hc.prototype.Qr=function(L,Ma,rb,ec,fd){var yd=this;rb=void 0===rb?!1:rb;ec=void 0===ec?!1:ec;fd=void 0===fd?0:fd;try{this.xo&&this.pasteShortcutManager&&
this.pasteShortcutManager.u6b();var be=fd,xe=this.Soi();if(!ec&&2===xe)return dc.ULS.sendTraceTag(537167821,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Ma,rb,ec,fd,xe),Promise.reject(null);0===be&&(be=xe);var cf=this.$.Pb.Gc("UserAction","ClearCopyState"),ze=cf.id;dc.ULS.sendTraceTag(537167820,
0,50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Ma,rb,ec,fd,xe);this.Vp.cxb();this.C2i();return this.T3b.onCancelCopy(Ma).then(function(){Ma&&td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Ag.a.RC&&(yd.N6a=!1);cf.stop();yd.Tkf(L,ze,!0,rb,Ma,"","",cf.Bc,be);return Promise.resolve(!0)},
function(Yf){dc.ULS.sendTraceTag(24150915,0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: {0}",Yf?yd.getStringifiedError(Yf):"null");cf.stop();var Sg=Hc.bUg+Hc.IIa,eg=Hc.Qrb;Yf&&(Sg+=Hc.ZJa(Yf),Yf.message&&(eg=Yf.message));yd.Tkf(L,ze,!1,rb,Ma,eg,Sg,cf.Bc,be);return Promise.reject(Yf)})}catch(Yf){return Promise.reject(null)}};Hc.prototype.r2b=function(L,Ma,rb,ec,fd){rb=void 0===rb?!1:rb;ec=void 0===ec?!1:ec;fd=void 0===fd?0:fd;return ec||!td.EwaSettings.ma(657)||
this.Fgh()?this.Qr(L,Ma,rb,ec,fd):(dc.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))};Hc.prototype.Yya=function(L,Ma,rb){dc.ULS.sendTraceTag(590705172,0,50,"CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: {0}",Ma);var ec=new Od.a;ec.ia("reason",Ma);dd.a(ic.a.discontinuousSelectionBlocking,
[rb?Rc.a.LVi:Rc.a.T2g],!0,!0,!1,!1,ec);L=Se.a.gd(1,1,753,L,0,371863010,"DiscontinuousSelectionBlocking");td.EwaSettings.Az()?new Me.a(this.$,L):(L=new He.ErrorDialog(this.$,L),L.initialize(),L.Af())};Hc.prototype.Soi=function(){var L=wc(this.rK);return L&&L.sourceItem?Object.getType(L.sourceItem)===lf?2:1:0};Hc.prototype.dragDropCells=function(L,Ma,rb,ec,fd){var yd=this;fd=void 0===fd?!1:fd;L.stopwatch=this.$.Pb.Gc("UserAction","DragDropClientSide");this.Qr("DragDrop/before/"+gg.a[L.ribbonCommandInfo.method],
!1,void 0,void 0,L.copyPasteTargetType).catch(function(){});var be=fd?2:1,xe=0;xe=fd?4:ec?256:128;var cf={encounteredDeploymentErrors:!1};cf.commandParameters=L;L.userHash=this.userHash;L.id=Lg.a.create().toString();return this.zqd?this.Vp.pasteRange(L.ribbonCommandInfo,$e.q(Ma,this.$),$e.q(rb,this.$),be,xe,[L.stopwatch],cf,!1,function(){dc.ULS.sendTraceTag(537167818,0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',L.copyPasteTargetType);yd.R7a(L,be,Ma,rb,cf)},function(ze){dc.ULS.sendTraceTag(537167817,
0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',ze?yd.getStringifiedError(ze):"null",L.copyPasteTargetType);yd.m9a(ze,L,be,Ma,rb,cf)}).then(function(){yd.gridView.ha.selectionType=-1;return Promise.resolve(!0)},function(ze){return Promise.reject(ze)}):this.Vp.pasteRange(L.ribbonCommandInfo,$e.q(Ma,this.$),$e.q(rb,this.$),be,xe,[L.stopwatch],cf,!1,null,null).then(function(){dc.ULS.sendTraceTag(521410075,0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',
L.copyPasteTargetType);yd.gridView.ha.selectionType=-1;yd.R7a(L,be,Ma,rb,cf);return Promise.resolve(!0)},function(ze){dc.ULS.sendTraceTag(521410074,0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',ze?yd.getStringifiedError(ze):"null",L.copyPasteTargetType);yd.m9a(ze,L,be,Ma,rb,cf);return Promise.reject(ze)})};Hc.prototype.ahh=function(L,Ma,rb,ec,fd){var yd=this;fd=void 0===fd?!1:fd;L.stopwatch=this.$.Pb.Gc("UserAction","DragDropReplaceClientSide");this.r2b("DragDropReplace/before/"+
gg.a[L.ribbonCommandInfo.method],!1,void 0,void 0,L.copyPasteTargetType).catch(function(){});var be=fd?2:1,xe=0;xe=fd?4:ec?256:128;var cf={encounteredDeploymentErrors:!1};cf.commandParameters=L;td.EwaSettings.getBooleanFeatureGate(zf.a.c7b,!1)&&(L.isDragInsert=!1);L.userHash=this.userHash;L.id=Lg.a.create().toString();return this.zqd?this.Vp.pasteRange(L.ribbonCommandInfo,$e.q(Ma,this.$),$e.q(rb,this.$),be,xe,[L.stopwatch],cf,!1,function(){dc.ULS.sendTraceTag(537167816,0,50,'CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="{0}"',
L.copyPasteTargetType);yd.R7a(L,be,Ma,rb,cf)},function(ze){dc.ULS.sendTraceTag(537167815,0,10,'CopyPasteInfrastructure.DragDropReplaceCells: {0}, copyPasteTargetType="{1}"',ze?yd.getStringifiedError(ze):"null",L.copyPasteTargetType);return yd.m9a(ze,L,be,Ma,rb,cf)}).then(function(){yd.gridView.ha.selectionType=-1;return Promise.resolve(!0)},function(ze){return Promise.reject(ze)}):this.Vp.pasteRange(L.ribbonCommandInfo,$e.q(Ma,this.$),$e.q(rb,this.$),be,xe,[L.stopwatch],cf,!1,null,null).then(function(){dc.ULS.sendTraceTag(521410073,
0,50,'CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="{0}"',L.copyPasteTargetType);yd.gridView.ha.selectionType=-1;yd.R7a(L,be,Ma,rb,cf);return Promise.resolve(!0)},function(ze){dc.ULS.sendTraceTag(521410072,0,10,'CopyPasteInfrastructure.DragDropReplaceCells: {0}, copyPasteTargetType="{1}"',ze?yd.getStringifiedError(ze):"null",L.copyPasteTargetType);yd.m9a(ze,L,be,Ma,rb,cf);return Promise.reject(ze)})};Hc.prototype.$gh=function(L,Ma,rb,ec,fd){var yd=this;fd=void 0===fd?
!1:fd;L.stopwatch=this.$.Pb.Gc("UserAction","DragDropInsertClientSide");this.r2b("DragDropInsert/before/"+gg.a[L.ribbonCommandInfo.method],!1,void 0,void 0,L.copyPasteTargetType).catch(function(){});var be=fd?2:1,xe=$e.K(this.iZc([rb],be)),cf=this.$.ea.qa.sheetName,ze=this.$.ea.qa.sheetName,Yf=$e.v(Ma,this.$);Yf.SheetName=cf;cf=$e.v(xe,this.$);cf.SheetName=ze;ec=xe.isRow||Ma.isRow||ec?1:0;var Sg={encounteredDeploymentErrors:!1};L.isDragInsert=!0;Sg.commandParameters=L;L.userHash=this.userHash;L.id=
Lg.a.create().toString();if(this.zqd)return fd=this.Vp.WIe(Sg,Yf,cf,fd,ec,L.ribbonCommandInfo,function(){dc.ULS.sendTraceTag(537167814,0,50,'CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="{0}"',L.copyPasteTargetType);yd.R7a(L,be,Ma,rb,Sg)},function(Pg){dc.ULS.sendTraceTag(537167813,0,10,'CopyPasteInfrastructure.DragDropInsertCells: {0}, copyPasteTargetType="{1}"',Pg?yd.getStringifiedError(Pg):"null",L.copyPasteTargetType);yd.m9a(Pg,L,be,Ma,rb,Sg)}),me.c(fd.then(function(){yd.gridView.ha.selectionType=
-1;return Promise.resolve(!0)},function(Pg){return Promise.reject(Pg)})).CWR(function(){return!0});fd=this.Vp.WIe(Sg,Yf,cf,fd,ec,L.ribbonCommandInfo,null,null);var eg=this;return me.c(fd.then(function(){dc.ULS.sendTraceTag(521410071,0,50,'CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="{0}"',L.copyPasteTargetType);yd.gridView.ha.selectionType=-1;yd.R7a(L,be,Ma,rb,Sg);return Promise.resolve(!0)},function(Pg){dc.ULS.sendTraceTag(521410070,0,10,'CopyPasteInfrastructure.DragDropInsertCells: {0}, copyPasteTargetType="{1}"',
Pg?eg.getStringifiedError(Pg):"null",L.copyPasteTargetType);eg.m9a(Pg,L,be,Ma,rb,Sg);return Promise.reject(Pg)})).CWR(function(){return!0})};Hc.prototype.Aai=function(L,Ma){var rb=this,ec=wc(this.rK);if(!ec)return dc.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),qb.Task.Sa(!1);if(!Dd(ec.sourceItem))return dc.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),qb.Task.Sa(!1);var fd=ec.sourceItem;if(!fd)return dc.ULS.shipAssertTag(537167810,
0,!!fd,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),qb.Task.Sa(!1);if(!fd.isFromCurrentSession(this.$))return dc.ULS.sendTraceTag(537167809,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),qb.Task.Sa(!1);if(1<fd.ranges.length)return dc.ULS.sendTraceTag(537167808,0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.Yya(2155,"InsertCopiedCutCells",!0),qb.Task.Sa(!1);ec=$e.K(fd.ranges);var yd=this.gridView.ha.ta.qd.clone();L=$e.K(this.iZc([yd],
L));var be=this.Jif();fd=fd.sheetName;yd=this.$.ea.qa.sheetName;var xe=$e.v(ec,this.$);xe.SheetName=fd;var cf=$e.v(L,this.$);cf.SheetName=yd;return(L.hf||ec.hf?qb.Task.Sa(0):L.isRow||ec.isRow?qb.Task.Sa(1):this.Bai.i4b(this.$,ae.g(this.$).rtl)).CWR(function(ze){return rb.Vp.executeInsertCopiedCutCellsOperation(xe,cf,be,ze.result,Ma)}).continueWith(function(){be?rb.Vp.cxb():rb.Qr("InsertCopiedCutCells/success/"+gg.a[Ma.method],!0)})};Hc.prototype.qod=function(){var L=wc(this.rK),Ma=this.gridView.ha.ta.Hg;
return!!L&&Dd(L.sourceItem)&&Ma&&1===L.sourceItem.ranges.length};Hc.prototype.Jif=function(){return this.Kif(-911352779)};Hc.prototype.cjc=function(){return this.Kif(-1985798686)};Hc.prototype.uZc=function(L,Ma){var rb=new Ad.a(this.$.xa),ec=36===L,fd=rb.me(4);L=2===this.bBb()&&rb.me(1);ec=ec&&fd;rb=!rb.tj||!this.cjc()||!Ad.a.R6b(Ma,ae.g(this.$));return ec||L||this.$.Aq(Ma,!0)&&rb};Hc.prototype.jgc=function(L,Ma){return this.Vp.jgc(L,Ma)};Hc.prototype.dispose=function(){Ie.prototype.dispose.call(this);
this.al();this.rK.removeMetadataChangeListener(Hc.mpf)};Hc.prototype.v6c=function(L,Ma,rb,ec,fd,yd){if(!this.dYg(L.commandParameters.ribbonCommandInfo.command))return L.cseStatus=2,!1;if(yd&&Ma.Ed(ec))return L.cseStatus=4,!1;if(rb!==fd)return L.cseStatus=6,!1;if(td.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests")&&(ec.width%Ma.width||ec.height%Ma.height))return L.cseStatus=16,!1;if(td.EwaSettings.getBooleanFeatureGate(zf.a.JEe,!1)){if(rb=Ma,ec=ec.Se(this.gridView.Gh),Ma=
null===Ma.Se(this.gridView.Gh),fd=L.commandParameters.ribbonCommandInfo.command,Ma&&1804571062!==fd&&-185374993!==fd||!ec)return L.cseStatus=7,!1}else if(rb=Ma.Se(this.gridView.Gh),ec=ec.Se(this.gridView.Gh),!rb||!ec)return L.cseStatus=7,!1;Ma=$e.v(rb,this.$);Ma=this.Sg.PVi(this.gridView,Ma,$e.v(ec,this.$),L.commandParameters.ribbonCommandInfo.command,L.commandParameters.stopwatch);1===Ma&&(yd&&(this.Sg.h0c(rb,!1),this.Sg.h0c(rb,!0)),-185374993===L.commandParameters.ribbonCommandInfo.command&&ae.g(this.$).n2i(),
this.pasteIndicationManager.hjd(L.commandParameters.id),this.Vuc(L.commandParameters.expandDestinations,L.commandParameters.isPasteCommandFromRecoveryUI),this.lye("DoPasteClientEstimation/"+gg.a[L.commandParameters.ribbonCommandInfo.method],L));L.cseStatus=Ma;return 1===Ma};Hc.prototype.vGf=function(){this.copyPasteShortcutDialogFactory.create(this.$).showDialog(!0,!1,!1,this.Hui)};Hc.prototype.Dlf=function(L,Ma,rb,ec){L=Cf(L,Ma,rb,ec,this.$.ya.UserSessionId);L.k=!0;hg.b().Pe(45,L,!0)};Hc.prototype.rAf=
function(L,Ma,rb,ec,fd){var yd=!1,be=!1,xe=Hc.Qrb,cf=Hc.SIe+Hc.IIa;L&&(cf+=Hc.ZJa(L),Se.a.mr(L.ewaErrors)?(xe=this.Oac(L.ewaErrors),Se.a.nh(L.ewaErrors,[-103190598])&&(yd=!0)):L.message&&(xe=L.message));be||(be=this.Jnd(L));Ma=Cf(Ma,rb,ec,fd,this.$.ya.UserSessionId);Ma.k=!1;Ma.l=be;Ma.n=xe;Ma.p=cf;Ma.q=yd;hg.b().Pe(45,Ma,!0);return Promise.reject(L)};Hc.prototype.dYg=function(L){switch(L){case 237279923:case 808159687:return zf.a.eji;case -185374993:return!0;case 1804571062:return!0;default:return!1}};
Hc.prototype.Kif=function(L){var Ma=wc(this.rK);if(!Ma)return!1;var rb=Ma.sourceItem;return rb&&!rb.isFromCurrentSession(this.$)?(dc.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1):Ma.commandParameters.ribbonCommandInfo.command===L};Hc.prototype.Fgh=function(){var L=wc(this.rK);return L?(L=L.sourceItem)&&!L.isFromCurrentSession(this.$)?(dc.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),
!1):!0:!1};Hc.prototype.muj=function(L){return L&&L.lastCopy?Xc(L.lastCopy,this.$):!0};Hc.prototype.WXe=function(L,Ma,rb,ec,fd){var yd={};yd.a=this.$.ya.UserSessionId;yd.e=L.stopwatch.id;yd.c=hg.b().ri(L.ribbonCommandInfo.command);yd.b=gg.a[L.ribbonCommandInfo.method];yd.d=L.id;yd.f=rb.toString();yd.g=ec.toString();yd.h=Ma.toString();yd.o=L.stopwatch.Bc;yd.q=!1;yd.r=L.copyPasteTargetType.toString();yd.s=fd.encounteredDeploymentErrors;td.EwaSettings.getBooleanFeatureGate(zf.a.c7b,!1)&&(yd.i=fd.commandParameters.dragDropIsShiftKeyDown,
yd.j=fd.commandParameters.isDragInsert);return yd};Hc.prototype.R7a=function(L,Ma,rb,ec,fd){L=this.WXe(L,Ma,rb,ec,fd);L.k=!0;hg.b().Pe(45,L,!0)};Hc.prototype.Ssi=function(L,Ma,rb,ec,fd,yd,be,xe,cf){L=this.WXe(L,Ma,rb,ec,cf);L.k=!1;L.l=fd;L.n=yd;L.p=be;L.q=xe;hg.b().Pe(45,L,!0)};Hc.prototype.Tkf=function(L,Ma,rb,ec,fd,yd,be,xe,cf){var ze={};ze.a=this.$.ya.UserSessionId;ze.b=Ma;ze.c=L;ze.f=rb;ze.e=ec;ze.d=fd;ze.g=yd;ze.h=be;ze.i=xe;ze.j=cf.toString();hg.b().Pe(46,ze,!0)};Hc.prototype.Lsi=function(L,
Ma){L=this.tXe(L.commandParameters,L);L.l=!0;L.j=Ma;hg.b().Pe(43,L,!0)};Hc.prototype.Ksi=function(L,Ma,rb,ec,fd,yd,be){L=this.tXe(L,be);L.l=!1;L.m=Ma;L.o=rb;L.y=ec;L.x=fd;L.z=yd;hg.b().Pe(43,L,!0);dc.ULS.sendTraceTag(537167776,0,15,"CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",L.y,L.x,L.m,L.z,L.o)};Hc.prototype.tXe=function(L,Ma){var rb={};rb.a=this.$.ya.UserSessionId;rb.f=L.stopwatch.id;rb.g=L.id;rb.c=
hg.b().ri(L.ribbonCommandInfo.command);rb.b=gg.a[L.ribbonCommandInfo.method];rb.q=L.stopwatch.Bc;rb.bd=Hc.X$b();rb.bg=L.copyPasteHandlerName;rb.bj=void 0===L.ribbonCommandInfo.Ze||null===L.ribbonCommandInfo.Ze?null:od.a[L.ribbonCommandInfo.Ze];rb.bq=L.uploadToClipService;rb.br=L.floatingObjectType;rb.s=L.copyPasteTargetType.toString();rb.bc=Md(L.copyPasteTargetType);rb.z=!1;if(Ma){rb.bk=Ma.id;rb.bl=Ma.serverRequestTimeInMs;Ma.requestTelemetryData&&(rb.bm=Ma.requestTelemetryData.EcsOperationDuration,
rb.bn=Ma.requestTelemetryData.EcsRequestDuration,rb.bo=Ma.requestTelemetryData.WfeRequestDuration);rb.d=Ma.sourceItem?Ma.sourceItem.toString():null;rb.e=-1;if(Dd(Ma.sourceItem)){rb.e=0;L=Gl(Ma.sourceItem.ranges);for(var ec=L.next();!ec.done;ec=L.next())rb.e+=ec.value.eM}rb.h=Ma.isAsyncCopy;rb.i=Ma.isFromCache;rb.k=Ma.isSelectionAllowed;rb.r=Ma.plainTextPayloadSize;rb.u=Ma.htmlPayloadSize;rb.v=Ma.htmlSizeExceedsLimit;rb.w=Ma.copyTotalSizeExceedsLimit;rb.t=Ma.shadowWorkbookPayloadSize;rb.p=Ma.clientSideCopyTime;
rb.ba=Ma.encounteredDeploymentErrors;rb.bb=Ma.shadowWorkbookSizeExceedsLimit;rb.be=Ma.syncClipboardItemsKeys;rb.bf=Ma.asyncClipboardItemsKeys;rb.bh=this.BBe(Ma.succeededPopulatingSystemClipboardSync);rb.bi=this.BBe(Ma.succeededPopulatingSystemClipboardAsync)}return rb};Hc.prototype.Vuc=function(L,Ma){Ma=void 0===Ma?!1:Ma;if(!this.gridView.isEditing&&!this.gridView.Li){var rb=this.gridView.ha.ta,ec=!Ma&&1===L.length&&$e.Q(L,rb.selectedRanges),fd=ec?rb.activeCell:L[0].topLeft;L[0].contains(fd)||(dc.ULS.shipAssertTag(537167775,
0,!1,"CopyPasteInfrastructure.SelectPastedRange: SelectedRanges {0}, IndexOfActiveRange {1}, ActiveCell {2}, calculatedDestinationRanges {3}, keepThePreviousActiveCell {4}, newActiveCell {5}, isPasteCommandFromRecoveryUI {6}",rb.selectedRanges,rb.nt,rb.activeCell,L,ec,fd,Ma),fd=L[0].topLeft);this.gridView.ha.GB(L,0,fd,0,void 0,kb.a.Y2g)}};Hc.prototype.g0e=function(L,Ma){var rb={};rb.a=this.$.ya.UserSessionId;rb.g=L.stopwatch.id;rb.t=L.stopwatch.Bc;rb.bz=!1;Ma&&(rb.bv=Ma.id,rb.bw=Ma.serverRequestTimeInMs,
rb.n=Ma.commandParameters.clipboardFormatReadTimes,rb.o=Ma.commandParameters.clipboardFormatReadStatus,rb.p=Ma.commandParameters.clipboardReadPermissionPromptShown,rb.q=Ma.commandParameters.asyncApiReadTimedOut,Ma.requestTelemetryData&&(rb.cb=Ma.requestTelemetryData.EcsOperationDuration,rb.cc=Ma.requestTelemetryData.EcsRequestDuration,rb.cd=Ma.requestTelemetryData.WfeRequestDuration));rb.x=L.copyPasteTargetType.toString();rb.bl=Md(L.copyPasteTargetType);rb.br=L.copyPasteHandlerName;rb.i=$e.i(L.expandDestinations,
",",this.$,!1);rb.h=$e.i(L.originalDestinations,",",this.$,!1);rb.e=L.id;rb.d=L.commandType;rb.c=hg.b().ri(L.ribbonCommandInfo.command);rb.b=gg.a[L.ribbonCommandInfo.method];rb.bf=!1;rb.bg=!1;rb.bp=Hc.X$b();rb.bt=void 0===L.ribbonCommandInfo.Ze||null===L.ribbonCommandInfo.Ze?null:od.a[L.ribbonCommandInfo.Ze];rb.cj=L.isPasteCommandFromEnterShortcut;if(rb.ca=L.isPasteCommandFromRecoveryUI)rb.cf=L.pasteRecoveryUndoStopwatch.id,rb.cg=L.pasteRecoveryUndoStopwatch.Bc;if(Ma){if((L=Ma.copyContextSnapshot)&&
!Ma.wasLastCopyExternal){rb.f=L.commandParameters.id;rb.j=L.sourceItem.toString();rb.k=-1;if(Dd(L.sourceItem)){rb.k=0;for(var ec=Gl(L.sourceItem.ranges),fd=ec.next();!fd.done;fd=ec.next())rb.k+=fd.value.eM}rb.bg=1===L.commandParameters.commandType}else Ma.clipboardItems?rb.f=Ma.clipboardItems.getItem(Ec.Lqb):dc.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");rb.bz=Ma.pasteRecoveryUIDisplayed;rb.ci=Ma.cseStatus}else dc.ULS.sendTraceTag(537167773,
0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return rb};Hc.prototype.Yti=function(L,Ma,rb,ec,fd,yd,be,xe,cf){L=this.g0e(L,xe);L.l=!1;L.m=Ma;L.s=rb;L.bc=ec;L.be=fd;L.bd=yd;L.bf=be;xe?(L.y=pe(xe)||!xe.copyContextSnapshot,L.bi=!L.y&&Xc(xe.copyContextSnapshot,this.$),L.bj=xe.shadowWorkbookSizeExceedsLimit,L.v=xe.shadowWorkbookPayloadSize,L.w=xe.htmlPayloadSize,L.bq=Tc(xe.clipboardItems),L.bb=xe.activeSelectionType,L.bs=xe.isSameSession,L.bn=xe.payloadOrigin,L.bo=xe.payloadType,
L.bu=xe.externalAppSource,L.bx=xe.indicationDisplayScheduled,L.by=xe.pasteIndicationDisplayStatus,L.ck=xe.pasteDestinationHasMergedCells):L.bi=Xc(cf,this.$);hg.b().Pe(44,L,!0);dc.ULS.sendTraceTag(537167772,0,15,"CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",L.be,L.bd,L.m,L.bf,L.s)};Hc.prototype.Zti=function(L){var Ma=this.g0e(L.commandParameters,L);Ma.y=L.wasLastCopyExternal;Ma.l=!0;Ma.u=L.plainTextPayloadSize;
Ma.v=L.shadowWorkbookPayloadSize;Ma.w=L.htmlPayloadSize;Ma.z=L.isClipboardDataContainShadowWorkbook;Ma.ba=L.isShadowWorkbookParsedSuccessfully;Ma.bb=L.activeSelectionType;Ma.bc=L.pasteResult;Ma.bh=L.encounteredDeploymentErrors;Ma.bj=L.shadowWorkbookSizeExceedsLimit;Ma.bk=ed(L);Ma.bq=Tc(L.clipboardItems);Ma.bs=L.isSameSession;Ma.bn=L.payloadOrigin;Ma.bo=L.payloadType;Ma.bu=L.externalAppSource;Ma.bx=L.indicationDisplayScheduled;Ma.by=L.pasteIndicationDisplayStatus;Ma.ck=L.pasteDestinationHasMergedCells;
Ma.bm=L.clipboardItems?L.clipboardItems.getItem(Ec.QWg):null;Ma.bi=!L.isSameSession&&!L.wasLastCopyExternal;hg.b().Pe(44,Ma,!0)};Hc.prototype.Ej=function(){this.$.xa.og(this.Th);this.$.xa.Nme(this.rnc);this.$.userOperationManager.xq(this.ER);this.$.dl(this.vd);ae.g(this.$).pc.ql(this.SEb)};Hc.prototype.al=function(){this.$&&this.$.xa&&(this.$.xa.Wg(this.Th),this.$.xa.rPf(this.rnc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.Ul(this.ER);this.gridView&&this.gridView.pc&&this.gridView.pc.kl(this.SEb)};
Hc.prototype.EEb=function(L,Ma){var rb=null,ec=!1,fd=null,yd="UnknownFailure",be=-1,xe=Hc.Qrb,cf=Hc.pasteErrorName+Hc.IIa,ze=!1;this.pasteIndicationManager.hjd(L.id);this.Rdf&&this.pasteDestinationHasMergedCells(L.expandDestinations)&&(Ma.pasteContext.pasteDestinationHasMergedCells=!0);var Yf=wc(this.rK);(L.clearStateOnFinish||L.clearSystemClipboard)&&this.Qr("Paste/fail/"+gg.a[L.ribbonCommandInfo.method],!0,void 0,void 0,L.copyPasteTargetType).catch(function(){});if(Ma){be=Ma.reason;cf+=Hc.ZJa(Ma);
Ma.message&&(xe=Ma.message);if(rb=Hc.o2g(Ma))if(1===rb.pasteErrorName)ec=!0,yd="CopyPasteLengthTooLongPopup",xe=fd="The pasted content is too long. Popup a dialog to the user.",dc.ULS.sendTraceTag(25216992,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',fd,L.copyPasteTargetType),rb=Se.a.gd(1,0,26,692,0,1306609195,"CopyPasteOversizeError"),td.EwaSettings.Az()?new Me.a(this.$,rb):(rb=new He.ErrorDialog(this.$,rb),rb.initialize(),rb.Af());else if(7===rb.pasteErrorName)ec=
!0,yd="No-Op",xe=fd="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",dc.ULS.sendTraceTag(33948251,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',fd,L.copyPasteTargetType);else if(8===rb.pasteErrorName)ec=!0,yd="UseShortcutsPopup",xe=fd="Unable to paste content from the system clipboard. Popup dialog to the user.",dc.ULS.sendTraceTag(25216994,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',
fd,L.copyPasteTargetType),this.vGf();else if(18===rb.pasteErrorName){ec=!0;yd="PasteExternalNotSupportMultipleSelectionPopup";xe="Paste external not support multiple selection.";fd="Unknown";var Sg=2155;100!==rb.validationFailureReason&&(fd=ya[rb.validationFailureReason],Sg=Hc.uBe(rb.validationFailureReason));this.Yya(Sg,fd,!0)}else 20===rb.pasteErrorName||19===rb.pasteErrorName?(ec=!0,20===rb.pasteErrorName?(yd="PasteAcrossSessionNotSupportMultipleSelectionPopup",xe="Paste across session does not support multiple selection."):
(yd="PasteInSameSessionNotSupportMultipleSelectionPopup",xe="This kind of multiple selection is not supported for same session paste."),fd="Unknown",Sg=2155,100!==rb.validationFailureReason&&(fd=ya[rb.validationFailureReason],Sg=Hc.uBe(rb.validationFailureReason)),rb=6===rb.validationFailureReason,this.uZc(L.commandType,L.expandDestinations)&&rb&&this.Vuc(L.expandDestinations),this.Yya(Sg,fd,!0)):6===rb.pasteErrorName?(ec=!0,yd="No-Op",xe=fd="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",
dc.ULS.sendTraceTag(36263241,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',fd,L.copyPasteTargetType)):17===rb.pasteErrorName?(ec=!0,yd="No-Op",xe=fd="Paste text on Art is not yet a supported operation",dc.ULS.sendTraceTag(0,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',fd,L.copyPasteTargetType)):16===rb.pasteErrorName?(ec=!0,yd="No-Op",xe=fd="Paste has failed because the previous copy has failed",dc.ULS.sendTraceTag(537167771,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}", error={2}',
fd,L.copyPasteTargetType,this.getStringifiedError(rb))):Se.a.mr(rb.ewaErrors)?(Se.a.a$(rb.ewaErrors)||Se.a.nh(rb.ewaErrors,Se.a.rcc())?(ec=!0,yd="CommunicationError",fd=Se.a.Tc(rb.ewaErrors),dc.ULS.sendTraceTag(36304159,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',xe,L.copyPasteTargetType)):Se.a.nh(rb.ewaErrors,Hc.vij)?(ec=!0,yd="SavingWorkbookError",fd=Se.a.Tc(rb.ewaErrors),dc.ULS.sendTraceTag(36304160,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',
xe,L.copyPasteTargetType)):Se.a.nh(rb.ewaErrors,Hc.operationSucceededWithAlert)&&(ze=ec=!0,yd="OperationSucceededWithAlert",fd=Se.a.Tc(rb.ewaErrors),dc.ULS.sendTraceTag(36304161,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',xe,L.copyPasteTargetType)),ec||(xe=this.Oac(rb.ewaErrors),ec=this.Jnd(Ma))):11===rb.pasteErrorName&&(ec=!0,yd="No-Op",xe="Paste has failed because user try copy cross-session oart object");15===Ma.reason&&(ec=!0,yd="No-Op",xe="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
Na.a.equals(cf,rd.LSj,!1)&&(ec=!0,yd="No-Op",xe="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}ec||dc.ULS.sendTraceTag(24150916,0,10,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',Ma?this.getStringifiedError(Ma):"null",L.copyPasteTargetType);this.Yti(L,ec,xe,yd,cf,be,ze,Ma.pasteContext,Yf);return Promise.reject(Ma)};Hc.prototype.Rnc=function(L,Ma){var rb;dc.ULS.sendTraceTag(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="{0}"',
Ma.copyPasteTargetType);this.pasteIndicationManager.hjd(Ma.id);if(this.UVi(Ma.copyPasteTargetType,L)){td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Ag.a.RC&&L.wasLastCopyExternal&&L.payloadType===Mc.tO&&(this.N6a=!0);var ec=null;(null===(rb=L.pastedRange)||void 0===rb?0:rb.Ranges)&&0<L.pastedRange.Ranges.length?ec=$e.g(L.pastedRange.Ranges):L.wasLastCopyExternal||(ec=Ma.expandDestinations);this.ekj(L,ec);if(this.hwj(L,ec)){rb=Bc.a.clone(Ma.originalDestinations);
ec=1028===Ma.commandType?Bc.a.clone(Ma.expandDestinations):Bc.a.clone(ec);var fd=null;L.wasLastCopyExternal&&(Ma.isKeyboardEvent||Ma.isPasteCommandFromRecoveryUI)&&(fd={},fd=(fd[Hc.kFf]=L.clipboardItems,fd));this.Rdf&&this.pasteDestinationHasMergedCells(Ma.expandDestinations)&&(L.pasteDestinationHasMergedCells=!0);L.pasteRecoveryUIDisplayed=!0;var yd=new md(this.$,rb,ec,fd),be=Ob.GetServiceTaskFactory.Xa(this.$.da,406,405,0);Pd.TaskExtensions.Ba(be,function(){var xe=be.result;xe.yNg(yd);xe.qzj(Ma.ribbonCommandInfo.method)},
this.la,8)}}this.lye("Paste/success/"+gg.a[Ma.ribbonCommandInfo.method],L);this.Zti(L);this.I1f&&(!Ma.isKeyboardEvent||ed(L))&&this.$.ea.Yg.get(66)&&(dc.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.I1f=!1,this.P3g());return Promise.resolve(!0)};Hc.prototype.hwj=function(L,Ma){return!Ma||1!==Ma.length||L.commandParameters.clearSystemClipboard||L.commandParameters.clearStateOnFinish||L.commandParameters.skipClipboardAccess?!1:
pe(L)&&(Ma=L.clipboardItems.getItem(Ec.yW),L=L.clipboardItems.getItem(Ec.html),void 0===Ma||null===Ma||Ma.length>this.ovd||void 0===L||null===L||L.length>this.TNa)?(dc.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0};Hc.prototype.UVi=function(L,Ma){return 1===L||Ma.payloadType===Mc.yW||td.EwaSettings.ma(162)&&Ma.payloadType===Mc.html||td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!Ag.a.RC&&Ma.payloadType===Mc.tO};Hc.prototype.pasteDestinationHasMergedCells=function(L){var Ma=ae.g(this.$).Ea.XE();if(!Ma||!Ma.length)return!1;Ma=Gl(Ma);for(var rb=Ma.next();!rb.done;rb=Ma.next())if(rb.value.Aw(L[0]))return!0;return!1};Hc.prototype.lye=function(L,Ma){var rb=this,ec;(function(){var fd=rb.wei(Ma);ec=fd.RGa;return fd})().returnValue&&this.Qr(L,ec,void 0,void 0,Ma.commandParameters.copyPasteTargetType).catch(function(){})};Hc.prototype.m9a=function(L,Ma,rb,ec,fd,yd){dc.ULS.sendTraceTag(24150918,
0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: {0}",L?this.getStringifiedError(L):"null");var be=!1,xe=!1,cf=!1,ze=Hc.Qrb,Yf=Hc.SIe+Hc.IIa;L&&(Yf+=Hc.ZJa(L),Se.a.mr(L.ewaErrors)?(ze=this.Oac(L.ewaErrors),Se.a.nh(L.ewaErrors,Hc.operationSucceededWithAlert)&&(be=!0),Se.a.nh(L.ewaErrors,Hc.dragDropNonEmptyRange)&&(xe=cf=!0)):L.message&&(ze=L.message));cf||(cf=this.Jnd(L));xe?this.gridView.ha.selectionType=-1:this.Vp.s5i(fd);this.Ssi(Ma,rb,ec,fd,cf,ze,Yf,be,yd)};Hc.prototype.iZc=function(L,Ma){var rb=
L,ec=this.XPh();if(null===ec||void 0===ec?0:ec.ranges)rb=this.Vp.$Sg(Ma,ec.ranges,L);return rb};Hc.prototype.XPh=function(){var L=wc(this.rK);return L&&Dd(L.sourceItem)?L.sourceItem:null};Hc.prototype.C2i=function(){this.raiseEvent(Hc.mBd,null)};Hc.prototype.ekj=function(L,Ma){var rb=L.commandParameters.originalDestinations;Ma&&($e.Q(this.gridView.ha.ta.selectedRanges,rb)?(this.Vuc(Ma),dc.ULS.sendTraceTag(537167767,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: {0}",
Oe.HelperMethods.Znb(Ma))):L.commandParameters.isPasteCommandFromRecoveryUI?(this.Vuc(Ma,!0),dc.ULS.sendTraceTag(537167766,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: {0}, active cell: {1}",Ma,Ma[0].topLeft)):dc.ULS.sendTraceTag(537167765,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: {0}",Oe.HelperMethods.Znb(rb)))};
Hc.prototype.wei=function(L){if(L.isPlainTextPaste||L.isHtmlPaste||Nd(L)||L.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,RGa:!1};var Ma=L.copyContextSnapshot;if(L.commandParameters.clearStateOnFinish)return{returnValue:!0,RGa:!0};if(Ma&&Dd(Ma.sourceItem)){var rb=Ma.sourceItem;if(!rb.isFromCurrentSession(this.$))return{returnValue:!1,RGa:!0};Ma=-1985798686===Ma.commandParameters.ribbonCommandInfo.command;if(!(1<rb.ranges.length||1<L.commandParameters.expandDestinations.length)){var ec=
$e.K(rb.ranges);L=$e.K(L.commandParameters.expandDestinations);var fd=this.$.ea.qa.sheetName;rb=rb.sheetName;if(rb===fd&&L.equals(ec))return{returnValue:!1,RGa:!0};if(rb===fd&&L.Se(ec))return{returnValue:!0,RGa:!1}}return{returnValue:Ma,RGa:!0}}return{returnValue:!1,RGa:!0}};Hc.prototype.rCf=function(){var L=wc(this.rK);(L=this.Vp.Svb(L))&&L.isFromCurrentSession(this.$)&&this.Qr("OnStartEdit",!1).catch(function(){})};Hc.prototype.Oac=function(L){L=Se.a.KMh(L,Hc.IIa);return this.Jyi+Aa.a.ew(L).toString()};
Hc.prototype.Jnd=function(L){L=Hc.ZJa(L);return!!L&&Na.a.M1a(L,Hc.Iyi)};Hc.prototype.P3g=function(){var L=Se.a.gd(1,2,331,332,Ag.a.lp?333:Ag.a.JH?334:335,530046625,"ActivateLocalStorage"),Ma=Ob.GetServiceTaskFactory.Xa(this.$.da,5,4,0);Pd.TaskExtensions.Ba(Ma,function(){Ma.result.fg(41,L)},this.la,3)};Hc.prototype.BBe=function(L){return void 0===L||null===L?Cd.fCi:L?Cd.success:Cd.failed};Hc.o2g=function(L){var Ma=L.innerError;return Ma&&0!==Ma.pasteErrorName?L.innerError:null};Hc.b2g=function(L){var Ma=
L.innerError;return Ma&&0!==Ma.copyErrorName?L.innerError:null};Hc.ZJa=function(L){var Ma="";if(!L)return Hc.VFe;L.errorName&&(Ma=L.errorName,L.innerError&&(Ma+=Hc.IIa+Hc.ZJa(L.innerError)));Ma||(Ma=L&&L.name?L.name:Hc.VFe);return Ma};Hc.X$b=function(){Hc.SLb||(Lc.a.hef()?Hc.SLb=Sb.AAj:Lc.a.Pod()?Hc.SLb=Sb.zAj:Hc.SLb=Sb.yAj);return Hc.SLb};Hc.uBe=function(L){switch(L){case 7:case 1:return 2162;case 5:return 2159;case 6:return 2158;case 8:case 3:case 2:case 4:case 9:case 10:return 2155;default:return dc.ULS.shipAssertTag(537167764,
0,!1,"CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = {0}",L),2162}};Hc.c2g=function(L){switch(L){case 3:return 2156;case 1:return 2157;case 2:case 4:return 2155;default:return dc.ULS.shipAssertTag(537167763,0,!1,"CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = {0}",L),2162}};Ck.Object.defineProperties(Hc.prototype,{pasteIndicationManager:{configurable:!0,enumerable:!0,get:function(){return this.$.da.za(373)}}});
Hc.mpf="EwaJsMetadataChangeListenerId";Hc.mBd="cpiOSC";Hc.cch="cpiDID";Hc.Qrb="Unknown";Hc.VFe="UnknownError";Hc.IIa="_";Hc.SIe="DragAndDropError";Hc.pasteErrorName="PasteError";Hc.bUg="CancelError";Hc.copyErrorName="CopyError";Hc.Iyi="MergedCellOverlap";Hc.kFf="PasteRecoveryCachedClipboardItems";Hc.vij=[1352631530,1679665408];Hc.operationSucceededWithAlert=[-103190598];Hc.pasteDataLimitHit=[1306609195];Hc.copyThrottlingError=[-386183710];Hc.dragDropNonEmptyRange=[563945982];Hc.SLb=null;Object(nd.a)(Hc,
"CopyPasteInfrastructure",le.a,[860,861,3]);Object(nd.a)(gc,"ClipboardPlatformInitializationResult",null,[]);var Xe=b(735),wf=b(127),De=b(5),oc=b(83);Object(nd.a)(xb,"MacroRecorderPasteRangePayload",null,[450]);kd.prototype.getContent=function(){return this.content};Object(nd.a)(kd,"MacroRecorderPasteStringPayload",null,[450]);var Yc=b(63);Object(nd.a)(Qc,"MacroRecorderPastePayload",null,[450]);var hf=b(644),ie=b(971),bf=b(560),Wd=b(175),ee=b(213),Yg=b(121),Sf=b(292),vd=b(354);Ub.prototype.getParameters=
function(){return this.parameters};Object(nd.a)(Ub,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[450]);var vf=b(386);Object(nd.a)(Zb,"PasteHtmlRequestParams",null,[]);jb.prototype.copy=function(L,Ma,rb,ec,fd){function yd(ze,Yf,Sg){var eg={CopyPasteTargetType:1};eg.SourceRanges=L;eg.CopyOperationId=Ma.id;dc.ULS.sendTraceTag(537167756,0,50,"CopyPasteInfrastructure.Copy served from CopyPasteProxy : {0}, CopyOperationId : {1}",be.Hwa,eg.CopyOperationId);be.YMa=be.Hwa?Qd(be.$.na.kw,eg,Sf.b(ze,
rb),ec?Sf.a(Yf,ec):Yf,Sg,Ma.ribbonCommandInfo,xe,fd):Qd(be.$.na.va,eg,Sf.b(ze,rb),ec?Sf.a(Yf,ec):Yf,Sg,Ma.ribbonCommandInfo,xe,fd);return be.YMa}var be=this;ec=void 0===ec?null:ec;fd=void 0===fd?null:fd;var xe=this.$.na.va.hc();this.dmd&&this.pY();this.Ric=xe.ClientRequestId;var cf=td.EwaSettings.qc()?new Wd.a(505,0,yd,80):new bf.a(505,0,yd,16);cf=this.$.userOperationManager.jc(cf,Ma.ribbonCommandInfo);this.dmd&&this.pv.add(cf)};jb.prototype.jFf=function(L,Ma,rb,ec,fd,yd){var be=this;return new Promise(function(xe,
cf){var ze,Yf=yd.commandParameters.stopwatch.Bc,Sg=2;20===yd.commandParameters.commandType&&(Sg=16);36===yd.commandParameters.commandType&&(Sg=32);Lc.a.Pod()&&68===yd.commandParameters.commandType&&(Sg=64);Lc.a.ard(be.$)&&1028===yd.commandParameters.commandType&&(Sg=1024);var eg=null;if(null===(ze=yd.copyContextSnapshot)||void 0===ze?0:ze.commandParameters)eg=yd.copyContextSnapshot.commandParameters.id;jb.ZMd(be.$,L,ec,Ma,rb,null,function(Pg){jb.Qcc(Pg,yd,xe,cf,Yf,be.$)},function(Pg){yd.serverRequestTimeInMs=
yd.commandParameters.stopwatch.Bc-Yf;Pg=Yg.a.ig(Pg.data);cf(new ie.a(5,Pg))},fd,Sg,eg,yd.commandParameters.id)})};jb.prototype.pasteRange=function(L,Ma,rb,ec,fd,yd,be,xe,cf,ze){var Yf=this;return new Promise(function(Sg,eg){var Pg=be.commandParameters.stopwatch.Bc;jb.qlj(Yf.$,L,Ma,rb,ec|-5&fd,function(Vh){null===cf||void 0===cf?void 0:cf();jb.Qcc(Vh,be,Sg,eg,Pg,Yf.$)},function(Vh){be.serverRequestTimeInMs=be.commandParameters.stopwatch.Bc-Pg;Vh=Yg.a.ig(Vh.data);Vh=new ie.a(5,Vh);null===ze||void 0===
ze?void 0:ze(Vh);eg(Vh)},yd,xe)})};jb.prototype.S_i=function(L,Ma,rb,ec,fd,yd,be){var xe=this;return(new Promise(function(cf,ze){if(Ma)if(Ma.length>xe.TNa){var Yf=be.clipboardItems.getItem(Ec.yW),Sg=-1;void 0!==Yf&&null!==Yf&&(Sg=Yf.length);dc.ULS.sendTraceTag(42071712,0,15,"CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: {0}, MaxHtmlImportLength: {1}, PlainTextLength: {2}",Ma.length,xe.TNa,Sg);ze(new ie.a(1))}else Yf=function(eg,Pg,Vh){xe.$.By();var fe=
be.commandParameters.stopwatch.Bc;eg=Sf.b(eg,function(ag){jb.Qcc(ag,be,cf,ze,fe,xe.$,Ma)});Pg=Sf.a(Pg,function(ag){be.serverRequestTimeInMs=be.commandParameters.stopwatch.Bc-fe;ag=Yg.a.ig(ag.data);ze(new ie.a(3,ag))});var af=xe.$.na.va.hc(),zh=$e.v(L,xe.$),yi={};yi.SourceHtml=Ma;yi.DestinationRanges=zh?$e.s(zh):null;yi.CopyOperationId=rb;yi.PasteId=ec;dc.ULS.sendTraceTag(537167755,0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : {0}. PasteId : {1}",xe.Hwa,yi.PasteId);return xe.Hwa?
Jd(xe.$.na.kw,yi,eg,Pg,Vh,null,af,yd):Jd(xe.$.na.va,yi,eg,Pg,Vh,null,af,yd)},Yf=td.EwaSettings.qc()?new Wd.a(204,0,Yf,65):new bf.a(204,0,Yf,1),xe.$.userOperationManager.jc(Yf,fd);else cf("")})).then(function(){zf.a.ggi&&Ma.length>xe.q$a&&(xe.LXi(Ma),xe.RN=new Zb(L,Ma,rb,ec,fd,yd,be,0,xe.DCd.length),window.requestIdleCallback&&window.requestIdleCallback(function(){return xe.wFf()}))})};jb.prototype.LXi=function(L){var Ma=this.$.Pb.Gc("Task","pasteHtmlChunkOperation"),rb=Math.floor(L.length/this.q$a)+
1;this.DCd=Array(rb);for(var ec=0;ec<rb;)this.DCd[ec]=L.substring(ec*this.q$a,(ec+1)*this.q$a),ec++;dc.ULS.sendTraceTag(523257954,0,50,"CopyPasteUtils.populatePasteChunks Time taken for chunking: "+Ma.Bc)};jb.prototype.wFf=function(){var L=this,Ma=this.DCd[this.RN.Opb],rb=this.$.Pb.Gc("Task","pasteHtmlServerCall");this.NVi(this.RN.destinationRange,Ma,this.RN.Lqb,this.RN.iFf,this.RN.Sd,this.RN.sOb,this.RN.pasteContext,this.RN.Opb,this.RN.NVd);this.RN.Opb++;dc.ULS.sendTraceTag(523257953,0,15,"CopyPasteUtils.performChunkedPasteHtml server call time: "+
rb.Bc+",\n       pasteid:"+this.RN.iFf+",\n       chunkIndex:"+this.RN.Opb+",\n       totalChunks:"+this.RN.NVd);this.RN.Opb<this.RN.NVd&&window.requestIdleCallback(function(){return L.wFf()})};jb.prototype.NVi=function(L,Ma,rb,ec,fd,yd,be,xe,cf){function ze(eg,Pg,Vh){var fe=be.commandParameters.stopwatch.Bc;eg=Sf.b(eg);Pg=Sf.a(Pg,function(){be.serverRequestTimeInMs=be.commandParameters.stopwatch.Bc-fe});var af=Yf.$.na.va.hc(),zh=$e.v(L,Yf.$);zh={SourceHtml:Ma,DestinationRanges:zh?$e.s(zh):null,CopyOperationId:rb,
PasteId:ec+"_chunk_"+xe,ChunkIndex:xe,TotalChunks:cf};dc.ULS.sendTraceTag(523257952,0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : {0}. PasteId : {1}",Yf.Hwa,zh.PasteId);return Jd(Yf.$.na.kw,zh,eg,Pg,Vh,null,af,yd)}var Yf=this,Sg=td.EwaSettings.qc()?new Wd.a(204,0,ze,65):new bf.a(204,0,ze,1);this.$.userOperationManager.jc(Sg,fd)};jb.prototype.T_i=function(L,Ma,rb,ec,fd){var yd=this;return new Promise(function(be,xe){dc.ULS.sendTraceTag(537167754,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id={0}",
fd.id);Ma&&(Ma=Na.a.trimEnd(Ma,"\n","\r"));dc.ULS.sendTraceTag(537167753,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id={0}",fd.id);if(Ma){var cf=yd.ovd;if(Ma.length>cf)dc.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",Ma.length,cf),xe(new ie.a(1));else{var ze=$e.v(L,yd.$);dc.ULS.sendTraceTag(537167752,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id={0}",
fd.id);cf=!yd.$.ea.isNamedObjectViewMode&&!Ma.includes("\n")&&!Ma.includes("\t");dc.ULS.sendTraceTag(537167751,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id={0}. treatAsLink={1}",fd.id,cf);cf=cf&&Na.a.Gdf(Ma);dc.ULS.sendTraceTag(537167750,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id={0}. treatAsLink={1}",fd.id,cf);var Yf=yd.$.na.va.hc();if(cf){var Sg=526;dc.ULS.sendTraceTag(537167749,
0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id={0}",fd.id);var eg=ee.a.sad(Ma);dc.ULS.sendTraceTag(537167748,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id={0}",fd.id);var Pg=$e.s(ze);cf=function(fe,af,zh){var yi=fd.commandParameters.stopwatch.Bc;fe=Sf.b(fe,function(ag){dc.ULS.sendTraceTag(537167747,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id={0}",
fd.id);fd.requestTelemetryData=ag.RequestTelemetryData;fd.serverRequestTimeInMs=fd.commandParameters.stopwatch.Bc-yi;ag.Errors&&0<ag.Errors.length?xe(new ie.a(2,ag.Errors)):be(Ma)});af=Sf.a(af,function(ag){fd.serverRequestTimeInMs=fd.commandParameters.stopwatch.Bc-yi;ag=Yg.a.ig(ag.data);xe(new ie.a(2,ag))});yd.$.By();dc.ULS.sendTraceTag(537167746,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id={0}",fd.id);return oc.c(yd.$.na.va,Pg,Ma,eg,!1,!1,
63,fe,af,zh,L,Yf,ec)};var Vh=function(){return new hf.a(Pg,Ma,eg)}}else Sg=180,cf=function(fe,af,zh){yd.$.By();var yi=fd.commandParameters.stopwatch.Bc;fe=Sf.b(fe,function(ag){dc.ULS.sendTraceTag(537167745,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id={0}",fd.id);jb.Qcc(ag,fd,be,xe,yi,yd.$,Ma)});af=Sf.a(af,function(ag){fd.serverRequestTimeInMs=fd.commandParameters.stopwatch.Bc-yi;ag=Yg.a.ig(ag.data);xe(new ie.a(4,ag))});dc.ULS.sendTraceTag(537167744,
0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id={0}",fd.id);return zd(yd.$.na.va,ze,Ma,fe,af,zh,null,Yf,ec)},Vh=function(){return new kd(ze,Ma)};dc.ULS.sendTraceTag(537167715,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserNonBlockingWebMethodOperation. pasteContext.Id={0}",fd.id);cf=td.EwaSettings.qc()?new Wd.a(Sg,0,cf,65,Vh):new bf.a(Sg,0,cf,1,Vh);dc.ULS.sendTraceTag(537167714,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id={0}",
fd.id);yd.$.userOperationManager.jc(cf,rb)}}else be("")})};jb.prototype.u7e=function(L,Ma){Ma=[1===Ma?4:5];this.gridView.Db.Av(vd.a.$0(Yc.d(this.$.qa),L),Ma,!0);this.gridView.Db.Cn(Ma);this.gridView.Db.update(!0)};jb.prototype.cxb=function(){var L=[4,5];this.gridView.Db.Oh(L,!1,!1);this.gridView.Db.vj(null,L,!1);1===this.gridView.ha.We&&this.gridView.Cn(!1,!1);this.gridView.Db.update(!1,!1)};jb.prototype.$Sg=function(L,Ma,rb){var ec=[];rb=Gl(rb);for(var fd=rb.next();!fd.done;fd=rb.next())ec.push(this.cTg(L,
Ma,fd.value));return ec};jb.prototype.pY=function(){if(this.pv)for(var L=Gl(this.pv),Ma=L.next();!Ma.done;Ma=L.next())Ma=Ma.value,this.$&&this.$.userOperationManager&&(Ma.operation&&dc.ULS.sendTraceTag(526758675,0,50,"CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",wf.a(Ma.operation.operationName)),this.$Tg(),this.$.userOperationManager.Ota(Ma))};jb.prototype.$Tg=function(){if(this.YMa){var L=this.YMa.Pt;dc.ULS.sendTraceTag(526758674,0,15,"Cancelling pending copy request with Id={0}",
L);Yg.a.yu(L);!td.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&this.Ric&&oc.j(this.$.na.va,this.Ric,null,null,null);this.Ric=this.YMa=null}};jb.prototype.Kz=function(L,Ma){2===Ma.Dp?(this.pv.clear(),this.YMa=null):1===Ma.Dp&&this.pv&&this.pv.contains(Ma.Pf)&&(dc.ULS.sendTraceTag(526758673,0,50,"CopyPasteUtils.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",wf.a(Ma.Pf.operation.operationName),Ma.Pf.dequeueUtcTime.getTime()-Ma.Pf.enqueueUtcTime.getTime()),
this.pv.remove(Ma.Pf),this.YMa=null)};jb.prototype.cTg=function(L,Ma,rb){dc.ULS.shipAssertTag(537167713,0,!!Ma,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");dc.ULS.shipAssertTag(537167712,0,0<Ma.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");var ec=0,fd=0,yd=new Set,be=new Set;Ma=Gl(Ma);for(var xe=Ma.next();!xe.done;xe=Ma.next()){xe=xe.value;var cf=String.format("{0}_{1}",xe.left,xe.right),ze=String.format("{0}_{1}",xe.top,
xe.bottom);be.has(cf)||(be.add(cf),fd+=xe.width);yd.has(ze)||(yd.add(ze),ec+=xe.height)}if(36===L)return rb.isSingle?jb.WQe(fd,ec,rb):rb.clone();516===L&&(L=ec,ec=fd,fd=L);L=!(rb.width%fd)&&!(rb.height%ec);yd=rb.l_&&!(rb.height%ec);rb.y5&&!(rb.width%fd)||yd?rb=jb.WQe(fd,ec,rb):L?rb=rb.clone():(rb=rb.clone(),rb.bottom=Math.min(Ve.a.Hh,rb.top+ec-1),rb.right=Math.min(Ve.a.Rh,rb.left+fd-1));return rb};jb.prototype.AKg=function(L,Ma,rb,ec,fd,yd,be,xe,cf,ze,Yf){if(!ec||!ec.length)return 1;if(1<ec.length){if(!this.Hfc&&
yd)return 3;if(ze)return 0;if(xe)return 9;if(cf)return 8;if(Yf)return 2;if(1<Ma.length)return 4;var Sg=Ma[0];if(!be&&!Bc.a.all(ec,function(eg){return eg.isSingle||!(eg.width%Sg.width)&&!(eg.height%Sg.height)}))return 5;if((!this.Hfc||!yd)&&Na.a.equals(L,rb,!0))for(fd=Gl(fd),L=fd.next();!L.done;L=fd.next())if(L=L.value,L.Ed(Sg)&&!L.equals(Sg))return 6}else if(Ma&&0<Ma.length){if(0!==this.sbf(Ma,cf))return 7;if(1<Ma.length){if(!this.Hfc&&yd)return 3;if((!this.Hfc||!yd)&&Na.a.equals(L,rb,!0))for(L=Gl(Ma),
Ma=L.next();!Ma.done;Ma=L.next())if(Ma=Ma.value,rb=fd[0],Ma.Ed(rb)&&!Ma.equals(rb))return 6}}return 0};jb.prototype.sbf=function(L,Ma){if(!L||1>=L.length)return 0;if(Ma)return 2;if(!$e.S(L))return 1;Ma=new Xe.a(sa.a.Qk());for(var rb=Gl(L),ec=rb.next();!ec.done;ec=rb.next()){ec=ec.value;for(var fd=Gl(L),yd=fd.next();!yd.done;yd=fd.next()){yd=yd.value;var be=ec.top===yd.top&&ec.bottom===yd.bottom,xe=ec.left===yd.left&&ec.right===yd.right,cf=Math.max(ec.left,yd.left)<Math.min(ec.right,yd.right);if(Math.max(ec.top,
yd.top)<Math.min(ec.bottom,yd.bottom)&&!be||cf&&!xe)return 3;Ma.add(String.format("{0}-{1}-{2}-{3}",ec.top,ec.bottom,yd.left,yd.right));Ma.add(String.format("{0}-{1}-{2}-{3}",yd.top,yd.bottom,ec.left,ec.right))}}L=Gl(L);for(rb=L.next();!rb.done;rb=L.next())rb=rb.value,Ma.remove(String.format("{0}-{1}-{2}-{3}",rb.top,rb.bottom,rb.left,rb.right));return 0<Ma.count?3:0};jb.prototype.s5i=function(L){var Ma=this.gridView.ha;Ma.updateSelection(L,L.topLeft,0);Ma.selectionType=-1};jb.prototype.Svb=function(L){if(null===
L||void 0===L?0:L.sourceItem){if(!Dd(L.sourceItem))return null;if((L=L.sourceItem)&&$e.cb(L.ranges,!0))return L}return null};jb.prototype.jgc=function(L,Ma){dc.ULS.shipAssertTag(537167711,0,!!L,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return Ma&&De.a.YF in Ma||L.tabName?!1:1===L.method};jb.qlj=function(L,Ma,rb,ec,fd,yd,be,xe,cf){function ze(){return new xb(rb,ec,fd)}function Yf(eg,Pg,Vh){L.By();var fe=L.na.va;eg=Sf.b(eg,yd);Pg=Sf.a(Pg,be);var af=xe;af=void 0===af?null:
af;var zh=fe.Na(9,Sg);zh.sourceRanges=rb;zh.destinationRanges=ec;zh.flags=fd;return oc.i(fe,"PasteRange",zh,eg,Pg,Vh,null,64,af)}var Sg=L.na.va.hc(cf?{ola:!0,kka:1}:{ola:!1,kka:0});cf=td.EwaSettings.qc()?new Wd.a(506,0,Yf,65,ze):new bf.a(506,0,Yf,1,ze);L.userOperationManager.jc(cf,Ma)};jb.Qcc=function(L,Ma,rb,ec,fd,yd,be){be=void 0===be?null:be;dc.ULS.sendTraceTag(537167710,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id={0}",Ma.id);Ma.requestTelemetryData=
L.RequestTelemetryData;Ma.serverRequestTimeInMs=Ma.commandParameters.stopwatch.Bc-fd;Se.a.oh(L.Errors)?Se.a.aha(L.Errors)?(Ma&&(Ma.encounteredDeploymentErrors=!0),dc.ULS.sendTraceTag(537167707,0,15,"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",Se.a.Tc(L.Errors))):ec(new ie.a(5,L.Errors)):L.Result?(ec=!!L&&!!L.RequestTelemetryData,ae.g(yd).Ii.qla(Ma.commandParameters.stopwatch.id,L.StateId,ec?L.RequestTelemetryData.EcsOperationDuration:
0,ec?L.RequestTelemetryData.EcsRequestDuration:0,ec?L.RequestTelemetryData.WfeRequestDuration:0),Ma.pastedRange=L.Result.SheetMultiRange,dc.ULS.sendTraceTag(537167708,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id={0}",Ma.id),rb(!0)):(dc.ULS.sendTraceTag(537167709,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id={0}",Ma.id),rb(be||!0))};
jb.ZMd=function(L,Ma,rb,ec,fd,yd,be,xe,cf,ze,Yf,Sg){function eg(){return new Qc(fe)}function Pg(af,zh,yi){L.By();return bd(L.na.va,fe,Sf.b(af,be),Sf.a(zh,xe),yi,yd,Vh,cf)}var Vh=L.na.va.hc(),fe=jb.Q7g(rb,ec,fd,ze,Yf,Sg);rb=td.EwaSettings.qc()?new Wd.a(503,0,Pg,65,eg):new bf.a(503,0,Pg,1,eg);L.userOperationManager.jc(rb,Ma)};jb.Q7g=function(L,Ma,rb,ec,fd,yd){var be={};be.ShadowWorkbookBase64=L.shadowWorkbookBase64;be.SourceRanges={};be.SourceRanges.Ranges=Array(1);be.SourceRanges.Ranges[0]={};be.SourceRanges.Ranges[0].FirstRow=
L.rangeRowStart;be.SourceRanges.Ranges[0].LastRow=L.rangeRowEnd;be.SourceRanges.Ranges[0].FirstColumn=L.rangeColumnStart;be.SourceRanges.Ranges[0].LastColumn=L.rangeColumnEnd;td.EwaSettings.getBooleanFeatureGate(zf.a.R4b,!1)?rb?be.DestinationRanges=$e.u(rb.SheetName,rb.NamedObjectName,$e.g(rb.Ranges)):(dc.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),be.DestinationRanges=null):be.DestinationRanges=Ma?$e.s(Ma):null;be.CopyPasteTargetType=
1;be.PasteType=ec;be.CopyOperationId=fd;be.PasteId=yd;be.SourceClientPath=L.sourceClientPath;be.SourceSheetName=L.sourceSheetName;be.SourceWorkbookName=L.sourceWorkbookName;if(!L.originalSourceRangesCountExceedsLimit&&L.originalSourceRanges&&0<L.originalSourceRanges.length&&1024===ec){be.OriginalSourceMultiRange={};Ma=Array(L.originalSourceRanges.length);for(rb=0;rb<Ma.length;++rb)Ma[rb]={},Ma[rb].FirstRow=L.originalSourceRanges[rb][0],Ma[rb].FirstColumn=L.originalSourceRanges[rb][1],Ma[rb].LastRow=
L.originalSourceRanges[rb][2],Ma[rb].LastColumn=L.originalSourceRanges[rb][3];be.OriginalSourceMultiRange.Ranges=Ma}return be};jb.WQe=function(L,Ma,rb){rb=rb.clone();rb.height<Ma&&(rb.bottom=Math.min(Ve.a.Hh,rb.top+Ma-1));rb.width<L&&(rb.right=Math.min(Ve.a.Rh,rb.left+L-1));return rb};jb.prototype.executeInsertCopiedCutCellsOperation=function(L,Ma,rb,ec,fd,yd,be){function xe(){return new Ub(cf)}yd=void 0===yd?null:yd;be=void 0===be?null:be;var cf={};cf.InsertDirection=ec;cf.SourceRange=L;cf.DestRange=
Ma;cf.CopyCutOperation=rb?0:1;var ze=this.$.na.va;return vf.a(this.$.userOperationManager,function(Yf,Sg,eg){Yf=yd?Sf.b(Yf,yd):Yf;Sg=be?Sf.a(Sg,be):Sg;var Pg=ze.Na(41,null);Pg.insertCopiedCutCellsParameters=cf;return oc.i(ze,"InsertCopiedCutCells",Pg,Yf,Sg,eg,null,4)},function(Yf){return new Wd.a(104,0,Yf,void 0,xe)},fd)};jb.prototype.WIe=function(L,Ma,rb,ec,fd,yd,be,xe){var cf=this;return new Promise(function(ze,Yf){function Sg(Pg){Pg=Yg.a.ig(Pg.data);Pg=new ie.a(21,Pg);null===xe||void 0===xe?void 0:
xe(Pg);Yf(Pg)}function eg(Pg){null===be||void 0===be?void 0:be();L.requestTelemetryData=Pg.RequestTelemetryData;Pg.Errors&&0<Pg.Errors.length?Yf(new ie.a(21,Pg.Errors)):ze(!0)}td.EwaSettings.isChangeGateEnabled("OfficeVSO:6126613_RemoveClearingRunningAntsICCCForDragInsert")?cf.executeInsertCopiedCutCellsOperation(Ma,rb,ec,fd,yd,eg,Sg):cf.executeInsertCopiedCutCellsOperation(Ma,rb,ec,fd,yd,eg,Sg).continueWith(function(){if(ec)cf.cxb();else{var Pg=cf.$.da.za(254);Pg&&Pg.r2b("DragDropInsert/success/"+
gg.a[yd.method],!0)}})})};Ck.Object.defineProperties(jb.prototype,{ovd:{configurable:!0,enumerable:!0,get:function(){dc.ULS.sendTraceTag(537167757,0,50,"CopyPasteUtils.MaxCopyPasteLength returning BootstrapContext.MaxCopyPasteLength. MaxCopyPasteLength={0}",this.$.ya.MaxCopyPasteLength);return this.$.ya.MaxCopyPasteLength}},TNa:{configurable:!0,enumerable:!0,get:function(){return this.Hwa?td.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.$.ya.CopyPasteMaxPayloadLength):
Ve.a.TNa}}});Object(nd.a)(jb,"CopyPasteUtils",null,[858]);var rh=b(539),cg;(function(L){L[L.range=0]="range";L[L.art=1]="art"})(cg||(cg={}));Object(nd.b)("SourceItemType",cg);var eh=b(25),Ud=b(95);ma.prototype.serializeSourceItem=function(L){var Ma={};if(L&&Object.getType(L)===wb)Ma.sheetName=L.sheetName,Ma.topArray=Bc.a.map(L.ranges,function(rb){return rb.top}),Ma.leftArray=Bc.a.map(L.ranges,function(rb){return rb.left}),Ma.bottomArray=Bc.a.map(L.ranges,function(rb){return rb.bottom}),Ma.rightArray=
Bc.a.map(L.ranges,function(rb){return rb.right}),Ma.sessionStateId=L.sessionStateId,Ma.sessionId=L.sessionId,Ma.sourceItemType=this.QWf(0);else if(L&&Object.getType(L)===lf)Ma.activeFloatingObjectControlId=L.activeFloatingObjectControlId,Ma.sheetName=L.sheetName,Ma.sessionStateId=L.sessionStateId,Ma.sessionId=L.sessionId,Ma.floatingObjectType=this.Slj(L.type),Ma.sourceItemType=this.QWf(1);else return dc.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),
null;return JSON.stringify(Ma)};ma.prototype.serializeCommandParameters=function(L){if(!L)return dc.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;var Ma={};Ma.id=L.id;Ma.commandType=L.commandType;Ma.copyPasteTargetType=L.copyPasteTargetType;L.ribbonCommandInfo&&(Ma.ribbonCommandName=this.$lj(L.ribbonCommandInfo.command),Ma.inputMethodName=this.Ulj(L.ribbonCommandInfo.method),Ma.frameModeName=this.Tlj(L.ribbonCommandInfo.mode),
Ma.uiLocationName=this.cmj(L.ribbonCommandInfo.Ze),Ma.tabName=L.ribbonCommandInfo.tabName);return JSON.stringify(Ma)};ma.prototype.deserializeSourceItem=function(L){if(!L)return null;try{var Ma=JSON.parse(L);if(!Ma)return dc.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;var rb=null;switch(this.edh(Ma.sourceItemType)){case 0:rb=new wb(this.$,this.bdh(Ma),Ma.sheetName,Ma.sessionStateId,Ma.sessionId);break;case 1:rb=new lf(Ma.activeFloatingObjectControlId,
Ma.sheetName,Ma.sessionStateId,Ma.sessionId,this.Zch(Ma.floatingObjectType))}return rb}catch(ec){return dc.ULS.sendTraceTag(537167702,0,10,"EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: {0}, errror: {1}",L?L.length:0,ec),null}};ma.prototype.deserializeCommandParameters=function(L){if(!L)return null;try{var Ma=JSON.parse(L);if(!Ma)return dc.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),
null;var rb=fh.a();rb.id=Ma.id;rb.ribbonCommandInfo=this.ddh(Ma);rb.commandType=Ma.commandType;rb.copyPasteTargetType=Ma.copyPasteTargetType;return rb}catch(ec){return dc.ULS.sendTraceTag(537167700,0,10,"EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: {0}, errror: {1}",L?L.length:0,ec),null}};ma.prototype.bdh=function(L){var Ma=[];dc.ULS.shipAssertTag(537167699,0,!!L.topArray&&0<L.topArray.length,"EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be {0}.",
L.topArray?"empty":"null");dc.ULS.shipAssertTag(537167698,0,!!L.leftArray&&0<L.leftArray.length,"EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be {0}.",L.leftArray?"empty":"null");dc.ULS.shipAssertTag(537167697,0,!!L.bottomArray&&0<L.bottomArray.length,"EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be {0}.",L.bottomArray?"empty":"null");dc.ULS.shipAssertTag(537167696,0,!!L.rightArray&&0<L.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be {0}.",
L.rightArray?"empty":"null");if(!(L.topArray&&L.leftArray&&L.bottomArray&&L.rightArray))return Ma;dc.ULS.shipAssertTag(537167695,0,L.topArray.length===L.bottomArray.length&&L.topArray.length===L.leftArray.length&&L.topArray.length===L.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray({0}), BottomArray({1}), LeftArray({2}), RightArray({3}) should be the same.",L.topArray.length,L.bottomArray.length,L.leftArray.length,L.rightArray.length);for(var rb=Math.min(L.topArray.length,
L.bottomArray.length,L.leftArray.length,L.rightArray.length),ec=0;ec<rb;ec++)Ma.push(new eh.Range(L.topArray[ec],L.leftArray[ec],L.bottomArray[ec],L.rightArray[ec],!1,!1));return Ma};ma.prototype.ddh=function(L){return new Ud.a(this.cdh(L.ribbonCommandName),this.adh(L.inputMethodName),this.$ch(L.frameModeName),this.fdh(L.uiLocationName),L.tabName)};ma.prototype.$lj=function(L){return void 0!==L&&null!==L&&L.toString()in this.eLd?this.eLd[L.toString()]:(dc.ULS.shipAssertTag(537167694,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",
-911352779,-1985798686,L),this.eLd["-911352779"])};ma.prototype.cdh=function(L){return L&&L in this.W5f?this.W5f[L]:(dc.ULS.shipAssertTag(537167693,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,L),-911352779)};ma.prototype.Ulj=function(L){return void 0!==L&&null!==L&&gg.a[L]in this.hka?this.hka[gg.a[L]]:(dc.ULS.shipAssertTag(537167692,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value {0}",
L),this.hka.unknown)};ma.prototype.adh=function(L){return L&&L in this.V5f?this.V5f[L]:(dc.ULS.shipAssertTag(537167691,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value {0}",L),0)};ma.prototype.Tlj=function(L){return void 0!==L&&null!==L&&rh.a[L]in this.R2a?this.R2a[rh.a[L]]:(dc.ULS.shipAssertTag(537167690,0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value {0}",L),this.R2a.edit)};ma.prototype.$ch=function(L){return L&&L in this.U5f?this.U5f[L]:
(dc.ULS.shipAssertTag(537167689,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value {0}",L),2)};ma.prototype.QWf=function(L){return void 0!==L&&null!==L&&cg[L]in this.$Lb?this.$Lb[cg[L]]:(dc.ULS.shipAssertTag(537167688,0,!1,"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value {0}",L),this.$Lb.range)};ma.prototype.edh=function(L){return L&&L in this.X5f?this.X5f[L]:(dc.ULS.shipAssertTag(537167687,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value {0}",
L),0)};ma.prototype.Slj=function(L){return void 0!==L&&null!==L&&L.toString()in this.RWc?this.RWc[L.toString()]:(dc.ULS.shipAssertTag(537167686,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value {0}",L),this.RWc["99"])};ma.prototype.Zch=function(L){return L&&L in this.T5f?this.T5f[L]:(dc.ULS.shipAssertTag(537167685,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value {0}",L),99)};ma.prototype.cmj=function(L){return void 0!==L&&
null!==L&&od.a[L]in this.Gr?this.Gr[od.a[L]]:(dc.ULS.shipAssertTag(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value {0}",L),this.Gr.ribbon)};ma.prototype.fdh=function(L){return L&&L in this.Y5f?this.Y5f[L]:(dc.ULS.shipAssertTag(537167684,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value {0}",L),2)};Object(nd.a)(ma,"EnvironmentSerializationHelper",null,[]);hd.gUf="SameSession";hd.KEe="CrossSession";hd.vjf="LegacyCrossSession";hd.external=
"External";Object(nd.a)(hd,"PayloadOrigin",null,[]);Jb.prototype.shouldWaitForCopyToComplete=function(){return!1};Jb.prototype.onDeferredPasteStarted=function(){};Jb.prototype.onDeferredPasteCompleted=function(){};Jb.prototype.beforePaste=function(){};Jb.prototype.LLj=function(L){var Ma=null;try{var rb=L.getItem(Ec.tO);if(!rb)return{returnValue:!1,I0:Ma};Ma=JSON.parse(rb);return{returnValue:this.ani(Ma),I0:Ma}}catch(ec){return dc.ULS.sendTraceTag(537167835,0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+
ec),{returnValue:!1,I0:Ma}}};Jb.prototype.ani=function(L){return!!L&&(!!L.shadowWorkbookBase64||L.shadowWorkbookSizeExceedsLimit)&&void 0!==L.rangeRowStart&&void 0!==L.rangeRowEnd&&void 0!==L.rangeColumnStart&&void 0!==L.rangeColumnEnd};Jb.prototype.wpc=function(L){L.wasLastCopyExternal=!0;if(td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Ag.a.RC&&516!==L.commandParameters.commandType&&1028!==L.commandParameters.commandType){var Ma=this.LLj(L.clipboardItems);
var rb=Ma.I0;if(Ma.returnValue)return L.isShadowWorkbookParsedSuccessfully=!0,this.MVi(L,rb)}return 516!==L.commandParameters.commandType&&36!==L.commandParameters.commandType?td.EwaSettings.ma(162)&&20!==L.commandParameters.commandType&&(null===this.$.shortcutKeyManager||this.$.shortcutKeyManager.Mfc)&&(rb=L.clipboardItems.getItem(Ec.html),void 0!==rb&&null!==rb&&rb&&rb.trim()!==this.VWc&&(rb.startsWith("<")||Ag.a.Nf&&rb.startsWith("\n<")))?(Ma=L.clipboardItems.getItem(Ec.Lqb),this.KVi(L,rb,void 0===
Ma?null:Ma)):this.eFf(L):Promise.reject(new ie.a(6))};Jb.prototype.MVi=function(L,Ma){dc.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");L.pasteResult="SystemClipboardShadowWorkbookPaste";L.payloadType=Mc.tO;L.payloadOrigin=hd.external;L.shadowWorkbookPayloadSize=uc(Ma);L.shadowWorkbookSizeExceedsLimit=kc(Ma);var rb=null,ec=null,fd=L.commandParameters.originalDestinations;td.EwaSettings.getBooleanFeatureGate(zf.a.R4b,
!1)?rb=$e.r(fd,this.$):ec=$e.v($e.K(fd),this.$);Ma.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(L.originalSourceRangesCountExceedsLimit=Ma.originalSourceRangesCountExceedsLimit);if(L.shadowWorkbookSizeExceedsLimit)return dc.ULS.sendTraceTag(537167833,0,15,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",L.shadowWorkbookPayloadSize,Ve.a.Lkc,Ma.shadowWorkbookSizeExceedsLimit),
Promise.reject(new ie.a(1));dc.ULS.sendTraceTag(537167832,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId={0}",L.commandParameters.id);return this.Vp.jFf(L.commandParameters.ribbonCommandInfo,ec,rb,Ma,[L.commandParameters.stopwatch],L)};Jb.prototype.eFf=function(L){var Ma=L.clipboardItems.getItem(Ec.yW);if(void 0!==Ma&&null!==Ma&&Ma.trim()===this.VWc)return Promise.reject(new ie.a(7));void 0!==Ma&&null!==Ma&&(L.plainTextPayloadSize=Ma.length);
L.isPlainTextPaste=!0;L.pasteResult="SystemClipboardPaste";L.payloadOrigin=ed(L)?hd.vjf:hd.external;L.payloadType=Mc.yW;dc.ULS.sendTraceTag(537167831,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id={0}, PasteOperationId={1}",L.id,L.commandParameters.id);Ma=this.Vp.T_i($e.K(L.commandParameters.originalDestinations),Ma,L.commandParameters.ribbonCommandInfo,[L.commandParameters.stopwatch],L);dc.ULS.sendTraceTag(537167830,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id={0}",
L.id);return Ma};Jb.prototype.KVi=function(L,Ma,rb){L.htmlPayloadSize=Ma.length;L.isHtmlPaste=!0;L.pasteResult="SystemClipboardHtmlPaste";L.payloadType=Mc.html;L.payloadOrigin=ed(L)?hd.vjf:hd.external;dc.ULS.sendTraceTag(42071711,0,50,"BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId={0}",L.commandParameters.id);return this.Vp.S_i($e.K(L.commandParameters.originalDestinations),Ma,rb,L.commandParameters.id,L.commandParameters.ribbonCommandInfo,[L.commandParameters.stopwatch],
L)};Jb.prototype.hEe=function(L){var Ma={};L&&(Ma.shadowWorkbookBase64=L.ShadowWorkbookBase64,Ma.shadowWorkbookSizeExceedsLimit=L.ShadowWorkbookSizeExceedsLimit,Ma.originalSourceRangesCountExceedsLimit=L.OriginalSourceRangesCountExceedsLimit,Ma.originalSourceRangesCount=L.OriginalSourceRangesCount,Ma.shadowWorkbookBlockedSize=L.ShadowWorkbookBlockedSize);return Ma};Jb.prototype.feg=function(L,Ma){var rb=pe(L),ec=32===(L.commandParameters.commandType&32),fd=1024===(L.commandParameters.commandType&
1024),yd=!1,be=null,xe=null,cf=!1;if(!rb){yd=-1985798686===L.commandParameters.ribbonCommandInfo.command;var ze=L.copyContextSnapshot;if(Ma)cf=!ze.sourceItem.isFromCurrentSession(this.$);else if(ze=this.Vp.Svb(ze))be=ze.ranges,xe=ze.sheetName,cf=!L.isSameSession}return this.Vp.AKg(xe,be,this.$.qa.sheetName,L.commandParameters.originalDestinations,L.commandParameters.expandDestinations,cf,ec,fd,yd,Ma,rb)};Ck.Object.defineProperties(Jb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},
VWc:{configurable:!0,enumerable:!0,get:function(){return this.Wm.Wa(5)}}});Object(nd.a)(Jb,"BaseCopyPasteHandler",null,[955,956,957]);$b.prototype.getValue=function(L){return this.key&&this.key.isEqual(L)?this.createClipboardItems(this.clipboardItems):null};$b.prototype.setValue=function(L,Ma){this.key=L;this.clipboardItems=this.createClipboardItems(Ma)};$b.prototype.createClipboardItems=function(L){var Ma=this.y$.create(),rb=L.getItem(Ec.yW);rb&&Ma.setItem(Ec.yW,rb);(rb=L.getItem(Ec.tO))&&Ma.setItem(Ec.tO,
rb);(L=L.getItem(Ec.html))&&Ma.setItem(Ec.html,L);return Ma};Object(nd.a)($b,"CopyCache",null,[]);var lh=b(71);Wl(Ha,Jb);Ha.prototype.getSourceItem=function(){var L=Bc.a.clone(this.gridView.ha.ta.selectedRanges);return new wb(this.$,L,this.$.ea.qa.sheetName,this.$.ea.Te,this.$.ya.UserSessionId)};Ha.prototype.beforeSerialize=function(L){var Ma=this;L.isSelectionAllowed=!1;L.isAsyncCopy=!1;L.isFromCache=!1;L.encounteredDeploymentErrors=!1;L.plainTextPayloadSize=0;L.shadowWorkbookPayloadSize=0;L.htmlPayloadSize=
0;L.clientSideCopyTime=0;var rb=new Ad.a(this.$.xa),ec=L.sourceItem;L.isSelectionAllowed=Bc.a.all(ec.ranges,function(fd){return Ma.isSelectionAllowed(rb,fd)});L.isSelectionAllowed&&this.Vp.u7e(ec.ranges,L.commandParameters.commandType)};Ha.prototype.xMa=function(L){return this.gridView.Ea.$Z()&&ae.i(this.gridView,L)};Ha.prototype.gWi=function(L,Ma,rb,ec){var fd=!1,yd=1===Ma.commandParameters.commandType,be=ec[0].eM;1===rb.ranges.length&&1===ec.length?td.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests1")&&
yd&&1!==be&&be!==rb.ranges[0].eM?L.cseStatus=17:fd=this.X2g.v6c(L,$e.K(rb.ranges),rb.sheetName,$e.K(L.commandParameters.expandDestinations),this.$.ea.qa.sheetName,yd):L.cseStatus=5;fd&&ae.g(this.$).Ii.N0(L.commandParameters.stopwatch.id,lh.BasicTelemetryCalculator.aR);return this.SVi(L,rb,$e.u(this.$.qa.sheetName,null,ec),Ma.commandParameters.commandType,fd)};Ha.prototype.isSelectionAllowed=function(L,Ma){return L.aAb(Ma,this.gridView)};Ha.prototype.SVi=function(L,Ma,rb,ec,fd){Ma=$e.u(Ma.sheetName,
null,Ma.ranges);L.pasteResult="SameSessionPaste";L.payloadOrigin=hd.gUf;L.payloadType=Mc.gzg;dc.ULS.sendTraceTag(537167829,0,50,"BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId={0}",L.commandParameters.id);return this.Vp.pasteRange(L.commandParameters.ribbonCommandInfo,Ma,rb,ec,L.commandParameters.commandType,[L.commandParameters.stopwatch],L,fd,null,null)};Object(nd.a)(Ha,"BaseRangeCopyPasteHandler",Jb,[]);var Eg=b(35);lb.prototype.onDeferredPasteStarted=
function(L){this.PU.yb(L.id)||this.PU.add(L.id,!0);if(0<this.PU.count){var Ma=Ob.GetServiceTaskFactory.Xa(this.$.da,5,4,0);Pd.TaskExtensions.Ba(Ma,function(){Ma.result.fg(28,null)},this.$.la,3)}};lb.prototype.onDeferredPasteCompleted=function(L){var Ma=0<this.PU.count;this.PU.yb(L.id)&&this.PU.remove(L.id);if(Ma&&!this.PU.count){var rb=Ob.GetServiceTaskFactory.Xa(this.$.da,5,4,0);Pd.TaskExtensions.Ba(rb,function(){rb.result.removeEntry(28)},this.$.la,3)}};Object(nd.a)(lb,"DeferredPasteTracker",null,
[]);var Vf;(function(L){L[L.none=0]="none";L[L.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";L[L.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";L[L.asyncCopyCanceled=3]="asyncCopyCanceled";L[L.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})(Vf||(Vf={}));Object(nd.b)("CopyErrorType",Vf);var ve=b(1129),Rg=b(1279),hh=ve.a;Wl(cb,hh);Object(nd.a)(cb,"CopyInnerError",ve.a,[]);Wl(Qa,Ha);Qa.prototype.serialize=function(L){var Ma=L.sourceItem,
rb={},ec=this.w2c.getValue(Ma);if(ec)rb.synchronousResult=ec,L.isFromCache=!0,L.clientSideCopyTime=L.commandParameters.stopwatch.Bc;else{var fd=null,yd=$e.F(Ma.ranges);if(!Lc.a.fdf()&&this.xMa(yd)){dc.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");yd=this.clipboardRangeFactory.create(yd);try{fd=yd.toString(),ec=this.y$.create(),ec.setItem(Ec.yW,fd),this.w2c.setValue(Ma,ec),rb.synchronousResult=ec,L.clientSideCopyTime=
L.commandParameters.stopwatch.Bc}finally{yd&&yd.dispose()}}else L.isAsyncCopy=!0,rb.synchronousResult=this.y$.create(),rb.synchronousResult.setItem(Ec.yW,this.VWc);rb.asynchronousResult=this.$cd(L,Ma,fd)}L.syncClipboardItemsKeys=Tc(rb.synchronousResult);return rb};Qa.prototype.shouldWaitForCopyToComplete=function(L){if(!L||!L.copyContextSnapshot)return dc.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),
!1;dc.ULS.shipAssertTag(537167906,0,!!this.$.ya,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(L.copyContextSnapshot.sessionId===this.$.ya.UserSessionId)return dc.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;dc.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};
Qa.prototype.onDeferredPasteStarted=function(L){this.PU.onDeferredPasteStarted(L)};Qa.prototype.onDeferredPasteCompleted=function(L){this.PU.onDeferredPasteCompleted(L)};Qa.prototype.deserialize=function(L){L.isClipboardDataContainShadowWorkbook=!(void 0===L.clipboardItems.getItem(Ec.tO)||null===L.clipboardItems.getItem(Ec.tO));if(ae.g(this.$).ha.We&326)return pe(L)&&(L.wasLastCopyExternal=!0),Promise.reject(new ie.a(17));var Ma=this.feg(L,!1);if(0!==Ma)return Promise.reject(new ie.a(pe(L)?18:L.isSameSession?
19:20,void 0,void 0,void 0,Ma));var rb=L.copyContextSnapshot,ec=this.Vp.Svb(rb);if(pe(L))return this.wpc(L);Ma=L.commandParameters.originalDestinations;if(ec&&L.isSameSession)return this.gWi(L,rb,ec,Ma);if(516!==L.commandParameters.commandType){ec=this.KLj(L.clipboardItems);rb=ec.I0;if(ec.returnValue){L.isShadowWorkbookParsedSuccessfully=!0;var fd=ec=null;td.EwaSettings.getBooleanFeatureGate(zf.a.R4b,!1)?ec=$e.r(Ma,this.$):fd=$e.v($e.K(Ma),this.$);return this.IVi(L,fd,ec,rb)}if(L.isClipboardInaccessible)return Promise.reject(new ie.a(8));
if(36!==L.commandParameters.commandType)return this.eFf(L)}return Promise.reject(new ie.a(6))};Qa.prototype.beforePaste=function(L){this.$.da.za(373).Pij(L);L.indicationDisplayScheduled=!0};Qa.prototype.fLj=function(L){if(!(L&&L.SourceRanges&&L.SourceRanges.Ranges&&L.SourceRanges.Ranges.length&&(L.OriginalSourceRangesCountExceedsLimit||L.OriginalSourceMultiRange&&L.OriginalSourceMultiRange.Ranges&&L.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,I0:null};var Ma=L.SourceRanges.Ranges[0];
if(!L.ShadowWorkbookBase64&&!L.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,I0:null};var rb=this.hEe(L);rb.rangeRowStart=Ma.FirstRow;rb.rangeRowEnd=Ma.LastRow;rb.rangeColumnStart=Ma.FirstColumn;rb.rangeColumnEnd=Ma.LastColumn;rb.sourceClientPath=L.SourceClientPath;rb.sourceSheetName=L.SourceSheetName;rb.sourceWorkbookName=L.SourceWorkbookName;if(!L.OriginalSourceRangesCountExceedsLimit)for(L=L.OriginalSourceMultiRange.Ranges,rb.originalSourceRanges=Array(L.length),Ma=0;Ma<L.length;++Ma)rb.originalSourceRanges[Ma]=
[L[Ma].FirstRow,L[Ma].FirstColumn,L[Ma].LastRow,L[Ma].LastColumn];return{returnValue:!0,I0:rb}};Qa.prototype.KLj=function(L){var Ma=null;L=L.getItem(Ec.tO);if(!L)return{returnValue:!1,I0:Ma};Ma=JSON.parse(L);return{returnValue:this.$mi(Ma),I0:Ma}};Qa.prototype.$mi=function(L){return!!L&&(!!L.shadowWorkbookBase64||L.shadowWorkbookSizeExceedsLimit)&&void 0!==L.rangeRowStart&&void 0!==L.rangeRowEnd&&void 0!==L.rangeColumnStart&&void 0!==L.rangeColumnEnd};Qa.prototype.IVi=function(L,Ma,rb,ec){dc.ULS.shipAssertTag(537167903,
0,!!ec,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");Gd.AFrameworkApplication.gN("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions");L.pasteResult="CrossSessionPaste";L.payloadOrigin=hd.KEe;L.payloadType=Mc.tO;L.shadowWorkbookPayloadSize=uc(ec);L.shadowWorkbookSizeExceedsLimit=kc(ec);ec.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(L.originalSourceRangesCountExceedsLimit=ec.originalSourceRangesCountExceedsLimit);
if(L.shadowWorkbookSizeExceedsLimit)return dc.ULS.sendTraceTag(34415003,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",L.shadowWorkbookPayloadSize,Ve.a.Lkc,ec.shadowWorkbookSizeExceedsLimit),Promise.reject(new ie.a(1));if(1028===L.commandParameters.commandType&&L.originalSourceRangesCountExceedsLimit)return dc.ULS.sendTraceTag(572617859,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count({0}) is over the limit({1}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: {2}",
ec.originalSourceRangesCount,Ve.a.zxi,ec.originalSourceRangesCountExceedsLimit),Promise.reject(new ie.a(1));dc.ULS.sendTraceTag(537167902,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId={0}",L.commandParameters.id);return this.Vp.jFf(L.commandParameters.ribbonCommandInfo,Ma,rb,ec,[L.commandParameters.stopwatch],L)};Qa.prototype.$cd=function(L,Ma,rb){var ec=this;dc.ULS.shipAssertTag(537167901,0,!!L,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");
var fd=L.commandParameters.stopwatch.Bc;return new Promise(function(yd,be){dc.ULS.sendTraceTag(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: {0}",L.id);var xe=$e.u(Ma.sheetName,null,Ma.ranges);ec.Vp.copy(xe,L.commandParameters,function(cf){L.requestTelemetryData=cf.RequestTelemetryData;L.serverRequestTimeInMs=L.commandParameters.stopwatch.Bc-fd;if(Se.a.oh(cf.Errors))Se.a.aha(cf.Errors)?(L.encounteredDeploymentErrors=
!0,dc.ULS.sendTraceTag(537167898,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}. copy Id: {1}",Se.a.Tc(cf.Errors),L.id)):(dc.ULS.sendTraceTag(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",Se.a.Tc(cf.Errors),L.id),be(new cb(2,cf.Errors)));else if(dc.ULS.sendTraceTag(537167900,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: {0}",
L.id),L.markForCancellation)be(new cb(3,cf.Errors));else{cf=cf.Result;var ze=cf.PlainTextResult;void 0!==rb&&null!==rb&&(ze=rb);void 0!==ze&&null!==ze&&(L.plainTextPayloadSize=ze.length);var Yf=ec.y$.create(),Sg=ec.fLj(cf);var eg=Sg.I0;Sg.returnValue&&(L.shadowWorkbookPayloadSize=uc(eg),L.shadowWorkbookSizeExceedsLimit=kc(eg),L.originalSourceRangesCountExceedsLimit=cf.OriginalSourceRangesCountExceedsLimit,eg=JSON.stringify(eg),Yf.setItem(Ec.tO,eg));Yf.setItem(Ec.yW,ze);Lc.a.fdf()&&(ze=cf.HtmlResult,
L.htmlSizeExceedsLimit=cf.HtmlSizeExceedsLimit,void 0!==ze&&null!==ze&&(L.htmlPayloadSize=ze.length),Yf.setItem(Ec.html,ze));L.copyTotalSizeExceedsLimit=cf.CopyTotalSizeExceedsLimit;Yf.setItem(Ec.Lqb,L.commandParameters.id);ec.w2c.setValue(Ma,Yf);L.asyncClipboardItemsKeys=Tc(Yf);yd(Yf)}},function(cf){L.serverRequestTimeInMs=L.commandParameters.stopwatch.Bc-fd;cf=Yg.a.ig(cf.data);dc.ULS.sendTraceTag(537167897,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",
Se.a.Tc(cf),L.id);be(new cb(2,cf))},[L.commandParameters.stopwatch])})};Object(nd.a)(Qa,"AcrossSessionRangeCopyPasteHandler",Ha,[]);Object(nd.a)(Ib,"CopyArtRequest",null,[]);Object(nd.a)(yb,"PasteArtRequest",null,[]);Xa.prototype.A2h=function(L){if(this.fji(L.INa)){dc.ULS.sendTraceTag(537167681,5,50,"PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: {0}",L.INa);var Ma=this.tIb.oa(L.INa);this.tIb.ia(L.INa,L);var rb=Ma.promise;Ma.vdf=!1;return this.akh(L,
rb)}this.tIb.ia(L.INa,L);return this.Upi(L)};Xa.prototype.fji=function(L){return this.tIb.yb(L)};Xa.prototype.Upi=function(L){var Ma=this;return new Promise(function(rb,ec){L.promise=Ma.jZa.dFf(L).then(function(fd){rb(null);return Ma.Rnc(L,fd)},function(fd){ec(null);return Ma.EEb(fd)})})};Xa.prototype.akh=function(L,Ma){var rb=this;return new Promise(function(ec,fd){L.promise=Ma.then(function(yd){rb.NQj(L,yd);return rb.jZa.dFf(L).then(function(be){ec(null);return rb.Rnc(L,be)},function(be){fd(null);
return rb.EEb(be)})},function(yd){return rb.EEb(yd)})})};Xa.prototype.Rnc=function(L,Ma){L.vdf&&(this.AXg(L.INa),this.CMd(L,Ma));return this.s0i(Ma)};Xa.prototype.AXg=function(L){this.tIb.remove(L)};Xa.prototype.CMd=function(L,Ma){var rb=this.EVh();L.INa===rb&&this.jZa.CMd(L.destination,Ma,L.item.type)};Xa.prototype.EVh=function(){var L=ae.g(this.$).ha.Oa.activeFloatingObjectControlId;L||(L=$e.v(ae.g(this.$).ha.ta.activeCell,this.$),L=L.FirstRow+"_"+L.FirstColumn);return L};Xa.prototype.NQj=function(L,
Ma){L.destination=null;L.LGe=Ma};Object(nd.a)(Xa,"PasteArtRequestManager",null,[]);var ff=b(191),Ih=b(122),Eh=b(104);Wl(bb,Jb);bb.prototype.getSourceItem=function(){dc.ULS.shipAssertTag(537167896,0,!!this.ha.Oa.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");dc.ULS.sendTraceTag(537167895,0,50,"ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[{0}]",this.ha.Oa.activeFloatingObjectControlId);return new lf(this.ha.Oa.activeFloatingObjectControlId,
this.$.ea.qa.sheetName,this.$.ea.Te,this.$.ya.UserSessionId,this.ha.Oa.nc.floatingObject.type)};bb.prototype.beforeSerialize=function(L){L&&L.commandParameters?(L?(L.isAsyncCopy=!1,L.isSelectionAllowed=!1,L.isFromCache=!1,L.plainTextPayloadSize=0,L.shadowWorkbookPayloadSize=0,L.htmlPayloadSize=0,L.htmlSizeExceedsLimit=!1,L.clientSideCopyTime=0,L.encounteredDeploymentErrors=!1,L.shadowWorkbookSizeExceedsLimit=!1,L.originalSourceRangesCountExceedsLimit=!1,L.copyTotalSizeExceedsLimit=!1):dc.ULS.sendTraceTag(537167826,
0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),L.commandParameters.copyPasteTargetType=2):dc.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")};bb.prototype.serialize=function(L){var Ma=L.sourceItem,rb={};if(!Ma)return dc.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),rb;if(!this.Pli())return dc.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),
rb;dc.ULS.sendTraceTag(537167892,0,50,"ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[{0}]",Ma.activeFloatingObjectControlId);this.ODd();var ec=this.v2c.getValue(Ma);if(ec)rb.synchronousResult=ec,L.isFromCache=!0,L.isAsyncCopy=!1,L.clientSideCopyTime=L.commandParameters.stopwatch.Bc,1===L.commandParameters.commandType&&this.$.Ud(2045211913,L.commandParameters.ribbonCommandInfo.method,L.commandParameters.ribbonCommandInfo.Ze,null);else{L.isFromCache=!1;L.isAsyncCopy=
!0;ec=this.y$.create();if(L.commandParameters.uploadToClipService){var fd={};fd["data-clipservice-ccpid"]=L.commandParameters.id;fd["data-pkey"]=L.commandParameters.pKey;fd["data-clipservice-type"]=L.commandParameters.clipServiceDataType;fd["data-clipservice-count"]=L.commandParameters.objectCount.toString();fd["data-clipservice-dc"]=L.commandParameters.clipServiceDataCenter;fd["data-clipservice-client"]=this.wYg;fd["data-TimeStamp"]=(new Date).toUTCString();fd["data-clipservice-version"]=this.xYg;
ec.setItem(Ec.oHg,JSON.stringify(fd))}rb.synchronousResult=this.MAg(ec);rb.asynchronousResult=this.$cd(L,Ma,ec)}L.syncClipboardItemsKeys=Tc(rb.synchronousResult);return rb};bb.prototype.MAg=function(L){dc.ULS.shipAssertTag(537167891,0,!!this.ha.Oa.nc,"Expecting a floating object to be currently selected for copy");L||(L=this.y$.create());var Ma=this.ha.Oa.nc.qub();Ma&&(Ma=String.format("<img src='{0}'>",Ma),L.setItem(Ec.html,Ma));return L};bb.prototype.ODd=function(){var L=this.ha.Oa.nc;this.aob.ODd(Ih.a.bqb(L.floatingObject),
Ih.a.zYg(L.Yt))};bb.prototype.shouldWaitForCopyToComplete=function(){dc.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};bb.prototype.onDeferredPasteStarted=function(L){this.PU.onDeferredPasteStarted(L)};bb.prototype.onDeferredPasteCompleted=function(L){this.PU.onDeferredPasteCompleted(L)};bb.prototype.deserialize=function(L){var Ma=pe(L),rb=null,ec=null,fd=!1;if(!Ma){rb=L.copyContextSnapshot;ec=rb.sourceItem;if(!ec)return Promise.reject(new ie.a(10));
fd=ec.isFromCurrentSession(this.$)}var yd=this.feg(L,!0);if(0!==yd)return Promise.reject(new ie.a(Ma?18:fd?19:20,void 0,void 0,void 0,yd));if(Ma)return this.wpc(L);if(!fd&&!bb.$ei(ec))return L=String.format("User attempted to paste art of type [{0}] between sessions.",ec.type),dc.ULS.sendTraceTag(537167889,0,50,L),Promise.reject(new ie.a(11,void 0,void 0,L));if(rb.isAsyncSerializeFailed)return Promise.reject(new ie.a(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));
try{var be=L.clipboardItems.getItem(Ec.tO);var xe=JSON.parse(be)}catch(cf){return dc.ULS.sendTraceTag(537167888,0,10,"ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: {0}",copyPasteInfra.getStringifiedError(cf)),Promise.reject(new ie.a(12,void 0,cf))}xe.floatingObjectId!==ec.activeFloatingObjectControlId?dc.ULS.sendTraceTag(537167887,0,10,"ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",
ec.activeFloatingObjectControlId,xe.floatingObjectId):dc.ULS.sendTraceTag(537167886,0,50,"ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",ec.activeFloatingObjectControlId,xe.floatingObjectId);if(!xe||!xe.shadowWorkbookBase64)return Promise.reject(new ie.a(13,void 0,void 0,String.format("shadowWorkbookPayload is null = {0}",!xe)));L.isShadowWorkbookParsedSuccessfully=!0;L.shadowWorkbookPayloadSize=
uc(xe);L.shadowWorkbookSizeExceedsLimit=kc(xe);L.payloadOrigin=fd?hd.gUf:hd.KEe;L.payloadType=Mc.Nhg;if(kc(xe))return L=String.format("Shadow workbook size [{0}] is over the limit [{1}]. ShadowWorkbookSizeExceedsLimit: {2}",L.shadowWorkbookPayloadSize,Ve.a.Lkc,xe.shadowWorkbookSizeExceedsLimit),dc.ULS.sendTraceTag(36304156,0,15,"ArtCopyPasteHandler.Deserialize: {0}",L),Promise.reject(new ie.a(1,void 0,void 0,L));rb=Ma=null;ae.g(this.$).ha.We&326?rb=ae.g(this.$).ha.Oa.activeFloatingObjectControlId:
Ma=this.$.qa&&this.$.qa.activeCell?$e.v(this.$.qa.activeCell,this.$):$e.v($e.K(L.commandParameters.originalDestinations),this.$);fd=null;if(this.aob.k1f(ec))try{fd=this.aob.v6c()}catch(cf){dc.ULS.sendTraceTag(537167885,0,10,"ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: {0}",copyPasteInfra.getStringifiedError(cf))}return this.JVi.A2h(new yb(L.commandParameters.ribbonCommandInfo,Ma,rb,L.commandParameters.commandType,[L.commandParameters.stopwatch],
xe,ec,L,fd))};bb.prototype.wpc=function(L){L.wasLastCopyExternal=!0;if(L.clipboardItems.getItem("image/png")){var Ma=L.commandParameters.stopwatch.Bc;L.payloadType=Mc.zNg;var rb={};return me.b(this.$.Ud(1403967063,L.commandParameters.ribbonCommandInfo.method,L.commandParameters.ribbonCommandInfo.Ze,(rb.dataUrl=L.clipboardItems.getItem("image/png"),rb))).then(function(ec){L.serverRequestTimeInMs=L.commandParameters.stopwatch.Bc-Ma;return ec?Promise.resolve(null):Promise.reject(new ie.a(15))},function(){L.serverRequestTimeInMs=
L.commandParameters.stopwatch.Bc-Ma;return Promise.reject(new ie.a(15))})}dc.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return Jb.prototype.wpc.call(this,L)};bb.prototype.Pli=function(){var L=ae.g(this.$).ha;return L.Oa.activeFloatingObjectControlId&&L.Oa.nc&&L.Oa.nc.floatingObject?L.Oa.nc.floatingObject.PTd():!1};bb.prototype.$cd=function(L,Ma,rb){var ec=this;return new Promise(function(fd,yd){var be=L.commandParameters.stopwatch.Bc;
dc.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");ec.jZa.P2g(new Ib(Ma.activeFloatingObjectControlId,L.commandParameters,function(xe){L.requestTelemetryData=xe.RequestTelemetryData;L.serverRequestTimeInMs=L.commandParameters.stopwatch.Bc-be;if(Se.a.oh(xe.Errors))Se.a.aha(xe.Errors)?(L.encounteredDeploymentErrors=!0,dc.ULS.sendTraceTag(537167879,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",
Se.a.Tc(xe.Errors))):(dc.ULS.sendTraceTag(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",Se.a.Tc(xe.Errors)),yd(new cb(4,xe.Errors)));else if(dc.ULS.sendTraceTag(537167883,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[{0}].",Ma.activeFloatingObjectControlId),L.markForCancellation)yd(new cb(3,xe.Errors));else{Se.a.mr(xe.Errors)&&dc.ULS.sendTraceTag(537167882,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: {0}",
Se.a.Tc(xe.Errors));var cf=xe.Result;if(cf){cf=ec.hEe(cf);cf.floatingObjectId=Ma.activeFloatingObjectControlId;L.shadowWorkbookPayloadSize=uc(cf);L.shadowWorkbookSizeExceedsLimit=kc(cf);try{var ze=JSON.stringify(cf)}catch(Yf){yd(new ie.a(14,void 0,Yf,String.format("Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [{0}], shadowWorkbookPayload.FloatingObjectId: [{1}]",L.shadowWorkbookPayloadSize,cf.floatingObjectId)));return}dc.ULS.shipAssertTag(537167881,0,!!rb,"Expecting syncClipboardItems to be defined");
rb.setItem(Ec.tO,ze);1===L.commandParameters.commandType&&(ec.YYi(Ma.type,Ma.activeFloatingObjectControlId,xe.StateId),ec.deleteFloatingObject(Ma.activeFloatingObjectControlId,Ma.type));ec.v2c.setValue(Ma,rb);L.asyncClipboardItemsKeys=Tc(rb);fd(rb)}else dc.ULS.sendTraceTag(537167880,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: {0}",Ma.activeFloatingObjectControlId),fd(ec.v2c.getValue(Ma))}},L.commandParameters.commandType,Ma.type,function(xe){L.serverRequestTimeInMs=
L.commandParameters.stopwatch.Bc-be;xe=Yg.a.ig(xe.data);1===L.commandParameters.commandType&&ec.jZa.JMj(Ma.type,Ma.activeFloatingObjectControlId);dc.ULS.sendTraceTag(537167878,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",Se.a.Tc(xe));yd(new cb(4,xe))},[L.commandParameters.stopwatch]))})};bb.prototype.deleteFloatingObject=function(L,Ma){L=ff.a.jz(Ma,L);if(L=Eh.a(this.$).Hq(L))Eh.a(this.$).deleteFloatingObject(L,14,!0),ae.g(this.$).ha.Oa.wC=null};bb.prototype.YYi=
function(L,Ma,rb){var ec=this.$.da.za(277);if(ec){var fd=null;L=ff.a.jz(L,Ma);L=Eh.a(this.$).Hq(L);if(null===L||void 0===L?0:L.Xi)fd=L.Xi.block;if(fd){var yd=L.floatingObject.Tg();ec.FYb(function(){return!fd.Zi.yb(yd)},rb,"CutArt")}}};bb.$ei=function(L){return 1===L.type||5===L.type};Object(nd.a)(bb,"ArtCopyPasteHandler",Jb,[]);var Xf=b(55);Wl(Ua,Qc);Object(nd.a)(Ua,"MacroRecorderPasteArtPayload",Qc,[]);ja.prototype.T7h=function(L,Ma,rb,ec,fd,yd,be){var xe=this;yd=void 0===yd?null:yd;be=void 0===
be?null:be;var cf=this.$.na.va.hc(),ze=null,Yf={CopyPasteTargetType:2};Yf.FloatingObjectId=L;Yf.CopyOperationId=rb.id;rb.floatingObjectType=Ma;Yf.UploadToClipService=rb.uploadToClipService;Yf.PKey=rb.pKey;Yf.ClipServiceDataCenter=rb.clipServiceDataCenter;var Sg=0;2===fd?(fd=505,Sg=16,ze=function(eg,Pg,Vh){return Qd(xe.$.na.va,Yf,Sf.b(eg,ec),yd?Sf.a(Pg,yd):Pg,Vh,rb.ribbonCommandInfo,cf,be)}):(fd=179,ze=function(eg,Pg,Vh){xe.egh(Ma,L);xe.$.By();var fe=xe.$.na.va;eg=Sf.b(eg,ec);Pg=yd?Sf.a(Pg,yd):Pg;
var af=rb.ribbonCommandInfo,zh=be;zh=void 0===zh?null:zh;var yi=fe.Na(1,void 0===cf?null:cf);yi.copyParameters=Yf;return oc.i(fe,"Cut",yi,eg,Pg,Vh,af,0,zh)});td.EwaSettings.qc()?this.$.userOperationManager.jc(new Wd.a(fd,0,ze,Sg|64),rb.ribbonCommandInfo):this.$.userOperationManager.jc(new bf.a(fd,0,ze,Sg),rb.ribbonCommandInfo)};ja.prototype.egh=function(L,Ma){var rb=ff.a.jz(L,Ma);(rb=Eh.a(this.$).Hq(rb))?(ae.g(this.$).ha.Oa.ZG(rb),rb.isVisible=!1):dc.ULS.sendTraceTag(537167876,0,50,"ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : {0}, FloatingObjectId: {1}",
L,Ma)};ja.prototype.JMj=function(L,Ma){L=ff.a.jz(L,Ma);if(L=Eh.a(this.$).Hq(L))L.isVisible=!0};ja.prototype.P2g=function(L){this.T7h(L.floatingObjectId,L.N2g,L.commandParameters,L.yt,L.mah,L.qaa,L.sOb)};ja.prototype.s8h=function(L,Ma,rb,ec,fd,yd,be,xe,cf){var ze=this;xe=void 0===xe?null:xe;cf=void 0===cf?!0:cf;return new Promise(function(Yf,Sg){var eg=yd.commandParameters.stopwatch.Bc;ze.ZMd(L,fd,Ma,rb,function(Pg){yd.requestTelemetryData=Pg.RequestTelemetryData;yd.serverRequestTimeInMs=yd.commandParameters.stopwatch.Bc-
eg;if(Se.a.aha(Pg.Errors))yd&&(yd.encounteredDeploymentErrors=!0),dc.ULS.sendTraceTag(537167875,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",Se.a.Tc(Pg.Errors));else if(Se.a.oh(Pg.Errors))dc.ULS.sendTraceTag(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",Se.a.Tc(Pg.Errors)),Sg(new ie.a(9,Pg.Errors));else if(Pg.Result){var Vh=Pg.Result;dc.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded.");
ze.mZi(be,Vh.FloatingObjectId,Pg.StateId);Yf(ja.ukd(Vh.FloatingObjectId))}else dc.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),Sg(new ie.a(9,Pg.Errors))},function(Pg){yd.serverRequestTimeInMs=yd.commandParameters.stopwatch.Bc-eg;Pg=Yg.a.ig(Pg.data);dc.ULS.sendTraceTag(537167872,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",Se.a.Tc(Pg));Sg(new ie.a(9,Pg))},ec,xe,cf)})};ja.prototype.mZi=function(L,Ma,rb){var ec=
this,fd=this.$.da.za(277);if(fd){var yd=ff.a.jz(L,ja.ukd(Ma));fd.FYb(function(){return!!Eh.a(ec.$).Hq(yd)},rb,"PasteArt")}};ja.prototype.ZWd=function(L,Ma){Ma&&this.aob.ZWd(L,ff.a.jz(L.type,Ma))};ja.prototype.dFf=function(L){var Ma=this;return this.s8h(L.ribbonCommandInfo,L.destination,L.LGe,L.sOb,L.I0,L.pasteContext,L.item.type,L.vye,L.item.isFromCurrentSession(this.$)).then(function(rb){return rb},function(rb){Ma.ZWd(L.item,L.vye);return Promise.reject(rb)})};ja.prototype.CMd=function(L,Ma,rb){L||
(L=$e.v(ae.g(this.$).ha.ta.activeCell,this.$));ae.g(this.$).uhc($e.D(L),1)?Eh.a(this.$).rna(rb,Ma,!0):ae.g(this.$).ha.Oa.Psa(L,Ma,rb).continueWith(function(ec){ec.result?dc.ULS.sendTraceTag(537167843,5,50,"ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [{0}]",Ma):dc.ULS.sendTraceTag(537167842,5,10,"ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [{0}]",Ma)})};ja.prototype.ZMd=function(L,Ma,rb,ec,fd,yd,be,xe,cf){function ze(){if(cf){var Vh=
Xf.a.ni(Xf.a.Jc(Pg));Vh.FloatingObjectId=Ma.floatingObjectId;Pg.DestinationRanges||(Vh.DestinationRanges=$e.p(Sg.$.xa.qa.sheetName,"",0,0,0,0));return new Ua(Vh,cf,0,0)}return new Ua(Pg,cf,0,0)}function Yf(Vh,fe,af){xe||Sg.$.By();return bd(Sg.$.na.va,Pg,Sf.b(Vh,fd),Sf.a(fe,yd),af,null,eg,be)}var Sg=this;cf=void 0===cf?!0:cf;var eg=this.$.na.va.hc(),Pg={};Pg.ShadowWorkbookBase64=Ma.shadowWorkbookBase64;Pg.FloatingObjectId=ec;Pg.DestinationRanges=rb?$e.s(rb):null;Pg.CopyPasteTargetType=2;Pg.ClientEstimationFloatingObjectId=
xe;rb=td.EwaSettings.qc()?new Wd.a(503,0,Yf,void 0,ze):new bf.a(503,0,Yf,void 0,ze);rb.flags=td.EwaSettings.qc()?65:1;this.$.userOperationManager.jc(rb,L)};ja.ukd=function(L){return String.format("{0}.{{{1}}}",L.length+2,L.toUpperCase())};Object(nd.a)(ja,"ArtCopyPasteUtils",null,[926]);var jj=b(249);wa.prototype.ODd=function(L,Ma){this.lta=L;this.t2c=Ma};wa.prototype.v6c=function(){if(!this.lta||!this.t2c)return dc.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),
"";var L=Ih.a.bqb(new ff.a(this.lta));L.Id=ja.ukd(Lg.a.create().toString());L.Version=-1;L.Name="";L.IsClientEstimation=!0;var Ma=this.H9h(L);if(!Ma)return null;var rb=new ff.a(L);Ma.block.Zi.add(rb);rb.yIb();var ec=Eh.a(this.$);ec.g4b(rb,Ma);Ma=ec.Hq(ff.a.GOh(L));!Ma||Ma.floatingObject.fMa||Ma.floatingObject.DMa||Ma.kRa(this.t2c);ec.rna(L.Type,L.Id,!0);return L.Id};wa.prototype.k1f=function(L){return td.EwaSettings.ma(223)&&L.isFromCurrentSession(this.$)&&!ae.g(this.$).rtl&&!ae.g(this.$).rb.$i};
wa.prototype.ZWd=function(L,Ma){this.k1f(L)&&(L=Eh.a(this.$).Hq(Ma))&&(dc.ULS.sendTraceTag(537167840,5,50,"ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [{0}] of type [{1}]",Ma,L.floatingObject.type),Eh.a(this.$).deleteFloatingObject(L,15,!0),L.Xi&&L.Oab(L.Xi,!1))};wa.prototype.H9h=function(L){if(!L)return dc.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),
null;if(ae.g(this.$).ha.Oa.activeFloatingObjectControlId){var Ma=ae.g(this.$).ha.Oa.wC.floatingObject;L.OriginDeltaX=Ma.offsetX+this.r$a;L.OriginDeltaY=Ma.offsetY+this.r$a;L.AbsoluteLeft+=this.r$a;L.AbsoluteTop+=this.r$a;L.AbsoluteRight+=this.r$a;L.AbsoluteBottom+=this.r$a;L.ZOrder=Ma.Ly+1;return ae.g(this.$).ha.Oa.wC.Xi}if(!this.$.qa||!this.$.qa.activeCell)return dc.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),
null;var rb=this.$.qa.activeCell;Ma=ae.g(this.$).k1(rb);if(!Ma)return dc.ULS.sendTraceTag(537167837,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range {0} is null.",rb.toString()),null;var ec=Oe.HelperMethods.Dvb(Ma.domElement,Ma.yj.domElement);rb=Ma.gridView.tg(rb,2);if(!ec||!rb)return dc.ULS.sendTraceTag(537167836,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: {0}. cellPositionRelativeToGridOrigin is null: {1} .",
!ec,!rb),null;L.OriginDeltaX=rb.topLeft.x-ec.x;L.OriginDeltaY=rb.topLeft.y-ec.y;L.AbsoluteLeft=rb.topLeft.x;L.AbsoluteTop=rb.topLeft.y;L.AbsoluteRight=L.AbsoluteLeft+Math.abs(this.lta.AbsoluteRight-this.lta.AbsoluteLeft);L.AbsoluteBottom=L.AbsoluteTop+Math.abs(this.lta.AbsoluteBottom-this.lta.AbsoluteTop);L.ZOrder=this.lta.ZOrder+100;return new jj.a(Ma.gridView.Ea.ul(Ma.hashCode),Ma.hashCode)};Object(nd.a)(wa,"ArtPasteClientEstimation",null,[924]);Za.prototype.create=function(){var L=window.clipboardPlatform;
return L?L.createClipboardItems():null};Object(nd.a)(Za,"ClipboardItemsFactory",null,[925]);ub.undefined="Undefined";Object(nd.a)(ub,"CCPTelemetryConsts",null,[]);ad.cells="Cells";ad.floatingObject="FloatingObject";ad.unknown="Unknown";Object(nd.a)(ad,"ActiveSelection",null,[]);vc.rfh="DisplayNotInvoked";vc.n6c="Displayed";vc.xZi="PrerequisitesNotReady";Object(nd.a)(vc,"PasteIndicationDisplayStatus",null,[]);var Yh=b(110);zb.prototype.getCopyFlowHandler=function(L){var Ma=this.CKh(ae.g(this.$).We);
L.commandParameters.copyPasteHandlerName=Ma.name;return Ma};zb.prototype.getPasteFlowHandler=function(L){var Ma=L.copyContextSnapshot;Ma=Nd(L)?this.QWc:pe(L)?this.PFd:(null===Ma||void 0===Ma?0:Ma.sourceItem)&&Object.getType(Ma.sourceItem)===lf?this.QWc:this.PFd;L.commandParameters.copyPasteHandlerName=Ma.name;return Ma};zb.prototype.initializePasteContext=function(L){if(L&&(L.isSameSession=!1,L.isShadowWorkbookParsedSuccessfully=!1,L.pasteResult=ub.undefined,L.payloadOrigin=ub.undefined,L.payloadType=
ub.undefined,L.encounteredDeploymentErrors=!1,L.shadowWorkbookSizeExceedsLimit=!1,L.originalSourceRangesCountExceedsLimit=!1,L.activeSelectionType=this.uGh(),L.indicationDisplayScheduled=!1,L.pasteDestinationHasMergedCells=!1,L.pasteIndicationDisplayStatus=vc.rfh,L.copyContextSnapshot)){var Ma=L.copyContextSnapshot,rb=Dd(Ma.sourceItem),ec=Ma.sourceItem;var fd=!!ec&&Object.getType(ec)===lf;ec=0;var yd=!1;rb?(yd=Ma.sourceItem,L.isSameSession=yd.isFromCurrentSession(this.$),ec=1,yd=this.gji(yd,L)):fd&&
(L.isSameSession=Ma.sourceItem.isFromCurrentSession(this.$),ec=2);if(L.copyContextSnapshot.commandParameters){fd=-1985798686===Ma.commandParameters.ribbonCommandInfo.command;var be=L.commandParameters;var xe=this.$;Ma?xe&&xe.ya?Ma=Ma.sessionId===xe.ya.UserSessionId:(dc.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),Ma=!1):(dc.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),Ma=!1);be.clearSystemClipboard=Ma&&fd&&rb&&!yd;L.commandParameters.copyPasteTargetType=ec}}};
zb.prototype.getSessionId=function(){return this.$.ya.UserSessionId};zb.prototype.gji=function(L,Ma){var rb=Yh.b(L.ranges,function(ec){return ec.hf})&&Yh.b(Ma.commandParameters.originalDestinations,function(ec){return 1!==ec.top});return Yh.b(L.ranges,function(ec){return ec.isRow})&&Yh.b(Ma.commandParameters.originalDestinations,function(ec){return 1!==ec.left})||rb};zb.prototype.CKh=function(L){switch(L){case 1:return this.PFd;case 64:case 4:case 2:case 256:return this.QWc;default:throw Error.invalidOperation("Unsupported selection");
}};zb.prototype.uGh=function(){return ae.g(this.$).ha.We&470?ad.floatingObject:1===ae.g(this.$).ha.We?ad.cells:ad.unknown};zb.prototype.getDialogResponse=function(){};Ck.Object.defineProperties(zb.prototype,{PFd:{configurable:!0,enumerable:!0,get:function(){if(!this.fPc){var L=this.$.da.za(254,!0);L&&(this.fPc=new Qa(this.$,L,new Za))}return this.fPc}},QWc:{configurable:!0,enumerable:!0,get:function(){if(!this.aFc&&this.$.da.za(254,!0)){var L=new wa(this.$);this.aFc=new bb(this.$,new Za,new ja(this.$,
L),L)}return this.aFc}}});Object(nd.a)(zb,"ExcelCopyPasteApplicationHost",null,[857]);var sh=b(162),ii=Pe.a;Wl(sc,ii);sc.prototype.Ug=function(L){this.Yo=new sh.a;var Ma=yf.a.instance.ga(16);L=this.FM(L);this.initializeAndShow(Ma,this.Cai,L)};sc.prototype.FM=function(L){var Ma={};return Ma[sc.Px]=this.Cc,Ma[sc.Fki]=L,Ma};Ck.Object.defineProperties(sc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"InsertCopiedCutCellsDialog"}}});sc.Ceh="direction";sc.Fki="isRtl";var Bg={};sc.Deh=
(Bg.Vertical=1,Bg.Horizontal=0,Bg);Object(nd.a)(sc,"InsertCopiedCutCellsDialog",Pe.a,[]);Hb.prototype.i4b=function(L,Ma){return(new sc(L,Ma)).Yo.task};Object(nd.a)(Hb,"InsertCopiedCutCellsDialogFactory",null,[855]);var Ga=b(91),Kb=b(47),qc=b(43);Yb.prototype.OIe=function(){var L=this;this.jqc||(dc.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.LC(function(Ma){Ma.Yua(0).then(function(){L.jqc=!0})}))};Yb.prototype.Pij=
function(L){var Ma=this,rb=L.commandParameters.id;dc.ULS.sendTraceTag(537167651,0,50,"PasteIndicationManager.ScheduleDisplay: pasteCommandId = {0}, cancelCtx is null = {1}, PrerequisitesDownloaded = {2}",rb,!this.Us,this.jqc);this.OIe();this.i5b=rb;rb=!this.Sqf();if(!this.Us||rb)this.Mve(),this.Us=Kb.a.instance.create(function(){Ma.qfh(L)},void 0===L.timeoutToShowSpinnerInMs||null===L.timeoutToShowSpinnerInMs?100:L.timeoutToShowSpinnerInMs,qc.a.OVi);this.s2=L.commandParameters.originalDestinations};
Yb.prototype.qfh=function(L){this.jqc?(this.display(L.commandParameters.originalDestinations),L.pasteIndicationDisplayStatus=vc.n6c):(dc.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),L.pasteIndicationDisplayStatus=vc.xZi)};Yb.prototype.display=function(L){dc.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.gridView.Db.Av(vd.a.$0(Yc.d(this.gridView.$.qa),L),Yb.xpc,!0);this.gridView.Db.Cn(Yb.xpc)};
Yb.prototype.hjd=function(L){dc.ULS.sendTraceTag(537167648,0,50,"PasteIndicationManager.HideForPasteId: pasteCommandId = {0}, currentPasteCommandId = {1}",L,this.i5b);L&&Na.a.equals(L,this.i5b,!1)&&this.hide()};Yb.prototype.hide=function(L){this.s2&&(void 0===L?0:L)&&this.Sqf()&&dc.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.i5b="";this.Mve();this.s2=null;this.gridView.Db.Oh(Yb.xpc);
this.gridView.Db.vj(null,Yb.xpc)};Yb.prototype.Sqf=function(){return $e.Q(this.gridView.ha.ta.selectedRanges,this.s2)};Yb.prototype.Mve=function(){this.Us&&(Ga.a.Ha(this.Us),this.Us=null)};Yb.prototype.dispose=function(){this.hide();this.gridView.ha.MF(this.Y6e)};Yb.xpc=[30];Object(nd.a)(Yb,"PasteIndicationManager",null,[856,3]);var Wc=b(1179),Dc=b(54),de=vg.a;Wl(sb,de);sb.prototype.create=function(){var L=this,Ma=Dc.a.y_([52,53],4,this.vb,void 0,void 0,void 0,sb.jAa),rb=Ob.GetServiceTaskFactory.create(this.$.da,
18,this.$.la,this.vb);Pd.TaskExtensions.Ba(Pd.TaskExtensions.te([rb,Ma],this.la),function(){var ec=new Wc.a,fd=null;L.t0g(ec).then(function(yd){fd=yd.zye;var be=copyPasteInfra.createCopyPasteInfra(fd,new zb(L.$),ec,L.$);dc.ULS.shipAssertTag(537167762,0,!!L.$.ya,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");dc.ULS.shipAssertTag(537167761,0,!!L.$.ya&&!!L.$.ya.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");
var xe=fd.getMetadataManager();L.Eb(new Hc(L.$,xe,rb.result,be,new jb(L.$,ae.g(L.$)),new Hb,L.$.ya.DocumentHostInfo.UserId,fd.getInitializationError()));yd.I_a?dc.ULS.sendTraceTag(41731933,0,50,"CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName={0}, StrategyType={1}, StrategyCapabilities={2}, IsBestStrategyTypeInitialized={3}, InfraLoadTimeMS={4}",Hc.X$b(),yd.I_a.dataClipboardStrategyType,JSON.stringify(yd.I_a.dataClipboardCapabilities),yd.I_a.clipboardStrategiesToInitialize[0].clipboardStrategyType===
yd.I_a.dataClipboardStrategyType,void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString()):dc.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},function(yd){dc.ULS.shipAssertTag(38847436,0,!1,"CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: {0} error: {1}",
Hc.X$b(),yd?copyPasteInfra.getStringifiedError(yd):"null")})},this.la,3)};sb.prototype.dispose=function(){de.prototype.dispose.call(this)};sb.prototype.t0g=function(L){var Ma=null,rb=window.clipboardPlatform;rb&&(Ma=rb.getClipboardPlatformEnvironment());if(!Ma)return dc.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);rb=this.$.ya;var ec=[rb.OfficeOnlineChromeExtensionId,
rb.ChromeClipboardAccessExtensionId],fd=this.Wm.Wa(5),yd=this.$.Yf.get(57),be=!yd&&this.$.Yf.get(5),xe=this.$.ea.xc;xe&&(xe.inWebPart||xe.inViewerFromWebPart||xe.isDivSyndicated)&&(be=!1);yd=this.AJh(be,!yd);dc.ULS.shipAssertTag(537167758,0,!!rb.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return Ma.init(this.$,L,ec,rb.SharedClipboardHostingApp,rb.SharedClipboardHostingApps,rb.SharedClipboardHostingEnvironments,
rb.SharedClipboardOverrideOrigin,rb.SharedClipboardSchemaVersion,rb.SharedClipboardExpirationInMinutes,rb.ClipboardPromiseTimeoutInMinutes,fd,rb.MachineCluster,new ma(this.$),yd,rb.DocumentHostInfo.UserId,rb.ClipboardTtlInMS,td.EwaSettings.ma(311),rb.UserSessionId).then(function(cf){return Object(kg.a)(new gc,{zye:Ma,I_a:cf})},function(cf){return Promise.reject(cf)})};sb.prototype.AJh=function(L,Ma){var rb=[];L&&Ma&&rb.push(this.O9g());Ma&&(rb.push(this.Z3c(7)),rb.push(this.Z3c(0)));L&&rb.push(this.pDe());
rb.push({clipboardStrategyType:4});dc.ULS.sendTraceTag(39978242,0,50,"CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed={0}, isSystemClipboardAllowed={1}, result = {2}",L,Ma,rb?rb.join(","):"[]");return rb};sb.prototype.pDe=function(){var L=this.$.ya,Ma={clipboardStrategyType:5};Ma.sessionId=L.UserSessionId;Ma.useSharedClipboardIframe=!0;Ma.sharedClipboardHostingApp=L.SharedClipboardHostingApp;Ma.sharedClipboardHostingApps=
L.SharedClipboardHostingApps;Ma.sharedClipboardHostingEnvironments=L.SharedClipboardHostingEnvironments;Ma.sharedClipboardOverrideOrigin=L.SharedClipboardOverrideOrigin;Ma.sharedClipboardSchemaVersion=L.SharedClipboardSchemaVersion;Ma.sharedClipboardExpirationInMinutes=L.SharedClipboardExpirationInMinutes;Ma.wacCluster=L.MachineCluster;return Ma};sb.prototype.O9g=function(){var L={clipboardStrategyType:6};L.localStorageStrategyParameters=this.pDe();L.systemClipboardStrategyParameters=this.Z3c(0);
return L};sb.prototype.Z3c=function(L){var Ma={};Ma.clipboardStrategyType=L;Ma.skipFilesIfPlainTextExists=!0;return Ma};sb.ka=function(L){L.da.Ga(373,new Yb(L));L.da.Ga(sb.jAa,new sb(L))};sb.jAa=255;Object(nd.a)(sb,"CopyPasteInfrastructureFactory",vg.a,[]);var ye=b(11),Gf=b(109),jf=b(13),Hf=le.a;Wl(mc,Hf);mc.prototype.dispose=function(){this.al();this.ym=this.vr=this.$=null;this.statusBarManager&&(this.statusBarManager.HF(this),this.statusBarManager=null)};mc.prototype.sn=function(){return this.J1f};
mc.prototype.Xr=function(L,Ma){if("QueryPasteShortcutEnabledLabel"!==L&&!Array.contains(mc.wDj,L))return!1;var rb=this.xo();"QueryPasteShortcutEnabledLabel"===L?(Ma.Visible=rb,dc.ULS.sendTraceTag(537167636,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",rb,L)):(Ma.Visible=!rb,dc.ULS.sendTraceTag(537167635,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",!rb,L));return!0};mc.prototype.Cjh=function(){this.Ej();this.raiseEvent("pasteShortcutStatusChanged")};
mc.prototype.u6b=function(){this.al();this.raiseEvent("pasteShortcutStatusChanged")};mc.prototype.xo=function(){return this.c8c};mc.prototype.yq=function(L){this.addHandler("pasteShortcutStatusChanged",L)};mc.prototype.Wq=function(L){this.removeHandler("pasteShortcutStatusChanged",L)};mc.prototype.Ej=function(){if(!this.xo()){this.c8c=!0;ae.g(this.$).Nj.ql(this.yHe);this.ym.ka("blur",this.Leh);var L=this.$.da.za(65);L&&L.o3&&L.o3.registerForCommentEvents(this.xHe);this.vr.xt(jf.a.Xb,this.tgf?this.$.jw:
this.$.domElement,this.onKeyDown,!0)}};mc.prototype.al=function(){if(this.xo()){this.c8c=!1;ae.g(this.$).Nj.kl(this.yHe);this.ym.detach("blur");var L=this.$.da.za(65);L&&L.o3&&L.o3.unregisterForCommentEvents(this.xHe);this.vr.Dt(jf.a.Xb,this.tgf?this.$.jw:this.$.domElement,this.onKeyDown,!0)}};mc.wDj=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(nd.a)(mc,"PasteShortcutManager",le.a,[859,457,177,3]);var Df=b(130),Rf=vg.a;Wl(Vb,Rf);Vb.prototype.create=function(){var L=this.$;this.Eb(L.da.za(478)||
this.$.da.Ga(478,new mc(L,Gf.KeyInputManager.instance,Df.a.instance.VG())))};Vb.ka=function(L){L.da.Ga(479,new Vb(L))};Object(nd.a)(Vb,"PasteShortcutManagerFactory",vg.a,[]);bc.prototype.isEnabled=function(){if(Gd.AFrameworkApplication.fa?Gd.AFrameworkApplication.fa.ra("IsAnonymousUser"):1)return!1;var L=Gd.AFrameworkApplication.dc?Object(Wb.a)(String,Gd.AFrameworkApplication.dc.AudienceGroup):"";return"Unknown"!==L&&"Automation"!==L};Ck.Object.defineProperties(bc.prototype,{gWc:{configurable:!0,
enumerable:!0,get:function(){return"Excel"}},campaignId:{configurable:!0,enumerable:!0,get:function(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}},version:{configurable:!0,enumerable:!0,get:function(){return 1}},currentVersion:{configurable:!0,enumerable:!0,get:function(){return 0}},lfi:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.ma(338)}},a7a:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.ma(340)}},Y6a:{configurable:!0,enumerable:!0,
get:function(){return this.$.ma(339)}},VAh:{configurable:!0,enumerable:!0,get:function(){return null}},wpf:{configurable:!0,enumerable:!0,get:function(){return 24}},nTf:{configurable:!0,enumerable:!0,get:function(){return 4E3}},OIb:{configurable:!0,enumerable:!0,get:function(){return this.$.ya.WebServiceBase||""}}});Object(nd.a)(bc,"FirstRunExperienceLauncherSettings",null,[853]);qd.prototype.lRd=function(){this.gTe&&this.gTe.lRd(this.IAh)};Object(nd.a)(qd,"FirstRunExperienceManager",null,[852]);
var Of=vg.a;Wl(yc,Of);yc.prototype.create=function(){this.Eb(this.$.da.za(311)||this.M5g())};yc.prototype.M5g=function(){var L=new bc(this.$);L=new qd(Hg.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),L);L.lRd();return L};yc.ka=function(L){L.da.Ga(312,new yc(L))};Object(nd.a)(yc,"FirstRunExperienceManagerFactory",vg.a,[]);var Ig=b(59),Sh=vg.a;Wl(Rb,Sh);Rb.prototype.create=function(){this.Eb(this.$.da.za(361)||this.x6g())};Rb.prototype.x6g=function(){var L=
this;this.Dkd=Hg.a.instance.Lh("Common.IInProductMessagingUIManager");Ig.a.Fg.isReactSharedHeaderUxEnabled?Le.a.get_instance().Nk(16,function(){L.b$e()}):this.b$e();return this.Dkd};Rb.prototype.b$e=function(){var L=this;Hg.a.instance.kc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ma){Ma.isFeatureEnabled("MsoPremiumBadge",!0).then(function(rb){!rb&&Ma.isFreemiumUpsellEnabled()&&L.Dkd.ckf();return null})})};Rb.ka=function(L){L.da.Ga(362,new Rb(L))};Object(nd.a)(Rb,
"InProductMessagingManagerFactory",vg.a,[]);var Fh=b(903),zg=b(103),ki=b(186),Hi=b(108);Ja.prototype.bFb=function(L){this.Ij=L;if(!this.i1a){if(this.CYd){if(this.G8a&&Ag.a.mF){this.qSb=L.P6b(Object(ob.a)(this,this.Czd,"onFileChosen"));return}this.qSb=L.P6b(null);if(!this.LBa(this.qSb,L))return}this.finalizeUpload(L,null)}};Ja.prototype.Czd=function(L){if(this.LBa(L,this.Ij)){if(Ag.a.mF||Ag.a.Nf)this.qSb=L;this.finalizeUpload(this.Ij,null)}};Ja.prototype.Foc=function(){this.uBd&&this.uBd()};Ja.prototype.Bej=
function(){this.ira=0;this.DEa=this.fa.Dd("Box4UploadRetryDelayStart",200);this.Ij&&(this.Ij.dispose(),this.Ij=null)};Ck.Object.defineProperties(Ja.prototype,{context:{configurable:!0,enumerable:!0,get:function(){return this.dT}},fa:{configurable:!0,enumerable:!0,get:function(){return this.wb}},retryCount:{configurable:!0,enumerable:!0,get:function(){return this.ira}},ZKd:{configurable:!0,enumerable:!0,get:function(){return this.DEa}}});Object(nd.a)(Ja,"FileUploader",null,[]);var ug=b(331),wi=b(990),
Fa=b(135);Wl(Eb,Ja);Eb.prototype.iYe=function(L){switch(L){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}};Eb.prototype.deg=function(L){return Eb.LBa(L,this.hZh())};Eb.prototype.hZh=function(){return Eb.xie};Eb.prototype.LBa=function(L,Ma){Ma=void 0===Ma?null:Ma;L=this.deg(L);return 0!==L?(Ma&&Ma.Hke(),2===L&&this.si(0,this.iYe(L)),!1):!0};Eb.prototype.finalizeUpload=function(L,Ma){dc.ULS.sendTraceTag(36783360,
322,50,"PictureUploader.FinalizeUpload");this.uBd=Ma;this.Byj();ug.a.mark(5576);this.$Ub=this.AO.Gc("LoadResource","PictureUploadTime")};Eb.prototype.si=function(L,Ma){var rb=new Fa.StandardDialog;rb.ic=0;rb.Wz(L,CommonUIStrings.l_ImageUploadFailedTitle,Ma,null)};Eb.prototype.Foc=function(){dc.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");Ja.prototype.Foc.call(this);this.$Ub&&(this.$Ub.stop(),this.$Ub=null);this.LYg()};Eb.prototype.Byj=function(){this.Era=(new wi.a).create();
this.Era.message=CommonUIStrings.l_ImageUploadWait;this.Era.ic=5;this.Era.fv=!1;this.Era.HAa(null,null,null)};Eb.prototype.LYg=function(){this.Era&&(this.Era.close(),this.Era=null)};Eb.h4h=function(L,Ma){L=Aa.a.Al(L);for(var rb=0;rb<Ma.length;++rb)if(L.endsWith(Ma[rb]))return!0;return!1};Eb.LBa=function(L,Ma){Ma=void 0===Ma?null:Ma;Ma||(Ma=Eb.xie);return L?Eb.h4h(L,Ma)?0:2:1};Ck.Object.defineProperties(Eb.prototype,{AO:{configurable:!0,enumerable:!0,get:function(){return Gd.AFrameworkApplication.sa.yD}}});
Eb.xie=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(nd.a)(Eb,"PictureUploader",Ja,[]);var na=b(617),Gb=b(293),Vd=b(150),ge=b(90),We=b(169),Vg=b(182),Qg=b(87),jg=b(1318),sg=b(80),Th=jg.a;Wl(zc,Th);zc.prototype.Jrc=function(L,Ma){this.isEnabled()&&this.tFa(this.targetOrigin)&&(this.jo(L),this.Tl(L,Ma))};Object(nd.a)(zc,"InsertMediaCrossDocumentMessenger",jg.a,[923,98,3]);Object(nd.a)(Bb,"OnlineMediaSearchResult",null,[]);var Bi=b(324),ri=Vd.a;Wl(db,ri);db.prototype.tyj=function(L){var Ma=
this;this.ugc=!1;this.showDialog(this.Jm,null);this.jwa=document.getElementById(this.oi("InsertMediaFrame"));if(!this.jwa)throw this.yua(this.Pob),Error.invalidOperation("Couldn't get InsertMediaIframe.");var rb=document.getElementById(this.oi("WACDialogPanel"));rb&&rb.setAttribute(ge.a.Wd,ge.a.eZa);rb=document.createElement("div");rb.id="KeepFocusStartDiv";rb.tabIndex=0;rb.className="keep-focus-start";this.jwa.parentNode.insertBefore(rb,this.jwa.parentNode.firstChild);rb=document.createElement("div");
rb.id="KeepFocusDiv";rb.tabIndex=0;rb.className="keep-focus";this.jwa.parentNode.appendChild(rb);$addHandler(this.hIa,"keydown",this.Brd);this.jwa.src=this.l$e;this.jwa.frameBorder="0";rb=document.getElementById(this.oi("WACDialogButtonPanel"));if(!rb)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");rb.className="display-none";rb=document.getElementById(this.oi("WACDialogTitleText"));if(!rb)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");rb.className="display-none";
2===this.Vof&&(document.getElementById(this.oi("WACDialogTitlePanel")).className="display-none",document.getElementById(this.oi("WACDialogBodyPanel")).className="padding-zero");Pf.FocusManager.instance().MQ().scope.oR=!0;this.QR=new zc(this.jwa.contentWindow,this.l$e);this.QR.Jrc(We.a.SAg,function(ec){Ma.qEi(ec,Object(ob.a)(L,L.Ooa,"uploadResponseReceived"))});this.QR.Jrc(We.a.insert,function(){Ma.HLi(Object(ob.a)(L,L.Ooa,"uploadResponseReceived"))});this.QR.Jrc(We.a.CZc,this.vFi);2===this.Vof&&0===
this.heh&&(this.QR.Jrc(We.a.Lpi,this.rMi),this.oNa=this.Hnb.Pma("MsoPremiumStockImages",function(ec){dc.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");if(ec.isEnabled){var fd={};Ma.QR.Gj(We.a.iSj,(fd.LicenseTier=ec.toString(),fd))}else dc.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}))};db.prototype.dispose=function(){this.dAa=null;this.Hnb&&this.oNa&&this.Hnb.PHd("MsoPremiumStockImages",this.oNa);
this.QR&&(this.QR.dispose(),this.QR=null);ri.prototype.dispose.call(this)};db.prototype.hide=function(){ri.prototype.hide.call(this);Qg.a.Vvc(this.$)};db.prototype.qEi=function(L,Ma){L=L&&L.Values?(L=L.Values)?Object(kg.a)(new Bb,{Action:L.action||"",Caption:L.caption||"",ContentType:L.contentType||"",FileExtension:L.extension||"",PageUrl:L.pageUrl||"",SourceUrl:L.sourceUrl||"",ThumbnailUrl:L.thumbnailUrl||"",LicenseUrl:L.licenseUrl||"",LicenseDisplayName:L.licenseDisplayName||"",Height:L.height||
0,Width:L.width||0}):null:null;L&&(this.dAa.push(L),this.ugc&&(dc.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),Ma(this.dAa),this.ugc=!1,this.yua(this.Pob)))};db.prototype.HLi=function(L){this.dAa&&0<this.dAa.length?this.dAa.length<=this.Moe?(L(this.dAa),this.yua(this.Pob)):(this.Wz(),dc.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),Array.clear(this.dAa)):this.ugc=!0};db.prototype.A6g=function(){var L=
document.createElement("div");L.id="InsertMediaDialog";L.className=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";var Ma=document.createElement("div");Ma.id="InsertMediaPanel";Ma.className=td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";var rb=document.createElement("iframe");rb.id=
"InsertMediaFrame";rb.className="insert-media-frame";L.appendChild(Ma);Ma.appendChild(rb);return Bi.b(L)};db.prototype.Wz=function(){var L=Se.a.gd(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");L.Description=String.format(yf.a.instance.Bb(197),this.Moe.toLocaleString());td.EwaSettings.Az()?new Me.a(this.$,L):(new He.ErrorDialog(this.$,L)).Af()};Ck.Object.defineProperties(db.prototype,{s4:{configurable:!0,enumerable:!0,get:function(){return Vg.a.l6b+"/InsertMediaDialog"}},canBePreempted:{configurable:!0,
enumerable:!0,get:function(){return!1}}});Object(nd.a)(db,"InsertMediaDialog",Vd.a,[]);var pi=b(490),vi=b(394);Wl(nb,Eb);nb.prototype.Ooa=function(L){var Ma=this;if(L){for(var rb=Array(L.length),ec=0;ec<L.length;ec++){var fd=L[ec];rb[ec]={};rb[ec].SourceUrl=fd.SourceUrl;Aa.a.Kwa(fd.LicenseUrl)&&Aa.a.Kwa(fd.PageUrl)&&(rb[ec].LicenseUrl=fd.LicenseUrl,rb[ec].LicenseDisplayName=fd.LicenseDisplayName,rb[ec].PageUrl=fd.PageUrl);rb[ec].AltText=-2053056795===this.Sd.command?fd.Caption:""}var yd=-2009825598===
this.Sd.command?"bing":"M365";ec=ae.g(this.$);var be=$e.o(ec.ha.ta.activeCell,this.$);vf.a(this.$.userOperationManager,function(xe,cf,ze){return oc.M(Ma.$.na.va,be,rb,yd,Sf.b(xe,Ma.eOi),Sf.a(cf,Ma.dOi),ze,null)},function(xe){return new Wd.a(595,0,xe)},this.Sd);Oe.HelperMethods.g_?(ec=new Map,ec.set("MediaProvider",yd),ec.set("ImagesCount",L.length.toString()),ec.set("TimeTakenToOpenDialog",this.wmf.toString()),pc.Health.instance.recordKpiUsage(vi.a.Kai,1,pi.a.H7f,ec)):dc.ULS.sendTraceTag(537155805,
0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.Foc()}else dc.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};nb.prototype.dispose=function(){this.$=null};nb.prototype.showDialog=function(){var L=this,Ma=null;Ma=this.$.Pb.Gc("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.Sd.command){case -2009825598:this.Fxj();break;case -2053056795:this.vpe.execute(function(rb){rb.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(function(ec){return dc.ULS.sendTraceTag(557200643,0,10,"OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: {0}",ec)}).then(function(ec){L.Gxj(ec);return null})})}Ma.stop();this.wmf=Ma.Bc};nb.prototype.Fxj=function(){var L=this.$.ya.BingPictureEndpoint,Ma=na.a.kH(Gd.AFrameworkApplication.lcid),rb=Lg.a.create();L?(L=0<L.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(L,1,1):String.format(L,1,Gd.AFrameworkApplication.lcid,
Ma?Ma.name:"en-us",Gd.AFrameworkApplication.buildVersion,rb.toString(),1,this.$.ya.DocumentHostInfo.LoggableUserId),this.i4b(L,1,-1,yf.a.instance.ga(1736))):(dc.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.T0.setException(Error.create("Failed to access the Bing service endpoint")))};nb.prototype.Gxj=function(L){var Ma=this.$.ya.M365PictureEndpoint,rb=Lg.a.create();if(Ma){var ec=this.$.ya.DocumentHostInfo.UserId;
ec=ec?Aa.a.ew(ec).toString():"0";var fd=this.vpe.instance.isFreemiumUpsellEnabled();L=L?1:fd?0:-1;rb=rb.toString();fd=na.a.kH(Gd.AFrameworkApplication.lcid).name;Ma=String.format(Ma,Gd.AFrameworkApplication.lcid,fd,Gd.AFrameworkApplication.buildVersion,rb,1,ec,L,1);this.i4b(Ma,2,L,yf.a.instance.ga(1735))}else dc.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.T0.setException(Error.create("Failed to access the M365 service endpoint"))};
nb.prototype.i4b=function(L,Ma,rb,ec){try{(new db(this.$,L,Hg.a.instance.Lh("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ma,rb,ec)).tyj(this),this.T0.setResult(!0)}catch(fd){dc.ULS.sendTraceTag(537155802,0,10,"OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : {0}] [MediaProvider : {1}] [DialogLicenseTier : {2}]",fd,Ma,rb),this.T0.setException(fd)}};Object(nd.a)(nb,"OnlinePictureUploaderWrapper",Eb,[3]);Nb.prototype.executeCommand=function(L,Ma,rb){L=Ma.command;
switch(L){case 1403967063:if(rb&&"dataUrl"in rb)return Ma=new sh.a,this.uploaderCreator&&this.uploaderCreator.s9h(this.$,zg.a.instance,Gd.AFrameworkApplication.fa,rb,rb.dataUrl,Ma),Ma.task;this.uploaderCreator&&this.uploaderCreator.v$h(this.$,Ma,zg.a.instance,Gd.AFrameworkApplication.fa,rb);return qb.Task.Sa(!0);case -2053056795:case -2009825598:return L=new sh.a,new nb(this.$,Ma,zg.a.instance,Gd.AFrameworkApplication.fa,rb,L),L.task;default:return ki.a(L)}};Nb.prototype.Mc=function(L,Ma){if(L=this.$.isEditMode)switch(Ma.command){case 1403967063:L=
!0;break;case -2053056795:L=!0;break;case -2009825598:L=td.EwaSettings.isChangeGateEnabled("OfficeVSO:5744839_InsertOnlinePictures");break;default:L=!1}return L};Nb.prototype.jd=function(){return!1};Nb.prototype.$c=function(){return!1};Object(nd.a)(Nb,"PictureCommandHandler",null,[428]);var jh=Fh.a;Wl(nc,jh);nc.prototype.Od=function(){var L=this;Pd.TaskExtensions.Ba(Ob.GetServiceTaskFactory.Xa(this.$.da,484,485,1),function(Ma){L.Cd([new Nb(L.$,Ma.result)])},this.$.la,3)};nc.ka=function(L){Fh.a.ee(90,
new nc(L))};Object(nd.a)(nc,"PictureCommandHandlerFactory",Fh.a,[]);var Ng=b(555),ji=b(437),we=b(77),vh=b(591),Ph=b(636),Mf=vh.a;Wl(cc,Mf);cc.prototype.bPd=function(L){this.Gfa!==L&&(this.Gfa=L,this.KGb())};cc.prototype.dispose=function(){this.gridView.pc.kl(this.Vtf);this.gridView.pc.Um(this.Utf);this.gridView=null;Mf.prototype.dispose.call(this)};cc.prototype.KGb=function(){this.LFd(this.Gfa)};cc.prototype.refresh=function(){this.bPd(!this.gridView.isEditing)};Ck.Object.defineProperties(cc.prototype,
{XH:{configurable:!0,enumerable:!0,get:function(){return this.Zkc(this.Gfa)}},name:{configurable:!0,enumerable:!0,get:function(){return Ph.a.cellEdit}}});Object(nd.a)(cc,"CellEditSafeStatePublisher",vh.a,[]);Object(nd.a)(Cb,"SafeStatePublisherState",null,[]);var rf=b(705),oi=le.a;Wl(Pa,oi);Pa.prototype.xZb=function(L){this.addHandler(Pa.GQa,L)};Pa.prototype.Psc=function(L){this.removeHandler(Pa.GQa,L)};Pa.prototype.yza=function(L,Ma){function rb(yd,be){fd.XH=be.XH;ec.MGb()}var ec=this,fd=new Cb(L,
Ma);this.HQa.add(fd);L.xZb(rb);fd.handler=rb;this.MGb()};Pa.prototype.lXd=function(L){for(var Ma=null,rb=Gl(this.HQa),ec=rb.next();!ec.done;ec=rb.next())if(ec=ec.value,ec.publisher===L){this.Sag(ec);Ma=ec;break}Ma&&(this.HQa.remove(Ma),this.MGb())};Pa.prototype.dispose=function(){for(var L=Gl(this.HQa),Ma=L.next();!Ma.done;Ma=L.next())this.Sag(Ma.value);this.HQa.clear();this.Dyb&&(this.fje.laj(this.Fyf.bind(this)),this.vma.bbb(this.rya.bind(this)));oi.prototype.dispose.call(this)};Pa.prototype.Q$b=
function(){var L=xa.Q$b(this.HQa.toArray().map(function(Ma){return Ma.XH}));return this.$ic&&1===L?2:L};Pa.prototype.Sag=function(L){L.publisher.Psc(L.handler)};Pa.prototype.MGb=function(){var L=this.Q$b();L!==this.Rif&&(this.raiseEvent(Pa.GQa,new rf.a(L)),this.Rif=L)};Pa.prototype.Fyf=function(){this.$ic&&dc.ULS.sendTraceTag(523317957,0,15,"ClientStateMonitor.onMergeWasAborted: Aborted merge occurred after another aborted merge.");this.$ic=!0;this.MGb()};Pa.prototype.rya=function(L,Ma){L=Ma.hca;
(Ma=!Da(L))||(Ma=this.Xoi,Ma=(null===L||void 0===L?void 0:L.SuspensionStartTimestamp)!==(null===Ma||void 0===Ma?void 0:Ma.SuspensionStartTimestamp));Ma&&(this.$ic=!1);this.Xoi=L;this.MGb()};Ck.Object.defineProperties(Pa.prototype,{MNj:{configurable:!0,enumerable:!0,get:function(){return Yh.f(Yh.c(this.HQa.toArray(),function(L){return 0!=L.XH}),function(L){return L.publisher.name})}}});Pa.GQa="SSC";Object(nd.a)(Pa,"ClientStateMonitor",le.a,[]);var bh=b(6),ah=b(66),wh=vh.a;Wl(mb,wh);mb.prototype.bPd=
function(L){L!==this.Gfa&&(this.Gfa=L,this.KGb())};mb.prototype.dispose=function(){ah.a(this.$).vsc(this.Zuf);this.d5a.Wq(this.yN);this.r7d=null;wh.prototype.dispose.call(this)};mb.prototype.KGb=function(){this.LFd(this.Gfa)};mb.prototype.refresh=function(){this.bPd(1===this.d5a.$t||ah.a(this.$).wi===this.d5a)};Ck.Object.defineProperties(mb.prototype,{XH:{configurable:!0,enumerable:!0,get:function(){return this.Zkc(this.Gfa)}},name:{configurable:!0,enumerable:!0,get:function(){return Ph.a.d5a}},d5a:{configurable:!0,
enumerable:!0,get:function(){return this.r7d}}});Object(nd.a)(mb,"IdleActivitySafeStatePublisher",vh.a,[]);var xi=b(327),O=b(3),fa=we.a;Wl(eb,fa);eb.prototype.$c=function(){return!1};eb.prototype.executeCommand=function(){return qb.Task.Sa(!0)};eb.prototype.Mc=function(L,Ma){return 1905775613===Ma.command};eb.prototype.jd=function(){return!1};Object(nd.a)(eb,"ToggleMergeSuspensionSafeState",we.a,[428]);var Va=le.a;Wl(Ra,Va);Ra.prototype.yq=function(L){this.addHandler(Ra.Qvd,L)};Ra.prototype.Wq=function(L){this.removeHandler(Ra.Qvd,
L)};Ra.prototype.Gz=function(){this.raiseEvent(Ra.Qvd)};Ra.prototype.sn=function(L){return L===Ra.T0i&&!!this.mergeSuspensionManager};Ra.prototype.Xr=function(L,Ma){if(!this.sn(L))return!1;this.mergeSuspensionManager&&(Ma.LabelText=this.Ilc,Ma.On=this.lxd);return!0};Ra.prototype.dispose=function(){this.gNb&&(this.Ka.Qab(this.gNb),this.gNb.dispose(),this.gNb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.vma.bbb(this.rya),this.mergeSuspensionManager.Mha.Psc(this.GOa),this.mergeSuspensionManager=
null);this.statusBarManager&&(this.statusBarManager.HF(this),this.statusBarManager=null);this.Ilc=null;Va.prototype.dispose.call(this)};Ra.Qvd="MSMSC";Ra.T0i="QueryMergeSuspensionStatus";Object(nd.a)(Ra,"MergeSuspensionIndicatorManager",le.a,[457,177,3]);var d=b(1087),r=Sys.EventArgs;Wl($a,r);Object(nd.a)($a,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);Object(nd.a)(la,"SuspensionState",null,[]);Wl(va,la);Object(nd.a)(va,"ReadyForPendingMergeState",la,[]);var S=new la,ca=new la,Ka=
new va(!1),fc=new va(!0),pb=b(1088),Z=pb.a;Wl(Tb,Z);Object(nd.a)(Tb,"ReadyForPendingMergesUpdatedEventArgs",pb.a,[]);var Ba=le.a;Wl(tb,Ba);tb.prototype.h8h=function(){return Object(ji.a)(Pa,this.Mha)?Object(Wb.a)(Pa,this.Mha).Q$b():1};tb.prototype.CZb=function(L){this.addHandler(tb.uVd,L)};tb.prototype.Rsc=function(L){this.removeHandler(tb.uVd,L)};tb.prototype.WFg=function(L){this.addHandler(tb.sGd,L)};tb.prototype.Raj=function(L){this.removeHandler(tb.sGd,L)};tb.prototype.dFg=function(L){this.addHandler(tb.Lvd,
L)};tb.prototype.kaj=function(L){this.removeHandler(tb.Lvd,L)};tb.prototype.D2i=function(){this.JFd(this.getState()===ca)};tb.prototype.dispose=function(){this.Mha.Psc(this.GOa);this.Mha=null;this.vma.bbb(this.rya);this.vma=null;Ba.prototype.dispose.call(this)};tb.prototype.Led=function(){return Object(kg.a)(new d.a,{Current:this.vla.Current,Pending:this.vla.Pending,SuspensionStartTimestamp:this.vla.SuspensionStartTimestamp})};tb.prototype.getState=function(){return Da(this.vla)?0==this.XH?fc:this.Dyb&&
1==this.XH?Ka:ca:S};tb.prototype.SSe=function(L,Ma){L!==Ma&&(Ma===ca?this.JFd(!0):L===ca&&this.JFd(!1));Ma instanceof va&&this.raiseEvent(tb.sGd,new Tb(this.vla,Ma.Koe||!this.Dyb))};tb.prototype.$ti=function(L,Ma,rb){L===S&&Ma!==S?(L=Ma===ca,Ma=Ma===Ka,dc.ULS.sendTraceTag(252760283,0,50,"MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: {0} publisher: {1} counter: {2} isBlockingAllMerges: {3}",Ma,Ma||L?this.Mha.MNj.join(","):"",Sa(this.vla),L)):L!==S&&Ma===
S&&dc.ULS.sendTraceTag(252760284,0,50,"MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: {0}",Sa(rb))};tb.prototype.JFd=function(L){this.raiseEvent(tb.uVd,new $a(L))};tb.uVd="TPMBBC";tb.sGd="RFPMU";tb.Lvd="MCC";Object(nd.a)(tb,"MergeSuspensionStateHandler",le.a,[]);var Fb=le.a;Wl(Ya,Fb);Ya.prototype.AYa=function(L){this.addHandler("MCU",L)};Ya.prototype.bbb=function(L){this.removeHandler("MCU",L)};Ya.prototype.qya=function(L,Ma){Ma=void 0===Ma?"":Ma;var rb=this.W1.Current<
L.Current||this.W1.Pending<L.Pending;if(L.SuspensionStartTimestamp&&this.Zic!==L.SuspensionStartTimestamp){if(this.Zic>L.SuspensionStartTimestamp){rb&&dc.ULS.sendTraceTag(553736149,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via {0}. S: {1}, C: {2}",Ma,Ya.zCb(L),Ya.zCb(this.W1));return}rb||dc.ULS.sendTraceTag(553736148,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: {0}, C: {1}",Ya.zCb(L),
Ya.zCb(this.W1))}else if(!rb)return;this.W1=L;this.SJf(L,Ma)};Ya.prototype.dispose=function(){this.$.ea.Dk(this.xvc);this.$.ea.$R(this.xvc);ae.g(this.$).pc.Um(this.o9a);td.EwaSettings.isChangeGateEnabled("OfficeVSO:6329027_UpdateMergeCountWhenWebMethodReturnsWithErrors")||this.$.na.Ar(this.j8);var L=this.$.da.za(292);L&&L.bbb(this.ACb);Fb.prototype.dispose.call(this)};Ya.prototype.SJf=function(L,Ma){Ma=void 0===Ma?"":Ma;Da(L)&&L.SuspensionStartTimestamp>this.Zic&&(dc.ULS.sendTraceTag(537155416,0,
50,"PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: {0}, Origin: {1}",Sa(L),Ma),this.Zic=L.SuspensionStartTimestamp);this.raiseEvent("MCU",new pb.a(L))};Ya.prototype.gSf=function(){dc.ULS.sendTraceTag(588276808,0,50,"PendingMergeMonitor.ResetMergeCounter : Last counter was {0}",Ya.zCb(this.W1));this.W1=Object(kg.a)(new d.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})};Ya.zCb=function(L){return L?String.format("({0}/{1} @{2})",L.Current,L.Pending,L.SuspensionStartTimestamp):
"null"};Ck.Object.defineProperties(Ya.prototype,{vla:{configurable:!0,enumerable:!0,get:function(){return this.W1}}});Ya.TZd="PMM.RTC";Ya.ysb="PMM.EwaResult";Ya.uej="PMM.resetMergeCounter";Object(nd.a)(Ya,"PendingMergeMonitor",le.a,[]);Object(nd.a)(Ia,"ClientRevisions",null,[]);var xc=le.a;Wl(za,xc);za.prototype.dispose=function(){this.$.na.pda(this.k8);this.Eyc();this.X5.Raj(this.qAf);this.X5.Rsc(this.YEb);this.X5.kaj(this.Eyf);this.X5=null;xc.prototype.dispose.call(this)};za.prototype.KCj=function(){this.Eyc();
if(this.lHe()){var L=this.X5.Led();dc.ULS.sendTraceTag(537155414,0,50,"RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter {0} fail count: {1}",Sa(L),this.AAb)}else this.BAb=this.mZa.create(this.AWf,this.ytc,qc.a.BAb),this.o7a=this.mZa.tC(this.AWf,this.voi,qc.a.o7a)};za.prototype.Eyc=function(){this.o7a&&(this.BAb.cancel(),this.o7a.cancel(),this.o7a=this.BAb=null)};za.prototype.cMi=function(L){var Ma=
" fail count: "+this.AAb;this.AAb++;this.lHe()&&this.Eyc();dc.ULS.sendTraceTag(542229773,0,10,"RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed {0}{1}",Sa(L),Ma)};za.prototype.lHe=function(){return this.AAb>za.Gxi};za.Gxi=5;Object(nd.a)(za,"RequestController",le.a,[]);var Pc=b(212),Sc=b(28),oe=le.a;Wl(ka,oe);ka.prototype.eFg=function(L){this.addHandler(ka.Rvd,L)};ka.prototype.laj=function(L){this.removeHandler(ka.Rvd,L)};ka.prototype.ULg=function(L,Ma){var rb=this;this.nLb(L,
Ma)?(new sh.a).setResult(!0):(Ma=this.eWi(L,Ma),this.$Ab=L,this.CBd++,Ma.CWCT(function(){rb.KHi()},Pc.a.none,0,this.HO))};ka.prototype.eWi=function(L,Ma){this.RYd=this.qh.Cea;this.jif=Ma;dc.ULS.sendTraceTag(554767493,0,50,"DoPendingMergeSender.performDoPendingMergeInternal: Sending DoPendingMerge {0} / {1} @{2}. allowSelectionAdjustment: {3}",L.Current,L.Pending,L.SuspensionStartTimestamp,Ma);this.isDocumentHidden||this.By();return this.Ukj(Ma,L)};ka.prototype.nLb=function(L,Ma){if(this.eAa&&!Ma&&
!this.eAa.Eli())return dc.ULS.sendTraceTag(523317956,0,50,"DoPendingMergeSender.shouldThrottle: We can't retrieve selection and selection adjustments are disallowed."),!0;if(!this.$Ab||L.SuspensionStartTimestamp>this.$Ab.SuspensionStartTimestamp)return this.DLa&&dc.ULS.sendTraceTag(523551556,0,50,"DoPendingMergeSender.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: {0} / {1} @{2}",L.Current,L.Pending,L.SuspensionStartTimestamp),!1;if(this.DLa)return!0;if(this.qdg){L=
Ta(L,this.$Ab);var rb=this.qh.Cea-this.RYd<this.ytc;Ma=this.jif===Ma;return L&&rb&&Ma}return Ta(L,this.$Ab)&&this.qh.Cea-this.RYd<this.ytc};ka.prototype.Ukj=function(L,Ma){function rb(){dc.ULS.sendTraceTag(588276806,0,10,"DoPendingMergeSender.sendDoPendingMergeRequest: request failed {0} / {1} @{2}",Ma.Current,Ma.Pending,Ma.SuspensionStartTimestamp)}var ec=this.va.hc();return this.eAa?this.eAa.xhj(this.YLh(L,rb,ec)):this.lve(null,!0,void 0,rb,ec)};ka.prototype.YLh=function(L,Ma,rb){var ec=this;return function(fd,
yd,be){var xe=void 0;ec.qdg&&(dc.ULS.shipAssertTag(523317955,0,null!=fd||L,"!allowSelectionAdjustment requires a non-null initialViewportState."),xe=ec.LHi.bind(ec));yd&&(xe=Sf.b.call(null,function(cf){var ze=cf.Result,Yf=null===ze||void 0===ze?void 0:ze.AdjustedViewportState;3===(null===ze||void 0===ze?void 0:ze.MergeResultState)&&(Yf=void 0);yd(Yf,cf.StateId)},xe));be&&(Ma=Sf.a.call(null,be,Ma));return ec.lve(fd,L,xe,Ma,rb)}};ka.prototype.lve=function(L,Ma,rb,ec,fd){if(this.kTg){var yd=this.va;
fd=yd.Na(1,void 0===fd?null:fd);fd.viewportState=L;fd.allowViewAdjustment=Ma;L=oc.i(yd,"DoPendingMerge",fd,rb,ec,null,null,0)}else yd=this.va,fd=yd.Na(1,void 0===fd?null:fd),fd.viewportState=L,fd.allowViewAdjustment=Ma,L=oc.i(yd,"DoPendingMergeNew",fd,rb,ec,null,null,0);return L};ka.prototype.LHi=function(L){L=L.Result;void 0!=L&&3===L.MergeResultState&&(dc.ULS.sendTraceTag(523317954,0,50,"DoPendingMergeSender.onDoPendingMergeSucceeded: Aborted merge."),this.g2i())};ka.prototype.g2i=function(){this.raiseEvent(ka.Rvd,
new Sys.EventArgs)};ka.prototype.KHi=function(){this.CBd--};Ck.Object.defineProperties(ka.prototype,{DLa:{configurable:!0,enumerable:!0,get:function(){return 0<this.CBd}},isDocumentHidden:{configurable:!0,enumerable:!0,get:function(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.zi}}});ka.Rvd="MWA";Object(nd.a)(ka,"DoPendingMergeSender",le.a,[878,879]);Ck.Object.defineProperties(Ea.prototype,{reportName:{configurable:!0,enumerable:!0,get:function(){return this.d7h?"SelectionAdjustInHiddenDocument":
"SelectionAdjust"}}});Object(nd.a)(Ea,"SelectionAdjustSessionEndsReport",null,[454]);qa.prototype.Meg=function(L){var Ma=this;this.y6d&&(this.pUb?this.AQb=this.selectedRanges.map(function(yd){return Ma.CAc(yd,Ma.oEc)}):this.iCa&&(this.AQb=[this.CAc(this.selectedRanges[0],this.oEc)]));for(var rb=Gl(this.AQb),ec=rb.next();!ec.done;ec=rb.next()){ec=ec.value;if(!this.Ejg&&!ec)return!1;if(ec){ec=Gl(ec);for(var fd=ec.next();!fd.done;fd=ec.next())if(fd=fd.value,fd.mk&&fd.qe.Revision<L)return!1}}return!0};
qa.prototype.oIj=function(){var L;if(this.iCa||this.pUb){var Ma={SheetName:this.sheetName,ActiveCell:null===(L=this.activeCell)||void 0===L?void 0:L.toString(),SelectedRange:this.selectedRanges[0].toString(),TopLeft:void 0,SelectedRanges:void 0};this.pUb&&(Ma.SelectedRange=void 0,Ma.SelectedRanges=$e.r(this.selectedRanges,this.xb));return Ma}};qa.prototype.toString=function(){var L,Ma;return String.format("active cell: {0} selection: {1}",null!==(Ma=null===(L=this.activeCell)||void 0===L?void 0:L.toString())&&
void 0!==Ma?Ma:"null",Yh.f(this.selectedRanges,function(rb){var ec;return null!==(ec=null===rb||void 0===rb?void 0:rb.toString())&&void 0!==ec?ec:"null"}).join(","))};qa.prototype.equals=function(L){return L?this.activeCell.equals(L.activeCell)&&$e.Q(this.selectedRanges,L.selectedRanges)&&this.sheetName===L.sheetName:!1};qa.prototype.TSg=function(){for(var L=Gl(this.selectedRanges.entries()),Ma=L.next();!Ma.done;Ma=L.next()){var rb=Gl(Ma.value);Ma=rb.next().value;rb=rb.next().value;if(null===rb||
void 0===rb?0:rb.contains(this.activeCell))return Ma}return-1};qa.prototype.CAc=function(L,Ma){var rb,ec=ae.g(this.xb).Ea.h3a(L,Ma);ec||dc.ULS.sendTraceTag(522803340,0,50,"SelectionState.tryGetBlockCacheItemsFromRange: no items found. range: {0} ; activeItemNameIsDefined: {1}",null!==(rb=null===L||void 0===L?void 0:L.toString())&&void 0!==rb?rb:"null",!!Ma);return ec};Ck.Object.defineProperties(qa.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return this.nG}},selectedRanges:{configurable:!0,
enumerable:!0,get:function(){return this.t9}},nt:{configurable:!0,enumerable:!0,get:function(){if(void 0==this.HL||this.HL>=this.selectedRanges.length)this.HL>=this.selectedRanges.length&&dc.ULS.sendTraceTag(521200010,0,10,"SelectionState.indexOfActiveRange: index out of bounds. indexOfActiveRange: {0}, selectedRangesLength: {1}",this.HL,this.selectedRanges.length),this.HL=this.TSg();return this.HL}},activeRange:{configurable:!0,enumerable:!0,get:function(){return 0>this.nt?this.activeCell:this.selectedRanges[this.nt]}},
sheetName:{configurable:!0,enumerable:!0,get:function(){return this.pWb}},activeItemName:{configurable:!0,enumerable:!0,get:function(){return this.oEc}},iCa:{configurable:!0,enumerable:!0,get:function(){return 1===this.selectedRanges.length}}});Object(nd.a)(qa,"SelectionState",null,[]);var gf=b(220),xf;(function(L){L[L.none=0]="none";L[L.waitingForAdjusted=1]="waitingForAdjusted";L[L.invalid=2]="invalid";L[L.nonContinuous=3]="nonContinuous";L[L.noAdjustRequired=4]="noAdjustRequired";L[L.noAdjustRequiredWithDivergence=
5]="noAdjustRequiredWithDivergence";L[L.divergenceOnResponse=6]="divergenceOnResponse";L[L.waitingForViewport=7]="waitingForViewport";L[L.adjusted=8]="adjusted";L[L.divergenceOnViewportReady=9]="divergenceOnViewportReady";L[L.differentSheetAdjust=10]="differentSheetAdjust";L[L.editBoxDivergence=11]="editBoxDivergence";L[L.exception=12]="exception"})(xf||(xf={}));Object(nd.b)("SelectionAdjustState",xf);var Uf=b(946);oa.prototype.xhj=function(L){function Ma(){rb.sEi()}var rb=this,ec=null,fd=null;this.vaf()?
(this.$L.parallel++,dc.ULS.sendTraceTag(526390086,0,15,"SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : {0}",!!this.Vy)):(ec=function(yd,be){rb.tEi(yd,be)},fd=this.iqj());return null===L||void 0===L?void 0:L(fd,ec,Ma)};oa.prototype.Eli=function(){return!this.vaf()&&this.Kaa().iCa};oa.prototype.iqj=function(){var L;dc.ULS.shipAssertTag(525135961,0,0===this.UC,"SelectionAdjustManager.setPreRequestState: unexpected state");this.Vy&&
(this.$L.errors++,dc.ULS.sendTraceTag(526960090,0,10,"SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: {0}",this.Vy.toString()));this.Vy=null;this.ey=this.Kaa();var Ma=null,rb=null===(L=this.ey)||void 0===L?void 0:L.oIj();rb&&(Ma={ActiveSheetName:this.ey.sheetName,SheetViewportStateChanges:[rb]});this.UC=1;return Ma};oa.prototype.sEi=function(){dc.ULS.shipAssertTag(525135960,0,1===this.UC,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.$L.errors++;
this.UC=2;this.Qr()};oa.prototype.tEi=function(L,Ma){try{dc.ULS.shipAssertTag(525135959,0,1===this.UC,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.iMb=Ma,Ma=2,this.ey?L?(this.Vy=this.Ltj(L))?(Ma=7,this.QCb||this.ey.iCa)?this.ey.equals(this.Vy)?this.PQf&&!this.ey.equals(this.Kaa())?(this.$L.adjustedDidntChangeWithDivergence++,Ma=5):(this.$L.adjustedDidntChange++,Ma=4):this.ey.sheetName!=this.Vy.sheetName?(this.$L.differentSheetAdjust++,Ma=10):this.PQf&&!this.ey.equals(this.Kaa())&&
(this.$L.divergenceOnResponse++,Ma=6,this.OQf()):(this.$L.nonContinuous++,Ma=3):this.$L.errors++:(this.$L.errors++,dc.ULS.sendTraceTag(537155412,0,15,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: {0}",this.ey.toString())):(this.$L.errors++,dc.ULS.sendTraceTag(537155413,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: {0}, SelectedRange: {1}",null===L||void 0===
L?void 0:L.ActiveCell,null===L||void 0===L?void 0:L.SelectedRange)),this.UC=Ma}catch(rb){this.UC=12,dc.ULS.sendTraceTag(525135958,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception {0}",rb)}finally{7!=this.UC?this.Qr():this.iXc(!1,!0)}};oa.prototype.dispose=function(){this.gridView.Ea.tv(this.Oi);this.gridView.Ea.Vq(this.g9a);this.gridView.Ea.QOf(this.g9a);this.gridView.Ea.Vab(this.g9a);td.EwaSettings.isChangeGateEnabled("OfficeVSO:6385622_SelectionAdjustImplementsCustomReportManager")&&
this.$.yl(this.vd)};oa.prototype.vaf=function(){return 1===this.UC||7===this.UC};oa.prototype.Ltj=function(L){var Ma=this,rb,ec;if(!function(){var yd=$e.Z(L.ActiveCell,Ma.$.xa);rb=yd.range;return yd}().returnValue)return dc.ULS.sendTraceTag(537155411,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell {0}",L.ActiveCell),null;var fd=[];if(this.QCb)if(L.SelectedRanges)fd=$e.g(L.SelectedRanges.Ranges);else return dc.ULS.sendTraceTag(522826913,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: SelectedRanges is null"),
null;else{if(!function(){var yd=$e.Z(L.SelectedRange,Ma.$.xa);ec=yd.range;return yd}().returnValue)return dc.ULS.sendTraceTag(537155410,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract selected range {0}",L.SelectedRange),null;fd.push(ec)}return new this.kWf(this.$,rb,fd,L.SheetName,this.ey.activeItemName,this.ey.nt)};oa.prototype.Kaa=function(){var L=this.$.qa;if((null===L||void 0===L?0:L.activeCell)&&L.selectedRanges&&L.sheetName)return new this.kWf(this.$,L.activeCell,
L.selectedRanges,L.sheetName,this.$.activeItemName,L.nt);dc.ULS.sendTraceTag(525135957,0,10,"SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: {0}, activeCell null: {1}, selectedRanges null: {2}, sheetName null: {3}",!L,!(null===L||void 0===L?0:L.activeCell),!(null===L||void 0===L?0:L.selectedRanges),!(null===L||void 0===L?0:L.sheetName));return null};oa.prototype.eEe=function(){var L=this;this.$.da.$a(276,function(){var Ma=gf.a(L.$);Ma.D2(L.a1d);Ma.D2(L.b1d)})};oa.prototype.iXc=
function(L,Ma){var rb;if(this.Wji(L))if(td.EwaSettings.isChangeGateEnabled("OfficeVSO:6280340_preventRecursionOfAttemptAdjustSelection")&&8===this.UC)dc.ULS.sendTraceTag(523106438,0,15,"SelectionAdjustManager.attemptAdjustSelection: skipping as was already adjusted");else{Ma&&dc.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");try{if(dc.ULS.shipAssertTag(525135956,0,7===this.UC,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),
this.ey.equals(this.Kaa()))if(this.Qcj&&(null===(rb=this.gridView)||void 0===rb?0:rb.isEditing))this.$L.editBoxDivergence++,this.UC=11;else{L=0;if(this.QCb&&(L=this.Vy.nt,-1==L)){this.$L.errors++;dc.ULS.sendTraceTag(522826912,0,10,"SelectionAdjustManager.attemptAdjustSelection: invalid indexOfActiveRange");return}this.$L.adjusted++;this.UC=8;td.EwaSettings.isChangeGateEnabled("OfficeVSO:6413876_AdjustSelectionWithoutCallingGoto")?this.gridView.ha.GB(this.Vy.selectedRanges,L,this.Vy.activeCell,0,void 0,
kb.a.iWf):this.gridView.xV(this.Vy.selectedRanges,L,this.Vy.sheetName,null,this.Vy.activeCell,null,null,0,kb.a.iWf)}else this.$L.divergenceOnViewportReady++,this.OQf(),this.UC=9}catch(ec){this.UC=12,dc.ULS.sendTraceTag(525135955,0,10,"SelectionAdjustManager.attemptAdjustSelection: caught Exception {0}",ec)}finally{this.Qr()}}};oa.prototype.Wji=function(L){if(!this.Vy)return!1;if(!this.ey)return dc.ULS.sendTraceTag(537155409,0,10,"SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: {0}",
this.Vy.toString()),!1;if(this.Voe&&ae.g(this.$).Ea.tvd<this.iMb)return!1;if(L||this.xGj){if(!this.Voe&&ae.g(this.$).Ea.tvd<this.iMb)return!1;(this.QCb||this.ey.iCa)&&dc.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust")}else if(!this.ey.iCa&&!this.QCb||!this.ey.Meg(this.iMb)||!this.Vy.Meg(this.iMb))return!1;return!0};oa.prototype.Qr=function(){var L,Ma,rb,ec;this.wdj&&2!=this.UC&&dc.ULS.sendTraceTag(526792898,
0,50,"SelectionAdjustManager.clearState: initial: {0}, adjusted: {1}, state: {2}, hidden: {3}",null!==(Ma=null===(L=this.ey)||void 0===L?void 0:L.toString())&&void 0!==Ma?Ma:"null",null!==(ec=null===(rb=this.Vy)||void 0===rb?void 0:rb.toString())&&void 0!==ec?ec:"null",xf[this.UC],Uf.a.jB(this.ypf));this.ey=this.Vy=null;this.UC=0};oa.prototype.OQf=function(){var L=this.Kaa();dc.ULS.sendTraceTag(537155408,0,50,"SelectionAdjustManager.ReportDivergence: initial: {0} current: {1} adjusted: {2} sheetSameBetweenInitialAndAdjusted: {3} sheetSameBetweenInitialAndCurrent: {4}",
this.ey.toString(),L?L.toString():"",this.Vy.toString(),this.ey.sheetName===this.Vy.sheetName,this.ey.sheetName===(L?L.sheetName:null))};Ck.Object.defineProperties(oa.prototype,{kWf:{configurable:!0,enumerable:!0,get:function(){return qa}},$L:{configurable:!0,enumerable:!0,get:function(){return Uf.a.jB(this.ypf)?this.b1d:this.a1d}}});Object(nd.a)(oa,"SelectionAdjustManager",null,[880,3]);var Zf=we.a;Wl(xa,Zf);xa.prototype.CZb=function(L){this.Nfa.CZb(L)};xa.prototype.Rsc=function(L){this.Nfa&&this.Nfa.Rsc(L)};
xa.prototype.yza=function(L,Ma){this.FCa.yza(L,Ma)};xa.prototype.lXd=function(L){this.FCa.lXd(L)};xa.prototype.qya=function(L,Ma){this.MWa.qya(L,void 0===Ma?"":Ma)};xa.prototype.dispose=function(){this.qec&&(this.qec.dispose(),this.qec=null);this.eAa&&this.eAa.dispose();this.o1a.dispose();this.XJd&&(this.XJd.dispose(),this.XJd=null);this.Nfa&&(this.Nfa.dispose(),this.Nfa=null);this.MWa.dispose();this.MWa=null;this.FCa.dispose();this.FCa=null;this.r_a&&(this.r_a.dispose(),this.r_a=null);this.e5a&&
(this.e5a.dispose(),this.e5a=null);this.$=null;Zf.prototype.dispose.call(this)};xa.prototype.KGb=function(){this.Nfa.D2i()};xa.Q$b=function(L){var Ma=0;L=Gl(L);for(var rb=L.next();!rb.done;rb=L.next()){rb=rb.value;if(2==rb)return 2;1==rb&&(Ma=1)}return Ma};xa.prototype.C8h=function(L,Ma){this.FCa=new Pa(this.o1a,this.MWa);Ma?Object(ji.a)(mb,Ma)?this.yza(Ma,Object(Wb.a)(mb,Ma).XH):Object(ji.a)(cc,Ma)?this.yza(Ma,Object(Wb.a)(cc,Ma).XH):this.yza(Ma,0):(this.r_a=new cc(L),this.e5a=new mb(L),this.yza(this.r_a,
this.r_a.XH),this.yza(this.e5a,this.e5a.XH))};Ck.Object.defineProperties(xa.prototype,{Mha:{configurable:!0,enumerable:!0,get:function(){return this.FCa}},vma:{configurable:!0,enumerable:!0,get:function(){return this.MWa}},X5:{configurable:!0,enumerable:!0,get:function(){return this.Nfa}}});Object(nd.a)(xa,"MergeSuspensionManager",we.a,[851,3]);var Ne=vg.a;Wl(ta,Ne);ta.prototype.create=function(){dc.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");this.Eb(this.Rc.da.za(343)||this.Rc.da.Ga(343,
new xa(this.Rc,Kb.a.instance)))};ta.ka=function(L){dc.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");L.da.Ga(344,new ta(L))};Object(nd.a)(ta,"MergeSuspensionFactory",vg.a,[]);ha.Xqi=3;ha.connected=0;Object(nd.a)(ha,"ConnectionStateConstants",null,[]);var ch=b(111),yh=b(119),nf=b(44);U.prototype.iYf=function(){this.durationMs=yh.a(Sc.a.Ua,this.startTime)};U.prototype.CAd=function(L){var Ma=this,rb;this.iYf();nf.a(L).Nsc(this.Ctf);nf.a(L).yg.Osc(this.zca);L.da.$a(291,function(ec){ec.Xab(Ma.mW)});
if(null===(rb=L.ea)||void 0===rb?0:rb.Ue)L.ea.Ue.fJd(this.xBd),this.wasUserActiveOnPIEnd=L.ea.Ue.ur};U.prototype.Ej=function(L){var Ma=this;nf.a(L).rZb(this.Ctf);this.isToastShown?this.toastRaiser="Immediate":nf.a(L).yg.hVc(this.zca);L.da.$a(291,function(rb){Ma.hasTabbedOut=rb.zi;rb.AFa(Ma.mW)});this.wasUserActiveOnPIStart&&L.ea.Ue.Lne(this.xBd)};Object(nd.a)(U,"PartialInteractivityData",null,[]);var Ci=b(1281);Wl(Y,U);Y.prototype.GGi=function(L,Ma){this.swappedByOffline=Ma;this.CAd(L)};Y.prototype.goj=
function(L){this.errorDataDuringConnectivityIssuesMode=L};Y.prototype.W4i=function(L){10>this.failedRequests.length&&(L=L+"_"+ch.getElapsedSeconds(this.startTime,Sc.a.Ua.Vb).toString(),this.failedRequests.push(L))};Object(nd.a)(Y,"ConnectivityIssuesData",U,[]);var kh=b(178);R.Ehh="DuringWork";R.connectivityIssues="ConnectivityIssues";R.offline="Offline";Object(nd.a)(R,"UnavailabilityTypes",null,[]);I.prototype.dispose=function(){this.$&&(nf.a(this.$).yg.ZOf(this.Puf),this.$.rf&&this.$.rf.YOf(this.Muf));
this.data&&this.$.na.rf.WPf(this.Wn);this.$=null};I.prototype.GSg=function(L){var Ma=this.l$c-1;return(this.data.averageDurationBetweenFailedRequestsSec*(Ma-1)+L)/Ma};Object(nd.a)(I,"ConnectivityIssuesTelemetryManager",null,[3]);var Xi=b(1061),hi=b(1325),Mi=b(1280);G.prototype.dispose=function(){this.$&&(this.tQd&&this.$.na&&0<this.L8a.count&&this.$.na.Ar(this.Uh),this.uQd&&(this.nTd("Dispose"),this.$.ea.Ue.Gza(this.yca)))};G.prototype.g8h=function(){td.EwaSettings.ma(213)&&this.PYi();this.uQd&&this.QYi()};
G.prototype.D8h=function(){this.wDb=this.xDb;this.Qrd=0;var L={};if(!this.L8a){this.L8a=new Dg.a;var Ma=hi.a.Tbd(this.vdj,"InitSampleMeasurement",this.$);Ma=Gl(Ma);for(var rb=Ma.next();!rb.done;rb=Ma.next())rb=rb.value,L[rb.Jjd]=rb.baseUrl,this.L8a.add(rb)}L=Sys.Serialization.JavaScriptSerializer.serialize(L);dc.ULS.sendTraceTag(537155210,0,50,"Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: {0}, numberOfRequestFromTheLastNetworkMeasurement: {1}, testParams: {2} ",this.xDb,this.wDb,
L);0<this.L8a.count&&this.$.na.zq(this.Uh)};G.prototype.bDj=function(){for(var L=Gl(this.L8a),Ma=L.next();!Ma.done;Ma=L.next())Ma.value.runTest()};G.prototype.TSd=function(L){this.fSa&&this.fSa.yo||(dc.ULS.sendTraceTag(537155208,0,50,"NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: {0}",L),this.fSa=Kb.a.instance.tC(this.Pkj,5E3,qc.a.ZAj),this.fSa.qka())};G.prototype.nTd=function(L){this.fSa&&this.fSa.yo&&(dc.ULS.sendTraceTag(537155207,0,50,"NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: {0}",
L),this.fSa.cancel())};G.prototype.lvj=function(L){return this.wDb>=this.xDb&&L-this.Qrd>this.Zvd};G.prototype.mWg=function(){return G.oTf(this.$.ya.SlowNetworkMeasurementsSamplePercentage)};G.prototype.PYi=function(){this.xDb=this.$.ya.NumberOfRequestToWaitPerNetworkMeasurement;this.Zvd=1E3*this.$.ya.MinTimeBetweenNetworkMeasurementInSec;var L=this.$.ya.NetworkMeasurementsSamplePercentage;0<this.xDb&&0<this.Zvd&&(this.tQd=G.oTf(L))&&this.D8h()};G.prototype.QYi=function(){if(!this.dyc){this.dyc=new Dg.a;
var L=hi.a.Tbd(this.Lcj,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[Mi.a.LDc]);L=Gl(L);for(var Ma=L.next();!Ma.done;Ma=L.next())this.dyc.add(Ma.value);this.$.ea.Ue.ur&&this.TSd("PrepareAndInitSlowNetworkTests")}};G.oTf=function(L){return 100*Math.random()<L};Object(nd.a)(G,"NetworkMeasurement",null,[3]);var uj=b(993);E.prototype.cPj=function(){this.JU&&this.JU.iYf()};E.prototype.wBg=function(L){this.allOfflinePartialInteractivitiesDataInSession.push(L);this._count++};Ck.Object.defineProperties(E.prototype,
{count:{configurable:!0,enumerable:!0,get:function(){return this._count}},JU:{configurable:!0,enumerable:!0,get:function(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]}}});Object(nd.a)(E,"OfflinePartialInteractivitiesDataForLog",null,[]);Wl(aa,U);aa.prototype.Frj=function(L){this.timeFromLastOffline=L};aa.prototype.hoj=function(L){this._errorDataDuringOfflineMode=L};Object(nd.a)(aa,"OfflinePartialInteractivityData",U,[]);V.prototype.dispose=
function(){this.$&&nf.a(this.$)&&nf.a(this.$).yg.KId(this.H9a);Ga.a.Ha(this.Stb);this.$=this.Stb=null};V.prototype.LNi=function(L){this.JU=new aa(Sc.a.Ua.Vb,this.$,0!==L);this.JU.Frj(-1!==this.xEd?window.performance.now()-this.xEd:-1);this.kOa.wBg(this.JU);nf.a(this.$).yg.hVc(this.zca);this.D2a();this.Stb=Kb.a.instance.tC(this.D2a,V.sBh,qc.a.D2a);kh.a(this.$).PUc(this.wUf)};V.prototype.MNi=function(){this.JU.CAd(this.$);this.D2a();Ga.a.Ha(this.Stb);this.Stb=null;this.xEd=window.performance.now();
nf.a(this.$).yg.Osc(this.zca);kh.a(this.$).yId(this.wUf);this.Mcj()};V.prototype.pij=function(L,Ma){var rb=this;this.$?this.Tif=Pd.TaskExtensions.Ba(this.Tif,function(){rb.indexedDB.Tbb(new uj.a(L,Ma))},this.$.la):dc.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")};V.prototype.Gcj=function(){var L=this.$.la;Pd.TaskExtensions.Ba(Pd.TaskExtensions.Ba(this.indexedDB.E3a(V.ACd),this.ldj,L),this.A8i,L)};V.prototype.Mcj=
function(){if(this.JU){var L=Sys.Serialization.JavaScriptSerializer.serialize(this.JU);td.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?hg.b().PJb(560791645,0,50,R.offline,this.JU.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",L):dc.ULS.sendTraceTag(560791645,0,50,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",
L)}td.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&this.JU&&this.JU.isToastShown&&pc.Health.instance.recordQosError(ic.a.OSj,[Rc.a.yjc],!0,!1,!1,!1,null)};V.Mkd="NetworkAvailability";V.Nkd="NetworkAvailabilityData";V.ACd="partialInteractivityData";V.sBh=3E3;Object(nd.a)(V,"OfflineModeTelemetryManager",null,[3]);ba.prototype.dispose=function(){Ga.a.Ha(this.wsf);Ga.a.Ha(this.Zwd);Ga.a.Ha(this.Cla);Ga.a.Ha(this.P0g);this.$=null};Object(nd.a)(ba,"NetworkConnectionTelemetryManager",
null,[3]);Wl(M,U);M.prototype.H9a=function(){this.wasInteruptedByOfflineMode=!0};Object(nd.a)(M,"SilentReopenData",U,[]);Q.prototype.dispose=function(){this.yg.yPf(this.yyf);this.yg.qbj(this.hCf);this.H7=this.yg=this.$=null};Q.prototype.eCf=function(L,Ma){L.RL?this.H7=new M(Sc.a.Ua.Vb,this.$,0!==L.loa,Ma):(5===L.loa&&(this.H7.wasInteruptedByOfflineMode=!0),3!==L.loa&&2!==L.loa||dc.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),
this.H7.CAd(this.$),2===Ma?td.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?hg.b().QJb(571289604,0,50,R.offline,this.H7.durationMs,this.H7):dc.ULS.sendTraceTag(571289604,0,50,Xf.a.Jc(this.H7)):td.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?hg.b().QJb(542782150,0,50,R.Ehh,this.H7.durationMs,this.H7):dc.ULS.sendTraceTag(542782150,0,50,Xf.a.Jc(this.H7)),this.H7=null)};Object(nd.a)(Q,"SilentReopenPartialInteractivityTelemetryManager",
null,[3]);var uh=le.a;Wl(P,uh);P.prototype.dispose=function(){this.rf&&(this.Twc&&(this.rf.qaj(this.yEb),this.rf.YHb(this.hzf)),this.rf.YOf(this.Nuf),this.rf.e$i(this.Ouf));this.Lzb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.QHb(this.lya),this.Lzb=!1);this.$&&(this.Qrc&&this.UAc(),this.$.ea&&(this.$.ea.OPf(this.gCf),this.$.ea.Ue&&this.$.ea.Ue.Gza(this.yca)));td.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.Y0&&(this.Y0.dispose(),
this.Y0=null);Ga.a.Ha(this.Iqf);this.$=null;uh.prototype.dispose.call(this)};P.prototype.gxi=function(){this.mQd=!0};P.prototype.tje=function(){this.Yna||(this.Yna=nf.a(this.$).yg.YXa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))};P.prototype.Adi=function(){if(this.mQd)return this.mQd=!1,!0;var L=this.S7>this.omf||this.Fkd>this.omf&&10>this.S7;dc.ULS.sendTraceTag(537155223,0,50,"NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:{0}, Time gap between last two activities: {1}. return value:{2}",
this.S7,this.Fkd,L);return L};P.prototype.ydj=function(){td.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&(this.Y0=Kb.a.instance.create(function(){pc.Health.instance.recordQosError(ic.a.dBj,[Rc.a.yjc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0))};P.prototype.azg=function(){var L=this;this.Yna||this.L0?dc.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):
this.L0=Kb.a.instance.create(function(){L.$?L.Yna?dc.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):ae.g(L.$).isEditing?(L.Jab||(ae.g(L.$).tc.Kn(L.Tf),dc.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),L.Kab=
!0,dc.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):L.tje():dc.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.N3f,qc.a.bAj,void 0,!0)};P.prototype.Epf=function(L){this.L1c=this.Rue(2,L,!0);this.hoe()};P.prototype.glc=function(L,
Ma){this.gWb=this.Rue(L,Ma,!1);this.hoe()};P.prototype.Rue=function(L,Ma,rb){rb=rb?this.L1c:this.gWb;return Ma?rb|L:rb&~L};P.prototype.tVd=function(){var L=!!this.lOa,Ma=!!this.bSa,rb=!!this.Yna,ec=!!this.t3b;this.WBb&&!L?this.$yg():!this.WBb&&L&&this.kbh();!this.hkc||Ma||rb?this.hkc||(Ma?this.EFe():(rb||this.L0&&this.L0.yo)&&this.FFe()):this.W0f&&this.Dfa?this.Yyg():!this.$Kb||this.Dfa||td.EwaSettings.isChangeGateEnabled("OfficeVSO:5658794_DontActivatePartialInteractivityIfTimerIsRunning")&&this.L0||
this.azg();this.vka&&!ec?this.R8f(!0):!this.vka&&ec&&this.R8f(!1)};P.prototype.$yg=function(){this.$?this.lOa?dc.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):ae.g(this.$).isEditing?(this.Kab||(ae.g(this.$).tc.Kn(this.Tf),dc.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),
this.Jab=!0,dc.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.wje():dc.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")};P.prototype.wje=function(){this.lOa||(this.lOa=nf.a(this.$).yg.YXa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))};P.prototype.kbh=function(){this.lOa&&
(Ga.a.Ha(this.lOa),this.lOa=null)};P.prototype.EFe=function(){this.bSa&&(Ga.a.Ha(this.bSa),this.bSa=null);td.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.Y0&&this.Y0.yo&&this.Y0.cancel();this.Y0=null};P.prototype.FFe=function(){this.Yna&&(Ga.a.Ha(this.Yna),this.Yna=null);this.L0&&(Ga.a.Ha(this.L0),this.L0=null);this.Kab&&!this.Jab&&ae.g(this.$).tc.Um(this.Tf);this.Kab=!1};P.prototype.Yyg=function(){this.bSa||(this.bSa=nf.a(this.$).yg.YXa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,yf.a.instance.ga(2153)));this.ydj()};P.prototype.R8f=function(L){L?(this.t3b=nf.a(this.$).yg.YXa(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.U0i()):(Ga.a.Ha(this.t3b),this.t3b=null)};P.prototype.U0i=function(){if(this.$&&this.$.na){var L=this.$.na.va.hc();oc.jb(this.$.na.va,null,null,null,L)}};P.prototype.UAc=function(){ah.a(this.$).KQ(bh.a.QOa).Wq(this.rzf);this.$.yl(this.vd);this.Qrc=!1};P.prototype.hoe=function(){this.documentVisibilityObserver||dc.ULS.sendTraceTag(537155211,
0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");this.documentVisibilityObserver&&this.documentVisibilityObserver.zi?this.Lzb||(this.documentVisibilityObserver.fnb(this.lya),this.Lzb=!0,dc.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.tVd()};Ck.Object.defineProperties(P.prototype,
{Bfi:{configurable:!0,enumerable:!0,get:function(){return this.Dfa}},WBb:{configurable:!0,enumerable:!0,get:function(){return!(this.gWb&1)}},hkc:{configurable:!0,enumerable:!0,get:function(){return!(this.gWb&2)}},vka:{configurable:!0,enumerable:!0,get:function(){return!!(this.L1c&2)}}});Object(nd.a)(P,"NetworkConnectionStateManager",le.a,[850,3]);var Ui=vg.a;Wl(N,Ui);N.prototype.create=function(){var L=this;Pd.TaskExtensions.Ba(Ob.GetServiceTaskFactory.Xa(this.$.da,395,396,this.vb),function(Ma){L.Eb(L.$.da.za(400)||
new P(L.$,Ma.result))},this.$.la,3)};N.ka=function(L){L.da.Ga(401,new N(L))};Object(nd.a)(N,"NetworkConnectionStateManagerFactory",vg.a,[]);var Zh=b(1434),fi=b(1236);B.prototype.dispose=function(){this.wag();this.Dag();this.Urd=this.Jrd=this.IK=this.ym=this.vr=this.crc=this.$=null;this.EZd=0};B.prototype.yNg=function(L){this.IK=L;this.Jrd=L.nHg;this.Urd=L.p5i};B.prototype.oIa=function(){if(this.IK){var L=$e.K(this.IK.Iwh);this.mBj(L);this.hide();this.wag();this.IK=null}};B.prototype.mBj=function(L){var Ma=
[1868184698,-1985798686,753331043,2137617149,237279923,1804571062,1766348718,42074747,-875588320,-958589048,-185374993,-111689794,-1502853784,-1096627081];Gd.AFrameworkApplication.z_("XLS-SmartView-OnPasteEnabled-Control; XLS-SmartView-OnPasteEnabled-Treatment");td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.OnPasteEnabled",!1)&&L&&(dc.ULS.sendTraceTag(523622037,0,50,"RecoveryUIController.SmartViewOnPaste: RecoveryUI is being dismissed."),null!=this.MAb&&Ma.includes(this.MAb.command)?
(dc.ULS.sendTraceTag(526758984,306,50,"RecoveryUIController:dismissRecoveryUI Table hand raise is not triggered. Last command was {0}",fi.a[this.MAb.command]),this.MAb=null):this.documentHidden?(dc.ULS.sendTraceTag(523833603,306,50,"RecoveryUIController:dismissRecoveryUI Table hand raise is not triggered. User clicked outside of document."),this.documentHidden=!1):ae.g(this.$).Nb.s5(L)?dc.ULS.sendTraceTag(526758983,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a table. Table hand raise is not triggered."):
ae.g(this.$).Nb.Ika(L)?dc.ULS.sendTraceTag(526758982,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a pivot table. Table hand raise is not triggered."):(Ma=Yc.d(this.$.xa.qa),L=new vd.a(L,Ma),this.HKj(L)))};B.prototype.bki=function(){return!!this.IK&&this.crc.ugi};B.prototype.qzj=function(L){this.IK?this.show(L):dc.ULS.shipAssertTag(537154072,0,!1,"RecoveryUIController.ShowRecoveryUI: recoveryUI is null.")};B.prototype.aQh=function(){return this.IK?this.IK.cqi:null};B.prototype.show=
function(L){var Ma=this.IK.VLh();Ma?(this.crc.showFloatie(Object(kg.a)(new Zh.a,{x:Ma.x,y:Ma.y}),this.IK.QJa(),L),this.Ej()):dc.ULS.sendTraceTag(537154071,0,100,"RecoveryUIController.Show: point is null.")};B.prototype.hide=function(){this.bki()&&this.crc.AC();this.Dag()};B.prototype.Ej=function(){if(!this.y6b){var L=ae.g(this.$);L.view.Rs(this.ycg);L.Nj.ql(this.OHe);this.ym.ka("blur",this.cfh);this.$.Ka.Wra(this.uN);this.$.xa.og(this.PHe);(L=this.$.da.za(65))&&L.o3&&L.o3.registerForCommentEvents(this.NHe);
this.y6b=!0}this.Adc||(this.vr.xt(jf.a.Xb,this.$.domElement,this.onKeyDown,!0),this.vr.xt(jf.a.Vd,this.$.domElement,this.onKeyUp,!0),this.Adc=!0)};B.prototype.wag=function(){if(this.y6b){var L=ae.g(this.$);L.view.Xq(this.ycg);L.Nj.kl(this.OHe);this.ym.detach("blur");this.$.Ka.Dza(this.uN);this.$.xa.Wg(this.PHe);(L=this.$.da.za(65))&&L.o3&&L.o3.unregisterForCommentEvents(this.NHe);this.y6b=!1}};B.prototype.Dag=function(){this.Adc&&(this.vr.Dt(jf.a.Xb,this.$.domElement,this.onKeyDown,!0),this.vr.Dt(jf.a.Vd,
this.$.domElement,this.onKeyUp,!0),this.Adc=this.r_=this.S8b=!1)};B.prototype.UQj=function(){this.IK&&250<=Sc.a.Ua.oe.m-this.EZd&&this.show(-1)};B.prototype.HKj=function(L){Pd.TaskExtensions.Ba(Ob.GetServiceTaskFactory.Xa(this.$.da,426,427,1),function(Ma){Ma.result.pea(L,"Paste");dc.ULS.sendTraceTag(523622036,0,50,"RecoveryUIController.triggerTableInvitationHandRaise: IntelligentMetadataOverlayManager is triggered.")},this.$.la,3)};Object(nd.a)(B,"RecoveryUIController",null,[847,3]);var wg=vg.a;Wl(A,
wg);A.prototype.create=function(){var L=this;if(td.EwaSettings.Gl())this.sBi();else{var Ma=this.$;Ma.LC(function(rb){rb.tec().then(function(ec){L.Eb(L.$.da.za(406)||new B(Ma,ec,Gf.KeyInputManager.instance,Df.a.instance.VG()))})})}};A.prototype.sBi=function(){var L=this,Ma=this.$,rb=this.$.da.za(406);rb?this.Eb(rb):Ma.LC(function(ec){ec.tec().then(function(fd){rb=new B(Ma,fd,Gf.KeyInputManager.instance,Df.a.instance.VG());L.$.da.Ga(406,rb);L.Eb(rb)})})};A.ka=function(L){L.da.Ga(405,new A(L))};Object(nd.a)(A,
"RecoveryUIControllerFactory",vg.a,[]);var gj=b(731),Ei=b(609),Fi=b(42),ck=b(1254),Uh=Vd.a;Wl(D,Uh);D.prototype.validate=function(){this.Ij.OE||dc.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Ij.OE.value?!0:(D.Wz(CommonUIStrings.l_FileUploadNoFileSpecified),!1)};D.prototype.aJi=function(L){this.cvg&&(this.Ij=this.q_f(L,this.sXb))};D.prototype.hSi=function(){this.Ij&&this.Ij.OE&&(this.P5d||(this.Ij.c7i(Object(ob.a)(this,this.Czd,"onFileChosen")),this.P5d=!0),
this.Ij.QRe())};D.prototype.Czd=function(L){this.UWa.uploadStatusLabel=L;this.Leb(this.titleText,Object(ob.a)(this,this.Lec,"insertDialogHandler"),this.UWa)};D.prototype.Lec=function(L){1===L&&this.isEnabled()?D.Au&&this.Ij.OE&&!this.Ij.OE.value?(this.UWa.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.Leb(this.titleText,Object(ob.a)(this,this.Lec,"insertDialogHandler"),this.UWa)):(this.hxb(),this.sXb.finalizeUpload(this.Ij,Object(ob.a)(this,this.dispose,"dispose"))):0===L&&this.hide()};
D.prototype.r_f=function(){this.lIc=!1;this.Ij=this.q_f(document.getElementById("uploadFrameContainer"),this.sXb);Gd.AFrameworkApplication.fa.ra("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.yga=Object(ob.a)(this,this.vBd,"onUploadFrameLoad"),Fi.a.addHandler(this.Ij.iFrame,"load",this.yga));this.Ij.OE||dc.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.tIf()};D.prototype.vBd=function(){this.tIf()};D.prototype.tIf=function(){if(this.Ij&&!this.lIc){var L=this.Ij.OE;
L&&(Fi.a.addHandler(L,jf.a.Xb,Object(ob.a)(this,this.onKeyDown,"onKeyDown")),L=[L],this.cn=L.concat.apply(L,this.cn),this.hcg(),this.lIc=!0)}};D.prototype.dispose=function(){if(this.Ij&&!D.Au){var L=this.Ij.OE;L&&Fi.a.removeHandler(L,jf.a.Xb,Object(ob.a)(this,this.onKeyDown,"onKeyDown"));this.yga&&Fi.a.removeHandler(this.Ij.iFrame,"load",this.yga)}this.Ij=null;Uh.prototype.dispose.call(this)};D.prototype.hcg=function(){if(0<this.cn.length){var L=new ck.a(this.cn),Ma=Pf.FocusManager.instance().MQ();
Ma&&(this.cn[0].focus(),Ma.jf=L,Ma.A_=!0)}};D.prototype.onKeyDown=function(L){4!==Pf.FocusManager.instance().vIf(L)&&L.preventDefault()};D.Wz=function(L){var Ma=document.getElementById("errorText");Ma.innerText=L;Ma.style.display="inline-block"};Ck.Object.defineProperties(D.prototype,{oSj:{configurable:!0,enumerable:!0,get:function(){return this.sXb}}});Ck.Object.defineProperties(D,{Au:{configurable:!0,enumerable:!0,get:function(){return Gd.AFrameworkApplication.sa.Qa.lv&&Gd.AFrameworkApplication.sa.Qa.hff}}});
Object(nd.a)(D,"InsertFileDialog",Vd.a,[]);Ck.Object.defineProperties(z,{hg:{configurable:!0,enumerable:!0,get:function(){return Vd.a.$o(z.zk,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}});z.zk="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(nd.a)(z,
"InsertImageDialogHtml",null,[]);Wl(t,D);t.prototype.validate=function(){this.Ij.OE||dc.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var L=Object(Wb.a)(Eb,this.oSj),Ma=L.deg(this.Ij.OE.value);return 0!==Ma?(D.Wz(L.iYe(Ma)),!1):!0};Ck.Object.defineProperties(t.prototype,{PXb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadButtonText}},titleText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadingTitle}},
geh:{configurable:!0,enumerable:!0,get:function(){return z.hg}}});Object(nd.a)(t,"InsertImageDialog",D,[]);var Xg=b(615),Oi=b(205),Wj=b(493);w.prototype.Z9e=function(){this.JD=Lg.a.create().toString();this.Qqa?this.R7c():this.Rpe()};w.prototype.J3g=function(L){this.eo=document.createElement("iframe");this.eo.className=L;this.eo.id=L;this.t6d&&(this.eo.style.visibility="visible",this.eo.style.height="30px",this.eo.setAttribute("frameborder","0"));this.yga=Object(ob.a)(this,this.vBd,"onUploadFrameLoad");
Fi.a.addHandler(this.eo,"load",this.yga)};w.prototype.P6b=function(L){var Ma=this;L=void 0===L?null:L;Gd.AFrameworkApplication.sa.hqc();if(!this.er)return dc.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";Fi.a.addHandler(this.er,"change",function(){Ma.qyh(L)});v(Object(ob.a)(this,this.QRe,"fileInputClick"),1,"DoFileOpenDialog");return this.er.value};w.prototype.qyh=function(L){L&&L(this.er.value)};w.prototype.ryh=function(){this.oSb&&(this.oSb.innerText=this.uZe())};w.prototype.c7i=function(L){var Ma=
this;Fi.a.addHandler(this.er,"change",function(){L(Ma.uZe())})};w.prototype.uZe=function(){var L=null;if(this.er.value){var Ma=this.er.value,rb=Ma.lastIndexOf("\\");0<rb&&(L=Ma.substring(rb+1,Ma.length))}return L?L:""};w.prototype.QRe=function(){try{dc.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.er.click()}catch(L){throw dc.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",L.message),L;}};w.prototype.iEj=function(){this.$ki()?
this.i6f():(this.tYd(),this.Gs.submit())};w.prototype.$ki=function(){return(this.eqg||this.Qqa)&&!(void 0===window.self.FormData||null===window.self.FormData)};w.prototype.JWf=function(L){if(L){var Ma=this.cCe();this.Pg=new XMLHttpRequest;this.Pg.open("POST",Ma);this.Pg.setRequestHeader("X-CorrelationId",this.JD);this.fti(L);this.Pg.onreadystatechange=Object(ob.a)(this,this.Ooa,"uploadResponseReceived");this.Pg.send(L)}};w.prototype.fti=function(L){if(!Ag.a.lB&&L.get){var Ma=L.get("ImageId");L=window.self.navigator;
var rb={};Ma=(rb.CorrelationId=this.JD,rb.Canary=Gd.AFrameworkApplication.canary,rb.ImageNodeId=Ma,rb);L&&(L=L.connection?L.connection:L.mozConnection?L.mozConnection:L.webkitConnection?L.webkitConnection:null)&&(Ma.effectiveType=L.effectiveType,Ma.downlink=L.downlink,Ma.type=L.type,Ma.rtt=L.rtt);dc.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",Ma)}};w.prototype.i6f=function(){try{this.tYd();dc.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");
var L=new (Type.parse("FormData"))(this.Gs);this.JWf(L)}catch(Ma){dc.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+Ma.message),this.T9a(null)}};w.prototype.h6f=function(L){try{if(this.tYd(),dc.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.zTj(L)){this.pSb=L;this.Gs.contains(this.er)&&this.Gs.removeChild(this.er);var Ma=new (Type.parse("FormData"))(this.Gs);Ma.append("applicationfileInput",
L.blob,L.filename);this.JWf(Ma)}else this.T9a(null)}catch(rb){dc.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+rb.message),this.T9a(null)}};w.prototype.zTj=function(L){return L&&void 0!==L.blob&&null!==L.blob&&void 0!==L.filename&&null!==L.filename&&""!==L.filename?void 0===window.self.FormData||null===window.self.FormData?(dc.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(L=L?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",
void 0===L.blob||null===L.blob,void 0===L.filename||null===L.filename||""===L.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",dc.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",L)),!1)};w.prototype.Ooa=function(){if(4===this.Pg.readyState)if(200===this.Pg.status){dc.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.JD);var L=this.Pg.getResponseHeader("X-NewKey"),
Ma=this.cei(this.Pg),rb=!1;if(void 0!==L&&null!==L&&Ma&&(rb=this.pTj(L),!this.uSc&&rb)){dc.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.JD);this.uSc=!0;void 0!==this.pSb&&null!==this.pSb?this.h6f(this.pSb):this.i6f();return}dc.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.uSc,
Ma,!(void 0===L||null===L),rb,this.JD);this.T9a(this.Pg.responseText)}else dc.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Pg.status,this.Pg.responseText?!1:!0,this.JD),this.T9a(null)};w.prototype.cei=function(L){try{var Ma=If.a(L.responseText).Responses;if(void 0!==Ma&&null!==Ma&&1===Ma.length){var rb=Ma[0];if(void 0!==rb&&null!==rb&&2===rb.length&&28===rb[1].StatusCode)return!0}}catch(ec){}return!1};w.prototype.pTj=function(L){Wj.a.mbg(L);
return Gd.AFrameworkApplication.canary!==L?!1:!0};w.prototype.tYd=function(){this.vSc||(this.vSc=new Date)};w.prototype.dispose=function(){this.Cm||(this.Qqa?this._parent.removeChild(this.Gs):(this._parent.removeChild(this.eo),Fi.a.removeHandler(this.eo,"load",this.yga),this.yga=null),this.kIc&&(Fi.a.removeHandler(this.er,"change",this.kIc),this.kIc=null),this.RRe&&(this.fib&&(Fi.a.removeHandler(this.er,"change",this.fib),this.fib=null),this.oSb=null),this.er=this.Gs=this._parent=this.eo=null,this.Cm=
!0,this.vSc=null,dc.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))};w.prototype.delayedDispose=function(){this.dispose()};w.prototype.l6g=function(L){if(this.Gs){var Ma;(Ma=this.Gs.querySelector("input[name=__REQUESTDIGEST]"))?Ma.value=L:(Ma=this.s3c(),Ma.type="hidden",Ma.id="__REQUESTDIGEST",Ma.name="__REQUESTDIGEST",Ma.value=L,this.Gs.appendChild(Ma))}};w.prototype.s3c=function(){return this.Qqa?document.createElement("input"):this.eo.contentWindow.document.createElement("input")};w.prototype.vBd=
function(){try{if(!this.eo.contentWindow.document.body)return}catch(ec){this.f3h();return}if(!(this._initialized||this.G8a&&Ag.a.mF))this.R7c();else if(!this.G8a||!Ag.a.mF||this.cii){var L=Ag.a.Of?this.eo.contentWindow.document.body.innerText:this.vdg?this.eo.contentWindow.document.body.firstChild.innerText:this.eo.contentWindow.document.body.firstChild.innerHTML;var Ma=this.eo.contentWindow.document.body.innerText.toLowerCase(),rb=0<=Ma.indexOf("responses")||0<=Ma.indexOf("wopisrc");Ma=0<=Ma.indexOf("http error");
!rb&&Ma&&dc.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this.eo.contentWindow.document.body.innerText);this.T9a(L)}};w.prototype.R7c=function(){if(!this._initialized){var L=this.ga("uploadForm"),Ma=this.ga("fileInput"),rb=this.cCe();this.S5g();this.Gs.id=L;this.Gs.method="post";this.Gs.encoding="multipart/form-data";this.Gs.action=rb;this.er.type="file";this.C0d&&(this.er.accept=this.C0d,this.y2d&&(this.er.capture=this.y2d));this.er.id=Ma;this.er.name=
Ma;this.vIg&&(this.er.multiple=!0);!this.RRe||Ag.a.Of||Ag.a.JH||(this.fib=Object(ob.a)(this,this.ryh,"fileInputChangedHandleAccessibility"),Fi.a.addHandler(this.er,"change",this.fib),this.oSb=ge.a.Npe(this.Gs,this.er,"InputFileDescription"));this.t6d&&(this.Qqa||(L=this.eo.contentWindow.document.body,L.style.margin="0",L.style.overflow="hidden"),L=Gd.AFrameworkApplication.sa,this.er.style.fontFamily=L.b1,this.er.style.fontSize=L.JAc,this.er.style.margin="0");(L=document.getElementById("__REQUESTDIGEST"))&&
this.l6g(L.value);this.Gs.appendChild(this.er);this._initialized=!0;this.Gpg(this)}};w.prototype.S5g=function(){if(this.Qqa)this.Gs=document.createElement("form"),this._parent.appendChild(this.Gs),this.er=document.createElement("input");else{this.Gs=this.eo.contentWindow.document.createElement("form");var L=this.eo.contentWindow.document;L.body.appendChild(this.Gs);this.er=L.createElement("input")}};w.prototype.Rpe=function(){this._parent.appendChild(this.eo);this.G8a&&Ag.a.mF&&this.R7c()};w.prototype.cCe=
function(){var L=new pg.QueryStringBuilder(this.WRe);Gd.AFrameworkApplication.iYa(L);this.Pmj(L);L=L.toString();if(Ag.a.Nf||Ag.a.mF||Ag.a.JH)L=sg.a.zVe(L);return L};w.prototype.Hke=function(){var L=new Hi.a(2,1,0,Object(ob.a)(this,this.delayedDispose,"delayedDispose"),4);Gd.AFrameworkApplication.Pi.Qg(L)};Ck.Object.defineProperties(w.prototype,{BSf:{configurable:!0,enumerable:!0,get:function(){return this.oug}},sessionId:{configurable:!0,enumerable:!0,get:function(){return this.zQc}},iFrame:{configurable:!0,
enumerable:!0,get:function(){return this.eo}},OE:{configurable:!0,enumerable:!0,get:function(){return this.er}},G8a:{configurable:!0,enumerable:!0,get:function(){return Gd.AFrameworkApplication.fa?Gd.AFrameworkApplication.fa.ra("NativeFileOpenDialogIsEnabled"):!1}},RRe:{configurable:!0,enumerable:!0,get:function(){return Gd.AFrameworkApplication.fa?Gd.AFrameworkApplication.fa.ra("FileInputDescriptionAccessibilityIsEnabled"):!1}},cii:{configurable:!0,enumerable:!0,get:function(){return this.Qqa?!1:
Oi.b(this.eo.contentWindow.location.pathname,this.WRe,0)}},vIg:{configurable:!0,enumerable:!0,get:function(){return!Ag.a.lB&&Gd.AFrameworkApplication.fa.ra("AllowMultipleImageInsertFromLocalDevice")}}});Object(nd.a)(w,"UploadFrame",null,[3]);Wl(u,w);u.prototype.ga=function(L){return L};u.prototype.Pmj=function(L){dc.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");Yg.a.lWc(L,this.$.ya);L.G9(Ve.a.sessionId,this.sessionId);var Ma=ae.g(this.$).ha;Ma=$e.o(Ma.ta.r4,this.$);
L.G9(Ve.a.N0i,this.$.xa.qa.name);L.G9(Ve.a.M0i,Ma.FirstRow.toString());L.G9(Ve.a.L0i,Ma.FirstColumn.toString())};u.prototype.f3h=function(){this.BSf("ServerUploadError")};u.prototype.T9a=function(L){this.BSf(L)};u.hgi=function(L){return!L||Na.a.equals(L,"ServerUploadError",!1)};Object(nd.a)(u,"UploadFrameWrapper",w,[]);Wl(x,t);x.prototype.q_f=function(L,Ma){return new u(L,Object(ob.a)(Ma,Ma.bFb,"onUploadFrameInitialized"),Object(ob.a)(Ma,Ma.Ooa,"uploadResponseReceived"),this.fa,!0,this.$)};x.prototype.dispose=
function(){this.XAc();this.ZQ=this.eCc=null;t.prototype.dispose.call(this)};x.prototype.hide=function(){t.prototype.hide.call(this);this.$.Ab.Cz=!1};x.prototype.validate=function(){var L=this.eCc.aZd(this.Ij.OE.value,this.eCc.i$f(this.Ij));return 0!==L?(L=this.eCc.wdd(L).Description,this.HXd(L),this.DTd(),!1):!0};x.prototype.isEnabled=function(){return!0};x.prototype.HXd=function(L){this.dV.innerHTML=L};x.prototype.kld=function(){this.dV=document.getElementById("errorText");this.dV.style.display=
"inline-block";this.SAa=!1;this.HXd("");this.hIa.style.maxWidth=this.hIa.currentStyle.minWidth};x.prototype.DTd=function(){this.ZQ.pa(jf.a.click,this.Ij.OE,this.Rmc);this.ZQ.pa(jf.a.Xb,this.Ij.OE,this.Rmc);this.SAa=!0};x.prototype.XAc=function(){this.SAa&&(this.ZQ.Aa(jf.a.click,this.Ij.OE,this.Rmc),this.ZQ.Aa(jf.a.Xb,this.Ij.OE,this.Rmc),this.SAa=!1)};Object(nd.a)(x,"InsertImageDialogWrapper",t,[]);Wl(h,Eb);h.prototype.dispose=function(){Ga.a.Ha(this.Y_b);this.Ij&&this.Ij.Hke();this.Ij=this.Y_b=this.xb=
null};h.prototype.i4i=function(L){function Ma(){ec.ex(!0)}var rb=this;if(!this.$)return dc.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),qb.Task.Sa(!0);if(!this.$.Aba)return qb.Task.Sa(!0);var ec=new sh.a,fd=new FileReader;L=L.OE.files[0];fd.onload=function(){rb.$Cd=fd.result;ec.ex(!0)};fd.onerror=Ma;fd.onabort=Ma;fd.readAsDataURL(L);return ec.task};h.prototype.i$f=function(L){var Ma=-1;L=L.OE;(null===L||void 0===L?0:L.files)&&0<L.files.length&&(Ma=L.files[0].size);
return Ma};h.prototype.aZd=function(L,Ma){var rb=h.H2g(Eb.LBa(L));0===rb?-1!==Ma&&(dc.ULS.sendTraceTag(526399118,0,50,"Validating picture, pictureSize: {0}, maxAllowedSize: {1}, remainingWorkbookSize: {2}",Ma,this.Ikc,this.$.ea.Pif),Ma>this.Ikc?rb=3:Ma>this.$.ea.Pif&&(rb=7)):6===rb&&this.evi(L);dc.ULS.sendTraceTag(526399117,0,50,"Validated file on client, validation result: {0}",rb);return rb};h.prototype.LBa=function(L,Ma){L=this.aZd(L,this.i$f(Ma));return 0!==L?(this.i1a||1===L||this.qRd(L),!1):
!0};h.prototype.G9f=function(L){L.iEj()};h.prototype.wdd=function(L){var Ma=0,rb=1,ec=-1100324317,fd="InsertPictureUnknownError",yd=null;switch(L){case 1:Ma=1730;rb=0;ec=940870981;fd="InsertPictureNoFileSelected";break;case 3:rb=0;ec=1250467391;fd="InsertPicturePictureTooBig";yd=String.format(yf.a.instance.Bb(172),this.rxi.toLocaleString());break;case 6:Ma=1734;rb=0;ec=1380041209;fd="InsertPictureUnsupportedFormat";break;case 7:Ma=1731;rb=0;ec=-903115058;fd="InsertPictureExceedWorkbookSize";break;
case 4:Ma=1732;rb=0;ec=1218352119;fd="InsertPictureUploadTimeout";break;case 5:Ma=1733,rb=0,ec=1979899005,fd="InsertPictureServiceNonDeterministicError"}L=h.gd(Ma,rb,ec,fd);yd&&(L.Description=yd);return L};h.prototype.showDialog=function(){this.wve()?(this.i1a=!1,this.Ij=new u(this.$.domElement,this.bFb,this.Ooa,this.fa,!1,this.$,!0)):(dc.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.Y6a&&(Ag.a.kv||Ag.a.mF&&72>Ag.a.Dxe)?(this.i1a=!1,this.Ij=new u(this.$.domElement,this.bFb,
this.Ooa,this.fa,!1,this.$)):(this.i1a=!0,this.Ij=(new x(this,this.$,this.fa)).Ij))};h.prototype.U2h=function(L){var Ma={};try{if(Ma=Xf.a.ni(L),hg.b().EA(this.RZd.id,Ma.ServerCorrelationId,"actions","ServerActions"),!Se.a.oh(Ma.Errors)&&Ma.Result){this.$.ea.BX(Ma.StateId,"BasePictureUploaderWrapper.UploadResponseReceived");var rb=Ma.Result;Eh.a(this.$).rna(1,rb);var ec=this.$.da.za(277);ec&&ec.iUc(this.$,1,Ma.Result,Ma,"InsertPicture");dc.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(fd){dc.ULS.sendTraceTag(526399113,
0,50,"BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: {0}, errror: {1}",L?L.length:-1,fd)}this.xAc(Ma,null,"InsertPictureWebMethod")};h.prototype.x4e=function(L){L={Errors:[this.wdd(L)]};this.xAc(L,null,"InsertPictureWebMethod")};h.prototype.xAc=function(L,Ma,rb){this.yt(L,Ma,rb)};h.prototype.iWd=function(L,Ma,rb){this.paa(L,Ma,rb)};h.prototype.qRd=function(L){L=this.wdd(L);td.EwaSettings.Az()?new Me.a(this.$,L):(new He.ErrorDialog(this.$,L)).Af()};
h.prototype.evi=function(L){var Ma=this.$.ya.InsertPicturUnsupportedExtensionsForLogging;L=Aa.a.Al(L);for(var rb=0;rb<Ma.length;++rb)if(L.endsWith(Ma[rb])){dc.ULS.sendTraceTag(526399112,0,50,"Insert picture blocked invalid extension: {0}",Ma[rb]);break}};h.DTj=function(L){return!L||Na.a.equals(L,Ve.a.insertPictureUnknownError,!0)?2:Na.a.equals(L,Ve.a.insertPictureNoFileSelectedError,!0)?1:Na.a.equals(L,Ve.a.Nai,!0)?3:Na.a.equals(L,Ve.a.Oai,!0)?5:0};h.gd=function(L,Ma,rb,ec){return Se.a.gd(1,0,0,L,
Ma,rb,ec)};h.H2g=function(L){switch(L){case 1:return 1;case 2:return 6}return 0};h.prototype.wve=function(){return td.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")&&!this.Y6a&&void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1};Ck.Object.defineProperties(h.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.xb}},rxi:{configurable:!0,enumerable:!0,get:function(){return this.Ikc/1024/1024}}});Object(nd.a)(h,"BasePictureUploaderWrapper",
Eb,[3]);Wl(m,h);m.prototype.Vxj=function(){this.Ikc=28E5;this.qRd(3)};m.prototype.Q$c=function(L){var Ma=this;dc.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");var rb=new FileReader;L=L.OE.files;if(0==L.length)dc.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var ec=L[0];rb.onload=function(){Ma.q9b.stop();Ma.wyh.$Qi(rb.result,Ma);dc.ULS.sendTraceTag(526399109,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:{0}, Size:{1}",
ec.type,ec.size.toString())};rb.onerror=function(){Ma.q9b.stop();dc.ULS.sendTraceTag(526399108,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:{0}, Size:{1}",ec.type,ec.size.toString())};rb.onabort=function(){Ma.q9b.stop();dc.ULS.sendTraceTag(526399107,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:{0}, Size:{1}",ec.type,ec.size.toString())};this.q9b.start();rb.readAsDataURL(ec)}};m.prototype.finalizeUpload=function(L,Ma){this.Q$c(L,Ma)};
Object(nd.a)(m,"FileReaderUploaderWrapper",h,[929]);n.prototype.getSheetName=function(){return this.sheetName};Object(nd.a)(n,"MacroRecorderPictureInsertedPayload",null,[450]);Wl(l,h);l.prototype.Q$c=function(L,Ma){var rb=this;h.prototype.finalizeUpload.call(this,L,Ma);vf.a(this.$.userOperationManager,function(ec,fd){rb.yt=ec;rb.paa=fd;rb.RZd.start();rb.Y_b.Zq();rb.Wzc=!1;rb.G9f(L);return rb.i4i(L)},function(ec){function fd(){return new n(be,rb.$Cd?rb.$Cd:"")}var yd={};rb.$.Pj(yd);var be=yd.SheetName;
ec=td.EwaSettings.qc()?new Wd.a(510,0,ec,72,fd):new bf.a(510,0,ec,8,fd);ec.Gna(function(){return!0});ec.Sd=rb.Sd;return ec},this.Sd)};l.prototype.finalizeUpload=function(L,Ma){this.Q$c(L,Ma)};Object(nd.a)(l,"PictureUploaderWrapper",h,[]);Object(nd.a)(f,"UploadBlobParameters",null,[]);Wl(e,l);e.prototype.iWd=function(L,Ma,rb){l.prototype.iWd.call(this,L,Ma,rb);this.T0.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))};e.prototype.xAc=function(L,
Ma,rb){l.prototype.xAc.call(this,L,Ma,rb);Se.a.oh(L.Errors)?this.T0.setException(Error.create(String.format("DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: {0}",Se.a.Tc(L.Errors)))):this.T0.setResult(!0)};e.prototype.G9f=function(L){var Ma=new f(this.gec.name,this.gec);L.h6f(Ma)};e.wEh=function(L){var Ma=L.split(",");L=Ma[0].includes("base64")?window.self.atob(Ma[1]):window.self.decodeURI(Ma[1]);Ma=Ma[0].split(":")[1].split(";")[0];for(var rb=new Uint8Array(L.length),
ec=0;ec<L.length;ec++)rb[ec]=L.charCodeAt(ec);L=new Blob([rb],{type:Ma});L.name="Image.png";return L};Object(nd.a)(e,"DataUrlUploaderWrapper",l,[]);c.prototype.v$h=function(L,Ma,rb,ec,fd){new l(L,Ma,rb,ec,fd,!0)};c.prototype.s9h=function(L,Ma,rb,ec,fd,yd){new e(L,null,Ma,rb,ec,fd,yd)};c.prototype.E9h=function(L,Ma,rb,ec,fd){new m(L,Ma,rb,ec,fd,!0)};Object(nd.a)(c,"UploaderCreator",null,[849]);var Pj=vg.a;Wl(a,Pj);a.ka=function(L){L.da.Ga(485,new a(L))};a.prototype.create=function(){var L;this.Eb(null!==
(L=this.$.da.za(484))&&void 0!==L?L:this.$.da.Ga(484,new c))};Object(nd.a)(a,"UploaderCreatorFactory",vg.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPicture");Type.registerNamespace("_Ewa");Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");je.main();Type.registerNamespace("Common.App.InProductMessaging");he.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Ke.main();Type.registerNamespace("Common.App.InsertFile");
Type.registerNamespace("Common.App.InsertPicture");(function(){ye.a.Fa(function(L){sb.ka(L)})})();(function(){ye.a.Fa(function(L){Vb.ka(L)})})();(function(){ye.a.Fa(function(){ye.a.Fa(yc.ka)})})();(function(){ye.a.Fa(function(){ye.a.Fa(Rb.ka)})})();(function(){ye.a.Fa(function(L){nc.ka(L)})})();Ng.a.Ji(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
ye.a.Fa(ta.ka);ye.a.Fa(N.ka);(function(){ye.a.Fa(function(L){A.ka(L)})})();(function(){ye.a.Fa(function(L){a.ka(L)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.pi.js.map/6019295af31d5f09772afbb3ef1aea13/EwaDS.pi.js.map