(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1440:function(y,C,b){function a(T){var pa=Zj.call(this)||this;pa.$=T;pa.Tb();return pa}function c(T,pa){var hb=ag.call(this)||this;hb.kob=function(Db,rc){Db=rc.U4;var vb=hb.gridView;rc=rc.B5h;var Uc=rc.Ef,Td=rc.h$;ya.a.Eh&&Td.push(new z(Uc,vb));switch(Db){case 24:rc.h$.push(new v(Uc,rc));break;case 0:rc.h$.push(new D(Uc,vb));ya.a.pp||($e.EwaSettings.isChangeGateEnabled("OfficeVSO:6170982_UseDragSelectionClickBehaviorTableRange")?
(Td.push(new B(Uc,hb.gridView.$,rc.paneType,hb.tableManager,hb.oo)),$e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&Array.add(Td,new A(Uc,hb.gridView.$,rc.paneType,hb.tableManager,hb.oo))):Td.push(new P(Uc,hb.gridView.$,rc.paneType,hb.tableManager,hb.oo)));Td.push(new e(rc,Uc,vb,rc.paneType));break;case 3:Td.push(new E(Uc));ya.a.pp||(Td.push(new ba(Uc,hb.gridView.$,rc.paneType,hb.my,hb.oo,rc)),Td.push(new h(Uc,hb.gridView,hb.my,hb.oo,rc)),Td.push(new m(Uc,
hb.gridView,hb.my,hb.oo,rc)));break;case 4:case 5:Td.push(new n(Uc));break;case 30:Td.push(new l(Uc));break;case 16:Td.push(new f(Uc));Td.push(new w(rc,Uc,vb,rc.paneType));break;case 11:case 12:Td.push(new u(Uc,11===Db));break;case 17:Td.push(new E(Uc));break;case 19:Td.push(new E(Uc)),Td.push(new G(rc,Uc,vb,rc.paneType))}rc.u0b=!0};hb.$=T;hb.gridView=zf.g(T);hb.tableManager=pa;hb.my=new t(hb.gridView);hb.oo=new U(hb.gridView);hb.gridView.Db&&(hb.gridView.Db.AEg(hb.kob),hb.gridView.Db.update(!1));
T.da.Ga(64,hb);return hb}function e(T,pa,hb,Db){return I.call(this,T,pa,hb,Db)||this}function f(T){var pa=Y.call(this,T)||this;f.krb(T,O.a.Tuh+" "+ze.a.wua);f.krb(T,O.a.Suh+" "+ze.a.wua);f.krb(T,O.a.Puh+" "+ze.a.wua);f.krb(T,O.a.Ruh+" "+ze.a.wua);f.krb(T,ze.a.Quh);return pa}function l(T){var pa=Y.call(this,T)||this;appChrome.renderSpinner(T);return pa}function n(T){var pa=Y.call(this,T)||this;n.Vqb(T,O.a.suh+" "+ze.a.wua);n.Vqb(T,O.a.ruh+" "+ze.a.wua);n.Vqb(T,O.a.ouh+" "+ze.a.wua);n.Vqb(T,O.a.quh+
" "+ze.a.wua);n.Vqb(T,ze.a.puh);return pa}function m(T,pa,hb,Db,rc){var vb=x.call(this,T,pa,hb,Db,rc)||this;vb.pEb=function(){var Uc=3===dd.a.Sb;vb.Prd&&!Uc?vb.oo.wKb(vb.gba,vb.TK,!1):!vb.Prd&&Uc&&vb.oo.wKb(vb.gba,vb.TK,!0);vb.Prd=Uc};vb.cPi=function(Uc,Td){Td.Ixb===vb.gba.B$&&vb.oo.wKb(vb.gba,vb.TK,!Td.start&&vb.FQd())};dd.a.Ume(vb.pEb);vb.Prd=3===dd.a.Sb;vb.oo.cFg(vb.cPi);return vb}function h(T,pa,hb,Db,rc){return x.call(this,T,pa,hb,Db,rc)||this}function x(T,pa,hb,Db,rc){var vb=Y.call(this,T)||
this;vb.YK=null;vb.Ya=null;vb.z3=0;vb.sourceRange=null;vb.ub=null;vb.vSa=!1;vb.onPointerDown=function(Uc){Uc=Ih.a(vb.$).ie(Uc);if(vb.a1f(Uc)&&!vb.vSa){vb.Tlf();vb.Ya=vb.oo.fcd();vb.YK=vb.oo.q1e(Uc);if(!vb.Ya||!vb.YK||!vb.YK.range)return dc.ULS.shipAssertTag(537159361,0,!!vb.Ya,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),dc.ULS.shipAssertTag(537159360,0,!!vb.YK,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),dc.ULS.shipAssertTag(537159331,0,!!vb.YK.range,
"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;vb.ub=vb.YK.range.clone();vb.sourceRange=vb.ub.clone();vb.z3=vb.zYe(Uc);if(4===vb.z3)return dc.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;var Td=vb.j_e(Uc,!0);if(!Td)return dc.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!vb.zDe(Td))return dc.ULS.shipAssertTag(537159328,
0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;vb.gridView.rLa=!0;vb.Ya.OG(!1);vb.my.XIe(Uc.Lb);vb.oo.RJf(!0,vb.gba.B$);vb.Ya.textBox.removeSelection();vb.Ya.iZb(vb.V4e);vb.hNf();vb.vSa=!0;Rg.b(vb.$,!0)}return!0};vb.V4e=function(){vb.G9b(!0)};vb.gridView=pa;vb.$=pa.$;vb.TK=[];vb.ha=vb.gridView.ha;vb.my=hb;vb.oo=Db;vb.gba=rc;vb.coloredReferencesManager=vb.$.da.za(281);dc.ULS.shipAssertTag(537159362,0,!!vb.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");
pa=Gl(vb.nSf());for(hb=pa.next();!hb.done;hb=pa.next())hb=vb.oo.NCe(T,hb.value,vb.Wne(),vb.onPointerDown),vb.TK.push(hb);T=Gl(vb.TK);for(pa=T.next();!pa.done;pa=T.next())pa=pa.value,Eg.a.instance.pa(Vf.a.zW,pa,Object(of.a)(vb.my,vb.my.b8e,"hoveringStarted")),Eg.a.instance.pa(Vf.a.xy,pa,Object(of.a)(vb.my,vb.my.c8e,"hoveringStopped"));vb.KYa(rc);return vb}function u(T,pa){var hb=Y.call(this,T)||this;var Db=document.createElement("div"),rc=document.createElement("div");Db.className=pa?aa.Vuh:aa.Xuh;
rc.className=pa?aa.Wuh:aa.Uuh;T.appendChild(Db);T.appendChild(rc);return hb}function w(T,pa,hb,Db){return I.call(this,T,pa,hb,Db)||this}function v(T,pa){var hb=Y.call(this,T)||this;hb.Qzf=function(){if(!hb.gv)return dc.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;hb.gv.hKf(hb.zH,!1);hb.gv.OKe(hb.zH,!1);if(3===hb.gv.model.state)return!0;hb.gv.Y7e(!0);return!0};hb.vca=function(){if(!hb.gv)return!1;hb.gv.L1i();hb.gv.tKd(hb.zH,
!1);if(3===hb.gv.model.state)return!0;hb.gv.Y7e(!1);return!0};hb.onPointerDown=function(Db){return hb.gv?2===Db.zb&&Db.Vn===Sys.UI.MouseButton.leftButton?!0:!1:!1};hb.tEb=function(){if(!hb.gv)return!1;hb.gv.tKd(hb.zH,!0);hb.gv.hKf(hb.zH,!0);hb.gv.OKe(hb.zH,!0);hb.gv.yJb(!0);return!0};hb.onDoubleClick=function(Db){if(Db.Ca)return Db.Ca.stopPropagation(),!0;dc.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};hb.gv=Object(pg.a)(zh.a,
pa.metadata);hb.$J=document.createElement("div");hb.$J.id=String.format("{0}-{1}",T.id,ae.a.rwe);hb.$J.className=af.a.IUg;hb.zH=document.createElement("div");hb.zH.id=String.format("{0}-{1}",T.id,ae.a.c_c);hb.zH.className=af.a.c_c;hb.$J.appendChild(hb.zH);T.appendChild(hb.$J);dc.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");Eg.a.instance.pa(Vf.a.zW,hb.$J,hb.Qzf);Eg.a.instance.pa(Vf.a.xy,hb.$J,
hb.vca);Eg.a.instance.pa(Vf.a.pointerDown,hb.$J,hb.onPointerDown);oi.a.instance.pa(Vf.a.click,hb.$J,hb.tEb);oi.a.instance.pa(Vf.a.lk,hb.$J,hb.onDoubleClick);return hb}function t(T){var pa=this;this.Jg=function(){pa.pod=!1};this.Ap=function(){pa.pod=!0};this.gridView=T;this.Z4a=0;this.pod=this.sgc=!1;this.J5=Number.NaN;this.gridView.ha.K2(this.Ap);this.gridView.ha.yY(this.Jg);this.gridView.ha.zZb(this.Jg)}function z(T,pa){var hb=Y.call(this,T)||this;hb.XPi=function(Db){var rc=Ud.HelperMethods.Rn(Db),
vb=hb.Gva.sZd(Db.clientPoint);if(!vb)return!1;var Uc=vb.sf,Td=hb.Gva.Ea.hvb(Uc.hashCode).dva(vb.JI);if(!Td)return!1;Db=Uc.yj.domElement;vb=Ud.HelperMethods.sle(Ud.HelperMethods.Dvb(Uc.domElement,Db),vb.JI);Uc=0;Td=hb.Gva.lc(Td.getRange());for(var mf=0,bg=z.Cwe.length;mf<bg;++mf){var qg=z.Cwe[mf];if(128!==qg&&64!==qg||!hb.Gva.$.isEditMode){var Kg=Td.cKa(qg);if(Kg&&Kg.u5a&&"none"!==Kg.u5a.style.display){Kg=Kg.u5a;var di=Ud.HelperMethods.Dvb(Kg,Db);Kg=new Sys.UI.Bounds(di.x,di.y,Kg.offsetWidth,Kg.offsetHeight);
if(ob.a.WM(Kg,vb)){Uc=qg;break}}}}return 0!==Uc?(Td.invoke(Uc,rc),!0):!1};hb.Pog=pa;Z.a.instance.pa(Vf.a.click,T,hb.XPi);return hb}function D(T,pa){var hb=E.call(this,T)||this;hb.Jg=function(){hb.domElement.classList.remove(aa.selecting);fc.c(hb.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};hb.Ap=function(){hb.domElement.classList.add(aa.selecting)};hb.onPointerDown=function(Db){2===Db.zb&&Db.Vn===Sys.UI.MouseButton.leftButton&&(hb.gridView.ha.selectionType=4,hb.gridView.ha.sourceRange=
hb.gridView.ha.ta.qd,fc.c(hb.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};hb.rca=function(){hb.gridView.$.Ud(1983983164,2,30,null);return!0};hb.vd=function(){se.DOMElementExtensions.setVisible(hb.uaa,hb.gridView.$.isEditMode)};hb.B6=function(){se.DOMElementExtensions.setVisible(hb.uaa,!1)};hb.A6=function(){se.DOMElementExtensions.setVisible(hb.uaa,!0)};hb.fxf=function(){se.DOMElementExtensions.setVisible(hb.uaa,!1)};hb.exf=function(){se.DOMElementExtensions.setVisible(hb.uaa,
!0)};hb.UDb=function(Db,rc){se.DOMElementExtensions.setVisible(hb.uaa,!rc.Nje)};hb.gridView=pa;pa=document.createElement("div");pa.className=ze.a.Nuh;hb.uaa=pa;hb.vd(null,null);T.appendChild(pa);Eg.a.instance.pa(Vf.a.pointerDown,hb.uaa,hb.onPointerDown);Z.a.instance.pa(Vf.a.lk,hb.uaa,hb.rca);hb.gridView.ha.K2(hb.Ap);hb.gridView.ha.yY(hb.Jg);hb.gridView.$.dl(hb.vd);hb.gridView.$.Ab.HZb(hb.B6);hb.gridView.$.Ab.GZb(hb.A6);hb.gridView.mme(hb.UDb);hb.gridView.tc.ql(hb.fxf);hb.gridView.tc.Kn(hb.exf);return hb}
function A(T,pa,hb,Db,rc){var vb=N.call(this,T,pa,hb,rc)||this;vb.HOa=function(){vb.cq&&vb.w$(!0);5==vb.gi&&vb.XA(!0)};vb.IN=function(Uc){Ih.a(vb.$).ie(Uc);vb.cq=!1;vb.Db.Oh(vb.Nh);vb.ha.sourceRange=vb.sourceRange.clone();vb.M_i();vb.w$(!0);return!0};vb.FN=function(Uc){Uc=Ih.a(vb.$).ie(Uc);var Td=Uc.clientPoint;vb.Pw=Uc;var mf=vb.ha.Xn(Td,Uc.Lb,5,void 0,void 0,!0);if(mf){if(!vb.wpd(mf))return vb.R0h(Uc),!0;vb.mcg(mf,vb.isRow,Td);if(vb.isRow||vb.hf)vb.ub=vb.Z2(mf);vb.ha.sourceRange=vb.ub;vb.Db.vj(vb.ub,
vb.Nh);vb.Db.Cn(vb.Nh);vb.Db.Oh(vb.fB());vb.HB()}return!0};vb.Wyf=function(Uc){Uc.Errors&&0<Uc.Errors.length?(dc.ULS.sendTraceTag(521410185,0,10,"DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [{0}]",Df.a.Tc(Uc.Errors)),vb.ub.left=vb.sourceRange.left,vb.ub.right=vb.sourceRange.right,vb.ub.top=vb.sourceRange.top,vb.ub.bottom=vb.sourceRange.bottom):vb.isRow?vb.sourceRange.top<=vb.ub.top&&vb.sourceRange.bottom>=vb.ub.top-1?(vb.ub.top=vb.sourceRange.top,vb.ub.bottom=vb.sourceRange.bottom):
(vb.sourceRange.top>vb.ub.top||(vb.ub.top-=vb.sourceRange.height),vb.ub.bottom=vb.ub.top+vb.sourceRange.height-1):vb.sourceRange.left<=vb.ub.left&&vb.sourceRange.right>=vb.ub.left-1?(vb.ub.left=vb.sourceRange.left,vb.ub.right=vb.sourceRange.right):(vb.sourceRange.left>vb.ub.left||(vb.ub.left-=vb.sourceRange.width),vb.ub.right=vb.ub.left+vb.sourceRange.width-1);vb.bL();vb.gi=-1};vb.Vyf=function(Uc){Uc=Vh.a.ig(Uc.data);dc.ULS.sendTraceTag(521410184,0,10,"DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [{0}]",
Df.a.Tc(Uc))};vb.tableManager=Db;vb.ha.zZb(vb.HOa);return vb}function B(T,pa,hb,Db,rc){var vb=N.call(this,T,pa,hb,rc)||this;vb.Xz=null;vb.Pq=!1;vb.Oq=!1;vb.EAb=0;vb.qM=null;vb.uO=null;vb.Nn=0;vb.qia=Le.a.instance.ga(2227);vb.tsb=Le.a.instance.ga(2228);vb.Rna=Le.a.instance.ga(2229);vb.SKb=Le.a.instance.ga(2230);vb.rtd=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:6287205_LogDragDropActivity");vb.onKeyDown=function(Uc){if(vb.Yh){if(vb.tka(Uc)||Uc.Ca.keyCode===Ba.a.Dea)return vb.oMa||(ah.KeyInputManager.instance.pa(Vf.a.Vd,
vb.domElement.ownerDocument.body,vb.onKeyUp),vb.oMa=!0),!vb.gu&&vb.tka(Uc)&&(zf.g(vb.$).ug.Jo(B.Kqb),vb.gu=!0),vb.hu||Uc.Ca.keyCode!==Ba.a.Dea||(zf.g(vb.$).ug.Jo(V.A1a),vb.hu=!0,2===vb.Nn?(vb.XA(!1),vb.sE=0,vb.Nh=vb.Oq?[11]:[12],vb.Pq=vb.Oq,vb.SPa(),vb.GI()):3===vb.Nn?(vb.h3(!1),vb.sE=vb.isRow?1:2,vb.ZN(),vb.Jy()):1===vb.Nn&&(vb.w$(!1),vb.ZN(),vb.Jy())),!0}else if(!vb.gu&&(Uc.Ca.keyCode===Ba.a.i8||ya.a.isMac&&Uc.Ca.keyCode===Ba.a.Poa))return ah.KeyInputManager.instance.pa(Vf.a.Vd,vb.domElement.ownerDocument.body,
vb.onKeyUp),zf.g(vb.$).ug.Jo(B.Kqb),vb.gu=!0;return!1};vb.onKeyUp=function(Uc){if(vb.Yh){if(vb.tka(Uc)||Uc.Ca.keyCode===Ba.a.Dea)return vb.EAb=vb.tka(Uc)?0:1,vb.cq&&zf.g(vb.$).ug.Jo(V.A1a),Uc.Ca.keyCode===Ba.a.Dea&&(2===vb.Nn?(vb.h3(!1),vb.sE=0,vb.ZN(!0),vb.Jy(!0)):3===vb.Nn?(vb.XA(!1),vb.sE=vb.isRow?1:2,vb.Nh=vb.isRow?[11]:[12],vb.SPa(!0),vb.GI(!0)):1===vb.Nn&&(vb.XA(!1),vb.Nh=vb.Oq?[11]:[12],vb.xza(!0),vb.GI(!0))),vb.Goa(vb.EAb),!0}else if(Uc.Ca.keyCode===Ba.a.i8||ya.a.isMac&&Uc.Ca.keyCode===Ba.a.Poa)return vb.Goa(),
vb.cq&&zf.g(vb.$).ug.Jo(V.F6c),!0;return!1};vb.IN=function(Uc){Uc=Ih.a(vb.$).ie(Uc);5===vb.gi?vb.GAd(Uc):(vb.cq=!1,vb.Db.Oh(vb.Nh),!vb.$.Aq([vb.ub],!1)||vb.vGd()||vb.uzb()||(vb.ha.sourceRange=vb.sourceRange.clone(),vb.Yh?vb.$Ed():vb.rtb(),vb.ky()?vb.ub.top>vb.sourceRange.top&&(Uc=vb.ub.height,vb.ub.top-=Uc,vb.ub.bottom-=Uc):vb.ub.left>vb.sourceRange.left&&(Uc=vb.ub.width,vb.ub.left-=Uc,vb.ub.right-=Uc),vb.bL()),vb.rtd&&vb.qtd());vb.Tt(vb.FN,vb.IN);vb.tableRange=null;vb.gi=-1;vb.Yh&&(vb.Xz=null,vb.Nn=
0);return!0};vb.v6=function(){vb.cq=!1;vb.Nn=0;vb.Db.Oh(vb.Nh);if(!vb.$.Aq([vb.ub],!1))return vb.Tt(vb.u6,vb.v6),vb.gi=-1,!0;if(!(vb.ha.ta.qd.equals(vb.ub)||vb.nka(vb.ub)||vb.nka(vb.sourceRange)||vb.uzb())){vb.bL();vb.ha.sourceRange=vb.sourceRange.clone();var Uc=vb.ha.sourceRange,Td=vb.ha.ta.qd,mf={};vb.$.Ud(-694765314,2,30,(mf[ae.a.bua]=vb.gu,mf[ae.a.d7b]=!0,mf[ae.a.e7b]=vb.Pq,mf[ae.a.U3]=Uc,mf[ae.a.T3]=Td,mf[ae.a.rsb]=vb.hu,mf));vb.gu||(vb.ub.top>vb.sourceRange.top&&(vb.isRow||vb.ub.left===vb.sourceRange.left&&
vb.Pq)?(Uc=vb.ub.height,vb.ub.top-=Uc,vb.ub.bottom-=Uc):vb.ub.left>vb.sourceRange.left&&(vb.hf||vb.ub.top===vb.sourceRange.top&&!vb.Pq)&&(Uc=vb.ub.width,vb.ub.left-=Uc,vb.ub.right-=Uc),vb.bL())}vb.Tt(vb.u6,vb.v6);vb.tableRange=null;vb.Xz=null;vb.gi=-1;vb.Pq=!1;vb.rtd&&vb.qtd();return!0};vb.FN=function(Uc){var Td=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Td&&(Uc=Ih.a(vb.$).ie(Uc));var mf=Uc.clientPoint;Td||(Uc=Ih.a(vb.$).ie(Uc));vb.Yh&&(vb.Pw=Uc);if(Uc=
vb.ha.Xn(mf,Uc.Lb,5,void 0,void 0,!0)){if(vb.tableRange.contains(Uc.topLeft)){if(vb.mcg(Uc,vb.ky(),mf),vb.ub=vb.Z2(Uc),vb.ha.sourceRange=vb.ub,vb.Db.vj(vb.ub,vb.Nh),vb.Db.Cn(vb.Nh),vb.Db.Oh(vb.fB()),6!==vb.gi){for(mf=1;4>=mf;mf++)Uc=vb.Vh[mf.toString()],Uc.parentNode.removeChild(Uc),vb.Db.yw(vb.ky()?11:12,mf).Ef.appendChild(Uc);vb.gi=6}}else if(vb.ub=vb.Dha(Uc),vb.Yh)vb.owb(!1);else if(vb.Db.vj(vb.ub,vb.fB()),vb.Db.Cn(vb.fB()),vb.Db.Oh(vb.Nh),5!==vb.gi){for(mf=1;4>=mf;mf++)Uc=vb.Vh[mf.toString()],
Uc.parentNode.removeChild(Uc),vb.Db.yw(vb.Maa(),mf).Ef.appendChild(Uc);vb.gi=5}vb.HB()}return!0};vb.u6=function(Uc){var Td=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Td&&(Uc=Ih.a(vb.$).ie(Uc));var mf=Uc.clientPoint;Td||(Uc=Ih.a(vb.$).ie(Uc));vb.Pw=Uc;if(Td=vb.ha.Xn(mf,Uc.Lb,5,void 0,void 0,!0)){if(vb.Cwb(Td))return vb.ub=vb.Dha(Td),vb.nwb(!1),!0;var bg=zf.g(vb.$),qg=bg.tg(Td),Kg=bg.Uf(vb.paneType);mf=Pg.a.As(Kg.view.ti,vb.domElement.parentNode,mf,bg.rtl);
Kg=!1;var di=2;vb.Pq=!1;if(vb.isRow||vb.hf){vb.isRow&&mf.y-qg.topLeft.y>qg.height/2?(Kg=!0,di=1):vb.hf&&mf.x-qg.topLeft.x>qg.width/2&&(Kg=!0);if(Kg){Uc=bg.xk("DragSelectionClickBehaviorTableRange.OnPointerMoveDragInsert",bg.hH,di);try{Uc.ls(Td),Uc.$$mn(),Td=Uc.$$cu().range}finally{Uc&&Uc.dispose()}}vb.ub=vb.Dha(Td)}else{mf.x-qg.topLeft.x===qg.width?(vb.Pq=!1,Kg=!0):mf.y-qg.topLeft.y>qg.height/2&&(Kg=!0,vb.Pq=!0,di=1);vb.Xz&&(vb.Pq=vb.Oq);if(Kg){bg=bg.xk("DragSelectionClickBehaviorTableRange.OnPointerMoveDragInsert",
bg.hH,di);try{bg.ls(Td),bg.$$mn(),Td=bg.$$cu().range}finally{bg&&bg.dispose()}}vb.Db.Oh(vb.Nh);vb.Nh=vb.Pq?[11]:[12];for(bg=1;4>=bg;bg++)(qg=vb.Vh[bg.toString()])&&qg.parentNode.removeChild(qg),vb.Vh[bg.toString()]=null;vb.Uz(Uc.clientPoint,Uc.Lb,vb.Pq?11:12,!0);vb.ub=vb.Z2(Td)}vb.ha.sourceRange=vb.ub;vb.Db.vj(vb.ub,vb.Nh);vb.Db.Cn(vb.Nh);vb.Db.Oh(vb.fB());if(6!==vb.gi){for(Uc=1;4>=Uc;Uc++)Td=vb.Vh[Uc.toString()],Td.parentNode.removeChild(Td),vb.Db.yw(vb.isRow||vb.Pq?11:12,Uc).Ef.appendChild(Td);
vb.gi=6}vb.HB()}return!0};vb.HOa=function(){vb.Yh?vb.cq&&5<=vb.gi&&(vb.tableRange?vb.hu?vb.XA(!0):vb.w$(!0):vb.hu?vb.isRow||vb.hf?vb.XA(!0):vb.h3(!0):vb.isRow||vb.hf?vb.h3(!0):vb.XA(!0)):vb.cq&&5<=vb.gi&&(vb.tableRange?(vb.Db.Oh(vb.Nh),vb.Tt(vb.FN,vb.IN)):(vb.Db.Oh(vb.fB()),vb.Tt(Object(of.a)(vb,vb.Ih,"onPointerMove"),Object(of.a)(vb,vb.Gf,"onPointerUp"))))};vb.tableManager=Db;vb.tableRange=null;vb.hu=!1;vb.gu=!1;vb.oMa=!1;vb.ha.zZb(vb.HOa);return vb}function N(T,pa,hb,Db){var rc=V.call(this,T,pa,
hb,Db)||this;rc.Nh=null;rc.isRow=!1;rc.hf=!1;rc.Jg=function(){rc.domElement.classList.remove(aa.selecting)};rc.Ap=function(){rc.domElement.classList.add(aa.selecting)};rc.ld=function(){if(rc.$.isEditMode){var vb=rc.hxc();rc.Pvc(vb)}};rc.Vh={};rc.cq=!1;rc.ha.K2(rc.Ap);rc.ha.yY(rc.Jg);rc.ha.fE(rc.ld);return rc}function P(T,pa,hb,Db,rc){var vb=V.call(this,T,pa,hb,rc)||this;vb.qia=Le.a.instance.ga(2227);vb.tsb=Le.a.instance.ga(2228);vb.Rna=Le.a.instance.ga(2229);vb.SKb=Le.a.instance.ga(2230);vb.Nh=null;
vb.Xz=null;vb.Pq=!1;vb.isRow=!1;vb.hf=!1;vb.Oq=!1;vb.qM=null;vb.uO=null;vb.EAb=0;vb.Nn=0;vb.onKeyDown=function(Uc){if(vb.Yh){if(vb.tka(Uc)||Uc.Ca.keyCode===Ba.a.Dea)return vb.oMa||(ah.KeyInputManager.instance.pa(Vf.a.Vd,vb.domElement.ownerDocument.body,vb.onKeyUp),vb.oMa=!0),!vb.gu&&vb.tka(Uc)&&(zf.g(vb.$).ug.Jo(P.Kqb),vb.gu=!0),vb.hu||Uc.Ca.keyCode!==Ba.a.Dea||(zf.g(vb.$).ug.Jo(V.A1a),vb.hu=!0,2===vb.Nn?(vb.XA(!1),vb.sE=0,vb.Nh=vb.Oq?[11]:[12],vb.Pq=vb.Oq,vb.SPa(),vb.GI()):3===vb.Nn?(vb.h3(!1),vb.sE=
vb.isRow?1:2,vb.ZN(),vb.Jy()):1===vb.Nn&&(vb.w$(!1),vb.ZN(),vb.Jy())),!0}else if(!vb.gu&&(Uc.Ca.keyCode===Ba.a.i8||ya.a.isMac&&Uc.Ca.keyCode===Ba.a.Poa))return ah.KeyInputManager.instance.pa(Vf.a.Vd,vb.domElement.ownerDocument.body,vb.onKeyUp),zf.g(vb.$).ug.Jo(P.Kqb),vb.gu=!0;return!1};vb.onKeyUp=function(Uc){if(vb.Yh){if(vb.tka(Uc)||Uc.Ca.keyCode===Ba.a.Dea)return vb.EAb=vb.tka(Uc)?0:1,vb.cq&&zf.g(vb.$).ug.Jo(V.A1a),Uc.Ca.keyCode===Ba.a.Dea&&(2===vb.Nn?(vb.h3(!1),vb.sE=0,vb.ZN(!0),vb.Jy(!0)):3===
vb.Nn?(vb.XA(!1),vb.sE=vb.isRow?1:2,vb.Nh=vb.isRow?[11]:[12],vb.SPa(!0),vb.GI(!0)):1===vb.Nn&&(vb.XA(!1),vb.Nh=vb.Oq?[11]:[12],vb.xza(!0),vb.GI(!0))),vb.Goa(vb.EAb),!0}else if(Uc.Ca.keyCode===Ba.a.i8||ya.a.isMac&&Uc.Ca.keyCode===Ba.a.Poa)return vb.Goa(),vb.cq&&zf.g(vb.$).ug.Jo(V.F6c),!0;return!1};vb.IN=function(Uc){Uc=Ih.a(vb.$).ie(Uc);5===vb.gi?vb.GAd(Uc):(vb.cq=!1,vb.Db.Oh(vb.Nh),!vb.$.Aq([vb.ub],!1)||vb.vGd()||vb.uzb()||(vb.ha.sourceRange=vb.sourceRange.clone(),vb.Yh?vb.$Ed():vb.rtb(),vb.ky()?
vb.ub.top>vb.sourceRange.top&&(Uc=vb.ub.height,vb.ub.top-=Uc,vb.ub.bottom-=Uc):vb.ub.left>vb.sourceRange.left&&(Uc=vb.ub.width,vb.ub.left-=Uc,vb.ub.right-=Uc),vb.bL()));vb.Tt(vb.FN,vb.IN);vb.tableRange=null;vb.gi=-1;vb.Yh&&(vb.Xz=null,vb.Nn=0);return!0};vb.v6=function(){vb.cq=!1;vb.Nn=0;vb.Db.Oh(vb.Nh);if(!vb.$.Aq([vb.ub],!1))return vb.Tt(vb.u6,vb.v6),vb.gi=-1,!0;if(!(vb.ha.ta.qd.equals(vb.ub)||vb.nka(vb.ub)||vb.nka(vb.sourceRange)||vb.uzb())){vb.bL();vb.ha.sourceRange=vb.sourceRange.clone();var Uc=
vb.ha.sourceRange,Td=vb.ha.ta.qd,mf={};vb.$.Ud(-694765314,2,30,(mf[ae.a.bua]=vb.gu,mf[ae.a.d7b]=!0,mf[ae.a.e7b]=vb.Pq,mf[ae.a.U3]=Uc,mf[ae.a.T3]=Td,mf[ae.a.rsb]=vb.hu,mf));vb.gu||(vb.ub.top>vb.sourceRange.top&&(vb.isRow||vb.ub.left===vb.sourceRange.left&&vb.Pq)?(Uc=vb.ub.height,vb.ub.top-=Uc,vb.ub.bottom-=Uc):vb.ub.left>vb.sourceRange.left&&(vb.hf||vb.ub.top===vb.sourceRange.top&&!vb.Pq)&&(Uc=vb.ub.width,vb.ub.left-=Uc,vb.ub.right-=Uc),vb.bL())}vb.Tt(vb.u6,vb.v6);vb.tableRange=null;vb.Xz=null;vb.gi=
-1;vb.Pq=!1;return!0};vb.FN=function(Uc){var Td=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Td&&(Uc=Ih.a(vb.$).ie(Uc));var mf=Uc.clientPoint;Td||(Uc=Ih.a(vb.$).ie(Uc));vb.Yh&&(vb.Pw=Uc);if(Uc=vb.ha.Xn(mf,Uc.Lb,5,void 0,void 0,!0)){if(vb.tableRange.contains(Uc.topLeft)){Td=zf.g(vb.$);var bg=Td.tg(Uc),qg=Td.Uf(vb.paneType);mf=Pg.a.As(qg.view.ti,vb.domElement.parentNode,mf,Td.rtl);qg=!1;var Kg=2;vb.ky()&&mf.y-bg.topLeft.y>bg.height/2?(qg=!0,Kg=1):!vb.ky()&&
mf.x-bg.topLeft.x>bg.width/2&&(qg=!0);if(qg){Td=Td.xk("DragSelectionClickBehavior.OnPointerMoveRearrange",Td.hH,Kg);try{Td.ls(Uc),Td.$$mn(),Uc=Td.$$cu().range}finally{Td&&Td.dispose()}}vb.ub=vb.Z2(Uc);vb.ha.sourceRange=vb.ub;vb.Db.vj(vb.ub,vb.Nh);vb.Db.Cn(vb.Nh);vb.Db.Oh(vb.fB());if(6!==vb.gi){for(Uc=1;4>=Uc;Uc++)Td=vb.Vh[Uc.toString()],Td.parentNode.removeChild(Td),vb.Db.yw(vb.ky()?11:12,Uc).Ef.appendChild(Td);vb.gi=6}}else if(vb.ub=vb.Dha(Uc),vb.Yh)vb.owb(!1);else if(vb.Db.vj(vb.ub,vb.fB()),vb.Db.Cn(vb.fB()),
vb.Db.Oh(vb.Nh),5!==vb.gi){for(Uc=1;4>=Uc;Uc++)Td=vb.Vh[Uc.toString()],Td.parentNode.removeChild(Td),vb.Db.yw(vb.Maa(),Uc).Ef.appendChild(Td);vb.gi=5}vb.HB()}return!0};vb.u6=function(Uc){var Td=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Td&&(Uc=Ih.a(vb.$).ie(Uc));var mf=Uc.clientPoint;Td||(Uc=Ih.a(vb.$).ie(Uc));vb.Pw=Uc;if(Td=vb.ha.Xn(mf,Uc.Lb,5,void 0,void 0,!0)){if(vb.Cwb(Td))return vb.ub=vb.Dha(Td),vb.nwb(!1),!0;var bg=zf.g(vb.$),qg=bg.tg(Td),Kg=bg.Uf(vb.paneType);
mf=Pg.a.As(Kg.view.ti,vb.domElement.parentNode,mf,bg.rtl);Kg=!1;var di=2;vb.Pq=!1;if(vb.isRow||vb.hf){vb.isRow&&mf.y-qg.topLeft.y>qg.height/2?(Kg=!0,di=1):vb.hf&&mf.x-qg.topLeft.x>qg.width/2&&(Kg=!0);if(Kg){Uc=bg.xk("DragSelectionClickBehavior.OnPointerMoveDragInsert",bg.hH,di);try{Uc.ls(Td),Uc.$$mn(),Td=Uc.$$cu().range}finally{Uc&&Uc.dispose()}}vb.ub=vb.Dha(Td)}else{mf.x-qg.topLeft.x===qg.width?(vb.Pq=!1,Kg=!0):mf.y-qg.topLeft.y>qg.height/2&&(Kg=!0,vb.Pq=!0,di=1);vb.Xz&&(vb.Pq=vb.Oq);if(Kg){bg=bg.xk("DragSelectionClickBehavior.OnPointerMoveDragInsert",
bg.hH,di);try{bg.ls(Td),bg.$$mn(),Td=bg.$$cu().range}finally{bg&&bg.dispose()}}vb.Db.Oh(vb.Nh);vb.Nh=vb.Pq?[11]:[12];for(bg=1;4>=bg;bg++)(qg=vb.Vh[bg.toString()])&&qg.parentNode.removeChild(qg),vb.Vh[bg.toString()]=null;vb.Uz(Uc.clientPoint,Uc.Lb,vb.Pq?11:12,!0);vb.ub=vb.Z2(Td)}vb.ha.sourceRange=vb.ub;vb.Db.vj(vb.ub,vb.Nh);vb.Db.Cn(vb.Nh);vb.Db.Oh(vb.fB());if(6!==vb.gi){for(Uc=1;4>=Uc;Uc++)Td=vb.Vh[Uc.toString()],Td.parentNode.removeChild(Td),vb.Db.yw(vb.isRow||vb.Pq?11:12,Uc).Ef.appendChild(Td);
vb.gi=6}vb.HB()}return!0};vb.Jg=function(){vb.domElement.classList.remove(aa.selecting)};vb.Ap=function(){vb.domElement.classList.add(aa.selecting)};vb.ld=function(){if(vb.$.isEditMode){var Uc=vb.hxc();vb.Pvc(Uc)}};vb.HOa=function(){vb.Yh?vb.cq&&5<=vb.gi&&(vb.tableRange?vb.hu?vb.XA(!0):vb.w$(!0):vb.hu?vb.isRow||vb.hf?vb.XA(!0):vb.h3(!0):vb.isRow||vb.hf?vb.h3(!0):vb.XA(!0)):vb.cq&&5<=vb.gi&&(vb.tableRange?(vb.Db.Oh(vb.Nh),vb.Tt(vb.FN,vb.IN)):(vb.Db.Oh(vb.fB()),vb.Tt(Object(of.a)(vb,vb.Ih,"onPointerMove"),
Object(of.a)(vb,vb.Gf,"onPointerUp"))))};vb.tableManager=Db;vb.tableRange=null;vb.Vh={};vb.cq=!1;vb.gu=!1;vb.hu=!1;vb.oMa=!1;vb.ha.K2(vb.Ap);vb.ha.yY(vb.Jg);vb.ha.zZb(vb.HOa);vb.ha.fE(vb.ld);return vb}function Q(T,pa){this.destinationRange=this.sourceRange=null;this.sourceRange=T;this.destinationRange=pa}function M(T,pa,hb,Db,rc,vb,Uc,Td){Td=T.Na(41,void 0===Td?null:Td);Td.sourceRange=pa;Td.destinationRange=hb;return ye.i(T,"RearrangeRowColumn",Td,Db,rc,vb,Uc,0)}function ba(T,pa,hb,Db,rc,vb){var Uc=
V.call(this,T,pa,hb,rc)||this;Uc.YK=null;Uc.Ya=null;Uc.U4e=function(){Uc.vtb(!0)};Uc.gridView=zf.g(Uc.$);Uc.my=Db;Uc.coloredReferencesManager=Uc.$.da.za(281);dc.ULS.shipAssertTag(537159391,0,!!Uc.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");T=Gl(Uc.Vr);for(pa=T.next();!pa.done;pa=T.next())pa=pa.value,Eg.a.instance.pa(Vf.a.zW,pa,Object(of.a)(Uc.my,Uc.my.b8e,"hoveringStarted")),Eg.a.instance.pa(Vf.a.xy,
pa,Object(of.a)(Uc.my,Uc.my.c8e,"hoveringStopped"));Uc.KYa(vb);return Uc}function V(T,pa,hb,Db){var rc=E.call(this,T)||this;rc.vSa=!1;rc.Kje=null;rc.Jje=null;rc.Mra=0;rc.Yh=$e.EwaSettings.getBooleanFeatureGate(Sg.a.c7b,!1);rc.zfi=$e.EwaSettings.getBooleanFeatureGate(Sg.a.Zgh,!1);rc.sE=0;rc.Qdc=0;rc.CCc=0;rc.Fma=null;rc.sourceRange=null;rc.ub=null;rc.Pw=null;rc.onPointerDown=function(vb){vb=Ih.a(rc.$).ie(vb);if(2===vb.zb&&vb.Vn===Sys.UI.MouseButton.leftButton&&!rc.vSa){var Uc=rc.Obc(vb);if(!Uc)return dc.ULS.shipAssertTag(537159379,
0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;rc.ub=Uc.clone();rc.sourceRange=rc.ub.clone();rc.Fma=rc.ub;if(Uc=rc.dRh(vb))rc.gi=5,rc.CCc=Uc.top-rc.sourceRange.top,rc.Qdc=Uc.left-rc.sourceRange.left,zf.g(rc.$).ug.Jo(rc.Yh?V.A1a:V.F6c),rc.Vnc(vb),rc.vSa=!0,Rg.b(rc.$,!0)}return!1};rc.vd=function(vb,Uc){Uc.aN||rc.Pvc(rc.$.isEditMode)};rc.Vr=[];rc.$=pa;rc.ha=zf.g(rc.$).ha;rc.paneType=hb;rc.oo=Db;pa=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
hb=ya.a.Of;pa=Gl(rc.zfi?pa&&!hb?[aa.Iuh,aa.vuh,aa.Auh,aa.Euh]:[aa.Kuh,aa.xuh,aa.Cuh,aa.Guh]:pa&&!hb?[aa.Huh,aa.uuh,aa.zuh,aa.Duh]:[aa.Juh,aa.wuh,aa.Buh,aa.Fuh]);for(hb=pa.next();!hb.done;hb=pa.next())hb=rc.oo.NCe(T,hb.value,rc.Yh?[aa.yuh]:[aa.tuh],rc.onPointerDown),rc.Vr.push(hb);rc.$.dl(rc.vd);rc.Pvc(rc.$.isEditMode);return rc}function aa(){}function E(T){var pa=Y.call(this,T)||this;var hb=document.createElement("div");hb.className=ze.a.Ouh;T.appendChild(hb);return pa}function G(T,pa,hb,Db){return I.call(this,
T,pa,hb,Db)||this}function I(T,pa,hb,Db){var rc=Y.call(this,pa)||this;rc.Qnb=!1;rc.zWc=!1;rc.Jqd=!1;rc.mpb=null;rc.Gqd=!1;rc.yba=!1;rc.Mw=function(){rc.Qnb&&rc.Gqd?rc.Wna():rc.R4()};rc.kxf=function(Uc){3===Uc.zb&&(rc.Gqd=!0,rc.Wna());return!1};rc.lxf=function(Uc){if(3===Uc.zb){if(!Uc.Lb||rc.cgi(Uc))return!1;rc.Gqd=!1;rc.R4()}return!1};rc.Jg=function(){rc.yba&&rc.mXd();rc.Wna();rc.Jqd=!1};rc.Ap=function(){rc.R4();rc.Jqd=!0};rc.yya=function(Uc,Td){Td.U4===rc.U4&&(Td.visible?rc.Jqd||rc.Wna():rc.R4())};
rc.TCf=function(){rc.mxf(rc.QO.domElement,!1)};rc.Etf=function(){rc.mxf(rc.cM.domElement,!0)};rc.jnc=function(Uc,Td){rc.ha.nza(Td)};rc.knc=function(Uc,Td){rc.ha.nza(be.b(Td))};rc.pEb=function(){3===dd.a.Sb?rc.Wna():rc.R4();rc.yba&&1===dd.a.Sb&&rc.mXd()};rc.UCf=function(){rc.Tmj()};rc.tJe=function(){rc.R4()};rc.yp=function(){rc.ha.Oa.nc&&rc.R4()};rc.stf=function(){rc.R4()};rc.dxf=function(Uc,Td){rc.mXd();3===Td.zb?rc.Wna():rc.R4()};rc.brc=function(){rc.Qnb&&(rc.R4(),rc.Wna())};var vb=hb.$;rc.fr=hb;
rc.ha=hb.ha;rc.gba=T;rc.rkj=pa;rc.paneType=Db;T=rc.domElement.currentStyle;pa="#000000";T&&(pa=T.borderTopColor);rc.QO=new R(rc.Y$c(),pa,vb);rc.cM=new R(rc.Y$c(),pa,vb);rc.oef=vb.ea.isNamedObjectViewMode&&1===vb.workbookContext.NovMode;rc.QO.Kme(rc.TCf);rc.QO.Jme(rc.jnc);rc.QO.Lme(rc.knc);rc.cM.Kme(rc.Etf);rc.cM.Jme(rc.jnc);rc.cM.Lme(rc.knc);T=Gl(rc.gridView.vn);for(pa=T.next();!pa.done;pa=T.next())pa=pa.value,ve.a.instance.pa(Vf.a.Kf,pa.domElement,rc.lxf),ve.a.instance.pa(Vf.a.De,pa.domElement,rc.kxf);
hb.view.Rs(rc.Mw);hb.pc.ql(rc.tJe);hb.Db.pnb(rc.yya);hb.JUc(rc.stf);vb.GA(rc.brc);hb.Mt(rc.brc);rc.ha.yY(rc.Jg);rc.ha.K2(rc.Ap);hb.eE(rc.yp);rc.ha.ZYb(rc.dxf);dd.a.Ume(rc.pEb);jc.TaskExtensions.Ba(qb.GetServiceTaskFactory.Xa(vb.da,376,377,0),function(Uc){Uc.result.DGg(rc.UCf)},vb.la,3);return rc}function R(T,pa,hb){var Db=Yf.call(this,document.createElement("div"))||this;Db.j5b=null;Db.QOb=!1;Db.onPointerDown=function(vb){vb=Ih.a(Db.$)?Ih.a(Db.$).ie(vb):vb;Db.QOb=!1;if(3===(dd.a.Sb=vb.zb)){var Uc=
vb.Ca.rawEvent,Td=Uc.srcElement||Uc.target;se.DOMElementExtensions.Ff(Db.domElement,Td)&&se.DOMElementExtensions.Ff(Uc.currentTarget,Td)&&(Db.QOb=!0,Db.j5b=vb.clientPoint)}return!1};Db.Gf=function(vb){vb=Ih.a(Db.$)?Ih.a(Db.$).ie(vb):vb;Db.raiseEvent("GrPointerUp",vb);return Db.QOb=!1};Db.Ih=function(vb){vb=Ih.a(Db.$)?Ih.a(Db.$).ie(vb):vb;3===vb.zb&&Db.QOb&&Db.R3h(vb.clientPoint)&&(Db.raiseEvent("GrDrag"),Db.QOb=!1);return!1};Db.xd=function(vb){Ih.a(Db.$)&&Ih.a(Db.$).ie(vb);return!0};Db.$=hb;hb=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
var rc=ya.a.Of;Db.domElement.classList.add(!hb||rc?ze.a.SPe:ze.a.RPe);Db.domElement.classList.add(ze.a.E8b);T.appendChild(Db.domElement);se.DOMElementExtensions.setVisible(Db.domElement,!1);Db.HKa=document.createElement("div");Db.HKa.classList.add(ze.a.D8b);Db.HKa.style.borderColor=pa;Db.domElement.appendChild(Db.HKa);Eg.a.instance.pa(Vf.a.pointerDown,Db.domElement,Db.onPointerDown);Eg.a.instance.pa(Vf.a.Zd,Db.domElement,Db.Gf);ve.a.instance.pa(Vf.a.De,Db.domElement,Db.Gf);Eg.a.instance.pa(Vf.a.vh,
Db.domElement,Db.Ih);ve.a.instance.pa(Vf.a.Bg,Db.domElement,Db.Ih);Z.a.instance.pa(Vf.a.click,Db.domElement,Db.xd);return Db}function Y(T,pa){return yd.call(this,T,void 0===pa?null:pa)||this}function U(T){var pa=fd.call(this)||this;pa.kof=[3];pa.gridView=T;pa.SWd=Ph.a.vba(pa.gridView.$);return pa}function ha(T,pa){var hb=ec.call(this)||this;hb.start=T;hb.Ixb=pa;return hb}function ta(T){var pa=Ma.call(this)||this;pa.$=T;pa.Tb();return pa}function xa(T){var pa=L.call(this)||this;T.da.Ga(376,pa);return pa}
function oa(T){var pa=Pj.call(this)||this;pa.$=T;pa.Tb();return pa}function qa(){this.aLd=Kc.AFrameworkApplication.FVj;this.Zxi=Kc.AFrameworkApplication.DVj;this.PO=Kc.AFrameworkApplication.n_h();this.priority=Kc.AFrameworkApplication.$Zd;this.wee=this.vqj();this.SSc=Kc.AFrameworkApplication.m_h()}function Ea(T,pa,hb,Db,rc,vb,Uc){var Td=this;Db=void 0===Db?null:Db;rc=void 0===rc?!1:rc;vb=void 0===vb?null:vb;Uc=void 0===Uc?!1:Uc;this.ira=0;this.sga=this.Vi=null;this.iXb=new le.a;this.kT=new le.a;this.dm=
null;this.GTb=!1;this.ue=T;this.kde=pa;this.kde.execute(function(mf){mf.Tl(pc.a.Pjd,Object(of.a)(Td,Td.lLi,"onHostResponseReceived"))});this.p9=hb;this.Jhe=new Wj.a("WebServiceCall","TokenRefresh");this.lj=Db||new ka(T);this.Vug=rc;this.BT=vb?vb:Oi.SessionStatusManager.instance;this.l5d=Uc}function ka(T){this.Mo={};this.NX={};this.ltg={};this.mlf=15;this.w9d=!1;this.bvg=new Date;this.MTb=new Date;this.ue=T;this.ZWb=new te.a(2,2,6E4*this.mlf,Object(of.a)(this,this.Rfg,"writeMeasures"),135,"SL",!1);
this.ue.Qg(this.ZWb);this.k$h()}function za(){}function La(T,pa){var hb=this;this.documentVisibilityObserver=null;this.Pa=new Xe.a;this.Cx=null;this.Bdb=this.Vkb=!1;this.Grc=null;this.oHb=!1;this.dud=!0;this.a$d=this.B9d=this.cH=this.Xlb=!1;this.dT=null;this.$4e=function(){if(!hb.T9b||hb.T9b&&hb.$.ea.rc)hb.A5e(!1);else if(hb.dud){hb.dud=!1;var Db=vh.a(hb.$);dc.ULS.sendTraceTag(537170709,0,50,"EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [{0}] TimeUntilTokenExpirationInMin [{1}]",
Db.wi?Db.wi.activityName:"None",hb.z8f())}};this.od=function(Db,rc){hb.context&&(Db=hb.$.ea,rc.EH&&hb.context.jHb&&!hb.context.dAc?(hb.context.dAc=!0,rc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},rc.IsUserActive=Db.Ue.ur,rc.RefreshAccessTokenCorrelationID=hb.context.correlationID,rc=wi.a.Jc(rc),dc.ULS.sendTraceTag(537170708,0,50,rc)):hb.T9b&&hb.Vkb&&!Db.rc&&!hb.context.e4c&&(rc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},
hb.Cx&&(hb.Cx.C(),rc.Aborted=!0,$e.EwaSettings.isChangeGateEnabled("OfficeVSO:4877031_allowRefreshExpiringAfterAbort")&&(rc.ResetStopRefreshRetriesUntilTokenExpired=!0,hb.Bdb=!1)),rc.TimeUntilTokenExpirationInMin=hb.z8f(),rc.RefreshAccessTokenCorrelationID=hb.context.correlationID,rc=wi.a.Jc(rc),dc.ULS.sendTraceTag(572019856,0,50,rc)))};this.uya=function(){if(hb.context&&hb.context.jHb&&!hb.context.dAc){var Db={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};Db.CreatedForExpired=
hb.context.e4c;Db.RefreshAccessTokenCorrelationID=hb.context.correlationID;Db.OpenWorkbookErrors=Df.a.Tc(hb.$.ea.zF);Db.ExecutionContextErrors=Df.a.Tc(vh.a(hb.$).ud.errors);Db.accesstokenTTL=Kc.AFrameworkApplication.vk;Db=wi.a.Jc(Db);dc.ULS.sendTraceTag(537170707,0,15,Db)}};this.z5e=function(){hb.Bdb=!1;hb.A5e(!0)};this.wBd=function(){hb.oHb&&(hb.$.ea.Ue.Gza(hb.wBd),hb.oHb=!1);hb.e5f()};this.$=T;this.wVd=pa;this.$Gd=T.Pb.Zg("WebServiceCall","refreshToken");this.T9b=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:4874136_fixRaceOpenWorkbookRefreshExpiringToken");
uj.a.instance.oVc(this.z5e);uj.a.instance.mVc(this.$4e);pa=this.$.ea;pa.hk(this.od);pa.qZb(this.uya);this.azi=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.A0f=this.$.ya.ShortAccessTokenExpirationPromptSeconds;this.pMf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.Zcg(T.ea.wEf,Kc.AFrameworkApplication.vk);T=new Date;pa={};dc.ULS.sendTraceTag(537170714,217,50,"Initializing EwaAccessTokenExpirationRefreshManager. {0}",(pa.AccessTokenTtl=Kc.AFrameworkApplication.vk,pa.NowGetTime=
T.getTime(),pa.BootTime=Kc.AFrameworkApplication.rha,pa.WopiTokenExpiresAfterMinutes=Kc.AFrameworkApplication.YZd,pa.WopiTokenTaskItemPriority=Kc.AFrameworkApplication.$Zd,pa));this.$.da.$a(291,function(Db){hb.documentVisibilityObserver=Db})}function Ia(T,pa){this.iXb=T;this.kT=pa}function Ya(){return tb.apply(this,arguments)||this}function tb(){}function Tb(){}function va(T,pa){this.jHb=!1;this.correlationID=T;this.e4c=pa;this.dAc=!1;this.creationTime=jf.a.Ua.Vb}function la(T){var pa=$a.call(this)||
this;pa.Pa=new Xe.a;pa.Xlb=!1;pa.cH=!1;pa.$=T;return pa}function $a(){this.Jfe=this.yQc=!1;var T=Kc.AFrameworkApplication.vk;if(!(0>=T)){this.vk=T;T=new Date;var pa={};dc.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",(pa.AccessTokenTtl=this.vk,pa.NowGetTime=T.getTime(),pa.BootTime=Kc.AFrameworkApplication.rha,pa));uj.a.instance.oVc(Object(of.a)(this,this.IOa,"onSessionExpiredDetected"));uj.a.instance.mVc(Object(of.a)(this,this.FBf,"onSessionExpiringDetected"))}}function Ra(T){var pa=
hi.call(this)||this;pa.$=T;pa.Tb();return pa}function eb(T,pa,hb){hb=void 0===hb?null:hb;var Db=Xi.call(this,pa)||this;Db.sheetTabActivatePreviousHidden=Le.a.instance.ga(724);Db.sheetTabActivateNextHidden=Le.a.instance.ga(726);Db.svgIconProvider=null;Db.Ah=[];Db.vK=Array(6);Db.Qwd=Array(6);Db.Xk=null;Db.RPd=null;Db.Iwc=null;Db.Pcb=null;Db.Gwc=null;Db.DH=null;Db.Yxb=null;Db.CRa=null;Db.isRtl=!1;Db.Wu=0;Db.kK=0;Db.ctc=!1;Db.Z6b=!1;Db.ona=0;Db.Ppc=0;Db.g7b=null;Db.aaa=null;Db.W3=null;Db.rM=null;Db.MC=
0;Db.tcc=0;Db.BMb=null;Db.LAb=-1;Db.dZ=null;Db.Xoc=0;Db.vyc=-1;Db.Jma=0;Db.Rta=new Ja;Db.lLc=!1;Db.I_=null;Db.Vfe=null;Db.SPd=null;Db.TPd=null;Db.dtc=null;Db.m9d=!1;Db.Okd=null;Db.hwd=!1;Db.Ufe=null;Db.bD=function(rc,vb){Db.SBf(vb.item)};Db.Cya=function(rc,vb){rc=Db.$.xa.qa.index;for(var Uc=0,Td=Db.Ah.length;Uc<Td;Uc++){var mf=Db.RQ(Uc);if(mf.name===vb.oldName){mf.name=vb.newName;Db.m0();Uc===rc&&Db.y0(6);break}}};Db.XBf=function(rc,vb){(rc=Db.x2a(vb.item))&&rc.afb()};Db.YBf=function(rc,vb){vb.visible?
(Db.uRa(!1),Db.UBf(vb.item)):Db.SBf(vb.item)};Db.wN=function(rc){Db.jF?(Db.dZ=rc,Db.UNb()):(Db.dZ&&(Db.Ppc+=Db.dZ.clientPoint.x-rc.clientPoint.x),Db.dZ=rc,Math.abs(Db.Ppc)>=Db.ehh&&Db.UNb());return!0};Db.NN=function(rc){rc.Ca.preventDefault();return!1};Db.HVf=function(rc){Db.EVf(rc,!0)};Db.GVf=function(rc){Db.EVf(rc,!1)};Db.m6=function(rc){if(Db.jF&&(Db.yz||Db.ggf(rc)))if(Db.Z6b=Db.fcf(rc),Db.yz){var vb;rc=(vb=Db.RQ(Db.MC+1))?vb.sheet:null;Db.reorderSheets(rc,Db.MC+1===Db.PPd,!0)}else rc=Db.hwd?null:
Db.Okd,Db.reorderSheets(rc,Db.hwd,!0);Db.vQ();return!0};Db.Th=function(rc,vb){vb.BF&&Db.sYd(vb.BF);Db.Ovc(!1);Db.m0();vb.qa&&(Db.sYd(vb.qa),Db.y0(6),Db.ea.nma())};Db.Jsf=function(rc,vb){Db.YBc(vb.item)};Db.Ksf=function(rc,vb){Db.YBc(vb.item)};Db.Lsf=function(rc,vb){Db.YBc(vb.item)};Db.AOa=function(rc,vb){Db.YBc(vb.item)};Db.hya=function(){Db.n0c()};Db.vd=function(){Db.isVisible=!Db.ea.isNamedObjectViewMode;Db.n0c();Db.W3c();$e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",
!1)&&(kh.d(Db.$)||kh.e(Db.$))&&(Ci.PageLoadTrackingInfo.instance.WW(ae.a.Pna,["sheetTabBar"]),Ci.PageLoadTrackingInfo.instance.bS(ae.a.Pna,["sheetTabBar"]));Db.E3c();Db.m0();Db.uRa(!0);Db.y0(6)};Db.ej=function(){Db.isVisible&&(Db.m0(),Db.y0(6))};Db.Hf=function(){Object(vd.a)(Bb,Db.DH)===fa.k(Db.$.mg)&&Db.E3c();for(var rc=Gl(Db.Ah),vb=rc.next();!vb.done;vb=rc.next())vb.value.Jmj(!fa.k(Db.$.mg))};Db.WBf=function(rc,vb){Db.acj(vb.item,vb.isUserOperation)};Db.OEb=function(rc,vb){Db.UBf(vb.item)};Db.onKeyDown=
function(rc){switch(rc.keyCode){case 9:var vb=Db.domElement.querySelectorAll(se.DOMElementExtensions.$r),Uc=se.DOMElementExtensions.mn(vb);vb=se.DOMElementExtensions.JC(vb);se.DOMElementExtensions.Bna(rc,Uc,vb);break;case 39:case 37:se.DOMElementExtensions.DYf(rc,Db.domElement.querySelectorAll(se.DOMElementExtensions.$r),39===rc.keyCode?!Db.isRtl:Db.isRtl)}dc.ULS.sendTraceTag(537153691,0,50,"SheetTabBarControl.OnKeyDown: Press on {0}",rc.keyCode)};Db.onScroll=function(){Db.Xk.scrollLeft!==Db.ona&&
Db.cHj()};Db.r6=function(rc){if(rc.ctrlKey||rc.n3)return!1;Db.Xk.scrollLeft+=Math.floor(30*rc.VBa);if(Db.yz&&Db.jF){var vb=Db.QYe("OnMouseWheel");vb&&Db.eUd(0<rc.VBa,vb.x+vb.width/2)}return!0};Db.wF=function(rc,vb){if(Db.Rta)Db.i5e("PartialInteractivity",vb.RL?3:0);else{Db.vQ(!1);Db.vOd(vb.RL);rc=Gl(Db.Fse);for(var Uc=rc.next();!Uc.done;Uc=rc.next())(Uc=Uc.value)&&Uc.yX(vb.RL);rc=Gl(Db.Ah);for(Uc=rc.next();!Uc.done;Uc=rc.next())(Uc=Uc.value)&&Uc.yX(vb.RL)}};Db.UDb=function(rc,vb){rc=0;vb.Nje&&(rc=
2|(vb.Ctj?1:0));Db.i5e("ComponentRangePicker",rc)};Db.$=T;Db.ea=Db.$.ea;Db.yz=Ph.a.Xdf();Db.o7b=Db.yz&&!$e.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");Db.qm=$e.EwaSettings.ma(504);Db.Ew=Ph.a.Lpd();Db.egf=Db.qm&&!($e.EwaSettings.isChangeGateEnabled("OfficeVSO:6179307_hideSheetDropDownMenuForMobileMeetings")&&Db.$.gK);Db.yz&&(Db.m9d=Db.qm&&!ya.a.kv);Db.RAi=Db.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;Db.QAi=Db.$.ya.SheetTabNavigateButtonIntervalPeriodMS;
Db.ehh=Db.$.ya.SheetTabDragStartPixelThreshold;Db.hPa=-1;Db.gPa=-1;Db.d2c=!1;Db.Ew&&(Db.svgIconProvider=hb);Db.gC=new d.a(Db.domElement,3);Db.qm&&Db.domElement.classList.add(Eb.jrh);Db.k7g();Db.M4g();Db.l7g();Db.n8g();Db.Ovc(!0);Db.vd(null,null);T=Db.$.xa;T.og(Db.Th);T.MUc(Db.hya);T.xY(Db.bD);T.Qga(Db.OEb);T.BFa(Db.Cya);T.Rme(Db.WBf);T.yYa(Db.YBf);T.MEg(Db.XBf);T.WUc(Db.Jsf);T.Ome(Db.Ksf);T.Pme(Db.Lsf);T.Qme(Db.AOa);Db.$.dl(Db.vd);Db.$.GA(Db.ej);ng.a(Db.$).ai(Db);Db.$.da.Ga(32,Db);$e.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&
Db.$.ea.Nt(Db.Hf);Db.Hwc=Db.Ae.je(Db.domElement);Db.Hwc.ka("keydown",Db.onKeyDown);ff.a(Db.$).Mq()&&Db.wF(null,new pb.a(!0));ff.a(Db.$).yg.Rga(Db.wF);zf.g(Db.$).mme(Db.UDb);$e.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&Db.Hwc.ka("mousedown",function(rc){rc.preventDefault()});oi.a.instance.pa(Vf.a.WC,Db.domElement,Db.r6);Db.QPd=Db.Ae.je(Db.Xk);Db.QPd.ka("scroll",Db.onScroll);Db.cHj=r.a(function(){Db.m0()},200,Db.$.la,kb.a.Htj,!0);Db.$.xH(ae.a.nAj);Db.egf&&
(Db.Ufe=new Nb(Db.$,Db.CRa.domElement));$e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&Ci.PageLoadTrackingInfo.instance.d7(ae.a.Pna,["sheetTabBar"]);return Db}function mb(T,pa,hb){pa=zc.call(this,document.createElement("a"),pa)||this;pa.zha=$e.EwaSettings.ma(504)?O.a.R8c:O.a.gsh;hb.Cb(pa.domElement,Le.a.instance.ga(715),0,pa.zha,Le.a.instance.ga(715),xc.a.u1c,!0);T.appendChild(pa.domElement);pa.Kc.ka("contextmenu",function(Db){Gc.g(Db)});return pa}function Pa(T,
pa,hb,Db,rc,vb,Uc){var Td=zc.call(this,document.createElement("li"),T)||this;Td.s0f=0;Td.t0f=0;Td.V0c=0;Td.W0c=0;Td.j4c=.5;Td.KPd=!1;Td.fV=!1;Td.LO=null;Td.XCb=null;Td.tE=null;Td.mHc=null;Td.color=null;Td.Fdf=!1;Td.ihc=!1;Td.p5b="#BEBBB8";Td.LEc=null;Td.onKeyDown=function(mf){return 13!==mf.Ca.keyCode||Td.disabled?!1:(Td.activateSheet(1),!0)};Td.Iz=function(mf){return 32!==mf.Ca.charCode||Td.disabled?!1:(Td.activateSheet(1),!0)};Td.CN=function(){Td.disabled||(Td.rS.wQi(Td),Td.rS.jF||Td.Hna(!0,void 0,
"OnMouseOver"))};Td.BN=function(){Td.disabled||Td.Hna(!1,void 0,"OnMouseOut")};Td.sya=function(){Td.rS.jF||(Td.HCj(),Td.sheet.y7||zf.g(Td.$).uIb(Td.sheet.sheetName));return!1};Td.q6=function(){Td.DKe(!1);return!1};Td.xd=function(mf){if(Td.disabled)return!0;var bg=zf.g(Td.$);Td.sheet.active||3!==mf.zb?Td.qm?Td.activateSheet(mf.zb):Ph.a.wqd()&&bg.focus():(!Ph.a.MMa(Td.$)&&!Td.qAb||bg.isEditing||bg.Li||bg.csb(),Td.activateSheet(mf.zb));return 3!==mf.zb};Td.onPointerDown=function(mf){if(Td.disabled)return!0;
Td.DKe(!0);zf.g(Td.$).inRangePicker&&dc.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var bg=3===mf.zb;if(2===mf.zb||bg&&Td.Xwa)Td.qm?(Td.Hna(!0,!bg,"OnPointerDown"),bg=Od.Task.delay(bg?Td.t0f:Td.s0f).CWR(function(){return!0})):bg=Td.activateSheet(mf.zb),Td.Nzb&&(Td.ihc=!0,Td.rS.dtc=jc.TaskExtensions.Ba(bg,function(){Td.ihc&&Td.rS.yQi(Td,mf)},Td.la,11));return!1};Td.Gf=function(mf){if(Td.disabled||!Td.Nzb&&
$e.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;var bg=Td.rS.jF&&!Ph.a.Xdf();Td.ihc=!1;Td.qm&&Td.Hna(2===mf.zb,void 0,"OnPointerUp");Td.rS.dtc&&(jc.TaskExtensions.Ba(Td.rS.dtc,function(){Td.rS.xQi(Td)},Td.la,11),Td.rS.dtc=null);return bg};Td.NN=function(){Td.ihc=!1;Td.KPd||Td.Hna(!1,void 0,"OnTouchMove");return!1};Td.rye=new Da(Td,T);Td.qm=vb;Td.Ew=Uc;Td.qAb=Ph.a.qAb(T);Td.dnd=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&
!Td.Ew;Td.qm?(Td.s0f=T.ya.SheetDragReorderDelayInMilliseconds,Td.t0f=T.ya.SheetDragReorderDelayInMillisecondsForTouch,Td.V0c=18,Td.W0c=20):(Td.V0c=19,Td.W0c=22);Td.$=T;Td.oWb=Db;Td.rS=rc;Td.Nzb=rc.Joe();Td.B9g();Td.z3g();Td.Sjd=T.Pb.Zg("UserAction",Td.name);Td.iod=!1;se.DOMElementExtensions.tu(Td.domElement,ae.a.Ts,null,null);Td.domElement.appendChild(Td.anchor);Td.anchor.appendChild(Td.tE);Td.Nna=new le.a;T=new Cb(Td.sheet,Td.qm,Td.Ew);Td.Nna.add(new Ta(Td.$,T));Td.$.ea.OKb&&(T=new cc(Td.sheet,Td.qm,
Td.Ew),Td.Nna.add(new Ta(Td.$,T)));Td.dnd||(T=new Sa(Td.sheet,Td.rS.Dwc,function(){return Td.color?Pa.RQd(Td.color):!1},Td.Ew),Td.XCb=new Ta(Td.$,T),Td.Nna.add(Td.XCb));Td.Xwa=Td.rS.Xwa;Td.afb();Td.C7i();Td.Ete=new d.a(Td.domElement,1);pa.insertBefore(Td.domElement,hb);fc.a(Td.$)&&Td.Pcg(!0);return Td}function Da(T,pa){var hb=yh.call(this,T.domElement)||this;hb.onKeyDown=function(Db){121===Db.keyCode&&Db.shiftKey&&!hb.Qna.disabled&&(hb.showContextMenu(new Sys.UI.Point(0,0),1,hb.Qna.anchor),Gc.g(Db))};
hb.rca=function(Db){if(!hb.$.isEditMode||hb.Qna.disabled)return!0;hb.rename(!1,Db.zb);return!0};hb.Ql=function(Db){return hb.Qna.disabled?!0:hb.showContextMenu(Db.clientPoint,Db.zb,Db.Lb)};hb.Zfe=T;hb.$=pa;Z.a.instance.pa(Vf.a.lk,T.domElement,hb.rca);Ne.a.instance.pa(T.domElement,hb.Ql);hb.Kc.ka("keydown",hb.onKeyDown);return hb}function Ta(T,pa){var hb=this;this.Cqa=this.G1=this.TAa=this.wl=null;this.Tef=!1;this.hRc=this.koa=this.Tsa=this.Iha=this.Ssa=null;this.CN=function(){hb.dataSource.ZM()&&
jc.TaskExtensions.Ba(hb.HBb,function(){dialogControls.renderToolTip(hb.dataSource.Iv(),"SheetIconTooltip",hb.dataSource.BVd(),hb.wI,10,!1,!1,1)},hb.$.la,3)};this.BN=function(){hb.dataSource.ZM()&&hb.clearToolTip()};this.$=T;this.dataSource=pa;this.Ew=Ph.a.Lpd()}function Sa(T,pa,hb,Db){this.sheet=T;this.altText=Le.a.instance.ga(1878);this.YIj=pa;this.S1f=hb;this.Ew=Db}function Cb(T,pa,hb){this.qm=pa;this.Ew=hb;this.sheet=T;this.altText=Le.a.instance.ga(1958)}function cc(T,pa,hb){this.qm=pa;this.Ew=
hb;this.sheet=T;this.altText=Le.a.instance.ga(1959)}function nc(T,pa,hb){var Db=zc.call(this,document.createElement("a"),T,!0)||this;Db.Ig=function(){Db.yX(!1);Db.$.ea.Yn(Db.Ig)};Db.xd=function(rc){Db.W8f(rc.zb);return!0};Db.onKeyDown=function(rc){return 13===rc.Ca.keyCode||32===rc.Ca.keyCode?(Db.W8f(rc.zb),!0):!1};Db.Dsa=pa.Cb(Db.domElement,Le.a.instance.ga(515),0,O.a.Qqh,Le.a.instance.ga(515),xc.a.o0h,Db.disabled);Db.domElement.classList.add(Eb.Tqh);hb.appendChild(Db.domElement);Db.$.ea.Fl(Db.Ig);
Db.q6i();return Db}function Nb(T,pa){var hb=Pc.call(this,document.createElement("div"))||this;hb.GR=function(){dc.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");hb.vQf(!1,"OnSheetsChanged")};hb.THi=function(){hb.Ej()};hb.SHi=function(){hb.al()};hb.$=T;hb.ZFj=pa;hb.fV=!1;hb.iNb=0;return hb}function nb(T,pa){this.sheetName=null;this.newSheetIndex=0;this.sheetName=T;this.newSheetIndex=pa}function db(T,pa,hb){var Db=zc.call(this,document.createElement("a"),pa)||this;Db.xd=function(rc){Db.$.Ud(-684145703,
rc.zb,0,null);return!0};Db.uEb=function(rc){Ud.HelperMethods.sVd(Db.vue,Db.zha,Db.zha+ae.a.Xdc,("mouseover"===rc.type||"focus"===rc.type)&&!zf.g(Db.$).inRangePicker)};Db.$=pa;Db.zha=$e.EwaSettings.ma(504)?O.a.R8c:O.a.sOe;Db.vue=hb.Cb(Db.domElement,Le.a.instance.ga(513),0,Db.zha,Le.a.instance.ga(514),xc.a.u1c);T.appendChild(Db.domElement);Db.Kc.ka("contextmenu",function(rc){Gc.g(rc)});Db.Kc.ka("mouseover",Db.uEb);Db.Kc.ka("mouseout",Db.uEb);Z.a.instance.pa(Vf.a.click,Db.domElement,Db.xd);Db.TMa=ah.KeyInputManager.instance.rs(Db.domElement,
Db.xd,Ba.a.ei,Ba.a.j1);return Db}function Bb(T,pa,hb,Db){Db=void 0===Db?!1:Db;var rc=zc.call(this,document.createElement("a"),pa,Db)||this;rc.xd=function(vb){rc.disabled||rc.$.Ud(-1935155518,vb.zb,30,null);return!0};rc.uEb=function(vb){vb="mouseover"===vb.type||"focus"===vb.type;var Uc=fc.a(rc.$)?rc.M$a:rc.Dsa;Ud.HelperMethods.sVd(Uc,rc.zha,rc.zha+ae.a.Xdc,vb&&!zf.g(rc.$).inRangePicker)};rc.fj=function(){rc.yX(!0)};rc.Tf=function(){rc.yX(!1)};rc.zha=$e.EwaSettings.ma(504)?O.a.R8c:O.a.sOe;rc.Dsa=hb.Cb(rc.domElement,
Le.a.instance.ga(511),0,rc.zha,Le.a.instance.ga(512),xc.a.u1c,Db);T.appendChild(rc.domElement);rc.Kc.ka("contextmenu",function(vb){Gc.g(vb)});$e.EwaSettings.ma(504)||(rc.Kc.ka("mouseover",rc.uEb),rc.Kc.ka("mouseout",rc.uEb));Z.a.instance.pa(Vf.a.click,rc.domElement,rc.xd);rc.TMa=ah.KeyInputManager.instance.rs(rc.domElement,rc.xd,Ba.a.ei,Ba.a.j1);$e.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&(zf.g(rc.$).tc.ql(rc.fj),zf.g(rc.$).tc.Kn(rc.Tf));return rc}function zc(T,
pa,hb){hb=void 0===hb?!1:hb;T=Fb.call(this,T)||this;T.Dsa=null;T.M$a=null;T.$=pa;T.UX=hb;return T}function Eb(){}function Ja(){this.DHe=new wh.a(!0);this.AHc=0}function Rb(T){return rf.call(this,T)||this}function yc(T){this.shh=T}function qd(T){return Mf.call(this,T)||this}function bc(T,pa,hb,Db){var rc=this;this.menuId=null;this.VQa=-1;this.zCf=function(){rc.eda()};this.PRi=function(vb){if(!(rc.ta.FLa()||(!$e.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||
Rf.a(vb)||rc.WLa())&&Rf.a(vb)&&rc.WLa())){vb=rc.ta.activeCell;var Uc=rc.ta.activeRange,Td=rc.tableManager.Eg.usedRange;2===rc.VQa&&cg.g(rc.tableManager.Eg)&&vb.bottom===Td.bottom&&(Uc=Uc.y5?new Se.Range(Uc.top-1,Uc.left,Uc.bottom-1,Uc.right,!1,!0):new Se.Range(Uc.top,Uc.left,Uc.bottom-1,Uc.right,!1,!0),vb=Uc.contains(vb)?vb:Se.Range.hd(Uc.bottom,vb.left),zf.g(rc.$).ha.updateSelection(Uc,vb,0,3))}};this.gRi=function(vb){Rf.a(vb)?(dc.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),
rc.$.Bf()):dc.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.fRi=function(){dc.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");rc.$.Bf()};this.hRi=function(vb,Uc){Uc&&rc.mL(Uc);Rf.b(vb,-569193796)&&(vh.a(rc.$).ud.bE(-569193796),rc.Xpi(vb.Errors[0]))};this.$=T;this.tableManager=pa;this.namedSheetViewPublic=hb;this.frame=this.$.frame;this.ha=zf.g(this.$).ha;this.ta=this.ha.ta;this.hy=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
this.tableStyleManager=Db;this.tableStyleManager.aGg(this.zCf)}function Vb(T){T=jh.call(this,T)||this;var pa=zf.g(T.$);pa=pa.Nb.rj(pa.ha.ta.activeCell);Pf.a.Fh(pa.HSa)?T.WBd="":T.WBd=pa.HSa;Pf.a.Fh(pa.ISa)?T.UBd="":T.UBd=pa.ISa;pa=T.FM(T.WBd,T.UBd);T.initializeAndShow(Le.a.instance.ga(744),T.FFj,pa);return T}function mc(T){var pa=vi.call(this,T)||this;pa.PFj=function(hb,Db){1===hb&&pa.BKj(Ff.D(pa.WEf(Db[mc.uKf])))};pa.pvb=function(hb){hb=pa.wed(hb);return pa.Obd(hb)};pa.gridView=zf.g(T);pa.ta=pa.gridView.ha.ta;
pa.Yoc=pa.gridView.Nb.rj(pa.ta.activeCell).usedRange;T=pa.FM(pa.Yoc.toString());pa.initializeAndShow(Le.a.instance.ga(735),pa.PFj,T);return pa}function sb(T,pa){T=Bi.call(this,T)||this;T.WAa=pa;return T}function Yb(T,pa){T=sg.call(this,T,Le.a.instance.ga(734))||this;T.WAa=pa;return T}function Hb(T,pa,hb){this.Dzb=!1;this.sharedSheetRange=pa;this.$=T;this.kh=this.$.Pb.Zg("UserAction","ConvertToRangeManager");this.tableName=hb}function sc(T,pa){var hb=this;this.A_d=null;this.B_d=0;this.jj=null;this._state=
0;this.moveNext=function(){try{for(hb._state=1;1===hb._state;)hb.Ju=hb.Ju()}catch(Db){hb.dispose(),hb._state=3}};this.Cf=T;this.dCa=pa;this.Ju=this.tL;this.moveNext()}function zb(T){this.tableName=null;this.tableName=T}function vc(T,pa,hb){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=T;this.optionType=pa;this.isPivotTable=hb}function ad(T){this.originalRange=null;this.originalRange=T}function ub(T,pa){this.newName=this.oldName=null;this.oldName=T;this.newName=pa}function Za(T,
pa,hb){this.description=this.title=this.tableRange=null;this.tableRange=T;this.title=pa;this.description=hb}function wa(T,pa,hb,Db){T=ja.call(this,T,hb)||this;T.hasHeaders=!1;T.isCreation=!1;T.hasHeaders=pa;T.isCreation=Db;return T}function ja(T,pa){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=T;this.tableRange=Ff.l(T.Ranges[0],T.SheetName);this.styleIndex=pa}function Ua(T){this.autoFilterOptions=null;this.autoFilterOptions=T}function bb(T,pa){this.autoFilterOptions=null;
this.sortType=0;this.autoFilterOptions=T;this.sortType=pa}function Xa(T){var pa=Hi.call(this)||this;pa.tableStyleManager=null;pa.$=T;pa.Tb();return pa}function yb(T,pa,hb){var Db=ki.call(this)||this;var rc={};Db.PZi=(rc.height="100%",rc);Db.mHb={};Db.tgd=0;Db.LHa=0;Db.lastSyncTime=new Date;Db.Fda=-1;Db.VN=null;Db.Ema={};Db.hL=null;Db.aG={};Db.JSa={};Db.Drc=null;Db.Ref=!1;Db.isInitialized=!1;Db.a6a=!1;Db.gAb=!1;Db.Euc=null;Db.bUe=!1;Db.nMb=!1;Db.Nyc=!1;Db.Xxh=function(){Db.aic()?Db.$.ea.uId(Db.Xxh):
Db.uKa("tableStyleManagerInitialization")};Db.Zwf=function(vb,Uc,Td){var mf=!1,bg=$e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1);if(Rf.a(vb))-315732528!==vb.Errors[0].MessageId&&(dc.ULS.sendTraceTag(42821707,0,10,"TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : {0}",Df.a.Tc(vb.Errors)),Db.Tzd(null,Uc,Td));else if(dc.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),
(vb=vb.Result)&&vb.TableStyleItems.length){Td=60<vb.TableStyleItems.length;var qg=!1,Kg=!1;if(Db.hL)for(var di=0;60>di;++di){var Bh=vb.TableStyleItems[di],ak=Db.hL.TableStyleItems[di];if(bg&&Bh.HasStyleViolations!==ak.HasStyleViolations){mf=Kg=!0;break}for(var Kh=0;9>Kh&&!(Kh>=Bh.TableStyleElementsList.length);Kh++)if(!Pf.a.equals(Bh.TableStyleElementsList[Kh].BackgroundColor,ak.TableStyleElementsList[Kh].BackgroundColor,!1)){mf=qg=!0;break}}else for(Db.LHa=0,di=Gl(vb.TableStyleItems),Bh=di.next();!Bh.done;Bh=
di.next())Bh=Bh.value,Bh.TableStyleElementsList&&Bh.TableStyleElementsList.sort(Qa.tmf),Db.aG[Bh.Name]=Bh;if(qg||Kg)for(qg=0;60>qg;++qg)Kg=vb.TableStyleItems[qg],Db.aG[Kg.Name]=Kg;if(Td&&Db.hL)for(dc.ULS.sendTraceTag(42821700,0,50,"TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - {0}",vb.TableStyleItems.length-60),mf=!0,Td=60;Td<vb.TableStyleItems.length;++Td)qg=vb.TableStyleItems[Td],qg.Name in Db.aG||qg.TableStyleElementsList&&qg.TableStyleElementsList.sort(Qa.tmf),Db.aG[qg.Name]=
qg;if(zg.a(Db.aG).length!==vb.TableStyleItems.length)for(mf=!0,qg=Td=60;qg<Db.hL.TableStyleItems.length;)Td>=vb.TableStyleItems.length?delete Db.aG[Db.hL.TableStyleItems[qg].Name]:Td>=vb.TableStyleItems.length||!Pf.a.equals(vb.TableStyleItems[Td].Name,Db.hL.TableStyleItems[qg].Name,!1)?delete Db.aG[Db.hL.TableStyleItems[qg].Name]:++Td,++qg;Db.hL=vb;Db.MMf(mf);mf&&Db.IYc();bg&&Uc&&("accessibility"===Uc?(Db.nMb=!1,Db.Nyc=!0):Db.Nyc=!1);Db.Ref||(Db.Wli()&&Db.$.Bf(),Db.Ref=!0);Db.tgd=0;Db.gAb||Db.bUe?
bg&&Db.Nyc&&Db.raiseEvent("RefreshTableStyleGallery"):(Db.raiseEvent("RefreshTableStyleGallery"),Db.bUe=!0)}};Db.Tzd=function(){dc.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");Db.tgd++;5>Db.tgd&&Na.a.instance.create(function(){Db.uKa("getTableStylesFailed")},1E3,kb.a.k7f,!0,!0)};Db.yCf=function(){Db.gAb&&(Db.gAb=!1,Db.Euc&&Db.Euc(),Na.a.instance.create(function(){Db.uKa("galleryMenuClosed")},1E3,kb.a.k7f,!0,!0))};Db.$=T;Db.Ta=pa;Db.tableManager=
hb;Db.$.da.Ga(329,Db);Db.dZc=Db.Uub();Db.$.Ka.zYa(Db.yCf);return Db}function Ib(T,pa,hb,Db,rc,vb){this.headerRow=T;this.totalRow=pa;this.firstCol=hb;this.lastCol=Db;this.gS=rc;this.Rha=vb}function Qa(){}function cb(){}function lb(T){var pa=Ga.call(this)||this;pa.tableManager=null;pa.$=T;pa.Tb();return pa}function Ha(T){var pa=Ub.call(this,zf.g(T))||this;pa.opb=null;pa.nzc=null;pa.V0=null;pa.qpb=null;pa.rpe=!1;pa.P9d=null;pa.yRb=0;pa.r5b=null;pa.f0b=function(){var hb={},Db=pa.Dfd(),rc;for(rc in Db){var vb=
Db[rc];if(vb){var Uc=pa.wXh(vb);if(Uc){if(Uc in pa.oFa){var Td=pa.oFa[Uc];if(Td.mB){Td.ao.equals(vb)||(Td.ao=vb);delete pa.oFa[Uc];hb[Uc]=Td;continue}}(Td=kc.createInstance(zf.g(pa.$),vb,pa.UGh(),pa))?hb[Uc]=Td:dc.ULS.sendTraceTag(537151239,0,15,"TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range {0}",vb.hB(!1))}}}pa.g2b(null,null);pa.cQb=hb};pa.g2b=function(){var hb=pa.oFa,Db;for(Db in hb){var rc=Db,vb=hb[Db];vb&&(vb.dispose(),delete pa.oFa[rc])}pa.cQb={}};pa.yKf=function(){pa.g2b(null,
null);pa.f0b(null,null)};pa.onFocus=function(){pa.P9d=zf.g(pa.$).ha.ta.activeCell};pa.j6=function(){pa.$.isEditMode&&pa.Sh(null,null)};pa.Sh=function(){!pa.rpe&&Oe.c(pa.$,pa.gridView.ha.ta.activeCell)&&pa.xri()};pa.sN=function(){pa.Rxb(1);pa.$.ea.Yn(pa.sN)};pa.dGb=function(){pa.rpe=!0;pa.nzc=new $b(pa.$)};pa.$=T;pa.gridView=zf.g(pa.$);pa.$.da.Ga(66,pa);pa.cQb={};pa.f0b(null,null);pa.$.xa&&pa.$.xa.og(pa.yKf);pa.pne(pa.f0b);pa.$.ea.E2(pa.j6);pa.gridView.ha.oJ(pa.Sh);pa.$.isEditMode&&pa.Sh(null,null);
return pa}function $b(T){var pa=Bg.call(this,document.createElement("div"))||this;pa.UQ=!1;pa.REf=!1;pa.qnd=!1;pa.vTc=!1;pa.BJb=null;pa.Sh=function(){Oe.c(pa.$,pa.gridView.ha.ta.activeCell)?(pa.GLa=!0,pa.Rqb(!1)):(pa.GLa=!1,pa.g5=!1,pa.Rag())};pa.qt=function(){pa.GLa?pa.Rqb(!0):pa.g5=!1};pa.Ttf=function(){pa.vTc=!0;pa.GLa&&(pa.g5=!1)};pa.onContentReady=function(){pa.$.isEditMode?Oe.c(pa.$,pa.gridView.ha.ta.activeCell)&&(pa.GLa=!0,pa.Rqb(!1)):pa.g5=!1};pa.LDb=function(){pa.vTc=!1;pa.GLa?pa.Rqb(!1):
pa.g5=!1};pa.yf=function(hb,Db){pa.GLa&&(hb=pa.gridView.ipc(Db.nd.block.qe.BlockCachePosition.PaneType).lG(Db.nd.hash))&&(hb.eJd(pa.RKa),hb.wVc(pa.RKa))};pa.RKa=function(){pa.qQf()};pa.$=T;pa.gridView=zf.g(pa.$);pa.parentElement=pa.domElement;pa.parentElement.className=Jb.urh;pa.CKa=pa.gridView.Lj;pa.GLa=!0;pa.S9h();pa.vLg();pa.Rqb(!1);dc.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ");return pa}function Jb(){}function kc(T,pa,hb,Db){var rc=Eh.call(this,T)||this;
rc.j7f=[6];rc.d7f=[26];rc.Nr=null;rc.jic=!1;rc.szb=!1;rc.Zaa=null;rc.ot=null;rc.onPointerDown=function(vb){if(1!==rc.$.Ka.lH())return!0;vb=Ih.a(rc.$).ie(vb);if(rc.mB)return!0;var Uc=ff.a(rc.$).lod||ff.a(rc.$).Mq();if(rc.$pd||Uc)return rc.ubb(),!0;rc.ot=rc.ao;rc.OHd();rc.yjd();Uc=2===vb.zb&&vb.Vn===Sys.UI.MouseButton.leftButton;var Td=3===vb.zb;if(Uc||Td)vb=rc.ha.Xn(vb.clientPoint,vb.Lb,5,void 0,void 0,!0),vb||(vb=rc.ot),rc.szb=Uc,rc.jic=Td,rc.ot=rc.Q2e(vb),rc.yjd(),Uc?rc.Y6i():Td&&rc.L7i(),Rg.b(rc.$,
!0);return!0};rc.Ih=function(vb){vb=Ih.a(rc.$).ie(vb);if(!rc.mB)return!1;if(vb=rc.szb?rc.ha.Xn(vb.clientPoint,vb.Lb,5,void 0,void 0,!0):rc.ha.Xn(vb.clientPoint,vb.Lb,5,!0,!1,!0))vb=rc.Q2e(rc.LYa(vb)),rc.L0b(vb.bottomRight),rc.ot.equals(vb)||(rc.ot=vb,rc.AHb(!1),rc.OHd(!1),rc.yjd(!1),rc.u5h(),rc.Db.update(!1)),rc.ePj(rc.ot);return!0};rc.Gf=function(vb){Ih.a(rc.$).ie(vb);if(!rc.mB)return!1;rc.resizeTable();rc.ubb();return!0};rc.ZEb=function(vb){Ih.a(rc.$).ie(vb);if(!rc.mB)return dc.ULS.shipAssertTag(537151233,
0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;rc.resizeTable();rc.ubb();return!0};rc.vca=function(vb){Ih.a(rc.$).ie(vb);rc.ubb();return!0};rc.Otf=function(){rc.mB&&rc.ubb()};rc.gridView=pa;rc.$=pa.$;rc.tableManager=Db;rc.ha=pa.ha;rc.Db=pa.Db;rc.parentElement=T;rc.dRg();ya.a.pp||ya.a.Cka||Eg.a.instance.pa(Vf.a.pointerDown,rc.Zaa,rc.onPointerDown);rc.ao=hb;rc.$pd=!1;rc.xLc=!1;rc.tableManager.uDg(rc.Otf);return rc}function uc(T){var pa=Sf.call(this)||this;
pa.$=T;pa.Tb();return pa}function hd(T){var pa=this;this.Ig=function(){pa.$jf();pa.$.ea.Yn(pa.Ig)};this.$=T;this.R6f={};this.bUd={};var hb=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite",Db=this.nZe(hb);Db?(this.Nle(Db),this.$.ea.sh?this.$jf():T.ea.Fl(this.Ig),this.$.da.Ga(388,this)):dc.ULS.sendTraceTag(537151263,0,15,"window[{0}].icons returned null.",hb)}function ma(){}function jb(T){var pa=ie.call(this)||this;pa.sparklineManager=
null;pa.$=T;pa.Tb();return pa}function Zb(T,pa){T=Ub.call(this,T)||this;pa.Ga(240,T);return T}function Ub(T){var pa=hf.call(this)||this;pa.tT=[];pa.yf=function(Td,mf){var bg,qg=mf.nd.block;Td=!1;if(qg.mk&&qg.state&1&&(bg=pa.view.Uf(mf.nd.block.qe.BlockCachePosition.PaneType).lG(mf.nd.hash))){qg=pa.QFd(qg.Be);if(bg=bg.uf)for(var Kg=pa.tT.length-1;0<=Kg;Kg--)bg.contains(pa.tT[Kg].bottomRight)&&(Array.removeAt(pa.tT,Kg),Td=!0);if(qg)for(bg=0,Kg=qg.length;bg<Kg;bg++)pa.rangeList.push(oc.a.JQ(qg[bg])),
Td=!0;Td&&(mf=($e.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?pa.view.ipc(mf.nd.block.qe.BlockCachePosition.PaneType):pa.view.l3).lG(mf.nd.hash),pa.raiseEvent(Ub.RFd,new Yc.a(mf)))}};pa.Sm=function(){pa.tHb()};pa.Do=function(){pa.tT=[]};pa.Die=T;var hb=T.Ea;hb.Qs(pa.yf);hb.Oga(pa.yf);hb.WYb(pa.yf);hb.EG(pa.Sm);T.$.xa.pJ(pa.Do);T.$.Hb.pJ(pa.Do);hb=Gl(T.vn);for(var Db=hb.next();!Db.done;Db=hb.next()){Db=Gl(Db.value);for(var rc=Db.next();!rc.done;rc=Db.next()){rc=
Gl(rc.value);for(var vb=rc.next();!vb.done;vb=rc.next()){vb=vb.value;var Uc=T.Ea.ul(vb.hashCode);pa.yf(pa,new De.a(new wf.a(Uc,vb.hashCode),null))}}}return pa}function Qc(T){var pa=Ie.call(this)||this;pa.$=T;pa.Tb();return pa}function kd(T,pa){var hb=this;this.oW=function(){hb.Pd||hb.kpe()};this.Pd=!1;this.fZ=pa.FU;this.ariaLiveNotifier=T;this.c_d=new bd(T,pa);this.fZ&&this.fZ.dR?this.kpe():this.Ej()}function xb(T,pa,hb){var Db=this;this.Zxf=function(){Db.c_d.kLf();Db.ariaLiveNotifier.setEnabled(!0)};
this.$=pa;this.ariaLiveNotifier=T;this.c_d=new bd(T,pa);this.c$b=hb.ffd(this.$);this.c$b.SEg(this.Zxf)}function bd(T,pa){this.$=pa;this.ariaLiveNotifier=T}function Qd(T){var pa=me.call(this)||this;pa.$=T;pa.Tb();return pa}function zd(T,pa,hb,Db,rc){var vb=this;this.gridReadoutNotifier=null;this.nab=!1;this.Fsa=this.eob=null;this.Xca=function(){$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!vb.$?dc.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):
zf.g(vb.$).isEditing||vb.U_b.Zq()};this.mEi=function(){if(!zf.g(vb.$).ha.Oa.cpd){var Uc=vb.rGh();vb.readText(Uc.returnValue,Uc.activeCell)}};this.zp=function(){var Uc=vb.activeCell;vb.readText("Editing",Uc);$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||Uc&&Uc.idc&&!zf.g(vb.$).Q5e||vb.U_b.cancel()};this.ld=function(){$e.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!vb.$?dc.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):
(vb.Xca(),vb.nab&&zf.g(vb.$).inRangePicker&&1===dd.a.Sb&&(null===vb.eob?vb.eob=Na.a.instance.create(vb.nGd,zd.sTc,"readSelectedRanges"):vb.eob.Zq()))};this.$=pa;this.ariaLiveNotifier=T;this.sparklineManager=Db;this.tableManager=hb;this.mD=new Jd;this.Y5a=Md.Y5a();this.nab=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.Y5a&&($e.EwaSettings.Gb()?this.gridReadoutNotifier=rc:this.gridReadoutNotifier=pa.da.za(244),dc.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,
"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),zd.sTc=700);this.U_b=Na.a.instance.create(this.mEi,zd.sTc,kb.a.Hkj,!1);this.Ej()}function Jd(){this.activeItemName=null;this.Qff=!1;this.tableName=null;this.R_a=0;this.izc=!1}function gc(){}function Hc(T){switch(T){case 1:return 1434;case 2:return 1435;case 3:return 1436;case 4:return 1437;case 5:return 1438;case 6:return 1439;case 7:return 1440;case 8:return 1441;case 9:return 1442;case 10:return 1443;case 11:return 1444;case 12:return 1445;
case 13:return 1446;case 14:return 1447;case 15:return 1448;case 16:return 1449;case 17:return 1450;case 18:return 1451;case 19:return 1452;case 20:return 1453;case 21:return 1454;case 22:return 1457;case 23:return 1455;case 24:return 1456;case 25:return 1458;case 26:return 1459;case 27:return 1460;case 28:return 1461;default:return 1462}}function Tc(T){var pa=Pd.call(this)||this;pa.$=T;pa.Tb();return pa}function Md(T,pa){this.l0=this.MW=this.XN=null;this.$ia=pa;this.F8g(T);this.aZi();$e.EwaSettings.Gb()&&
T.da.Ga(244,this)}function Xc(T){var pa=fh.call(this)||this;pa.$=T;pa.Tb();return pa}function Cd(T,pa,hb){var Db=this;this.zuf=function(rc,vb){Db.bLf(vb.Sd.command)};this.$=T;this.Wea=document.createElement("div");this.Wea.setAttribute(ae.a.IP,ae.a.ik);this.Wea.className=lg.a.K8c;pa.insertBefore(this.Wea,hb);this.iga=document.createElement("div");this.iga.setAttribute(ae.a.IP,ae.a.ik);this.iga.className=lg.a.K8c;pa.insertBefore(this.iga,this.Wea);this.Frg=Le.a.instance.Wa(2);this.lha=document.createElement("div");
this.lha.setAttribute(ae.a.Wd,ae.a.ksa);this.lha.setAttribute(ae.a.nsa,ae.a.Vnb);this.lha.className=lg.a.K8c;pa.insertBefore(this.lha,this.iga);this.register();this.$.da.Ga(211,this)}function Sb(T,pa){pa&&(T.append(pa),T.append(Mc.hud))}function Mc(T){this.ruc=T||""}function md(T){var pa=Lf.call(this)||this;pa.$=T;pa.Tb();return pa}function wc(T){var pa=hg.call(this)||this;pa.ysd=null;pa.$=T;dc.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created");return pa}function ed(){return od.call(this)||
this}function Nd(T){var pa=kg.call(this)||this;pa.$=T;pa.Tb();return pa}function pe(T){var pa=Ec.call(this,document.documentElement,T)||this;pa.WB=0;pa.XMg=[fg.a.JBe,fg.a.Gxd,fg.a.sdc,fg.a.f9f,fg.a.fLd,fg.a.KYc,fg.a.jbd,fg.a.W3e,fg.a.RXc,fg.a.tzc,fg.a.uAj,fg.a.Ccc,fg.a.YZc,fg.a.Qtb,fg.a.OPd,fg.a.e_c,fg.a.o5f,fg.a.Vjf,fg.a.nYc];pa.bUj=[fg.a.sdc,fg.a.Aeg,fg.a.zeg,fg.a.Beg];pa.e_i=[fg.a.sdc,fg.a.THf,fg.a.UHf,fg.a.XHf];pa.WUg=[fg.a.lUe,fg.a.V3e,fg.a.hbd,fg.a.ebd];pa.GZi=[fg.a.JBe,fg.a.Gxd,fg.a.KYc,fg.a.jbd,
fg.a.RXc,fg.a.tzc,fg.a.Ccc,fg.a.YZc,fg.a.Qtb,fg.a.OPd,fg.a.pHf,fg.a.e_c,fg.a.nYc];pa.QZi=[fg.a.Ccc,fg.a.qUe];var hb=Le.a.instance.Wa(251);pa.Coj=pa.$.shortcutKeyManager.aKa(hb);pa.mode=0;T.da.Ga(15,pa);jc.TaskExtensions.Ba(qb.GetServiceTaskFactory.Xa(T.da,21,137,1),function(Db){Db=Db.result;Db.jo(pc.a.lmb);Db.Tl(pc.a.lmb,pa.EIb)},T.la);return pa}function Ec(T,pa){var hb=Ce.call(this,T)||this;hb.Y8=[];hb.L9d=null;hb.EIb=function(Db){var rc="forward";Db.Values[hc.a.direction]?rc=Db.Values[hc.a.direction].toLowerCase():
dc.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");Db=0;var vb=!0;"backward"===rc?(Db=hb.Erd.length-1,vb=!1):"forward"===rc?(Db=0,vb=!0):dc.ULS.sendTraceTag(537166663,0,15,"Received unknown direction to resume focus: {0}",rc);hb.Qpf(vb,Db,!1)};hb.Yxf=function(){hb.Y8=[]};hb.BOa=function(Db){if(-411645385===hb.$.shortcutKeyManager.au(Db,!0)&&hb.tdf()){var rc={};hb.$.Ka.Wb(new id.a(-411645385,1,hb.$.Xc,6,null),(rc.event=Db,rc),Db);Db.stopPropagation()}};hb.fMi=function(Db){hb.ema(Db)};
hb.xb=pa;hb.Kc.ka("keydown",hb.fMi);hb.Kc.ka("keyup",hb.BOa);ng.a(pa).mGg(hb.Yxf);da.a(pa.ya,27)&&jc.TaskExtensions.Ba(qb.GetServiceTaskFactory.Xa(pa.da,21,137,1),function(Db){Db=Db.result;Db.jo(pc.a.H7e);Db.Tl(pc.a.H7e,hb.EIb)},pa.la);return hb}function rd(){this.amb=this.Ude=this.tb=null;this.Cm=!1}function Dd(T,pa,hb,Db,rc,vb,Uc){this.hgb={};this.Z1=T;this.xrg=pa;this.dra=new lf(Kc.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),Kc.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",
3),this.Nw.Hlc);this.Ira=new lf(Kc.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),Kc.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.Nw.Hlc);this.Rtg=hb;this.Xie=Db;this.hyg={};this.qT=new qf;this.rog=rc;this.oUb="";this.Rv=vb;this.m5d=Uc;this.Stg=Kc.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",25);return this}function wb(){this.mruItemId=this.app=
this.documentExt=this.documentName=this.folderName=this.documentUrl=null}function lf(T,pa,hb){this.task=null;this.zec=T;this.Xxi=pa;this.taskManager=hb;this.retryCount=this.ayb=0;this.POc=this.UAb=null}function qf(){this._state=0;this.Xae=this.Zae=this.Yae=null;this.state=this.Ihe=0;this.rKc=!1;return this}function Cf(T,pa,hb,Db,rc){this.Apg=6E4;this.R8e="inactive";this.Cje="active";this.nT=!0;this.ue=T;this.vog=pa;this.XIc=hb;this.fXb=Db;this.Za=new Ef.a;rc&&this.JCj();this.Q9d=this.JZe()}function Fe(T,
pa){this.hgb={};this.Z1=T;this.clb=new Ke(pa,this.JCb.Hlc,"GetMoreInfo");this.No=new Id;return this}function Ke(T,pa,hb){this.eWb=this.Vi=null;this.HPc=0;this.Xug=T;this.ue=pa;this.o4d=hb}function $d(T,pa,hb,Db,rc,vb,Uc,Td){this.La=T;this.dh=pa;this.Wjg=hb;this.r1=Db;this.ue=rc;this.XIc=vb;this.Uog=Uc;this.TWb=Td}function Id(){this._state=0;this.tRc=this.Bkb=null;this.state=0;this.rKc=this.R7d=!1;return this}function he(){this._state=0}function Af(){this.hgb={}}function ne(){this.tb=null}function Te(){this.TVa=
null}function Ac(T){return String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",Kc.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",T,Kc.AFrameworkApplication.nj)}function Kd(T){var pa=new lc.a;Kc.AFrameworkApplication.Jd.gm(Ac(T),1,null,null,!0,2,function(hb){200===hb.data.httpStatus?pa.setResult("true"===hb.data.ke.toLowerCase()):pa.setResult(!1)},function(){pa.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return pa.task}function ce(T,pa){this.La=T;this.ZPb=
pa}function sd(T){var pa=$f.call(this,!1,!1,!0)||this;pa.ZPb=T;return pa}function Ge(T,pa){this.ID=T;this.type=pa}function kf(T,pa){this.value=T;this.contextId=pa}function Ze(T,pa,hb,Db,rc,vb,Uc,Td){this.type=T;this.startTime=null==hb||void 0==hb.value?new kf(hb,null):hb;this.endTime=null==Db||void 0==Db.value?new kf(Db,null):Db;null!=rc&&void 0!=rc.value||new kf(rc,null);null!=vb&&void 0!=vb.value||new kf(vb,null);this.operationType=Td}function je(T){this.ID=T}function dg(){this.Pe=[];this.Fnb=[];
this.cWc=0;this.duration=this.startTime=null;this.u7b={};this.vvd=this.Yvd=this.xXc=-1}b.r(C);var Zd=b(0),of=b(82),Wf=b(150),$f=Wf.a;Wl(sd,$f);sd.prototype.start=function(){var T={},pa={};T=(pa.id="AccessibilitySettingsDialog",pa.bodyControls=(T.tooltipPersistenceEnabled=this.ZPb.$7e,T),pa);this.initializeAndShow("",Object(of.a)(this,this.Lfj,"resultHandler"),T)};sd.prototype.Lfj=function(T,pa){1===T&&(this.ZPb.$7e=pa.tooltipPersistenceEnabled)};Object(Zd.a)(sd,"AccessibilitySettingsDialog",Wf.a,
[]);var mg=b(107),Qf=b(27);ce.prototype.Og=function(){this.La.fc(Qf.a.Xwj,mg.a.frame,Object(of.a)(this,this.Ywj,"showAccessibilitySettingsDialogHandler"))};ce.prototype.Ywj=function(){(new sd(this.ZPb)).start();return 32};Object(Zd.a)(ce,"AccessibilitySettingsDialogActor",null,[477]);var lc=b(162),Kc=b(4),Fd=b(166);Te.prototype.lri=function(){var T=this,pa=new lc.a;if(this.TVa)pa.setResult(this.TVa);else if(this.Dff()){var hb=Kd("getHoverableRibbonTooltipIsEnabled");hb.continueWith(function(){T.TVa=
hb.result;Fd.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(hb.result);pa.setResult(hb.result)},8)}else pa.setResult(!1)};Te.prototype.Dff=function(){var T=Kc.AFrameworkApplication.fa.ra("IsRoamingServiceEnabled"),pa=Kc.AFrameworkApplication.fa.ra("IsAnonymousUser");return T&&!pa};Ck.Object.defineProperties(Te.prototype,{$7e:{configurable:!0,enumerable:!0,get:function(){return!!this.TVa},set:function(T){T!==this.TVa&&(this.TVa=T,Fd.a("setHoverableTooltipsPreference")&&
appChrome.api.setHoverableTooltipsPreference(T),this.Dff()&&Kc.AFrameworkApplication.Jd.gm(Ac("saveHoverableRibbonTooltipIsEnabled"),2,T.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}}});Object(Zd.a)(Te,"AccessibilitySettingsInfo",null,[476]);var re=b(257),ke=b(171);ne.prototype.fi=function(T){var pa=this;this.tb=T;this.tb.register(Te,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Oc(function(){return new Te}).Hc();
this.tb.register(ce,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Oc(function(){return new ce(Kc.AFrameworkApplication.Ib,pa.tb.Lh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))}).Hc()};ne.prototype.init=function(){var T=this.tb.Lh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),pa=this.tb.Lh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");T&&pa?(pa.Og(),
T.lri()):ke.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")};ne.prototype.dispose=function(){};ne.main=function(){re.a.instance.gj(new ne)};Ck.Object.defineProperties(ne.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.AccessibilitySettings"}}});Object(Zd.a)(ne,"AccessibilitySettingsPackage",null,[4,5]);var nd=b(612),dc=b(15);Af.prototype.Syg=function(T){this.hgb[T.id.toString()]=
T};Af.prototype.rCi=function(T){var pa=this.hgb,hb;for(hb in pa)pa[hb].notify(T,!1);this.hgb={}};Af.prototype.R0i=function(T,pa){pa&&this.Syg(pa);return this.NAf(T,pa)};Af.prototype.s7c=function(T){this.rCi(T)};Af.prototype.iKe=function(T,pa){T.notify(pa,!0)};Object(Zd.a)(Af,"AEventEmitter",null,[900]);var Xd;(function(T){T[T.notStarted=0]="notStarted";T[T.waiting=1]="waiting";T[T.shouldRetry=2]="shouldRetry";T[T.complete=3]="complete"})(Xd||(Xd={}));Object(Zd.b)("EventResultState",Xd);Ck.Object.defineProperties(he.prototype,
{state:{configurable:!0,enumerable:!0,get:function(){return this._state},set:function(T){var pa={};dc.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",(pa.OldState=Xd[this._state],pa.NewState=Xd[T],pa),"ResultType",this.Z0e());this._state=T}}});Object(Zd.a)(he,"AEventResult",null,[916]);Wl(Id,he);Id.prototype.Z0e=function(){return"GetMoreInfo Result"};Ck.Object.defineProperties(Id.prototype,{NR:{configurable:!0,enumerable:!0,get:function(){return this.Bkb}},hoa:{configurable:!0,
enumerable:!0,get:function(){return this.tRc}},hbi:{configurable:!0,enumerable:!0,get:function(){return this.R7d}}});Object(Zd.a)(Id,"GetMoreInfoResult",he,[917,916]);var sa=b(80),ob=b(39),Wb=b(895),hc=b(389),pc=b(169),xd=b(738),Gd=b(637);$d.prototype.e6i=function(){this.M8a.fc(Qf.a.openUrlInNewTab,mg.a.frame,Object(of.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.M8a.fc(Qf.a.POa,mg.a.frame,Object(of.a)(this,this.POa,"openDocumentUrl"));Kc.AFrameworkApplication.pQ?this.slf():this.M8a.Ve(Qf.a.Y6b,
mg.a.frame,Object(of.a)(this,this.Y6b,"documentLoaded"),96)};$d.prototype.openUrlInNewTab=function(T,pa,hb,Db,rc){rc&&rc.MenuItemId&&(T={},dc.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",(T.Id=rc.SourceControlId,T.AppType=Gd.a[this.jca],T)),ob.a.mf(rc.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};$d.prototype.POa=function(T,pa,hb,Db,rc){if(rc&&rc.MenuItemId){var vb=Kc.AFrameworkApplication.fa.ra("WacInTabOpenMRUIsEnabledForUiHost"),Uc=Kc.AFrameworkApplication.fa.ra("UiHostSupportsDocRebootFeatures");
dc.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",vb,Uc);if(vb&&Uc){T={};dc.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",(T.Id=rc.SourceControlId,T.AppType=Gd.a[this.jca],T));rc=rc.MenuItemId.toString();var Td={};Td[hc.a.KPa]="1";Td[hc.a.documentUrl]=rc;Td[hc.a.reason]=xd.a.open;dc.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");Kc.AFrameworkApplication.wV().execute(function(mf){mf.Gj(pc.a.Xta,
Td)})}else this.openUrlInNewTab(T,pa,hb,Db,rc)}return 32};$d.prototype.Y6b=function(){this.slf();return 32};$d.prototype.$ba=function(T,pa,hb){hb=void 0===hb?"":hb;if(pa&&pa.fF){var Db=Wb.a[pa.status];pa=pa.fF.getTime();var rc=this.xw()-pa,vb={};dc.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",(vb.Caller=T,vb.RequestStatus=Db,vb.ElapsedMs=rc,vb.StartTime=pa,vb.Notes=hb,vb))}else hb={},dc.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",
(hb.Caller=T,hb))};$d.prototype.slf=function(){var T=Kc.AFrameworkApplication.fa.ra("QPGVCI"),pa=sa.a.gB(document.URL,"wdNewAndOpenCt",T);if(pa){pa=parseInt(pa);var hb=sa.a.gB(document.URL,"wdPreviousSession",T);T=sa.a.gB(document.URL,"wdPreviousCorrelation",T);var Db=Kc.AFrameworkApplication.fa.ra("NAOPLP");if(Kc.AFrameworkApplication.pQ){var rc=Kc.AFrameworkApplication.pQ.getTime();if(!pa||pa>rc)Db={},dc.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",
(Db.ClickTimestamp=pa,Db.DocumentLoadedTime=rc,Db.SessionId=hb,Db.Correlation=T,Db));else{var vb={};dc.ULS.sendTraceTag(5849683,202,Db?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",(vb.ClickToLoadTime=rc-pa,vb.ClickTimestamp=pa,vb.SessionId=hb,vb.Correlation=T,vb))}}else rc={},dc.ULS.sendTraceTag(5849681,202,Db?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",(rc.ClickTimestamp=pa,rc.SessionId=hb,
rc.Correlation=T,rc))}};$d.AM=function(){return new $d(new nd.a(function(){return Kc.AFrameworkApplication.Ib}),new nd.a(function(){return Kc.AFrameworkApplication.Jd}),new nd.a(function(){return Kc.AFrameworkApplication.sa}),new nd.a(function(){return Kc.AFrameworkApplication.sa.Qa.Sj}),new nd.a(function(){return Kc.AFrameworkApplication.Pi}),function(){return(new Date).getTime()},new nd.a(function(){return Kc.AFrameworkApplication.sa.Qa.jW}),new nd.a(function(){return Kc.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage}))};
Ck.Object.defineProperties($d.prototype,{M8a:{configurable:!0,enumerable:!0,get:function(){return this.La.value}},cDb:{configurable:!0,enumerable:!0,get:function(){return this.dh.value}},Jqf:{configurable:!0,enumerable:!0,get:function(){return this.Wjg.value}},jca:{configurable:!0,enumerable:!0,get:function(){return this.r1.value}},Hlc:{configurable:!0,enumerable:!0,get:function(){return this.ue.value}},xw:{configurable:!0,enumerable:!0,get:function(){return this.XIc}},jW:{configurable:!0,enumerable:!0,
get:function(){return this.Uog.value}},supportsGetMoreInfoForPersonalStorage:{configurable:!0,enumerable:!0,get:function(){return this.TWb.value}}});Ck.Object.defineProperties($d,{instance:{configurable:!0,enumerable:!0,get:function(){return $d.Ma||($d.Ma=$d.AM())}}});$d.Ma=null;Object(Zd.a)($d,"NewAndOpenCommonHelpers",null,[899]);var te=b(108);Ke.prototype.MHg=function(){this.HPc=this.Hbb+1};Ke.prototype.yKd=function(T){this.Vi&&(this.ue.Xp(this.Vi),this.Vi=null);T&&(this.HPc=0)};Ke.prototype.RCj=
function(T){var pa=this.YHj;0<=pa?(this.MHg(),this.yKd(!1),this.Vi=new te.a(4,1,pa,T,107),this.ue.Qg(this.Vi)):(this.yKd(!0),T={},dc.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",(T.Action=this.o4d,T)))};Ck.Object.defineProperties(Ke.prototype,{Hbb:{configurable:!0,enumerable:!0,get:function(){return this.HPc}},YHj:{configurable:!0,enumerable:!0,get:function(){return this.Hbb>=this.WWf.length?-1:this.WWf[this.Hbb]}},WWf:{configurable:!0,enumerable:!0,get:function(){if(!this.eWb){var T=(this.Xug.value||
"0").split(",");this.eWb=[];for(var pa=0;pa<T.length;pa++){var hb=parseInt(T[pa]);isNaN(hb)?(hb={},dc.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",(hb.Action=this.o4d,hb.Entry=T[pa],hb))):Array.add(this.eWb,hb)}}return this.eWb}}});Object(Zd.a)(Ke,"RetryHelper",null,[]);var Sd=b(41),If=b(29);Wl(Fe,Af);Fe.prototype.twi=function(){this.$ud("Document opened")};Fe.prototype.U6g=function(T){var pa=this;return function(){pa.$ud(T,!0)}};Fe.prototype.NAf=function(T,
pa){pa=void 0===pa?null:pa;var hb={};dc.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",(hb.Trigger=T,hb));3===this.No.state?(pa&&this.iKe(pa,this.No),pa={},dc.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",(pa.Trigger=T,pa))):this.$ud(T);return this.No};Fe.prototype.$ud=function(T,pa){this.clb.yKd(!(void 0===pa?0:pa));1===this.No.state?(pa={},dc.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",
(pa.Trigger=T,pa.RetryIndex=this.clb.Hbb,pa))):(pa={},dc.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",(pa.Trigger=T,pa.RetryIndex=this.clb.Hbb,pa)),this.No.state=1,pa=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.JCb.jW,Kc.AFrameworkApplication.nj),this.JCb.cDb.H9(pa,1,null,null,[Fe.Wce,Fe.Qge],!1,5,this.$5g(),this.Z5g(T),null))};Fe.prototype.$5g=function(){var T=this;return function(pa){var hb=!1,Db=!1,rc=!1;if(Kc.AFrameworkApplication.fa.ra("GetMoreInfoDataFromResponseBody"))if(pa.data.ke){var vb=
Sd.d(pa.data.ke);var Uc=vb.Wt;vb.returnValue?Uc?(rc=!0,T.No.tRc=Uc.StorageServiceDisplayName,T.No.Bkb=Fe.khf(Uc.PersonalFileStorageUrl)?Uc.PersonalFileStorageUrl:"",""===T.No.NR&&"SharePointOnlineConsumer"===Kc.AFrameworkApplication.fa.Va("FileSource")&&(T.No.Bkb=sa.a.gda(Kc.AFrameworkApplication.breadcrumbFolderUrl)),hb=""===T.No.NR&&""!==T.No.hoa):dc.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
dc.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else dc.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");rc||((Uc=pa.data.responseHeaders)?(T.No.tRc=(Uc[Fe.Qge]||"").toString(),hb=(Uc[Fe.Wce]||"").toString(),T.No.Bkb=Fe.khf(hb)?hb:"",""===T.No.NR&&"SharePointOnlineConsumer"===Kc.AFrameworkApplication.fa.Va("FileSource")?
(T.No.Bkb=sa.a.gda(Kc.AFrameworkApplication.breadcrumbFolderUrl),hb=""===T.No.NR&&""!==T.No.hoa):hb=""===hb&&""!==T.No.hoa):(dc.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),Db=!0));rc=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",T.clb.Hbb,Db,hb,rc);T.JCb.$ba("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",pa.data,rc);T.lXf(3,hb,Db)}};Fe.prototype.Z5g=function(T){var pa=this;return function(hb){pa.JCb.$ba("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",
hb.data,"Failure");pa.lXf(2);pa.clb.RCj(pa.U6g(T))}};Fe.prototype.lXf=function(T,pa,hb){this.No.state=T;this.No.R7d=void 0===pa?!1:pa;this.No.rKc=void 0===hb?!1:hb;this.s7c(this.No)};Fe.AM=function(){return new Fe(new nd.a(function(){return $d.instance}),new nd.a(function(){return Kc.AFrameworkApplication.bRh}))};Fe.khf=function(T){if(!T)return dc.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(If.a.Al(T).startsWith("https://"))return!0;dc.ULS.sendTraceTag(5849625,
202,10,"StorageUrl has invalid scheme.");return!1};Ck.Object.defineProperties(Fe.prototype,{JCb:{configurable:!0,enumerable:!0,get:function(){return this.Z1.value}}});Ck.Object.defineProperties(Fe,{instance:{configurable:!0,enumerable:!0,get:function(){return Fe.Ma||(Fe.Ma=Fe.AM())}}});Fe.Wce="PersonalFileStorageUrl";Fe.Qge="StorageServiceDisplayName";Fe.Ma=null;Object(Zd.a)(Fe,"GetMoreInfoActor",Af,[]);var pf=b(103),Ef=b(97);Cf.prototype.TTc=function(T){this.Za.addHandler(this.Cje,T)};Cf.prototype.mBg=
function(T){this.Za.addHandler(this.R8e,T)};Cf.prototype.JCj=function(){var T=new te.a(5,2,this.Apg,Object(of.a)(this,this.k7h,"inactiveLoop"),108);this.l7h.Qg(T)};Cf.prototype.k7h=function(){var T=this.JZe(),pa=this.xw()-T;if(pa>this.Tzc&&this.nT){var hb={};dc.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",(hb.TimeSinceLastActive=pa,hb));this.nT=!1;this.Za.raiseEvent(this.R8e)}T-this.Q9d>this.Tzc&&(this.nT=!0,this.Za.raiseEvent(this.Cje));this.Q9d=T};Cf.AM=function(){return new Cf(new nd.a(function(){return pf.a.instance}),
function(){return Kc.AFrameworkApplication.gjf.getTime()},function(){return(new Date).getTime()},new nd.a(function(){return Kc.AFrameworkApplication.Tzc}),!0)};Ck.Object.defineProperties(Cf.prototype,{l7h:{configurable:!0,enumerable:!0,get:function(){return this.ue.value}},JZe:{configurable:!0,enumerable:!0,get:function(){return this.vog}},xw:{configurable:!0,enumerable:!0,get:function(){return this.XIc}},Tzc:{configurable:!0,enumerable:!0,get:function(){return this.fXb.value}}});Ck.Object.defineProperties(Cf,
{instance:{configurable:!0,enumerable:!0,get:function(){return Cf.Ma||(Cf.Ma=Cf.AM())}}});Cf.Ma=null;Object(Zd.a)(Cf,"InactivityManager",null,[]);var pg=b(85),Ag=b(1113);Wl(qf,he);qf.prototype.Z0e=function(){return"MruActor Result"};Ck.Object.defineProperties(qf.prototype,{qwd:{configurable:!0,enumerable:!0,get:function(){return this.Yae}},Xpf:{configurable:!0,enumerable:!0,get:function(){return this.Zae}},pwd:{configurable:!0,enumerable:!0,get:function(){return this.Xae}},cIj:{configurable:!0,enumerable:!0,
get:function(){return this.Ihe}}});Object(Zd.a)(qf,"MruResult",he,[915,916]);var Nf=b(246);lf.prototype.iji=function(T,pa){return T===Nf.a.Wad||20===pa||18===pa||3===pa};lf.prototype.rki=function(T){return 3===T||5===T||6===T||7===T||9===T||10===T||11===T||12===T||13===T||14===T||15===T||16===T||23===T||26===T||27===T||28===T};lf.prototype.reset=function(){this.ayb=this.retryCount=0;this.POc=this.UAb=null;this.task&&(this.taskManager.Xp(this.task),this.task=null)};lf.prototype.jai=function(T,pa,hb,
Db){this.POc=String.format("{0}_{1}",hb,Db);if(this.retryCount>=this.Xxi)return dc.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.iji(hb,Db))return dc.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.rki(Db)&&1<=this.ayb)return this.UAb=hb,!1;pa=Math.max(pa,this.zec*Math.pow(2,this.ayb));if(26===Db)pa=Math.max(pa,3E4);else if(27===Db||28===Db)pa=Math.max(pa,6E4);9===Db||412===hb&&(null==this.UAb||412!==this.UAb)?pa=500:this.ayb+=1;this.UAb=
hb;this.retryCount+=1;this.task&&this.taskManager.Xp(this.task);dc.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",pa);this.task=new te.a(2,1,pa,T,107);this.taskManager.Qg(this.task);return!0};Ck.Object.defineProperties(lf.prototype,{xqc:{configurable:!0,enumerable:!0,get:function(){return this.POc}}});Object(Zd.a)(lf,"RetryManager",null,[]);var Lg=b(98),Mg=b(136);Object(Zd.a)(wb,"WriteOptions",null,[]);var Hg=b(617),nh=b(190);Wl(Dd,Af);Dd.prototype.R7i=function(){this.Nw.M8a.fc(Qf.a.renameMostRecentlyUsedFileEntry,
mg.a.frame,Object(of.a)(this,this.Kbj,"renameMruEntry"))};Dd.prototype.Kbj=function(){return this.i_d("Rename")};Dd.prototype.Ewi=function(){this.$nf("File Opened")};Dd.prototype.Fwi=function(){this.$nf("IntervalUpdate")};Dd.prototype.$nf=function(T){var pa={};dc.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",(pa.Trigger=T,pa));this.i_d(T)};Dd.prototype.u4=function(T){(T=If.a.u4(T))&&T.startsWith(".")&&(T=T.substring(1,T.length));return T};Dd.prototype.$Ve=function(){switch(this.Nw.jca){case 3:return"Word";
case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}};Dd.prototype.gZh=function(T){var pa=this.rog();if(!pa)return null;var hb=new wb;hb.documentUrl=this.m5d.value?encodeURI(pa):pa;hb.mruItemId=this.oUb;hb.app=this.$Ve();if(pa=this.Rv())hb.folderName=pa.breadcrumbFolderName,pa=pa.dn,hb.documentName=If.a.Gq(pa),hb.documentExt=this.u4(pa);T&&(hb.documentName?hb.documentName.length?255<=hb.documentName.length?T.set("DocumentNameLength","Long"):
2084<=hb.documentName.length&&T.set("DocumentNameLength","VeryLong"):T.set("DocumentNameLength","0"):T.set("DocumentNameLength","Null"));return JSON.stringify(hb)};Dd.prototype.i_d=function(T,pa){pa=void 0===pa?!1:pa;if(4===this.Nw.jca&&!Kc.AFrameworkApplication.Wta)return 2;var hb=Mg.a.Rr();hb&&(hb.set("Trigger",T),hb.set("IsRetry",pa?"true":"false"),hb.set("MruIdSent",this.oUb?"true":"false"),hb.set("URLEncoded",this.m5d.value?"true":"false"));Lg.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",
hb);T=this.gZh(hb);if(!T)return pa=!Kc.AFrameworkApplication.webEditingEnabled,hb&&(hb.set("WebEditingIsEnabled",Kc.AFrameworkApplication.webEditingEnabled?"true":"false"),hb.set("ProtectedFile",Kc.AFrameworkApplication.Iqc?"true":"false")),Lg.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",pa,!1,Object.assign(new nh.a,{extendedProperties:hb})),2;this.Ira&&!pa&&this.Ira.reset();hb=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.Nw.jW,this.localeName);this.Xie?this.gDc["X-FileId"]=
Kc.AFrameworkApplication.nj:hb+=String.format("&{0}",Kc.AFrameworkApplication.nj);Kc.AFrameworkApplication.dc&&(this.gDc["X-Office-AudienceGroup"]=Object(pg.a)(String,Kc.AFrameworkApplication.dc.AudienceGroup)||"");this.gDc["X-Timeout"]=15E3;return this.Nw.cDb.gm(hb,2,T,this.gDc,!0,5,Object(of.a)(this,this.cWj,"writeMruV2EntryOnServerSuccessCallback"),Object(of.a)(this,this.B$g,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")};Dd.prototype.cWj=function(T){this.Z4e(T.data)};
Dd.prototype.Z4e=function(T){var pa=Mg.a.Rr();this.Ira&&(pa&&this.Ira.xqc&&(pa.set("LastError",this.Ira.xqc),pa.set("NumRetries",this.Ira.retryCount.toString())),this.Ira.reset());var hb=Ag.c(T.ke);hb&&hb.diagnostics_data&&(this.oUb=hb.diagnostics_data.mru_id);T=+T.q3-+T.fF;pa&&pa.set("RequestDuration",T.toString());Lg.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new nh.a,{extendedProperties:pa}))};Dd.prototype.B$g=function(T){if(T.data.httpStatus===Nf.a.rrb)this.Z4e(T.data);else{var pa=
T.data.httpStatus===Nf.a.gGb,hb=Mg.a.Rr();this.l5e(this.Ira,T,this.q$g(),hb);hb&&(hb.set("StatusCode",T.data.httpStatus.toString()),pa||this.bUc(T.data,hb));Lg.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",T.data.httpStatus),pa,!1,Object.assign(new nh.a,{extendedProperties:hb}))}};Dd.prototype.q$g=function(){var T=this;return function(){T.i_d("Retry",!0)}};Dd.prototype.iRh=function(){this.n8a("Polling")};Dd.prototype.hRh=function(){this.n8a("Retry",!0)};Dd.prototype.xwi=
function(){this.n8a("Open")};Dd.prototype.wwi=function(){this.n8a("Activity")};Dd.prototype.vwi=function(){this.n8a("OpenRecentLinks",!1,!0)};Dd.prototype.uwi=function(){this.n8a("ActivityRecentLinks",!1,!0)};Dd.prototype.n8a=function(T,pa,hb){pa=void 0===pa?!1:pa;hb=void 0===hb?!1:hb;var Db={};dc.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",(Db.Trigger=T,Db));if(Db=Mg.a.Rr())Db.set("Trigger",T),Db.set("IsRetry",pa?"true":"false"),hb&&Db.set("RecentLinks","true");Lg.Health.instance.recordKpiUsage("GetMru",
0,"smartfio",Db);this.dra&&!pa&&this.dra.reset();hb?this.gDe(Object(of.a)(this,this.jRh,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(of.a)(this,this.fRh,"getMruForRecentLinksFromServerFailureCallback"),!0):this.gDe(Object(of.a)(this,this.kRh,"getMruV2FromServerSuccessCallback"),Object(of.a)(this,this.gRh,"getMruFromServerFailureCallback"))};Dd.prototype.bUc=function(T,pa){T&&T.responseHeaders&&(T=T.responseHeaders["X-CorrelationId"])&&pa.set("ServerCorrelationId",T)};Dd.prototype.pti=
function(T,pa){T&&(pa&&pa.set("RequestDuration",(+T.q3-+T.fF).toString()),Lg.Health.instance.recordKpiSuccess("GetMru",Object.assign(new nh.a,{extendedProperties:pa})))};Dd.prototype.kRh=function(T){this.l_e(T)};Dd.prototype.l_e=function(T,pa){pa=void 0===pa?!1:pa;var hb="",Db=null,rc=null,vb=null,Uc=Ag.c(T.data.ke);Uc&&(Db=Uc.places?Uc.places.items:[],rc=Uc.documents?Uc.documents.items:[],(vb=Ag.a(Uc,pa))&&(hb=Sd.c(vb)));Kc.AFrameworkApplication.sa&&Kc.AFrameworkApplication.sa.Qa.j_&&Fd.c()&&!pa&&
appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(hb,!0));hb=Mg.a.Rr();this.dra&&(hb&&this.dra.xqc&&(hb.set("LastError",this.dra.xqc),hb.set("NumRetries",this.dra.retryCount.toString())),this.dra.reset());pa&&hb&&hb.set("RecentLinks","true");vb||Db||rc?(pa?this.Nw.$ba("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",T.data,"Success"):this.Nw.$ba("MruActor.GetMruV2FromServerSuccessCallback",T.data,"Success"),this.KBc(3,vb,Db,rc),this.pti(T.data,hb)):(pa?this.Nw.$ba("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",
T.data,"Failure: Invalid JSON"):this.Nw.$ba("MruActor.GetMruV2FromServerSuccessCallback",T.data,"Failure: Invalid JSON"),hb&&this.bUc(T.data,hb),Lg.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new nh.a,{extendedProperties:hb})),this.KBc(3,null,null,null,!0));this.s7c(this.qT)};Dd.prototype.jRh=function(T){this.l_e(T,!0)};Dd.prototype.l5e=function(T,pa,hb,Db){var rc=0,vb=0,Uc=Ag.c(pa.data.ke);Uc&&(null!=Uc.response_code&&(rc=Uc.response_code,Db&&Db.set("MruResponseCode",
rc.toString()),9===rc&&(this.oUb="")),Uc.error_data&&null!=Uc.error_data.retry_after_ms&&(vb=Uc.error_data.retry_after_ms,Db&&Db.set("ExpectedRetryAfter",vb.toString())));T&&(pa=T.jai(hb,vb,pa.data.httpStatus,rc),Db&&(Db.set("CurrentRetryCount",T.retryCount.toString()),Db.set("RetryScheduled",pa?"true":"false")))};Dd.prototype.gRh=function(T){this.k_e(T)};Dd.prototype.k_e=function(T,pa){pa=void 0===pa?!1:pa;var hb=T.data.httpStatus===Nf.a.gGb,Db=Mg.a.Rr();Db&&(Db.set("StatusCode",T.data.httpStatus.toString()),
pa&&Db.set("RecentLinks","true"),hb||this.bUc(T.data,Db));pa?this.Nw.$ba("MruActor.GetMruForRecentLinksFromServerFailureCallback",T.data,"Failure"):this.Nw.$ba("MruActor.GetMruFromServerFailureCallback",T.data,"Failure");this.KBc(2);this.l5e(this.dra,T,Object(of.a)(this,this.hRh,"getMruFromServerRetryTask"),Db);Lg.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",T.data.httpStatus),hb,!1,Object.assign(new nh.a,{extendedProperties:Db}));this.s7c(this.qT);Kc.AFrameworkApplication.sa&&
Kc.AFrameworkApplication.sa.Qa.j_&&Fd.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),pa||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))};Dd.prototype.fRh=function(T){this.k_e(T,!0)};Dd.prototype.KBc=function(T,pa,hb,Db,rc){if(3!==this.qT.state||3===T)this.qT.Yae=void 0===pa?null:pa,this.qT.Zae=void 0===hb?null:hb,this.qT.Xae=void 0===Db?null:Db,this.qT.state=T,this.qT.rKc=void 0===rc?!1:rc,this.qT.Ihe=this.Nw.xw()};Dd.prototype.NAf=function(T,pa){var hb=
{};dc.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",(hb.Trigger=T,hb.ResultState=this.qT.state,hb));pa&&3===this.qT.state&&this.iKe(pa,this.qT);return this.qT};Dd.prototype.gDe=function(T,pa,hb){hb=void 0===hb?!1:hb;this.KBc(1);var Db={};var rc=hb?String.format(this.Nw.jW+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.Stg,"OfficeSuite",this.localeName,"ClassicMru"):String.format(this.Nw.jW+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.$Ve(),
this.localeName);this.Rtg.value||(rc+="&entity=docs");Kc.AFrameworkApplication.dc&&(Db["X-Office-AudienceGroup"]=Object(pg.a)(String,Kc.AFrameworkApplication.dc.AudienceGroup)||"");hb&&(Db["X-Office-Application"]="147");this.Xie?Db["X-FileId"]=Kc.AFrameworkApplication.nj:rc+=String.format("&{0}",Kc.AFrameworkApplication.nj);this.Nw.cDb.gm(rc,1,null,Db,!0,5,T,pa,null)};Dd.AM=function(){return new Dd(new nd.a(function(){return $d.instance}),new nd.a(function(){return Hg.a.kH(Kc.AFrameworkApplication.lcid).name}),
new nd.a(function(){return Kc.AFrameworkApplication.sa.Qa.lv}),Kc.AFrameworkApplication.fa.ra("MruWriteFileIdInHeader"),function(){return Kc.AFrameworkApplication.sa.Qa.Gx},function(){return Kc.AFrameworkApplication.jm},new nd.a(function(){return Kc.AFrameworkApplication.fa.ra("OICEncodeUrlIsEnabled")}))};Ck.Object.defineProperties(Dd.prototype,{gDc:{configurable:!0,enumerable:!0,get:function(){return this.hyg}},Nw:{configurable:!0,enumerable:!0,get:function(){return this.Z1.value}},localeName:{configurable:!0,
enumerable:!0,get:function(){return this.xrg.value}}});Ck.Object.defineProperties(Dd,{instance:{configurable:!0,enumerable:!0,get:function(){return Dd.Ma||(Dd.Ma=Dd.AM())}}});Dd.Ma=null;Object(Zd.a)(Dd,"MruActor",Af,[]);rd.prototype.fi=function(T){this.tb=T;T.register(899,"Common.INewAndOpenCommonHelpers").Hc().Oc(function(){return $d.instance});T.register(900,"Common.IEventEmitter<Common.IGetMoreInfoResult>").Hc().Oc(function(){return Fe.instance});T.register(900,"Common.IEventEmitter<Common.IMruResult>").Hc().Oc(function(){return Dd.instance})};
rd.prototype.init=function(){var T=this;Kc.AFrameworkApplication.fa.hv(function(){T.Lxb()})};rd.prototype.Lxb=function(){this.tb.resolve("Common.INewAndOpenCommonHelpers");this.tb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.tb.resolve("Common.IEventEmitter<Common.IMruResult>");var T=!1;$d.instance.e6i();Kc.AFrameworkApplication.Ela&&(T=!0);Kc.AFrameworkApplication.dLf&&(Dd.instance.xwi(),Kc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",
!1)&&Dd.instance.vwi(),0<Kc.AFrameworkApplication.Ypf&&this.Vke(),this.Qsj(),T=!0);Kc.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&T&&Fe.instance.twi();Kc.AFrameworkApplication.sQj&&(T=Dd.instance,T.R7i(),T.Ewi(),pf.a.instance.Qg(this.tQj))};rd.prototype.Qsj=function(){Cf.instance.TTc(Object(of.a)(Dd.instance,Dd.instance.wwi,"makeGetMruRequestActivityTrigger"));Kc.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&Cf.instance.TTc(Object(of.a)(Dd.instance,
Dd.instance.uwi,"makeGetMruForRecentLinksRequestActivityTrigger"));Cf.instance.TTc(Object(of.a)(this,this.Vke,"addGetMruFromServerTask"));Cf.instance.mBg(Object(of.a)(this,this.Dch,"deleteGetMruFromServerTask"))};rd.prototype.Dch=function(){pf.a.instance.Xp(this.Zpf)};rd.prototype.Vke=function(){pf.a.instance.Qg(this.Zpf)};rd.prototype.dispose=function(){this.Cm||(this.Cm=!0,this.amb&&(pf.a.instance.Xp(this.amb),this.amb=null))};Ck.Object.defineProperties(rd.prototype,{name:{configurable:!0,enumerable:!0,
get:function(){return"Common.App.NewAndOpen.Core"}},Zpf:{configurable:!0,enumerable:!0,get:function(){return this.Ude||(this.Ude=new te.a(5,2,Kc.AFrameworkApplication.Ypf,Object(of.a)(Dd.instance,Dd.instance.iRh,"getMruFromServerTask"),109))}},tQj:{configurable:!0,enumerable:!0,get:function(){return this.amb||(this.amb=new te.a(2,2,6E4*Kc.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(of.a)(Dd.instance,Dd.instance.Fwi,"makeUpdateMruTask"),
197))}}});Object(Zd.a)(rd,"CorePackageManager",null,[4,5,3]);var Ae=b(555);new Ge(0,0,0,0,0,0);new Ge(1,1,0,0,0,0);new Ge(2,2,0,0,0,0);new Ge(3,3,0,0,0,1);new Ge(4,3,1,0,1,1);new Ge(5,3,0,0,.42,1);new Ge(6,3,.83,0,1,1);new Ge(7,3,0,0,.58,1);new Ge(8,3,.42,0,.58,1);new Ge(9,3,.1,.25,.75,.9);new Ge(10,3,.1,.9,.2,1);new Ge(11,3,.1,.9,.2,1);new Ge(12,3,.9,.1,.2,1);new Ge(13,3,.4,0,0,1);new Ge(14,3,.13,.21,.1,.7);new Ge(15,3,.02,.33,.38,.77);new Ge(16,3,.57,.17,.95,.75);new Ge(17,3,0,.19,.07,.72);new Ge(18,
3,0,0,.95,.37);new Ge(19,3,.66,0,.34,1);new Ge(20,3,.8,0,.2,1);new Ge(21,3,.8,0,.2,1);Ze.prototype={type:0,startTime:new kf(0,null),endTime:new kf(0,null),$Zj:new kf(0,null),AYj:new kf(0,null),operationType:0};new je(0,[new Ze(5,0,0,0,null,1,1,0)]);new je(1,[new Ze(5,2,0,0,null,0,2,0),new Ze(5,2,0,50,null,1,1,0)]);new je(2,[new Ze(1,3,0,167,null,0,1,1),new Ze(2,3,0,167,null,0,1,1)]);new je(3,[new Ze(3,3,0,167,null,0,1,1),new Ze(4,3,0,167,null,0,1,1)]);new je(4,[new Ze(5,2,0,0,null,0,2,0),new Ze(5,
2,0,167,null,1,1,0)]);new je(5,[new Ze(5,2,0,167,null,0,1,0)]);new je(6,[new Ze(1,3,0,100,null,0,1,1),new Ze(2,3,0,100,null,0,1,1)]);new je(7,[new Ze(3,3,0,100,null,0,1,1),new Ze(4,3,0,100,null,0,1,1)]);new je(8,[new Ze(5,2,0,100,null,1,1,0)]);new je(9,[new Ze(5,2,0,0,null,0,2,0),new Ze(5,2,0,100,null,1,1,0)]);new je(10,[new Ze(5,2,0,100,null,0,1,0)]);new je(11,[new Ze(1,3,0,267,null,0,1,1),new Ze(2,3,0,267,null,0,1,1)]);new je(12,[new Ze(3,3,0,267,null,0,1,1),new Ze(4,3,0,267,null,0,1,1)]);new je(13,
[new Ze(5,2,0,267,null,1,1,0)]);new je(14,[new Ze(5,2,0,0,null,0,2,0),new Ze(5,2,0,267,null,1,1,0)]);new je(15,[new Ze(5,2,0,267,null,0,1,0)]);new je(16,[new Ze(6,3,0,267,null,0,1,1),new Ze(7,3,0,267,null,0,1,1)]);new je(17,[new Ze(1,3,0,750,null,0,1,1),new Ze(2,3,0,750,null,0,1,1)]);new je(18,[new Ze(3,3,0,750,null,0,1,1),new Ze(4,3,0,750,null,0,1,1)]);new je(19,[new Ze(5,2,0,750,null,1,1,0)]);new je(20,[new Ze(5,2,0,0,null,0,2,0),new Ze(5,2,0,750,null,1,1,0)]);new je(21,[new Ze(6,3,0,1E3,null,0,
1,1),new Ze(7,3,0,1E3,null,0,1,1)]);new je(22,[new Ze(1,3,0,367,null,0,1,1),new Ze(2,3,0,367,null,0,1,1)]);new je(23,[new Ze(3,3,0,367,null,0,1,1),new Ze(4,3,0,367,null,0,1,1)]);new je(24,[new Ze(5,2,0,367,null,1,1,0)]);new je(25,[new Ze(5,2,0,0,null,0,2,0),new Ze(5,2,0,367,null,1,1,0)]);new je(26,[new Ze(5,2,0,367,null,0,1,0)]);new je(27,[new Ze(5,2,0,0,null,1,1,0),new Ze(5,2,0,50,null,0,1,0)]);new je(28,[new Ze(1,3,0,433,null,0,1,1),new Ze(2,3,0,433,null,0,1,1)]);new je(29,[new Ze(5,2,0,0,null,
0,2,0),new Ze(5,2,0,50,null,1,1,0),new Ze(2,3,0,0,null,40,1,1),new Ze(2,3,0,100,null,0,1,1)]);new je(30,[new Ze(2,0,0,0,null,32,1,1),new Ze(2,0,0,100,null,32,1,1),new Ze(2,3,101,350,null,0,1,1),new Ze(3,0,0,0,null,0,2,1),new Ze(3,0,0,100,null,0,2,1),new Ze(3,3,101,350,null,0,1,1),new Ze(5,0,0,0,null,0,2,0),new Ze(5,0,0,100,null,1,1,0)]);new je(31,[new Ze(2,3,0,267,null,32,1,1),new Ze(3,3,0,267,null,0,2,1),new Ze(5,2,0,0,null,1,0,0),new Ze(5,2,0,267,null,0,2,0)]);new je(32,[new Ze(5,2,0,0,null,0,2,
0),new Ze(5,2,0,100,null,0,2,0),new Ze(5,2,101,267,null,1,1,0)]);new je(33,[new Ze(1,10,0,300,null,0,1,1),new Ze(2,10,0,300,null,0,1,1)]);new je(34,[new Ze(3,10,0,300,null,0,1,1),new Ze(4,10,0,300,null,0,1,1)]);new je(35,[new Ze(1,8,0,750,null,0,1,1),new Ze(2,8,0,750,null,0,1,1)]);new je(36,[new Ze(5,2,0,0,null,0,2,0),new Ze(5,2,0,200,null,0,2,0),new Ze(5,3,201,500,null,1,1,0)]);new je(37,[new Ze(1,2,0,0,null,0,2,1),new Ze(2,2,0,0,null,0,2,1),new Ze(1,2,0,200,null,0,2,1),new Ze(2,2,0,200,null,0,2,
1),new Ze(1,3,201,267,null,0,1,1),new Ze(2,3,201,267,null,0,1,1)]);new je(38,[new Ze(1,3,0,267,null,0,1,1),new Ze(2,3,0,267,null,0,1,1)]);new je(39,[new Ze(5,2,0,0,null,0,2,0),new Ze(5,2,0,267,null,1,1,0)]);new je(40,[new Ze(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||
function(T){window.setTimeout(T,16)}}();dg.prototype={Pe:null,SIg:5,Fnb:null,cWc:0,startTime:null,duration:null,u7b:null,xXc:-1,Yvd:-1,vvd:-1};dg.prototype.Start=function(){this.startTime=new Date;this.u7b={}};dg.prototype.GetRecentAnimationStats=function(){var T,pa=[],hb=0;for(T=Dg.cWc;T<Dg.SIg;T++)null!=Dg.Fnb[T]&&(pa[hb]=Dg.Fnb[T],hb++);for(T=0;T<Dg.cWc;T++)null!=Dg.Fnb[T]&&(pa[hb]=Dg.Fnb[T],hb++);return pa};dg.prototype.GetAnimationSqmStats=function(){var T=[];return T[0]=0>Dg.xXc?0:Dg.xXc,T[1]=
0>Dg.Yvd?0:Dg.Yvd,T[2]=0>Dg.vvd?0:Dg.vvd,T};var Dg=new dg;var Jf=b(229),fg=b(256),Jg=b(739),Og=b(90),ef=b(88),ng=b(272),Xb=b(167),da=b(75),Aa=b(392),qb=b(51),jc=b(37),id=b(95),Gc=b(72),Rd=b(635),Ce=ef.a;Wl(Ec,Ce);Ec.prototype.dispose=function(){this.$&&ng.a(this.$).hbj(this.Yxf);this.xb=null;Array.clear(this.Y8);Ce.prototype.dispose.call(this)};Ec.prototype.E_i=function(T){this.ema(T)};Ec.prototype.Qpf=function(T,pa,hb,Db){Db=void 0===Db?null:Db;var rc=this.fFj(T,pa,void 0===hb?!0:hb,Db);if(!rc){hb=
pa;var vb=T?1:-1,Uc=this.Erd;do{rc=!1;if(da.a(this.$.ya,27)){if(hb+=vb,hb>=Uc.length||0>hb)rc=!0}else hb=(hb+vb+Uc.length)%Uc.length;if(rc){this.svi(T,pa,Db);break}else if(rc=this.eFj(T,pa,hb,Db))break}while(hb!==pa)}};Ec.prototype.fFj=function(T,pa,hb,Db){Db=void 0===Db?null:Db;var rc=null;0<=pa&&(rc=this.Y8[pa]);return(null===rc||void 0===rc?0:rc.canReceiveFocus)&&rc.eg(T,void 0===hb?!0:hb)?(Db&&Gc.g(Db),dc.ULS.sendTraceTag(537166669,0,50,"Switched focus inside current section {0} into a sub region",
rc.xe),rc.Aj(),!0):!1};Ec.prototype.eFj=function(T,pa,hb,Db){Db=void 0===Db?null:Db;hb=this.Y8[hb];if((null===hb||void 0===hb?0:hb.canReceiveFocus)&&hb.eg(T,!1)){Db&&Gc.g(Db);hb.Aj();if(T=this.Y8[pa])T.Qj(),dc.ULS.sendTraceTag(537166668,0,50,"Switched focus from section {0} to {1}",T.xe,hb.xe);return!0}return!1};Ec.prototype.svi=function(T,pa,hb){(hb=void 0===hb?null:hb)&&Gc.g(hb);if(pa=this.Y8[pa])pa.Qj(),dc.ULS.sendTraceTag(537166666,0,50,"Lost focus from section {0}",pa.xe);jc.TaskExtensions.Ba(qb.GetServiceTaskFactory.Xa(this.$.da,
21,137,0),function(Db){var rc={};Db.result.Gj(pc.a.lmb,(rc[hc.a.direction]=T?"forward":"backward",rc))},this.$.la)};Ec.prototype.ema=function(T){var pa=this.$.isEditMode?Xb.a(this.$):null;if(!this.$.Ab.Nwa||Ec.Ahi(pa))if(117===T.keyCode&&(T.ctrlKey||Gc.b(T))){pa=this.AVh(T.target);var hb=!T.shiftKey;dc.ULS.sendTraceTag(537166662,0,50,"AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: {0}",pa);Kc.AFrameworkApplication.sa.Qa.Bz&&this.$.Nka&&1===pa&&1===this.$.Rxc&&Jg.ShyRibbon.QP(1,
0);this.Qpf(hb,pa,!0,T)}else 117!==T.keyCode||Ec.nRe?-411645385===this.$.shortcutKeyManager.au(T)?this.tdf()&&(pa={},this.$.Ka.Wb(new id.a(-411645385,1,this.$.Xc,6,null),(pa.event=T,pa),T),T.stopPropagation()):1588554917===this.$.shortcutKeyManager.au(T)?0===this.mode?(Rd.a(this.$)||(pa={},this.$.Ka.Wb(new id.a(1588554917,1,this.$.Xc,6,null),(pa.event=T,pa),T)),T.preventDefault(),T.stopPropagation()):3===this.mode&&(T.preventDefault(),T.stopPropagation()):this.i1h(T):(T=Aa.a.Sy.notificationBar.M$(Og.a.SMh(),
!1),T.image=0,Aa.a.Sy.notificationBar.cE(T),Ec.nRe=!0)};Ec.prototype.AVh=function(T){for(var pa=this.Erd,hb=0,Db=pa.length;hb<Db;++hb){var rc=pa[hb];if(rc&&rc.ph(T))return hb}return-1};Ec.prototype.GZe=function(){for(var T=[],pa=0,hb=this.mxa.length;pa<hb;pa++){var Db=ng.a(this.$).IM(this.mxa[pa]);Db&&T.push(Db)}return T};Ec.prototype.tdf=function(){return 0===this.mode||4===this.mode};Ec.Ahi=function(T){return T?T.inKeytipMode:!1};Ck.Object.defineProperties(Ec.prototype,{$:{configurable:!0,enumerable:!0,
get:function(){return this.xb}},Erd:{configurable:!0,enumerable:!0,get:function(){this.Y8.length||(this.Y8=this.GZe());return this.Y8}},mxa:{configurable:!0,enumerable:!0,get:function(){return this.L9d},set:function(T){this.L9d=T;this.Y8=this.GZe()}}});Ec.nRe=!1;Object(Zd.a)(Ec,"AccessibilityManager",ef.a,[912,3]);var Re=b(154),Pf=b(21),Le=b(14);Wl(pe,Ec);pe.prototype.ema=function(T){this.$.Qd&65536&&Ec.prototype.ema.call(this,T)};pe.prototype.i1h=function(T){if(Pf.a.equals(this.Coj,this.$.shortcutKeyManager.fed(T),
!1)){var pa=Re.b(this.$);if(null===pa||void 0===pa?0:pa.canReceiveFocus)Gc.g(T),pa.eg(!0,!1)}};Ck.Object.defineProperties(pe.prototype,{mode:{configurable:!0,enumerable:!0,get:function(){return this.WB},set:function(T){this.WB=T;switch(T){case 0:this.mxa=this.XMg;break;case 2:this.mxa=this.bUj;break;case 3:this.mxa=this.e_i;break;case 4:this.mxa=this.WUg;break;case 5:this.mxa=this.GZi;break;case 6:this.mxa=this.QZi;break;default:dc.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}}});
Object(Zd.a)(pe,"EwaAccessibilityManager",Ec,[]);var kg=Jf.a;Wl(Nd,kg);Nd.prototype.create=function(){this.Eb(this.$.da.za(15)||new pe(this.$))};Nd.ka=function(T){T.da.Ga(157,new Nd(T))};Object(Zd.a)(Nd,"AccessibilityManagerFactory",Jf.a,[]);var vg=b(11),gg=b(148),Bc=b(693),od=Bc.a;Wl(ed,od);ed.prototype.dispose=function(){gg.WacAirSpace.kmd()&&gg.WacAirSpace.Yzc()};ed.prototype.animate=function(T,pa,hb,Db,rc){pa&&gg.WacAirSpace.$K(T.element,pa);gg.WacAirSpace.animate(T,Db,rc);hb&&gg.WacAirSpace.m8i(T.element,
hb)};Object(Zd.a)(ed,"AnimationManager",Bc.a,[3]);var td=b(101),le=b(202),Ve=b(1016),Pe=b(563),yf=b(84),Cg=b(77),hg=Cg.a;Wl(wc,hg);wc.prototype.Tfj=function(){var T=new le.a,pa=Pe.a.ar(yf.a.instance.kc("Common.IEventEmitter<Common.IMruResult>")),hb=new nd.a(function(){return pa.result});this.ysd=new nd.a(function(){return new Ve.a(hb.value,null)});if(!this.ysd)return T;var Db=this.ysd.value.rz("NewAndOpenCoreManager",!1);if(!Db||3!==Db.state||!Db.pwd)return Db?dc.ULS.sendTraceTag(544289226,0,50,"NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: {0}, mruResult MruDocuments is null: {1}",
Db.state,!Db.pwd):dc.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;Db=Db.pwd;for(var rc=["xlsx","xlsb","xlsm"],vb=0;vb<Db.length;vb++){var Uc=Db[vb];if(!(0>Array.indexOf(rc,Uc.extension))){var Td=String.format("{0}.{1}",Uc.title,Uc.extension),mf=Ag.b(Uc,Kc.AFrameworkApplication.isRtl);Uc=Uc.url;if(Td&&mf&&Uc){var bg={};T.add((bg[wc.fileName]=Td,bg[wc.friendlyPath]=mf,bg[wc.section]="mru",bg[wc.absoluteUrl]=Uc,bg))}else Uc||dc.ULS.sendTraceTag(537155200,
0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}}return T};wc.prototype.dispose=function(){hg.prototype.dispose.call(this)};wc.fileName="FileName";wc.friendlyPath="FriendlyPath";wc.section="Section";wc.absoluteUrl="AbsoluteUrl";Object(Zd.a)(wc,"NewAndOpenCoreManager",Cg.a,[894,3]);var Lf=Jf.a;Wl(md,Lf);md.prototype.create=function(){this.Eb(this.$.da.za(451)||this.$.da.Ga(451,new wc(this.$)))};md.ka=function(T){T.da.Ga(164,new md(T))};Object(Zd.a)(md,"NewAndOpenCoreFactory",
Jf.a,[]);var $e=b(1),lg=b(31),ae=b(5),se=b(12),Wh=b(250),zf=b(22);Mc.T2a=function(T){T=If.a.vg(T||"");return new Mc(T)};Mc.u$b=function(T){return Mc.T2a(Le.a.instance.ga(T))};Mc.wbd=function(T){return new Mc(Le.a.instance.Wa(T))};Mc.pDh=function(T,pa){for(var hb=[],Db=1;Db<arguments.length;++Db)hb[Db-1]=arguments[Db];return Mc.oDh.apply(null,[Le.a.instance.Bb(T)].concat(hb))};Mc.oDh=function(T,pa){for(var hb=[],Db=1;Db<arguments.length;++Db)hb[Db-1]=arguments[Db];Db=hb.length;for(var rc=Array(Db),
vb=0;vb<Db;vb++)rc[vb]=(hb[vb]||Mc.nKe).ruc;return new Mc(String.format.apply(null,[T].concat(rc)))};Ck.Object.defineProperties(Mc,{nKe:{configurable:!0,enumerable:!0,get:function(){return Mc.j5d||(Mc.j5d=new Mc(""))}},hud:{configurable:!0,enumerable:!0,get:function(){return Mc.fae||(Mc.fae=Mc.wbd(2).ruc)}}});Mc.j5d=null;Mc.fae=null;Object(Zd.a)(Mc,"SafeHtml",null,[913]);Cd.prototype.dispose=function(){this.$&&this.unregister();se.DOMElementExtensions.zf(this.lha);se.DOMElementExtensions.zf(this.Wea);
se.DOMElementExtensions.zf(this.iga);this.iga=this.Wea=this.lha=this.$=null};Cd.prototype.setEnabled=function(T){this.fYf(this.iga,T)};Cd.prototype.$nj=function(){this.fYf(this.Wea,!0)};Cd.prototype.readText=function(T){this.XGb(Mc.T2a(T),!0)};Cd.prototype.GPa=function(T){this.XGb(Mc.T2a(T),!1)};Cd.prototype.eLf=function(T,pa){if(1>pa||!T)dc.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var hb=new Sys.StringBuilder;T=String.format(Le.a.instance.Bb(34),pa,T);Sb(hb,T);
Sb(hb,Le.a.instance.ga(854));this.XGb(Mc.T2a(hb.toString()),!1)}};Cd.prototype.a4i=function(T,pa,hb){if(1>hb||1>pa||pa>hb||!T)dc.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var Db=new Sys.StringBuilder;Sb(Db,T);Db.append(String.format(Le.a.instance.Bb(55),pa,hb));this.XGb(Mc.T2a(Db.toString()),!1)}};Cd.prototype.bLf=function(T){T=this.XUh(T);this.XGb(T,!1)};Cd.prototype.XGb=function(T,pa){if(T=T?T.ruc:null)pa=pa?this.iga:this.Wea,Pf.a.equals(pa.innerHTML,T,!1)&&(T+=Mc.hud),
pa.innerHTML=T};Cd.prototype.sab=function(T,pa){this.lha.getAttribute(ae.a.nsa)!==pa&&this.lha.setAttribute(ae.a.nsa,pa);T=T?Mc.T2a(T).ruc:"";this.lha.innerHTML=T};Cd.prototype.b4i=function(T,pa,hb,Db){var rc=!0;rc=void 0===rc?!1:rc;var vb=Le.a.instance.Bb(54);dc.ULS.shipAssertTag(537153949,0,!(void 0===T||null===T));dc.ULS.shipAssertTag(537153948,0,!(void 0===pa||null===pa));dc.ULS.shipAssertTag(537153947,0,!(void 0===hb||null===hb));dc.ULS.shipAssertTag(537153946,0,!(void 0===Db||null===Db));dc.ULS.shipAssertTag(537153945,
0,!(void 0===vb||null===vb));T=String.format(vb,T||"",pa||"",hb||"",Db||"");rc?this.sab(T,ae.a.gZa):this.readText(T)};Cd.prototype.nOj=function(T){var pa=this.iga.style;T?(T=Wh.a.T0b(T.cell,pa),pa=T.gL,pa.top=pa.left=pa.bottom=pa.right=null,T.Y9()):pa.cssText=""};Cd.prototype.XUh=function(T){switch(T){case -1985798686:return Mc.u$b(12);case -911352779:return Mc.u$b(11);case 237279923:return Mc.u$b(13);case -1502853784:return Mc.wbd(81);case -111689794:return Mc.wbd(78);case -287251124:return this.Jfd(1312,
function(pa){return pa.bold});case -1925065947:return this.Jfd(1313,function(pa){return pa.italic});case 1764140053:return this.Jfd(1314,function(pa){return pa.underline})}return null};Cd.prototype.register=function(){dc.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(dc.ULS.shipAssertTag(537153943,0,!!this.$.Ka,"Can't register to CommandHandlerManager's event"),this.$.Ka&&this.$.Ka.Wra(this.zuf))};Cd.prototype.unregister=function(){this.$&&this.$.Ka.Dza(this.zuf)};
Cd.prototype.fYf=function(T,pa){var hb=T===this.Wea;pa?(T.setAttribute(ae.a.nsa,ae.a.gZa),hb&&T.setAttribute(ae.a.Wd,ae.a.ksa),T.setAttribute(ae.a.IP,ae.a.nr),T.removeAttribute(ae.a.IP),T.innerHTML+=" "):(T.removeAttribute(ae.a.nsa),hb&&T.removeAttribute(ae.a.Wd),T.setAttribute(ae.a.IP,ae.a.ik))};Cd.prototype.Jfd=function(T,pa){var hb=this.activeCell;if(!hb)return null;pa=pa(hb)?7:8;return Mc.pDh(pa,Mc.u$b(T))};Ck.Object.defineProperties(Cd.prototype,{Cxa:{configurable:!0,enumerable:!0,get:function(){return this.Frg}},
isActive:{configurable:!0,enumerable:!0,get:function(){return!0}},activeCell:{configurable:!0,enumerable:!0,get:function(){return zf.g(this.$).lc(null)}}});Object(Zd.a)(Cd,"AriaLiveNotifier",null,[960,945,3]);var fh=Jf.a;Wl(Xc,fh);Xc.prototype.create=function(){this.Eb(this.$.da.za(211)||new Cd(this.$,this.$.jw,this.$.Lf))};Xc.ka=function(T){T.da.Ga(212,new Xc(T))};Object(Zd.a)(Xc,"AriaLiveNotifierFactory",Jf.a,[]);var ya=b(24),Ob=b(222),Lc=b(143),Ad=b(65);Md.prototype.readText=function(T){T=String.format(Le.a.instance.Bb(30),
T);this.XN.setAttribute(ae.a.Ot,T);this.MW.setAttribute(ae.a.Ot,T);this.kFj()};Md.prototype.dispose=function(){this.l0&&this.l0.parentNode&&this.l0.parentNode.removeChild(this.l0);this.MW=this.XN=this.l0=this.$ia=null};Md.prototype.F8g=function(T){var pa=T.Mb+"readoutElementWrapper",hb=T.Mb+"readoutElement1",Db=T.Mb+"readoutElement2";this.l0=document.getElementById(pa);this.l0||(this.l0=document.createElement(Ob.a.div),this.l0.id=pa,this.XN=document.createElement(Ob.a.label),this.XN.id=hb,this.XN.setAttribute(Lc.a.contentEditable,
Ad.a.HOb),this.XN.setAttribute(ae.a.Wd,ae.a.hZa),this.MW=document.createElement(Ob.a.label),this.MW.id=Db,this.MW.setAttribute(Lc.a.contentEditable,Ad.a.HOb),this.MW.setAttribute(ae.a.Wd,ae.a.hZa),this.XN.style.width="0px",this.XN.style.height="0px",this.MW.style.width="0px",this.MW.style.height="0px",this.XN.tabIndex=-1,this.MW.tabIndex=-1,this.l0.appendChild(this.XN),this.l0.appendChild(this.MW),T=T.Mb+ae.a.X1c,pa=document.getElementById(T),dc.ULS.shipAssertTag(537153942,3,!!pa,"FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: {0}",
T),pa&&pa.appendChild(this.l0))};Md.prototype.aZi=function(){this.$ia&&this.XN&&this.MW&&(this.$ia.setAttribute(ae.a.S2,this.XN.id),this.$ia.setAttribute(ae.a.KWc,String.format("{0} {1}",this.XN.id,this.MW.id)))};Md.prototype.kFj=function(){if(this.isActive){var T="";se.DOMElementExtensions.hasAttribute(this.$ia,ae.a.S2)&&(T=this.$ia.getAttribute(ae.a.S2).toString());this.$ia.setAttribute(ae.a.S2,T===this.XN.id?this.MW.id:this.XN.id)}else dc.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")};
Md.Y5a=function(){if(null==Md.Wtb)if($e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1)&&!ya.a.CMa)Md.Wtb=!0,dc.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(Md.Wtb=!1,ya.a.JH||ya.a.Nf)Md.Wtb=!0,dc.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return Md.Wtb};Md.ka=function(T){Md.Y5a()&&T.da.Ga(244,
new Md(T,zf.g(T).tc.textBox.ef))};Ck.Object.defineProperties(Md.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return!!this.$ia&&document.activeElement===this.$ia}}});Md.Wtb=null;Object(Zd.a)(Md,"FocusBasedReadout",null,[945,3]);var Pd=Jf.a;Wl(Tc,Pd);Tc.prototype.create=function(){var T=this;Md.Y5a()?zf.g(this.$).tc.textBox.qU(function(){var pa=T.$.da.za(244)||new Md(T.$,zf.g(T.$).tc.textBox.ef);T.Eb(pa)}):this.Eb(null)};Tc.ka=function(T){T.da.Ga(315,new Tc(T))};Object(Zd.a)(Tc,
"FocusBasedReadoutFactory",Jf.a,[]);var He=b(7),Me=b(91),Se=b(25),Ff=b(45),Oe=b(248),Na=b(47),kb=b(43),ic=b(122);gc.zfd=function(T){return gc.D0e(T.toString())};gc.D0e=function(T){return gc.qWg.test(T)?T.replace(gc.R2i,"$1 ").replace(gc.Q2i,' "$1"').trim():T};gc.tcj=function(T){var pa=T.lastIndexOf("!");return T.substring(0,-1<pa?pa+1:0)+gc.D0e(T.substring(-1<pa?pa+1:0,T.length))};Ck.Object.defineProperties(gc,{R2i:{configurable:!0,enumerable:!0,get:function(){return gc.Mde||(gc.Mde=RegExp("([A-Z]+)",
"g"))}},Q2i:{configurable:!0,enumerable:!0,get:function(){return gc.Lde||(gc.Lde=RegExp("([A-Z])","g"))}},qWg:{configurable:!0,enumerable:!0,get:function(){return gc.H2d||(gc.H2d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}}});gc.Mde=null;gc.Lde=null;gc.H2d=null;Object(Zd.a)(gc,"RangeAriaExtensions",null,[]);Object(Zd.a)(Jd,"SelectionReadoutState",null,[]);var Rc=b(63),dd=b(79);zd.prototype.dispose=function(){this.$&&
this.al();Me.a.Ha(this.U_b);this.sparklineManager=this.$=this.U_b=null};zd.prototype.DWe=function(T,pa,hb){hb=void 0===hb?!0:hb;if(!T)return"";var Db=this.$.da,rc=new Sys.StringBuilder;this.FJg(rc,T,pa);if($e.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var vb=this.tableManager.vva(T.range);(null===vb||void 0===vb?0:vb.bRd)&&this.Kpe(rc,vb);vb=this.tableManager.nn(T.range);(null===vb||void 0===vb?0:vb.dba)&&this.Kpe(rc,vb)}vb=T.bba?this.lZe(T):T.text;Sb(rc,vb);vb=this.$.activeItemName;
this.mD.activeItemName!==vb&&(Sb(rc,vb),this.mD.activeItemName=vb);vb=1===pa.length?Ff.K(pa).isSingle?"":Le.a.instance.ga(850):String.format(Le.a.instance.Bb(31),pa.length);Sb(rc,vb);vb=Gl(pa);for(var Uc=vb.next();!Uc.done;Uc=vb.next())Uc=Uc.value,Sb(rc,gc.zfd(Uc)),1===pa.length&&zd.ymi(Uc)&&(Uc=zf.g(this.$).Ea.cs(Uc.bottomRight),void 0!==Uc&&null!==Uc&&Uc.text&&(Uc=Uc.bba?this.kZe(Uc,Uc.text):Uc.text,Sb(rc,Uc)));vb=T.cell;vb=this.vSh(vb.Wgj,vb.wZg);Sb(rc,vb);this.pJg(rc,T);hb&&(T.y6a?Sb(rc,Le.a.instance.ga(838)):
T.sMa&&Sb(rc,Le.a.instance.ga(839)));if(T.hasAutoFilter||T.O4)this.GJg(rc,T.hasAutoFilter?T.cell.sob:T.cell.CWi),hb&&Sb(rc,Le.a.instance.ga(841));Oe.c(this.$,T.range)&&Sb(rc,Le.a.instance.ga(845));this.mJg(rc,T);hb=(hb=Db.za(14))?hb.sHh():"";Sb(rc,hb);T.vH&&(hb=zf.g(this.$).Ea.cs(T.range),hb=!!hb&&hb.e6e,zd.Ytj(T)?zd.nJg(rc,T):$e.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&hb?Sb(rc,Le.a.instance.ga(843)):Sb(rc,Le.a.instance.ga(842)));T.aba&&(Sb(rc,Le.a.instance.ga(844)),
T.Bwb&&Sb(rc,String.format(Le.a.instance.Bb(16),T.Pah)),Sb(rc,T.iconName));T.hasRichValueIcon&&(vb=this.$.da.za(271),hb="",vb&&T.cell.Mjf&&(vb=vb.qQ(T.cell.Mjf))&&vb.DomainId.Id!==zd.vVj&&(hb=vb.Name),T.cell.pdi?(Sb(rc,String.format(Le.a.instance.Bb(178),hb)),Sb(rc,Le.a.instance.ga(1784))):(Sb(rc,String.format(Le.a.instance.Bb(176),hb)),Sb(rc,Le.a.instance.ga(1783))));this.G3h(T)&&Sb(rc,zd.fOh(T));(Db=Db.za(231))&&Sb(rc,Db.zZe(pa,!0));1===pa.length&&pa[0].isSingle&&zd.Xtj(T,pa[0],this.$)&&(pa=this.$.da.za(271))&&
Sb(rc,pa.DHh());T.lNb&&T.mNb&&Sb(rc,T.mNb);(pa=T.cell.bVg)&&Sb(rc,pa);T.Swa&&T.SFb&&(T=T.YCd)&&(Sb(rc,Le.a.instance.ga(1950)),Sb(rc,T));return rc.toString()};zd.prototype.Lue=function(T){this.Fsa=this.mD;this.mD=Object(He.a)(new Jd,{activeItemName:this.Fsa.activeItemName,izc:T?this.Fsa.izc:!1,tableName:T?this.Fsa.tableName:"",R_a:T?this.Fsa.R_a:-1})};zd.prototype.HSf=function(){this.Fsa&&(this.mD=this.Fsa,this.Fsa=null)};zd.prototype.vSh=function(T,pa){return 2===T||2===pa?Le.a.instance.ga(871):1===
T||1===pa?Le.a.instance.ga(872):""};zd.prototype.lZe=function(T){return this.kZe(T.cell,T.text)};zd.prototype.FJg=function(T,pa,hb){if(hb&&1===hb.length&&hb[0].isSingle){hb="";var Db=this.tableManager.vva(pa.range);if(Db){hb=Db.pivotTableName;this.jWc(T,hb);var rc=Db.Zfc?Le.a.instance.ga(833):"";$e.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(rc+=(Db.altText?Db.altText+" . ":"")+(Db.altTextSummary?Db.altTextSummary:""));this.Mpe(T,!0,hb,rc);Sb(T,this.tableManager.zki(Db,
pa.range)?Le.a.instance.ga(835):"");Sb(T,this.tableManager.Gei(Db,pa.range)?Le.a.instance.ga(834):"")}else if(Db=this.tableManager.nn(pa.range)){hb=(rc=zf.g(this.$).Nb.rj(pa.range))?rc.name:"";this.jWc(T,hb);var vb="";rc&&$e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&(vb=(rc.HSa?rc.HSa+" . ":"")+(rc.ISa?rc.ISa:""));this.Mpe(T,!1,hb,vb);Sb(T,this.tableManager.Scf(Db,pa.range)?Le.a.instance.ga(834):"")}else this.jWc(T,hb),this.mD.tableName="",this.mD.R_a=
-1}};zd.prototype.jWc=function(T,pa){pa!==this.mD.tableName&&this.mD.tableName&&(T.append(Le.a.instance.ga(this.mD.izc?832:831)),Sb(T," "+this.mD.tableName))};zd.prototype.Mpe=function(T,pa,hb,Db){hb!==this.mD.tableName&&(T.append(Le.a.instance.ga(pa?830:829)),Sb(T," "+hb),Sb(T,Db),this.mD.tableName=hb,this.mD.izc=pa,this.mD.R_a=-1)};zd.prototype.Kpe=function(T,pa){var hb=zf.g(this.$).ha.ta.activeCell;if(hb.top!==pa.top&&hb.left!==this.mD.R_a){T.append(Le.a.instance.ga(834));pa=new Se.Range(pa.top,
hb.left,pa.top,hb.left,!0,!0);Sb(T,gc.zfd(pa));if(pa=zf.g(this.$).lc(pa))pa=pa.bba?this.lZe(pa):pa.text,Sb(T,pa);this.mD.R_a=hb.left}};zd.prototype.kZe=function(T,pa){var hb=T.a5a;return T.Ewb?String.format(Le.a.instance.Bb(14),pa,hb):String.format(Le.a.instance.Bb(13),pa,gc.tcj(hb))};zd.prototype.Ej=function(){dc.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var T=zf.g(this.$);dc.ULS.shipAssertTag(537153929,0,!!T,"Can't register to grid's events");T&&
(T.pc.ql(this.zp),T.Ea.yx(this.Xca),T.eE(this.Xca),this.nab&&T.pc.Kn(this.Tf.bind(this)),T=T.ha,dc.ULS.shipAssertTag(537153928,0,!!T,"Can't register to selectionManager's events"),T&&(T.GG(this.ld),T.oJ(this.Xca),T.Oa.I2(this.Xca),this.nab&&(this.nGd=this.nGd.bind(this))))}};zd.prototype.al=function(){if(this.$){var T=zf.g(this.$);T&&(T.pc.kl(this.zp),T.Ea.tv(this.Xca),T.KF(this.Xca),this.nab&&T.pc.Um(this.Tf),T=T.ha)&&(T.MF(this.Xca),T.aO(this.Xca),T.Oa.Xma(this.Xca))}};zd.prototype.readText=function(T,
pa){this.Y5a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(T):($e.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(T),this.nab&&!pa||this.ariaLiveNotifier.nOj(pa))};zd.prototype.Tf=function(){this.eob&&this.eob.cancel()};zd.prototype.nGd=function(){this.readText(this.HVh())};zd.prototype.HVh=function(){var T=this,pa="";zf.g(this.$).ha.rangePicker.DK.forEach(function(hb){pa+=
T.yWh(hb)});return pa+=" selected"};zd.prototype.yWh=function(T){return" "+(T.sheetId!==Rc.d(this.$.qa)?this.$.xa.$fd(T.sheetId).name:"")+" "+T.range.topLeft+" "+(T.range.isSingle?"":T.range.bottomRight)};zd.prototype.rGh=function(){var T=null;var pa=zf.g(this.$).ha;if(1!==pa.We&&!pa.Oa.nc)return dc.ULS.sendTraceTag(537153927,0,15,"selectionManager.CommandSelectionMode={0} and selectionManager.SelectedFloatingObjectControl is null",pa.We),{returnValue:"",activeCell:T};switch(pa.We){case 2:return{returnValue:this.mJh(pa),
activeCell:T};case 64:var hb=pa.Oa.nc.floatingObject,Db="";if(pa=pa.Oa.nc.Cs||pa.Oa.nc.Td)Db=(Db=pa.firstChild)?se.DOMElementExtensions.getTextContent(Db):"";return{returnValue:String.format(Le.a.instance.Bb(53),zd.I$b(hb.altText,hb.altTextDescription,hb.name),Db,hb.altTextDescription),activeCell:T};case 4:return{returnValue:zd.zIg(pa.Oa.nc.floatingObject),activeCell:T};case 512:return{returnValue:ic.a.$Xe(pa.Oa.nc.floatingObject.W6c),activeCell:T};case 8:return hb=(hb=pa.Oa.nc.floatingObject)?hb.name:
"",{returnValue:String.format(Le.a.instance.Bb(51),hb),activeCell:T};case 1:return T=this.activeCell,{returnValue:this.DWe(T,pa.ta.selectedRanges),activeCell:T}}return{returnValue:"",activeCell:T}};zd.prototype.mJh=function(T){var pa=new Sys.StringBuilder;pa.append(zd.HVg(T));var hb=this.$.da.za(231);hb&&Sb(pa,hb.zZe(T.Oa.nc.floatingObject,!1));return pa.toString()};zd.prototype.G3h=function(T){T=T.Yaf();var pa=!1;this.mD.Qff!==T&&(this.mD.Qff=T,pa=!0);return pa};zd.prototype.pJg=function(T,pa){if(pa.Owb)if(pa=
this.sparklineManager.GWh(pa)){var hb=Le.a.instance,Db=hb.ga;a:switch(pa.type){case 0:var rc=826;break a;case 1:rc=827;break a;default:rc=828}hb=Db.call(hb,rc);Sb(T,String.format(Le.a.instance.Bb(25),hb));pa=String.format(Le.a.instance.Bb(24),gc.zfd(pa.KBj));Sb(T,pa)}else dc.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),Sb(T,String.format(Le.a.instance.Bb(25),""))};zd.prototype.GJg=function(T,pa){switch(pa){case 1:case 11:Sb(T,Le.a.instance.ga(846));break;
case 6:Sb(T,Le.a.instance.ga(846));Sb(T,Le.a.instance.ga(848));break;case 7:Sb(T,Le.a.instance.ga(846));Sb(T,Le.a.instance.ga(849));break;case 2:Sb(T,Le.a.instance.ga(847));Sb(T,Le.a.instance.ga(848));break;case 3:Sb(T,Le.a.instance.ga(847));Sb(T,Le.a.instance.ga(849));break;default:Sb(T,Le.a.instance.ga(847))}};zd.prototype.mJg=function(T,pa){var hb,Db=this.$.da.za(65);pa=Db?Db.NJa(pa.range):null;var rc="",vb=Object(pg.a)(580,pa);if(pa)rc=!pa.h6a&&vb&&vb.$li?String.format(Le.a.instance.Bb(29),vb.aGj):
String.format(Le.a.instance.Bb(23),pa.author);else if(null===(hb=null===Db||void 0===Db?void 0:Db.Rm)||void 0===hb?0:hb.$E)rc=String.format(Le.a.instance.Bb(28),Db.Rm.nN.author);Sb(T,rc)};zd.zIg=function(T){return String.format(Le.a.instance.Bb(52),zd.I$b(T.altText,T.altTextDescription,T.name),T.altTextDescription)};zd.fOh=function(T){return Le.a.instance.ga(T.Yaf()?836:837)};zd.I$b=function(T,pa,hb){return T||pa?T:hb};zd.HVg=function(T){var pa=T.Oa.nc;T=pa.floatingObject;var hb=T.dd,Db=hb.ChartTitle,
rc=T.altText,vb=T.altTextDescription,Uc=!!(hb.Attributes&4);return(pa=pa.getSelectionDescription())?pa:hb.DataRangeForDisplay?String.format(Le.a.instance.Bb(Uc?49:47),zd.I$b(rc,vb,T.name),vb,Db,Le.a.instance.ga(Hc(hb.ChartCategory)),hb.DataRangeForDisplay):String.format(Le.a.instance.Bb(Uc?50:48),zd.I$b(rc,vb,T.name),vb,Db,Le.a.instance.ga(Hc(hb.ChartCategory)))};zd.Ytj=function(T){return $e.EwaSettings.ma(103)&&(T.Q5a||T.Xfc)};zd.nJg=function(T,pa){if(!pa.oSa)dc.ULS.shipAssertTag(537153924,0,!1,
"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.");else if(pa.Q5a)pa=pa.oSa.topLeft.toString(),Sb(T,String.format(Le.a.instance.Bb(26),pa));else if(pa.Xfc){var hb=pa.oSa.DS();pa=(hb.LastColumn-hb.FirstColumn+1).toString();hb=(hb.LastRow-hb.FirstRow+1).toString();Sb(T,String.format(Le.a.instance.Bb(27),pa,hb))}};zd.Xtj=function(T,pa,hb){return T.vH||!$e.EwaSettings.ma(139)?!1:(T=hb.da.za(271))?T.ufc(pa):!1};zd.ymi=
function(T){return T.top===T.bottom&&T.left+1===T.right||T.top+1===T.bottom&&T.left===T.right};Ck.Object.defineProperties(zd.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return zf.g(this.$).lc(null)}}});zd.vVj=268435712;zd.sTc=500;Object(Zd.a)(zd,"SelectionReadoutHandler",null,[959,3]);var Od=b(58),me=Jf.a;Wl(Qd,me);Qd.prototype.create=function(){var T=this,pa=this.$.da,hb=qb.GetServiceTaskFactory.Xa(pa,211,212,this.vb),Db=qb.GetServiceTaskFactory.Xa(pa,66,134,this.vb),rc=qb.GetServiceTaskFactory.Xa(pa,
240,239,this.vb),vb=Od.Task.Sa(null);$e.EwaSettings.Gb()&&(vb=qb.GetServiceTaskFactory.Xa(pa,244,315,this.vb));jc.TaskExtensions.Ba(jc.TaskExtensions.te([hb,Db,rc,vb],this.la),function(){var Uc=pa.za(226)||new zd(hb.result,T.$,Db.result,rc.result,vb.result);T.Eb(Uc)},this.$.la,3)};Qd.ka=function(T){T.da.Ga(227,new Qd(T))};Object(Zd.a)(Qd,"SelectionReadoutHandlerFactory",Jf.a,[]);bd.prototype.kLf=function(){var T=this.uHh();this.ariaLiveNotifier.sab(T,ae.a.Vnb)};bd.prototype.uHh=function(){var T=new Sys.StringBuilder;
this.$.workbookContext&&Sb(T,this.$.workbookContext.WorkbookFileName);Sb(T,Le.a.instance.ga(852));Sb(T,this.wHh());Sb(T,this.vHh());Sb(T,Le.a.instance.ga(853));return T.toString()};bd.prototype.wHh=function(){return this.$.isEditMode?Le.a.instance.ga(857):Le.a.instance.ga(858)};bd.prototype.vHh=function(){var T=this.CUj(),pa=this.$.xa.qa;T=1!==T?String.format(Le.a.instance.Bb(32),T):Le.a.instance.ga(851);T=new Sys.StringBuilder(T);pa&&pa.sheetName&&(T.append(Mc.hud),T.append(String.format(Le.a.instance.Bb(33),
pa.sheetName)));return T.toString()};bd.prototype.CUj=function(){for(var T=0,pa=Gl(this.$.xa.items),hb=pa.next();!hb.done;hb=pa.next())hb.value.visible&&T++;return T};Object(Zd.a)(bd,"WorkbookReadout",null,[]);xb.prototype.dispose=function(){this.c$b&&this.c$b.Y$i(this.Zxf);this.c$b=this.ariaLiveNotifier=this.$=null};Object(Zd.a)(xb,"EmbeddedWorkbookReadoutHandler",null,[3]);kd.prototype.dispose=function(){this.al();this.ariaLiveNotifier=this.fZ=null;this.Pd=!0};kd.prototype.Ej=function(){if(this.fZ){this.fZ.Mt(this.oW);
this.fZ.Ea.yx(this.oW);this.fZ.eE(this.oW);var T=Object(pg.a)(410,this.fZ);T&&(T.pc.ql(this.oW),T.ha.GG(this.oW),T.ha.oJ(this.oW),T.ha.Oa.I2(this.oW))}else dc.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")};kd.prototype.al=function(){if(this.fZ){this.fZ.Ea.tv(this.oW);this.fZ.KF(this.oW);var T=Object(pg.a)(410,this.fZ);T&&(T.pc.kl(this.oW),T.ha.MF(this.oW),T.ha.aO(this.oW),T.ha.Oa.Xma(this.oW))}};kd.prototype.kpe=function(){this.c_d.kLf();this.ariaLiveNotifier.setEnabled(!0);
this.ariaLiveNotifier.$nj();this.dispose()};Object(Zd.a)(kd,"WorkbookReadoutHandler",null,[3]);var Ie=Jf.a;Wl(Qc,Ie);Qc.prototype.create=function(){var T=this,pa=qb.GetServiceTaskFactory.Xa(this.$.da,211,212,this.vb);if(this.$.XM){var hb=qb.GetServiceTaskFactory.Xa(this.$.da,12,477,this.vb);jc.TaskExtensions.Ba(jc.TaskExtensions.te([pa,hb],this.$.la),function(){var Db=new xb(pa.result,T.$,hb.result);T.Eb(Db)},this.$.la,3)}else jc.TaskExtensions.Ba(pa,function(Db){Db=new kd(Db.result,T.$);T.Eb(Db)},
this.$.la,3)};Qc.ka=function(T){T.da.Ga(229,new Qc(T))};Object(Zd.a)(Qc,"WorkbookReadoutHandlerFactory",Jf.a,[]);var Xe=b(38),wf=b(249),De=b(374),oc=b(189),Yc=b(703),hf=Xe.a;Wl(Ub,hf);Ub.prototype.dispose=function(){this.view&&(this.view.Ea.Vq(this.yf),this.view.Ea.gI(this.Sm),this.view.Ea.Vab(this.yf),this.view.Ea.LHb(this.yf),this.view.$.xa.JK(this.Do),this.view.$.Hb.JK(this.Do));this.tT=this.Die=null;hf.prototype.dispose.call(this)};Ub.prototype.OYb=function(T){T=this.QFd(T);var pa=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?
this.view.hH:this.view.Gh;if(T&&0<T.length&&pa)for(var hb=0,Db=T.length;hb<Db;hb++)pa.contains(this.tT[hb])||this.tT.push(oc.a.JQ(T[hb]))};Ub.prototype.tHb=function(){var T=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:6336710_ApplyHeaderSnappingOnVerticalFreezePane")?this.view.hH:this.view.Gh;if(this.tT.length&&T)for(var pa=this.tT.length-1;0<=pa;pa--)T.contains(this.tT[pa])||Array.removeAt(this.tT,pa)};Ub.prototype.G0e=function(T){return this.c0e(T)};Ub.prototype.c0e=function(T){T=Ff.I(T,this.tT,
!0);return 0<T.length?T[0]:null};Ck.Object.defineProperties(Ub.prototype,{rangeList:{configurable:!0,enumerable:!0,get:function(){return this.tT}},view:{configurable:!0,enumerable:!0,get:function(){return this.Die}}});Ub.RFd="lrc";Object(Zd.a)(Ub,"LoadedRangeCollection",Xe.a,[]);Wl(Zb,Ub);Zb.prototype.GWh=function(T){for(var pa=Gl(this.rangeList),hb=pa.next();!hb.done;hb=pa.next())if(hb=hb.value,T.range.contains(hb))return hb;return null};Zb.prototype.QFd=function(T){return T.GridBlockModel&&(T=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(T.GridBlockModel))?
T.getSparklineRanges():null};Object(Zd.a)(Zb,"SparklineManager",Ub,[895]);var ie=Jf.a;Wl(jb,ie);jb.prototype.create=function(){this.Eb(this.sparklineManager||(this.sparklineManager=new Zb(zf.g(this.$),this.$.da)))};jb.ka=function(T){T.da.Ga(239,new jb(T))};Object(Zd.a)(jb,"SparklineManagerFactory",Jf.a,[]);var bf=b(54),Wd=b(300);ma.MNe="ewa-svg-icon";Object(Zd.a)(ma,"CssClassNames",null,[]);var ee=b(324),Yg=b(258);hd.prototype.dispose=function(){this.bUd=null;this.$.ea.Yn(this.Ig)};hd.prototype.Bva=
function(T,pa,hb,Db,rc){Db=void 0===Db?null:Db;rc=void 0===rc?null:rc;var vb;(vb=this.bUd[T])||(this.bUd[T]=vb=this.yVi(this.R6f[T]));if(!vb)return dc.ULS.shipAssertTag(537151262,0,!1,"SvgIconProvider.GetSvgElement: id {0} was not found in loaded SVG sprites.",T),null;var Uc=vb.cloneNode(!0);if(!Uc.style){var Td=ee.b(vb),mf=ee.b(Uc),bg={};bg.iconId=T;bg.isOriginalNodeStyleNull=void 0===vb.style||null===vb.style;bg.isOriginalNodeCurrentStyleNull=void 0===vb.currentStyle||null===vb.currentStyle;bg.isClonedNodeCurrentStyleNull=
void 0===Uc.currentStyle||null===Uc.currentStyle;bg.originalNode=Td.substring(0,Td.indexOf(">")+1);bg.clonedNode=mf.substring(0,mf.indexOf(">")+1);dc.ULS.sendTraceTag(537151261,0,10,"SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: {0}",JSON.stringify(bg))}T=String.format("height: {0}px; width: {0}px;",pa,hb);Uc.setAttribute("style",T);rc&&(T=document.createElement("title"),T.innerHTML=rc,Uc.insertBefore(T,Uc.childNodes[0]));if(Db)for(Db=Gl(Db),rc=Db.next();!rc.done;rc=Db.next())Sys.UI.DomElement.addCssClass(Uc,
rc.value);return Uc};hd.prototype.nba=function(T,pa,hb,Db,rc,vb,Uc,Td){rc=void 0===rc?0:rc;vb=void 0===vb?0:vb;Uc=void 0===Uc?null:Uc;Td=void 0===Td?null:Td;rc&&vb||(vb=se.DOMElementExtensions.getBoundingClientRect(Db),rc=vb.height,vb=vb.width);if(Uc=this.Bva(T,pa,hb,Uc,Td))Db.appendChild(Uc),(Db=se.DOMElementExtensions.yZ(Uc,"style",null))?Uc.setAttribute("style",Db+String.format(" margin: {0}px {1}px;",(rc-pa)/2,(vb-hb)/2)):dc.ULS.sendTraceTag(537151260,0,10,'SvgIconProvider.InsertAndCenterSvgElement: svgElement\'s GetAttribte("styl") returned null. Icon ID: {0}',
T);return Uc};hd.prototype.$jf=function(){var T=this;jc.TaskExtensions.Ba(qb.GetServiceTaskFactory.Xa(this.$.da,283,284,0),function(pa){pa=Yg.c(pa.result.Fn.loadScript("excel-uiSlice20-sprite"));jc.TaskExtensions.Ba(pa,function(){var hb=T.nZe("excelUiSlice20Sprite");hb?T.Nle(hb):dc.ULS.sendTraceTag(537151259,0,15,"window[{0}].icons returned null.","excelUiSlice20Sprite")},T.$.la,3)},this.$.da.la,3)};hd.prototype.Nle=function(T){T=Gl(T);for(var pa=T.next();!pa.done;pa=T.next())pa=pa.value,pa.type===
Ob.a.$Td&&(this.R6f[pa.id]=pa)};hd.prototype.yVi=function(T){if(!T)return null;var pa=T.viewBox;T=T.children;var hb=document.createElementNS(Wd.a.dUd,Ob.a.$Td);Sys.UI.DomElement.addCssClass(hb,ma.MNe);hb.setAttribute("focusable","false");hb.setAttribute("viewBox",pa);this.rCg(hb,T);return hb};hd.prototype.rCg=function(T,pa){pa=Gl(pa);for(var hb=pa.next();!hb.done;hb=pa.next()){hb=hb.value;var Db=document.createElementNS(Wd.a.dUd,hb.type),rc;for(rc in hb){var vb=rc,Uc=hb[rc];"className"===vb?Db.setAttribute("class",
Uc):Db.setAttribute(vb,Uc)}T.appendChild(Db)}};hd.prototype.nZe=function(T){return(T=window[T])?T.icons:null};Object(Zd.a)(hd,"SvgIconProvider",null,[891,3]);var Sf=Jf.a;Wl(uc,Sf);uc.prototype.create=function(){var T=this;jc.TaskExtensions.Ba(bf.a.y_([107],4,this.vb,void 0,void 0,void 0,387),function(){var pa=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite";window[pa]?T.Eb(T.$.da.za(388)||new hd(T.$)):dc.ULS.sendTraceTag(537151258,
0,50,"window.[{0}] returned null.",pa)},this.la,3)};uc.ka=function(T){T.da.Ga(387,new uc(T))};Object(Zd.a)(uc,"SvgIconProviderFactory",Jf.a,[]);var vd=b(437),vf=b(567),rh=b(231),cg=b(168),eh=b(130),Ud=b(10),lh=b(354),Eg=b(244),Vf=b(13),ve=b(161),Rg=b(245),hh=b(105),ff=b(44),Ih=b(33),Eh=ef.a;Wl(kc,Eh);kc.prototype.dispose=function(){this.ubb();this.tableManager.O9i(this.Otf);this.Agf||ya.a.pp||ya.a.Cka||Eg.a.instance.Aa(Vf.a.pointerDown,this.Zaa,this.onPointerDown);if(this.mB){Rg.b(this.$,!1);try{this.Kv()}catch(T){dc.ULS.sendTraceTag(537151236,
0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",T)}}this.parentElement&&this.parentElement.contains(this.Zaa)&&this.parentElement.removeChild(this.Zaa);this.Zaa=this.parentElement=null;Eh.prototype.dispose.call(this)};kc.prototype.Q2e=function(T){var pa=T.bottom-this.ao.topLeft.bottom-1;return 0<=T.right-this.ao.topLeft.right+1&&0<=pa&&T.bottom>=this.ao.top&&T.right>=this.ao.left?new Se.Range(this.ao.top,this.ao.left,T.bottom,T.right,!1,!1):this.ot};kc.prototype.yjd=
function(T){this.Xvc([this.ot],6,void 0===T?!0:T);this.Db.Cn(this.j7f)};kc.prototype.AHb=function(T){T=void 0===T?!0:T;this.Db.Oh(this.j7f);this.Xvc([null],6,T)};kc.prototype.OHd=function(T){T=void 0===T?!0:T;this.Db.Oh(this.d7f);this.Xvc([null],26,T)};kc.prototype.u5h=function(){var T=!1;T=void 0===T?!0:T;var pa=this.OFj();0<pa.length&&(this.Xvc(pa,26,T),this.Db.Cn(this.d7f))};kc.prototype.OFj=function(){var T=[];this.ao.contains(this.ot)&&(this.ao.right!==this.ot.right&&T.push(new Se.Range(this.ao.top,
this.ot.right+1,this.ot.bottom,this.ao.right,!1,!1)),this.ao.bottom!==this.ot.bottom&&T.push(new Se.Range(this.ot.bottom+1,this.ao.left,this.ao.bottom,this.ao.right,!1,!1)));return T};kc.prototype.resizeTable=function(){if(!this.ot.equals(this.ao)){var T=new Se.Range(this.ao.top,this.ao.left,this.ot.bottom,this.ot.right,!1,!1);this.GKj(T);this.$pd=!0}};kc.prototype.onKeyDown=function(T){Ih.a(this.$).ie(T);return!0};kc.prototype.o9a=function(){this.Agf&&(ya.a.pp||ya.a.Cka||(Eg.a.instance.pa(Vf.a.pointerDown,
this.Zaa,this.onPointerDown),this.Zaa.classList.remove("ewr-table-resize-default-cursor"),this.xLc=this.Zaa.disabled=!1),this.xLc=!1)};kc.prototype.dRg=function(){var T=document.createElement("div");T.className="ewr-table-resize-handle";var pa=document.createElement("div");pa.className="ewr-table-resize-fillhandle-higher";var hb=document.createElement("div");hb.className="ewr-table-resize-fillhandle-broader";T.appendChild(pa);T.appendChild(hb);this.Zaa=T;this.parentElement.appendChild(this.Zaa)};
kc.prototype.L0b=function(T){var pa=this,hb=this.ot.contains(T),Db=T.top,rc=T.bottom,vb=T.left;T=T.right;var Uc=null;if(hb){if(this.gridView.i_(this.ao.topLeft)&&!this.ao.coa)return;Db=Math.max(1,rc-5,this.ao.top);vb=Math.max(1,T-5,this.ao.left);rc=Db;T=vb;Uc=new Se.Range(Db,vb,Db,vb,!1,!1)}else rc+=5,T+=5,Db=rc,vb=T,Uc=new Se.Range(rc,T,rc,T,!1,!1);this.gridView.i_(Uc)||(this.Nr?this.Nr.yo||(this.Nr=Na.a.instance.create(function(){pa.gridView.jt(Uc,60,hh.a.g7f)},40,kb.a.h7f)):this.Nr=Na.a.instance.create(function(){pa.gridView.jt(Uc,
60,hh.a.g7f)},40,kb.a.h7f))};kc.prototype.LYa=function(T){var pa=T;if(this.gridView.rb.N4){if(!this.gridView.lc(T.topLeft)){var hb=this.gridView.xk("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.hH,this.ot.top!==T.top?1:2);try{hb.gl=this.ot.top<T.top||this.ot.left<T.left,hb.ls(T.topLeft),pa=hb.$$cu().range}finally{hb&&hb.dispose()}}pa.right=pa.left+T.width-1;pa.bottom=pa.top+T.height-1}return pa};kc.prototype.Xvc=function(T,pa,hb){hb=void 0===hb?!0:hb;var Db=[];T=Gl(T);for(var rc=T.next();!rc.done;rc=
T.next())Db.push(new lh.a(rc.value,Rc.d(this.$.qa)));this.Db.Av(Db,[pa],!0,void 0,hb)};kc.prototype.Y6i=function(){for(var T=Gl(this.gridView.vn),pa=T.next();!pa.done;pa=T.next())Eg.a.instance.pa(Vf.a.vh,pa.value.domElement,this.Ih);Eg.a.instance.pa(Vf.a.Zd,document.documentElement,this.Gf);this.wHe()};kc.prototype.L7i=function(){for(var T=Gl(this.gridView.vn),pa=T.next();!pa.done;pa=T.next())ve.a.instance.pa(Vf.a.Bg,pa.value.domElement,this.Ih);ve.a.instance.pa(Vf.a.De,document.documentElement,this.ZEb);
this.wHe()};kc.prototype.Kv=function(){this.szb&&this.vNj();this.jic&&this.GNj()};kc.prototype.vNj=function(){for(var T=Gl(this.gridView.vn),pa=T.next();!pa.done;pa=T.next())Eg.a.instance.Aa(Vf.a.vh,pa.value.domElement,this.Ih);Eg.a.instance.Aa(Vf.a.Zd,document.documentElement,this.Gf);this.nMf()};kc.prototype.GNj=function(){for(var T=Gl(this.gridView.vn),pa=T.next();!pa.done;pa=T.next())ve.a.instance.Aa(Vf.a.Bg,pa.value.domElement,this.Ih);ve.a.instance.Aa(Vf.a.De,document.documentElement,this.ZEb);
this.nMf()};kc.prototype.wHe=function(){Eg.a.instance.pa(Vf.a.xy,document.documentElement,this.vca);this.gridView.tc.B7b(!0)};kc.prototype.nMf=function(){Eg.a.instance.Aa(Vf.a.xy,document.documentElement,this.vca);this.gridView.tc.B7b(!1)};kc.prototype.GKj=function(T){var pa={};T=(pa.ResizeTableRange=T,pa.OriginalTableRange=this.ao,pa);this.$.Ud(-1400250766,dd.a.Sb,30,T)};kc.prototype.ePj=function(T){if(!this.ao.contains(T)){T=this.NFj();T=Gl(T);for(var pa=T.next();!pa.done;pa=T.next())if(this.tableManager.yqd(pa.value)){this.gridView.ug.Jo(ae.a.eCi);
return}}this.gridView.rtl?this.gridView.ug.Jo(ae.a.jBi):this.gridView.ug.Jo(ae.a.vDi)};kc.prototype.ubb=function(){if(this.mB){Rg.b(this.$,!1);try{this.Kv()}catch(T){dc.ULS.sendTraceTag(537151232,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",T)}}this.Nr&&(this.Nr.cancel(),this.Nr.dispose());this.jic=this.szb=!1;this.AHb();this.OHd();Rg.b(this.$,!1);this.gridView.ug.Jo(ae.a.J4)};kc.prototype.NFj=function(){var T=[];this.ao.right!==this.ot.right&&T.push(new Se.Range(this.ao.top,
this.ao.right+1,this.ot.bottom,this.ot.right,!1,!1));this.ao.bottom!==this.ot.bottom&&T.push(new Se.Range(this.ao.bottom+1,this.ao.left,this.ot.bottom,this.ao.right,!1,!1));return T};kc.createInstance=function(T,pa,hb,Db){if(!pa)return null;var rc=T.Db;rc.Av(hb,[27],!0);rc.Cn(kc.IFj);hb=rc.yw(27,T.rb.qj(pa.bottomRight),kc.XLh(pa,hb)).Ef;return new kc(hb,T,pa,Db)};kc.XLh=function(T,pa){for(var hb,Db=0;Db<pa.length;Db++)if((null===(hb=pa[Db])||void 0===hb?0:hb.range)&&pa[Db].range.equals(T))return Db;
return 0};Ck.Object.defineProperties(kc.prototype,{mB:{configurable:!0,enumerable:!0,get:function(){return this.szb||this.jic}},Agf:{configurable:!0,enumerable:!0,get:function(){return this.xLc}}});kc.IFj=[27];Object(Zd.a)(kc,"TableResizeBehavior",ef.a,[]);var Xf=b(243);Jb.urh="ewa-ttrd-buttonarea";Object(Zd.a)(Jb,"CssClassNames",null,[]);var jj=b(48),Yh=b(133),sh=b(134),ii=b(274),Bg=Xf.a;Wl($b,Bg);$b.prototype.dispose=function(){this.$&&this.pdh();this.$=this.gridView=this.parentElement=this.CKa=
null;Bg.prototype.dispose.call(this)};$b.prototype.PJh=function(T){var pa=this.uYh(this.gridView.lc(null).range);return pa?String.format("=SUBTOTAL({0},{1})",T,pa):null};$b.prototype.uYh=function(T){var pa=zf.g(this.$).Nb.rj(T);if(!pa)return null;pa=cg.a(pa,!1);pa.right=pa.left=T.left;return pa.toString()};$b.prototype.S9h=function(){$b.ZL={};$b.ZL["100"]=Le.a.instance.ga(1080);$b.ZL["101"]=Le.a.instance.ga(1083);$b.ZL["102"]=Le.a.instance.ga(1082);$b.ZL["103"]=Le.a.instance.ga(1087);$b.ZL["104"]=
Le.a.instance.ga(1084);$b.ZL["105"]=Le.a.instance.ga(1085);$b.ZL["109"]=Le.a.instance.ga(1081);$b.ZL["107"]=Le.a.instance.ga(1088);$b.ZL["110"]=Le.a.instance.ga(1090);$b.ZL["111"]=Le.a.instance.ga(1141)};$b.prototype.XUi=function(){var T=this.gridView.lc(null);if(T&&(T=T.vH?T.formulaBarText:null))if("=SUBTOTAL("===T.substring(0,10)){if(T=T.substring(10,13),T in $b.ZL)return T}else return"111";return"100"};$b.prototype.vLg=function(){this.gridView.Ea.Qs(this.yf);this.gridView.ha.oJ(this.Sh);this.gridView.Mt(this.onContentReady);
this.gridView.tc.ql(this.Ttf);this.gridView.tc.Kn(this.LDb)};$b.prototype.pdh=function(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.aO(this.Sh),this.gridView.Ea.Vq(this.yf)),this.gridView.Ww(this.onContentReady),this.gridView.tc&&(this.gridView.tc.kl(this.Ttf),this.gridView.tc.Um(this.LDb)),this.Rag())};$b.prototype.Rqb=function(T){this.pPj(T);this.kAb&&(this.lEj(),this.xmb?(this.REf||this.GLg(),this.vTc?this.g5=!1:(this.g5=!0,this.qQf())):(dc.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),
this.g5=!1))};$b.prototype.qQf=function(){var T=this;appChrome.renderTableTotalRowOptions(this.parentElement,$b.ZL,$b.ZL[this.XUi()].toString(),Math.round(Ih.a(this.$).Di(17)),function(pa){dc.ULS.sendTraceTag(537151198,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : {0}",pa);var hb={};hb=(hb.SelectedOption=$b.ZL[pa],hb.FunctionKeyCode=pa,hb.Location="canvas",hb);sh.b(T.$).Rd(Yh.a.SFj,hb,null,!0);if("111"===pa)return T.rci(),!0;if("100"!==pa){T.BJb=T.PJh(pa);if(!T.BJb)return dc.ULS.sendTraceTag(537151197,
0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;T.gRa(T.BJb)}else T.gRa("");se.DOMElementExtensions.setFocus(T.gridView.pc.textBox.domElement);return!0})};$b.prototype.rci=function(){dc.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");var T=new id.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ka.Wb(T)};$b.prototype.rva=function(T){if(!T)return null;var pa=this.gridView.tc.textBox.domElement;
var hb=0<se.DOMElementExtensions.getHeight(pa)&&0<se.DOMElementExtensions.getWidth(pa)&&0<=pa.offsetTop&&0<=pa.offsetLeft;if(hb)pa=se.DOMElementExtensions.rva(pa,this.gridView.Lj);else{pa=this.gridView.getCellBounds(T.cell);var Db=se.DOMElementExtensions.getBoundingClientRect(this.gridView.Lj);pa=new Sys.UI.Bounds(pa.x-Db.x,pa.y-Db.y,pa.width,pa.height)}if(pa)if(hb)2<pa.height&&2<pa.height&&(pa.x+=1,pa.y+=1,pa.height-=2,pa.width-=2);else if(hb=zf.g(this.$).SJ(T.cell))hb=hb.width,Db=Pf.a.equals(Wh.a.q3a(T.cell,
this.gridView.rtl),"right",!0),this.gridView.rtl&&Db&&(pa.x=pa.x+pa.width-hb),T.Oka&&this.gridView.rtl===Db&&(pa.width=hb);else return null;return pa};$b.prototype.pPj=function(T){var pa=this.xmb;if(pa){var hb=17>=pa.height?pa.y:pa.y+pa.height-17-2;pa=this.Whi?this.gridView.rtl?pa.x:pa.x+pa.width-(17<pa.height?17:pa.height):this.gridView.rtl?pa.x-(17<pa.height?17:pa.height):pa.x+pa.width;var Db=Ih.a(this.$).Aja(new Sys.UI.Point(pa,hb));this.parentElement.style.top=Ud.HelperMethods.uc(Db.y);this.parentElement.style.left=
Ud.HelperMethods.uc(Db.x);Ih.a(this.$).Qpj(this.parentElement);T&&(this.g5=this.gridView.sic(new jj.a(pa,hb)))}else this.g5=!1};$b.prototype.GLg=function(){this.CKa.insertBefore(this.parentElement,this.CKa.firstChild);this.REf=!0};$b.prototype.lEj=function(){this.UQ||(this.gridView.view.Rs(this.qt),this.UQ=!0)};$b.prototype.Rag=function(){this.UQ&&this.gridView.view&&(this.gridView.view.Xq(this.qt),this.UQ=!1)};$b.prototype.gRa=function(T){var pa=this.gridView.pc,hb=this.gridView.lc(null);hb&&(T=
Object(He.a)(new ii.a,{Text:T}),this.gridView.setCell(T,hb.range,0,127,null),pa.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))};Ck.Object.defineProperties($b.prototype,{g5:{configurable:!0,enumerable:!0,get:function(){return this.qnd},set:function(T){this.qnd!==T&&(this.qnd=this.isVisible=T)}},kAb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Qd&16)}},Whi:{configurable:!0,enumerable:!0,get:function(){var T=this.gridView.ha.ta.activeCell;return T.right===T.maxColumns}},xmb:{configurable:!0,
enumerable:!0,get:function(){var T=this.gridView.lc(null);return T&&this.gridView.r5(T.range)?this.rva(T):(T&&dc.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}}});$b.RFj="TableTotalRowDropDownIconButtonId";$b.ZL=null;Object(Zd.a)($b,"TableTotalRowOptions",Xf.a,[3]);Wl(Ha,Ub);Ha.prototype.pne=function(T){this.addHandler(Ub.RFd,T)};Ha.prototype.FPf=function(T){this.removeHandler(Ub.RFd,T)};Ha.prototype.uDg=function(T){this.addHandler("tce",
T)};Ha.prototype.O9i=function(T){this.removeHandler("tce",T)};Ha.prototype.yqd=function(T){return!!this.c0e(T)};Ha.prototype.nn=function(T){return this.$Th(this.G0e(T))};Ha.prototype.Bub=function(T){return this.G0e(T)};Ha.prototype.H7i=function(T){T?(this.qpb?this.qpb!==T&&(Me.a.Ha(this.V0),this.V0=null,this.qpb=T):this.qpb=T,this.V0||(this.V0=eh.a.instance.je(this.qpb)),this.V0.rn("focusin")||this.V0.ka("focusin",this.onFocus)):dc.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")};
Ha.prototype.Scf=function(T,pa){return T?T.dba&&T.top===pa.top:(dc.ULS.shipAssertTag(537151244,0,!!T,"autofilterRange can't be null"),!1)};Ha.prototype.vva=function(T){T=this.opb?Ff.I(T,this.opb):this.view.getRangeInformation(T);return 0<T.length&&Object(vd.a)(rh.PivotTableRange,T[0])?T[0]:null};Ha.prototype.Gei=function(T,pa){return T?!T.Zfc&&!!T.lM&&T.lM.Ed(pa):(dc.ULS.shipAssertTag(537151243,0,!!T,"Pivot table can't be null"),!1)};Ha.prototype.zki=function(T,pa){return T?!T.Zfc&&!!T.dX&&T.dX.Ed(pa):
(dc.ULS.shipAssertTag(537151242,0,!!T,"Pivot table can't be null"),!1)};Ha.prototype.OYb=function(T){Ub.prototype.OYb.call(this,T);if((T=Ud.HelperMethods.n0e(T))&&0<T.length){this.opb=Array(T.length);for(var pa=0;pa<T.length;pa++)this.opb[pa]=oc.a.JQ(T[pa])}};Ha.prototype.tHb=function(){Ub.prototype.tHb.call(this);this.opb=null};Ha.prototype.e3g=function(T,pa){return this.VBe(T,pa).returnValue};Ha.prototype.VBe=function(T,pa){var hb=this;var Db=!1;if(!T||!pa)return{returnValue:!1,GY:Db};T=T.clone();
T.right+=1;T.left=T.right;if(!T.isValidRange)return{returnValue:!1,GY:Db};if(T.top<pa.rb.Yi){var rc=T.clone();rc.bottom>=pa.rb.Yi&&(rc.bottom=pa.rb.Yi-1);if(!function(){var Uc=hb.UBe(rc,pa);Db=Uc.GY;return Uc}().returnValue)return{returnValue:!1,GY:Db}}if(T.bottom>=pa.rb.Yi){var vb=T.clone();vb.top<=pa.rb.Yi&&(vb.top=pa.rb.Yi);if(!function(){var Uc=hb.UBe(vb,pa);Db=Uc.GY;return Uc}().returnValue)return{returnValue:!1,GY:Db}}return{returnValue:!0,GY:Db}};Ha.prototype.i7f=function(T){(T=this.nn(T.topLeft))&&
T.toString()in this.oFa&&(this.oFa[T.toString()].$pd=!1)};Ha.prototype.D1i=function(){this.raiseEvent("tce")};Ha.prototype.Xh=function(T,pa){if(!this.nzc)return!1;switch(pa){case -569786022:case 541421805:if(this.nzc.g5){var hb=document.getElementById($b.RFj);hb&&Na.a.instance.create(function(){se.DOMElementExtensions.Wec(hb,null)},0,kb.a.LFj,!0,!0)}return!0;default:return!1}};Ha.prototype.dispose=function(){this.g2b(null,null);this.FPf(this.f0b);this.$.xa.Wg(this.yKf);this.$.tm(this.g2b);this.cQb=
null;this.$.ea&&this.$.ea.q0(this.j6);this.gridView.ha.aO(this.Sh);this.nzc=null;$e.EwaSettings.ma(410)&&this.V0&&(Me.a.Ha(this.V0),this.V0=null);Ub.prototype.dispose.call(this)};Ha.prototype.Z2h=function(T,pa,hb,Db){var rc=this.gridView.Nb.rj(new Se.Range(pa,hb,pa,hb,!1,!1));if(this.r5b=rc){var vb=rc.usedRange,Uc=T.ctrlKey||ya.a.isMac&&Gc.b(T),Td=!T.shiftKey&&Uc;T=T.shiftKey&&!Uc;$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(zf.g(this.$).ha.selectionType=3);switch(Db){case 0:this.yRb=
0;$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(pa=this.a4c(T,vb.top,hb,vb.bottom,hb),this.NOd(pa,Td,T)):this.OOd(vb.top,hb,vb.bottom,hb,cg.d(rc),cg.g(rc),Td);break;case 1:this.yRb=1;$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(pa=this.a4c(T,pa,vb.left,pa,vb.right),this.NOd(pa,Td,T)):this.OOd(pa,vb.left,pa,vb.right,!1,!1,Td);break;case 2:this.yRb=2;$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(pa=this.a4c(T,vb.top,vb.left,vb.bottom,vb.right),this.NOd(pa,Td,T)):this.OOd(vb.top,vb.left,vb.bottom,vb.right,cg.d(rc),cg.g(rc),Td);break;default:dc.ULS.shipAssertTag(537151240,0,!1,"TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: {0}",Db.toString());return}$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(zf.g(this.$).ha.selectionType=3);dc.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else dc.ULS.shipAssertTag(537151241,
0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")};Ha.prototype.uuj=function(T){var pa=this.r5b.usedRange;return this.$ef(T)||1!==this.UHa&&this.$ef(new Se.Range(pa.top,T.left,pa.bottom,T.right,!1,!1))?!0:!1};Ha.prototype.QFd=function(T){return T.Autofilters};Ha.prototype.UBe=function(T,pa){var hb=!1;var Db=pa.rb.qj(T),rc=pa.Uf(Db).Gh;if(!rc)return dc.ULS.sendTraceTag(537151238,0,15,"TableManager.CouldExpandImpl - loadedRange is null. PaneType={0}",
Db),{returnValue:!1,GY:hb};if(!rc.Se(T))return{returnValue:!0,GY:hb};T=pa.xk("TableManager.CouldExpandImpl",T,2);try{for(;T.$$mn();){if(T.$$cu().text||T.Mn.f6e)return hb=!0,{returnValue:!1,GY:hb};if(T.$$cu().hF)return{returnValue:!1,GY:hb}}}finally{T&&T.dispose()}return{returnValue:!0,GY:hb}};Ha.prototype.$Th=function(T){if(!T)return null;var pa=new vf.AutofilterRange(T.top,T.left,T.bottom,T.right,null,null,null,T.id,T.dba);pa.coa=T.coa;if($e.EwaSettings.isChangeGateEnabled("OfficeVSO:6424701_fixIssueWithTheGrippieButton")){var hb=
this.gridView.Nb.rj(T,!0);if(!hb)return null;for(var Db=0,rc=this.rangeList.length;Db<rc;Db++){var vb=this.rangeList[Db],Uc=this.gridView.Nb.rj(vb,!0);Uc&&Uc.name===hb.name&&vb!==T&&this.dff(vb)&&(pa.union(vb),vb.coa&&(pa.coa=!0))}}else for(hb=0,Db=this.rangeList.length;hb<Db;hb++)rc=this.rangeList[hb],rc.id===T.id&&rc!==T&&this.dff(rc)&&(pa.union(rc),rc.coa&&(pa.coa=!0));return pa};Ha.prototype.dff=function(T){return!!zf.g(this.$).Nb.rj(T)};Ha.prototype.UGh=function(){for(var T=[],pa=Gl(this.rangeList),
hb=pa.next();!hb.done;hb=pa.next())hb=new lh.a(this.nn(hb.value.topLeft),Rc.d(this.$.qa)),T.push(hb);return T};Ha.prototype.Dfd=function(){for(var T={},pa=Gl(this.rangeList),hb=pa.next();!hb.done;hb=pa.next())if(hb=hb.value){var Db=this.nn(hb.topLeft);Db&&(T[Db.toString()]=this.nn(hb.topLeft))}return T};Ha.prototype.xri=function(){this.$.ea.sh?this.Rxb(0):this.$.ea.Fl(this.sN)};Ha.prototype.Rxb=function(T){var pa=this;this.$.LC(function(hb){hb.Yua(T).then(pa.dGb)})};Ha.prototype.wXh=function(T){var pa=
this.gridView.Nb.rj(T);return pa?pa.name:T.toString()};Ha.prototype.OOd=function(T,pa,hb,Db,rc,vb,Uc){var Td=T+(rc?1:0),mf=hb-(vb?1:0),bg=this.gridView.inRangePicker||this.gridView.Li,qg=!1,Kg=new Se.Range(Td,pa,mf,Db,!1,!1);if(rc||vb)for(rc=bg?lh.a.jrb(this.gridView.ha.rangePicker.DK):this.gridView.ha.ta.selectedRanges,rc=Gl(rc),vb=rc.next();!vb.done;vb=rc.next()){vb=vb.value;qg=this.sqb(vb,Td,pa,mf,Db);var di=this.sqb(vb,T,pa,hb,Db);if(bg&&qg)break;if(!bg&&(qg||di)){this.gridView.ha.updateSelection(vb,
vb.topLeft,0,1);if(Uc&&di)return;break}}qg&&(Kg.top=T,Kg.bottom=hb);T=Kg.topLeft;Uc?this.gridView.ha.updateSelection(Kg,T,0,1):bg?this.gridView.ha.GB([Kg],0,T,0):this.gridView.ha.updateSelection(Kg,T,0,3)};Ha.prototype.NOd=function(T,pa,hb){T&&(hb=hb?zf.g(this.$).ha.ta.activeCell:T.topLeft,pa?this.gridView.ha.updateSelection(T,hb,0,1):this.gridView.ha.GB([T],0,hb,0))};Ha.prototype.a4c=function(T,pa,hb,Db,rc){var vb=cg.d(this.r5b),Uc=cg.g(this.r5b),Td=pa+(1!==this.UHa&&vb?1:0),mf=Db-(1!==this.UHa&&
Uc?1:0),bg=this.gridView.inRangePicker||this.gridView.Li;if(T){var qg=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&bg&&!lh.a.jrb(this.gridView.ha.rangePicker.DK).length?new Se.Range(Td,hb,mf,rc,!1,!1):bg?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.ta.activeCell;qg=new Se.Range(qg.top<Td?qg.top:Td,qg.left<hb?qg.left:hb,qg.bottom>mf?qg.bottom:mf,qg.right>rc?qg.right:rc,!1,!1)}else qg=new Se.Range(Td,hb,mf,rc,!1,!1);if(1!==this.UHa&&(vb||Uc)&&(!T||T&&this.sqb(qg,
Td,hb,mf,rc)))for(T=bg?lh.a.jrb(this.gridView.ha.rangePicker.DK):this.gridView.ha.ta.selectedRanges,T=Gl(T),vb=T.next();!vb.done;vb=T.next())if(this.sqb(vb.value,Td,hb,mf,rc)){qg.top=pa;qg.bottom=Db;break}return qg};Ha.prototype.$ef=function(T){var pa=this.gridView.inRangePicker||this.gridView.Li?lh.a.jrb(this.gridView.ha.rangePicker.DK):this.gridView.ha.ta.selectedRanges;pa=Gl(pa);for(var hb=pa.next();!hb.done;hb=pa.next())if(this.sqb(hb.value,T.top,T.left,T.bottom,T.right))return!0;return!1};Ha.prototype.sqb=
function(T,pa,hb,Db,rc){return!!T&&T.top===pa&&T.bottom===Db&&T.left===hb&&T.right===rc};Ck.Object.defineProperties(Ha.prototype,{oFa:{configurable:!0,enumerable:!0,get:function(){return this.cQb}},Ird:{configurable:!0,enumerable:!0,get:function(){return this.P9d}},UHa:{configurable:!0,enumerable:!0,get:function(){return this.yRb}},Eg:{configurable:!0,enumerable:!0,get:function(){var T=zf.g(this.$);return T.Nb.rj(T.ha.ta.activeCell,!1)}},AEd:{configurable:!0,enumerable:!0,get:function(){return this.Ird?
zf.g(this.$).Nb.rj(this.Ird,!1):null}}});Object(Zd.a)(Ha,"TableManager",Ub,[889,3]);var Ga=Jf.a;Wl(lb,Ga);lb.prototype.create=function(){this.Eb(this.tableManager||(this.tableManager=new Ha(this.$)))};Object(Zd.a)(lb,"TableManagerFactory",Jf.a,[]);var Kb=b(113),qc=b(1022),Wc=b(1478),Dc=b(932),de=b(1429),ye=b(83),Gf=b(111),jf=b(28),Hf=b(198),Df=b(30),Rf=b(293);Object(Zd.a)(cb,"TableStyleElement",null,[]);var Of=b(958),Ig=b(214),Sh=b(89),Fh=b(588);Qa.tmf=function(T,pa){return Qa.l7f[T.Type]-Qa.l7f[pa.Type]};
Qa.G3a=function(T,pa){try{return appChrome.buildTableStyleGalleryIconNew(Qa.UAa,Qa.moa,T,pa)}catch(hb){return null}};Qa.Cgf=function(T){return T&&dd.a.kd in T&&(T=T[dd.a.kd])?Pf.a.fL(T,ae.a.mGb):!1};Qa.ita=function(T){var pa=[],hb=0;T=Gl(T);for(var Db=T.next();!Db.done;Db=T.next()){Db=Db.value;pa[hb]={};pa[hb].backgroundColor="white";pa[hb].color="black";for(var rc in Db){var vb=Db[rc];switch(rc){case "background-color":pa[hb].backgroundColor=vb;break;case "color":pa[hb].color=vb;break;case "font-size":pa[hb].fontSize=
vb;break;case "border-bottom":pa[hb].borderBottom=vb;break;case "border-right":pa[hb].borderRight=vb;break;case "border-left":pa[hb].borderLeft=vb;break;case "border-top":pa[hb].borderTop=vb}}hb++}return pa};Qa.S3b=function(T,pa){var hb=[];if(null===T||void 0===T?0:T.TableStyleElementsList)for(var Db=0===T.Category,rc=0;rc<Qa.moa;rc++)hb.push.apply(hb,Qa.MKh(T,pa,Db,rc));else{if(Qa.z5c)return Qa.z5c;T={color:"black","background-color":"white"};for(pa=0;pa<Qa.moa;pa++)for(Db=0;Db<Qa.UAa;Db++)hb.push(T);
Qa.z5c=hb}return hb};Qa.xXh=function(T,pa){if(!T.TableStyleElementsList)return"";var hb="";T=Gl(T.TableStyleElementsList);for(var Db=T.next();!Db.done;Db=T.next())if(Db=Db.value,Db.BackgroundColor&&"#000000"!==Db.BackgroundColor)switch(Db.Type){case 0:hb=Db.BackgroundColor;break;case 5:case 7:if(pa.Rha||pa.gS)hb=Db.BackgroundColor;break;case 3:case 4:if(pa.firstCol||pa.lastCol)hb=Db.BackgroundColor;break;case 2:pa.totalRow&&(hb=Db.BackgroundColor);break;case 1:pa.headerRow&&(hb=Db.BackgroundColor)}return hb};
Qa.Q2b=function(T){T=new Ig.a(parseInt(String("0x"+T.substr(1,2)),16),parseInt(String("0x"+T.substr(3,2)),16),parseInt(String("0x"+T.substr(5,2)),16));return Of.a.fKa(T)};Qa.m2e=function(T,pa){if(!T||!pa)return"";pa=(pa=Qa.xXh(T,pa))?Qa.Q2b(pa)+", ":Le.a.instance.ga(2035)+", ";switch(T.Index){case 0:return pa+Le.a.instance.ga(1969);case 1:return pa+Le.a.instance.ga(1970);case 2:return pa+Le.a.instance.ga(1971);case 3:return pa+Le.a.instance.ga(1972);case 4:return pa+Le.a.instance.ga(1973);case 5:return pa+
Le.a.instance.ga(1974);case 6:return pa+Le.a.instance.ga(1975);case 7:return pa+Le.a.instance.ga(1976);case 8:return pa+Le.a.instance.ga(1977);case 9:return pa+Le.a.instance.ga(1978);case 10:return pa+Le.a.instance.ga(1979);case 11:return pa+Le.a.instance.ga(1980);case 12:return pa+Le.a.instance.ga(1981);case 13:return pa+Le.a.instance.ga(1982);case 14:return pa+Le.a.instance.ga(1983);case 15:return pa+Le.a.instance.ga(1984);case 16:return pa+Le.a.instance.ga(1985);case 17:return pa+Le.a.instance.ga(1986);
case 18:return pa+Le.a.instance.ga(1987);case 19:return pa+Le.a.instance.ga(1988);case 20:return pa+Le.a.instance.ga(1989);case 21:return pa+Le.a.instance.ga(1990);case 22:return pa+Le.a.instance.ga(1991);case 23:return pa+Le.a.instance.ga(1992);case 24:return pa+Le.a.instance.ga(1993);case 25:return pa+Le.a.instance.ga(1994);case 26:return pa+Le.a.instance.ga(1995);case 27:return pa+Le.a.instance.ga(1996);case 28:return pa+Le.a.instance.ga(1997);case 29:return pa+Le.a.instance.ga(1998);case 30:return pa+
Le.a.instance.ga(1999);case 31:return pa+Le.a.instance.ga(2E3);case 32:return pa+Le.a.instance.ga(2001);case 33:return pa+Le.a.instance.ga(2002);case 34:return pa+Le.a.instance.ga(2003);case 35:return pa+Le.a.instance.ga(2004);case 36:return pa+Le.a.instance.ga(2005);case 37:return pa+Le.a.instance.ga(2006);case 38:return pa+Le.a.instance.ga(2007);case 39:return pa+Le.a.instance.ga(2008);case 40:return pa+Le.a.instance.ga(2009);case 41:return pa+Le.a.instance.ga(2010);case 42:return pa+Le.a.instance.ga(2011);
case 43:return pa+Le.a.instance.ga(2012);case 44:return pa+Le.a.instance.ga(2013);case 45:return pa+Le.a.instance.ga(2014);case 46:return pa+Le.a.instance.ga(2015);case 47:return pa+Le.a.instance.ga(2016);case 48:return pa+Le.a.instance.ga(2017);case 49:return pa+Le.a.instance.ga(2018);case 50:return pa+Le.a.instance.ga(2019);case 51:return pa+Le.a.instance.ga(2020);case 52:return pa+Le.a.instance.ga(2021);case 53:return pa+Le.a.instance.ga(2022);case 54:return pa+Le.a.instance.ga(2023);case 55:return pa+
Le.a.instance.ga(2024);case 56:return pa+Le.a.instance.ga(2025);case 57:return pa+Le.a.instance.ga(2026);case 58:return pa+Le.a.instance.ga(2027);case 59:return pa+Le.a.instance.ga(2028);default:return T.Name?T.Name:""}};Qa.HRh=function(T){return(T+1)%Qa.p6h};Qa.bwb=function(T,pa,hb){hb=void 0===hb?"":hb;return T||!hb?String.format("{0}, {1}, -version, {2}",Qa.p8e,T.Index.toString(),pa.toString()):String.format("{0}, {1}, -version, {2}",Qa.p8e,hb,pa.toString())};Qa.MKh=function(T,pa,hb,Db){for(var rc=
[],vb=0;vb<Qa.UAa;vb++)rc.push(Qa.bdd(T,pa,hb,Db,vb));return rc};Qa.bdd=function(T,pa,hb,Db,rc){var vb=T.TableStyleElementsList;T=new cb;var Uc={};if(!vb)return Uc;for(var Td=Gl(vb),mf=Td.next();!mf.done;mf=Td.next())if(mf=mf.value,0===mf.Type){T=mf;break}Td=!!T.BackgroundColor;var bg="";!hb&&T.TableStyleBorderFromatList&&0<T.TableStyleBorderFromatList.length&&(bg=T.TableStyleBorderFromatList[0].Color);Uc["background-color"]=Td?T.BackgroundColor:"#FFFFFF";T.FontColor||(T.FontColor="#000000");Uc.color=
T.FontColor;Qa.$we(Db,rc,Uc,T,bg,hb,Td);vb=Gl(vb);for(mf=vb.next();!mf.done;mf=vb.next())(mf=mf.value)&&0!==mf.Type&&(2!==mf.Type||Td||(mf.BackgroundColor=T.BackgroundColor),Qa.sqd(mf,Db,rc,pa)&&(mf.BackgroundColor&&(Uc["background-color"]=mf.BackgroundColor),Uc.color=mf.FontColor||T.FontColor,Qa.$we(Db,rc,Uc,mf,bg,hb,Td)));return Uc};Qa.sV=function(T,pa,hb,Db,rc,vb){hb&&(hb.Color&&!hb.Style&&(hb.Style=1),hb.Style&&!hb.Color&&(hb.Color=rc?"#000000":Db?Db:vb?"#FFFFFF":"#000000"),pa[Qa.borders[T]]=
"1px "+Qa.dW[hb.Style]+" "+hb.Color)};Qa.sqd=function(T,pa,hb,Db){return-1===T.Type?!1:Qa.tqd(T,pa,hb,Db)||Qa.Gli(T,pa,hb,Db)||Qa.uqd(T,pa,hb,Db)};Qa.Gli=function(T,pa,hb,Db){return!pa&&Db.headerRow||pa===Qa.moa-1&&Db.totalRow?!1:1===pa%2&&5===T.Type&&Db.gS&&Db.headerRow||1<pa&&!!((pa-1)%(T.BandSize+1))&&6===T.Type&&Db.gS&&Db.headerRow||!(pa%2)&&5===T.Type&&Db.gS&&!Db.headerRow||!!(pa%(T.BandSize+1))&&6===T.Type&&Db.gS&&!Db.headerRow||!(hb%2)&&7===T.Type&&Db.Rha||!!(hb%(T.BandSize+1))&&8===T.Type&&
Db.Rha};Qa.uqd=function(T,pa,hb,Db){return pa===Qa.moa-1&&2===T.Type&&Db.totalRow||hb===Qa.UAa-1&&pa===Qa.moa-1&&12===T.Type&&Db.totalRow&&Db.lastCol||!hb&&pa===Qa.moa-1&&11===T.Type&&Db.totalRow&&Db.firstCol||hb===Qa.UAa-1&&4===T.Type&&Db.lastCol};Qa.tqd=function(T,pa,hb,Db){return!pa&&1===T.Type&&Db.headerRow||!hb&&3===T.Type&&Db.firstCol||!hb&&!pa&&9===T.Type&&Db.headerRow&&Db.firstCol||hb===Qa.UAa-1&&!pa&&10===T.Type&&Db.headerRow&&Db.lastCol};Qa.$we=function(T,pa,hb,Db,rc,vb,Uc){if(Db.TableStyleBorderFromatList)for(var Td=
Gl(Db.TableStyleBorderFromatList),mf=Td.next();!mf.done;mf=Td.next())if(mf=mf.value,mf.Style)switch(mf.Position){case 0:T&&12!==Db.Type&&11!==Db.Type&&2!==Db.Type&&5!==Db.Type&&6!==Db.Type||Qa.sV(0,hb,mf,rc,vb,Uc);break;case 1:T!==Qa.moa-1&&1!==Db.Type&&10!==Db.Type&&9!==Db.Type&&5!==Db.Type&&6!==Db.Type||Qa.sV(1,hb,mf,rc,vb,Uc);break;case 2:pa&&12!==Db.Type&&10!==Db.Type&&7!==Db.Type&&8!==Db.Type&&4!==Db.Type||Qa.sV(2,hb,mf,rc,vb,Uc);break;case 3:pa!==Qa.UAa-1&&9!==Db.Type&&11!==Db.Type&&3!==Db.Type&&
7!==Db.Type&&8!==Db.Type||Qa.sV(3,hb,mf,rc,vb,Uc);break;case 5:pa!==Qa.UAa-1&&3!==Db.Type&&4!==Db.Type&&7!==Db.Type&&8!==Db.Type&&Qa.sV(3,hb,mf,rc,vb,Uc);break;case 6:T!==Qa.moa-1&&2!==Db.Type&&1!==Db.Type&&5!==Db.Type&&6!==Db.Type&&Qa.sV(1,hb,mf,rc,vb,Uc)}};Qa.AXh=function(){var T=Array(12);T[0]=0;T[7]=1;T[8]=2;T[5]=3;T[6]=4;T[4]=5;T[3]=6;T[1]=7;T[2]=8;T[9]=9;T[10]=10;T[11]=11;T[12]=13;return T};Qa.moa=5;Qa.UAa=5;Qa.p6h=5;Qa.p8e="TableStyleIcon";Qa.dW=[null,Sh.a.solid,Sh.a.dashed,Sh.a.dotted,Sh.a.dashed,
Sh.a.dotted,Sh.a.dashed,Sh.a.double];Qa.borders=[Fh.a.borderTop,Fh.a.borderBottom,Fh.a.borderLeft,Fh.a.borderRight];Qa.l7f=Qa.AXh();Qa.z5c=null;Object(Zd.a)(Qa,"TableStyleHelper",null,[]);Ib.prototype.equals=function(T){return T?this.headerRow===T.headerRow&&this.totalRow===T.totalRow&&this.firstCol===T.firstCol&&this.lastCol===T.lastCol&&this.Rha===T.Rha&&this.gS===T.gS:!1};Object(Zd.a)(Ib,"TableStyleOptions",null,[]);var zg=b(999),ki=Xe.a;Wl(yb,ki);yb.prototype.w5e=function(T){var pa=this.tableManager.Eg;
if(!pa)return!1;T=T[dd.a.kd];if(!T)return!1;switch(Number.parseInvariant(T)){case 0:return cg.d(pa);case 1:return cg.c(pa);case 2:return cg.g(pa);case 3:return cg.e(pa);case 4:return cg.f(pa);case 5:return cg.b(pa);case 6:return pa.hasAutoFilter}return!1};yb.prototype.rGf=function(T,pa){if(Kb.a.isEmpty(this.aG))return!0;if("PopulateTableMoreStylesMenu"!==T&&"PopulateTableAccessibleStylesMenu"!==T)return!1;if($e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)&&
"PopulateTableAccessibleStylesMenu"===T&&!this.Nyc)return this.nMb||(this.nMb=!0,this.uKa("accessibilityTab")),!0;this.gAb=!0;var hb=this.Ta.Cq("TableStylesMenu"),Db=this.Ta.uC("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),rc=this.Ta.uC("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),vb=this.Ta.uC("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),Uc=this.Ta.uC("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48"),Td=-123538519;if(pa.MenuId)if(Pf.a.contains(pa.MenuId,
"FormatAsTable",!0))Td=753331043,this.a6a=!0;else{var mf=Le.a.instance.ga(1968);var bg=Qa.bwb(null,1,"-1");$e.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?Uc.Kt("-1",Td,"QueryTableStyle",0,"-1",bg,void 0,void 0,mf):Uc.Kt("-1",Td,"QueryTableStyle",0,"-1",void 0,void 0,void 0,mf);this.a6a=!1}bg=0;var qg=this.aG,Kg;for(Kg in qg){var di=qg[Kg];if(!$e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)||"PopulateTableAccessibleStylesMenu"!==
T||!di.HasStyleViolations){mf=Qa.m2e(di,this.Uub());var Bh=Qa.bwb(di,this.LHa);if(di)switch(di.Category){case 0:Db.Kt(di.Index.toString(),Td,"QueryTableStyle",0,di.Index.toString(),Bh,void 0,void 0,mf);bg++;break;case 3:rc.Kt(di.Index.toString(),Td,"QueryTableStyle",0,di.Index.toString(),Bh,void 0,void 0,mf);break;case 2:vb.Kt(di.Index.toString(),Td,"QueryTableStyle",0,di.Index.toString(),Bh,void 0,void 0,mf);break;case 1:Uc.Kt(di.Index.toString(),Td,"QueryTableStyle",0,di.Index.toString(),Bh,void 0,
void 0,mf)}}}0<bg&&this.B2(hb,Db,1936);this.B2(hb,Uc,1937);this.B2(hb,vb,1938);this.B2(hb,rc,1939);pa.MenuItems=hb.jE();this.isInitialized||(this.isInitialized=!0);return!0};yb.prototype.hid=function(T){var pa=this;T[qc.a.On]=!1;var hb=T[dd.a.kd];if(hb&&!Kb.a.isEmpty(this.aG)){Pf.a.contains(T.ParentMenuId,"FormatAsTable",!0)?this.a6a=!0:this.a6a=!1;this.a6a||this.Bbg();Qa.Cgf(T)&&(hb=this.ovb(hb).toString());var Db=this.Uub();T[qc.a.Alt]="-1"===hb?Le.a.instance.ga(1968):Qa.m2e(this.sgd(hb),Db);if(hb in
this.JSa&&Db.equals(this.dZc))this.tGf(T,hb,Db,!0);else{if(!this.Drc||this.Drc&&!this.Drc.yo)this.Ema={},this.Drc=Na.a.instance.create(function(){pa.MMf();pa.dZc=pa.Uub()},0,kb.a.QFj,!0,!0);this.uDd(Db,T,hb)}}};yb.prototype.getTableStyleIndexFromName=function(T){if(!T||Kb.a.isEmpty(this.aG))return-1;if(T in this.aG)return this.aG[T].Index;this.uKa("getTableStyleIndexFromName");return-1};yb.prototype.aic=function(){return!!this.hL};yb.prototype.ovb=function(T){this.VN||this.IYc();return T in this.VN?
this.VN[T]:-1};yb.prototype.uKa=function(T){if(this.$.isEditMode)if($e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)){var pa=new Date;if(30<Gf.getElapsedSeconds(this.lastSyncTime,pa)||Kb.a.isEmpty(this.aG)||this.nMb){var hb=this.$.na.va.hc();this.lastSyncTime=pa;T=this.nMb&&"accessibilityTab"===T||"galleryMenuClosed"===T;ye.s(this.$.na.va,T,this.Zwf,this.Tzd,null,T?"accessibility":"normal",hb)}}else if(hb=new Date,30<Gf.getElapsedSeconds(this.lastSyncTime,hb)||
Kb.a.isEmpty(this.aG))T=this.$.na.va.hc(),this.lastSyncTime=hb,ye.r(this.$.na.va,this.Zwf,this.Tzd,null,null,T)};yb.prototype.dispose=function(){this.VN=this.JSa=this.hL=this.aG=null;this.$.Ka.XHb(this.yCf);ki.prototype.dispose.call(this)};yb.prototype.aGg=function(T){this.addHandler("RefreshTableStyleGallery",T)};yb.prototype.Uaj=function(T){this.removeHandler("RefreshTableStyleGallery",T)};yb.prototype.IYc=function(){var T={};this.tableManager.Eg&&(this.Fda=this.getTableStyleIndexFromName(this.tableManager.Eg.lzc));
for(var pa=1;7>=pa;pa++)T["preview"+pa]=this.KQh(pa);this.VN=T};yb.prototype.KQh=function(T){var pa=this.hL.TableStyleItems.length;pa=4>=this.Fda?this.Fda+T-1:4<this.Fda&&this.Fda<pa-4?4===T?this.Fda:Math.floor(this.Fda+T-4):this.Fda+T-1;-1===pa||pa.toString()in this.JSa||(pa=T-3);return pa};yb.prototype.Bbg=function(){if(this.tableManager.Eg){var T=!1,pa=this.getTableStyleIndexFromName(this.tableManager.Eg.lzc);if(pa!==this.Fda){if(this.VN){var hb=this.VN,Db;for(Db in hb)hb[Db]===pa&&(T=!0)}this.Fda=
pa;T||Kb.a.isEmpty(this.JSa)||this.IYc()}}};yb.prototype.B2=function(T,pa,hb){var Db=this.Ta.Pc();Db.Yp="Thin";Db.title=Le.a.instance.ga(hb);Db.buttons.push(pa);T.Ec.push(Db)};yb.prototype.Uub=function(){var T=this.tableManager.Eg;return this.a6a||!T?new Ib(!0,!1,!1,!1,!0,!1):new Ib(cg.d(T),cg.g(T),cg.c(T),cg.e(T),cg.f(T),cg.b(T))};yb.prototype.MMf=function(T){T=void 0===T?!1:T;var pa={},hb={},Db=this.Uub();if(!Kb.a.isEmpty(this.aG)&&(this.tableManager.Eg&&this.Bbg(),!Db.equals(this.dZc)||T||Kb.a.isEmpty(this.JSa))){this.LHa=
Qa.HRh(this.LHa);T=this.aG;for(var rc in T){var vb=T[rc],Uc=Qa.bwb(vb,this.LHa);pa[vb.Index.toString()]=Qa.G3a(Qa.ita(Qa.S3b(vb,Db)),Uc);hb[Uc]=pa[vb.Index.toString()];this.lHb(hb)}rc=Qa.bwb(null,this.LHa,"-1");pa["-1"]=Qa.G3a(Qa.ita(Qa.S3b(null,Db)),rc);hb[rc]=pa["-1"];this.lHb(hb);Hf.c(this.JSa,pa,!1)}};yb.prototype.Wli=function(){var T=Xb.a(this.$);return T?T.Wl.FB===ae.a.qza:!1};yb.prototype.uDd=function(T,pa,hb){Number.parseInvariant(hb);"-1"===hb&&Pf.a.contains(pa.ParentMenuId,"FormatAsTable",
!0)||this.tGf(pa,hb,T,!1)};yb.prototype.tGf=function(T,pa,hb,Db){var rc=Qa.bwb(null,this.LHa,pa);Qa.Cgf(T)?(rc in this.Ema?hb=this.Ema[rc]:(hb=Qa.ita(Qa.S3b(this.sgd(pa),hb)),this.Ema[rc]=hb),T[qc.a.GalleryButtonProps]=Object(He.a)(new Wc.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:rc,Alt:T[qc.a.Alt],MenuItemId:pa,TableCellStyles:hb,TableStyles:this.PZi})):(T[Dc.a.Icon]=rc,T[qc.a.GalleryButtonProps]=Object(He.a)(new de.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:rc,Alt:T[qc.a.Alt],
MenuItemId:pa}),Db||(Db=[],this.sgd(pa),"-1"===pa||Pf.a.contains(T.ParentMenuId,"FormatAsTable",!0)||(Db=Qa.S3b(this.hL.TableStyleItems[Number.parseInvariant(pa)],hb)),this.JSa[pa]=Qa.G3a(Qa.ita(Db),rc)))};yb.prototype.lHb=function(T){var pa=this;if(this.gAb)this.Euc=function(){pa.lHb(T)};else{this.Euc=null;var hb=[],Db;for(Db in T){var rc=Db;rc in this.mHb?hb.push(rc):this.mHb[rc]=!0}try{0<hb.length&&appChrome.api.unregisterIcons(hb),Kb.a.isEmpty(T)||appChrome.api.registerIconProvider(function(){return T})}catch(vb){}}};
yb.prototype.sgd=function(T){T=Number.parseInvariant(T);if(-1===T||!this.hL)return null;if(60<T)for(var pa=60;pa<this.hL.TableStyleItems.length;++pa){var hb=this.hL.TableStyleItems[pa];if(hb.Index===T)return hb}return this.hL.TableStyleItems[T]};Object(Zd.a)(yb,"TableStyleManager",Xe.a,[885,3]);var Hi=Jf.a;Wl(Xa,Hi);Xa.prototype.create=function(){var T=this,pa=qb.GetServiceTaskFactory.create(this.$.da,102,this.la,this.vb),hb=qb.GetServiceTaskFactory.Xa(this.$.da,66,134,this.vb);jc.TaskExtensions.Ba(Od.Task.WAA(pa,
hb),function(){T.Eb(T.tableStyleManager||(T.tableStyleManager=new yb(T.$,pa.result,hb.result)))},this.$.la,8)};Object(Zd.a)(Xa,"TableStyleManagerFactory",Jf.a,[]);var ug=b(903),wi=b(55);bb.prototype.oV=function(){return this.autoFilterOptions};Object(Zd.a)(bb,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[450]);Ua.prototype.oV=function(){return this.autoFilterOptions};Object(Zd.a)(Ua,"MacroRecorderRangeItemFilteredPayload",null,[450]);var Fa=b(1133),na=b(386),Gb=b(175),Vd=b(186),ge=b(292);
Object(Zd.a)(ja,"MacroRecorderTableStyleAppliedPayload",null,[450]);Wl(wa,ja);Object(Zd.a)(wa,"MacroRecorderRangeFormatedAsTablePayload",ja,[]);Za.prototype.nn=function(){return this.tableRange};Za.prototype.getTitle=function(){return this.title};Za.prototype.getDescription=function(){return this.description};Object(Zd.a)(Za,"MacroRecorderTableAltTextEditedPayload",null,[450]);Object(Zd.a)(ub,"MacroRecorderTableRenamedPayload",null,[450]);Object(Zd.a)(ad,"MacroRecorderTableResizedPayload",null,[450]);
Object(Zd.a)(vc,"MacroRecorderTableStyleOptionToggledPayload",null,[450]);Object(Zd.a)(zb,"MacroRecorderTableConvertedToRangePayload",null,[450]);sc.prototype.tL=function(){dc.ULS.sendTraceTag(537151186,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken to show Get IsRangeQueryTable is {0} milliseconds",this.Cf.kh.Bc);if(this.dCa&&!Rf.a(this.dCa)){this.Cf.Dzb=this.dCa.Result;if(this.Cf.Dzb)return this.A_d=Df.a.gd(3,2,0,740,0,-66108047,"ConvertToRange"),this.jj=ff.a(this.Cf.$).si(this.A_d).G(),
this.jj.isCompleted||(this._state=2,this.jj.vN(this.moveNext)),this.rDc;this.Cf.EBe();return this.Afb}return this.n1};sc.prototype.n1=function(){this.Cf.kh.stop();dc.ULS.sendTraceTag(537151185,0,50,"ConvertToRangeManager.ShowDialogOld: Total Time taken for complete operation is {0} milliseconds",this.Cf.kh.Bc);this._state=3};sc.prototype.Afb=function(){return this.n1};sc.prototype.rDc=function(){this.B_d=this.jj.rz();dc.ULS.sendTraceTag(537151184,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken for User Input is {0} milliseconds",
this.Cf.kh.Bc);0===this.B_d&&this.Cf.DBe();return this.Afb};sc.prototype.dispose=function(){};Object(Zd.a)(sc,"$$sm_Microsoft$Office$Excel$WebUI$Client$TableOperations$ConvertToRangeManager$ShowDialogOld",null,[3]);var We=b(952);Hb.prototype.y$a=function(){var T=this;this.kh.start();var pa=this.$.na.va.hc();return $e.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?We.h(this.$.na.va,this.sharedSheetRange,function(hb){T.showDialog(hb)},
null,null,null,pa):We.h(this.$.na.va,this.sharedSheetRange,function(hb){T.Ixj(hb)},null,null,null,pa)};Hb.prototype.showDialog=function(T){var pa=this;dc.ULS.sendTraceTag(537151193,0,50,"ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is {0} milliseconds",this.kh.Bc);T&&!Rf.a(T)&&((this.Dzb=T.Result)?(T=Df.a.gd(3,2,0,740,0,-66108047,"ConvertToRange"),jc.TaskExtensions.Ba(ff.a(this.$).si(T),function(hb){dc.ULS.sendTraceTag(537151192,0,50,"ConvertToRangeManager.ShowDialog: Time taken for User Input is {0} milliseconds",
pa.kh.Bc);0===hb.result&&pa.DBe()},this.$.la,11)):this.EBe());this.kh.stop();dc.ULS.sendTraceTag(537151191,0,50,"ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is {0} milliseconds",this.kh.Bc)};Hb.prototype.Ixj=function(T){new sc(this,T)};Hb.prototype.Ote=function(){var T={};T.IsQueryTable=this.Dzb;T.Range=this.sharedSheetRange;return T};Hb.prototype.DBe=function(){var T=this,pa=this.$.na.va;dc.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");
this.kaf(194,function(hb,Db,rc){return We.d(pa,T.Ote(),hb,Db,rc,null)});dc.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")};Hb.prototype.EBe=function(){var T=this,pa=this.$.na.va;dc.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");this.kaf(193,function(hb,Db,rc){return We.c(pa,T.Ote(),hb,Db,rc,null)},function(){return new zb(T.tableName)});dc.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")};Hb.prototype.kaf=
function(T,pa,hb){hb=void 0===hb?null:hb;na.a(this.$.userOperationManager,pa,function(Db){return new Gb.a(T,0,Db,void 0,hb)},null)};Object(Zd.a)(Hb,"ConvertToRangeManager",null,[]);var Vg=b(1287),Qg=b(1286),jg=b(1323),sg=jg.a;Wl(Yb,sg);Yb.prototype.oj=function(){var T=this,pa=Ff.s(this.sC.TableRange);return function(){return new wa(pa,T.H4a.checked,T.WAa,!0)}};Yb.prototype.Zy=function(){var T=this,pa=Ff.s(this.sC.TableRange);return function(hb,Db,rc){return We.g(T.$.na.va,pa,T.H4a.checked,!1,T.sC.HasTotalRow,
T.WAa,hb,Db,rc,null)}};Yb.prototype.ry=function(T,pa,hb){sg.prototype.ry.call(this,T,pa,hb)};Ck.Object.defineProperties(Yb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},Mv:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(Zd.a)(Yb,"FormatAsTableDialogDeprecated",jg.a,[]);var Th=b(1153),Bi=Th.a;Wl(sb,Bi);sb.prototype.oj=function(){var T=this,pa=Ff.s(this.sC.TableRange);return function(){return new wa(pa,T.hasHeaders,T.WAa,!0)}};sb.prototype.Zy=
function(){var T=this,pa=Ff.s(this.sC.TableRange),hb=this.sC.HasTotalRow;return function(Db,rc,vb){return We.g(T.$.na.va,pa,T.hasHeaders,!1,hb,T.WAa,Db,rc,vb,null)}};Ck.Object.defineProperties(sb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},Mv:{configurable:!0,enumerable:!0,get:function(){return 215}},Jm:{configurable:!0,enumerable:!0,get:function(){return Le.a.instance.ga(734)}}});Object(Zd.a)(sb,"FormatAsTableReactDialog",Th.a,[]);var ri=b(387),pi=b(87),
vi=ri.a;Wl(mc,vi);mc.prototype.WEf=function(T){T=T.startsWith("=")?T.substring(1,T.length):T;var pa=Ff.Z(T,this.$.xa);T=pa.sheetName;var hb=pa.range;return pa.returnValue&&hb?(hb=Ff.v(hb,this.$),hb.SheetName=Pf.a.equals(T,"",!0)?this.$.qa.name:T,hb):null};mc.prototype.FM=function(T){var pa={};return pa[mc.X4]="ResizeTableDialog",pa[mc.uKf]=T,pa.getInputErrorIfInvalid=this.pvb,pa};mc.prototype.wed=function(T){T=this.WEf(T);if(!T)return 1;var pa=Ff.D(T);return Pf.a.equals(T.SheetName,this.$.qa.sheetName,
!0)&&this.Yoc.top===pa.top&&this.Yoc.Ed(pa)?0:2};mc.prototype.Obd=function(T){var pa="";switch(T){case 1:pa=Le.a.instance.ga(74);break;case 2:pa=pi.a.gg(Le.a.instance.ga(73))}return pa};mc.prototype.BKj=function(T){var pa={};T=(pa.ResizeTableRange=T,pa.OriginalTableRange=this.Yoc,pa);this.$.Ud(-1400250766,dd.a.Sb,8,T)};Ck.Object.defineProperties(mc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"ResizeTableDialog"}}});mc.X4="id";mc.uKf="range";Object(Zd.a)(mc,"ResizeTableDialog",
ri.a,[]);var jh=ri.a;Wl(Vb,jh);Vb.prototype.FFj=function(T,pa){if(1===T&&(T=pa[Vb.hIj],pa=pa[Vb.Vch],T!==this.WBd||pa!==this.UBd)){var hb={};T=(hb.Title=T,hb.Description=pa,hb);this.$.Ud(868579142,dd.a.Sb,8,T)}};Vb.prototype.FM=function(T,pa){var hb={};return hb.id="AltTextDialog",hb.title=T,hb.description=pa,hb};Ck.Object.defineProperties(Vb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"TableAltTextDialog"}}});Vb.X4="id";Vb.hIj="title";Vb.Vch="description";Object(Zd.a)(Vb,"TableAltTextDialog",
ri.a,[]);var Ng=b(979),ji=b(980),we=b(112),vh=b(66),Ph=b(36);bc.prototype.$c=function(T,pa){switch(pa){case -544558380:return!(this.tableManager&&this.ta.dK()&&!this.WLa()&&cg.d(this.tableManager.Eg));case 1544516694:return!(this.tableManager&&(this.ta.dK()?!this.WLa():this.ta.FLa()));case -697806646:case 323142015:return!this.ta.dK();case 341449783:case 2128797448:return $e.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.ta.dK()?!this.WLa():
this.ta.FLa())):!(this.tableManager&&this.tableManager.yqd(this.ta.activeCell));case -123538519:return!(this.ta.dK()&&this.tableStyleManager&&this.tableStyleManager.aic());case 756677940:return!($e.EwaSettings.ma(410)&&this.Lci());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.Mci());case 844144422:return!this.ta.dK();case -723113214:return!($e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&this.ta.dK())}return!1};
bc.prototype.executeCommand=function(T,pa,hb){var Db=this,rc;T=jc.TaskExtensions.sk();var vb=this.$.na.va,Uc=null,Td=1,mf=pa.command,bg=this.$.na.va.hc(),qg=null;switch(mf){case -2058042992:var Kg=wi.a.ni(hb[dd.a.pg]);bc.rXf(this.$,Kg);Uc=function(Hh,Aj,Kf){return We.a(vb,Kg,null,null,!1,!1,!1,Ng.a.Ava(we.a.tsa,ji.a.clearAutoFilter,Hh),Aj,Kf,null)};Td=176;qg=function(){return new Ua(Kg)};break;case 504133448:case -798968736:case 477776686:var di=wi.a.ni(hb[dd.a.pg]),Bh=hb.TopCellAddress;bc.rXf(this.$,
di);var ak=504133448===pa.command?1:-798968736===pa.command?2:3;if($e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&Bh){hb=this.tableManager.nn(Bh);if(!hb&&$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")){var Kh=this.$.xa.qa;(null===(rc=Ff.D(Kh.J0))||void 0===rc?0:rc.contains(Bh))?hb=Ff.D(Kh.J0):dc.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(!$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||
hb&&!this.$.DWc([hb],!0,1))break}else if(hb&&!this.$.Aq([hb],!0,1))break}Uc=function(Hh,Aj,Kf){return ye.ib(vb,di,ak,ge.b(Hh,Db.hRi),Aj,Kf,Bh,bg)};Td=177;qg=function(){return new bb(di,ak)};break;case 341449783:case 2128797448:this.VQa=341449783===mf?0:2;rc=this.toggleTableStyleOption(vb,bg);Uc=rc.TBa;Td=rc.operationName;qg=rc.oj;break;case -712419744:this.hy?this.W$e(hb[ae.a.event]):this.W$e(null);break;case 1868184698:if($e.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&
(hb=this.a$f(null,bg),rc=hb.vyb,Uc=hb.TBa,qg=hb.oj,rc)){Td=206;break}$e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new Qg.a(this.$):(rc=new Vg.a(this.$),rc.initialize(),rc.Af());break;case 844144422:new mc(this.$);break;case 1544516694:case -544558380:if(rc=hb[dd.a.kd])this.VQa=this.zXh(rc),-1!==this.VQa&&(rc=this.toggleTableStyleOption(vb,bg),Uc=rc.TBa,Td=rc.operationName,qg=rc.oj);break;case 756677940:if(this.WLa()&&this.Uef()){dc.ULS.sendTraceTag(537151177,
0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");break}var Fg=hb.Text,si=this.RPh();if(si){Uc=function(Hh,Aj,Kf){return We.i(vb,Fg,si,ge.b(Hh,Db.gRi),ge.a(Aj,Db.fRi),Kf,bg)};Td=217;var xj=null;this.tableManager.Eg?xj=this.tableManager.Eg.name:this.tableManager.AEd?xj=this.tableManager.AEd.name:dc.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");
xj&&(qg=function(){return new ub(xj,Fg)})}else return dc.ULS.sendTraceTag(537151175,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),Od.Task.Sa(!1);break;case 323142015:if(this.WLa())break;return(new Hb(this.$,this.gcd(),this.tableManager.Eg.name)).y$a();case -1400250766:Td=211;Uc=this.afj(hb,vb,bg);var lj=Ff.m(hb.OriginalTableRange,this.$.xa.qa);qg=function(){return new ad(lj)};break;case 1872288872:this.tableManager.D1i();break;case -123538519:var gk=this.yXh(hb);rc=Pf.a.contains(hb[dd.a.kd],
ae.a.mGb,!0)||Pf.a.contains(hb[ae.a.YF],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";dc.ULS.sendTraceTag(51181323,0,50,"TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from {0} with style index {1}",rc,gk.toString());var zj=this.u1e();zj&&(Uc=function(Hh,Aj,Kf){return We.b(vb,zj,gk,Hh,Aj,Kf,null,bg)},qg=function(){return new ja(zj,gk)},Td=212);break;case 753331043:rc=hb[dd.a.kd];if(!rc)break;var Qj=Number.parseInvariant(rc);if(this.ta.dK()){dc.ULS.sendTraceTag(51181321,
0,50,"TableCommandHandler.FormatAsTable invoked on existing table with style index: {0}",Qj);var Gg=this.u1e();Gg&&(Uc=function(Hh,Aj,Kf){return We.g(vb,Gg,!1,!1,!1,Qj,Hh,Aj,Kf,null,bg)},qg=function(){return new wa(Gg,!1,Qj,!1)},Td=215);break}if($e.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&(Kh=this.a$f(Qj,bg),hb=Kh.vyb,Uc=Kh.TBa,qg=Kh.oj,hb)){Td=215;break}dc.ULS.sendTraceTag(51181322,0,50,"TableCommandHandler.FormatAsTable invoked on newly created table with style index: {0}",
Qj);$e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new sb(this.$,Number.parseInvariant(rc)):(rc=new Yb(this.$,Number.parseInvariant(rc)),rc.initialize(),rc.Af());break;case 71074531:var Xh=hb.HasHeader,rj=hb.TableRange;Uc=function(Hh,Aj,Kf){return We.e(vb,rj,Xh,!1,!1,Hh,Aj,Kf,null)};qg=function(){return new Fa.a(Xh,rj)};Td=206;break;case -723113214:new Vb(this.$);break;case 868579142:dc.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");Td=1022;var mk=
hb.Title,dk=hb.Description,yj=this.gcd();Uc=function(Hh,Aj,Kf){return We.f(vb,mk,dk,yj,Hh,Aj,Kf,null)};if(this.tableManager.Eg){Kh=Pf.a.Fh(this.tableManager.Eg.HSa)?"":this.tableManager.Eg.HSa;var Gi=Pf.a.Fh(this.tableManager.Eg.ISa)?"":this.tableManager.Eg.ISa}qg=mk==Kh?function(){return new Za(yj,void 0,dk)}:dk==Gi?function(){return new Za(yj,mk,void 0)}:function(){return new Za(yj,mk,dk)};break;default:return Vd.a(mf)}if(Uc){var Nh=function(Hh){return new Gb.a(Td,0,Hh,void 0,qg)};T=!this.namedSheetViewPublic||
-2058042992!==mf&&504133448!==mf&&-798968736!==mf&&477776686!==mf?na.a(this.$.userOperationManager,Uc,Nh,pa):this.namedSheetViewPublic.GAa().continueWith(function(Hh){Hh.result&&na.a(Db.$.userOperationManager,Uc,Nh,pa)})}return T};bc.prototype.toggleTableStyleOption=function(T,pa){var hb=this,Db=this.ta.FLa();dc.ULS.sendTraceTag(41996800,0,50,"TableCommandHandler: The selected {0} style option {1} was toggled.",Db?"PivotTable":"table",this.VQa);var rc=this.gcd();return{TBa:function(vb,Uc,Td){return We.k(T,
rc,hb.VQa,ge.b(vb,hb.PRi),Uc,Td,null,pa)},operationName:196,oj:function(){return new vc(rc,hb.VQa,Db)}}};bc.prototype.afj=function(T,pa,hb){function Db(mf){mf.Errors&&vb.tableManager.i7f(Uc)}function rc(){vb.tableManager.i7f(Uc)}var vb=this,Uc=T.OriginalTableRange,Td=Ff.m(T.ResizeTableRange,this.$.xa.qa);return function(mf,bg,qg){return We.j(pa,Td,ge.b(mf,Db),ge.a(bg,rc),qg,null,hb)}};bc.prototype.yXh=function(T){var pa=-1;T[dd.a.kd]&&(pa=T[dd.a.kd],pa=Pf.a.contains(pa,ae.a.mGb,!0)?this.tableStyleManager.ovb(pa):
Number.parseInvariant(T[dd.a.kd]));return pa};bc.prototype.Mc=function(T,pa){T=!1;switch(pa.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:T=!0;break;case 756677940:T=$e.EwaSettings.ma(410);break;case -723113214:case 868579142:T=$e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",
!1)}return T};bc.prototype.jd=function(T,pa,hb){T=!1;switch(pa){case "PopulateTableMoreStylesMenu":this.menuId=hb.MenuId;this.tableStyleManager.aic()||this.tableStyleManager.uKa("formatAsTableMenu");T=this.tableStyleManager.rGf(pa,hb);break;case "PopulateTableAccessibleStylesMenu":this.menuId=hb.MenuId,this.tableStyleManager.aic()||this.tableStyleManager.uKa("accessibilityTab"),T=this.tableStyleManager.rGf(pa,hb)}return T};bc.prototype.dispose=function(){this.tableStyleManager.Uaj(this.zCf)};bc.prototype.eda=
function(){(Pf.a.contains(this.menuId,"Format",!0)||Pf.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.Lv(this.menuId)};bc.prototype.gcd=function(){return Ff.v(this.ta.activeCell,this.$)};bc.prototype.RPh=function(){var T=this.tableManager.Ird;return T?Ff.v(T,this.$):null};bc.prototype.W$e=function(T){if(this.tableManager){var pa=zf.g(this.$),hb=this.ta.activeCell,Db=this.tableManager.nn(hb),rc=null;if(!Db||Db.coa)for(pa=Gl(pa.l3),Db=pa.next();!Db.done;Db=pa.next()){Db=Gl(Db.value);
for(var vb=Db.next();!vb.done;vb=Db.next()){vb=vb.value;var Uc=vb.Sn;hb.left>=Uc[0]&&hb.left<=Uc[Uc.length-1]&&(rc=(vb=vb.ds(hb).UJ())?se.DOMElementExtensions.Oj(vb,lg.a.uoe):null)}}else{var Td=pa.lc(Se.Range.hd(Db.top,hb.left));if(this.hy){Na.a.instance.create(function(){Td.invoke(8,T)},0,kb.a.b7f,!0,!0);return}rc=Td.cKa(56).u5a}rc&&Na.a.instance.create(function(){se.DOMElementExtensions.Wec(rc,null)},0,kb.a.b7f,!0,!0)}};bc.prototype.zXh=function(T){T=Number.parseInvariant(T);return-1<T&&8>=T?T:
-1};bc.prototype.WLa=function(){return!this.tableManager.Eg};bc.prototype.Uef=function(){return this.tableManager.AEd?!1:(dc.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)};bc.prototype.Mci=function(){var T=this.ta.dK(),pa=this.ta.Hg&&!zf.g(this.$).Nb.s5(this.ta.qd);return T||pa};bc.prototype.Lci=function(){return this.ta.dK()||!this.Uef()};bc.prototype.BXh=function(T){var pa=[];T=Gl(T);for(var hb=T.next();!hb.done;hb=
T.next())if(hb=Oe.b(this.$,hb.value),null===hb||void 0===hb?0:hb.length){hb=Gl(hb);for(var Db=hb.next();!Db.done;Db=hb.next())Db=Db.value,Db.usedRange&&!Array.contains(pa,Db.usedRange)&&pa.push(Db.usedRange)}return pa};bc.prototype.u1e=function(){var T=this.ta.selectedRanges,pa=[];if($e.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))pa=this.BXh(T);else{T=Gl(T);for(var hb=T.next();!hb.done;hb=T.next())hb=hb.value,zf.g(this.$).Nb.s5(hb)&&pa.push(hb)}return pa&&
pa.length?Ff.r(pa,this.$):null};bc.prototype.mL=function(T){Ph.a.Fba(this.$)&&jc.TaskExtensions.Ba(qb.GetServiceTaskFactory.Xa(this.$.da,430,431,1),function(pa){pa.result.pea(T);dc.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)};bc.prototype.Xpi=function(T){var pa=this;jc.TaskExtensions.Ba(qb.GetServiceTaskFactory.Xa(this.$.da,446,447,0),function(hb){hb.result.A9g(pa.$,T)},this.$.la,3)};bc.rXf=function(T,pa){pa.SheetName=
T.qa.name;pa.NamedObjectView=T.ea.isNamedObjectViewMode};bc.prototype.a$f=function(T,pa){var hb=this;if(!this.ta.Hg||1!=this.ta.qd.eM)return{vyb:!1,TBa:Uc,oj:Td};var Db=Ff.v(this.ta.qd,this.$);Db.LastColumn=Db.FirstColumn+3-1;Db.LastRow=Db.FirstRow+4-1;var rc=Ff.D(Db),vb=zf.g(this.$);if(!rc.isValidRange||!vb.Nb.Uwa(rc))return{vyb:!1,TBa:Uc,oj:Td};Kc.AFrameworkApplication.z_("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");if(!$e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",
!1))return{vyb:!1,TBa:Uc,oj:Td};if(null==T){var Uc=function(bg,qg,Kg){return We.e(hb.$.na.va,Db,!1,!1,!1,bg,qg,Kg,pa)};var Td=function(){return new Fa.a(!1,Db)}}else{var mf=Ff.s(Db);Uc=function(bg,qg,Kg){return We.g(hb.$.na.va,mf,!1,!1,!1,T,bg,qg,Kg,pa)};Td=function(){return new wa(mf,!1,T,!0)}}return{vyb:!0,TBa:Uc,oj:Td}};Object(Zd.a)(bc,"TableCommandHandler",null,[428]);var Mf=ug.a;Wl(qd,Mf);qd.prototype.dispose=function(){Mf.prototype.dispose.call(this)};qd.prototype.Od=function(){var T=this,pa=
qb.GetServiceTaskFactory.create(this.$.da,134,this.la,this.vb),hb=qb.GetServiceTaskFactory.create(this.$.da,330,this.la,this.vb),Db=qb.GetServiceTaskFactory.Xa(this.$.da,309,310,this.vb);jc.TaskExtensions.Ba(Od.Task.WAA(pa,Db,hb),function(){T.Cd([new bc(T.$,pa.result,Db.result,hb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)};qd.ka=function(T){ug.a.ee(86,new qd(T))};Object(Zd.a)(qd,"TableCommandHandlerFactory",ug.a,[]);yc.prototype.$c=function(){return!1};
yc.prototype.executeCommand=function(T,pa){T=pa.command;pa=null;switch(T){case 1243860697:this.shh.HIj();break;default:pa=Vd.a(T)}return pa||Od.Task.Sa(!0)};yc.prototype.Mc=function(T,pa){return 1243860697===pa.command};yc.prototype.jd=function(){return!1};Object(Zd.a)(yc,"SheetDropdownMenuCommandHandler",null,[428]);var rf=ug.a;Wl(Rb,rf);Rb.prototype.Od=function(){var T=this;this.$.LC(function(pa){pa.tec().then(function(){jc.TaskExtensions.Ba(qb.GetServiceTaskFactory.Xa(T.$.da,32,33,T.vb),function(hb){T.Cd([new yc(hb.result.Atj)])},
T.$.la)})})};Rb.ka=function(T){ug.a.ee(392,new Rb(T))};Object(Zd.a)(Rb,"SheetDropdownMenuCommandHandlerFactory",ug.a,[]);var oi=b(195),bh=b(42),ah=b(109),wh=b(35);Ja.prototype.QJg=function(T,pa){this.DHe.add(T,pa);this.JS()};Ja.prototype.JS=function(){var T=this;this.AHc=0;wh.a.forEach(this.DHe.ku,function(pa){T.AHc=T.b6c|pa.value})};Ck.Object.defineProperties(Ja.prototype,{b6c:{configurable:!0,enumerable:!0,get:function(){return this.AHc}},navigationButtonsDisabled:{configurable:!0,enumerable:!0,
get:function(){return!!(this.b6c&1)}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.b6c&2)}}});Object(Zd.a)(Ja,"SheetTabBarDisabledStateManager",null,[]);Eb.jrh="ewa-stb-uir";Eb.wNe="ewa-stb-drag";Eb.Uqh="ewa-stb-navarea";Eb.Vqh="ewa-stb-navarea-dimensions";Eb.Xqh="ewa-stb-navbutton";Eb.bZ="cui-disabled";Eb.Wqh="ewa-stb-navareaextra";Eb.gia="cui-img-container";Eb.Rqh="ewa-stb-contentarea";Eb.xNe="ewa-stb-left-scrollable";Eb.JNe="ewa-stb-right-scrollable";Eb.hrh=
"ewa-stb-tabarea";Eb.grh="ewa-stb-sheettabmoveindicator";Eb.LNe="ewa-stb-tabs";Eb.rFj="tab-active";Eb.zFj="tab-inactive";Eb.yFj="tab-hover";Eb.irh="ewa-stb-tabs-ghost";Eb.tFj="tab-anchor-text";Eb.dark="dark";Eb.light="light";Eb.sFj="tab-active-text";Eb.wFj="tab-content-container";Eb.BFj="tab-text";Eb.$qh="ewa-stb-nsv-inactive";Eb.arh="ewa-stb-nsv-inactive-svg";Eb.Yqh="ewa-stb-nsv-active";Eb.Zqh="ewa-stb-nsv-active-svg";Eb.Eph="ewa_nsv_margin";Eb.Sqh="ewa-stb-disable-scrollbar";Eb.jqi="leave-size-fixed-on-tab-hover-old";
Eb.iqi="leave-size-fixed-on-tab-hover";Eb.BNe="ewa-stb-locked-sheet";Eb.CNe="ewa-stb-locked-sheet-svg";Eb.DNe="ewa-stb-locked-sheet-svg-16px";Eb.Tqh="ewa-stb-dropdown-menu-button";Eb.Blh="ewa-active-sheet-menu-item";Object(Zd.a)(Eb,"CssClassNames",null,[]);var xi=b(616),O=b(19),fa=b(102),Va=b(560),d=b(295),r=b(328),S=b(100),ca=b(358),Ka=b(196),fc=b(388),pb=b(384),Z=b(230),Ba=b(86),Fb=Xf.a;Wl(zc,Fb);zc.prototype.dispose=function(){this.M$a=this.Dsa=this.$=null;Fb.prototype.dispose.call(this)};zc.prototype.yX=
function(T){this.UX=T;this.domElement.setAttribute(ae.a.lsa,T.toString());se.DOMElementExtensions.toggleCssClass(this.domElement,xi.a.bZ,T)};Ck.Object.defineProperties(zc.prototype,{disabled:{configurable:!0,enumerable:!0,get:function(){return this.UX}}});Object(Zd.a)(zc,"SheetBarButton",Xf.a,[]);var xc=b(918);Wl(Bb,zc);Bb.prototype.dispose=function(){Z.a.instance.Aa(Vf.a.click,this.domElement,this.xd);ah.KeyInputManager.instance.Jv(this.domElement,this.TMa);$e.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&
zf.g(this.$)&&zf.g(this.$).tc&&(zf.g(this.$).tc.kl(this.fj),zf.g(this.$).tc.Um(this.Tf));zc.prototype.dispose.call(this)};Bb.prototype.yX=function(T){var pa=Bb.Z0f(this.$);zc.prototype.yX.call(this,T||pa)};Bb.Z0f=function(T){return!T.isEditMode||!T.xa.count};Object(Zd.a)(Bb,"InsertSheetButton",zc,[]);Wl(db,zc);db.prototype.dispose=function(){Z.a.instance.Aa(Vf.a.click,this.domElement,this.xd);ah.KeyInputManager.instance.Jv(this.domElement,this.TMa);this.vue=null;zc.prototype.dispose.call(this)};Object(Zd.a)(db,
"InsertTemplateButton",zc,[]);nb.prototype.getSheetName=function(){return this.sheetName};Object(Zd.a)(nb,"MacroRecorderSheetReorderedPayload",null,[450]);var Pc=Xf.a;Wl(Nb,Pc);Nb.prototype.dispose=function(){this.al();Pc.prototype.dispose.call(this)};Nb.prototype.HIj=function(){this.vQf(!0,"TogglerSheetDropdownMenu")};Nb.prototype.vQf=function(T,pa){dc.ULS.sendTraceTag(537153795,0,50,"SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: {0}, toggle: {1}, toggleStateId: {2}",pa,T,this.iNb);
T&&(this.iNb+=1);var hb=this.$.Pb.Gc("UserAction",String.format("SheetDropdownMenu.RenderSheetMenuInternal: caller: {0}, toggle: {1}, toggleStateId: {2}, sheetCount: {3}",pa,T,this.iNb,this.$.xa.count));T=this.q9g();appChrome.renderSheetDropdownMenu(this.domElement,this.ZFj,T,this.iNb,this.THi,this.SHi,function(){hb.stop()},fc.a(this.$))};Nb.prototype.q9g=function(){for(var T=this.$.xa,pa=[],hb=0;hb<T.count;hb++){var Db=Object(pg.a)(S.a,T.getItem(hb));0===Db.Gy&&(Db=this.p9g(Db),pa.push(Db))}return pa};
Nb.prototype.p9g=function(T){var pa={};pa.key=T.name;pa.text=T.name;pa.onClick=this.r9g(T);T.active&&(pa.className=fc.a(this.$)?"ewa-active-sheet-menu-item-present-mode":Eb.Blh);return pa};Nb.prototype.r9g=function(T){var pa=this;return function(){var hb=new id.a(-1876836819,0,pa.$.Xc,30,null),Db={};pa.$.Ka.Wb(hb,(Db[ae.a.MPd]=T.name,Db))}};Nb.prototype.Ej=function(){if(!this.fV){var T=this.$.xa;T.og(this.GR);T.MUc(this.GR);T.xY(this.GR);T.Qga(this.GR);T.BFa(this.GR);T.Rme(this.GR);T.yYa(this.GR);
this.fV=!0}};Nb.prototype.al=function(){if(this.fV){var T=this.$.xa;T.Wg(this.GR);T.sId(this.GR);T.a7(this.GR);T.Yma(this.GR);T.dQa(this.GR);T.vPf(this.GR);T.UHb(this.GR);this.fV=!1}};Object(Zd.a)(Nb,"SheetDropdownMenu",Xf.a,[911,3]);var Sc=b(365);Wl(nc,zc);nc.prototype.dispose=function(){this.nNj();zc.prototype.dispose.call(this)};nc.prototype.yX=function(T){zc.prototype.yX.call(this,T||!this.$.ea.vwa)};nc.prototype.W8f=function(T){this.disabled||(dc.ULS.sendTraceTag(537153793,0,50,"SheetDropdownMenuAnchor.ToggleMenu: inputMethod: {0}",
Sc.a[T]),this.$.Ka.Wb(new id.a(1243860697,T,this.$.Xc,30,null)))};nc.prototype.q6i=function(){Z.a.instance.pa(Vf.a.click,this.domElement,this.xd);ah.KeyInputManager.instance.pa(Vf.a.Xb,this.domElement,this.onKeyDown)};nc.prototype.nNj=function(){Z.a.instance.Aa(Vf.a.click,this.domElement,this.xd);ah.KeyInputManager.instance.Aa(Vf.a.Xb,this.domElement,this.onKeyDown)};Object(Zd.a)(nc,"SheetDropdownMenuAnchor",zc,[]);var oe=b(204),gf=b(128),xf=b(59),Uf=b(203),Zf=b(172);cc.prototype.ZM=function(){return this.sheet.active};
cc.prototype.jod=function(){return this.sheet.isLockPausedInSession};cc.prototype.Ssa=function(){return this.qm?O.a.ANe:this.ZM()?O.a.zNe:O.a.yNe};cc.prototype.koa=function(){return this.sheet.tj?xc.a.OIf:$e.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?xc.a.$Mj:xc.a.ZMj};cc.prototype.aUd=function(){return $e.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:13};cc.prototype.cUd=function(){return $e.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?
16:12};cc.prototype.Iha=function(){return null};cc.prototype.Tsa=function(){return this.qm?this.Ew?$e.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?Eb.DNe:Eb.CNe:Eb.BNe:null};cc.prototype.BVd=function(){return null};cc.prototype.Iv=function(){return null};cc.prototype.rkd=function(){return 0};cc.prototype.iWc=function(){return!0};Object(Zd.a)(cc,"LockPausedSheetIconDataSource",null,[918]);Cb.prototype.ZM=function(){return this.sheet.active};Cb.prototype.jod=function(){return this.sheet.tj};
Cb.prototype.Ssa=function(){return this.qm?O.a.ANe:this.ZM()?O.a.zNe:O.a.yNe};Cb.prototype.koa=function(){return xc.a.OIf};Cb.prototype.aUd=function(){return $e.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:13};Cb.prototype.cUd=function(){return $e.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:12};Cb.prototype.Iha=function(){return null};Cb.prototype.Tsa=function(){return this.qm?this.Ew?$e.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?
Eb.DNe:Eb.CNe:Eb.BNe:null};Cb.prototype.BVd=function(){return null};Cb.prototype.Iv=function(){return null};Cb.prototype.rkd=function(){return 0};Cb.prototype.iWc=function(){return!0};Object(Zd.a)(Cb,"LockedSheetIconDataSource",null,[918]);Sa.prototype.ZM=function(){return this.sheet.active};Sa.prototype.jod=function(){return this.sheet.Yd.jy};Sa.prototype.Iha=function(){return this.Ew?this.ZM()?Eb.Zqh:Eb.arh:this.ZM()?Eb.Yqh:Eb.$qh};Sa.prototype.Ssa=function(){return!this.ZM()&&this.S1f()?O.a.Psh:
O.a.Osh};Sa.prototype.koa=function(){return!this.ZM()&&this.S1f()?xc.a.Ktj:xc.a.Jtj};Sa.prototype.aUd=function(){return 14};Sa.prototype.cUd=function(){return 16};Sa.prototype.Tsa=function(){return Eb.Eph};Sa.prototype.BVd=function(){return this.sheet.Yd.Dmb};Sa.prototype.Iv=function(){return this.YIj};Sa.prototype.rkd=function(){return 8};Sa.prototype.iWc=function(){return!1};Object(Zd.a)(Sa,"NamedSeetViewSheetIconDataSource",null,[918]);Ta.prototype.$bg=function(){if(this.wI&&(this.wl||this.TAa)){if(this.Ew){var T=
this.dataSource.koa();this.koa!==T&&(this.TAa&&this.TAa.parentNode.removeChild(this.TAa),this.i$e(),this.koa=T)}else T=this.dataSource.Ssa(),this.Ssa!==T&&(this.wJd(this.wl,this.Ssa,T),this.Ssa=T);T=this.dataSource.Iha();this.Iha!==T&&(this.Ew?this.jcj(this.TAa,this.Iha,T):this.wJd(this.wl,this.Iha,T),this.Iha=T);T=this.dataSource.Tsa();this.Tsa!==T&&(this.wJd(this.wI,this.Tsa,T),this.Tsa=T);this.dataSource.Iv()&&!this.dataSource.ZM()&&this.clearToolTip()}};Ta.prototype.kyj=function(T,pa,hb){this.P$h(T,
pa,hb);se.DOMElementExtensions.setVisible(this.wI,this.dataSource.jod())};Ta.prototype.clearToolTip=function(){var T=this;jc.TaskExtensions.Ba(this.HBb,function(){dialogControls.clearToolTip(T.dataSource.Iv())},this.$.la,3)};Ta.prototype.P$h=function(T,pa,hb){this.wI&&this.Tef!==T&&(this.wI.parentNode.removeChild(this.wI),this.Tsa=this.Iha=this.koa=this.Ssa=this.hRc=null,this.dataSource.Iv()&&(this.Kc.detach("mouseover",!0),this.Kc.detach("mouseout",!0)));this.wI||(this.hRc=document.createElement("span"),
Sys.UI.DomElement.addCssClass(this.wI,xi.a.gia),Sys.UI.DomElement.addCssClass(this.wI,O.a.YA),$e.EwaSettings.ma(504)?T===this.dataSource.iWc()?pa.appendChild(this.wI):pa.insertBefore(this.wI,hb):T?pa.insertBefore(this.wI,hb):pa.appendChild(this.wI),this.Ew?this.i$e():(this.wl=document.createElement("img"),this.wl.tabIndex=-1,this.wl.alt=this.dataSource.altText,this.wI.appendChild(this.wl),this.wl.src=bf.a.gf(this.dataSource.rkd())),this.dataSource.Iv()&&(this.Kc.ka("mouseover",this.CN,!0),this.Kc.ka("mouseout",
this.BN,!0)),this.Tef=T)};Ta.prototype.jcj=function(T,pa,hb){T&&(Sys.UI.DomElement.removeCssClass(T,pa),Sys.UI.DomElement.addCssClass(T,hb))};Ta.prototype.wJd=function(T,pa,hb){pa&&Sys.UI.DomElement.removeCssClass(T,pa);hb&&Sys.UI.DomElement.addCssClass(T,hb)};Ta.prototype.dispose=function(){Me.a.Ha(this.G1)};Ta.prototype.i$e=function(){var T=this.$.da.za(388);T?(this.TAa=T.Bva(this.dataSource.koa(),this.dataSource.aUd(),this.dataSource.cUd()))?this.wI.appendChild(this.TAa):dc.ULS.shipAssertTag(537153763,
0,!1,"Sheeticon.InsertCurrentSvgIcon: Svg with id {0} was not found.",this.dataSource.koa()):dc.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")};Ck.Object.defineProperties(Ta.prototype,{Kc:{configurable:!0,enumerable:!0,get:function(){return this.G1||(this.G1=eh.a.instance.je(this.wI))}},HBb:{configurable:!0,enumerable:!0,get:function(){var T=this;if(this.Cqa)return this.Cqa;var pa=new lc.a;this.$.LC(function(hb){jc.TaskExtensions.Ba(hb.Ssd(),
function(){pa.setResult(!0)},T.$.la,3)});return this.Cqa=pa.task}},wI:{configurable:!0,enumerable:!0,get:function(){return this.hRc}}});Object(Zd.a)(Ta,"SheetIcon",null,[3]);var Ne=b(366),ch=b(158),yh=ef.a;Wl(Da,yh);Da.prototype.dispose=function(){this.Qna&&(Z.a.instance.Aa(Vf.a.lk,this.Qna.domElement,this.rca),Ne.a.instance.Aa(this.Qna.domElement,this.Ql),this.Zfe=null);this.$=null;yh.prototype.dispose.call(this)};Da.prototype.showContextMenu=function(T,pa,hb){this.Qna.activate(pa,Ph.a.wqd());pa=
new id.a(-1075099431,pa,this.$.Xc,30,null);var Db,rc={};return!ch.a(Db=this.$.Ka.Wb(pa,(rc[ae.a.w0f]=T,rc[Da.Btj]=this.Qna.sheet,rc[ae.a.x0f]=hb,rc)))&&(6!==Db.status||Db.result)};Da.prototype.rename=function(T,pa){this.$.Ud(817296323,pa,T?19:0,null)};Ck.Object.defineProperties(Da.prototype,{Qna:{configurable:!0,enumerable:!0,get:function(){return this.Zfe}}});Da.Btj="Sheet";Object(Zd.a)(Da,"SheetOpsSheetClickHelper",ef.a,[]);Wl(Pa,zc);Pa.prototype.MNh=function(){return se.DOMElementExtensions.canReceiveFocus(this.anchor)?
this.anchor:null};Pa.prototype.dispose=function(){if(this.fV){Eg.a.instance.Aa(Vf.a.pointerDown,this.domElement,this.onPointerDown);ah.KeyInputManager.instance.Aa(Vf.a.Xb,this.domElement,this.onKeyDown);ah.KeyInputManager.instance.Aa(Vf.a.rp,this.domElement,this.Iz);Z.a.instance.Aa(Vf.a.click,this.domElement,this.xd);Eg.a.instance.Aa(Vf.a.zW,this.domElement,this.sya);Eg.a.instance.Aa(Vf.a.xy,this.domElement,this.q6);if(this.Nzb||$e.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))Eg.a.instance.Aa(Vf.a.Zd,
this.domElement,this.Gf),this.Xwa&&(ve.a.instance.Aa(Vf.a.De,this.domElement,this.Gf),ve.a.instance.Aa(Vf.a.Bg,this.domElement,this.NN));this.fV=!1;this.p5b="#BEBBB8"}Me.a.Dc([this.rye,this.Ete]);this.LO=this.tE=this.LEc=this.rS=this.Ete=this.rye=null;if(this.Nna){for(var T=Gl(this.Nna),pa=T.next();!pa.done;pa=T.next())pa.value.dispose();this.Nna=null}this.color=this.oWb=null;zc.prototype.dispose.call(this)};Pa.prototype.yX=function(T){T&&this.Hna(!1,!1);zc.prototype.yX.call(this,T)};Pa.prototype.wRd=
function(T){if(xf.a.Fg.lR){this.LHe();var pa=qb.GetServiceTaskFactory.Xa(this.$.da,322,323,1);jc.TaskExtensions.Ba(pa,function(hb){oe.UISurfaces.QQ().then(function(Db){var rc=hb.result;rc.Hpj(Db);rc.show(T);return null},function(Db){dc.ULS.sendTraceTag(537153688,0,15,"SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: {0}",Db);return null})},this.la,3)}};Pa.prototype.wle=function(){var T=this;if(this.sheet.active&&this.$.lr){var pa=this.$.lr,hb=zf.g(this.$),Db=hb.om;
if(this.sheet.Yd.jy){if(!this.XCb){var rc=new Sa(this.sheet,this.rS.Dwc,function(){return T.color?Pa.RQd(T.color):!1},this.Ew);this.XCb=new Ta(this.$,rc);this.Nna.add(this.XCb)}Db?hb.Qeb(1):pa.classList.add(O.a.WPe);pa=Pa.Ped(ae.a.wqf);hb=Pa.Ped(ae.a.Gwd);Db=Pa.Ped(ae.a.nqf);rc=this.sheet.Yd.DQd;this.sheet.Yd.DQd=!1;"true"===Db&&rc&&this.$.ea.GQd?(gf.a.Cv(ae.a.nqf,"false",gf.a.iW),this.$.ea.GQd=!1,this.wRd(3)):"true"===pa&&"true"===hb&&"true"===Db?this.$.ea.HQd&&this.$.ea.jLb&&(this.sheet.Yd.iK?(pa=
1,gf.a.Cv(ae.a.Gwd,"false",gf.a.iW),this.$.ea.jLb=!1):pa=0,gf.a.Cv(ae.a.wqf,"false",gf.a.iW),this.$.ea.HQd=!1,this.wRd(pa)):this.sheet.Yd.iK&&"true"===hb&&"true"===Db&&this.$.ea.jLb&&(gf.a.Cv(ae.a.Gwd,"false",gf.a.iW),this.$.ea.jLb=!1,this.wRd(2))}else this.LHe(),Db?hb.Qeb(0):pa.classList.remove(O.a.WPe)}};Pa.prototype.LHe=function(){if($e.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")){var T=this.$.da.za(322);T&&T.dismiss()}else this.$.gqd&&(T=qb.GetServiceTaskFactory.Xa(this.$.da,322,
323,0),jc.TaskExtensions.Ba(T,function(pa){pa.result.dismiss()},this.$.la,3))};Pa.prototype.afb=function(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.s6a()?Eb.rFj:Eb.zFj;$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.LO.parentNode.classList.add(Eb.iqi):this.LO.parentNode.classList.add(Eb.jqi);this.Qcg();this.dnd&&this.wle();this.lyj();this.Wcg();this.fBc();this.dnd||this.wle()};Pa.prototype.uQi=function(){this.KPd=!0;this.Hna(!0,!0,
"OnSheetReorderStarted")};Pa.prototype.tQi=function(){this.KPd=!1;this.Hna(!1,void 0,"OnSheetReorderEnded")};Pa.prototype.activate=function(T,pa){T=void 0===T?0:T;pa=void 0===pa?!1:pa;this.b2b()||(this.sheet.activate(),pa&&zf.g(this.$).focus(),pa={},T=(pa.InputMethod=Sc.a[T],pa.AppMode=this.$.Xc,pa.Location="canvas",pa),sh.b(this.$).Rd(Yh.a.xtj,T))};Pa.prototype.Pcg=function(T){this.p5b=T?"#797775":"#BEBBB8";this.j4c=T?-.5:.5;this.mHc=T?Uf.a.cp("#3B3A39"):Uf.a.cp("#F5F5F5");this.Wcg()};Pa.prototype.Jmj=
function(T){this.Nzb=T};Pa.prototype.jzd=function(T){T.I1c();this.Mwe(T)};Pa.prototype.Mwe=function(T){T.a0a();this.sheet.activate()};Pa.prototype.bzg=function(T){T=new id.a(-1876836819,T,this.$.Xc,30,null);var pa={};return this.$.Ka.Wb(T,(pa[ae.a.MPd]=this.sheet.name,pa))};Pa.prototype.Qcg=function(){this.LO.parentNode.setAttribute("sheet-title",this.LO.innerText)};Pa.prototype.fBc=function(){var T=this.tHh();this.anchor.setAttribute(ae.a.Ot,T);this.anchor.setAttribute(ae.a.eha,this.sheet.active.toString())};
Pa.prototype.tHh=function(){var T=this.sheet.Yd.jy,pa=this.sheet.Yd.Dmb,hb=this.sheet.tj,Db=this.sheet.isLockPausedInSession;return T&&hb?String.format(Le.a.instance.Bb(20),this.name,pa):T&&Db?String.format(Le.a.instance.Bb(22),this.name,pa):T?String.format(Le.a.instance.Bb(19),this.name,pa):hb?String.format(Le.a.instance.Bb(18),this.name):Db?String.format(Le.a.instance.Bb(21),this.name):this.name};Pa.prototype.activateSheet=function(T){T=void 0===T?0:T;if(Ph.a.wqd()){if($e.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&
this.b2b())return Od.Task.Sa(!1);Zf.a.current.jS="ActivateSheet";this.sheet.activate();return Od.Task.Sa(!0)}return this.bzg(T)};Pa.prototype.Wcg=function(){var T=this.sheet.tabColor;this.color=T?Uf.a.cp(T):this.Zbh;this.Fdf=Pa.RQd(this.color);this.Hna(!1,void 0,"UpdateTabColor")};Pa.prototype.Hna=function(T,pa,hb){pa=void 0===pa?!1:pa;hb=void 0===hb?null:hb;if(this.sheet){hb=this.sheet.active;var Db=this.s6a(),rc=!!this.sheet.tabColor,vb=Uf.a.eG(hb||Db?Ig.a.white:this.color);this.tE.style.background=
"";hb||Db?(rc?$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.$Ka?this.zrj():this.qm?this.yrj():this.xrj():this.qm||(this.tE.style.backgroundColor=vb),this.tE.style.height=this.V0c.toString()+"px"):(this.tE.style.filter="",this.tE.style.backgroundColor=vb,this.tE.style.height=this.W0c.toString()+"px");this.LO.className=hb?Eb.sFj:Db?Eb.dark:this.Fdf?Eb.light:Eb.dark;vb=Gl(this.Nna);for(var Uc=vb.next();!Uc.done;Uc=vb.next())Uc.value.$bg();this.qm&&
(T&&!rc&&(this.tE.style.backgroundColor="#E1DFDD"),se.DOMElementExtensions.toggleCssClass(this.domElement,Eb.yFj,T),pa?(rc||(this.tE.style.backgroundColor=this.p5b),this.domElement.style.backgroundColor=this.p5b):(rc||(this.tE.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.LO.style.fontWeight=hb||Db||!this.qm&&T?this.qm?"600":"bold":""}else dc.ULS.sendTraceTag(537153687,0,15,"SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: {0}",
hb)};Pa.prototype.yrj=function(){var T=this.tE.style,pa=Uf.a.eG(Pa.n_c(this.color,this.j4c));T.background=pa};Pa.prototype.xrj=function(){var T=this.tE.style,pa=Uf.a.eG(Pa.n_c(this.color,1)),hb=Uf.a.eG(Pa.n_c(this.color,this.j4c)),Db="";if(ya.a.ixa)Db="-webkit-";else if(ya.a.Nf)Db="-moz-";else if(ya.a.Of){if(Db="-ms-",!ya.a.f6a){T.filter=String.format("progid:DXImageTransform.Microsoft.gradient(startColorstr={0}, endColorstr={1})",pa,hb);return}}else ya.a.vef&&(Db="-o-");T.background=String.format("{0}linear-gradient({1}, {2})",
Db,pa,hb)};Pa.prototype.zrj=function(){this.tE.style.background="transparent"};Pa.prototype.z3g=function(){this.LEc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=Eb.tFj;se.DOMElementExtensions.tu(this.anchor,ae.a.Ynb,null,null);this.tabIndex=-1};Pa.prototype.B9g=function(){this.tE=document.createElement("span");this.tE.className=Eb.wFj;this.LO=document.createElement("span");this.LO.className=Eb.BFj;this.LO.dir=this.sheet.rtlName?"rtl":"ltr";this.tE.appendChild(this.LO)};
Pa.prototype.lyj=function(){for(var T=this.$.lJ,pa=Gl(this.Nna),hb=pa.next();!hb.done;hb=pa.next())hb.value.kyj(T,this.tE,this.LO)};Pa.prototype.s6a=function(){return zf.g(this.$).s6a(this.sheet)};Pa.prototype.HCj=function(){this.Sjd.start();this.iod=!0};Pa.prototype.DKe=function(T){if(this.iod){this.Sjd.stop();var pa={};T=(pa["Sheet index"]=this.sheet.index,pa["Active Sheet"]=this.sheet.active,pa["Hovering time"]=this.Sjd.Bc,pa["Has been clicked"]=T,pa);dc.ULS.sendTraceTag(537153686,0,50,Sd.c(T));
this.iod=!1}};Pa.prototype.C7i=function(){Eg.a.instance.pa(Vf.a.pointerDown,this.domElement,this.onPointerDown);ah.KeyInputManager.instance.pa(Vf.a.Xb,this.domElement,this.onKeyDown);ah.KeyInputManager.instance.pa(Vf.a.rp,this.domElement,this.Iz);this.Kc.ka("mouseover",this.CN);this.Kc.ka("mouseout",this.BN);Eg.a.instance.pa(Vf.a.zW,this.domElement,this.sya);Eg.a.instance.pa(Vf.a.xy,this.domElement,this.q6);if(this.Nzb||$e.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))Eg.a.instance.pa(Vf.a.Zd,
this.domElement,this.Gf),this.Xwa&&(ve.a.instance.pa(Vf.a.De,this.domElement,this.Gf),ve.a.instance.pa(Vf.a.Bg,this.domElement,this.NN));Z.a.instance.pa(Vf.a.click,this.domElement,this.xd);this.fV=!0};Pa.prototype.b2b=function(){var T=this.$.da.za(65);return T&&T.sba()?(T.fJb(),this.Mwe(T),!0):!1};Pa.Ped=function(T){var pa=gf.a.get(T);pa||(gf.a.Cv(T,"true",gf.a.iW),pa=gf.a.get(T));return pa};Pa.n_c=function(T,pa){if(1<pa||-1>pa)return T;var hb=T.r,Db=T.g;T=T.b;0<pa?(hb=hb*(1-pa)+255*pa,Db=Db*(1-pa)+
255*pa,T=T*(1-pa)+255*pa):(hb*=1+pa,Db*=1+pa,T*=1+pa);return Ig.a.kub(Math.round(hb),Math.round(Db),Math.round(T))};Pa.RQd=function(T){return 128>=(222*T.r+707*T.g+71*T.b)/1E3};Ck.Object.defineProperties(Pa.prototype,{Zbh:{configurable:!0,enumerable:!0,get:function(){return this.mHc||(this.mHc=Uf.a.cp("#F5F5F5"))}},name:{configurable:!0,enumerable:!0,get:function(){return this.LO.innerText},set:function(T){this.LO&&(this.LO.innerText=T,this.fBc(),this.Qcg())}},sheet:{configurable:!0,enumerable:!0,
get:function(){return this.oWb}},anchor:{configurable:!0,enumerable:!0,get:function(){return this.LEc}},tabIndex:{configurable:!0,enumerable:!0,get:function(){return this.anchor.tabIndex},set:function(T){this.anchor.tabIndex=T}}});Object(Zd.a)(Pa,"SheetTabButton",zc,[]);Wl(mb,zc);Object(Zd.a)(mb,"WorkbookProtectionButton",zc,[]);var nf=b(50),Ci=b(46),kh=b(53),Xi=Xf.a;Wl(eb,Xi);eb.prototype.Cb=function(T,pa,hb,Db,rc,vb,Uc){Uc=void 0===Uc?!1:Uc;T.removeAttribute("Href");T.setAttribute(ae.a.Wd,ae.a.Ss);
T.className=Eb.Xqh;T.title=pa;T.tabIndex=0;this.Ew&&vb?hb=this.svgIconProvider.nba(vb,12,12,T,24,24):(pa=document.createElement("span"),pa.className=this.qm?O.a.nYg:O.a.YA,pa.classList.add(xi.a.gia),pa.tabIndex=-1,T.appendChild(pa),vb=document.createElement("img"),vb.src=bf.a.gf(hb),vb.className=Db,vb.alt=rc,vb.tabIndex=-1,pa.appendChild(vb),hb=vb);Uc&&T.classList.add(xi.a.bZ);return hb};eb.prototype.dispose=function(){if(this.$){var T=this.$.xa;T.Wg(this.Th);T.sId(this.hya);T.a7(this.bD);T.Yma(this.OEb);
T.dQa(this.Cya);T.vPf(this.WBf);T.UHb(this.YBf);T.S$i(this.XBf);T.EId(this.Jsf);T.sPf(this.Ksf);T.tPf(this.Lsf);T.uPf(this.AOa);this.$.yl(this.vd);this.$.rD(this.ej);ff.a(this.$)&&ff.a(this.$).yg.Zma(this.wF);this.Rta&&zf.g(this.$).WOf(this.UDb);oi.a.instance.Aa(Vf.a.WC,this.domElement,this.r6)}Me.a.Dc(this.Qwd);this.Qwd=null;if(this.vK)for(T=0;T<this.vK.length;T++){var pa=se.DOMElementExtensions.UJ(this.vK[T],this.domElement,!1,"a");pa&&bh.a.Sma(pa)}Me.a.Ha(this.gC);Me.a.Ha(this.Hwc);Me.a.Ha(this.QPd);
this.QPd=this.Hwc=this.Yxb=this.DH=this.gC=null;this.$&&this.yz&&this.vQ(!1);this.aaa=null;this.ONd(null,"Dispose");this.BMb=this.rM=this.g7b=null;this.n0c();this.Pcb=this.Iwc=this.RPd=this.Xk=this.vK=this.$=this.ea=null;Xi.prototype.dispose.call(this)};eb.prototype.eg=function(T,pa){if(!pa){dc.ULS.shipAssertTag(537153760,0,0<this.Ah.length,"There is no sheet tab button.");if(!this.Ah.length)return!1;T=null;for(var hb=Gl(this.Ah),Db=hb.next();!Db.done&&!(T=Db.value.MNh());Db=hb.next());if(!T)return dc.ULS.shipAssertTag(537153759,
0,!1,"There is no focusable tab element."),!1;se.DOMElementExtensions.setFocus(T)}return!pa};eb.prototype.ph=function(T){return se.DOMElementExtensions.Ff(this.wc,T)};eb.prototype.Aj=function(){};eb.prototype.Qj=function(){};eb.prototype.reorderSheets=function(T,pa,hb){if(this.I_&&this.I_!==T){var Db=this.I_.index;this.$bj(this.I_,T,pa);T=T?T.index-1:pa?this.$.xa.count-1:0;Db!==T&&(this.tui(Db,T,hb),this.$jh(this.I_.name,T))}};eb.prototype.xZh=function(T){T=this.Sia(T);return-1!==T&&this.Wu<=T&&T<=
this.kK?this.Ah[T].domElement:null};eb.prototype.tRj=function(T){if(this.Ew){for(var pa=0;pa<this.vK.length;pa++){var hb=this.vK[pa];if(hb&&this.svgIconProvider){var Db=hb.parentNode;this.AOf(hb);Db&&(this.vK[pa]=this.svgIconProvider.nba(T?this.nHf[pa]:this.Rwd[pa],12,12,Db,24,24))}}for(pa=0;pa<this.Ah.length;pa++)this.Ah[pa].Pcg(T);this.CRa&&this.CRa.Dsa&&this.Ocg(xc.a.p0h,this.CRa,T);this.DH&&this.DH.Dsa&&this.Ocg(xc.a.x_g,this.DH,T)}};eb.prototype.Ocg=function(T,pa,hb){pa.M$a||(pa.M$a=this.svgIconProvider.nba(T,
12,12,pa.Dsa.parentNode,24,24));pa.M$a&&(se.DOMElementExtensions.setVisible(pa.Dsa,!hb),se.DOMElementExtensions.setVisible(pa.M$a,hb))};eb.prototype.yQi=function(T,pa){var hb=zf.g(this.$),Db=hb.inRangePicker,rc=Ud.HelperMethods.Rn(pa);if(hb.isEditing&&!Db){var vb=hb.Bj?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed",Uc=void 0;$e.EwaSettings.u6a&&(Uc=[Object(Ka.a)(hb.tc.textBox.aBa)]);Ka.b(this.$).cTa(rc.rawEvent,vb,Uc);hb.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}hb=this.Xwa&&
3===pa.zb;!(2===pa.zb&&rc.button===Sys.UI.MouseButton.leftButton||hb)||Db||this.jF||ff.a(this.$).Mq()||(hb&&T.uQi(),this.LAb=pa.clientPoint.x,this.dZ=pa,this.nNg(T))};eb.prototype.wQi=function(T){!this.yz&&this.jF&&this.FRd(T.sheet,!1)};eb.prototype.xQi=function(T){this.yz||(this.jF&&this.reorderSheets(T.sheet,!1,!0),this.vQ());this.m0()};eb.prototype.Joe=function(){return this.$.isEditMode&&!fa.k(this.$.mg)};eb.prototype.m0=function(){var T=this,pa=Ud.HelperMethods.gca(function(){T.xPj();T.qm&&T.Zqj();
T.vOd()});dc.ULS.sendTraceTag(537153757,0,50,"SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = {0}",pa)};eb.prototype.Zqj=function(){var T=this.kK===this.Ah.length-1;se.DOMElementExtensions.toggleCssClass(this.Pcb,this.$.lJ?Eb.JNe:Eb.xNe,!!this.Wu);se.DOMElementExtensions.toggleCssClass(this.Pcb,this.$.lJ?Eb.xNe:Eb.JNe,!T)};eb.prototype.vOd=function(T){T=void 0===T?!1:T;var pa=!this.Wu,hb=this.kK===this.Ah.length-1;this.lZf(4,this.sheetTabActivatePreviousHidden,!pa);this.lZf(5,this.sheetTabActivateNextHidden,
!hb);this.cwc(0,pa||T);this.cwc(1,pa||T);this.cwc(2,hb||T);this.cwc(3,hb||T)};eb.prototype.lZf=function(T,pa,hb){if(T=this.vK[T]){se.DOMElementExtensions.setVisible(T,hb);var Db=this.t_e(T);Db.title="img"===T.nodeName?T.alt=0<this.Ah.length&&hb?pa:"":T.title=0<this.Ah.length&&hb?pa:"";Db.tabIndex=hb?0:-1}};eb.prototype.t_e=function(T){return this.Ew?T.parentNode:T.parentNode.parentNode};eb.prototype.cwc=function(T,pa){if(T=this.vK[T])T=this.t_e(T),void 0!==T&&null!==T&&(!this.Ah.length||pa?(T.classList.add(xi.a.bZ),
T.setAttribute(ae.a.lsa,"true")):(T.classList.remove(xi.a.bZ),T.setAttribute(ae.a.lsa,"false")))};eb.prototype.uRa=function(T){var pa=this.$.lJ?this.Ah.length-1:0,hb=this.H1e(this.$.lJ?0:this.Ah.length-1);hb&&(hb.borderRightWidth=T?"1px":"0");this.Wu!==this.kK&&(hb=this.H1e(pa))&&(hb.borderRightWidth="0")};eb.prototype.Jle=function(T,pa){this.Ah||(this.Ah=[]);-1===pa?Array.add(this.Ah,T):Array.insert(this.Ah,pa,T)};eb.prototype.G4b=function(T,pa){var hb=-1,Db=null;pa||(hb=this.GRh(T.index),-1!==hb&&
(Db=this.rKa(hb)));T=new Pa(this.$,this.Xk,Db,T,this,this.qm,this.Ew);this.Jle(T,hb);se.DOMElementExtensions.setVisible(T.domElement,!0)};eb.prototype.FRd=function(T,pa){var hb=this.x2a(T);if(hb){this.Okd=T;this.hwd=pa;T=hb.domElement;hb=this.isRtl?T.offsetLeft+(this.Xk.scrollWidth-this.Xk.clientWidth-this.Xk.scrollLeft):T.offsetLeft-this.Xk.scrollLeft;if(!this.isRtl&&pa||this.isRtl&&!pa)hb+=T.offsetWidth;this.Gwc.style.left=Ud.HelperMethods.uc(hb-4);se.DOMElementExtensions.setVisible(this.Gwc,!0)}};
eb.prototype.o7e=function(){se.DOMElementExtensions.setVisible(this.Gwc,!1)};eb.prototype.y0=function(T){var pa=this,hb=Ud.HelperMethods.gca(function(){switch(T){case 0:pa.Juc(0);break;case 1:pa.Juc(pa.Wu-1);break;case 2:pa.Juc(pa.Wu+1);break;case 3:pa.scrollIntoView(pa.Ah.length-1);break;case 4:pa.Wu&&1<=pa.Ah.length&&(pa.yje(pa.Wu-1),pa.lMd());break;case 5:pa.kK!==pa.Ah.length-1&&1<=pa.Ah.length&&(pa.yje(pa.kK+1),pa.lMd());break;case 6:pa.lMd()}});this.o7b&&this.jF&&this.UNb();dc.ULS.sendTraceTag(537153755,
0,50,"SheetTabBarControl.ScrollSheetTabs: operation = {0}, duration = {1}",T,hb)};eb.prototype.yje=function(T){(T=this.RQ(T))&&T.activate()};eb.prototype.kAh=function(T){if(0===T.Gy)for(var pa=this.$.xa,hb=0,Db=0,rc=pa.count;Db<rc;Db++){var vb=Object(pg.a)(S.a,pa.getItem(Db));if(vb===T)return hb;0===vb.Gy&&hb++}return-1};eb.prototype.Yzh=function(T){var pa=this.$.xa;T=T.index+1;for(var hb=pa.count;T<hb;T++){var Db=Object(pg.a)(S.a,pa.getItem(T));if(0===Db.Gy)return Db}return null};eb.prototype.Sia=
function(T){for(var pa=0;pa<this.Ah.length;pa++){var hb=this.RQ(pa);if(!hb)dc.ULS.sendTraceTag(537153754,0,15,"SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[{0}] is null even though index is not out of bounds!",pa);else if(hb.sheet===T)return pa}return-1};eb.prototype.x2a=function(T){T=this.Sia(T);return this.RQ(T)};eb.prototype.tui=function(T,pa,hb){var Db={};Db.a=this.$.ya.UserSessionId;Db.b=hb;Db.c=this.Z6b;Db.d=T;Db.e=pa;Db.f=this.$.xa.count;nf.b().Pe(2,Db,hb)};eb.prototype.$bj=
function(T,pa,hb){var Db=Object(pg.a)(ca.a,this.$.xa);pa?(pa=pa.index,pa=T.index<pa?pa-1:pa):pa=hb?Db.count-1:0;Db.reorderSheet(T,pa,!0)};eb.prototype.JYf=function(T){zf.g(this.$).ug.Jo(T)};eb.prototype.nNg=function(T){if(!this.ctc){var pa=this.domElement.ownerDocument.body;this.yz?(Eg.a.instance.pa(Vf.a.vh,document.documentElement,this.wN),this.Xwa&&(ve.a.instance.pa(Vf.a.Bg,document.documentElement,this.wN),ve.a.instance.pa(Vf.a.Bg,this.domElement,this.NN))):(Eg.a.instance.pa(Vf.a.vh,pa,this.wN),
ve.a.instance.pa(Vf.a.Bg,pa,this.wN));Eg.a.instance.pa(Vf.a.Zd,document.documentElement,this.m6);ve.a.instance.pa(Vf.a.De,pa,this.m6);this.ctc=!0}this.I_=T.sheet;this.Z6b=!1;this.yz?(this.rM=null,this.g7b=T,this.aaa=T.domElement,this.ONd(se.DOMElementExtensions.getBoundingClientRect(this.aaa),"BeginSheetTabButtonDrag")):(dc.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),this.domElement.classList.add(Eb.wNe),this.domElement.style.cursor=
"",this.JYf("pointer"))};eb.prototype.vQ=function(T){T=void 0===T?!0:T;if(this.ctc){this.JYf(ae.a.J4);var pa=this.domElement.ownerDocument.body;this.yz?(Eg.a.instance.Aa(Vf.a.vh,document.documentElement,this.wN),this.Xwa&&(ve.a.instance.Aa(Vf.a.Bg,document.documentElement,this.wN),ve.a.instance.Aa(Vf.a.Bg,this.domElement,this.NN))):(Eg.a.instance.Aa(Vf.a.vh,pa,this.wN),ve.a.instance.Aa(Vf.a.Bg,pa,this.wN));Eg.a.instance.Aa(Vf.a.Zd,document.documentElement,this.m6);ve.a.instance.Aa(Vf.a.De,pa,this.m6);
this.lLc=this.ctc=!1}this.Ppc=0;this.Z6b=!1;this.Okd=this.I_=null;this.yz?(this.aaa&&(this.aaa.style.visibility="visible",this.aaa=null),this.g7b=null,this.ONd(null,"EndSheetTabButtonDrag"),this.rM&&(this.rM.parentNode&&this.rM.parentNode.removeChild(this.rM),this.rM=null),this.nej(T)):(this.domElement.classList.remove(Eb.wNe),this.o7e())};eb.prototype.nej=function(T){this.rTd(T);this.MC=this.LAb=-1};eb.prototype.$jh=function(T,pa){function hb(Uc,Td,mf){var bg=vb.Na(9,null);bg.sheetName=T;bg.newSheetIndex=
pa;return ye.i(vb,"ReorderSheets",bg,Uc,Td,mf,null,0)}function Db(){return new nb(T,pa)}var rc=this.$.na,vb=rc?rc.va:null;$e.EwaSettings.qc()?this.$.userOperationManager.jc(new Gb.a(557,0,hb,64,Db),null):this.$.userOperationManager.jc(new Va.a(557,0,hb,void 0,Db),null)};eb.prototype.RQ=function(T){return 0<=T&&T<this.Ah.length?this.Ah[T]:null};eb.prototype.G1e=function(T){return(T=this.RQ(T))?T.sheet:null};eb.prototype.rKa=function(T){return(T=this.RQ(T))?T.domElement:null};eb.prototype.H1e=function(T){return(T=
this.rKa(T))?T.style:null};eb.prototype.GRh=function(T){var pa=this.$.xa;T+=1;for(var hb=-1,Db=this.Ah?this.Ah.length:0;T<pa.count;){var rc=Object(pg.a)(S.a,pa.getItem(T));if(0===rc.Gy){for(hb=0;hb<Db&&this.G1e(hb)!==rc;hb++);break}T++}return-1===hb||hb===Db?-1:hb};eb.prototype.SBf=function(T){var pa=this.x2a(T);pa&&(this.yz&&this.jF&&(dc.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),$e.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.vQ()),this.Xk.removeChild(pa.domElement),pa=Array.indexOf(this.Ah,pa),Array.removeAt(this.Ah,pa),this.m0(),(!this.isRtl&&pa===this.Ah.length||this.isRtl&&!pa)&&this.uRa(!0),this.o7b&&this.jF?T===this.I_?(this.vQ(),this.y0(6)):this.UNb():this.y0(6))};eb.prototype.UBf=function(T){var pa=Object(pg.a)(S.a,T);this.yz&&this.jF&&(dc.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),$e.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.vQ());if(0===pa.Gy){this.uRa(!1);var hb=this.Sia(T);-1===hb&&(dc.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.G4b(pa,!1),hb=this.Sia(T));this.r5e(hb,!0)}};eb.prototype.acj=function(T,pa){var hb=this.x2a(T);hb&&(this.yz&&this.jF&&!pa&&(dc.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),$e.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&
this.vQ()),T=this.nFj(T,hb),!$e.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.yz&&T&&pa&&T.tQi())};eb.prototype.nFj=function(T,pa){var hb=Array.indexOf(this.Ah,pa),Db=this.kAh(Object(pg.a)(S.a,T));if(-1===Db||-1===hb)return null;hb!==Db||this.yz?(this.uRa(!1),Db=eb.Xbj(hb,Db,this.Wu,this.kK),this.Wu=Db.KAh,this.kK=Db.fpi,pa&&pa.domElement.parentNode===this.Xk&&(this.Xk.removeChild(pa.domElement),Array.removeAt(this.Ah,hb)),pa=this.Yzh(T),hb=this.Sia(pa),
pa=new Pa(this.$,this.Xk,this.rKa(hb),Object(pg.a)(S.a,T),this,this.qm,this.Ew),this.Jle(pa,hb),hb=this.Sia(T),this.r5e(hb,!1,!this.qm)):pa=null;return pa};eb.prototype.Mkh=function(){for(var T=this.Ah?this.Ah.length:0,pa=this.Wu,hb=this.kK,Db=0;Db<T;Db++){var rc=this.RQ(Db),vb=Db>=pa;rc&&(rc.tabIndex=vb&&Db<=hb?0:-1)}};eb.prototype.jOj=function(){for(var T=this.Ah?this.Ah.length:0,pa=0;pa<T;pa++){var hb=this.RQ(pa);hb&&hb.afb()}};eb.prototype.r5e=function(T,pa,hb){hb=void 0===hb?!0:hb;pa&&T<=this.Wu&&
this.Wu++;this.Mkh();this.uRa(!0);this.m0();this.o7b&&this.jF?this.UNb():hb&&this.y0(6)};eb.prototype.Ovc=function(T){var pa=this.$.lJ;if(T||this.isRtl!==pa)this.isRtl=pa,this.domElement.classList.remove(this.isRtl?O.a.ENe:O.a.KNe),this.domElement.classList.add(this.isRtl?O.a.KNe:O.a.ENe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.jOj();T||this.uRa(!0);for(T=0;T<this.vK.length;T++)0!==T&&3!==T&&(!this.qm||4!==T&&5!==T)&&this.mZf(T)};eb.prototype.k7g=function(){var T=this.RPd=document.createElement("div");
T.className=Eb.Uqh;this.qm&&T.classList.add(Eb.Vqh);this.domElement.appendChild(T);this.A4b(T,1,719,718);this.A4b(T,2,721,720);this.egf&&(this.CRa=new nc(this.$,this,T));this.qm||this.A4b(T,4,725,724)};eb.prototype.l7g=function(){var T=this.Iwc=document.createElement("div");T.className=Eb.Wqh;this.domElement.appendChild(T);this.qm||this.A4b(T,5,727,726);this.E3c()};eb.prototype.n8g=function(){var T=document.getElementById(ae.a.ytj),pa=document.getElementById(ae.a.ztj);T&&!pa&&dc.ULS.sendTraceTag(537153746,
0,50,"CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: {0}. progressBar div has child: {1}. ProgressBarMessage div exists: {2}",T.parentNode.id,!!T.firstChild,!!document.getElementById(ae.a.HPd));if(Ph.a.kgf(this.$)&&T&&pa)this.domElement.appendChild(T),this.SPd=T.firstChild,this.TPd=document.getElementById(ae.a.HPd),pa.style.visibility="visible";else{T=document.createElement("div");pa=document.createElement("div");T.className=O.a.erh;pa.className=
O.a.crh;pa.style.display="none";var hb=document.createElement("div");hb.className=O.a.frh;var Db=document.createElement("div");Db.className=O.a.drh;var rc=document.createElement("div");rc.className=O.a.brh;pa.appendChild(hb);pa.appendChild(Db);pa.appendChild(rc);T.appendChild(pa);this.domElement.appendChild(T);this.SPd=pa;this.TPd=Db}};eb.prototype.mZf=function(T){var pa=this.vK[T];if(pa)if(this.Ew){var hb=pa.parentNode;this.AOf(pa);pa=fc.a(this.$)?this.nHf[T]:this.Rwd[T];this.vK[T]=this.svgIconProvider.nba(pa,
12,12,hb,24,24)}else pa.className=this.Pwd[T]};eb.prototype.AOf=function(T){(null===T||void 0===T?0:T.parentNode)&&T.parentNode.removeChild(T)};eb.prototype.M4g=function(){var T=this.Pcb=document.createElement("div");T.className=Eb.Rqh;this.domElement.appendChild(T);this.s9g(T)};eb.prototype.s9g=function(T){var pa=document.createElement("div");pa.className=Eb.hrh;pa.classList.add(Eb.Sqh);this.$.printingEnabled||pa.classList.add(lg.a.QPe);T.appendChild(pa);this.Xk=document.createElement("ul");se.DOMElementExtensions.tu(this.Xk,
ae.a.NWc,null,null);this.Xk.className=lg.a.LNe;pa.appendChild(this.Xk);this.d7g();this.Vfe=document.createElement("div");this.Dwc.id="SheetIconTooltipContainer";pa.appendChild(this.Dwc)};eb.prototype.d7g=function(){var T=document.createElement("div"),pa="<div class='"+O.a.rYg+"'>{0}</div>",hb=bf.a.Kcd(O.a.fsh,0,"55_16_N","");T.innerHTML=String.format(pa,hb);T.className=Eb.grh;se.DOMElementExtensions.setVisible(T,!1);this.Gwc=T;this.Xk.appendChild(T)};eb.prototype.W3c=function(){for(var T=this.$.xa,
pa=0,hb=T.count;pa<hb;pa++){var Db=Object(pg.a)(S.a,T.getItem(pa));0===Db.Gy&&(this.G4b(Db,!0),Db.active&&Db.activate())}};eb.prototype.n0c=function(){Me.a.Dc(this.Ah);this.Ah=[];this.kK=this.Wu=0};eb.prototype.A4b=function(T,pa,hb,Db){function rc(mf){"mouseup"===mf.type&&vb.yz&&vb.jF||Gc.g(mf);Uc.classList.contains(xi.a.bZ)||(Td?vb.jNi(mf,pa):vb.qm||vb.ezf(mf,pa))}var vb=this,Uc=document.createElement("a");T.appendChild(Uc);T=this.Rwd[pa];this.vK[pa]=this.Cb(Uc,Le.a.instance.ga(Db),0,this.Pwd[pa],
Le.a.instance.ga(hb),T);if(5===pa||4===pa)se.DOMElementExtensions.UJ(this.vK[pa],Uc,!1,"span").style.marginTop="10px";this.mZf(pa);hb=this.Qwd[pa]=this.Ae.je(Uc);Eg.a.instance.pa(Vf.a.pointerDown,Uc,function(mf){return mf.ctrlKey&&vb.iHi(pa)?!0:vb.czf(pa)});Eg.a.instance.pa(Vf.a.Zd,Uc,function(){return vb.dzf()});ve.a.instance.pa(Vf.a.De,Uc,function(){return vb.dzf()});Eg.a.instance.pa(Vf.a.pointerOut,Uc,function(){return vb.f0c()});ah.KeyInputManager.instance.pa(Vf.a.Xb,Uc,function(mf){return 13!==
mf.Ca.keyCode&&32!==mf.Ca.keyCode||vb.d2c?!1:(vb.d2c=!0,vb.czf(pa))});ah.KeyInputManager.instance.pa(Vf.a.Vd,Uc,function(mf){return 13===mf.Ca.keyCode||32===mf.Ca.keyCode?(vb.d2c=!1,vb.f0c()):!1});var Td=this.Joe();hb.ka("mouseover",rc);hb.ka("mouseout",rc);hb.ka("focus",rc);hb.ka("blur",rc);Td&&hb.ka("mouseup",rc)};eb.prototype.fcf=function(T){var pa=!1,hb=this.$.Lf;hb&&(pa=ob.a.WM(se.DOMElementExtensions.getBoundingClientRect(hb),T.clientPoint));return pa};eb.prototype.ggf=function(T){return ob.a.WM(se.DOMElementExtensions.getBoundingClientRect(this.domElement),
T.clientPoint)||this.fcf(T)};eb.prototype.gAh=function(T){var pa=null,hb=T.clientPoint,Db=this.Wu;if(this.ggf(T))for(Db=this.Wu;Db<=this.kK;Db++)if(pa=this.RQ(Db))if(T=se.DOMElementExtensions.getBoundingClientRect(pa.domElement),!this.isRtl&&hb.x<T.x+T.width||this.isRtl&&hb.x>T.x)break;return{returnValue:pa,axj:Db>this.kK}};eb.prototype.UNb=function(){if(this.yz){if(!this.rM){dc.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");
this.rM=this.aaa.cloneNode(!0);if(!this.cUf(this.rM,this.aaa,!0,"UpdateDragAndDropState"))return;this.aaa.style.visibility="hidden";this.rM.classList.add(Eb.irh);this.rM.style.borderRightWidth="";this.tcc=this.dZ.clientPoint.x-this.W3.width/2;this.rM.style.left=this.tcc+"px";this.MC=this.Sia(this.I_);0>this.MC&&dc.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.o7b&&(this.MC=this.Sia(this.I_));var T=se.DOMElementExtensions.getBoundingClientRect(this.Xk),
pa=T.x;T=T.x+T.width;var hb=this.dZ.clientPoint.x-this.W3.width/2;hb=Math.min(hb,T-this.W3.width);hb=Math.max(hb,pa);this.rM.style.transform="translateX("+Math.abs(hb-this.tcc)*(this.tcc<hb?1:-1)+"px)";var Db=this.dZ.clientPoint.x>this.LAb,rc=this.dZ.clientPoint.x;hb>=T-this.W3.width?(rc=T-this.W3.width/2,this.iMd()||this.Jma||(dc.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.Xoc=this.Xk.scrollLeft,
this.Jma=window.requestAnimationFrame(this.HVf))):hb<=pa?(rc=pa+this.W3.width/2,this.hMd()||this.Jma||(dc.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.Xoc=this.Xk.scrollLeft,this.Jma=window.requestAnimationFrame(this.GVf))):this.Jma&&(dc.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.rTd());this.dZ.clientPoint.x!==
this.LAb&&(this.eUd(Db,rc),this.LAb=this.dZ.clientPoint.x)}else T=this.gAh(this.dZ),pa=T.axj,(T=T.returnValue)?this.FRd(T.sheet,pa):this.o7e();this.lLc=!0};eb.prototype.eUd=function(T,pa){for(var hb=this,Db;function(){var rc=hb.fhh(pa,T);Db=rc.C1b;return rc}().returnValue;)this.BMb=Db,this.MIg(T)};eb.prototype.MIg=function(T){if(this.BMb){var pa=(T?1:-1)*this.W3.width;if(T&&!this.$.lJ||!T&&this.$.lJ){var hb=this.aaa;var Db=this.MC+1;var rc=!0}else hb=(Db=this.RQ(this.MC+1))?Db.domElement:null,Db=
this.MC-1,rc=!1;if(this.cUf(this.BMb,hb,rc,"AnimateSheetSwap")){dc.ULS.sendTraceTag(537153738,0,50,"SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index {0} and other sheet-index {1}. amount of sheets in the bar: {2} isMovingRight: {3}",this.MC,Db,this.PPd,T);0<=this.MC&&this.MC<this.Ah.length&&0<=Db&&Db<this.Ah.length?(T=this.Ah[Db],this.Ah[Db]=this.Ah[this.MC],this.Ah[this.MC]=T):(dc.ULS.sendTraceTag(537153737,0,15,"SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: {0}, ghostIndex: {1}, swappedSheetIndex: {2}",
this.Ah.length,this.MC,Db),this.vQ());this.MC=Db;var vb=this.BMb;vb.style.transform="translateX("+pa+"px)";window.requestAnimationFrame(function(){vb.style.transform="translateX(0px)"})}}};eb.prototype.cUf=function(T,pa,hb,Db){function rc(vb){return vb?String.format("Node ID: {0} , Node class: {1}, Node name: {2},",vb.id,vb.className,vb.nodeName):null}try{return this.Xk.insertBefore(T,pa),!0}catch(vb){return T=this.x2a(this.I_),dc.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",
T?T!==this.g7b?"Changed":"NoChange":"Removed",Db,rc(pa),rc(pa.parentNode),rc(this.Xk),hb,this.MC,this.PPd,vb),this.vQ(),!1}};eb.prototype.fhh=function(T,pa){var hb=this.$.lJ===pa?this.RQ(this.MC-1):this.RQ(this.MC+1);if(!hb)return{returnValue:!1,C1b:null};hb=hb.domElement;var Db=se.DOMElementExtensions.getBoundingClientRect(hb);return this.W3?pa?{returnValue:T+this.W3.width/2>=Db.x+.5*Db.width,C1b:hb}:{returnValue:T-this.W3.width/2<=Db.x+.5*Db.width,C1b:hb}:(dc.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.vQ(),{returnValue:!1,C1b:hb})};eb.prototype.EVf=function(T,pa){var hb=pa?this.HVf:this.GVf;if(-1===this.vyc)this.vyc=T,this.Jma=window.requestAnimationFrame(hb);else{T=Math.floor((T-this.vyc)/1E3*300);var Db=this.MIb>this.tBb?1:-1;this.scrollLeft(Math.abs(this.Xk.scrollLeft-(pa?this.Xoc+T*Db:this.Xoc-T*Db))*(pa?-1:1));if(T=this.QYe("ScrollStep"))this.eUd(pa,T.x+T.width/2),pa&&!this.iMd()||!pa&&!this.hMd()?this.Jma=window.requestAnimationFrame(hb):(dc.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.rTd())}};eb.prototype.iMd=function(){var T=this.MIb>this.tBb;return T&&this.ona>=this.MIb||!T&&this.ona<=this.MIb};eb.prototype.hMd=function(){var T=this.MIb>this.tBb;return T&&this.ona<=this.tBb||!T&&this.ona>=this.tBb};eb.prototype.rTd=function(T){T=void 0===T?!0:T;this.Xk&&(this.ona=this.Xk.scrollLeft);window.cancelAnimationFrame(this.Jma);this.Jma=0;this.vyc=-1;T&&this.m0()};eb.prototype.ONd=function(T,pa){T||dc.ULS.sendTraceTag(537153733,0,50,"SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by {0}",
pa);this.W3=T};eb.prototype.iHi=function(T){return 2===T?(this.y0(3),!0):1===T?(this.y0(0),!0):!1};eb.prototype.czf=function(T){var pa=this;dc.ULS.shipAssertTag(537153732,0,-1===this.hPa&&-1===this.gPa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.hPa&&(window.clearTimeout(this.hPa),this.hPa=-1);-1!==this.gPa&&(window.clearInterval(this.gPa),this.gPa=-1);this.y0(T);this.hPa=window.setTimeout(function(){pa.XCj(T)},
this.RAi);return!0};eb.prototype.XCj=function(T){var pa=this;this.gPa=window.setInterval(function(){pa.y0(T)},this.QAi)};eb.prototype.dzf=function(){this.f0c();return!this.yz||!this.jF};eb.prototype.f0c=function(){window.clearTimeout(this.hPa);window.clearInterval(this.gPa);this.gPa=this.hPa=-1;return!0};eb.prototype.ezf=function(T,pa){var hb=this.Pwd[pa];Ud.HelperMethods.sVd(this.vK[pa],hb,hb+ae.a.Xdc,"mouseover"===T.type||"focus"===T.type)};eb.prototype.jNi=function(T,pa){var hb=this.qgc(pa),Db=
5===pa;if("mouseup"===T.type){if(Db||4===pa)hb||this.reorderSheets(null,Db,!1),this.vQ()}else!this.yz&&this.jF?(hb||this.FRd(this.G1e(Db?this.kK:this.Wu),Db),this.y0(Db?2:1)):this.qm||this.ezf(T,pa)};eb.prototype.qgc=function(T){return!!se.DOMElementExtensions.Jdd(this.vK[T],"a").title};eb.prototype.YBc=function(T){this.sYd(T);this.m0()};eb.prototype.sYd=function(T){(T=this.x2a(T))&&T.afb()};eb.prototype.lMd=function(){var T=this.$.xa;if(T.qa&&(!kh.e(this.$)||T.count))if(T=this.Sia(T.qa),-1===T)dc.ULS.sendTraceTag(537153729,
0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var pa=this.rKa(T);T<this.Wu?this.Juc(T):T>this.Wu&&!this.xqd(pa)&&this.scrollIntoView(T)}};eb.prototype.xPj=function(){this.Wu=0;this.kK=this.Ah.length-1;for(var T=!1,pa=0;pa<this.Ah.length;pa++){var hb=this.RQ(pa);if(!hb)break;var Db=this.xqd(hb.domElement);hb.tabIndex=Db?0:-1;if(!T&&Db)this.Wu=pa,T=!0;else if(T&&!Db){this.kK=pa-1;break}}};eb.prototype.Juc=function(T){this.$.xa.count&&(this.Ah.length||
this.W3c(),this.uXf(this.rKa(Math.max(0,Math.min(T,this.Ah.length-1)))),this.m0())};eb.prototype.scrollIntoView=function(T){dc.ULS.shipAssertTag(537153697,0,T>=this.Wu,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.xa.count){this.Ah.length||this.W3c();var pa=this.rKa(Math.max(0,Math.min(T,this.Ah.length-1))),hb=this.rKa(this.Wu);if(!this.xqd(pa)){pa=se.DOMElementExtensions.getBoundingClientRect(pa);var Db=se.DOMElementExtensions.getBoundingClientRect(this.Pcb);
pa=this.isRtl?Db.x-pa.x:pa.x+pa.width-(Db.x+Db.width);for(Db=0;hb&&Db<pa;){var rc=se.DOMElementExtensions.getBoundingClientRect(hb);Db+=rc.width;hb=hb.nextSibling}hb?this.uXf(hb):dc.ULS.sendTraceTag(537153696,0,15,"SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = {0}, lastVisibleSheetTabIndex = {1}, scroll to index: {2}",this.Wu,this.kK,T)}this.m0()}};eb.prototype.uXf=function(T){var pa=se.DOMElementExtensions.getBoundingClientRect(this.Xk);T=se.DOMElementExtensions.getBoundingClientRect(T);
this.isRtl?this.scrollLeft(Math.floor(pa.x+pa.width-(T.x+T.width+.5))):this.scrollLeft(Math.ceil(pa.x-T.x-.5))};eb.prototype.scrollLeft=function(T){(0>T&&this.iMd()||0<T&&this.hMd())&&dc.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");var pa=this.Xk.scrollLeft;if(this.isRtl){if(ya.a.mF||ya.a.Nf){this.Xk.scrollLeft=this.ona=pa-T;return}if(ya.a.lB||ya.a.JH){this.Xk.scrollLeft=this.ona=pa+T;return}dc.ULS.sendTraceTag(537153694,
0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Xk.scrollLeft=this.ona=pa-T};eb.prototype.xqd=function(T){T=se.DOMElementExtensions.getBoundingClientRect(T);var pa=se.DOMElementExtensions.getBoundingClientRect(this.Pcb);return T&&pa?T.x>=pa.x-1&&T.x+T.width<=pa.x+pa.width+1:(dc.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)};eb.prototype.F7g=function(){var T=this.Iwc;if(Bb.Z0f(this.$))this.qm?(Me.a.Ha(this.DH),
this.DH=new Bb(T,this.$,this,!0)):(Me.a.Ha(this.DH),this.DH=null);else if(!this.DH||this.qm)Me.a.Ha(this.DH),fa.k(this.$.mg)?this.DH=new mb(T,this.$,this):this.DH=new Bb(T,this.$,this)};eb.prototype.FDe=function(T,pa){var hb=this.$.xa;if(!this.$.isEditMode||!hb.count)Me.a.Ha(pa),pa=null;else if(!pa)if(hb=this.qm?this.RPd:this.Iwc,fa.k(this.$.mg))pa=new mb(hb,this.$,this);else switch(T){case 0:pa=new Bb(hb,this.$,this);break;case 1:pa=new db(hb,this.$,this);break;default:dc.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return pa};eb.prototype.E3c=function(){$e.EwaSettings.ma(427)?(this.DH=this.FDe(0,this.DH),this.Yxb=this.FDe(1,this.Yxb)):this.F7g()};eb.prototype.QYe=function(T){var pa=se.DOMElementExtensions.getBoundingClientRect(this.rM);pa||(dc.ULS.sendTraceTag(537153689,0,50,"SheetTabBarControl.{0}: GetBoundingClientRect returned null for the dragged sheet.",
T),this.vQ());return pa};eb.prototype.i5e=function(T,pa){this.Rta.QJg(T,pa);this.vQ(!1);this.vOd(this.navigationButtonsDisabled);T=Gl(this.AFj);for(pa=T.next();!pa.done;pa=T.next())(pa=pa.value)&&pa.yX(this.navigationButtonsDisabled);T=Gl(this.Fse);for(pa=T.next();!pa.done;pa=T.next())(pa=pa.value)&&pa.yX(this.operationButtonsDisabled)};eb.Xbj=function(T,pa,hb,Db){T<hb?(pa>hb&&hb--,pa>Db&&Db--):T>Db?(pa<hb&&hb++,pa<Db&&Db++):pa<hb&&hb++;return{KAh:hb,fpi:Db}};Ck.Object.defineProperties(eb.prototype,
{wc:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},xe:{configurable:!0,enumerable:!0,get:function(){return fg.a.OPd}},jF:{configurable:!0,enumerable:!0,get:function(){return this.lLc}},PPd:{configurable:!0,enumerable:!0,get:function(){return this.Ah.length}},Dwc:{configurable:!0,enumerable:!0,get:function(){return this.Vfe}},Xwa:{configurable:!0,enumerable:!0,get:function(){return this.m9d}},
navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.Rta&&this.Rta.navigationButtonsDisabled}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.Rta&&this.Rta.operationButtonsDisabled}},Pwd:{configurable:!0,enumerable:!0,get:function(){return this.qm?this.$.lJ?[O.a.n8b,O.a.GNe,O.a.INe,O.a.m8b,O.a.tua,O.a.tua]:[O.a.m8b,O.a.INe,O.a.GNe,O.a.n8b,O.a.tua,O.a.tua]:this.$.lJ?[O.a.n8b,O.a.FNe,O.a.HNe,O.a.m8b,O.a.tua,O.a.tua]:[O.a.m8b,O.a.HNe,
O.a.FNe,O.a.n8b,O.a.tua,O.a.tua]}},Rwd:{configurable:!0,enumerable:!0,get:function(){return this.$.lJ?[null,xc.a.cAe,xc.a.aAe]:[null,xc.a.aAe,xc.a.cAe]}},nHf:{configurable:!0,enumerable:!0,get:function(){return this.$.lJ?[null,xc.a.dAe,xc.a.bAe]:[null,xc.a.bAe,xc.a.dAe]}},tBb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(ya.a.mF)return 0;if(ya.a.Nf)return-1*(this.Xk.scrollWidth-this.Xk.clientWidth);if(ya.a.kv)return this.Xk.scrollWidth-this.Xk.clientWidth;dc.ULS.sendTraceTag(537153762,
0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}},MIb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(ya.a.mF)return this.Xk.scrollWidth-this.Xk.clientWidth;if(ya.a.Nf||ya.a.kv)return 0;dc.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Xk.scrollWidth-this.Xk.clientWidth}},Fse:{configurable:!0,enumerable:!0,get:function(){return this.Rta?[this.DH,this.Yxb]:[this.DH,this.Yxb,this.CRa]}},AFj:{configurable:!0,
enumerable:!0,get:function(){return this.Ah.concat(this.CRa)}},Atj:{configurable:!0,enumerable:!0,get:function(){return this.Ufe}}});Object(Zd.a)(eb,"SheetTabBarControl",Xf.a,[893,3,415]);var hi=Jf.a;Wl(Ra,hi);Ra.prototype.create=function(){var T=this,pa=this.$.Mb,hb=$e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.makingFosSheetTabOptional",!1);if(da.a(this.$.ya,1))hb&&Ci.PageLoadTrackingInfo.instance.rda(ae.a.Pna,["sheetTabBar"]);else{var Db=document.getElementById(pa+ae.a.a5c);Db?($e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",
!1)&&Ci.PageLoadTrackingInfo.instance.lAa(ae.a.Pna),Ph.a.Lpd()?jc.TaskExtensions.Ba(qb.GetServiceTaskFactory.Xa(this.$.da,388,387,this.vb),function(rc){T.Eb(T.$.da.za(32)||new eb(T.$,Db,rc.result))},this.$.la,3):this.Eb(this.$.da.za(32)||new eb(this.$,Db))):hb&&Ci.PageLoadTrackingInfo.instance.rda(ae.a.Pna,["sheetTabBar"])}};Ra.ka=function(T){T.da.Ga(33,new Ra(T))};Object(Zd.a)(Ra,"SheetTabBarFactory",Jf.a,[]);var Mi=b(52),uj=b(200);$a.prototype.IOa=function(){uj.a.instance.ZId(Object(of.a)(this,
this.IOa,"onSessionExpiredDetected"));dc.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.K2h()};$a.prototype.FBf=function(){uj.a.instance.YId(Object(of.a)(this,this.FBf,"onSessionExpiringDetected"));this.Jfe||this.yQc||(dc.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Jfe=!0,this.Azj())};$a.prototype.K2h=function(){this.yQc||(Kc.AFrameworkApplication.PF(Mi.a.tvc),this.yQc=!0,this.zzj())};Object(Zd.a)($a,"ASessionExpirationManager",null,
[]);var uh=b(259),Ui=b(6),Zh=b(81),fi=b(262);Wl(la,$a);la.prototype.lne=function(T){this.Pa.addHandler("SessionExpired",T)};la.prototype.oZb=function(T){this.Pa.addHandler("TokenRefreshed",T)};la.prototype.MId=function(T){this.Pa.removeHandler("TokenRefreshed",T)};la.prototype.kdc=function(){return uj.a.instance.nR(Kc.AFrameworkApplication.vk)};la.prototype.dispose=function(){Me.a.Ha(this.Pa);this.$=null};la.prototype.Azj=function(){this.$.isEditMode&&this.Icc(!1)};la.prototype.zzj=function(){this.Xlb=
!0;this.Icc(!0);this.Pa.raiseEvent("SessionExpired")};la.prototype.Icc=function(T){var pa=this;dc.ULS.sendTraceTag(537170715,0,15,"EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired {0}, GotDeploymentOrTimedOutError {1}",T,this.$.ea.Waa);var hb=this.$.Ab.Wp;T&&hb&&hb.isVisible&&1299163859===hb.error.MessageId&&this.$.Ab.Wp.Ut();var Db=this.gd(T);ff.a(this.$).tt(new uh.a(Ui.a.oz,5,function(){var rc=vh.a(pa.$),vb=rc.ud.activityState;vb[Zh.a.t2]=pa.$.Wob(pa.$.isEditMode);vb[Zh.a.UL]=
Zh.a.J8a;vb[fi.a.hr]=Ui.a.accessTokenExpiringWarning;rc.ud.Jt([Db])}))};la.prototype.gd=function(T){return T?Df.a.gEe():this.m9g()};la.prototype.m9g=function(){var T=Df.a.gd(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");T.Description=this.accessTokenExpiringMessage;return T};Ck.Object.defineProperties(la.prototype,{accessTokenExpiringMessage:{configurable:!0,enumerable:!0,get:function(){var T=(new Date(this.vk)).format(this.$.ya.ShortTimeFormat);return String.format(Le.a.instance.Bb(78),T)}},
tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.Xlb}},Scb:{configurable:!0,enumerable:!0,get:function(){return!1}},Jba:{configurable:!0,enumerable:!0,get:function(){return!1}},bHd:{configurable:!0,enumerable:!0,get:function(){return!1}},H5:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(Zd.a)(la,"EwaAccessTokenExpirationManager",$a,[898,223,3]);var wg=b(176),gj=b(736);Object(Zd.a)(va,"RefreshAccessTokenContext",null,[]);var Ei=b(177),Fi=b(119),ck=b(146),Uh=
b(34),Xg=b(116);Object(Zd.a)(Tb,"Error",null,[]);Object(Zd.a)(tb,"NamedResult",null,[]);Wl(Ya,tb);Object(Zd.a)(Ya,"ErrorInfo",tb,[]);Ck.Object.defineProperties(Ia.prototype,{PO:{configurable:!0,enumerable:!0,get:function(){return this.iXb}},errors:{configurable:!0,enumerable:!0,get:function(){return this.kT}}});Object(Zd.a)(Ia,"TokenRefreshArgs",null,[907]);La.prototype.lne=function(T){this.Pa.addHandler("SessionExpired",T)};La.prototype.oZb=function(T){this.Pa.addHandler("TokenRefreshed",T)};La.prototype.MId=
function(T){this.Pa.removeHandler("TokenRefreshed",T)};La.prototype.kdc=function(){return uj.a.instance.nR(Kc.AFrameworkApplication.vk)};La.prototype.dispose=function(){uj.a.instance.ZId(this.z5e);uj.a.instance.YId(this.$4e);var T=this.$.ea;T&&(T.Dk(this.od),T.Msc(this.uya));Me.a.Ha(this.Pa);this.documentVisibilityObserver=this.$=null};La.prototype.z8f=function(){return this.kdc()?0:(Kc.AFrameworkApplication.vk-(new Date).getTime())/6E4};La.prototype.Zcg=function(T,pa){if(0<pa&&!this.kdc()){var hb=
Kc.AFrameworkApplication.fa.Dd("AccessTokenExpirationPromptSeconds",Kc.AFrameworkApplication.qY),Db=(pa-T.getTime())/6E4;dc.ULS.shipAssertTag(537170713,0,0<=Db,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [{0}] creationTime [{1}] tokenLifetimeInMin [{2}]",pa,T.getTime(),Db);Db<this.azi?(dc.ULS.sendTraceTag(537170712,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",
this.A0f,Db),Kc.AFrameworkApplication.qY=this.A0f):Kc.AFrameworkApplication.qY!==hb&&(dc.ULS.sendTraceTag(537170711,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",hb,Db),Kc.AFrameworkApplication.qY=hb)}};La.prototype.I3g=function(T){return!this.context||this.context.jHb||this.context.e4c!==T?(T=new va(wg.a.create().toString(),T),this.context&&!this.context.dAc&&dc.ULS.sendTraceTag(537170710,0,15,"TokenManager.InitContext: creating new context [{0}] although previeous one [{1}] not used successfully, isPreviousOneRefreshedSuccessfully [{2}] ",
T.correlationID,this.context.correlationID,this.context.jHb),this.dT=T,!0):!1};La.prototype.pej=function(T){T&&this.cH&&!this.Jba&&this.$.ea.Ue.ur&&!this.H5&&(this.cH=!1)};La.prototype.A5e=function(T){var pa=this;this.pej(T);if(!(this.Vkb||this.Bdb&&!T||this.cH)&&this.Scb){this.Vkb=!0;var hb=this.context?this.context.creationTime:null,Db=this.I3g(T);this.dud=!0;var rc=this.$.ea,vb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh",newContextCreated:Db};vb.IsUserActive=rc.Ue.ur;vb.IsSessionActive=
rc.rc;vb.ContainsChangesWorkbookOperations=this.$.userOperationManager.mHa();vb.isSessionExpired=T;vb.stopRefreshRetriesUntilTokenExpired=this.Bdb;vb.FailedToRefreshExpiredToken=this.cH;vb.numOfFailuresWhileUserIsActive=Xg.a.e6;vb.numOfFailuresWhileUserIsInActive=Xg.a.f6;vb.numOfFailuresWhileOffline=Xg.a.cya;vb.RefreshAccessTokenCorrelationID=this.context.correlationID;Db&&hb&&(vb.TimeInMinFromPreviosContextCreation=Math.round(Fi.b(jf.a.Ua,hb)/60));hb=wi.a.Jc(vb);dc.ULS.sendTraceTag(40416199,0,50,
hb);this.$Gd.start();this.B9d=rc.Ue.ur;this.Cx=new gj.a;this.Iqi(T);var Uc=this.wVd.P5i(!T,this.Cx?this.Cx.token:null);Uc.continueWith(function(){pa.rXg();var Td=pa.wVd.c0i(Uc);pa.$Gd.stop();var mf=pa.kdc();if(!Td||$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&mf){var bg=Uc.result.errors;Td&&mf&&pa.vAg(bg);pa.s2h(bg,T)}else pa.Bdb=!1,pa.u2h(Uc.result.PO,T);pa.Vkb=!1},this.T9b?8:0)}};La.prototype.vAg=function(T){var pa=[Object(He.a)(new Tb,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];
T.add(Object(He.a)(new Ya,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:pa}))};La.prototype.Iqi=function(T){T&&(this.$.ea.Ue.ur?this.e5f():(this.$.ea.Ue.Sga(this.wBd),this.oHb=!0))};La.prototype.e5f=function(){var T=this;this.Grc=Ei.AsyncMethodContext.Zs(function(){T.O5i()},1E3*this.pMf,kb.a.v5i,this.Grc)};La.prototype.rXg=function(){this.Grc&&this.Grc.cancel();this.oHb&&(this.$.ea.Ue.Gza(this.wBd),this.oHb=!1);this.Cx=null};La.prototype.O5i=function(){dc.ULS.sendTraceTag(537170706,0,15,"EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [{0}]",
this.pMf);this.Cx.C()};La.prototype.s2h=function(T,pa){this.Bdb=!0;pa&&(this.cH||(this.Xlb=this.cH=!0),this.wVd.bhc(T)&&(this.a$d=!0));var hb=!pa||this.Scb&&!Xg.a.$wc?40380379:39982555;pa=this.LCe(pa);pa.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";pa.FailedToRefreshExpiredToken=this.cH;pa.LastErrorIsPermanent=this.H5;if(0<T.count){var Db=T.oa(0);pa.errorName=Db.Name;0<Db.Errors.length&&(pa.ErrorId=Db.Errors[0].Id,Db=Db.Errors[0].Details,pa.ErrorDetails=this.Ggh(Db.toString())?
"PiiScrubbed":Db)}pa=wi.a.Jc(pa);dc.ULS.sendTraceTag(hb,0,15,pa);this.Pa.raiseEvent("TokenRefreshed",new Ia(null,T))};La.prototype.Ggh=function(T){return Pf.a.contains(T,"makes the internet safe for businesses",!0)};La.prototype.LCe=function(T){var pa={},hb=this.$.ea;pa.Name="";pa.IsUserActive=hb.Ue.ur;pa.IsSessionActive=hb.rc;pa.GotDeploymentOrTimedOutError=hb.Waa;pa.TimeInSecFromLastStatefulSuccessfulRequest=hb.T7;pa.TimeFromLastUserActivityInMs=hb.Ue.$db;pa.calledFromSessionExpiredFlow=T;pa.RefreshTokenDurationInMS=
this.$Gd.Bc;pa.numOfFailuresWhileUserIsActive=Xg.a.e6;pa.numOfFailuresWhileUserIsInActive=Xg.a.f6;pa.numOfFailuresWhileOffline=Xg.a.cya;pa.RefreshAccessTokenCorrelationID=this.context.correlationID;pa.accessTokenTTL=Kc.AFrameworkApplication.vk;pa.ContainsChangesWorkbookOperations=this.$.userOperationManager.mHa();pa.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.zi.toString():"Unknown";pa.TimeFromFirstOpenInHr=Math.floor(Fi.b(jf.a.Ua,Gf.toUtc(hb.wEf))/3600);return pa};
La.prototype.u2h=function(T,pa){this.cH=!1;this.URj();this.Zcg(new Date,Kc.AFrameworkApplication.vk);var hb=this.$.ea,Db=!pa&&hb.Ue.ur,rc=!this.$.isEditMode&&hb.wab;pa=this.LCe(pa);pa.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";pa.shouldTriggerSilentReloadAfterExpiring=Db;pa.WopiTokenTaskItemPriority=Kc.AFrameworkApplication.$Zd;pa.isDirtyViewSession=rc;pa=wi.a.Jc(pa);dc.ULS.sendTraceTag(39982556,0,15,pa);this.Pa.raiseEvent("TokenRefreshed",new Ia(T,null));rc?hb.Ue.ur&&(dc.ULS.sendTraceTag(537170705,
0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),hb.abd()):hb.Ue.ur?Db&&(T=vh.a(this.$).ud.activityState,T[Xg.a.reb]=!0,T[ck.a.uY]=!0,T[Uh.a.Ns]=this.$.isEditMode,ff.a(this.$).tt(new uh.a(Ui.a.xna,2,null))):hb.rc&&ye.m(this.$.na.va,!0,!1,!1,null,null,null,null,null)};La.prototype.URj=function(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=
sa.a.VT(this.$.ea.workbookContext.WorkbookUri,Kc.AFrameworkApplication.yP,Kc.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=sa.a.VT(this.$.ea.workbookContext.WorkbookUri,Kc.AFrameworkApplication.rY,Kc.AFrameworkApplication.vk.toString()),this.$.ea.Moc()):dc.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ya.AccessToken=Kc.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=Kc.AFrameworkApplication.vk;
void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=sa.a.VT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,Kc.AFrameworkApplication.yP,Kc.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=sa.a.VT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,Kc.AFrameworkApplication.rY,Kc.AFrameworkApplication.vk.toString()));
void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=sa.a.VT(this.$.ya.EmbedConfiguratorUrl,Kc.AFrameworkApplication.yP,Kc.AFrameworkApplication.accessToken),this.$.ya.EmbedConfiguratorUrl=sa.a.VT(this.$.ya.EmbedConfiguratorUrl,Kc.AFrameworkApplication.rY,Kc.AFrameworkApplication.vk.toString()));this.context.jHb=!0};Ck.Object.defineProperties(La.prototype,{tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.Xlb}},Jba:{configurable:!0,
enumerable:!0,get:function(){return this.B9d}},H5:{configurable:!0,enumerable:!0,get:function(){return this.a$d}},context:{configurable:!0,enumerable:!0,get:function(){return this.dT}},Scb:{configurable:!0,enumerable:!0,get:function(){return this.H5?!1:this.$.ea.Ue.ur?1>Xg.a.e6:6>Xg.a.f6}},bHd:{configurable:!0,enumerable:!0,get:function(){return this.Vkb}}});Object(Zd.a)(La,"EwaAccessTokenExpirationRefreshManager",null,[898,223,3]);za.kYb="ActivityDuration";za.error="Error";za.glh="Errors";za.failed=
"Failed";za.xAh="FirstActivity";za.initialized="Initialized";za.Qoi="LastActivity";za.Zfj="RetryOverride";za.Ndj="RequestGroups";za.requests="Requests";za.DSf="Responses";za.uvc="SessionDuration";za.status="Status";za.success="Success";za.sMb="Successful";za.PO="Tokens";Object(Zd.a)(za,"SessionExpirationStrings",null,[]);ka.prototype.Rfg=function(){var T={};dc.ULS.sendTraceTag(41964821,217,50,dc.ULS.Jc((T.Aggregate=this.NX,T.Current=this.Mo,T)))};ka.prototype.k$h=function(){this.NX[za.Ndj]=0;this.NX[za.requests]=
0;this.NX[za.DSf]=0;this.NX[za.status]=za.initialized;this.NX[za.xAh]=new Date;this.NX[za.uvc]=0;this.NX[za.kYb]=0;this.NX[za.uvc]=0;this.Mo[za.uvc]=0;this.NX[za.kYb]=0;this.Mo[za.kYb]=0};ka.prototype.Kkd=function(T,pa){var hb=T[pa];hb=hb?hb:0;hb++;T[pa]=hb;this.lOd(T)};ka.prototype.lOd=function(T){var pa=new Date;T[za.kYb]=+pa-+this.MTb;this.MTb=pa;T[za.uvc]=+this.MTb-+this.bvg;T[za.Qoi]=this.MTb};ka.prototype.xcb=function(T,pa){this.Mo[T]=pa;this.lOd(this.Mo)};ka.prototype.UXf=function(T,pa){this.Mo[T]=
pa;this.lOd(this.Mo)};ka.prototype.incrementCounter=function(T){this.Kkd(this.Mo,T);this.Kkd(this.NX,T);this.Kkd(this.ltg,T)};ka.prototype.flush=function(){this.w9d||(this.NX[za.status]=this.Mo[za.status],this.Rfg(this.ZWb),this.ue.ena(this.ZWb,6E4*this.mlf))};ka.prototype.stop=function(){dc.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.w9d=!0;this.ue.Xp(this.ZWb)};Object(Zd.a)(ka,"SessionLogger",null,[908]);var Oi=b(737),Wj=b(1143);Ea.prototype.lLi=
function(T){if(T.MessageId!==pc.a.Pjd)ke.a(39408099,306,15,"Unexpected message.");else{var pa=new le.a,hb=new le.a;this.lj.incrementCounter(za.DSf);var Db=T.Values[hc.a.bXf];if(!Db||0>=Db.length)ke.a(40122317,306,15,"Found no tokens in the dictionary"),Db=T.Values;ke.a(40122318,306,100,"The Tokens array contains {0} tokens",Db.length);this.lj.xcb("Correlation",T.CorrelationId);for(var rc="",vb=0;vb<Db.length;vb++){this.lj.UXf(za.PO,Db.length);var Uc=Db[vb],Td=Uc;if(Td&&Td.Name){this.lj.incrementCounter(Td.Name);
var mf=Uc;if(mf&&mf.Value)ke.a(39408128,306,100,"Received token with name: {0}",mf.Name),pa.add(mf),this.iXb.add(mf),this.lj.xcb(za.status,za.success),this.l5d&&this.BT&&this.BT.Nej();else if(Uc=this.zVh(Uc),ke.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",Td.Name,JSON.stringify(Uc),this.sga),hb.add(Uc),this.kT.add(Uc),rc=JSON.stringify(Uc),this.lj.xcb(za.error,JSON.stringify(Uc)),this.lj.xcb(za.status,za.failed),this.l5d)for(Td=Gl(Uc.Errors),Uc=Td.next();!Uc.done;Uc=
Td.next())Uc=this.GMh(Uc.value),this.BT&&this.BT.KCg(Uc)}}0<hb.count&&""!==rc?(Db=Object.assign(new nh.a,{extendedProperties:new Map}),Db.extendedProperties.set("Errors",rc),Lg.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Db)):Lg.Health.instance.recordKpiSuccess("WACTokenRefresh",null);ke.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",pa.count,hb.count,T.CorrelationId,this.sga);0<hb.count&&!this.bhc(hb)?(T=
this.p9.VUh(hb),T!==this.p9.aLd&&(this.lj.UXf(za.Zfj,T),this.ue.ena(this.Vi,T))):(this.lj.flush(),this.Vi&&(ke.a(39408131,306,100,"Deleting task {0} from task manager",this.Vi.name),this.ue.Xp(this.Vi)),this.dm&&!this.dm.task.isCompleted&&this.dm.setResult(new Ia(pa,hb)))}};Ea.prototype.zVh=function(T){if(!T)return null;var pa=Object.assign(new Ya,{Name:T.Name,Errors:[]});T=Gl(T.Errors);for(var hb=T.next();!hb.done;hb=T.next()){hb=hb.value;var Db=new Tb;Db.Id=hb.Id;Db.Details=this.yVh(hb.Details);
pa.Errors.push(Db)}return pa};Ea.prototype.yVh=function(T){if(!T)return"";var pa=T.toString().toLowerCase();return 0<pa.indexOf("<!doctype")?this.Efd("Seems to contain HTML - Contains <!DOCTYPE"):0<pa.indexOf("<html")?this.Efd("Seems to contain HTML - Contains <html>"):500<pa.length?this.Efd(String.format("Error details content too long: Length: {0}",pa.length)):T};Ea.prototype.Efd=function(T){return String.format("{0} - Reason: [{1}]","### REDACTED ###",T)};Ea.prototype.requestTokensOnce=function(){this.MRf()};
Ea.prototype.MRf=function(){Kc.AFrameworkApplication.bkc("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.ira>=this.p9.Zxi?(ke.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.sga),this.RCe(this.dm,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(Lg.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.Lkj())};Ea.prototype.Lkj=function(){var T={};T[hc.a.bXf]=
this.p9.PO;var pa=wg.a.create().toString();ke.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.p9.PO),this.ira+1,pa,this.sga);this.kde.execute(function(hb){hb.Gj(pc.a.zpe,T,pa)});this.ira++;this.lj.incrementCounter(za.requests)};Ea.prototype.RCe=function(T,pa,hb){for(var Db=new le.a,rc=0;rc<this.p9.PO.length;rc++){var vb=Object.assign(new Ya,{Name:this.p9.PO[rc],Errors:[Object.assign(new Tb,{Id:pa,Details:hb})]});Db.add(vb);this.kT.add(vb)}this.ue.Xp(this.Vi);
this.lj.xcb(za.glh,JSON.stringify(this.kT));this.lj.xcb(za.status,za.failed);T&&!T.task.isCompleted&&T.setResult(new Ia(new le.a,this.kT))};Ea.prototype.P5i=function(T,pa){var hb=this;pa=void 0===pa?null:pa;this.Jhe.start();this.GTb=T;this.sga=wg.a.create().toString();ke.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.sga,this.GTb);this.ira=0;this.kT.clear();this.iXb.clear();var Db=new lc.a;this.dm=Db;pa&&pa.R(function(){var rc=!!Db&&!Db.task.isCompleted;ke.a(588096223,
306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",hb.sga,hb.GTb,rc);rc&&hb.RCe(Db,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.Vi=new te.a(this.p9.priority,2,this.p9.aLd,Object(of.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,pc.a.zpe,!0);this.Vug&&this.MRf();this.ue.Qg(this.Vi);return this.dm.task};Ea.prototype.c0i=function(T){this.Jhe.stop();var pa=this.C3h(T.result.errors);dc.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!pa,this.sga,this.GTb,this.ira,this.kT.count,0<T.result.errors.count?T.result.errors.oa(0).Name:"",0<T.result.errors.count&&0<T.result.errors.oa(0).Errors.length?T.result.errors.oa(0).Errors[0].Id:"",0<T.result.errors.count&&0<T.result.errors.oa(0).Errors.length?T.result.errors.oa(0).Errors[0].Details:"");return pa?!1:this.b0i(T.result.PO)};Ea.prototype.bhc=function(T){return this.p9.bhc(T)};Ea.prototype.b0i=function(T){for(var pa=0;pa<T.count;pa++){var hb=T.oa(pa);if(hb.Name===hc.a.accessToken){var Db=
(new Date).getTime();if(hb.Expiry>Kc.AFrameworkApplication.vk){var rc={};dc.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",(rc.AccessTokenTtl=hb.Expiry,rc.NowGetTime=Db,rc.BootTime=Kc.AFrameworkApplication.rha,rc),"PreviousAccessTokenTtl",Kc.AFrameworkApplication.vk);Kc.AFrameworkApplication.accessToken=hb.Value;Kc.AFrameworkApplication.vk=Math.floor(hb.Expiry);Kc.AFrameworkApplication.ZZd=Db;Kc.AFrameworkApplication.TXa=Math.floor(hb.Expiry)}else rc={},dc.ULS.sendTraceTag(39706828,
217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",(rc.AccessTokenTtl=hb.Expiry,rc.NowGetTime=Db,rc.BootTime=Kc.AFrameworkApplication.rha,rc),"PreviousAccessTokenTtl",Kc.AFrameworkApplication.vk)}}return!0};Ea.prototype.C3h=function(T){for(var pa=!1,hb=0;hb<T.count;hb++){pa=!0;var Db=T.oa(hb);dc.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",Db.Name,JSON.stringify(Db.Errors),this.sga)}return pa};Ea.prototype.GMh=function(T){var pa=
Mi.a.tvc;T=parseInt(T.Id);if(isNaN(T))pa=Mi.a.zVj;else{switch(T){case 401:pa=Mi.a.CVj;break;case 403:pa=Mi.a.xVj;break;case 500:pa=Mi.a.yVj;break;case 503:pa=Mi.a.BVj}pa===Mi.a.tvc&&(pa=500<T?Mi.a.AVj:Mi.a.wVj)}return pa};Object(Zd.a)(Ea,"TokenRefreshManager",null,[897]);qa.prototype.bhc=function(T){T=JSON.stringify(T);if(this.SSc&&0<this.SSc.length)for(var pa=Gl(this.SSc),hb=pa.next();!hb.done;hb=pa.next())if(hb=hb.value,0<hb.length&&0<=T.indexOf(hb))return!0;return!1};qa.prototype.VUh=function(T){try{if(T)for(var pa=
Gl(T),hb=pa.next();!hb.done;hb=pa.next()){var Db=hb.value;if(Db.Errors)for(var rc=Gl(Db.Errors),vb=rc.next();!vb.done;vb=rc.next()){var Uc=vb.value;if(Uc.Id in this.wee)return Number.parseInvariant(this.wee[Uc.Id].toString())}}}catch(Td){dc.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",Td.toString())}return this.aLd};qa.prototype.vqj=function(){var T={};try{if(!Kc.AFrameworkApplication.scc()||0>=Kc.AFrameworkApplication.scc().length||""===Kc.AFrameworkApplication.scc()[0])return T;
for(var pa=Gl(Kc.AFrameworkApplication.scc()),hb=pa.next();!hb.done;hb=pa.next()){var Db=hb.value;0<Db.length&&(T[Db]=Kc.AFrameworkApplication.EVj)}}catch(rc){dc.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",rc.toString())}return T};Object(Zd.a)(qa,"TokenRefreshPolicy",null,[892]);var Pj=Jf.a;Wl(oa,Pj);oa.prototype.create=function(){Kc.AFrameworkApplication.gN("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");
Kc.AFrameworkApplication.fa.ra("RefreshAccessTokenSilently")?this.Eb(this.C5g()):this.Eb(this.$.da.za(38)||this.$.da.Ga(38,new la(this.$)))};oa.prototype.C5g=function(){var T=this.$.da.za(38);if(T)return T;T=new Ea(Kc.AFrameworkApplication.Pi,Kc.AFrameworkApplication.wV(),new qa);return this.$.da.Ga(38,new La(this.$,T))};oa.ka=function(T){T.da.Ga(39,new oa(T))};Object(Zd.a)(oa,"AccessTokenExpirationManagerFactory",Jf.a,[]);var L=Xe.a;Wl(xa,L);xa.prototype.DGg=function(T){this.addHandler("TAF",T)};
xa.prototype.vbj=function(T){this.removeHandler("TAF",T)};xa.prototype.R1i=function(){this.raiseEvent("TAF")};Object(Zd.a)(xa,"GridHighlightBehaviorEventManager",Xe.a,[474,3]);var Ma=Jf.a;Wl(ta,Ma);ta.prototype.create=function(){this.Eb(this.$.da.za(376)||new xa(this.$))};ta.ka=function(T){T.da.Ga(377,new ta(T))};Object(Zd.a)(ta,"GridHighlightBehaviorEventManagerFactory",Jf.a,[]);var rb=b(114),ec=Sys.EventArgs;Wl(ha,ec);Object(Zd.a)(ha,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var fd=
Xe.a;Wl(U,fd);U.prototype.cFg=function(T){this.addHandler("mrek",T)};U.prototype.Vw=function(T,pa,hb){for(var Db=Gl(this.gridView.vn),rc=Db.next();!rc.done;rc=Db.next())Eg.a.instance.pa(Vf.a.vh,rc.value.domElement,T);Eg.a.instance.pa(Vf.a.Zd,document.documentElement,pa);this.gridView.tc.B7b(!0);hb&&Eg.a.instance.pa(Vf.a.xy,this.gridView.Lj,pa)};U.prototype.iXd=function(T,pa,hb){for(var Db=Gl(this.gridView.vn),rc=Db.next();!rc.done;rc=Db.next())Eg.a.instance.Aa(Vf.a.vh,rc.value.domElement,T);Eg.a.instance.Aa(Vf.a.Zd,
document.documentElement,pa);this.gridView.tc.B7b(!1);hb&&Eg.a.instance.Aa(Vf.a.xy,this.gridView.Lj,pa)};U.prototype.J6i=function(T,pa){for(var hb=Gl(this.gridView.vn),Db=hb.next();!Db.done;Db=hb.next())ve.a.instance.pa(Vf.a.Bg,Db.value.domElement,T);ve.a.instance.pa(Vf.a.De,document.documentElement,pa)};U.prototype.rNj=function(T,pa){for(var hb=Gl(this.gridView.vn),Db=hb.next();!Db.done;Db=hb.next())ve.a.instance.Aa(Vf.a.Bg,Db.value.domElement,T);ve.a.instance.Aa(Vf.a.De,document.documentElement,
pa)};U.prototype.NCe=function(T,pa,hb,Db){var rc=document.createElement("div");rc.className=pa;pa=Gl(hb);for(hb=pa.next();!hb.done;hb=pa.next())rc.classList.add(hb.value);T.appendChild(rc);Eg.a.instance.pa(Vf.a.pointerDown,rc,Db);return rc};U.prototype.q1e=function(T){T=T.Lb.parentNode;if(!T)return dc.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;T=parseInt(T.getAttribute(ae.a.Ixb),10);return isNaN(T)?(dc.ULS.shipAssertTag(537159393,
0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.Db.yw(3,1,T)};U.prototype.wKb=function(T,pa,hb){T=(void 0===hb?!0:hb)&&!!this.coloredReferencesManager&&this.coloredReferencesManager.jii(T);pa=Gl(pa);for(hb=pa.next();!hb.done;hb=pa.next())se.DOMElementExtensions.setVisible(hb.value,T)};U.prototype.fcd=function(){return this.gridView.Bj?rb.a(this.gridView.$):this.gridView.pc};U.prototype.GLf=function(){var T=this.fcd();
T&&this.coloredReferencesManager?this.SWd?T.nL(null):this.coloredReferencesManager.nL(T,null):(dc.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Db.Oh(this.kof),this.gridView.Db.vj(null,this.kof))};U.prototype.RJf=function(T,pa){this.raiseEvent("mrek",new ha(T,pa))};Ck.Object.defineProperties(U.prototype,{coloredReferencesManager:{configurable:!0,enumerable:!0,get:function(){var T=
this.gridView.$.da.za(281);T||dc.ULS.sendTraceTag(537159395,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return T}}});Object(Zd.a)(U,"BehaviorHelperMethods",Xe.a,[]);var yd=ef.a;Wl(Y,yd);Y.prototype.KYa=function(){};Object(Zd.a)(Y,"HighlightFlyweightBehavior",ef.a,[]);var be=b(492),xe=b(117),cf=b(9),ze=b(68),Yf=Xf.a;Wl(R,Yf);
R.prototype.Kme=function(T){this.addHandler("GrDrag",T)};R.prototype.oPf=function(T){this.removeHandler("GrDrag",T)};R.prototype.Jme=function(T){this.addHandler("GrContxt",T)};R.prototype.nPf=function(T){this.removeHandler("GrContxt",T)};R.prototype.Lme=function(T){this.addHandler("GrPointerUp",T)};R.prototype.pPf=function(T){this.removeHandler("GrPointerUp",T)};R.prototype.dispose=function(){bh.a.Sma(this.domElement);Yf.prototype.dispose.call(this)};R.prototype.tcg=function(T){this.domElement.parentNode.removeChild(this.domElement);
T.appendChild(this.domElement)};R.prototype.qXf=function(){this.domElement.classList.remove(ze.a.E8b);this.HKa.classList.remove(ze.a.D8b);this.HKa.classList.add(ze.a.TPe)};R.prototype.Mag=function(){this.HKa.classList.remove(ze.a.TPe);this.HKa.classList.add(ze.a.D8b);this.domElement.classList.add(ze.a.E8b)};R.prototype.R3h=function(T){return!!this.j5b&&(3<Math.abs(T.x-this.j5b.x)||3<Math.abs(T.y-this.j5b.y))};R.Lub=function(T){var pa=$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),
hb=ya.a.Of;return pa&&!hb?(T=Ih.a(T.$)?Ih.a(T.$).zoom:cf.a.N_,Math.round(9/Math.max(T,1))):9};R.gvd=0;Object(Zd.a)(R,"TouchGrippie",Xf.a,[]);Wl(I,Y);I.prototype.dispose=function(){Me.a.Dc([this.QO,this.cM]);this.QO.oPf(this.TCf);this.QO.nPf(this.jnc);this.QO.pPf(this.knc);this.cM.oPf(this.Etf);this.cM.nPf(this.jnc);this.cM.pPf(this.knc);for(var T=Gl(this.gridView.vn),pa=T.next();!pa.done;pa=T.next())pa=pa.value,ve.a.instance.Aa(Vf.a.Kf,pa.domElement,this.lxf),ve.a.instance.Aa(Vf.a.De,pa.domElement,
this.kxf);this.gridView.view.Xq(this.Mw);this.gridView.pc.kl(this.tJe);this.gridView.Db.bIb(this.yya);this.gridView.qId(this.stf);this.gridView.$.rD(this.brc);this.gridView.Ww(this.brc);this.ha.QW(this.Jg);this.ha.b7(this.Ap);this.gridView.KF(this.yp);this.ha.usc(this.dxf);dd.a.xPf(this.pEb);this.yba&&dc.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(T=this.gridView.$.da.za(376))&&T.vbj(this.UCf);Y.prototype.dispose.call(this)};I.prototype.MRa=
function(){if(!this.gba.range||!this.gba.range.equals(this.$bb))return!1;var T=!this.gridView.rMa();return this.gridView.isEditing&&T&&(this.$bb.isRow||this.$bb.hf)?!1:this.yba?!0:3===dd.a.Sb};I.prototype.R4=function(){this.Qnb&&(this.QO.set_visible(!1),this.cM.set_visible(!1),this.Qnb=!1)};I.prototype.Wna=function(){if(this.MRa()){this.MQj();var T=se.DOMElementExtensions.getBoundingClientRect(this.mpb);T||dc.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",
this.gridView.$.ea.isNamedObjectViewMode,this.oef,this.zWc,this.gridView.Lj,this.gridView.rb.$i);var pa=se.DOMElementExtensions.getBoundingClientRect(this.rkj),hb=new Sys.UI.Bounds(pa.x-T.x,pa.y-T.y,pa.width,pa.height),Db=this.$bb,rc=Db.topLeft,vb=Db.bottomRight,Uc=Db.isRow||Db.hf;if(Db.hf){var Td=this.Mzh();Db=hb.x-2*R.Lub(this.gridView);var mf=Td;var bg=hb.x+pa.width}else Db.isRow?(Db=bg=this.Lzh(),mf=hb.y-2*R.Lub(this.gridView),Td=hb.y+pa.height):(mf=hb.y,Td=hb.y+pa.height,this.gridView.rtl?(Db=
hb.x+pa.width,bg=hb.x):(Db=hb.x,bg=hb.x+pa.width));pa=R.gvd+(Uc?0:R.Lub(this.gridView));this.QO.style.left=Ud.HelperMethods.uc(Db-pa);this.QO.style.top=Ud.HelperMethods.uc(mf-pa);this.cM.style.left=Ud.HelperMethods.uc(bg-pa);this.cM.style.top=Ud.HelperMethods.uc(Td-pa);this.QO.set_visible(this.Qcf(mf,Db,rc,Uc,T));this.cM.set_visible(this.Qcf(Td,bg,vb,Uc,T));this.Qnb=!0}};I.prototype.Qcf=function(T,pa,hb,Db,rc){var vb=se.DOMElementExtensions.getBoundingClientRect(this.gridView.Uf(this.paneType).domElement);
rc=new Sys.UI.Bounds(vb.x-rc.x-3,vb.y-rc.y-3,vb.width+6,vb.height+6);return(this.gridView.rb.qj(hb)===this.paneType||Db)&&ob.a.WM(rc,new Sys.UI.Point(pa,T))};I.prototype.MQj=function(){if(this.oef!==this.zWc){this.mpb=null;var T=this.Y$c();this.QO.tcg(T);this.cM.tcg(T)}};I.prototype.Mzh=function(){return(this.gridView.view.visibleArea.height+this.gridView.rb.height+R.gvd-R.Lub(this.gridView))/2};I.prototype.Lzh=function(){return(this.gridView.view.visibleArea.width+this.gridView.rb.width+R.gvd-R.Lub(this.gridView))/
2};I.prototype.hBf=function(){this.Wna()};I.prototype.cgi=function(T){return se.DOMElementExtensions.Qbb(T.Lb,O.a.Zo)&&(this.dhi(T)||this.ehi(T))};I.prototype.ehi=function(T){if(this.gridView.rtl)T=T.clientPoint.x;else{var pa=se.DOMElementExtensions.getBoundingClientRect(T.Lb);T=T.clientPoint.x-(pa.x+pa.width-xe.a.vv)}return 0<T&&T<=xe.a.vv};I.prototype.dhi=function(T){var pa=se.DOMElementExtensions.getBoundingClientRect(T.Lb);T=T.clientPoint.y-(pa.y+pa.height-xe.a.vv);return 0<T&&T<=xe.a.vv};I.prototype.mxf=
function(T,pa){this.yba&&dc.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.QZc(T,pa,this.yba);this.R4()};I.prototype.Tmj=function(){this.yba||(dc.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.yba=!0,this.QO.qXf(),this.cM.qXf(),this.gridView.ha.sourceRange=this.gridView.ha.ta.qd,this.Wna())};I.prototype.mXd=function(){this.yba&&(dc.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),
this.yba=!1,this.QO.Mag(),this.cM.Mag())};I.prototype.Y$c=function(){this.mpb||(this.zWc=!1,this.mpb=this.gridView.Lj);return this.mpb};Ck.Object.defineProperties(I.prototype,{gridView:{configurable:!0,enumerable:!0,get:function(){return this.fr}}});Object(Zd.a)(I,"SelectionTouchGrippiesBehaviorBase",Y,[]);Wl(G,I);G.prototype.MRa=function(){var T=this.gridView.Li||this.gridView.isEditing;return!this.gridView.ha.ta.Hg&&!T&&I.prototype.MRa.call(this)};Ck.Object.defineProperties(G.prototype,{U4:{configurable:!0,
enumerable:!0,get:function(){return 19}},$bb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.ta.activeRange}}});Object(Zd.a)(G,"DiscontinuousSelectionTouchGrippiesBehavior",I,[]);var Sg=b(326);Wl(E,Y);Object(Zd.a)(E,"SelectionBorderBehavior",Y,[]);aa.tuh="ewr-selection-draghandle";aa.yuh="ewr-selection-draghandle-grab";aa.Juh="ewr-selection-draghandle-top-ie";aa.Kuh="ewr-selection-draghandle-top-ie-enhanced";aa.Huh="ewr-selection-draghandle-top";aa.Iuh="ewr-selection-draghandle-top-enhanced";
aa.wuh="ewr-selection-draghandle-bottom-ie";aa.xuh="ewr-selection-draghandle-bottom-ie-enhanced";aa.uuh="ewr-selection-draghandle-bottom";aa.vuh="ewr-selection-draghandle-bottom-enhanced";aa.Buh="ewr-selection-draghandle-left-ie";aa.Cuh="ewr-selection-draghandle-left-ie-enhanced";aa.zuh="ewr-selection-draghandle-left";aa.Auh="ewr-selection-draghandle-left-enhanced";aa.Fuh="ewr-selection-draghandle-right-ie";aa.Guh="ewr-selection-draghandle-right-ie-enhanced";aa.Duh="ewr-selection-draghandle-right";
aa.Euh="ewr-selection-draghandle-right-enhanced";aa.$Pe="ewr-selection-dragtooltip";aa.aQe="ewr-selection-dragtooltip-updated";aa.Vuh="ewr_selection_rearrangeleft";aa.Wuh="ewr_selection_rearrangeright";aa.Xuh="ewr_selection_rearrangetop";aa.Uuh="ewr_selection_rearrangebottom";aa.selecting="selecting";aa.Yuh="ewr-selection-resizemarqueehandle";aa.avh="ewr-selection-resizemarqueehandle-topleft";aa.bvh="ewr-selection-resizemarqueehandle-topright";aa.Zuh="ewr-selection-resizemarqueehandle-bottomleft";
aa.$uh="ewr-selection-resizemarqueehandle-bottomright";aa.juh="ewr-marquee-thick";aa.nuh="ewr-resizemarqueehandle-thick";Object(Zd.a)(aa,"CssClassNames",null,[]);Wl(V,E);V.prototype.dispose=function(){var T=this;this.Vr.forEach(function(pa){Eg.a.instance.Aa(Vf.a.pointerDown,pa,T.onPointerDown)});Array.clear(this.Vr);this.Fma=this.sourceRange=this.ub=null;dc.ULS.sendTraceTag(537159381,0,50,"DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = {0}, EwaControl is null : {1}",this.Mra,!this.$);
this.$&&(this.$.yl(this.vd),1===this.Mra&&(dc.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.Tt(this.Jje,this.Kje,!1)));E.prototype.dispose.call(this)};V.prototype.Gf=function(T){T=Ih.a(this.$).ie(T);return this.GAd(T)};V.prototype.GAd=function(T){if(5!==this.gi)return!1;(T=this.vya(T))||this.vtb(!1);Rg.b(this.$,!1);return T};V.prototype.Ih=function(T){T=Ih.a(this.$).ie(T);if(this.Yh&&this.Xnc(T))return!0;if(T=this.ha.Xn(T.clientPoint,
T.Lb,5,void 0,void 0,!0)){T=this.Dha(T);if(this.ub.equals(T))return!0;this.ub=T;if(!this.Jy())return dc.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.vtb(!0),!1}return!0};V.prototype.Vw=function(T,pa){dc.ULS.shipAssertTag(537159377,0,!this.Mra,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.Mra+=1;this.Jje=T;this.Kje=pa;this.oo.Vw(T,pa,this.uAc())};V.prototype.Dha=
function(T){if(!T||!this.ub)return dc.ULS.shipAssertTag(537159376,0,!!T,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),dc.ULS.shipAssertTag(537159375,0,!!this.ub,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;var pa=this.ub.clone();1!==this.sE&&(pa.left=Math.max(T.left-this.Qdc,1),pa.right=pa.left+this.sourceRange.width-1);2!==this.sE&&(pa.top=Math.max(T.top-this.CCc,1),pa.bottom=pa.top+this.sourceRange.height-1);return this.LYa(pa)};
V.prototype.Tt=function(T,pa,hb,Db){hb=void 0===hb?!0:hb;Db=void 0===Db?!0:Db;dc.ULS.shipAssertTag(537159374,0,1===this.Mra,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.Mra;this.Yh||zf.g(this.$).ug.Jo(ae.a.J4);this.oo.iXd(T,pa,this.uAc());hb&&this.Ppb(Db);this.sE=0;this.vSa=!1};V.prototype.LYa=function(T){var pa=zf.g(this.$),hb=T;if(pa.rb.N4){if(!pa.lc(T.topLeft)){pa=pa.xk("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",pa.hH,this.Fma.top!==T.top?
1:2);try{pa.gl=this.Fma.top<T.top||this.Fma.left<T.left,pa.ls(T.topLeft),hb=pa.$$cu().range}finally{pa&&pa.dispose()}}hb.right=hb.left+T.width-1;hb.bottom=hb.top+T.height-1}return this.Fma=hb};V.prototype.Pvc=function(T){this.Vr.forEach(function(pa){se.DOMElementExtensions.setVisible(pa,T)})};V.prototype.dRh=function(T){var pa=T.Lb;T=T.clientPoint;if(!pa||!T)return dc.ULS.shipAssertTag(537159373,0,!!pa,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),dc.ULS.shipAssertTag(537159372,
0,!!T,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;T.y+=pa===this.Vr[V.vIa]?2:pa===this.Vr[V.J6c]?-2:0;T.x+=pa===this.Vr[V.K6c]?2:pa===this.Vr[V.uIa]?-2:0;return this.ha.Xn(T,pa,5,void 0,void 0,!0)};Ck.Object.defineProperties(V.prototype,{Db:{configurable:!0,enumerable:!0,get:function(){return zf.g(this.$).Db}},gi:{configurable:!0,enumerable:!0,get:function(){return this.ha.selectionType},set:function(T){this.ha.selectionType=T}}});V.F6c="move";V.A1a="grabbing";V.vIa=
0;V.J6c=1;V.K6c=2;V.uIa=3;Object(Zd.a)(V,"DragSelectionClickBehaviorBase",E,[]);Wl(ba,V);ba.prototype.KYa=function(T){this.oo.wKb(T,this.Vr);this.my.Nza()};ba.prototype.Vnc=function(T){dc.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.rLa=!0;this.Ya.OG(!1);this.gi=5;this.my.XIe(T.Lb);this.Ya.textBox.removeSelection();this.Ya.iZb(this.U4e);this.Vw(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,
"onPointerUp"));this.sE=this.sourceRange.isRow?1:this.sourceRange.hf?2:0};ba.prototype.vya=function(){var T=this.bL();this.gi=-1;this.Tt(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp"));return T};ba.prototype.Ppb=function(){this.gridView.rLa=!1;this.my.YIe(this.Vr[0]);this.Ya.textBox.setCaretPositionToEnd();this.Ya.Fsc(this.U4e);this.oo.GLf()};ba.prototype.vtb=function(T){dc.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");
T&&this.Tt(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp"))};ba.prototype.Obc=function(T){this.Ya=this.oo.fcd();this.YK=this.oo.q1e(T);return this.Ya&&this.YK&&this.YK.range?this.YK.range:(dc.ULS.shipAssertTag(537159388,0,!!this.Ya,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),dc.ULS.shipAssertTag(537159387,0,!!this.YK,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),dc.ULS.shipAssertTag(537159386,0,!!this.YK.range,
"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)};ba.prototype.bL=function(){return this.YK?this.coloredReferencesManager.Spf(this.Ya,this.YK,this.ub):(dc.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)};ba.prototype.Jy=function(){return this.bL()};ba.prototype.uAc=function(){return!0};ba.prototype.Xnc=function(){return!1};Object(Zd.a)(ba,
"DragMarqueeClickBehavior",V,[]);var eg=b(971),Pg=b(915),Vh=b(121);Object(Zd.a)(Q,"MacroRecorderTableRowColumnRearrangedPayload",null,[450]);Wl(P,V);P.prototype.dispose=function(){this.ha&&(this.ha.b7(this.Ap),this.ha.QW(this.Jg),this.ha.VId(this.HOa),this.ha.hI(this.ld));if(this.Vh)for(var T=1;4>=T;T++)se.DOMElementExtensions.zf(this.Vh[T.toString()]);this.Vh=this.Nh=null;this.gu&&this.Goa();this.Yh&&this.hu&&this.Goa(1);V.prototype.dispose.call(this)};P.prototype.Vnc=function(T){this.Yh&&(this.Pw=
T,this.Xz=null,this.Oq=this.isRow=this.hf=this.Pq=!1,ah.KeyInputManager.instance.pa(Vf.a.Xb,this.domElement.ownerDocument.body,this.onKeyDown));this.cq=!0;this.tableRange=this.kZc(this.tableManager.nn(this.sourceRange.topLeft));zf.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Yh?(this.Xz=this.tableRange,this.Nn=1,this.Nh=(this.Oq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.gi=6,this.Vw(this.FN,this.IN),this.qM=
this.qia,this.uO=this.Rna,this.Uz(T.clientPoint,T.Lb,this.Oq?11:12,!0,!0),this.GI(!0)):(this.Nh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.gi=6,this.Vw(this.FN,this.IN),this.Uz(T.clientPoint,T.Lb,this.isRow?11:12,!0)):(this.tableRange=null,this.Yh?(this.isRow=this.sourceRange.isRow,this.hf=this.sourceRange.hf,this.isRow||this.hf?(this.Nn=3,this.sE=this.isRow?1:2,this.gi=6,this.Nh=this.isRow?[11]:[12],this.Vw(this.u6,this.v6),
this.qM=this.qia,this.uO=this.Rna,this.Uz(T.clientPoint,T.Lb,this.isRow?11:12,!0,!0),this.GI(!0)):(this.Nn=2,this.sE=0,this.Vw(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp")),this.qM=this.tsb,this.uO=this.SKb,this.Uz(T.clientPoint,T.Lb,this.Maa(),!1,!0),this.Jy(!0))):(this.Vw(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp")),ah.KeyInputManager.instance.pa(Vf.a.Xb,this.domElement.ownerDocument.body,this.onKeyDown),this.sE=this.sourceRange.isRow?
1:this.sourceRange.hf?2:0,this.Uz(T.clientPoint,T.Lb,this.Maa(),!1),this.Jy()))};P.prototype.vya=function(){this.cq=!1;this.Yh&&(this.Nn=0);this.Db.Oh(this.fB());if(!this.$.Aq([this.ub],!1))return this.Tt(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp")),this.gi=-1,!0;if(this.ha.ta.qd.equals(this.ub)||this.nka(this.ub)||this.nka(this.sourceRange))this.gi=-1;else{this.bL();this.ha.sourceRange=this.sourceRange.clone();var T=this.ha.sourceRange,pa=this.ha.ta.qd;if(this.Yh){var hb=
{};this.$.Ud(-694765314,2,30,(hb[ae.a.bua]=this.gu,hb[ae.a.U3]=T,hb[ae.a.T3]=pa,hb[ae.a.rsb]=this.hu,hb))}else hb={},this.$.Ud(-694765314,2,30,(hb[ae.a.bua]=this.gu,hb[ae.a.U3]=T,hb[ae.a.T3]=pa,hb))}!this.Yh&&this.tableRange||this.Tt(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp"));return!0};P.prototype.Ppb=function(T){T&&(ah.KeyInputManager.instance.Aa(Vf.a.Xb,this.domElement.ownerDocument.body,this.onKeyDown),this.Yh&&zf.g(this.$).ug.Jo(ae.a.J4),this.cq=!1);for(T=
1;4>=T;T++){var pa=this.Vh[T.toString()];pa&&pa.parentNode.removeChild(pa);this.Vh[T.toString()]=null}this.Nh=null};P.prototype.Xnc=function(T){var pa=this.ha.Xn(T.clientPoint,T.Lb,5,void 0,void 0,!0);this.Pw=T;return this.Cwb(pa)?(this.ub=this.Z2(pa),this.nwb(!0),!0):this.zid(pa)?(this.ub=this.Dha(pa),this.owb(!0),!0):!1};P.prototype.Cwb=function(T){return!!this.Xz&&1!==this.Nn&&!!T&&this.Xz.contains(T.topLeft)};P.prototype.zid=function(T){return!!this.Xz&&1===this.Nn&&!!T&&!this.Xz.contains(T.topLeft)};
P.prototype.nwb=function(T){this.tableRange=this.Xz;this.Nn=1;var pa=!this.hu;T?(this.XA(!1),this.Nh=this.Oq?[11]:[12],this.xza(pa),this.GI(pa)):(this.h3(!1),this.ZN(pa),this.Jy(pa))};P.prototype.owb=function(T){this.tableRange=null;this.Nn=2;var pa=!this.hu;T?(this.XA(!1),this.Nh=this.Oq?[11]:[12],this.Pq=this.Oq,this.SPa(pa),this.GI(pa)):(this.w$(!1),this.ZN(pa),this.Jy(pa))};P.prototype.Obc=function(){return this.ha.ta.qd};P.prototype.bL=function(){this.ha.updateSelection(this.ub,this.ub.topLeft,
0);return!0};P.prototype.Jy=function(T){T=void 0===T?!1:T;this.Db.vj(this.ub,this.fB());this.Db.Cn(this.fB());this.HB(T);return!0};P.prototype.GI=function(T){T=void 0===T?!1:T;this.Db.vj(this.ub,this.Nh);this.Db.Cn(this.Nh);this.HB(T)};P.prototype.vtb=function(){dc.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")};P.prototype.uAc=function(){return!1};P.prototype.hxc=function(){if(!zf.g(this.$).ha.ta.Hg)return!1;
var T=zf.g(this.$).getRangeInformation(this.ha.ta.qd);T=Gl(T);for(var pa=T.next();!pa.done;pa=T.next())if(Object(vd.a)(rh.PivotTableRange,pa.value))return!1;return!0};P.prototype.kZc=function(T){if(T&&T.contains(this.sourceRange)&&!T.equals(this.sourceRange)){if(T.dba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===T.top){var pa=new Se.Range(this.sourceRange.top,this.sourceRange.left,T.bottom,this.sourceRange.right,!1,!1);if(!pa.equals(T))return this.sourceRange=pa,this.ha.updateSelection(this.sourceRange,
this.sourceRange.topLeft,0),T}this.Yh?this.Oq=T.left===this.sourceRange.left&&T.right===this.sourceRange.right:this.isRow=T.left===this.sourceRange.left&&T.right===this.sourceRange.right;if(T.top===this.sourceRange.top&&T.bottom===this.sourceRange.bottom||this.ky())return T}return null};P.prototype.Z2=function(T){var pa=T.clone();this.ky()?pa.left=Math.max(T.left-this.Qdc,1):pa.top=Math.max(T.top-this.CCc,1);pa.right=pa.left+this.sourceRange.width-1;pa.bottom=pa.top+this.sourceRange.height-1;return this.LYa(pa)};
P.prototype.uzb=function(){var T=this.ub.topLeft.Ed(this.sourceRange);return T||this.Yh&&!this.tableRange?T:this.ky()?this.ub.top===this.sourceRange.bottom+1:this.ub.left===this.sourceRange.right+1};P.prototype.vGd=function(){if(this.ky()&&this.ub.left!==this.tableRange.left||!this.ky()&&this.ub.top!==this.tableRange.top){var T=Df.a.gd(1,1,0,909,0,2065438552,"RearrangeInvalidDest");ff.a(this.$).Cr([T]);return!0}return!1};P.prototype.$Ed=function(){var T=this,pa=this.$.Pb.Gc("UserAction","RearrangeRowColumnClientSide"),
hb={},Db=(hb.CopyPasteTargetType=1,hb.OperationId=wg.a.create().toString(),hb.Stopwatch=pa,hb.DragDropIsShiftKeyDown=this.hu,hb.EncounteredDeploymentErrors=!1,hb),rc=this.gu?2:1,vb=this.$.da.za(254);(new Promise(function(Uc,Td){T.rtb(function(mf){mf.Errors&&0<mf.Errors.length?Td(new eg.a(22,mf.Errors)):Uc(!0)},function(mf){mf=Vh.a.ig(mf.data);Td(new eg.a(22,mf))})})).then(function(){dc.ULS.sendTraceTag(537159383,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="{0}"',
1);vb&&vb.Dlf(Db,rc,T.sourceRange,T.ub);return Promise.resolve(!0)},function(Uc){dc.ULS.sendTraceTag(537159382,0,10,'DragSelectionClickBehavior.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',Uc?copyPasteInfra.getStringifiedError(Uc):"null",1);return vb?vb.rAf(Uc,Db,rc,T.sourceRange,T.ub):Promise.reject(Uc)})};P.prototype.rtb=function(T,pa){function hb(){return new Q(Uc,vb)}function Db(Td,mf,bg){return M(rc.$.na.va,Uc,vb,T?ge.b(Td,T):Td,pa?ge.a(mf,pa):mf,bg,null)}var rc=this;T=void 0===T?null:
T;pa=void 0===pa?null:pa;var vb={};this.ky()?(vb.FirstRow=this.ub.top-1,vb.FirstColumn=0,vb.DeltaColumn=0,vb.DeltaRow=this.ub.bottom-this.ub.top+1):(vb.FirstRow=0,vb.FirstColumn=this.ub.left-1,vb.DeltaColumn=this.ub.right-this.ub.left+1,vb.DeltaRow=0);vb.LastRow=cf.a.ny;vb.LastColumn=cf.a.mv;vb.SheetName=this.$.xa.qa?this.$.xa.qa.name:this.$.Hb.getItemByName(this.$.Hb.qa.name).sheetName;var Uc=Ff.v(this.sourceRange,this.$);$e.EwaSettings.qc()?this.$.userOperationManager.jc(new Gb.a(514,0,Db,64,hb),
null):this.$.userOperationManager.jc(new Va.a(514,0,Db,void 0,hb),null)};P.prototype.nka=function(T){T=zf.g(this.$).getRangeInformation(T);for(var pa=0,hb=T.length;pa<hb;++pa)if(Object(vd.a)(rh.PivotTableRange,T[pa]))return T=Df.a.gd(1,0,0,897,0,2105176604,"InsDelCellsPivotTable"),ff.a(this.$).Cr([T]),!0;return!1};P.prototype.Uz=function(T,pa,hb,Db,rc){rc=void 0===rc?!1:rc;var vb=se.DOMElementExtensions.getBoundingClientRect(pa),Uc=pa===this.Vr[V.vIa]||pa===this.Vr[V.J6c];if(this.Yh){var Td=pa===
this.Vr[V.K6c]||pa===this.Vr[V.uIa];this.isRow&&Td||this.hf&&Uc?Td="100px":(Uc=this.isRow||Uc,Td=(Uc?rc?P.EVd:P.KVd:rc?P.DVd:P.HVd)+"px");pa=Uc?pa===this.Vr[V.vIa]?"top":"bottom":pa===this.Vr[V.uIa]?"right":"left";T=100*(Uc?T.x-vb.x:T.y-vb.y)/(Uc?vb.width:vb.height);for(vb=1;4>=vb;vb++){Db=document.createElement("div");var mf=document.createElement("div"),bg=document.createElement("div");Db.appendChild(mf);Db.appendChild(bg);rc&&(mf=document.createElement("div"),Db.appendChild(mf),bg.style.fontWeight=
"bold");Db.className=aa.aQe;this.Vh[vb.toString()]=Db;this.Db.yw(hb,vb).Ef.appendChild(Db);Db=this.Vh[vb.toString()];Db.style[pa]=Td;Db.style[Uc?"left":"top"]=T+"%"}}else for(rc=(Uc?-P.JVd:-P.GVd)+"px",Td=Uc?pa===this.Vr[V.vIa]?"top":"bottom":pa===this.Vr[V.uIa]||Db?"right":"left",pa=100*(Uc?Db?0:T.x-vb.x:T.y-vb.y)/(Uc?vb.width:vb.height),T=1;4>=T;T++)vb=document.createElement("div"),vb.className=aa.$Pe,this.Vh[T.toString()]=vb,this.Db.yw(hb,T).Ef.appendChild(vb),vb=this.Vh[T.toString()],vb.style[Td]=
rc,vb.style[Uc?"left":"top"]=pa+"%"};P.prototype.HB=function(T){T=void 0===T?!1:T;var pa=this.ub.toString();if(this.Yh)for(var hb=1;4>=hb;hb++)this.Vh[hb.toString()].childNodes[0].innerText=pa,this.Vh[hb.toString()].childNodes[1].innerText=this.qM,T&&(this.Vh[hb.toString()].childNodes[2].innerText=this.uO);else for(T=1;4>=T;T++)this.Vh[T.toString()].innerText=pa};P.prototype.Goa=function(T){T=void 0===T?0:T;0===T?this.gu=!1:1===T&&(this.hu=!1);this.Yh&&(this.gu||this.hu)||(ah.KeyInputManager.instance.Aa(Vf.a.Vd,
this.domElement.ownerDocument.body,this.onKeyUp),this.oMa=!1)};P.prototype.XA=function(T){this.Db.Oh(this.fB());this.Tt(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp"),void 0,T)};P.prototype.h3=function(T){this.Db.Oh(this.Nh);this.Tt(this.u6,this.v6,void 0,T)};P.prototype.w$=function(T){this.Db.Oh(this.Nh);this.Tt(this.FN,this.IN,void 0,T)};P.prototype.ZN=function(T){T=void 0===T?!1:T;this.gi=5;this.Vw(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,
this.Gf,"onPointerUp"));this.qM=this.tsb;this.uO=this.SKb;this.Uz(this.Pw.clientPoint,this.Pw.Lb,this.Maa(),!1,T)};P.prototype.SPa=function(T){T=void 0===T?!1:T;this.gi=6;this.Vw(this.u6,this.v6);this.qM=this.qia;this.uO=this.Rna;this.Uz(this.Pw.clientPoint,this.Pw.Lb,this.isRow||this.Oq?11:12,!0,T)};P.prototype.xza=function(T){T=void 0===T?!1:T;this.gi=6;this.Vw(this.FN,this.IN);this.qM=this.qia;this.uO=this.Rna;this.Uz(this.Pw.clientPoint,this.Pw.Lb,this.ky()?11:12,!0,T)};P.prototype.tka=function(T){return T.Ca.keyCode===
Ba.a.i8||ya.a.isMac&&T.Ca.keyCode===Ba.a.Poa};P.prototype.ky=function(){return!this.Yh&&this.isRow||this.Yh&&this.Oq};P.prototype.Maa=function(){return this.Yh?47:6};P.prototype.fB=function(){return this.Yh?P.H6c:P.L6c};P.GVd=50;P.JVd=25;P.HVd=-85;P.KVd=-40;P.DVd=-120;P.EVd=-50;P.Kqb="copy";P.L6c=[6];P.H6c=[47];Object(Zd.a)(P,"DragSelectionClickBehavior",V,[]);Wl(N,V);N.prototype.dispose=function(){this.ha&&(this.ha.b7(this.Ap),this.ha.QW(this.Jg),this.ha.VId(this.HOa),this.ha.hI(this.ld));if(this.Vh)for(var T=
1;4>=T;T++)se.DOMElementExtensions.zf(this.Vh[T.toString()]);this.Vh=this.Nh=null;V.prototype.dispose.call(this)};N.prototype.Ppb=function(T){T&&(this.Yh&&zf.g(this.$).ug.Jo(ae.a.J4),this.cq=!1);for(T=1;4>=T;T++){var pa=this.Vh[T.toString()];pa&&pa.parentNode.removeChild(pa);this.Vh[T.toString()]=null}this.Nh=null};N.prototype.Obc=function(){return this.ha.ta.qd};N.prototype.bL=function(){this.ha.updateSelection(this.ub,this.ub.topLeft,0);return!0};N.prototype.Jy=function(T){T=void 0===T?!1:T;this.Db.vj(this.ub,
this.fB());this.Db.Cn(this.fB());this.HB(T);return!0};N.prototype.GI=function(T){T=void 0===T?!1:T;this.Db.vj(this.ub,this.Nh);this.Db.Cn(this.Nh);this.HB(T)};N.prototype.vtb=function(){dc.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")};N.prototype.uAc=function(){return!1};N.prototype.Uz=function(T,pa,hb,Db,rc){rc=void 0===rc?!1:rc;var vb=se.DOMElementExtensions.getBoundingClientRect(pa),Uc=pa===this.Vr[V.vIa]||
pa===this.Vr[V.J6c];if(this.Yh){var Td=pa===this.Vr[V.K6c]||pa===this.Vr[V.uIa];this.isRow&&Td||this.hf&&Uc?Td="100px":(Uc=this.isRow||Uc,Td=(Uc?rc?N.EVd:N.KVd:rc?N.DVd:N.HVd)+"px");pa=Uc?pa===this.Vr[V.vIa]?"top":"bottom":pa===this.Vr[V.uIa]?"right":"left";T=100*(Uc?T.x-vb.x:T.y-vb.y)/(Uc?vb.width:vb.height);for(vb=1;4>=vb;vb++){Db=document.createElement("div");var mf=document.createElement("div"),bg=document.createElement("div");Db.appendChild(mf);Db.appendChild(bg);rc&&(mf=document.createElement("div"),
Db.appendChild(mf),bg.style.fontWeight="bold");Db.className=aa.aQe;this.Vh[vb.toString()]=Db;this.Db.yw(hb,vb).Ef.appendChild(Db);Db=this.Vh[vb.toString()];Db.style[pa]=Td;Db.style[Uc?"left":"top"]=T+"%"}}else for(rc=(Uc?-N.JVd:-N.GVd)+"px",Td=Uc?pa===this.Vr[V.vIa]?"top":"bottom":pa===this.Vr[V.uIa]||Db?"right":"left",pa=100*(Uc?Db?0:T.x-vb.x:T.y-vb.y)/(Uc?vb.width:vb.height),T=1;4>=T;T++)vb=document.createElement("div"),vb.className=aa.$Pe,this.Vh[T.toString()]=vb,this.Db.yw(hb,T).Ef.appendChild(vb),
vb=this.Vh[T.toString()],vb.style[Td]=rc,vb.style[Uc?"left":"top"]=pa+"%"};N.prototype.mcg=function(T,pa,hb){var Db=zf.g(this.$),rc=Db.tg(T),vb=Db.Uf(this.paneType);hb=Pg.a.As(vb.view.ti,this.domElement.parentNode,hb,Db.rtl);vb=!1;var Uc=2;pa&&hb.y-rc.topLeft.y>rc.height/2?(vb=!0,Uc=1):!pa&&hb.x-rc.topLeft.x>rc.width/2&&(vb=!0);if(vb){pa=Db.xk("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",Db.hH,Uc);try{pa.ls(T),pa.$$mn(),pa.$$cu()}finally{pa&&pa.dispose()}}};N.prototype.w$=function(T){this.Db.Oh(this.Nh);
this.Tt(this.FN,this.IN,void 0,T)};N.prototype.XA=function(T){this.Db.Oh(this.fB());this.Tt(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp"),void 0,T)};N.prototype.Maa=function(){return this.Yh?47:6};N.prototype.fB=function(){return this.Yh?N.H6c:N.L6c};N.GVd=50;N.JVd=25;N.HVd=-85;N.KVd=-40;N.DVd=-120;N.EVd=-50;N.L6c=[6];N.H6c=[47];Object(Zd.a)(N,"DragSelectionClickBehaviorTemporary",V,[]);Wl(B,N);B.prototype.dispose=function(){this.gu&&this.Goa();this.Yh&&this.hu&&
this.Goa(1);N.prototype.dispose.call(this)};B.prototype.Vnc=function(T){this.Yh&&(this.Pw=T,this.Xz=null,this.Oq=this.isRow=this.hf=this.Pq=!1,ah.KeyInputManager.instance.pa(Vf.a.Xb,this.domElement.ownerDocument.body,this.onKeyDown));this.cq=!0;this.tableRange=this.kZc(this.tableManager.nn(this.sourceRange.topLeft));zf.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Yh?(this.Xz=this.tableRange,this.Nn=1,this.Nh=(this.Oq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===
this.sourceRange.right)?[11]:[12],this.gi=6,this.Vw(this.FN,this.IN),this.qM=this.qia,this.uO=this.Rna,this.Uz(T.clientPoint,T.Lb,this.Oq?11:12,!0,!0),this.GI(!0)):(this.Nh=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.gi=6,this.Vw(this.FN,this.IN),this.Uz(T.clientPoint,T.Lb,this.isRow?11:12,!0)):(this.tableRange=null,this.Yh?(this.isRow=this.sourceRange.isRow,this.hf=this.sourceRange.hf,this.isRow||this.hf?(this.Nn=3,this.sE=
this.isRow?1:2,this.gi=6,this.Nh=this.isRow?[11]:[12],this.Vw(this.u6,this.v6),this.qM=this.qia,this.uO=this.Rna,this.Uz(T.clientPoint,T.Lb,this.isRow?11:12,!0,!0),this.GI(!0)):(this.Nn=2,this.sE=0,this.Vw(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp")),this.qM=this.tsb,this.uO=this.SKb,this.Uz(T.clientPoint,T.Lb,this.Maa(),!1,!0),this.Jy(!0))):(this.Vw(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp")),ah.KeyInputManager.instance.pa(Vf.a.Xb,
this.domElement.ownerDocument.body,this.onKeyDown),this.sE=this.sourceRange.isRow?1:this.sourceRange.hf?2:0,this.Uz(T.clientPoint,T.Lb,this.Maa(),!1),this.Jy()))};B.prototype.vya=function(){this.cq=!1;this.Yh&&(this.Nn=0);this.Db.Oh(this.fB());if(!this.$.Aq([this.ub],!1))return this.Tt(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp")),this.gi=-1,!0;if(this.ha.ta.qd.equals(this.ub)||this.nka(this.ub)||this.nka(this.sourceRange))this.gi=-1;else{this.bL();this.ha.sourceRange=
this.sourceRange.clone();var T=this.ha.sourceRange,pa=this.ha.ta.qd;if(this.Yh){var hb={};this.$.Ud(-694765314,2,30,(hb[ae.a.bua]=this.gu,hb[ae.a.U3]=T,hb[ae.a.T3]=pa,hb[ae.a.rsb]=this.hu,hb))}else hb={},this.$.Ud(-694765314,2,30,(hb[ae.a.bua]=this.gu,hb[ae.a.U3]=T,hb[ae.a.T3]=pa,hb))}!this.Yh&&this.tableRange||this.Tt(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp"));this.rtd&&this.qtd();return!0};B.prototype.Ppb=function(T){T&&ah.KeyInputManager.instance.Aa(Vf.a.Xb,
this.domElement.ownerDocument.body,this.onKeyDown);N.prototype.Ppb.call(this,T)};B.prototype.Xnc=function(T){var pa=this.ha.Xn(T.clientPoint,T.Lb,5,void 0,void 0,!0);this.Pw=T;return this.Cwb(pa)?(this.ub=this.Z2(pa),this.nwb(!0),!0):this.zid(pa)?(this.ub=this.Dha(pa),this.owb(!0),!0):!1};B.prototype.HB=function(T){T=void 0===T?!1:T;var pa=this.ub.toString();if(this.Yh)for(var hb=1;4>=hb;hb++)this.Vh[hb.toString()].childNodes[0].innerText=pa,this.Vh[hb.toString()].childNodes[1].innerText=this.qM,
T&&(this.Vh[hb.toString()].childNodes[2].innerText=this.uO);else for(T=1;4>=T;T++)this.Vh[T.toString()].innerText=pa};B.prototype.Cwb=function(T){return!!this.Xz&&1!==this.Nn&&!!T&&this.Xz.contains(T.topLeft)};B.prototype.zid=function(T){return!!this.Xz&&1===this.Nn&&!!T&&!this.Xz.contains(T.topLeft)};B.prototype.nwb=function(T){this.tableRange=this.Xz;this.Nn=1;var pa=!this.hu;T?(this.XA(!1),this.Nh=this.Oq?[11]:[12],this.xza(pa),this.GI(pa)):(this.h3(!1),this.ZN(pa),this.Jy(pa))};B.prototype.owb=
function(T){this.tableRange=null;this.Nn=2;var pa=!this.hu;T?(this.XA(!1),this.Nh=this.Oq?[11]:[12],this.Pq=this.Oq,this.SPa(pa),this.GI(pa)):(this.w$(!1),this.ZN(pa),this.Jy(pa))};B.prototype.hxc=function(){if(!zf.g(this.$).ha.ta.Hg)return!1;var T=zf.g(this.$).getRangeInformation(this.ha.ta.qd);T=Gl(T);for(var pa=T.next();!pa.done;pa=T.next())if(Object(vd.a)(rh.PivotTableRange,pa.value))return!1;return!0};B.prototype.kZc=function(T){if(T&&T.contains(this.sourceRange)&&!T.equals(this.sourceRange)){if(T.dba&&
this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===T.top){var pa=new Se.Range(this.sourceRange.top,this.sourceRange.left,T.bottom,this.sourceRange.right,!1,!1);if(!pa.equals(T))return this.sourceRange=pa,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),T}this.Yh?this.Oq=T.left===this.sourceRange.left&&T.right===this.sourceRange.right:this.isRow=T.left===this.sourceRange.left&&T.right===this.sourceRange.right;if(T.top===this.sourceRange.top&&T.bottom===this.sourceRange.bottom||
this.ky())return T}return null};B.prototype.Z2=function(T){var pa=T.clone();this.ky()?pa.left=Math.max(T.left-this.Qdc,1):pa.top=Math.max(T.top-this.CCc,1);pa.right=pa.left+this.sourceRange.width-1;pa.bottom=pa.top+this.sourceRange.height-1;return this.LYa(pa)};B.prototype.uzb=function(){var T=this.ub.topLeft.Ed(this.sourceRange);return T||this.Yh&&!this.tableRange?T:this.ky()?this.ub.top===this.sourceRange.bottom+1:this.ub.left===this.sourceRange.right+1};B.prototype.vGd=function(){if(this.ky()&&
this.ub.left!==this.tableRange.left||!this.ky()&&this.ub.top!==this.tableRange.top){var T=Df.a.gd(1,1,0,909,0,2065438552,"RearrangeInvalidDest");ff.a(this.$).Cr([T]);return!0}return!1};B.prototype.$Ed=function(){var T=this,pa=this.$.Pb.Gc("UserAction","RearrangeRowColumnClientSide"),hb={},Db=(hb.CopyPasteTargetType=1,hb.OperationId=wg.a.create().toString(),hb.Stopwatch=pa,hb.DragDropIsShiftKeyDown=this.hu,hb.EncounteredDeploymentErrors=!1,hb),rc=this.gu?2:1,vb=this.$.da.za(254);(new Promise(function(Uc,
Td){T.rtb(function(mf){mf.Errors&&0<mf.Errors.length?Td(new eg.a(22,mf.Errors)):Uc(!0)},function(mf){mf=Vh.a.ig(mf.data);Td(new eg.a(22,mf))})})).then(function(){dc.ULS.sendTraceTag(523638492,0,50,'DragSelectionClickBehaviorTableRange.RearrangeRowColumn: success. copyPasteTargetType="{0}"',1);vb&&vb.Dlf(Db,rc,T.sourceRange,T.ub);return Promise.resolve(!0)},function(Uc){dc.ULS.sendTraceTag(523638491,0,10,'DragSelectionClickBehaviorTableRange.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',Uc?copyPasteInfra.getStringifiedError(Uc):
"null",1);return vb?vb.rAf(Uc,Db,rc,T.sourceRange,T.ub):Promise.reject(Uc)})};B.prototype.rtb=function(T,pa){function hb(){return new Q(Uc,vb)}function Db(Td,mf,bg){return M(rc.$.na.va,Uc,vb,T?ge.b(Td,T):Td,pa?ge.a(mf,pa):mf,bg,null)}var rc=this;T=void 0===T?null:T;pa=void 0===pa?null:pa;var vb={};this.ky()?(vb.FirstRow=this.ub.top-1,vb.FirstColumn=0,vb.DeltaColumn=0,vb.DeltaRow=this.ub.bottom-this.ub.top+1):(vb.FirstRow=0,vb.FirstColumn=this.ub.left-1,vb.DeltaColumn=this.ub.right-this.ub.left+1,
vb.DeltaRow=0);vb.LastRow=cf.a.ny;vb.LastColumn=cf.a.mv;vb.SheetName=this.$.xa.qa?this.$.xa.qa.name:this.$.Hb.getItemByName(this.$.Hb.qa.name).sheetName;var Uc=Ff.v(this.sourceRange,this.$);$e.EwaSettings.qc()?this.$.userOperationManager.jc(new Gb.a(514,0,Db,64,hb),null):this.$.userOperationManager.jc(new Va.a(514,0,Db,void 0,hb),null)};B.prototype.nka=function(T){T=zf.g(this.$).getRangeInformation(T);for(var pa=0,hb=T.length;pa<hb;++pa)if(Object(vd.a)(rh.PivotTableRange,T[pa]))return T=Df.a.gd(1,
0,0,897,0,2105176604,"InsDelCellsPivotTable"),ff.a(this.$).Cr([T]),!0;return!1};B.prototype.Goa=function(T){T=void 0===T?0:T;0===T?this.gu=!1:1===T&&(this.hu=!1);this.Yh&&(this.gu||this.hu)||(ah.KeyInputManager.instance.Aa(Vf.a.Vd,this.domElement.ownerDocument.body,this.onKeyUp),this.oMa=!1)};B.prototype.ZN=function(T){T=void 0===T?!1:T;this.gi=5;this.Vw(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp"));this.qM=this.tsb;this.uO=this.SKb;this.Uz(this.Pw.clientPoint,
this.Pw.Lb,this.Maa(),!1,T)};B.prototype.SPa=function(T){T=void 0===T?!1:T;this.gi=6;this.Vw(this.u6,this.v6);this.qM=this.qia;this.uO=this.Rna;this.Uz(this.Pw.clientPoint,this.Pw.Lb,this.isRow||this.Oq?11:12,!0,T)};B.prototype.xza=function(T){T=void 0===T?!1:T;this.gi=6;this.Vw(this.FN,this.IN);this.qM=this.qia;this.uO=this.Rna;this.Uz(this.Pw.clientPoint,this.Pw.Lb,this.ky()?11:12,!0,T)};B.prototype.tka=function(T){return T.Ca.keyCode===Ba.a.i8||ya.a.isMac&&T.Ca.keyCode===Ba.a.Poa};B.prototype.ky=
function(){return!this.Yh&&this.isRow||this.Yh&&this.Oq};B.prototype.h3=function(T){this.Db.Oh(this.Nh);this.Tt(this.u6,this.v6,void 0,T)};B.prototype.qtd=function(){var T=yf.a.instance.kc("Common.ISystemInitiatedFeedback");T&&T.execute(function(pa){pa.logActivity("DragDrop",null)})};B.Kqb="copy";Object(Zd.a)(B,"DragSelectionClickBehaviorTableRange",N,[]);var fe=b(329);Wl(A,N);A.prototype.Vnc=function(T){this.Pw=T;this.isRow=this.hf=!1;this.cq=!0;this.Fc=this.tableManager.vva(this.sourceRange);zf.g(this.$);
zf.g(this.$).ug.Jo(V.A1a);this.wpd(this.ub)?(this.isRow=this.Bki(),this.hf=this.Hei(),this.isRow||this.hf?(this.Wgc=!1,this.xza(T),this.ub=this.Z2(this.ub),this.GI()):(this.Wgc=!0,this.ZN(T),this.Jy())):(this.Wgc=!0,this.ZN(T),this.Jy())};A.prototype.vya=function(){return 5==this.gi?(this.XA(!0),this.Wgc=!1,this.Mxj(),this.gi=-1,!0):!1};A.prototype.Xnc=function(T){var pa=this.ha.Xn(T.clientPoint,T.Lb,5,void 0,void 0,!0);this.Pw=T;return this.Wgc?!1:this.wpd(pa)?(this.S0h(T),!0):!1};A.prototype.HB=
function(){var T=new Se.Range(this.ub.top,this.ub.left,this.ub.bottom,this.ub.right,!1,!0);6==this.gi&&(this.isRow?(--T.top,T.bottom=T.top+this.ub.height-1):(--T.left,T.right=T.left+this.ub.width-1));for(var pa=1;4>=pa;pa++)this.Vh[pa.toString()].childNodes[0].innerText=T.toString()};A.prototype.hxc=function(){if(!zf.g(this.$).ha.ta.Hg)return!1;var T=zf.g(this.$).getRangeInformation(this.ha.ta.qd);T=Gl(T);for(var pa=T.next();!pa.done;pa=T.next())if(Object(vd.a)(rh.PivotTableRange,pa.value))return!0;
return!1};A.prototype.Z2=function(T){T=T.clone();this.isRow?(T.left=this.sourceRange.left,T.right=this.Fc.right,T.bottom=T.top+this.sourceRange.height-1):this.hf&&(T.top=this.sourceRange.top,T.bottom=this.Fc.dX.bottom,T.right=T.left+this.sourceRange.width-1);return this.LYa(T)};A.prototype.M_i=function(){var T={},pa=Ff.v(this.sourceRange,this.$);zf.g(this.$).getRangeInformation(this.ub);if(this.isRow){T.FirstColumn=this.ub.left-1;T.LastColumn=this.ub.right-1;if(this.sourceRange.top<=this.ub.top&&
this.sourceRange.bottom>=this.ub.top-1)return;T.FirstRow=this.sourceRange.top>this.ub.top?this.ub.top-1:this.ub.top-this.sourceRange.height-1;T.LastRow=T.FirstRow+this.sourceRange.height-1}else{T.FirstRow=this.ub.top;T.LastRow=this.ub.bottom;if(this.sourceRange.left<=this.ub.left&&this.sourceRange.right>=this.ub.left-1)return;T.FirstColumn=this.sourceRange.left>this.ub.left?this.ub.left-1:this.ub.left-this.sourceRange.width-1;T.LastColumn=T.FirstColumn+this.sourceRange.width-1}var hb={};hb.SheetName=
this.$.xa.qa?this.$.xa.qa.name:this.$.Hb.getItemByName(this.$.Hb.qa.name).sheetName;hb.Ranges=Array(2);hb.Ranges[0]=pa;hb.Ranges[1]=T;this.pwh(hb)};A.prototype.pwh=function(T){function pa(Db,rc,vb){var Uc=hb.$.na.va;Db=hb.Wyf?ge.b(Db,hb.Wyf):Db;rc=hb.Vyf?ge.a(rc,hb.Vyf):rc;var Td=Uc.Na(1,null);Td.moveRange=T;return ye.i(Uc,"MoveLineItems",Td,Db,rc,vb,null,0)}var hb=this;$e.EwaSettings.qc()?this.$.userOperationManager.jc(new Gb.a(265,0,pa,64),null):this.$.userOperationManager.jc(new Va.a(265,0,pa,
void 0),null)};A.prototype.wpd=function(T){return T.left>=this.Fc.dX.left&&T.right<=this.Fc.lM.right&&T.top>=this.Fc.lM.top&&T.bottom<=this.Fc.dX.bottom};A.prototype.Bki=function(){return this.Fc.dX.top<=this.ub.top&&this.Fc.dX.left<=this.ub.left&&this.Fc.dX.right>=this.ub.left};A.prototype.Hei=function(){return this.Fc.lM.top==this.ub.top&&this.Fc.lM.left<=this.ub.left&&this.Fc.lM.right>=this.ub.right};A.prototype.xza=function(T){this.gi=6;this.Nh=this.isRow?[11]:[12];this.Vw(this.FN,this.IN);this.Uz(T.clientPoint,
T.Lb,this.isRow?11:12,!0,!1)};A.prototype.ZN=function(T){this.gi=5;this.Vw(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp"));this.Uz(T.clientPoint,T.Lb,this.Maa(),!1,!1)};A.prototype.S0h=function(T){this.XA(!0);this.xza(T);this.ub=this.Z2(this.ub);this.GI()};A.prototype.R0h=function(T){this.w$(!0);this.ZN(T);this.Jy()};A.prototype.Mxj=function(){var T=Df.a.gd(1,0,899,898,0,2069074184,"PivotTableInvalidMove");T.HelpTopicId=fe.a.sBj;T.HelpDescription=Le.a.instance.ga(904);
ff.a(this.$).Cr([T])};Object(Zd.a)(A,"DragSelectionClickBehaviorPivotTableRange",N,[]);Wl(D,E);D.prototype.dispose=function(){Eg.a.instance.Aa(Vf.a.pointerDown,this.uaa,this.onPointerDown);Z.a.instance.Aa(Vf.a.lk,this.uaa,this.rca);this.gridView.$&&(this.gridView.ha.b7(this.Ap),this.gridView.ha.QW(this.Jg),this.gridView.$.yl(this.vd),this.gridView.$.Ab.Vsc(this.B6),this.gridView.$.Ab.Usc(this.A6),this.gridView.WOf(this.UDb),this.gridView.tc.kl(this.fxf),this.gridView.tc.Um(this.exf));E.prototype.dispose.call(this)};
Object(Zd.a)(D,"FillHandleClickBehavior",E,[]);Wl(z,Y);Ck.Object.defineProperties(z.prototype,{Gva:{configurable:!0,enumerable:!0,get:function(){return this.Pog}}});z.Cwe=[1,2,32,256,128,64];Object(Zd.a)(z,"IPadSelectionClickThroughBehavior",Y,[]);t.prototype.dispose=function(){this.gridView.ha.b7(this.Ap);this.gridView.ha.QW(this.Jg);this.gridView.ha.VId(this.Jg)};t.prototype.Nza=function(){this.Z4a=0;this.sgc=!1;this.J5=Number.NaN};t.prototype.b8e=function(T){this.rBc(T.Lb,1);return!0};t.prototype.c8e=
function(T){this.rBc(T.Lb,-1);return!0};t.prototype.XIe=function(T){this.sgc=!0;this.rBc(T,1)};t.prototype.YIe=function(T){this.sgc=!1;this.rBc(T,-1)};t.prototype.rBc=function(T,pa){if(T)if(T.parentNode)if(this.pod)isNaN(this.J5)||(this.EBc(this.J5,!1),this.J5=Number.NaN);else if(T=parseInt(T.parentNode.getAttribute(ae.a.Ixb),10),isNaN(T))dc.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.J5)&&T!==this.J5){if(this.sgc)return;
this.EBc(this.J5,!1)}if(isNaN(this.J5)||T!==this.J5)this.J5=T,this.Z4a=0;!this.Z4a&&0<pa&&this.EBc(T,!0);this.Z4a=Math.max(this.Z4a+pa,0);!this.Z4a&&0>pa&&(this.EBc(T,!1),this.J5=Number.NaN)}else dc.ULS.shipAssertTag(537159367,0,!!T.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else dc.ULS.shipAssertTag(537159368,0,!!T,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")};t.prototype.EBc=function(T,pa){for(var hb=1;4>=hb;hb++){var Db=this.gridView.Db.yw(3,
hb,T).Ef;se.DOMElementExtensions.toggleCssClass(Db,aa.juh,pa);for(Db=Db.firstChild;Db;Db=Db.nextSibling)Pf.a.contains(Db.className,"resizemarqueehandle",!0)&&se.DOMElementExtensions.toggleCssClass(Db,aa.nuh,pa)}};Object(Zd.a)(t,"MarqueeHoveringManager",null,[]);var af=b(1029),zh=b(1316);Wl(v,Y);v.prototype.dispose=function(){Eg.a.instance.Aa(Vf.a.zW,this.$J,this.Qzf);Eg.a.instance.Aa(Vf.a.xy,this.$J,this.vca);Eg.a.instance.Aa(Vf.a.pointerDown,this.$J,this.onPointerDown);oi.a.instance.Aa(Vf.a.click,
this.$J,this.tEb);oi.a.instance.Aa(Vf.a.lk,this.$J,this.onDoubleClick);se.DOMElementExtensions.zf(this.zH);this.zH=null;se.DOMElementExtensions.zf(this.$J);this.gv=this.$J=null;Y.prototype.dispose.call(this)};v.prototype.KYa=function(T){this.gv=Object(pg.a)(zh.a,T.metadata)};Object(Zd.a)(v,"RangeCatchUpActivityHighlightBehavior",Y,[]);Wl(w,I);w.prototype.MRa=function(){return(this.gridView.inRangePicker||this.gridView.Li)&&I.prototype.MRa.call(this)};Ck.Object.defineProperties(w.prototype,{U4:{configurable:!0,
enumerable:!0,get:function(){return 16}},$bb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.rangePicker.icd(!1)}}});Object(Zd.a)(w,"RangePickerTouchGrippiesBehavior",I,[]);Wl(u,Y);Object(Zd.a)(u,"RearrangeHighlightBehavior",Y,[]);var yi;(function(T){T[T.topLeft=0]="topLeft";T[T.topRight=1]="topRight";T[T.bottomLeft=2]="bottomLeft";T[T.bottomRight=3]="bottomRight";T[T.error=4]="error"})(yi||(yi={}));Object(Zd.b)("Corner",yi);Wl(x,Y);x.prototype.dispose=function(){var T=this;
this.TK.forEach(function(pa){Eg.a.instance.Aa(Vf.a.pointerDown,pa,T.onPointerDown)});Array.clear(this.TK);Y.prototype.dispose.call(this)};x.prototype.KYa=function(T){this.gba=T;this.eoe(T);this.oo.wKb(T,this.TK,this.FQd());this.my.Nza()};x.prototype.Ih=function(T){T=Ih.a(this.$).ie(T);T=this.j_e(T,!1);if(!T)return!0;T=this.zDe(T);if(!T)return dc.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.G9b(!0),!1;if(this.ub.equals(T))return!0;this.ub=
T;T=this.Jy();T||(dc.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.G9b(!0));return T};x.prototype.Gf=function(T){var pa=this;T=Ih.a(this.$).ie(T);T=this.bL();dc.ULS.shipAssertTag(537159325,0,T,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");ya.a.lB&&(this.ha.cec(!0),window.setTimeout(function(){pa.ha.cec(!1)},100));this.G9b(!T);return T};x.prototype.j_e=function(T,pa){var hb=T.Lb;T=T.clientPoint;if(!hb||!T)return dc.ULS.shipAssertTag(537159324,
0,!!hb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),dc.ULS.shipAssertTag(537159323,0,!!T,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;pa&&(T=this.Tpf(T));pa=this.ha.Xn(T,hb,0,!0,!1,!0);pa||(T=this.Tpf(T),pa=this.ha.Xn(T,hb,0,!0,!1,!0));return pa};x.prototype.Tpf=function(T){T.y+=0===this.z3||1===this.z3?2:-2;T.x+=0===this.z3||2===this.z3?2:-2;return T};x.prototype.zDe=function(T){if(!T||!this.sourceRange)return dc.ULS.shipAssertTag(537159322,0,!!T,
"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),dc.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.z3)return new Se.Range(T.top,T.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.z3)return new Se.Range(T.top,this.sourceRange.left,this.sourceRange.bottom,T.right,!0,!1);if(2===this.z3)return new Se.Range(this.sourceRange.top,T.left,T.bottom,this.sourceRange.right,!0,!1);if(3===this.z3)return new Se.Range(this.sourceRange.top,
this.sourceRange.left,T.bottom,T.right,!0,!1);dc.ULS.shipAssertTag(537159320,0,!1,"ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: {0}",yi[this.z3]);return null};x.prototype.bL=function(){return this.coloredReferencesManager.Spf(this.Ya,this.YK,this.ub)};x.prototype.Jy=function(){return this.bL()};x.prototype.G9b=function(T){T&&dc.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");
this.my.YIe(this.TK[0]);this.oo.RJf(!1,this.gba.B$);this.Ya.textBox.setCaretPositionToEnd();this.Ya.Fsc(this.V4e);this.Gag();this.vSa=this.gridView.rLa=!1;Rg.b(this.$,!1);this.oo.GLf()};Object(Zd.a)(x,"ResizeMarqueeBehaviorBase",Y,[]);Wl(h,x);h.prototype.nSf=function(){return[aa.avh,aa.bvh,aa.Zuh,aa.$uh]};h.prototype.Wne=function(){return[aa.Yuh]};h.prototype.zYe=function(T){T=T.Lb;if(T===this.TK[0])return 0;if(T===this.TK[1])return 1;if(T===this.TK[2])return 2;if(T===this.TK[3])return 3;dc.ULS.shipAssertTag(537159318,
0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};h.prototype.hNf=function(){this.oo.Vw(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp"),!0)};h.prototype.Gag=function(){this.oo.iXd(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp"),!0)};h.prototype.a1f=function(T){return 2===(dd.a.Sb=T.zb)&&T.Vn===Sys.UI.MouseButton.leftButton};h.prototype.FQd=function(){return!0};h.prototype.Tlf=
function(){dc.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")};h.prototype.eoe=function(T){for(var pa=Gl(this.TK),hb=pa.next();!hb.done;hb=pa.next())hb.value.style.backgroundColor=T.Ef.style.borderColor};Object(Zd.a)(h,"ResizeMarqueeMouseBehavior",x,[]);Wl(m,x);m.prototype.dispose=function(){dd.a.xPf(this.pEb);x.prototype.dispose.call(this)};m.prototype.nSf=function(){return[ze.a.buh,ze.a.auh]};m.prototype.Wne=function(){var T=
$e.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),pa=ya.a.Of;T=!T||pa;return[T?ze.a.SPe:ze.a.RPe,ze.a.E8b,T?ze.a.$th:ze.a.D8b]};m.prototype.zYe=function(T){T=T.Lb;if(T===this.TK[0])return 0;if(T===this.TK[1])return 3;dc.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};m.prototype.hNf=function(){ya.a.kv?this.oo.Vw(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp"),!1):
this.oo.J6i(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp"))};m.prototype.Gag=function(){ya.a.kv?this.oo.iXd(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp"),!1):this.oo.rNj(Object(of.a)(this,this.Ih,"onPointerMove"),Object(of.a)(this,this.Gf,"onPointerUp"))};m.prototype.a1f=function(T){return 3===(dd.a.Sb=T.zb)};m.prototype.FQd=function(){return 3===dd.a.Sb};m.prototype.Tlf=function(){dc.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")};
m.prototype.eoe=function(){};Object(Zd.a)(m,"ResizeMarqueeTouchBehavior",x,[]);Wl(n,Y);n.Vqb=function(T,pa){var hb=document.createElement("div");hb.className=pa;T.appendChild(hb)};Object(Zd.a)(n,"SelectionCutCopyBehavior",Y,[]);Wl(l,Y);Object(Zd.a)(l,"SelectionPasteBehavior",Y,[]);Wl(f,Y);f.krb=function(T,pa){var hb=document.createElement("div");hb.className=pa;T.appendChild(hb)};Object(Zd.a)(f,"SelectionRangePickerBehavior",Y,[]);Wl(e,I);e.prototype.MRa=function(){var T=this.gridView.Li||this.gridView.isEditing;
return this.gridView.ha.ta.Hg&&!T&&I.prototype.MRa.call(this)};Ck.Object.defineProperties(e.prototype,{U4:{configurable:!0,enumerable:!0,get:function(){return 0}},$bb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.ta.qd}}});Object(Zd.a)(e,"SelectionTouchGrippiesBehavior",I,[]);var ag=Cg.a;Wl(c,ag);c.prototype.dispose=function(){this.gridView.Db.L$i(this.kob);this.my&&(this.my.dispose(),this.my=null);ag.prototype.dispose.call(this)};Object(Zd.a)(c,"GridHighlightsBehaviorManager",
Cg.a,[]);var Zj=Jf.a;Wl(a,Zj);a.prototype.create=function(){var T=this;jc.TaskExtensions.Ba(qb.GetServiceTaskFactory.create(this.$.da,134,this.la,this.vb),function(pa){T.Eb(T.$.da.za(64)||new c(T.$,pa.result))},this.la,3)};a.ka=function(T){T.da.Ga(149,new a(T))};Object(Zd.a)(a,"GridHighlightsBehaviorManagerFactory",Jf.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.AccessibilitySettings");ne.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.NewAndOpen.Core");re.a.instance.gj(new rd);Ae.a.Ji('.ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ms-core-needIEFilter .ewr-selection-draghandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ms-core-needIEFilter .ewr-selection-resizemarqueehandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}');
Ae.a.Ji('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none;-ms-overflow-style:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-locked-sheet-svg{margin-right:4px !important;height:15px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}');
Ae.a.Ji(".ewa-svg-icon{height:100%;width:100%}");Ae.a.Ji(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}");
vg.a.Fa(Nd.ka);td.a.vl.Ga(141,new ed);vg.a.Fa(md.ka);(function(){vg.a.Fa(function(T){Xc.ka(T);$e.EwaSettings.Gb()?Tc.ka(T):Md.ka(T);Qd.ka(T);Qc.ka(T)})})();vg.a.Fa(jb.ka);vg.a.Fa(uc.ka);(function(){vg.a.Fa(function(T){T.da.Ga(134,new lb(T));T.da.Ga(330,new Xa(T))})})();vg.a.Fa(qd.ka);(function(){vg.a.Fa(function(T){Ra.ka(T);Rb.ka(T)})})();Type.registerNamespace("Common.App.SessionExpiration");vg.a.Fa(oa.ka);vg.a.Fa(a.ka);vg.a.Fa(ta.ka)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.acc.js.map/731b738e17fa065983b84b0ff60d6895/EwaDS.acc.js.map